(self.webpackChunkclickgroupIFE=self.webpackChunkclickgroupIFE||[]).push([[179],{406:(bn,fn,Je)=>{"use strict";var ht=Je(564),gt=Je(498),h="\n  ",me={};function Xe(Yt){var De=Array.isArray(Yt);return function(nt){var Ge=Oe(me.plainArray,nt);if(Ge)return Ge;if(De&&nt.length!==Yt.length)return"an array with "+Yt.length+" items";for(var Ct=0;Ct<nt.length;Ct++)if(Ge=Oe(De?Yt[Ct]:Yt,nt[Ct]))return[Ct].concat(Ge)}}function Oe(Yt,De){if(null!=De||Yt.hasOwnProperty("__required")){var ct=Yt(De);if(ct)return Array.isArray(ct)?ct:[ct]}}function tt(Yt,De){var ct=Yt.length,qt=Yt[ct-1],nt=Yt.slice(0,ct-1);return 0===nt.length&&(nt=["value"]),De=gt(De,{path:nt}),"function"==typeof qt?qt(De):pn(De,function Vt(Yt){return"must be "+function Fn(Yt){return/^an? /.test(Yt)?Yt:/^[aeiou]/i.test(Yt)?"an "+Yt:/^[a-z]/i.test(Yt)?"a "+Yt:Yt}(Yt)+"."}(qt))}function pn(Yt,De){return(vn(Yt.path)?"Item at position ":"")+Yt.path.join(".")+" "+De}function vn(Yt){return"number"==typeof Yt[Yt.length-1]||"number"==typeof Yt[0]}me.assert=function(Yt,De){return De=De||{},function(ct){var qt=Oe(Yt,ct);if(qt){var nt=tt(qt,De);throw De.apiName&&(nt=De.apiName+": "+nt),new Error(nt)}}},me.shape=function(De){var ct=function en(Yt){return Object.keys(Yt||{}).map(function(De){return{key:De,value:Yt[De]}})}(De);return function(nt){var Ge=Oe(me.plainObject,nt);if(Ge)return Ge;for(var Ct,Qt=[],xn=0;xn<ct.length;xn++)(Ge=Oe(ct[xn].value,nt[Ct=ct[xn].key]))&&Qt.push([Ct].concat(Ge));return Qt.length<2?Qt[0]:function(Et){Qt=Qt.map(function(To){return"- "+To[0]+": "+tt(To,Et).split("\n").join(h)});var Si=Et.path.join(".");return"The following properties"+("value"===Si?"":" of "+Si)+" have invalid values:"+h+Qt.join(h)}}},me.strictShape=function(De){var ct=me.shape(De);return function(nt){var Ge=ct(nt);if(Ge)return Ge;var Ct=Object.keys(nt).reduce(function(Le,Qt){return void 0===De[Qt]&&Le.push(Qt),Le},[]);return 0!==Ct.length?function(){return"The following keys are invalid: "+Ct.join(", ")}:void 0}},me.arrayOf=function(De){return Xe(De)},me.tuple=function(){return Xe(Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments))},me.required=function(De){function ct(qt){return null==qt?function(nt){return pn(nt,vn(nt.path)?"cannot be undefined/null.":"is required.")}:De.apply(this,arguments)}return ct.__required=!0,ct},me.oneOfType=function(){var De=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(qt){var nt=De.map(function(Ge){return Oe(Ge,qt)}).filter(Boolean);if(nt.length===De.length)return nt.every(function(Ge){return 1===Ge.length&&"string"==typeof Ge[0]})?function Ye(Yt){return Yt.length<2?Yt[0]:2===Yt.length?Yt.join(" or "):Yt.slice(0,-1).join(", ")+", or "+Yt.slice(-1)}(nt.map(function(Ge){return Ge[0]})):nt.reduce(function(Ge,Ct){return Ct.length>Ge.length?Ct:Ge})}},me.equal=function(De){return function(qt){if(qt!==De)return JSON.stringify(De)}},me.oneOf=function(){var ct=(Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments)).map(function(qt){return me.equal(qt)});return me.oneOfType.apply(this,ct)},me.range=function(De){var ct=De[0],qt=De[1];return function(Ge){if(Oe(me.number,Ge)||Ge<ct||Ge>qt)return"number between "+ct+" & "+qt+" (inclusive)"}},me.any=function(){},me.boolean=function(De){if("boolean"!=typeof De)return"boolean"},me.number=function(De){if("number"!=typeof De)return"number"},me.plainArray=function(De){if(!Array.isArray(De))return"array"},me.plainObject=function(De){if(!ht(De))return"object"},me.string=function(De){if("string"!=typeof De)return"string"},me.func=function(De){if("function"!=typeof De)return"function"},me.validate=Oe,me.processMessage=tt,bn.exports=me},564:bn=>{"use strict";var fn=Object.prototype.toString;bn.exports=function(Je){var ht;return"[object Object]"===fn.call(Je)&&(null===(ht=Object.getPrototypeOf(Je))||ht===Object.getPrototypeOf({}))}},805:(bn,fn,Je)=>{"use strict";var ht=Je(630).x0;function gt(We){this.origin=We.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=We.accessToken,this.version="0.2.0",this.sessionID=this.generateSessionID(),this.userAgent=this.getUserAgent(),this.options=We,this.send=this.send.bind(this),this.countries=We.countries?We.countries.split(","):null,this.types=We.types?We.types.split(","):null,this.bbox=We.bbox?We.bbox:null,this.language=We.language?We.language.split(","):null,this.limit=We.limit?+We.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(We),this.eventQueue=new Array,this.flushInterval=We.flushInterval||1e3,this.maxQueueSize=We.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}gt.prototype={select:function(We,h){var me=this.getSelectedIndex(We,h),Xe=this.getEventPayload("search.select",h);if(Xe.resultIndex=me,Xe.resultPlaceName=We.place_name,Xe.resultId=We.id,(me!==this.lastSentIndex||Xe.queryString!==this.lastSentInput)&&-1!=me&&(this.lastSentIndex=me,this.lastSentInput=Xe.queryString,Xe.queryString))return this.push(Xe)},start:function(We){var h=this.getEventPayload("search.start",We);if(h.queryString)return this.push(h)},keyevent:function(We,h){if(We.key&&!We.metaKey&&-1===[9,27,37,39,13,38,40].indexOf(We.keyCode)){var me=this.getEventPayload("search.keystroke",h);if(me.lastAction=We.key,me.queryString)return this.push(me)}},send:function(We,h){if(!this.enableEventLogging)return h?h():void 0;var me=this.getRequestOptions(We);this.request(me,function(Xe){return Xe?this.handleError(Xe,h):h?h():void 0}.bind(this))},getRequestOptions:function(We){return Array.isArray(We)||(We=[We]),{method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(We)}},getEventPayload:function(We,h){var me;me=h.options.proximity?"object"==typeof h.options.proximity?[h.options.proximity.longitude,h.options.proximity.latitude]:"ip"===h.options.proximity?[999,999]:h.options.proximity:null;var Xe=h._map?h._map.getZoom():void 0,Oe={event:We,created:+new Date,sessionIdentifier:this.sessionID,country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",autocomplete:h.options.autocomplete,fuzzyMatch:h.options.fuzzyMatch,proximity:me,limit:h.options.limit,routing:h.options.routing,worldview:h.options.worldview,mapZoom:Xe,keyboardLocale:this.locale};return Oe.queryString="search.select"===We?h.inputString:"search.select"!=We&&h._inputEl?h._inputEl.value:h.inputString,Oe},request:function(We,h){var me=new XMLHttpRequest;for(var Xe in me.onreadystatechange=function(){if(4==this.readyState)return h(204==this.status?null:this.statusText)},me.open(We.method,We.host+"/"+We.path,!0),We.headers)me.setRequestHeader(Xe,We.headers[Xe]);me.send(We.body)},handleError:function(We,h){if(h)return h(We)},generateSessionID:function(){return ht()},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(We,h){if(h._typeahead){var Xe=We.id;return h._typeahead.data.map(function(Ye){return Ye.id}).indexOf(Xe)}},shouldEnableLogging:function(We){return!(!1===We.enableEventLogging||We.origin&&"https://api.mapbox.com"!==We.origin||We.localGeocoder||We.filter)},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=new Array),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(We,h){this.eventQueue.push(We),(this.eventQueue.length>=this.maxQueueSize||h)&&this.flush()},remove:function(){this.flush()}},bn.exports=gt},280:bn=>{bn.exports={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}}},272:bn=>{function fn(){}fn.prototype={isSupport:function(){return!!window.navigator.geolocation},getCurrentPosition:function(){const Je={enableHighAccuracy:!0};return new Promise(function(ht,gt){window.navigator.geolocation.getCurrentPosition(ht,gt,Je)})}},bn.exports=fn},904:(bn,fn,Je)=>{"use strict";var ht=Je(28),gt=Je(220),We=Je(498),h=Je(16).EventEmitter,me=Je(280),Xe=Je(658),Oe=Je(725),tt=Je(805),Ye=Je(251),Vt=Je(681),Fn=Je(272),pn=Je(485);function Yt(De){this._eventEmitter=new h,this.options=We({},this.options,De),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geolocation=new Fn}Yt.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,flipCoordinates:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,enableGeolocation:!1,addressAccuracy:"street",getItemValue:function(De){return De.place_name},render:function(De){var ct=De.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+ct[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+ct.splice(1,ct.length).join(",")+"</div></div>"}},addTo:function(De){function ct(qt,nt){if(!document.body.contains(nt))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const Ge=qt.onAdd();nt.appendChild(Ge)}if(De._controlContainer)De.addControl(this);else if(De instanceof HTMLElement)ct(this,De);else{if("string"!=typeof De)throw new Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element");{const qt=document.querySelectorAll(De);if(0===qt.length)throw new Error("Element ",De,"not found.");if(qt.length>1)throw new Error("Geocoder can only be added to a single html element");ct(this,qt[0])}}},onAdd:function(De){if(De&&"string"!=typeof De&&(this._map=De),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=Oe(Xe({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new tt(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this),this._geolocateUser=this._geolocateUser.bind(this);var ct=this.container=document.createElement("div");ct.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var qt=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",gt(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",function(Et){this.eventManager.keyevent(Et,this)}.bind(this));var nt=document.createElement("div");nt.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var Ge=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');if(this._clearEl.appendChild(Ge),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),nt.appendChild(this._clearEl),nt.appendChild(this._loadingEl),ct.appendChild(qt),ct.appendChild(this._inputEl),ct.appendChild(nt),this.options.enableGeolocation&&this.geolocation.isSupport()){this._geolocateEl=document.createElement("button"),this._geolocateEl.setAttribute("aria-label","Geolocate"),this._geolocateEl.addEventListener("click",this._geolocateUser),this._geolocateEl.className="mapboxgl-ctrl-geocoder--button";var Ct=this.createIcon("geolocate",'<path d="M12.999 3.677L2.042 8.269c-.962.403-.747 1.823.29 1.912l5.032.431.431 5.033c.089 1.037 1.509 1.252 1.912.29l4.592-10.957c.345-.822-.477-1.644-1.299-1.299z" fill="#4264fb"/>');this._geolocateEl.appendChild(Ct),nt.appendChild(this._geolocateEl),this._showGeolocateButton()}var Le=this._typeahead=new ht(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit});this.setRenderFunction(this.options.render),Le.getItemValue=this.options.getItemValue;var Qt=Le.list.draw,xn=this._footerNode=function en(){var De=document.createElement("div");return De.className="mapboxgl-ctrl-geocoder--powered-by",De.innerHTML='<a href="https://www.mapbox.com/search-service" target="_blank">Powered by Mapbox</a>',De}();return Le.list.draw=function(){Qt.call(this),xn.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),xn.addEventListener("mouseup",function(){this.selectingListItem=!1}.bind(this)),this.element.appendChild(xn)},this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),ct},_geolocateUser:function(){this._hideGeolocateButton(),this._showLoadingIcon(),this.geolocation.getCurrentPosition().then(function(De){this._hideLoadingIcon();const ct={geometry:{type:"Point",coordinates:[De.coords.longitude,De.coords.latitude]}};this._handleMarker(ct),this._fly(ct),this._typeahead.clear(),this._typeahead.selected=!0,this.lastSelected=JSON.stringify(ct),this._showClearButton(),this.fresh=!1;const qt={limit:1,language:[this.options.language],query:ct.geometry.coordinates,types:["address"]};this.options.localGeocoderOnly?(this._setInputValue(ct.geometry.coordinates[0]+","+ct.geometry.coordinates[1]),this._eventEmitter.emit("result",{result:ct})):this.geocoderService.reverseGeocode(qt).send().then(function(nt){const Ge=nt.body.features[0];if(Ge){const Ct=pn.transformFeatureToGeolocationText(Ge,this.options.addressAccuracy);this._setInputValue(Ct),Ge.user_coordinates=ct.geometry.coordinates,this._eventEmitter.emit("result",{result:Ge})}else this._eventEmitter.emit("result",{result:{user_coordinates:ct.geometry.coordinates}})}.bind(this))}.bind(this)).catch(function(De){1===De.code?this._renderUserDeniedGeolocationError():this._renderLocationError(),this._hideLoadingIcon(),this._showGeolocateButton(),this._hideAttribution()}.bind(this))},createIcon:function(De,ct){var qt=document.createElementNS("http://www.w3.org/2000/svg","svg");return qt.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+De),qt.setAttribute("viewBox","0 0 18 18"),qt.setAttribute("xml:space","preserve"),qt.setAttribute("width",18),qt.setAttribute("height",18),qt.innerHTML=ct,qt},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_setInputValue:function(De){this._inputEl.value=De,setTimeout(function(){this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0)}.bind(this),1)},_onPaste:function(De){var ct=(De.clipboardData||window.clipboardData).getData("text");ct.length>=this.options.minLength&&this._geocode(ct)},_onKeyDown:function(De){var ct=27,qt=9;if(De.keyCode===ct&&this.options.clearAndBlurOnEsc)return this._clear(De),this._inputEl.blur();var nt=De.target&&De.target.shadowRoot?De.target.shadowRoot.activeElement:De.target;if(!nt||!nt.value)return this.fresh=!0,De.keyCode!==qt&&this.clear(De),this._showGeolocateButton(),this._hideClearButton();this._hideGeolocateButton(),!De.metaKey&&-1===[qt,ct,37,39,13,38,40].indexOf(De.keyCode)&&nt.value.length>=this.options.minLength&&this._geocode(nt.value)},_showButton:function(){this._typeahead.selected&&this._showClearButton()},_hideButton:function(){this._typeahead.selected&&this._hideClearButton()},_showClearButton:function(){this._clearEl.style.display="block"},_hideClearButton:function(){this._clearEl.style.display="none"},_showGeolocateButton:function(){this._geolocateEl&&this.geolocation.isSupport()&&(this._geolocateEl.style.display="block")},_hideGeolocateButton:function(){this._geolocateEl&&(this._geolocateEl.style.display="none")},_showLoadingIcon:function(){this._loadingEl.style.display="block"},_hideLoadingIcon:function(){this._loadingEl.style.display="none"},_showAttribution:function(){this._footerNode.style.display="block"},_hideAttribution:function(){this._footerNode.style.display="none"},_onBlur:function(De){this.options.clearOnBlur&&this._clearOnBlur(De),this.options.collapsed&&this._collapse()},_onChange:function(){var De=this._typeahead.selected;De&&JSON.stringify(De)!==this.lastSelected&&(this._hideClearButton(),this.options.flyTo&&this._fly(De),this.options.marker&&this._mapboxgl&&this._handleMarker(De),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(De),this._eventEmitter.emit("result",{result:De}),this.eventManager.select(De,this))},_fly:function(De){var ct;if(De.properties&&me[De.properties.short_code])ct=We({},this.options.flyTo),this._map&&this._map.fitBounds(me[De.properties.short_code].bbox,ct);else if(De.bbox){var qt=De.bbox;ct=We({},this.options.flyTo),this._map&&this._map.fitBounds([[qt[0],qt[1]],[qt[2],qt[3]]],ct)}else ct=We({},{zoom:this.options.zoom},this.options.flyTo),De.center?ct.center=De.center:De.geometry&&De.geometry.type&&"Point"===De.geometry.type&&De.geometry.coordinates&&(ct.center=De.geometry.coordinates),this._map&&this._map.flyTo(ct)},_requestType:function(De,ct){return De.localGeocoderOnly?1:De.reverseGeocode&&pn.REVERSE_GEOCODE_COORD_RGX.test(ct)?2:0},_setupConfig:function(De,ct){const nt=/[\s,]+/;var Ge=this,Ct=["bbox","limit","proximity","countries","types","language","reverseMode","mode","autocomplete","fuzzyMatch","routing","worldview"].reduce(function(Qt,xn){return null==Ge.options[xn]||(Qt[xn]=["countries","types","language"].indexOf(xn)>-1?Ge.options[xn].split(nt):Ge.options[xn],"proximity"===xn&&"number"==typeof Ge.options[xn].longitude&&"number"==typeof Ge.options[xn].latitude&&(Qt[xn]=[Ge.options[xn].longitude,Ge.options[xn].latitude])),Qt},{});switch(De){case 2:var Le=ct.split(nt).map(function(Qt){return parseFloat(Qt,10)});Ge.options.flipCoordinates||Le.reverse(),Ct=We(Ct,{query:Le,limit:1}),["proximity","autocomplete","fuzzyMatch","bbox"].forEach(function(Qt){Qt in Ct&&delete Ct[Qt]});break;case 0:{const Qt=ct.trim();/^(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)?$/.test(Qt)&&(ct=ct.replace(/,/g," ")),Ct=We(Ct,{query:ct})}}return Ct},_geocode:function(De){this.inputString=De,this._showLoadingIcon(),this._eventEmitter.emit("loading",{query:De});const ct=this._requestType(this.options,De),qt=this._setupConfig(ct,De);var nt;switch(ct){case 1:nt=Promise.resolve();break;case 0:nt=this.geocoderService.forwardGeocode(qt).send();break;case 2:nt=this.geocoderService.reverseGeocode(qt).send()}var Ge=this.options.localGeocoder&&this.options.localGeocoder(De)||[],Ct=[],Le=null;return nt.catch(function(Qt){Le=Qt}.bind(this)).then(function(Qt){this._hideLoadingIcon();var xn={};return Qt?"200"==Qt.statusCode&&((xn=Qt.body).request=Qt.request,xn.headers=Qt.headers):xn={type:"FeatureCollection",features:[]},xn.config=qt,this.fresh&&(this.eventManager.start(this),this.fresh=!1),xn.features=xn.features?Ge.concat(xn.features):Ge,this.options.externalGeocoder?(Ct=this.options.externalGeocoder(De,xn.features)||Promise.resolve([])).then(function(Et){return xn.features=xn.features?Et.concat(xn.features):Et,xn},function(){return xn}):xn}.bind(this)).then(function(Qt){if(Le)throw Le;this.options.filter&&Qt.features.length&&(Qt.features=Qt.features.filter(this.options.filter)),Qt.features.length?(this._showClearButton(),this._hideGeolocateButton(),this._showAttribution(),this._eventEmitter.emit("results",Qt),this._typeahead.update(Qt.features)):(this._hideClearButton(),this._hideAttribution(),this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",Qt))}.bind(this)).catch(function(Qt){this._hideLoadingIcon(),this._hideAttribution(),Ge.length&&this.options.localGeocoder||Ct.length&&this.options.externalGeocoder?(this._showClearButton(),this._hideGeolocateButton(),this._typeahead.update(Ge)):(this._hideClearButton(),this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:Ge}),this._eventEmitter.emit("error",{error:Qt})}.bind(this)),nt},_clear:function(De){De&&De.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._hideClearButton(),this._showGeolocateButton(),this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(De){this._clear(De),this._inputEl.focus()},_clearOnBlur:function(De){De.relatedTarget&&this._clear(De)},_onQueryResult:function(De){var ct=De.body;if(ct.features.length){var qt=ct.features[0];this._typeahead.selected=qt,this._inputEl.value=qt.place_name,this._onChange()}},_updateProximity:function(){if(this._map&&this.options.trackProximity)if(this._map.getZoom()>9){var De=this._map.getCenter().wrap();this.setProximity({longitude:De.lng,latitude:De.lat},!1)}else this.setProximity(null,!1)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(De){return this._geocode(De).then(this._onQueryResult),this},_renderError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>")},_renderLocationError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>A location error has occurred</div>")},_renderNoResults:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>")},_renderUserDeniedGeolocationError:function(){this._renderMessage("<div class='mapbox-gl-geocoder--error'>Geolocation permission denied</div>")},_renderMessage:function(De){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(De)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var De=this.options.language.split(",")[0],ct=Vt.language(De),qt=Ye.placeholder[ct];if(qt)return qt}return"Search"},setInput:function(De,ct){return void 0===ct&&(ct=!1),this._inputEl.value=De,this._typeahead.selected=null,this._typeahead.clear(),De.length>=this.options.minLength&&(ct?this._geocode(De):this._onChange()),this},setProximity:function(De,ct=!0){return this.options.proximity=De,ct&&(this.options.trackProximity=!1),this},getProximity:function(){return this.options.proximity},setRenderFunction:function(De){return De&&"function"==typeof De&&(this._typeahead.render=De),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(De){var ct=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=De||this.options.language||ct,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(De){return this.options.zoom=De,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(De){return this.options.flyTo=De,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(De){return this.options.placeholder=De||this._getPlaceholderText(),this._inputEl.placeholder=this.options.placeholder,this._inputEl.setAttribute("aria-label",this.options.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(De){return this.options.bbox=De,this},getCountries:function(){return this.options.countries},setCountries:function(De){return this.options.countries=De,this},getTypes:function(){return this.options.types},setTypes:function(De){return this.options.types=De,this},getMinLength:function(){return this.options.minLength},setMinLength:function(De){return this.options.minLength=De,this._typeahead&&(this._typeahead.options.minLength=De),this},getLimit:function(){return this.options.limit},setLimit:function(De){return this.options.limit=De,this._typeahead&&(this._typeahead.options.limit=De),this},getFilter:function(){return this.options.filter},setFilter:function(De){return this.options.filter=De,this},setOrigin:function(De){return this.options.origin=De,this.geocoderService=Oe(Xe({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},setAccessToken:function(De){return this.options.accessToken=De,this.geocoderService=Oe(Xe({accessToken:this.options.accessToken,origin:this.options.origin})),this},setAutocomplete:function(De){return this.options.autocomplete=De,this},getAutocomplete:function(){return this.options.autocomplete},setFuzzyMatch:function(De){return this.options.fuzzyMatch=De,this},getFuzzyMatch:function(){return this.options.fuzzyMatch},setRouting:function(De){return this.options.routing=De,this},getRouting:function(){return this.options.routing},setWorldview:function(De){return this.options.worldview=De,this},getWorldview:function(){return this.options.worldview},_handleMarker:function(De){if(this._map){this._removeMarker();var qt=We({},{color:"#4668F2"},this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(qt),De.center?this.mapMarker.setLngLat(De.center).addTo(this._map):De.geometry&&De.geometry.type&&"Point"===De.geometry.type&&De.geometry.coordinates&&this.mapMarker.setLngLat(De.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(De,ct){return this._eventEmitter.on(De,ct),this},off:function(De,ct){return this._eventEmitter.removeListener(De,ct),this.eventManager.remove(),this}},bn.exports=Yt},251:bn=>{"use strict";bn.exports={placeholder:{de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05dc\u05d7\u05e4\u05e9",ja:"\u30b5\u30fc\u30c1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041f\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641c\u7d22",cs:"Vyhled\xe1v\xe1n\xed",hu:"Keres\xe9s",ka:"\u10eb\u10d8\u10d4\u10d1\u10d0",nb:"S\xf8ke",sk:"Vyh\u013ead\xe1vanie",th:"\u0e04\u0e49\u0e19\u0e2b\u0e32",fi:"Hae",is:"Leita",ko:"\uc218\uc0c9",pl:"Szukaj",sl:"Iskanje",fa:"\u062c\u0633\u062a\u062c\u0648",ru:"\u041f\u043e\u0438\u0441\u043a"}}},485:bn=>{function Je(gt){const We=gt.address||"",h=gt.text||"",me=gt.place_name||"",Oe={address:me.split(",")[0],houseNumber:We,street:h,placeName:me};return gt.context.forEach(function(tt){const Ye=tt.id.split(".")[0];Oe[Ye]=tt.text}),Oe}bn.exports={transformFeatureToGeolocationText:function fn(gt,We){const h=Je(gt),me=["address","street","place","country"];if("function"==typeof We)return We(h);const Oe=me.indexOf(We);return(-1===Oe?me:me.slice(Oe)).reduce(function(tt,Ye){return h[Ye]?(""!==tt&&(tt+=", "),tt+h[Ye]):tt},"")},getAddressInfo:Je,REVERSE_GEOCODE_COORD_RGX:/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/}},658:(bn,fn,Je)=>{"use strict";var ht=Je(819);bn.exports=ht},819:(bn,fn,Je)=>{"use strict";var ht=Je(561),gt=Je(983);function We(me){gt.call(this,me)}(We.prototype=Object.create(gt.prototype)).constructor=We,We.prototype.sendRequest=ht.browserSend,We.prototype.abortRequest=ht.browserAbort,bn.exports=function h(me){return new We(me)}},561:(bn,fn,Je)=>{"use strict";var ht=Je(896),gt=Je(43),We=Je(889),h=Je(17),me={};function tt(pn){var vn=pn.total,en=pn.loaded;return{total:vn,transferred:en,percent:100*en/vn}}function Ye(pn,vn){return new Promise(function(en,Yt){vn.onprogress=function(qt){pn.emitter.emit(We.EVENT_PROGRESS_DOWNLOAD,tt(qt))};var De=pn.file;De&&(vn.upload.onprogress=function(qt){pn.emitter.emit(We.EVENT_PROGRESS_UPLOAD,tt(qt))}),vn.onerror=function(qt){Yt(qt)},vn.onabort=function(){var qt=new gt({request:pn,type:We.ERROR_REQUEST_ABORTED});Yt(qt)},vn.onload=function(){if(delete me[pn.id],vn.status<200||vn.status>=400){var qt=new gt({request:pn,body:vn.response,statusCode:vn.status});Yt(qt)}else en(vn)};var ct=pn.body;"string"==typeof ct?vn.send(ct):ct?vn.send(JSON.stringify(ct)):De?vn.send(De):vn.send(),me[pn.id]=vn}).then(function(en){return function Oe(pn,vn){return new ht(pn,{body:vn.response,headers:h(vn.getAllResponseHeaders()),statusCode:vn.status})}(pn,en)})}function Vt(pn,vn){var en=pn.url(vn),Yt=new window.XMLHttpRequest;return Yt.open(pn.method,en),Object.keys(pn.headers).forEach(function(De){Yt.setRequestHeader(De,pn.headers[De])}),Yt}bn.exports={browserAbort:function Xe(pn){var vn=me[pn.id];vn&&(vn.abort(),delete me[pn.id])},sendRequestXhr:Ye,browserSend:function Fn(pn){return Promise.resolve().then(function(){var vn=Vt(pn,pn.client.accessToken);return Ye(pn,vn)})},createRequestXhr:Vt}},983:(bn,fn,Je)=>{"use strict";var ht=Je(746),gt=Je(323),We=Je(889);function h(me){if(!me||!me.accessToken)throw new Error("Cannot create a client without an access token");ht(me.accessToken),this.accessToken=me.accessToken,this.origin=me.origin||We.API_ORIGIN}h.prototype.createRequest=function(Xe){return new gt(this,Xe)},bn.exports=h},43:(bn,fn,Je)=>{"use strict";var ht=Je(889);bn.exports=function gt(We){var me,h=We.type||ht.ERROR_HTTP;if(We.body)try{me=JSON.parse(We.body)}catch{me=We.body}else me=null;var Xe=We.message||null;Xe||("string"==typeof me?Xe=me:me&&"string"==typeof me.message?Xe=me.message:h===ht.ERROR_REQUEST_ABORTED&&(Xe="Request aborted")),this.message=Xe,this.type=h,this.statusCode=We.statusCode||null,this.request=We.request,this.body=me}},323:(bn,fn,Je)=>{"use strict";var ht=Je(746),gt=Je(498),We=Je(81),h=Je(51),me=Je(889),Xe=1;function Oe(tt,Ye){if(!tt)throw new Error("MapiRequest requires a client");if(!Ye||!Ye.path||!Ye.method)throw new Error("MapiRequest requires an options object with path and method properties");var Vt={};Ye.body&&(Vt["content-type"]="application/json");var Fn=gt(Vt,Ye.headers),pn=Object.keys(Fn).reduce(function(vn,en){return vn[en.toLowerCase()]=Fn[en],vn},{});this.id=Xe++,this._options=Ye,this.emitter=new We,this.client=tt,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=Ye.path,this.method=Ye.method,this.origin=Ye.origin||tt.origin,this.query=Ye.query||{},this.params=Ye.params||{},this.body=Ye.body||null,this.file=Ye.file||null,this.encoding=Ye.encoding||"utf8",this.sendFileAs=Ye.sendFileAs||null,this.headers=pn}Oe.prototype.url=function(Ye){var Vt=h.prependOrigin(this.path,this.origin);Vt=h.appendQueryObject(Vt,this.query);var Fn=this.params,pn=Ye??this.client.accessToken;if(pn){Vt=h.appendQueryParam(Vt,"access_token",pn);var vn=ht(pn).user;Fn=gt({ownerId:vn},Fn)}return h.interpolateRouteParams(Vt,Fn)},Oe.prototype.send=function(){var Ye=this;if(Ye.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return Ye.sent=!0,Ye.client.sendRequest(Ye).then(function(Vt){return Ye.response=Vt,Ye.emitter.emit(me.EVENT_RESPONSE,Vt),Vt},function(Vt){throw Ye.error=Vt,Ye.emitter.emit(me.EVENT_ERROR,Vt),Vt})},Oe.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),!(this.response||this.error||this.aborted)&&(this.aborted=!0,this.client.abortRequest(this))},Oe.prototype.eachPage=function(Ye){var Vt=this;function Fn(en){Ye(null,en,function Yt(){delete Vt._nextPageRequest;var De=en.nextPage();De&&(Vt._nextPageRequest=De,vn(De))})}function pn(en){Ye(en,null,function(){})}function vn(en){en.send().then(Fn,pn)}vn(this)},Oe.prototype.clone=function(){return this._extend()},Oe.prototype._extend=function(Ye){var Vt=gt(this._options,Ye);return new Oe(this.client,Vt)},bn.exports=Oe},896:(bn,fn,Je)=>{"use strict";var ht=Je(295);function gt(We,h){this.request=We,this.headers=h.headers,this.rawBody=h.body,this.statusCode=h.statusCode;try{this.body=JSON.parse(h.body||"{}")}catch{this.body=h.body}this.links=ht(this.headers.link)}gt.prototype.hasNextPage=function(){return!!this.links.next},gt.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null},bn.exports=gt},889:bn=>{"use strict";bn.exports={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"}},17:bn=>{"use strict";bn.exports=function Je(ht){var gt={};return ht&&ht.trim().split(/[\r|\n]+/).forEach(function(We){var h=function fn(ht){var gt=ht.indexOf(":");return{name:ht.substring(0,gt).trim().toLowerCase(),value:ht.substring(gt+1).trim()}}(We);gt[h.name]=h.value}),gt}},295:bn=>{"use strict";bn.exports=function ht(gt){return gt?gt.split(/,\s*</).reduce(function(We,h){var me=function Je(gt){var We=gt.match(/<?([^>]*)>(.*)/);if(!We)return null;var h=We[1],me=We[2].split(";"),Xe=null,Oe=me.reduce(function(tt,Ye){var Vt=function fn(gt){var We=gt.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return We?{key:We[1],value:We[2]}:null}(Ye);return Vt?"rel"===Vt.key?(Xe||(Xe=Vt.value),tt):(tt[Vt.key]=Vt.value,tt):tt},{});return Xe?{url:h,rel:Xe,params:Oe}:null}(h);return me?(me.rel.split(/\s+/).forEach(function(Oe){We[Oe]||(We[Oe]={url:me.url,params:me.params})}),We):We},{}):{}}},51:bn=>{"use strict";function Je(me){return Array.isArray(me)?function fn(me){return me.map(encodeURIComponent).join(",")}(me):encodeURIComponent(String(me))}function ht(me,Xe,Oe){if(!1===Oe||null===Oe)return me;var tt=/\?/.test(me)?"&":"?",Ye=encodeURIComponent(Xe);return void 0!==Oe&&""!==Oe&&!0!==Oe&&(Ye+="="+Je(Oe)),""+me+tt+Ye}bn.exports={appendQueryObject:function gt(me,Xe){if(!Xe)return me;var Oe=me;return Object.keys(Xe).forEach(function(tt){var Ye=Xe[tt];void 0!==Ye&&(Array.isArray(Ye)&&(Ye=Ye.filter(function(Vt){return null!=Vt}).join(",")),Oe=ht(Oe,tt,Ye))}),Oe},appendQueryParam:ht,prependOrigin:function We(me,Xe){if(!Xe||"http"===me.slice(0,4))return me;var Oe="/"===me[0]?"":"/";return""+Xe.replace(/\/$/,"")+Oe+me},interpolateRouteParams:function h(me,Xe){return Xe?me.replace(/\/:([a-zA-Z0-9]+)/g,function(Oe,tt){var Ye=Xe[tt];if(void 0===Ye)throw new Error("Unspecified route parameter "+tt);return"/"+Je(Ye)}):me}}},81:bn=>{"use strict";var fn=Object.prototype.hasOwnProperty,Je="~";function ht(){}function gt(Xe,Oe,tt){this.fn=Xe,this.context=Oe,this.once=tt||!1}function We(Xe,Oe,tt,Ye,Vt){if("function"!=typeof tt)throw new TypeError("The listener must be a function");var Fn=new gt(tt,Ye||Xe,Vt),pn=Je?Je+Oe:Oe;return Xe._events[pn]?Xe._events[pn].fn?Xe._events[pn]=[Xe._events[pn],Fn]:Xe._events[pn].push(Fn):(Xe._events[pn]=Fn,Xe._eventsCount++),Xe}function h(Xe,Oe){0==--Xe._eventsCount?Xe._events=new ht:delete Xe._events[Oe]}function me(){this._events=new ht,this._eventsCount=0}Object.create&&(ht.prototype=Object.create(null),(new ht).__proto__||(Je=!1)),me.prototype.eventNames=function(){var tt,Ye,Oe=[];if(0===this._eventsCount)return Oe;for(Ye in tt=this._events)fn.call(tt,Ye)&&Oe.push(Je?Ye.slice(1):Ye);return Object.getOwnPropertySymbols?Oe.concat(Object.getOwnPropertySymbols(tt)):Oe},me.prototype.listeners=function(Oe){var Ye=this._events[Je?Je+Oe:Oe];if(!Ye)return[];if(Ye.fn)return[Ye.fn];for(var Vt=0,Fn=Ye.length,pn=new Array(Fn);Vt<Fn;Vt++)pn[Vt]=Ye[Vt].fn;return pn},me.prototype.listenerCount=function(Oe){var Ye=this._events[Je?Je+Oe:Oe];return Ye?Ye.fn?1:Ye.length:0},me.prototype.emit=function(Oe,tt,Ye,Vt,Fn,pn){var vn=Je?Je+Oe:Oe;if(!this._events[vn])return!1;var De,ct,en=this._events[vn],Yt=arguments.length;if(en.fn){switch(en.once&&this.removeListener(Oe,en.fn,void 0,!0),Yt){case 1:return en.fn.call(en.context),!0;case 2:return en.fn.call(en.context,tt),!0;case 3:return en.fn.call(en.context,tt,Ye),!0;case 4:return en.fn.call(en.context,tt,Ye,Vt),!0;case 5:return en.fn.call(en.context,tt,Ye,Vt,Fn),!0;case 6:return en.fn.call(en.context,tt,Ye,Vt,Fn,pn),!0}for(ct=1,De=new Array(Yt-1);ct<Yt;ct++)De[ct-1]=arguments[ct];en.fn.apply(en.context,De)}else{var nt,qt=en.length;for(ct=0;ct<qt;ct++)switch(en[ct].once&&this.removeListener(Oe,en[ct].fn,void 0,!0),Yt){case 1:en[ct].fn.call(en[ct].context);break;case 2:en[ct].fn.call(en[ct].context,tt);break;case 3:en[ct].fn.call(en[ct].context,tt,Ye);break;case 4:en[ct].fn.call(en[ct].context,tt,Ye,Vt);break;default:if(!De)for(nt=1,De=new Array(Yt-1);nt<Yt;nt++)De[nt-1]=arguments[nt];en[ct].fn.apply(en[ct].context,De)}}return!0},me.prototype.on=function(Oe,tt,Ye){return We(this,Oe,tt,Ye,!1)},me.prototype.once=function(Oe,tt,Ye){return We(this,Oe,tt,Ye,!0)},me.prototype.removeListener=function(Oe,tt,Ye,Vt){var Fn=Je?Je+Oe:Oe;if(!this._events[Fn])return this;if(!tt)return h(this,Fn),this;var pn=this._events[Fn];if(pn.fn)pn.fn===tt&&(!Vt||pn.once)&&(!Ye||pn.context===Ye)&&h(this,Fn);else{for(var vn=0,en=[],Yt=pn.length;vn<Yt;vn++)(pn[vn].fn!==tt||Vt&&!pn[vn].once||Ye&&pn[vn].context!==Ye)&&en.push(pn[vn]);en.length?this._events[Fn]=1===en.length?en[0]:en:h(this,Fn)}return this},me.prototype.removeAllListeners=function(Oe){var tt;return Oe?this._events[tt=Je?Je+Oe:Oe]&&h(this,tt):(this._events=new ht,this._eventsCount=0),this},me.prototype.off=me.prototype.removeListener,me.prototype.addListener=me.prototype.on,me.prefixed=Je,me.EventEmitter=me,bn.exports=me},725:(bn,fn,Je)=>{"use strict";var ht=Je(498),gt=Je(253),We=Je(160),h=Je(193),me=Je(981),Xe={},Oe=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];Xe.forwardGeocode=function(tt){gt.assertShape({query:gt.required(gt.string),mode:gt.oneOf("mapbox.places","mapbox.places-permanent"),countries:gt.arrayOf(gt.string),proximity:gt.oneOf(gt.coordinates,"ip"),types:gt.arrayOf(gt.oneOf(Oe)),autocomplete:gt.boolean,bbox:gt.arrayOf(gt.number),limit:gt.number,language:gt.arrayOf(gt.string),routing:gt.boolean,fuzzyMatch:gt.boolean,worldview:gt.string})(tt),tt.mode=tt.mode||"mapbox.places";var Ye=h(ht({country:tt.countries},We(tt,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:We(tt,["mode","query"]),query:Ye})},Xe.reverseGeocode=function(tt){gt.assertShape({query:gt.required(gt.coordinates),mode:gt.oneOf("mapbox.places","mapbox.places-permanent"),countries:gt.arrayOf(gt.string),types:gt.arrayOf(gt.oneOf(Oe)),bbox:gt.arrayOf(gt.number),limit:gt.number,language:gt.arrayOf(gt.string),reverseMode:gt.oneOf("distance","score"),routing:gt.boolean,worldview:gt.string})(tt),tt.mode=tt.mode||"mapbox.places";var Ye=h(ht({country:tt.countries},We(tt,["country","types","bbox","limit","language","reverseMode","routing","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:We(tt,["mode","query"]),query:Ye})},bn.exports=me(Xe)},981:(bn,fn,Je)=>{"use strict";var ht=Je(983),gt=Je(819);bn.exports=function We(h){return function(me){var Xe;Xe=ht.prototype.isPrototypeOf(me)?me:gt(me);var Oe=Object.create(h);return Oe.client=Xe,Oe}}},99:bn=>{"use strict";bn.exports=function fn(Je,ht){return Object.keys(Je).reduce(function(gt,We){return gt[We]=ht(We,Je[We]),gt},{})}},160:bn=>{"use strict";bn.exports=function fn(Je,ht){var gt=function(We,h){return-1!==ht.indexOf(We)&&void 0!==h};return"function"==typeof ht&&(gt=ht),Object.keys(Je).filter(function(We){return gt(We,Je[We])}).reduce(function(We,h){return We[h]=Je[h],We},{})}},193:(bn,fn,Je)=>{"use strict";var ht=Je(99);bn.exports=function gt(We){return ht(We,function(h,me){return"boolean"==typeof me?JSON.stringify(me):me})}},253:(bn,fn,Je)=>{"use strict";var ht=Je(498),gt=Je(406);bn.exports=ht(gt,{file:function We(Oe){return typeof window<"u"?Oe instanceof global.Blob||Oe instanceof global.ArrayBuffer?void 0:"Blob or ArrayBuffer":"string"!=typeof Oe&&void 0===Oe.pipe?"Filename or Readable stream":void 0},date:function me(Oe){var tt="date";if("boolean"==typeof Oe)return tt;try{var Ye=new Date(Oe);if(Ye.getTime&&isNaN(Ye.getTime()))return tt}catch{return tt}},coordinates:function Xe(Oe){return gt.tuple(gt.number,gt.number)(Oe)},assertShape:function h(Oe,tt){return gt.assert(gt.strictShape(Oe),tt)}})},746:(bn,fn,Je)=>{"use strict";var ht=Je(391),gt={};function me(Xe,Oe){return Object.prototype.hasOwnProperty.call(Xe,Oe)}bn.exports=function We(Xe){if(gt[Xe])return gt[Xe];var Oe=Xe.split("."),tt=Oe[0],Ye=Oe[1];if(!Ye)throw new Error("Invalid token");var Vt=function h(Xe){try{return JSON.parse(ht.decode(Xe))}catch{throw new Error("Invalid token")}}(Ye),Fn={usage:tt,user:Vt.u};return me(Vt,"a")&&(Fn.authorization=Vt.a),me(Vt,"exp")&&(Fn.expires=1e3*Vt.exp),me(Vt,"iat")&&(Fn.created=1e3*Vt.iat),me(Vt,"scopes")&&(Fn.scopes=Vt.scopes),me(Vt,"client")&&(Fn.client=Vt.client),me(Vt,"ll")&&(Fn.lastLogin=Vt.ll),me(Vt,"iu")&&(Fn.impersonator=Vt.iu),gt[Xe]=Fn,Fn}},242:(bn,fn,Je)=>{"use strict";function ht(e){return"function"==typeof e}function gt(e){const r=e(n=>{Error.call(n),n.stack=(new Error).stack});return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}const We=gt(e=>function(r){e(this),this.message=r?`${r.length} errors occurred during unsubscription:\n${r.map((n,s)=>`${s+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=r});function h(e,t){if(e){const r=e.indexOf(t);0<=r&&e.splice(r,1)}}class me{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:r}=this;if(r)if(this._parentage=null,Array.isArray(r))for(const u of r)u.remove(this);else r.remove(this);const{initialTeardown:n}=this;if(ht(n))try{n()}catch(u){t=u instanceof We?u.errors:[u]}const{_finalizers:s}=this;if(s){this._finalizers=null;for(const u of s)try{tt(u)}catch(m){t=t??[],m instanceof We?t=[...t,...m.errors]:t.push(m)}}if(t)throw new We(t)}}add(t){var r;if(t&&t!==this)if(this.closed)tt(t);else{if(t instanceof me){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}}_hasParent(t){const{_parentage:r}=this;return r===t||Array.isArray(r)&&r.includes(t)}_addParent(t){const{_parentage:r}=this;this._parentage=Array.isArray(r)?(r.push(t),r):r?[r,t]:t}_removeParent(t){const{_parentage:r}=this;r===t?this._parentage=null:Array.isArray(r)&&h(r,t)}remove(t){const{_finalizers:r}=this;r&&h(r,t),t instanceof me&&t._removeParent(this)}}me.EMPTY=(()=>{const e=new me;return e.closed=!0,e})();const Xe=me.EMPTY;function Oe(e){return e instanceof me||e&&"closed"in e&&ht(e.remove)&&ht(e.add)&&ht(e.unsubscribe)}function tt(e){ht(e)?e():e.unsubscribe()}const Ye={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Vt={setTimeout(e,t,...r){const{delegate:n}=Vt;return n?.setTimeout?n.setTimeout(e,t,...r):setTimeout(e,t,...r)},clearTimeout(e){const{delegate:t}=Vt;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function Fn(e){Vt.setTimeout(()=>{const{onUnhandledError:t}=Ye;if(!t)throw e;t(e)})}function pn(){}const vn=De("C",void 0,void 0);function De(e,t,r){return{kind:e,value:t,error:r}}let ct=null;function qt(e){if(Ye.useDeprecatedSynchronousErrorHandling){const t=!ct;if(t&&(ct={errorThrown:!1,error:null}),e(),t){const{errorThrown:r,error:n}=ct;if(ct=null,r)throw n}}else e()}class Ge extends me{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,Oe(t)&&t.add(this)):this.destination=To}static create(t,r,n){return new xn(t,r,n)}next(t){this.isStopped?mr(function Yt(e){return De("N",e,void 0)}(t),this):this._next(t)}error(t){this.isStopped?mr(function en(e){return De("E",void 0,e)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?mr(vn,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Ct=Function.prototype.bind;function Le(e,t){return Ct.call(e,t)}class Qt{constructor(t){this.partialObserver=t}next(t){const{partialObserver:r}=this;if(r.next)try{r.next(t)}catch(n){Et(n)}}error(t){const{partialObserver:r}=this;if(r.error)try{r.error(t)}catch(n){Et(n)}else Et(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(r){Et(r)}}}class xn extends Ge{constructor(t,r,n){let s;if(super(),ht(t)||!t)s={next:t??void 0,error:r??void 0,complete:n??void 0};else{let u;this&&Ye.useDeprecatedNextContext?(u=Object.create(t),u.unsubscribe=()=>this.unsubscribe(),s={next:t.next&&Le(t.next,u),error:t.error&&Le(t.error,u),complete:t.complete&&Le(t.complete,u)}):s=t}this.destination=new Qt(s)}}function Et(e){Ye.useDeprecatedSynchronousErrorHandling?function nt(e){Ye.useDeprecatedSynchronousErrorHandling&&ct&&(ct.errorThrown=!0,ct.error=e)}(e):Fn(e)}function mr(e,t){const{onStoppedNotification:r}=Ye;r&&Vt.setTimeout(()=>r(e,t))}const To={closed:!0,next:pn,error:function Si(e){throw e},complete:pn},Uo="function"==typeof Symbol&&Symbol.observable||"@@observable";function ts(e){return e}function Is(e){return 0===e.length?ts:1===e.length?e[0]:function(r){return e.reduce((n,s)=>s(n),r)}}let wn=(()=>{class e{constructor(r){r&&(this._subscribe=r)}lift(r){const n=new e;return n.source=this,n.operator=r,n}subscribe(r,n,s){const u=function Gr(e){return e&&e instanceof Ge||function Va(e){return e&&ht(e.next)&&ht(e.error)&&ht(e.complete)}(e)&&Oe(e)}(r)?r:new xn(r,n,s);return qt(()=>{const{operator:m,source:b}=this;u.add(m?m.call(u,b):b?this._subscribe(u):this._trySubscribe(u))}),u}_trySubscribe(r){try{return this._subscribe(r)}catch(n){r.error(n)}}forEach(r,n){return new(n=Ho(n))((s,u)=>{const m=new xn({next:b=>{try{r(b)}catch(T){u(T),m.unsubscribe()}},error:u,complete:s});this.subscribe(m)})}_subscribe(r){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(r)}[Uo](){return this}pipe(...r){return Is(r)(this)}toPromise(r){return new(r=Ho(r))((n,s)=>{let u;this.subscribe(m=>u=m,m=>s(m),()=>n(u))})}}return e.create=t=>new e(t),e})();function Ho(e){var t;return null!==(t=e??Ye.Promise)&&void 0!==t?t:Promise}const ja=gt(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let qe=(()=>{class e extends wn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(r){const n=new ua(this,this);return n.operator=r,n}_throwIfClosed(){if(this.closed)throw new ja}next(r){qt(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(r)}})}error(r){qt(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=r;const{observers:n}=this;for(;n.length;)n.shift().error(r)}})}complete(){qt(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:r}=this;for(;r.length;)r.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var r;return(null===(r=this.observers)||void 0===r?void 0:r.length)>0}_trySubscribe(r){return this._throwIfClosed(),super._trySubscribe(r)}_subscribe(r){return this._throwIfClosed(),this._checkFinalizedStatuses(r),this._innerSubscribe(r)}_innerSubscribe(r){const{hasError:n,isStopped:s,observers:u}=this;return n||s?Xe:(this.currentObservers=null,u.push(r),new me(()=>{this.currentObservers=null,h(u,r)}))}_checkFinalizedStatuses(r){const{hasError:n,thrownError:s,isStopped:u}=this;n?r.error(s):u&&r.complete()}asObservable(){const r=new wn;return r.source=this,r}}return e.create=(t,r)=>new ua(t,r),e})();class ua extends qe{constructor(t,r){super(),this.destination=t,this.source=r}next(t){var r,n;null===(n=null===(r=this.destination)||void 0===r?void 0:r.next)||void 0===n||n.call(r,t)}error(t){var r,n;null===(n=null===(r=this.destination)||void 0===r?void 0:r.error)||void 0===n||n.call(r,t)}complete(){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===r||r.call(t)}_subscribe(t){var r,n;return null!==(n=null===(r=this.source)||void 0===r?void 0:r.subscribe(t))&&void 0!==n?n:Xe}}function ys(e){return ht(e?.lift)}function ur(e){return t=>{if(ys(t))return t.lift(function(r){try{return e(r,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function ai(e,t,r,n,s){return new gr(e,t,r,n,s)}class gr extends Ge{constructor(t,r,n,s,u,m){super(t),this.onFinalize=u,this.shouldUnsubscribe=m,this._next=r?function(b){try{r(b)}catch(T){t.error(T)}}:super._next,this._error=s?function(b){try{s(b)}catch(T){t.error(T)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(b){t.error(b)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:r}=this;super.unsubscribe(),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function ii(e,t){return ur((r,n)=>{let s=0;r.subscribe(ai(n,u=>{n.next(e.call(t,u,s++))}))})}function Mi(e){return this instanceof Mi?(this.v=e,this):new Mi(e)}function qr(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,t=e[Symbol.asyncIterator];return t?t.call(e):(e=function Vn(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(u){r[u]=e[u]&&function(m){return new Promise(function(b,T){!function s(u,m,b,T){Promise.resolve(T).then(function(R){u({value:R,done:b})},m)}(b,T,(m=e[u](m)).done,m.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const Mt=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function Wt(e){return ht(e?.then)}function Zt(e){return ht(e[Uo])}function jt(e){return Symbol.asyncIterator&&ht(e?.[Symbol.asyncIterator])}function Ft(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Un=function Rt(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function xi(e){return ht(e?.[Un])}function tn(e){return function Xi(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,n=r.apply(e,t||[]),u=[];return s={},m("next"),m("throw"),m("return"),s[Symbol.asyncIterator]=function(){return this},s;function m(le){n[le]&&(s[le]=function(he){return new Promise(function(Me,Ve){u.push([le,he,Me,Ve])>1||b(le,he)})})}function b(le,he){try{!function T(le){le.value instanceof Mi?Promise.resolve(le.value.v).then(R,z):W(u[0][2],le)}(n[le](he))}catch(Me){W(u[0][3],Me)}}function R(le){b("next",le)}function z(le){b("throw",le)}function W(le,he){le(he),u.shift(),u.length&&b(u[0][0],u[0][1])}}(this,arguments,function*(){const r=e.getReader();try{for(;;){const{value:n,done:s}=yield Mi(r.read());if(s)return yield Mi(void 0);yield yield Mi(n)}}finally{r.releaseLock()}})}function ni(e){return ht(e?.getReader)}function Ai(e){if(e instanceof wn)return e;if(null!=e){if(Zt(e))return function Ir(e){return new wn(t=>{const r=e[Uo]();if(ht(r.subscribe))return r.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(Mt(e))return function xr(e){return new wn(t=>{for(let r=0;r<e.length&&!t.closed;r++)t.next(e[r]);t.complete()})}(e);if(Wt(e))return function dr(e){return new wn(t=>{e.then(r=>{t.closed||(t.next(r),t.complete())},r=>t.error(r)).then(null,Fn)})}(e);if(jt(e))return ls(e);if(xi(e))return function bs(e){return new wn(t=>{for(const r of e)if(t.next(r),t.closed)return;t.complete()})}(e);if(ni(e))return function cs(e){return ls(tn(e))}(e)}throw Ft(e)}function ls(e){return new wn(t=>{(function Co(e,t){var r,n,s,u;return function cn(e,t,r,n){return new(r||(r=Promise))(function(u,m){function b(z){try{R(n.next(z))}catch(W){m(W)}}function T(z){try{R(n.throw(z))}catch(W){m(W)}}function R(z){z.done?u(z.value):function s(u){return u instanceof r?u:new r(function(m){m(u)})}(z.value).then(b,T)}R((n=n.apply(e,t||[])).next())})}(this,void 0,void 0,function*(){try{for(r=qr(e);!(n=yield r.next()).done;)if(t.next(n.value),t.closed)return}catch(m){s={error:m}}finally{try{n&&!n.done&&(u=r.return)&&(yield u.call(r))}finally{if(s)throw s.error}}t.complete()})})(e,t).catch(r=>t.error(r))})}function eo(e,t,r,n=0,s=!1){const u=t.schedule(function(){r(),s?e.add(this.schedule(null,n)):this.unsubscribe()},n);if(e.add(u),!s)return u}function Wr(e,t,r=1/0){return ht(t)?Wr((n,s)=>ii((u,m)=>t(n,u,s,m))(Ai(e(n,s))),r):("number"==typeof t&&(r=t),ur((n,s)=>function fa(e,t,r,n,s,u,m,b){const T=[];let R=0,z=0,W=!1;const le=()=>{W&&!T.length&&!R&&t.complete()},he=Ve=>R<n?Me(Ve):T.push(Ve),Me=Ve=>{u&&t.next(Ve),R++;let at=!1;Ai(r(Ve,z++)).subscribe(ai(t,wt=>{s?.(wt),u?he(wt):t.next(wt)},()=>{at=!0},void 0,()=>{if(at)try{for(R--;T.length&&R<n;){const wt=T.shift();m?eo(t,m,()=>Me(wt)):Me(wt)}le()}catch(wt){t.error(wt)}}))};return e.subscribe(ai(t,he,()=>{W=!0,le()})),()=>{b?.()}}(n,s,e,r)))}function _l(e=1/0){return Wr(ts,e)}const Eo=new wn(e=>e.complete());function Oc(e){return e&&ht(e.schedule)}function Ua(e){return e[e.length-1]}function yh(e){return ht(Ua(e))?e.pop():void 0}function uo(e){return Oc(Ua(e))?e.pop():void 0}function yl(e,t=0){return ur((r,n)=>{r.subscribe(ai(n,s=>eo(n,e,()=>n.next(s),t),()=>eo(n,e,()=>n.complete(),t),s=>eo(n,e,()=>n.error(s),t)))})}function Ao(e,t=0){return ur((r,n)=>{n.add(e.schedule(()=>r.subscribe(n),t))})}function Ys(e,t){if(!e)throw new Error("Iterable cannot be null");return new wn(r=>{eo(r,t,()=>{const n=e[Symbol.asyncIterator]();eo(r,t,()=>{n.next().then(s=>{s.done?r.complete():r.next(s.value)})},0,!0)})})}function wr(e,t){return t?function Zr(e,t){if(null!=e){if(Zt(e))return function Xl(e,t){return Ai(e).pipe(Ao(t),yl(t))}(e,t);if(Mt(e))return function He(e,t){return new wn(r=>{let n=0;return t.schedule(function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())})})}(e,t);if(Wt(e))return function pa(e,t){return Ai(e).pipe(Ao(t),yl(t))}(e,t);if(jt(e))return Ys(e,t);if(xi(e))return function sn(e,t){return new wn(r=>{let n;return eo(r,t,()=>{n=e[Un](),eo(r,t,()=>{let s,u;try{({value:s,done:u}=n.next())}catch(m){return void r.error(m)}u?r.complete():r.next(s)},0,!0)}),()=>ht(n?.return)&&n.return()})}(e,t);if(ni(e))return function Xs(e,t){return Ys(tn(e),t)}(e,t)}throw Ft(e)}(e,t):Ai(e)}function vh(...e){const t=uo(e),r=function ud(e,t){return"number"==typeof Ua(e)?e.pop():t}(e,1/0),n=e;return n.length?1===n.length?Ai(n[0]):_l(r)(wr(n,t)):Eo}class ui extends qe{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const r=super._subscribe(t);return!r.closed&&t.next(this._value),r}getValue(){const{hasError:t,thrownError:r,_value:n}=this;if(t)throw r;return this._throwIfClosed(),n}next(t){super.next(this._value=t)}}function Gn(...e){return wr(e,uo(e))}function bh(e={}){const{connector:t=(()=>new qe),resetOnError:r=!0,resetOnComplete:n=!0,resetOnRefCountZero:s=!0}=e;return u=>{let m,b,T,R=0,z=!1,W=!1;const le=()=>{b?.unsubscribe(),b=void 0},he=()=>{le(),m=T=void 0,z=W=!1},Me=()=>{const Ve=m;he(),Ve?.unsubscribe()};return ur((Ve,at)=>{R++,!W&&!z&&le();const wt=T=T??t();at.add(()=>{R--,0===R&&!W&&!z&&(b=Ha(Me,s))}),wt.subscribe(at),!m&&R>0&&(m=new xn({next:ft=>wt.next(ft),error:ft=>{W=!0,le(),b=Ha(he,r,ft),wt.error(ft)},complete:()=>{z=!0,le(),b=Ha(he,n),wt.complete()}}),Ai(Ve).subscribe(m))})(u)}}function Ha(e,t,...r){if(!0===t)return void e();if(!1===t)return;const n=new xn({next:()=>{n.unsubscribe(),e()}});return Ai(t(...r)).subscribe(n)}function pt(e,t){return ur((r,n)=>{let s=null,u=0,m=!1;const b=()=>m&&!s&&n.complete();r.subscribe(ai(n,T=>{s?.unsubscribe();let R=0;const z=u++;Ai(e(T,z)).subscribe(s=ai(n,W=>n.next(t?t(T,W,z,R++):W),()=>{s=null,b()}))},()=>{m=!0,b()}))})}function hi(e,t=ts){return e=e??Di,ur((r,n)=>{let s,u=!0;r.subscribe(ai(n,m=>{const b=t(m);(u||!e(s,b))&&(u=!1,s=b,n.next(m))}))})}function Di(e,t){return e===t}function Ii(e){for(let t in e)if(e[t]===Ii)return t;throw Error("Could not find renamed property on target object.")}function xs(e,t){for(const r in t)t.hasOwnProperty(r)&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function jn(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(jn).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const r=t.indexOf("\n");return-1===r?t:t.substring(0,r)}function ks(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const _r=Ii({__forward_ref__:Ii});function Ki(e){return e.__forward_ref__=Ki,e.toString=function(){return jn(this())},e}function $n(e){return Qi(e)?e():e}function Qi(e){return"function"==typeof e&&e.hasOwnProperty(_r)&&e.__forward_ref__===Ki}function dd(e){return e&&!!e.\u0275providers}const hd="https://g.co/ng/security#xss";class yt extends Error{constructor(t,r){super(function vl(e,t){return`NG0${Math.abs(e)}${t?": "+t:""}`}(t,r)),this.code=t}}function li(e){return"string"==typeof e?e:null==e?"":String(e)}function Oo(e,t){throw new yt(-201,!1)}function us(e,t){null==e&&function Zn(e,t,r,n){throw new Error(`ASSERTION ERROR: ${e}`+(null==n?"":` [Expected=> ${r} ${n} ${t} <=Actual]`))}(t,e,null,"!=")}function Ut(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Oi(e){return{providers:e.providers||[],imports:e.imports||[]}}function Lc(e){return Ga(e,xl)||Ga(e,Dh)}function Ga(e,t){return e.hasOwnProperty(t)?e[t]:null}function ds(e){return e&&(e.hasOwnProperty(xu)||e.hasOwnProperty(_d))?e[xu]:null}const xl=Ii({\u0275prov:Ii}),xu=Ii({\u0275inj:Ii}),Dh=Ii({ngInjectableDef:Ii}),_d=Ii({ngInjectorDef:Ii});var ri=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}(ri||{});let ma;function ho(e){const t=ma;return ma=e,t}function yd(e,t,r){const n=Lc(e);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:r&ri.Optional?null:void 0!==t?t:void Oo(jn(e))}const In=globalThis,Jl={},Bc="__NG_DI_FLAG__",ec="ngTempTokenPath",Ah=/\n/gm,tc="__source";let nc;function $o(e){const t=nc;return nc=e,t}function Du(e,t=ri.Default){if(void 0===nc)throw new yt(-203,!1);return null===nc?yd(e,void 0,t):nc.get(e,t&ri.Optional?null:void 0,t)}function ze(e,t=ri.Default){return(function Th(){return ma}()||Du)($n(e),t)}function Jt(e,t=ri.Default){return ze(e,rc(t))}function rc(e){return typeof e>"u"||"number"==typeof e?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function Tu(e){const t=[];for(let r=0;r<e.length;r++){const n=$n(e[r]);if(Array.isArray(n)){if(0===n.length)throw new yt(900,!1);let s,u=ri.Default;for(let m=0;m<n.length;m++){const b=n[m],T=Ih(b);"number"==typeof T?-1===T?s=b.token:u|=T:s=b}t.push(ze(s,u))}else t.push(ze(n))}return t}function ga(e,t){return e[Bc]=t,e.prototype[Bc]=t,e}function Ih(e){return e[Bc]}function _a(e){return{toString:e}.toString()}var zc=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(zc||{}),ws=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(ws||{});const Rs={},ir=[],Cl=Ii({\u0275cmp:Ii}),wd=Ii({\u0275dir:Ii}),Wa=Ii({\u0275pipe:Ii}),Su=Ii({\u0275mod:Ii}),Cs=Ii({\u0275fac:Ii}),El=Ii({__NG_ELEMENT_ID__:Ii}),oc=Ii({__NG_ENV_ID__:Ii});function Mu(e,t,r){let n=e.length;for(;;){const s=e.indexOf(t,r);if(-1===s)return s;if(0===s||e.charCodeAt(s-1)<=32){const u=t.length;if(s+u===n||e.charCodeAt(s+u)<=32)return s}r=s+1}}function Za(e,t,r){let n=0;for(;n<r.length;){const s=r[n];if("number"==typeof s){if(0!==s)break;n++;const u=r[n++],m=r[n++],b=r[n++];e.setAttribute(t,m,b,u)}else{const u=s,m=r[++n];Vc(u)?e.setProperty(t,u,m):e.setAttribute(t,u,m),n++}}return n}function Do(e){return 3===e||4===e||6===e}function Vc(e){return 64===e.charCodeAt(0)}function Ks(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let r=-1;for(let n=0;n<t.length;n++){const s=t[n];"number"==typeof s?r=s:0===r||Au(e,r,s,null,-1===r||2===r?t[++n]:null)}}return e}function Au(e,t,r,n,s){let u=0,m=e.length;if(-1===t)m=-1;else for(;u<e.length;){const b=e[u++];if("number"==typeof b){if(b===t){m=-1;break}if(b>t){m=u-1;break}}}for(;u<e.length;){const b=e[u];if("number"==typeof b)break;if(b===r){if(null===n)return void(null!==s&&(e[u+1]=s));if(n===e[u+1])return void(e[u+2]=s)}u++,null!==n&&u++,null!==s&&u++}-1!==m&&(e.splice(m,0,t),u=m+1),e.splice(u++,0,r),null!==n&&e.splice(u++,0,n),null!==s&&e.splice(u++,0,s)}const Cd="ng-template";function jc(e,t,r){let n=0,s=!0;for(;n<e.length;){let u=e[n++];if("string"==typeof u&&s){const m=e[n++];if(r&&"class"===u&&-1!==Mu(m.toLowerCase(),t,0))return!0}else{if(1===u){for(;n<e.length&&"string"==typeof(u=e[n++]);)if(u.toLowerCase()===t)return!0;return!1}"number"==typeof u&&(s=!1)}}return!1}function Iu(e){return 4===e.type&&e.value!==Cd}function Ed(e,t,r){return t===(4!==e.type||r?e.value:Cd)}function ku(e,t,r){let n=4;const s=e.attrs||[],u=function Ru(e){for(let t=0;t<e.length;t++)if(Do(e[t]))return t;return e.length}(s);let m=!1;for(let b=0;b<t.length;b++){const T=t[b];if("number"!=typeof T){if(!m)if(4&n){if(n=2|1&n,""!==T&&!Ed(e,T,r)||""===T&&1===t.length){if(rs(n))return!1;m=!0}}else{const R=8&n?T:t[++b];if(8&n&&null!==e.attrs){if(!jc(e.attrs,R,r)){if(rs(n))return!1;m=!0}continue}const W=kh(8&n?"class":T,s,Iu(e),r);if(-1===W){if(rs(n))return!1;m=!0;continue}if(""!==R){let le;le=W>u?"":s[W+1].toLowerCase();const he=8&n?le:null;if(he&&-1!==Mu(he,R,0)||2&n&&R!==le){if(rs(n))return!1;m=!0}}}}else{if(!m&&!rs(n)&&!rs(T))return!1;if(m&&rs(T))continue;m=!1,n=T|1&n}}return rs(n)||m}function rs(e){return 0==(1&e)}function kh(e,t,r,n){if(null===t)return-1;let s=0;if(n||!r){let u=!1;for(;s<t.length;){const m=t[s];if(m===e)return s;if(3===m||6===m)u=!0;else{if(1===m||2===m){let b=t[++s];for(;"string"==typeof b;)b=t[++s];continue}if(4===m)break;if(0===m){s+=4;continue}}s+=u?1:2}return-1}return function Dl(e,t){let r=e.indexOf(4);if(r>-1)for(r++;r<e.length;){const n=e[r];if("number"==typeof n)return-1;if(n===t)return r;r++}return-1}(t,e)}function oi(e,t,r=!1){for(let n=0;n<t.length;n++)if(ku(e,t[n],r))return!0;return!1}function sc(e,t){e:for(let r=0;r<t.length;r++){const n=t[r];if(e.length===n.length){for(let s=0;s<e.length;s++)if(e[s]!==n[s])continue e;return!0}}return!1}function Rh(e,t){return e?":not("+t.trim()+")":t}function Uc(e){let t=e[0],r=1,n=2,s="",u=!1;for(;r<e.length;){let m=e[r];if("string"==typeof m)if(2&n){const b=e[++r];s+="["+m+(b.length>0?'="'+b+'"':"")+"]"}else 8&n?s+="."+m:4&n&&(s+=" "+m);else""!==s&&!rs(m)&&(t+=Rh(u,s),s=""),n=m,u=u||!rs(n);r++}return""!==s&&(t+=Rh(u,s)),t}function Ci(e){return _a(()=>{const t=Ps(e),r={...t,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===zc.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&e.dependencies||null,getStandaloneInjector:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||ws.Emulated,styles:e.styles||ir,_:null,schemas:e.schemas||null,tView:null,id:""};ya(r);const n=e.dependencies;return r.directiveDefs=Pu(n,!1),r.pipeDefs=Pu(n,!0),r.id=function Xf(e){let t=0;const r=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery].join("|");for(const s of r)t=Math.imul(31,t)+s.charCodeAt(0)<<0;return t+=2147483648,"c"+t}(r),r})}function Ph(e){return Fi(e)||kr(e)}function Oh(e){return null!==e}function Ji(e){return _a(()=>({type:e.type,bootstrap:e.bootstrap||ir,declarations:e.declarations||ir,imports:e.imports||ir,exports:e.exports||ir,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function Fh(e,t){if(null==e)return Rs;const r={};for(const n in e)if(e.hasOwnProperty(n)){let s=e[n],u=s;Array.isArray(s)&&(u=s[1],s=s[0]),r[s]=n,t&&(t[s]=u)}return r}function Bn(e){return _a(()=>{const t=Ps(e);return ya(t),t})}function vo(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,standalone:!0===e.standalone,onDestroy:e.type.prototype.ngOnDestroy||null}}function Fi(e){return e[Cl]||null}function kr(e){return e[wd]||null}function Go(e){return e[Wa]||null}function to(e,t){const r=e[Su]||null;if(!r&&!0===t)throw new Error(`Type ${jn(e)} does not have '\u0275mod' property.`);return r}function Ps(e){const t={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputTransforms:null,inputConfig:e.inputs||Rs,exportAs:e.exportAs||null,standalone:!0===e.standalone,signals:!0===e.signals,selectors:e.selectors||ir,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Fh(e.inputs,t),outputs:Fh(e.outputs)}}function ya(e){e.features?.forEach(t=>t(e))}function Pu(e,t){if(!e)return null;const r=t?Go:Ph;return()=>("function"==typeof e?e():e).map(n=>r(n)).filter(Oh)}const Vr=0,kn=1,yi=2,Rr=3,Fo=4,Hc=5,Pr=6,ac=7,sr=8,Tl=9,va=10,wi=11,$c=12,Sd=13,Qs=14,no=15,lc=16,qo=17,Es=18,Ui=19,Kf=20,ba=21,Js=22,Xa=23,cc=24,Li=25,Ou=1,Ka=2,hs=7,L=9,X=11;function _t(e){return Array.isArray(e)&&"object"==typeof e[Ou]}function yn(e){return Array.isArray(e)&&!0===e[Ou]}function fi(e){return 0!=(4&e.flags)}function pi(e){return e.componentOffset>-1}function Cr(e){return 1==(1&e.flags)}function Lo(e){return!!e.template}function Md(e){return 0!=(512&e[yi])}function Sl(e,t){return e.hasOwnProperty(Cs)?e[Cs]:null}let io=null,sp=!1;function xa(e){const t=io;return io=e,t}const Nh={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function zh(e){if(!Ml(e)||e.dirty){if(!e.producerMustRecompute(e)&&!Lm(e))return void(e.dirty=!1);e.producerRecomputeValue(e),e.dirty=!1}}function Vh(e){e.dirty=!0,function Fm(e){if(void 0===e.liveConsumerNode)return;const t=sp;sp=!0;try{for(const r of e.liveConsumerNode)r.dirty||Vh(r)}finally{sp=t}}(e),e.consumerMarkedDirty?.(e)}function kd(e){return e&&(e.nextProducerIndex=0),xa(e)}function jh(e,t){if(xa(t),e&&void 0!==e.producerNode&&void 0!==e.producerIndexOfThis&&void 0!==e.producerLastReadVersion){if(Ml(e))for(let r=e.nextProducerIndex;r<e.producerNode.length;r++)Uh(e.producerNode[r],e.producerIndexOfThis[r]);for(let r=e.nextProducerIndex;r<e.producerNode.length;r++)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}function Lm(e){Al(e);for(let t=0;t<e.producerNode.length;t++){const r=e.producerNode[t],n=e.producerLastReadVersion[t];if(n!==r.version||(zh(r),n!==r.version))return!0}return!1}function Nm(e){if(Al(e),Ml(e))for(let t=0;t<e.producerNode.length;t++)Uh(e.producerNode[t],e.producerIndexOfThis[t]);e.producerNode.length=e.producerLastReadVersion.length=e.producerIndexOfThis.length=0,e.liveConsumerNode&&(e.liveConsumerNode.length=e.liveConsumerIndexOfThis.length=0)}function Uh(e,t){if(function Bm(e){e.liveConsumerNode??=[],e.liveConsumerIndexOfThis??=[]}(e),Al(e),1===e.liveConsumerNode.length)for(let n=0;n<e.producerNode.length;n++)Uh(e.producerNode[n],e.producerIndexOfThis[n]);const r=e.liveConsumerNode.length-1;if(e.liveConsumerNode[t]=e.liveConsumerNode[r],e.liveConsumerIndexOfThis[t]=e.liveConsumerIndexOfThis[r],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,t<e.liveConsumerNode.length){const n=e.liveConsumerIndexOfThis[t],s=e.liveConsumerNode[t];Al(s),s.producerIndexOfThis[n]=t}}function Ml(e){return e.consumerIsAlwaysLive||(e?.liveConsumerNode?.length??0)>0}function Al(e){e.producerNode??=[],e.producerIndexOfThis??=[],e.producerLastReadVersion??=[]}let $h=null;const rn=()=>{},_={...Nh,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:e=>{e.schedule(e.ref)},hasRun:!1,cleanupFn:rn};class f{constructor(t,r,n){this.previousValue=t,this.currentValue=r,this.firstChange=n}isFirstChange(){return this.firstChange}}function v(){return w}function w(e){return e.type.prototype.ngOnChanges&&(e.setInput=S),E}function E(){const e=O(this),t=e?.current;if(t){const r=e.previous;if(r===Rs)e.previous=t;else for(let n in t)r[n]=t[n];e.current=null,this.ngOnChanges(t)}}function S(e,t,r,n){const s=this.declaredInputs[r],u=O(e)||function N(e,t){return e[I]=t}(e,{previous:Rs,current:null}),m=u.current||(u.current={}),b=u.previous,T=b[s];m[s]=new f(T&&T.currentValue,t,b===Rs),e[n]=t}v.ngInherit=!0;const I="__ngSimpleChanges__";function O(e){return e[I]||null}const G=function(e,t,r){};function K(e){for(;Array.isArray(e);)e=e[Vr];return e}function J(e,t){return K(t[e])}function oe(e,t){return K(t[e.index])}function ye(e,t){return e.data[t]}function re(e,t){return e[t]}function ae(e,t){const r=t[e];return _t(r)?r:r[Vr]}function ke(e,t){return null==t?null:e[t]}function lt(e){e[qo]=0}function $e(e){1024&e[yi]||(e[yi]|=1024,Fe(e,1))}function Qe(e){1024&e[yi]&&(e[yi]&=-1025,Fe(e,-1))}function Fe(e,t){let r=e[Rr];if(null===r)return;r[Hc]+=t;let n=r;for(r=r[Rr];null!==r&&(1===t&&1===n[Hc]||-1===t&&0===n[Hc]);)r[Hc]+=t,n=r,r=r[Rr]}const Ue={lFrame:L_(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Xt(){return Ue.bindingsEnabled}function mn(){return null!==Ue.skipHydrationRootTNode}function mt(){return Ue.lFrame.lView}function un(){return Ue.lFrame.tView}function Mn(e){return Ue.lFrame.contextLView=e,e[sr]}function Cn(e){return Ue.lFrame.contextLView=null,e}function hr(){let e=na();for(;null!==e&&64===e.type;)e=e.parent;return e}function na(){return Ue.lFrame.currentTNode}function ci(e,t){const r=Ue.lFrame;r.currentTNode=e,r.isParent=t}function Ni(){return Ue.lFrame.isParent}function fr(){Ue.lFrame.isParent=!1}function Er(){const e=Ue.lFrame;let t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function Os(){return Ue.lFrame.bindingIndex++}function Bo(e){const t=Ue.lFrame,r=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,r}function kl(e,t){const r=Ue.lFrame;r.bindingIndex=r.bindingRootIndex=e,Nu(t)}function Nu(e){Ue.lFrame.currentDirectiveIndex=e}function jm(e){const t=Ue.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}function F_(){return Ue.lFrame.currentQueryIndex}function Gh(e){Ue.lFrame.currentQueryIndex=e}function qh(e){const t=e[kn];return 2===t.type?t.declTNode:1===t.type?e[Pr]:null}function dp(e,t,r){if(r&ri.SkipSelf){let s=t,u=e;for(;!(s=s.parent,null!==s||r&ri.Host||(s=qh(u),null===s||(u=u[Qs],10&s.type))););if(null===s)return!1;t=s,e=u}const n=Ue.lFrame=Hm();return n.currentTNode=t,n.lView=e,!0}function Um(e){const t=Hm(),r=e[kn];Ue.lFrame=t,t.currentTNode=r.firstChild,t.lView=e,t.tView=r,t.contextLView=e,t.bindingIndex=r.bindingStartIndex,t.inI18n=!1}function Hm(){const e=Ue.lFrame,t=null===e?null:e.child;return null===t?L_(e):t}function L_(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function Hv(){const e=Ue.lFrame;return Ue.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const N_=Hv;function B_(){const e=Hv();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function Fs(){return Ue.lFrame.selectedIndex}function Od(e){Ue.lFrame.selectedIndex=e}function bo(){const e=Ue.lFrame;return ye(e.tView,e.selectedIndex)}let Dr=!0;function $m(){return Dr}function Fd(e){Dr=e}function Wh(e,t){for(let r=t.directiveStart,n=t.directiveEnd;r<n;r++){const u=e.data[r].type.prototype,{ngAfterContentInit:m,ngAfterContentChecked:b,ngAfterViewInit:T,ngAfterViewChecked:R,ngOnDestroy:z}=u;m&&(e.contentHooks??=[]).push(-r,m),b&&((e.contentHooks??=[]).push(r,b),(e.contentCheckHooks??=[]).push(r,b)),T&&(e.viewHooks??=[]).push(-r,T),R&&((e.viewHooks??=[]).push(r,R),(e.viewCheckHooks??=[]).push(r,R)),null!=z&&(e.destroyHooks??=[]).push(r,z)}}function Gm(e,t,r){$v(e,t,3,r)}function j_(e,t,r,n){(3&e[yi])===r&&$v(e,t,r,n)}function U_(e,t){let r=e[yi];(3&r)===t&&(r&=8191,r+=1,e[yi]=r)}function $v(e,t,r,n){const u=n??-1,m=t.length-1;let b=0;for(let T=void 0!==n?65535&e[qo]:0;T<m;T++)if("number"==typeof t[T+1]){if(b=t[T],null!=n&&b>=n)break}else t[T]<0&&(e[qo]+=65536),(b<u||-1==u)&&(Gv(e,r,t,T),e[qo]=(4294901760&e[qo])+T+2),T++}function E1(e,t){G(4,e,t);const r=xa(null);try{t.call(e)}finally{xa(r),G(5,e,t)}}function Gv(e,t,r,n){const s=r[n]<0,u=r[n+1],b=e[s?-r[n]:r[n]];s?e[yi]>>13<e[qo]>>16&&(3&e[yi])===t&&(e[yi]+=8192,E1(b,u)):E1(b,u)}const qc=-1;class hp{constructor(t,r,n){this.factory=t,this.resolving=!1,this.canSeeViewProviders=r,this.injectImpl=n}}function H_(e){return e!==qc}function qm(e){return 32767&e}function Zm(e,t){let r=function Wm(e){return e>>16}(e),n=t;for(;r>0;)n=n[Qs],r--;return n}let Yv=!0;function fp(e){const t=Yv;return Yv=e,t}const pp=255,Yh=5;let Bu=0;const Zo={};function Wc(e,t){const r=S1(e,t);if(-1!==r)return r;const n=t[kn];n.firstCreatePass&&(e.injectorIndex=t.length,Zc(n.data,e),Zc(t,null),Zc(n.blueprint,null));const s=$_(e,t),u=e.injectorIndex;if(H_(s)){const m=qm(s),b=Zm(s,t),T=b[kn].data;for(let R=0;R<8;R++)t[u+R]=b[m+R]|T[m+R]}return t[u+8]=s,u}function Zc(e,t){e.push(0,0,0,0,0,0,0,0,t)}function S1(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function $_(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let r=0,n=null,s=t;for(;null!==s;){if(n=Qv(s),null===n)return qc;if(r++,s=s[Qs],-1!==n.injectorIndex)return n.injectorIndex|r<<16}return qc}function Xv(e,t,r){!function Ld(e,t,r){let n;"string"==typeof r?n=r.charCodeAt(0)||0:r.hasOwnProperty(El)&&(n=r[El]),null==n&&(n=r[El]=Bu++);const s=n&pp;t.data[e+(s>>Yh)]|=1<<s}(e,t,r)}function Kv(e,t,r){if(r&ri.Optional||void 0!==e)return e;Oo()}function zu(e,t,r,n){if(r&ri.Optional&&void 0===n&&(n=null),!(r&(ri.Self|ri.Host))){const s=e[Tl],u=ho(void 0);try{return s?s.get(t,n,r&ri.Optional):yd(t,n,r&ri.Optional)}finally{ho(u)}}return Kv(n,0,r)}function ko(e,t,r,n=ri.Default,s){if(null!==e){if(2048&t[yi]&&!(n&ri.Self)){const m=function Yc(e,t,r,n,s){let u=e,m=t;for(;null!==u&&null!==m&&2048&m[yi]&&!(512&m[yi]);){const b=Ro(u,m,r,n|ri.Self,Zo);if(b!==Zo)return b;let T=u.parent;if(!T){const R=m[Kf];if(R){const z=R.get(r,Zo,n);if(z!==Zo)return z}T=Qv(m),m=m[Qs]}u=T}return s}(e,t,r,n,Zo);if(m!==Zo)return m}const u=Ro(e,t,r,n,Zo);if(u!==Zo)return u}return zu(t,r,n,s)}function Ro(e,t,r,n,s){const u=function ND(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(El)?e[El]:void 0;return"number"==typeof t?t>=0?t&pp:I1:t}(r);if("function"==typeof u){if(!dp(t,e,n))return n&ri.Host?Kv(s,0,n):zu(t,r,n,s);try{let m;if(m=u(n),null!=m||n&ri.Optional)return m;Oo()}finally{N_()}}else if("number"==typeof u){let m=null,b=S1(e,t),T=qc,R=n&ri.Host?t[no][Pr]:null;for((-1===b||n&ri.SkipSelf)&&(T=-1===b?$_(e,t):t[b+8],T!==qc&&G_(n,!1)?(m=t[kn],b=qm(T),t=Zm(T,t)):b=-1);-1!==b;){const z=t[kn];if(Tr(u,b,z.data)){const W=M1(b,t,r,m,n,R);if(W!==Zo)return W}T=t[b+8],T!==qc&&G_(n,t[kn].data[b+8]===R)&&Tr(u,b,t)?(m=z,b=qm(T),t=Zm(T,t)):b=-1}}return s}function M1(e,t,r,n,s,u){const m=t[kn],b=m.data[e+8],z=Ym(b,m,r,null==n?pi(b)&&Yv:n!=m&&0!=(3&b.type),s&ri.Host&&u===b);return null!==z?Xh(t,m,z,b):Zo}function Ym(e,t,r,n,s){const u=e.providerIndexes,m=t.data,b=1048575&u,T=e.directiveStart,z=u>>20,le=s?b+z:e.directiveEnd;for(let he=n?b:b+z;he<le;he++){const Me=m[he];if(he<T&&r===Me||he>=T&&Me.type===r)return he}if(s){const he=m[T];if(he&&Lo(he)&&he.type===r)return T}return null}function Xh(e,t,r,n){let s=e[r];const u=t.data;if(function qv(e){return e instanceof hp}(s)){const m=s;m.resolving&&function xh(e,t){const r=t?`. Dependency path: ${t.join(" > ")} > ${e}`:"";throw new yt(-200,`Circular dependency in DI detected for ${e}${r}`)}(function qi(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():li(e)}(u[r]));const b=fp(m.canSeeViewProviders);m.resolving=!0;const R=m.injectImpl?ho(m.injectImpl):null;dp(e,n,ri.Default);try{s=e[r]=m.factory(void 0,u,e,n),t.firstCreatePass&&r>=n.directiveStart&&function OD(e,t,r){const{ngOnChanges:n,ngOnInit:s,ngDoCheck:u}=t.type.prototype;if(n){const m=w(t);(r.preOrderHooks??=[]).push(e,m),(r.preOrderCheckHooks??=[]).push(e,m)}s&&(r.preOrderHooks??=[]).push(0-e,s),u&&((r.preOrderHooks??=[]).push(e,u),(r.preOrderCheckHooks??=[]).push(e,u))}(r,u[r],t)}finally{null!==R&&ho(R),fp(b),m.resolving=!1,N_()}}return s}function Tr(e,t,r){return!!(r[t+(e>>Yh)]&1<<e)}function G_(e,t){return!(e&ri.Self||e&ri.Host&&t)}class Ns{constructor(t,r){this._tNode=t,this._lView=r}get(t,r,n){return ko(this._tNode,this._lView,t,rc(n),r)}}function I1(){return new Ns(hr(),mt())}function mi(e){return _a(()=>{const t=e.prototype.constructor,r=t[Cs]||Xm(t),n=Object.prototype;let s=Object.getPrototypeOf(e.prototype).constructor;for(;s&&s!==n;){const u=s[Cs]||Xm(s);if(u&&u!==r)return u;s=Object.getPrototypeOf(s)}return u=>new u})}function Xm(e){return Qi(e)?()=>{const t=Xm($n(e));return t&&t()}:Sl(e)}function Qv(e){const t=e[kn],r=t.type;return 2===r?t.declTNode:1===r?e[Pr]:null}const Hi="__parameters__";function Qh(e,t,r){return _a(()=>{const n=function q_(e){return function(...r){if(e){const n=e(...r);for(const s in n)this[s]=n[s]}}}(t);function s(...u){if(this instanceof s)return n.apply(this,u),this;const m=new s(...u);return b.annotation=m,b;function b(T,R,z){const W=T.hasOwnProperty(Hi)?T[Hi]:Object.defineProperty(T,Hi,{value:[]})[Hi];for(;W.length<=z;)W.push(null);return(W[z]=W[z]||[]).push(m),T}}return r&&(s.prototype=Object.create(r.prototype)),s.prototype.ngMetadataName=e,s.annotationCls=s,s})}function ef(e,t){e.forEach(r=>Array.isArray(r)?ef(r,t):t(r))}function eb(e,t,r){t>=e.length?e.push(r):e.splice(t,0,r)}function Km(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function gp(e,t){const r=[];for(let n=0;n<e;n++)r.push(t);return r}function Da(e,t,r){let n=Ta(e,t);return n>=0?e[1|n]=r:(n=~n,function F1(e,t,r,n){let s=e.length;if(s==t)e.push(r,n);else if(1===s)e.push(n,e[0]),e[0]=r;else{for(s--,e.push(e[s-1],e[s]);s>t;)e[s]=e[s-2],s--;e[t]=r,e[t+1]=n}}(e,n,t,r)),n}function W_(e,t){const r=Ta(e,t);if(r>=0)return e[1|r]}function Ta(e,t){return function di(e,t,r){let n=0,s=e.length>>r;for(;s!==n;){const u=n+(s-n>>1),m=e[u<<r];if(t===m)return u<<r;m>t?s=u:n=u+1}return~(s<<r)}(e,t,1)}const Bd=ga(Qh("Optional"),8),tf=ga(Qh("SkipSelf"),4);function rg(e){return 128==(128&e.flags)}var Vu=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(Vu||{});const K1=/^>|^->|<!--|-->|--!>|<!-$/g,Q1=/(<|>)/g,J1="\u200b$1\u200b";const J_=new Map;let ew=0;const hb="__ngContext__";function Bs(e,t){_t(t)?(e[hb]=t[Ui],function ub(e){J_.set(e[Ui],e)}(t)):e[hb]=t}let ty;function Po(e,t){return ty(e,t)}function cg(e){const t=e[Rr];return yn(t)?t[Rr]:t}function yp(e){return vb(e[$c])}function yb(e){return vb(e[Fo])}function vb(e){for(;null!==e&&!yn(e);)e=e[Fo];return e}function rf(e,t,r,n,s){if(null!=n){let u,m=!1;yn(n)?u=n:_t(n)&&(m=!0,n=n[Vr]);const b=K(n);0===e&&null!==r?null==s?Eb(t,r,b):Hd(t,r,b,s||null,!0):1===e&&null!==r?Hd(t,r,b,s||null,!0):2===e?function Cp(e,t,r){const n=Qc(e,t);n&&function Db(e,t,r,n){e.removeChild(t,r,n)}(e,n,t,r)}(t,b,m):3===e&&t.destroyNode(b),null!=u&&function $d(e,t,r,n,s){const u=r[hs];u!==K(r)&&rf(t,e,n,u,s);for(let b=X;b<r.length;b++){const T=r[b];yg(T[kn],T,e,t,n,u)}}(t,e,u,r,s)}}function ug(e,t){return e.createComment(function cb(e){return e.replace(K1,t=>t.replace(Q1,J1))}(t))}function dg(e,t,r){return e.createElement(t,r)}function ow(e,t){const r=e[L],n=r.indexOf(t);Qe(t),r.splice(n,1)}function sf(e,t){if(e.length<=X)return;const r=X+t,n=e[r];if(n){const s=n[lc];null!==s&&s!==e&&ow(s,n),t>0&&(e[r-1][Fo]=n[Fo]);const u=Km(e,X+t);!function el(e,t){yg(e,t,t[wi],2,null,null),t[Vr]=null,t[Pr]=null}(n[kn],n);const m=u[Es];null!==m&&m.detachView(u[kn]),n[Rr]=null,n[Fo]=null,n[yi]&=-129}return n}function ny(e,t){if(!(256&t[yi])){const r=t[wi];t[Xa]&&Nm(t[Xa]),t[cc]&&Nm(t[cc]),r.destroyNode&&yg(e,t,r,3,null,null),function bb(e){let t=e[$c];if(!t)return xb(e[kn],e);for(;t;){let r=null;if(_t(t))r=t[$c];else{const n=t[X];n&&(r=n)}if(!r){for(;t&&!t[Fo]&&t!==e;)_t(t)&&xb(t[kn],t),t=t[Rr];null===t&&(t=e),_t(t)&&xb(t[kn],t),r=t&&t[Fo]}t=r}}(t)}}function xb(e,t){if(!(256&t[yi])){t[yi]&=-129,t[yi]|=256,function Kc(e,t){let r;if(null!=e&&null!=(r=e.destroyHooks))for(let n=0;n<r.length;n+=2){const s=t[r[n]];if(!(s instanceof hp)){const u=r[n+1];if(Array.isArray(u))for(let m=0;m<u.length;m+=2){const b=s[u[m]],T=u[m+1];G(4,b,T);try{T.call(b)}finally{G(5,b,T)}}else{G(4,s,u);try{u.call(s)}finally{G(5,s,u)}}}}}(e,t),function wb(e,t){const r=e.cleanup,n=t[ac];if(null!==r)for(let u=0;u<r.length-1;u+=2)if("string"==typeof r[u]){const m=r[u+3];m>=0?n[m]():n[-m].unsubscribe(),u+=2}else r[u].call(n[r[u+1]]);null!==n&&(t[ac]=null);const s=t[ba];if(null!==s){t[ba]=null;for(let u=0;u<s.length;u++)(0,s[u])()}}(e,t),1===t[kn].type&&t[wi].destroy();const r=t[lc];if(null!==r&&yn(t[Rr])){r!==t[Rr]&&ow(r,t);const n=t[Es];null!==n&&n.detachView(e)}!function QD(e){J_.delete(e[Ui])}(t)}}function fc(e,t,r){return function Cb(e,t,r){let n=t;for(;null!==n&&40&n.type;)n=(t=n).parent;if(null===n)return r[Vr];{const{componentOffset:s}=n;if(s>-1){const{encapsulation:u}=e.data[n.directiveStart+s];if(u===ws.None||u===ws.Emulated)return null}return oe(n,r)}}(e,t.parent,r)}function Hd(e,t,r,n,s){e.insertBefore(t,r,n,s)}function Eb(e,t,r){e.appendChild(t,r)}function hg(e,t,r,n,s){null!==n?Hd(e,t,r,n,s):Eb(e,t,r)}function Qc(e,t){return e.parentNode(t)}function mg(e,t,r){return xp(e,t,r)}let gg,tl,ay,cf,xp=function Tb(e,t,r){return 40&e.type?oe(e,r):null};function _g(e,t,r,n){const s=fc(e,n,t),u=t[wi],b=mg(n.parent||t[Pr],n,t);if(null!=s)if(Array.isArray(r))for(let T=0;T<r.length;T++)hg(u,s,r[T],b,!1);else hg(u,s,r,b,!1);void 0!==gg&&gg(u,n,t,r,s)}function wp(e,t){if(null!==t){const r=t.type;if(3&r)return oe(t,e);if(4&r)return ry(-1,e[t.index]);if(8&r){const n=t.child;if(null!==n)return wp(e,n);{const s=e[t.index];return yn(s)?ry(-1,s):K(s)}}if(32&r)return Po(t,e)()||K(e[t.index]);{const n=Jc(e,t);return null!==n?Array.isArray(n)?n[0]:wp(cg(e[no]),n):wp(e,t.next)}}return null}function Jc(e,t){return null!==t?e[no][Pr].projection[t.projection]:null}function ry(e,t){const r=X+e+1;if(r<t.length){const n=t[r],s=n[kn].firstChild;if(null!==s)return wp(n,s)}return t[hs]}function Mb(e,t,r,n,s,u,m){for(;null!=r;){const b=n[r.index],T=r.type;if(m&&0===t&&(b&&Bs(K(b),n),r.flags|=2),32!=(32&r.flags))if(8&T)Mb(e,t,r.child,n,s,u,!1),rf(t,e,s,b,u);else if(32&T){const R=Po(r,n);let z;for(;z=R();)rf(t,e,s,z,u);rf(t,e,s,b,u)}else 16&T?oy(e,t,n,r,s,u):rf(t,e,s,b,u);r=m?r.projectionNext:r.next}}function yg(e,t,r,n,s,u){Mb(r,n,e.firstChild,t,s,u,!1)}function oy(e,t,r,n,s,u){const m=r[no],T=m[Pr].projection[n.projection];if(Array.isArray(T))for(let R=0;R<T.length;R++)rf(t,e,s,T[R],u);else{let R=T;const z=m[Rr];rg(n)&&(R.flags|=128),Mb(e,t,R,z,s,u,!0)}}function sw(e,t,r){""===r?e.removeAttribute(t,"class"):e.setAttribute(t,"class",r)}function sy(e,t,r){const{mergedAttrs:n,classes:s,styles:u}=r;null!==n&&Za(e,t,n),null!==s&&sw(e,t,s),null!==u&&function nT(e,t,r){e.setAttribute(t,"style",r)}(e,t,u)}function zo(e){return function Nl(){if(void 0===tl&&(tl=null,In.trustedTypes))try{tl=In.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return tl}()?.createHTML(e)||e}function lf(){if(void 0!==ay)return ay;if(typeof document<"u")return document;throw new yt(210,!1)}function Ko(){if(void 0===cf&&(cf=null,In.trustedTypes))try{cf=In.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return cf}function ly(e){return Ko()?.createHTML(e)||e}function cy(e){return Ko()?.createScriptURL(e)||e}class uf{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${hd})`}}class Ib extends uf{getTypeName(){return"HTML"}}class aw extends uf{getTypeName(){return"Style"}}class rT extends uf{getTypeName(){return"Script"}}class eu extends uf{getTypeName(){return"URL"}}class Gd extends uf{getTypeName(){return"ResourceURL"}}function zs(e){return e instanceof uf?e.changingThisBreaksApplicationSecurity:e}function nl(e,t){const r=function kb(e){return e instanceof uf&&e.getTypeName()||null}(e);if(null!=r&&r!==t){if("ResourceURL"===r&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${r} (see ${hd})`)}return r===t}class Pb{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const r=(new window.DOMParser).parseFromString(zo(t),"text/html").body;return null===r?this.inertDocumentHelper.getInertBodyElement(t):(r.removeChild(r.firstChild),r)}catch{return null}}}class dw{constructor(t){this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(t){const r=this.inertDocument.createElement("template");return r.innerHTML=zo(t),r}}const df=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function bg(e){return(e=String(e)).match(df)?e:"unsafe:"+e}function ju(e){const t={};for(const r of e.split(","))t[r]=!0;return t}function tu(...e){const t={};for(const r of e)for(const n in r)r.hasOwnProperty(n)&&(t[n]=!0);return t}const uy=ju("area,br,col,hr,img,wbr"),hf=ju("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),xg=ju("rp,rt"),Ob=tu(uy,tu(hf,ju("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),tu(xg,ju("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),tu(xg,hf)),Fb=ju("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),fw=tu(Fb,ju("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ju("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),pw=ju("script,style,template");class dT{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let r=t.firstChild,n=!0;for(;r;)if(r.nodeType===Node.ELEMENT_NODE?n=this.startElement(r):r.nodeType===Node.TEXT_NODE?this.chars(r.nodeValue):this.sanitizedSomething=!0,n&&r.firstChild)r=r.firstChild;else for(;r;){r.nodeType===Node.ELEMENT_NODE&&this.endElement(r);let s=this.checkClobberedElement(r,r.nextSibling);if(s){r=s;break}r=this.checkClobberedElement(r,r.parentNode)}return this.buf.join("")}startElement(t){const r=t.nodeName.toLowerCase();if(!Ob.hasOwnProperty(r))return this.sanitizedSomething=!0,!pw.hasOwnProperty(r);this.buf.push("<"),this.buf.push(r);const n=t.attributes;for(let s=0;s<n.length;s++){const u=n.item(s),m=u.name,b=m.toLowerCase();if(!fw.hasOwnProperty(b)){this.sanitizedSomething=!0;continue}let T=u.value;Fb[b]&&(T=bg(T)),this.buf.push(" ",m,'="',Lb(T),'"')}return this.buf.push(">"),!0}endElement(t){const r=t.nodeName.toLowerCase();Ob.hasOwnProperty(r)&&!uy.hasOwnProperty(r)&&(this.buf.push("</"),this.buf.push(r),this.buf.push(">"))}chars(t){this.buf.push(Lb(t))}checkClobberedElement(t,r){if(r&&(t.compareDocumentPosition(r)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return r}}const hT=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,mw=/([^\#-~ |!])/g;function Lb(e){return e.replace(/&/g,"&amp;").replace(hT,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(mw,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let wg;function dy(e,t){let r=null;try{wg=wg||function uw(e){const t=new dw(e);return function hw(){try{return!!(new window.DOMParser).parseFromString(zo(""),"text/html")}catch{return!1}}()?new Pb(t):t}(e);let n=t?String(t):"";r=wg.getInertBodyElement(n);let s=5,u=n;do{if(0===s)throw new Error("Failed to sanitize html because the input is unstable");s--,n=u,u=r.innerHTML,r=wg.getInertBodyElement(n)}while(n!==u);return zo((new dT).sanitizeChildren(pc(r)||r))}finally{if(r){const n=pc(r)||r;for(;n.firstChild;)n.removeChild(n.firstChild)}}}function pc(e){return"content"in e&&function il(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var ka=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}(ka||{});function Bl(e){const t=Uu();return t?ly(t.sanitize(ka.HTML,e)||""):nl(e,"HTML")?ly(zs(e)):dy(lf(),li(e))}function qd(e){const t=Uu();return t?t.sanitize(ka.URL,e)||"":nl(e,"URL")?zs(e):bg(li(e))}function gw(e){const t=Uu();if(t)return cy(t.sanitize(ka.RESOURCE_URL,e)||"");if(nl(e,"ResourceURL"))return cy(zs(e));throw new yt(904,!1)}function Uu(){const e=mt();return e&&e[va].sanitizer}class Kt{constructor(t,r){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof r?this.__NG_ELEMENT_ID__=r:void 0!==r&&(this.\u0275prov=Ut({token:this,providedIn:r.providedIn||"root",factory:r.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Eg=new Kt("ENVIRONMENT_INITIALIZER"),_w=new Kt("INJECTOR",-1),yw=new Kt("INJECTOR_DEF_TYPES");class Bb{get(t,r=Jl){if(r===Jl){const n=new Error(`NullInjectorError: No provider for ${jn(t)}!`);throw n.name="NullInjectorError",n}return r}}function hy(e){return{\u0275providers:e}}function yT(...e){return{\u0275providers:fy(0,e),\u0275fromNgModule:!0}}function fy(e,...t){const r=[],n=new Set;let s;const u=m=>{r.push(m)};return ef(t,m=>{const b=m;Hu(b,u,[],n)&&(s||=[],s.push(b))}),void 0!==s&&vw(s,u),r}function vw(e,t){for(let r=0;r<e.length;r++){const{ngModule:n,providers:s}=e[r];po(s,u=>{t(u,n)})}}function Hu(e,t,r,n){if(!(e=$n(e)))return!1;let s=null,u=ds(e);const m=!u&&Fi(e);if(u||m){if(m&&!m.standalone)return!1;s=e}else{const T=e.ngModule;if(u=ds(T),!u)return!1;s=T}const b=n.has(s);if(m){if(b)return!1;if(n.add(s),m.dependencies){const T="function"==typeof m.dependencies?m.dependencies():m.dependencies;for(const R of T)Hu(R,t,r,n)}}else{if(!u)return!1;{if(null!=u.imports&&!b){let R;n.add(s);try{ef(u.imports,z=>{Hu(z,t,r,n)&&(R||=[],R.push(z))})}finally{}void 0!==R&&vw(R,t)}if(!b){const R=Sl(s)||(()=>new s);t({provide:s,useFactory:R,deps:ir},s),t({provide:yw,useValue:s,multi:!0},s),t({provide:Eg,useValue:()=>ze(s),multi:!0},s)}const T=u.providers;if(null!=T&&!b){const R=e;po(T,z=>{t(z,R)})}}}return s!==e&&void 0!==e.providers}function po(e,t){for(let r of e)dd(r)&&(r=r.\u0275providers),Array.isArray(r)?po(r,t):t(r)}const py=Ii({provide:String,useValue:Ii});function my(e){return null!==e&&"object"==typeof e&&py in e}function mc(e){return"function"==typeof e}const gy=new Kt("Set Injector scope."),Wd={},zb={};let Sg;function ff(){return void 0===Sg&&(Sg=new Bb),Sg}class ra{}class _y extends ra{get destroyed(){return this._destroyed}constructor(t,r,n,s){super(),this.parent=r,this.source=n,this.scopes=s,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,jb(t,m=>this.processProvider(m)),this.records.set(_w,Dp(void 0,this)),s.has("environment")&&this.records.set(ra,Dp(void 0,this));const u=this.records.get(gy);null!=u&&"string"==typeof u.value&&this.scopes.add(u.value),this.injectorDefTypes=new Set(this.get(yw.multi,ir,ri.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const r of this._ngOnDestroyHooks)r.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(t){return this.assertNotDestroyed(),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){this.assertNotDestroyed();const r=$o(this),n=ho(void 0);try{return t()}finally{$o(r),ho(n)}}get(t,r=Jl,n=ri.Default){if(this.assertNotDestroyed(),t.hasOwnProperty(oc))return t[oc](this);n=rc(n);const u=$o(this),m=ho(void 0);try{if(!(n&ri.SkipSelf)){let T=this.records.get(t);if(void 0===T){const R=function xT(e){return"function"==typeof e||"object"==typeof e&&e instanceof Kt}(t)&&Lc(t);T=R&&this.injectableDefInScope(R)?Dp(Mg(t),Wd):null,this.records.set(t,T)}if(null!=T)return this.hydrate(t,T)}return(n&ri.Self?ff():this.parent).get(t,r=n&ri.Optional&&r===Jl?null:r)}catch(b){if("NullInjectorError"===b.name){if((b[ec]=b[ec]||[]).unshift(jn(t)),u)throw b;return function xd(e,t,r,n){const s=e[ec];throw t[tc]&&s.unshift(t[tc]),e.message=function Wf(e,t,r,n=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let s=jn(t);if(Array.isArray(t))s=t.map(jn).join(" -> ");else if("object"==typeof t){let u=[];for(let m in t)if(t.hasOwnProperty(m)){let b=t[m];u.push(m+":"+("string"==typeof b?JSON.stringify(b):jn(b)))}s=`{${u.join(", ")}}`}return`${r}${n?"("+n+")":""}[${s}]: ${e.replace(Ah,"\n  ")}`}("\n"+e.message,s,r,n),e.ngTokenPath=s,e[ec]=null,e}(b,t,"R3InjectorError",this.source)}throw b}finally{ho(m),$o(u)}}resolveInjectorInitializers(){const t=$o(this),r=ho(void 0);try{const s=this.get(Eg.multi,ir,ri.Self);for(const u of s)u()}finally{$o(t),ho(r)}}toString(){const t=[],r=this.records;for(const n of r.keys())t.push(jn(n));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new yt(205,!1)}processProvider(t){let r=mc(t=$n(t))?t:$n(t&&t.provide);const n=function yy(e){return my(e)?Dp(void 0,e.useValue):Dp(xw(e),Wd)}(t);if(mc(t)||!0!==t.multi)this.records.get(r);else{let s=this.records.get(r);s||(s=Dp(void 0,Wd,!0),s.factory=()=>Tu(s.multi),this.records.set(r,s)),r=t,s.multi.push(t)}this.records.set(r,n)}hydrate(t,r){return r.value===Wd&&(r.value=zb,r.value=r.factory()),"object"==typeof r.value&&r.value&&function bT(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(r.value)&&this._ngOnDestroyHooks.add(r.value),r.value}injectableDefInScope(t){if(!t.providedIn)return!1;const r=$n(t.providedIn);return"string"==typeof r?"any"===r||this.scopes.has(r):this.injectorDefTypes.has(r)}removeOnDestroy(t){const r=this._onDestroyHooks.indexOf(t);-1!==r&&this._onDestroyHooks.splice(r,1)}}function Mg(e){const t=Lc(e),r=null!==t?t.factory:Sl(e);if(null!==r)return r;if(e instanceof Kt)throw new yt(204,!1);if(e instanceof Function)return function Vb(e){const t=e.length;if(t>0)throw gp(t,"?"),new yt(204,!1);const r=function Hf(e){return e&&(e[xl]||e[Dh])||null}(e);return null!==r?()=>r.factory(e):()=>new e}(e);throw new yt(204,!1)}function xw(e,t,r){let n;if(mc(e)){const s=$n(e);return Sl(s)||Mg(s)}if(my(e))n=()=>$n(e.useValue);else if(function Tg(e){return!(!e||!e.useFactory)}(e))n=()=>e.useFactory(...Tu(e.deps||[]));else if(function Dg(e){return!(!e||!e.useExisting)}(e))n=()=>ze($n(e.useExisting));else{const s=$n(e&&(e.useClass||e.provide));if(!function vT(e){return!!e.deps}(e))return Sl(s)||Mg(s);n=()=>new s(...Tu(e.deps))}return n}function Dp(e,t,r=!1){return{factory:e,value:t,multi:r?[]:void 0}}function jb(e,t){for(const r of e)Array.isArray(r)?jb(r,t):r&&dd(r)?jb(r.\u0275providers,t):t(r)}const Ag=new Kt("AppId",{providedIn:"root",factory:()=>wT}),wT="ng",Ig=new Kt("Platform Initializer"),Zd=new Kt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),oa=new Kt("AnimationModuleType"),Ub=new Kt("CSP nonce",{providedIn:"root",factory:()=>lf().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let Gb=(e,t,r)=>null;function qb(e,t,r=!1){return Gb(e,t,r)}class Cw{}class Ew{}class Tw{resolveComponentFactory(t){throw function Dw(e){const t=Error(`No component factory found for ${jn(e)}.`);return t.ngComponent=e,t}(t)}}let Xd=(()=>{class t{}return t.NULL=new Tw,t})();function Sw(){return mf(hr(),mt())}function mf(e,t){return new tr(oe(e,t))}let tr=(()=>{class t{constructor(n){this.nativeElement=n}}return t.__NG_ELEMENT_ID__=Sw,t})();function OT(e){return e instanceof tr?e.nativeElement:e}class Rg{}let $u=(()=>{class t{constructor(){this.destroyNode=null}}return t.__NG_ELEMENT_ID__=()=>function Cy(){const e=mt(),r=ae(hr().index,e);return(_t(r)?r:e)[wi]}(),t})(),Fp=(()=>{var e;class t{}return(e=t).\u0275prov=Ut({token:e,providedIn:"root",factory:()=>null}),t})();class Gu{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const Mw=new Gu("16.2.5"),Yb={};function Ey(e,t=null,r=null,n){const s=Pg(e,t,r,n);return s.resolveInjectorInitializers(),s}function Pg(e,t=null,r=null,n,s=new Set){const u=[r||ir,yT(e)];return n=n||("object"==typeof e?void 0:jn(e)),new _y(u,t||ff(),n||null,s)}let Xr=(()=>{var e;class t{static create(n,s){if(Array.isArray(n))return Ey({name:""},s,n,"");{const u=n.name??"";return Ey({name:u},n.parent,n.providers,u)}}}return(e=t).THROW_IF_NOT_FOUND=Jl,e.NULL=new Bb,e.\u0275prov=Ut({token:e,providedIn:"any",factory:()=>ze(_w)}),e.__NG_ELEMENT_ID__=-1,t})();function gf(e){return e.ngOriginalError}class qu{constructor(){this._console=console}handleError(t){const r=this._findOriginalError(t);this._console.error("ERROR",t),r&&this._console.error("ORIGINAL ERROR",r)}_findOriginalError(t){let r=t&&gf(t);for(;r&&gf(r);)r=gf(r);return r||null}}function e0(e){return t=>{setTimeout(e,void 0,t)}}const Wn=class zT extends qe{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,r,n){let s=t,u=r||(()=>null),m=n;if(t&&"object"==typeof t){const T=t;s=T.next?.bind(T),u=T.error?.bind(T),m=T.complete?.bind(T)}this.__isAsync&&(u=e0(u),s&&(s=e0(s)),m&&(m=e0(m)));const b=super.subscribe({next:s,error:u,complete:m});return t instanceof me&&t.add(b),b}};function Ra(...e){}class si{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Wn(!1),this.onMicrotaskEmpty=new Wn(!1),this.onStable=new Wn(!1),this.onError=new Wn(!1),typeof Zone>"u")throw new yt(908,!1);Zone.assertZonePatched();const s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!n&&r,s.shouldCoalesceRunChangeDetection=n,s.lastRequestAnimationFrameId=-1,s.nativeRequestAnimationFrame=function Rw(){const e="function"==typeof In.requestAnimationFrame;let t=In[e?"requestAnimationFrame":"setTimeout"],r=In[e?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&t&&r){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const s=r[Zone.__symbol__("OriginalDelegate")];s&&(r=s)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:r}}().nativeRequestAnimationFrame,function Pw(e){const t=()=>{!function VT(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(In,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,Ty(e),e.isCheckStableRunning=!0,Lp(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),Ty(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(r,n,s,u,m,b)=>{if(function jT(e){return!(!Array.isArray(e)||1!==e.length)&&!0===e[0].data?.__ignore_ng_zone__}(b))return r.invokeTask(s,u,m,b);try{return Ow(e),r.invokeTask(s,u,m,b)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===u.type||e.shouldCoalesceRunChangeDetection)&&t(),n0(e)}},onInvoke:(r,n,s,u,m,b,T)=>{try{return Ow(e),r.invoke(s,u,m,b,T)}finally{e.shouldCoalesceRunChangeDetection&&t(),n0(e)}},onHasTask:(r,n,s,u)=>{r.hasTask(s,u),n===s&&("microTask"==u.change?(e._hasPendingMicrotasks=u.microTask,Ty(e),Lp(e)):"macroTask"==u.change&&(e.hasPendingMacrotasks=u.macroTask))},onHandleError:(r,n,s,u)=>(r.handleError(s,u),e.runOutsideAngular(()=>e.onError.emit(u)),!1)})}(s)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!si.isInAngularZone())throw new yt(909,!1)}static assertNotInAngularZone(){if(si.isInAngularZone())throw new yt(909,!1)}run(t,r,n){return this._inner.run(t,r,n)}runTask(t,r,n,s){const u=this._inner,m=u.scheduleEventTask("NgZoneEvent: "+s,t,t0,Ra,Ra);try{return u.runTask(m,r,n)}finally{u.cancelTask(m)}}runGuarded(t,r,n){return this._inner.runGuarded(t,r,n)}runOutsideAngular(t){return this._outer.run(t)}}const t0={};function Lp(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Ty(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function Ow(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function n0(e){e._nesting--,Lp(e)}class Fw{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Wn,this.onMicrotaskEmpty=new Wn,this.onStable=new Wn,this.onError=new Wn}run(t,r,n){return t.apply(r,n)}runGuarded(t,r,n){return t.apply(r,n)}runOutsideAngular(t){return t()}runTask(t,r,n,s){return t.apply(r,n)}}const Sy=new Kt("",{providedIn:"root",factory:r0});function r0(){const e=Jt(si);let t=!0;return vh(new wn(s=>{t=e.isStable&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks,e.runOutsideAngular(()=>{s.next(t),s.complete()})}),new wn(s=>{let u;e.runOutsideAngular(()=>{u=e.onStable.subscribe(()=>{si.assertNotInAngularZone(),queueMicrotask(()=>{!t&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks&&(t=!0,s.next(!0))})})});const m=e.onUnstable.subscribe(()=>{si.assertInAngularZone(),t&&(t=!1,e.runOutsideAngular(()=>{s.next(!1)}))});return()=>{u.unsubscribe(),m.unsubscribe()}}).pipe(bh()))}function iu(e){return e instanceof Function?e():e}let Og=(()=>{var e;class t{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}}return(e=t).\u0275prov=Ut({token:e,providedIn:"root",factory:()=>new e}),t})();function fs(e){for(;e;){e[yi]|=64;const t=cg(e);if(Md(e)&&!t)return e;e=t}return null}const Bp=new Kt("",{providedIn:"root",factory:()=>!1});let My=null;function xf(e,t){return e[t]??h0()}function wf(e,t){const r=h0();r.producerNode?.length&&(e[t]=My,r.lView=e,My=Vw())}const d0={...Nh,consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{fs(e.lView)},lView:null};function Vw(){return Object.create(d0)}function h0(){return My??=Vw(),My}const Bi={};function we(e){jw(un(),mt(),Fs()+e,!1)}function jw(e,t,r,n){if(!n)if(3==(3&t[yi])){const u=e.preOrderCheckHooks;null!==u&&Gm(t,u,r)}else{const u=e.preOrderHooks;null!==u&&j_(t,u,0,r)}Od(r)}function xe(e,t=ri.Default){const r=mt();return null===r?ze(e,t):ko(hr(),r,$n(e),t)}function ol(){throw new Error("invalid")}function Ng(e,t,r,n,s,u,m,b,T,R,z){const W=t.blueprint.slice();return W[Vr]=s,W[yi]=140|n,(null!==R||e&&2048&e[yi])&&(W[yi]|=2048),lt(W),W[Rr]=W[Qs]=e,W[sr]=r,W[va]=m||e&&e[va],W[wi]=b||e&&e[wi],W[Tl]=T||e&&e[Tl]||null,W[Pr]=u,W[Ui]=function KD(){return ew++}(),W[Js]=z,W[Kf]=R,W[no]=2==t.type?e[no]:W,W}function Zu(e,t,r,n,s){let u=e.data[t];if(null===u)u=function Bg(e,t,r,n,s){const u=na(),m=Ni(),T=e.data[t]=function Vp(e,t,r,n,s,u){let m=t?t.injectorIndex:-1,b=0;return mn()&&(b|=128),{type:r,index:n,insertBeforeIndex:null,injectorIndex:m,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:b,providerIndexes:0,value:s,attrs:u,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,m?u:u&&u.parent,r,t,n,s);return null===e.firstChild&&(e.firstChild=T),null!==u&&(m?null==u.child&&null!==T.parent&&(u.child=T):null===u.next&&(u.next=T,T.prev=u)),T}(e,t,r,n,s),function rr(){return Ue.lFrame.inI18n}()&&(u.flags|=32);else if(64&u.type){u.type=r,u.value=n,u.attrs=s;const m=function zi(){const e=Ue.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();u.injectorIndex=null===m?-1:m.injectorIndex}return ci(u,!0),u}function zg(e,t,r,n){if(0===r)return-1;const s=t.length;for(let u=0;u<r;u++)t.push(n),e.blueprint.push(n),e.data.push(null);return s}function f0(e,t,r,n,s){const u=xf(t,Xa),m=Fs(),b=2&n;try{Od(-1),b&&t.length>Li&&jw(e,t,Li,!1),G(b?2:0,s);const R=b?u:null,z=kd(R);try{null!==R&&(R.dirty=!1),r(n,s)}finally{jh(R,z)}}finally{b&&null===t[Xa]&&wf(t,Xa),Od(m),G(b?3:1,s)}}function ru(e,t,r){if(fi(t)){const n=xa(null);try{const u=t.directiveEnd;for(let m=t.directiveStart;m<u;m++){const b=e.data[m];b.contentQueries&&b.contentQueries(1,r[m],m)}}finally{xa(n)}}}function Ay(e,t,r){Xt()&&(function Ww(e,t,r,n){const s=r.directiveStart,u=r.directiveEnd;pi(r)&&function v0(e,t,r){const n=oe(t,e),s=Yu(r);let m=16;r.signals?m=4096:r.onPush&&(m=64);const b=Oy(e,Ng(e,s,null,m,n,t,null,e[va].rendererFactory.createRenderer(n,r),null,null,null));e[t.index]=b}(t,r,e.data[s+r.componentOffset]),e.firstCreatePass||Wc(r,t),Bs(n,t);const m=r.initialInputs;for(let b=s;b<u;b++){const T=e.data[b],R=Xh(t,e,b,r);Bs(R,t),null!==m&&Gg(0,b-s,R,T,0,m),Lo(T)&&(ae(r.index,t)[sr]=Xh(t,e,b,r))}}(e,t,r,oe(r,t)),64==(64&r.flags)&&$g(e,t,r))}function p0(e,t,r=oe){const n=t.localNames;if(null!==n){let s=t.index+1;for(let u=0;u<n.length;u+=2){const m=n[u+1],b=-1===m?r(t,e):e[m];e[s++]=b}}}function Yu(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=m0(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):t}function m0(e,t,r,n,s,u,m,b,T,R,z){const W=Li+n,le=W+s,he=function Vg(e,t){const r=[];for(let n=0;n<t;n++)r.push(n<e?null:Bi);return r}(W,le),Me="function"==typeof R?R():R;return he[kn]={type:e,blueprint:he,template:r,queries:null,viewQuery:b,declTNode:t,data:he.slice().fill(null,W),bindingStartIndex:W,expandoStartIndex:le,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof u?u():u,pipeRegistry:"function"==typeof m?m():m,firstChild:null,schemas:T,consts:Me,incompleteFirstPass:!1,ssrId:z}}let zp=e=>null;function Hg(e,t,r,n){for(let s in e)if(e.hasOwnProperty(s)){r=null===r?{}:r;const u=e[s];null===n?Hw(r,t,s,u):n.hasOwnProperty(s)&&Hw(r,t,n[s],u)}return r}function Hw(e,t,r,n){e.hasOwnProperty(r)?e[r].push(t,n):e[r]=[t,n]}function sl(e,t,r,n,s,u,m,b){const T=oe(t,r);let z,R=t.inputs;!b&&null!=R&&(z=R[n])?(su(e,r,z,n,s),pi(t)&&function qw(e,t){const r=ae(t,e);16&r[yi]||(r[yi]|=64)}(r,t.index)):3&t.type&&(n=function Gw(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(n),s=null!=m?m(s,t.value||"",n):s,u.setProperty(T,n,s))}function g0(e,t,r,n){if(Xt()){const s=null===n?null:{"":-1},u=function KT(e,t){const r=e.directiveRegistry;let n=null,s=null;if(r)for(let u=0;u<r.length;u++){const m=r[u];if(oi(t,m.selectors,!1))if(n||(n=[]),Lo(m))if(null!==m.findHostDirectiveDefs){const b=[];s=s||new Map,m.findHostDirectiveDefs(m,b,s),n.unshift(...b,m),jp(e,t,b.length)}else n.unshift(m),jp(e,t,0);else s=s||new Map,m.findHostDirectiveDefs?.(m,n,s),n.push(m)}return null===n?null:[n,s]}(e,r);let m,b;null===u?m=b=null:[m,b]=u,null!==m&&_0(e,t,r,m,s,b),s&&function ky(e,t,r){if(t){const n=e.localNames=[];for(let s=0;s<t.length;s+=2){const u=r[t[s+1]];if(null==u)throw new yt(-301,!1);n.push(t[s],u)}}}(r,n,s)}r.mergedAttrs=Ks(r.mergedAttrs,r.attrs)}function _0(e,t,r,n,s,u){for(let R=0;R<n.length;R++)Xv(Wc(r,t),e,n[R].type);!function Py(e,t,r){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+r,e.providerIndexes=t}(r,e.data.length,n.length);for(let R=0;R<n.length;R++){const z=n[R];z.providersResolver&&z.providersResolver(z)}let m=!1,b=!1,T=zg(e,t,n.length,null);for(let R=0;R<n.length;R++){const z=n[R];r.mergedAttrs=Ks(r.mergedAttrs,z.hostAttrs),QT(e,r,t,T,z),Ry(T,z,s),null!==z.contentQueries&&(r.flags|=4),(null!==z.hostBindings||null!==z.hostAttrs||0!==z.hostVars)&&(r.flags|=64);const W=z.type.prototype;!m&&(W.ngOnChanges||W.ngOnInit||W.ngDoCheck)&&((e.preOrderHooks??=[]).push(r.index),m=!0),!b&&(W.ngOnChanges||W.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(r.index),b=!0),T++}!function $w(e,t,r){const s=t.directiveEnd,u=e.data,m=t.attrs,b=[];let T=null,R=null;for(let z=t.directiveStart;z<s;z++){const W=u[z],le=r?r.get(W):null,Me=le?le.outputs:null;T=Hg(W.inputs,z,T,le?le.inputs:null),R=Hg(W.outputs,z,R,Me);const Ve=null===T||null===m||Iu(t)?null:JT(T,z,m);b.push(Ve)}null!==T&&(T.hasOwnProperty("class")&&(t.flags|=8),T.hasOwnProperty("style")&&(t.flags|=16)),t.initialInputs=b,t.inputs=T,t.outputs=R}(e,r,u)}function $g(e,t,r){const n=r.directiveStart,s=r.directiveEnd,u=r.index,m=function uc(){return Ue.lFrame.currentDirectiveIndex}();try{Od(u);for(let b=n;b<s;b++){const T=e.data[b],R=t[b];Nu(b),(null!==T.hostBindings||0!==T.hostVars||null!==T.hostAttrs)&&XT(T,R)}}finally{Od(-1),Nu(m)}}function XT(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function jp(e,t,r){t.componentOffset=r,(e.components??=[]).push(t.index)}function Ry(e,t,r){if(r){if(t.exportAs)for(let n=0;n<t.exportAs.length;n++)r[t.exportAs[n]]=e;Lo(t)&&(r[""]=e)}}function QT(e,t,r,n,s){e.data[n]=s;const u=s.factory||(s.factory=Sl(s.type)),m=new hp(u,Lo(s),xe);e.blueprint[n]=m,r[n]=m,function YT(e,t,r,n,s){const u=s.hostBindings;if(u){let m=e.hostBindingOpCodes;null===m&&(m=e.hostBindingOpCodes=[]);const b=~t.index;(function y0(e){let t=e.length;for(;t>0;){const r=e[--t];if("number"==typeof r&&r<0)return r}return 0})(m)!=b&&m.push(b),m.push(r,n,u)}}(e,t,n,zg(e,r,s.hostVars,Bi),s)}function zl(e,t,r,n,s,u){const m=oe(e,t);!function Up(e,t,r,n,s,u,m){if(null==u)e.removeAttribute(t,s,r);else{const b=null==m?li(u):m(u,n||"",s);e.setAttribute(t,s,b,r)}}(t[wi],m,u,e.value,r,n,s)}function Gg(e,t,r,n,s,u){const m=u[t];if(null!==m)for(let b=0;b<m.length;)Zw(n,r,m[b++],m[b++],m[b++])}function Zw(e,t,r,n,s){const u=xa(null);try{const m=e.inputTransforms;null!==m&&m.hasOwnProperty(n)&&(s=m[n].call(t,s)),null!==e.setInput?e.setInput(t,s,r,n):t[n]=s}finally{xa(u)}}function JT(e,t,r){let n=null,s=0;for(;s<r.length;){const u=r[s];if(0!==u)if(5!==u){if("number"==typeof u)break;if(e.hasOwnProperty(u)){null===n&&(n=[]);const m=e[u];for(let b=0;b<m.length;b+=2)if(m[b]===t){n.push(u,m[b+1],r[s+1]);break}}s+=2}else s+=2;else s+=4}return n}function Yw(e,t,r,n){return[e,!0,!1,t,null,0,n,r,null,null,null]}function Xw(e,t){const r=e.contentQueries;if(null!==r)for(let n=0;n<r.length;n+=2){const u=r[n+1];if(-1!==u){const m=e.data[u];Gh(r[n]),m.contentQueries(2,t[u],u)}}}function Oy(e,t){return e[$c]?e[Sd][Fo]=t:e[$c]=t,e[Sd]=t,t}function b0(e,t,r){Gh(0);const n=xa(null);try{t(e,r)}finally{xa(n)}}function ou(e){return e[ac]||(e[ac]=[])}function qg(e){return e.cleanup||(e.cleanup=[])}function al(e,t,r){return(null===e||Lo(e))&&(r=function ne(e){for(;Array.isArray(e);){if("object"==typeof e[Ou])return e;e=e[Vr]}return null}(r[t.index])),r[wi]}function _c(e,t){const r=e[Tl],n=r?r.get(qu,null):null;n&&n.handleError(t)}function su(e,t,r,n,s){for(let u=0;u<r.length;){const m=r[u++],b=r[u++];Zw(e.data[m],t[m],n,b,s)}}function ps(e,t,r){const n=J(t,e);!function oo(e,t,r){e.setValue(t,r)}(e[wi],n,r)}function Kd(e,t){const r=ae(t,e),n=r[kn];!function Fy(e,t){for(let r=t.length;r<e.blueprint.length;r++)t.push(e.blueprint[r])}(n,r);const s=r[Vr];null!==s&&null===r[Js]&&(r[Js]=qb(s,r[Tl])),Ly(n,r,r[sr])}function Ly(e,t,r){Um(t);try{const n=e.viewQuery;null!==n&&b0(1,n,r);const s=e.template;null!==s&&f0(e,t,s,1,r),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&Xw(e,t),e.staticViewQueries&&b0(2,e.viewQuery,r);const u=e.components;null!==u&&function Ny(e,t){for(let r=0;r<t.length;r++)Kd(e,t[r])}(t,u)}catch(n){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),n}finally{t[yi]&=-5,B_()}}let w0=(()=>{var e;class t{constructor(){this.all=new Set,this.queue=new Map}create(n,s,u){const m=typeof Zone>"u"?null:Zone.current,b=function up(e,t,r){const n=Object.create(_);r&&(n.consumerAllowSignalWrites=!0),n.fn=e,n.schedule=t;const s=m=>{n.cleanupFn=m};return n.ref={notify:()=>Vh(n),run:()=>{if(n.dirty=!1,n.hasRun&&!Lm(n))return;n.hasRun=!0;const m=kd(n);try{n.cleanupFn(),n.cleanupFn=rn,n.fn(s)}finally{jh(n,m)}},cleanup:()=>n.cleanupFn()},n.ref}(n,z=>{this.all.has(z)&&this.queue.set(z,m)},u);let T;this.all.add(b),b.notify();const R=()=>{b.cleanup(),T?.(),this.all.delete(b),this.queue.delete(b)};return T=s?.onDestroy(R),{destroy:R}}flush(){if(0!==this.queue.size)for(const[n,s]of this.queue)this.queue.delete(n),s?s.run(()=>n.run()):n.run()}get isQueueEmpty(){return 0===this.queue.size}}return(e=t).\u0275prov=Ut({token:e,providedIn:"root",factory:()=>new e}),t})();function By(e,t,r){let n=r?e.styles:null,s=r?e.classes:null,u=0;if(null!==t)for(let m=0;m<t.length;m++){const b=t[m];"number"==typeof b?u=b:1==u?s=ks(s,b):2==u&&(n=ks(n,b+": "+t[++m]+";"))}r?e.styles=n:e.stylesWithoutHost=n,r?e.classes=s:e.classesWithoutHost=s}function Wg(e,t,r,n,s=!1){for(;null!==r;){const u=t[r.index];null!==u&&n.push(K(u)),yn(u)&&Cf(u,n);const m=r.type;if(8&m)Wg(e,t,r.child,n);else if(32&m){const b=Po(r,t);let T;for(;T=b();)n.push(T)}else if(16&m){const b=Jc(t,r);if(Array.isArray(b))n.push(...b);else{const T=cg(t[no]);Wg(T[kn],T,b,n,!0)}}r=s?r.projectionNext:r.next}return n}function Cf(e,t){for(let r=X;r<e.length;r++){const n=e[r],s=n[kn].firstChild;null!==s&&Wg(n[kn],n,s,t)}e[hs]!==e[Vr]&&t.push(e[hs])}function Hp(e,t,r,n=!0){const s=t[va],u=s.rendererFactory,m=s.afterRenderEventManager;u.begin?.(),m?.begin();try{zy(e,t,e.template,r)}catch(T){throw n&&_c(t,T),T}finally{u.end?.(),s.effectManager?.flush(),m?.end()}}function zy(e,t,r,n){const s=t[yi];if(256!=(256&s)){t[va].effectManager?.flush(),Um(t);try{lt(t),function ia(e){return Ue.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==r&&f0(e,t,r,2,n);const m=3==(3&s);if(m){const R=e.preOrderCheckHooks;null!==R&&Gm(t,R,null)}else{const R=e.preOrderHooks;null!==R&&j_(t,R,0,null),U_(t,0)}if(function yc(e){for(let t=yp(e);null!==t;t=yb(t)){if(!t[Ka])continue;const r=t[L];for(let n=0;n<r.length;n++){$e(r[n])}}}(t),Vy(t,2),null!==e.contentQueries&&Xw(e,t),m){const R=e.contentCheckHooks;null!==R&&Gm(t,R)}else{const R=e.contentHooks;null!==R&&j_(t,R,1),U_(t,1)}!function Uw(e,t){const r=e.hostBindingOpCodes;if(null===r)return;const n=xf(t,cc);try{for(let s=0;s<r.length;s++){const u=r[s];if(u<0)Od(~u);else{const m=u,b=r[++s],T=r[++s];kl(b,m),n.dirty=!1;const R=kd(n);try{T(2,t[m])}finally{jh(n,R)}}}}finally{null===t[cc]&&wf(t,cc),Od(-1)}}(e,t);const b=e.components;null!==b&&jy(t,b,0);const T=e.viewQuery;if(null!==T&&b0(2,T,n),m){const R=e.viewCheckHooks;null!==R&&Gm(t,R)}else{const R=e.viewHooks;null!==R&&j_(t,R,2),U_(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),t[yi]&=-73,Qe(t)}finally{B_()}}}function Vy(e,t){for(let r=yp(e);null!==r;r=yb(r))for(let n=X;n<r.length;n++)E0(r[n],t)}function Ef(e,t,r){E0(ae(t,e),r)}function E0(e,t){if(!function Se(e){return 128==(128&e[yi])}(e))return;const r=e[kn],n=e[yi];if(80&n&&0===t||1024&n||2===t)zy(r,e,r.template,e[sr]);else if(e[Hc]>0){Vy(e,1);const s=r.components;null!==s&&jy(e,s,1)}}function jy(e,t,r){for(let n=0;n<t.length;n++)Ef(e,t[n],r)}class Xu{get rootNodes(){const t=this._lView,r=t[kn];return Wg(r,t,r.firstChild,[])}constructor(t,r){this._lView=t,this._cdRefInjectingView=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[sr]}set context(t){this._lView[sr]=t}get destroyed(){return 256==(256&this._lView[yi])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[Rr];if(yn(t)){const r=t[8],n=r?r.indexOf(this):-1;n>-1&&(sf(t,n),Km(r,n))}this._attachedToViewContainer=!1}ny(this._lView[kn],this._lView)}onDestroy(t){!function ot(e,t){if(256==(256&e[yi]))throw new yt(911,!1);null===e[ba]&&(e[ba]=[]),e[ba].push(t)}(this._lView,t)}markForCheck(){fs(this._cdRefInjectingView||this._lView)}detach(){this._lView[yi]&=-129}reattach(){this._lView[yi]|=128}detectChanges(){Hp(this._lView[kn],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new yt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function bp(e,t){yg(e,t,t[wi],2,null,null)}(this._lView[kn],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new yt(902,!1);this._appRef=t}}class eS extends Xu{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;Hp(t[kn],t,t[sr],!1)}checkNoChanges(){}get context(){return null}}class Qw extends Xd{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const r=Fi(t);return new Zg(r,this.ngModule)}}function Jw(e){const t=[];for(let r in e)e.hasOwnProperty(r)&&t.push({propName:e[r],templateName:r});return t}class nS{constructor(t,r){this.injector=t,this.parentInjector=r}get(t,r,n){n=rc(n);const s=this.injector.get(t,Yb,n);return s!==Yb||r===Yb?s:this.parentInjector.get(t,r,n)}}class Zg extends Ew{get inputs(){const t=this.componentDef,r=t.inputTransforms,n=Jw(t.inputs);if(null!==r)for(const s of n)r.hasOwnProperty(s.propName)&&(s.transform=r[s.propName]);return n}get outputs(){return Jw(this.componentDef.outputs)}constructor(t,r){super(),this.componentDef=t,this.ngModule=r,this.componentType=t.type,this.selector=function Zf(e){return e.map(Uc).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!r}create(t,r,n,s){let u=(s=s||this.ngModule)instanceof ra?s:s?.injector;u&&null!==this.componentDef.getStandaloneInjector&&(u=this.componentDef.getStandaloneInjector(u)||u);const m=u?new nS(t,u):t,b=m.get(Rg,null);if(null===b)throw new yt(407,!1);const W={rendererFactory:b,sanitizer:m.get(Fp,null),effectManager:m.get(w0,null),afterRenderEventManager:m.get(Og,null)},le=b.createRenderer(null,this.componentDef),he=this.componentDef.selectors[0][0]||"div",Me=n?function jg(e,t,r,n){const u=n.get(Bp,!1)||r===ws.ShadowDom,m=e.selectRootElement(t,u);return function Ug(e){zp(e)}(m),m}(le,n,this.componentDef.encapsulation,m):dg(le,he,function tS(e){const t=e.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(he)),wt=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let ft=null;null!==Me&&(ft=qb(Me,m,!0));const Nn=m0(0,null,null,1,0,null,null,null,null,null,null),Sn=Ng(null,Nn,null,wt,null,null,W,le,m,null,ft);let Ri,lo;Um(Sn);try{const Jr=this.componentDef;let ca,Yl=null;Jr.findHostDirectiveDefs?(ca=[],Yl=new Map,Jr.findHostDirectiveDefs(Jr,ca,Yl),ca.push(Jr)):ca=[Jr];const cd=function eC(e,t){const r=e[kn],n=Li;return e[n]=t,Zu(r,n,2,"#host",null)}(Sn,Me),kD=function tC(e,t,r,n,s,u,m){const b=s[kn];!function Uy(e,t,r,n){for(const s of e)t.mergedAttrs=Ks(t.mergedAttrs,s.hostAttrs);null!==t.mergedAttrs&&(By(t,t.mergedAttrs,!0),null!==r&&sy(n,r,t))}(n,e,t,m);let T=null;null!==t&&(T=qb(t,s[Tl]));const R=u.rendererFactory.createRenderer(t,r);let z=16;r.signals?z=4096:r.onPush&&(z=64);const W=Ng(s,Yu(r),null,z,s[e.index],e,u,R,null,null,T);return b.firstCreatePass&&jp(b,e,n.length-1),Oy(s,W),s[e.index]=W}(cd,Me,Jr,ca,Sn,W,le);lo=ye(Nn,Li),Me&&function nC(e,t,r,n){if(n)Za(e,r,["ng-version",Mw.full]);else{const{attrs:s,classes:u}=function Yf(e){const t=[],r=[];let n=1,s=2;for(;n<e.length;){let u=e[n];if("string"==typeof u)2===s?""!==u&&t.push(u,e[++n]):8===s&&r.push(u);else{if(!rs(s))break;s=u}n++}return{attrs:t,classes:r}}(t.selectors[0]);s&&Za(e,r,s),u&&u.length>0&&sw(e,r,u.join(" "))}}(le,Jr,Me,n),void 0!==r&&function iC(e,t,r){const n=e.projection=[];for(let s=0;s<t.length;s++){const u=r[s];n.push(null!=u?Array.from(u):null)}}(lo,this.ngContentSelectors,r),Ri=function Qd(e,t,r,n,s,u){const m=hr(),b=s[kn],T=oe(m,s);_0(b,s,m,r,null,n);for(let z=0;z<r.length;z++)Bs(Xh(s,b,m.directiveStart+z,m),s);$g(b,s,m),T&&Bs(T,s);const R=Xh(s,b,m.directiveStart+m.componentOffset,m);if(e[sr]=s[sr]=R,null!==u)for(const z of u)z(R,t);return ru(b,m,e),R}(kD,Jr,ca,Yl,Sn,[rC]),Ly(Nn,Sn,null)}finally{B_()}return new iS(this.componentType,Ri,mf(lo,Sn),Sn,lo)}}class iS extends Cw{constructor(t,r,n,s,u){super(),this.location=n,this._rootLView=s,this._tNode=u,this.previousInputValues=null,this.instance=r,this.hostView=this.changeDetectorRef=new eS(s),this.componentType=t}setInput(t,r){const n=this._tNode.inputs;let s;if(null!==n&&(s=n[t])){if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),r))return;const u=this._rootLView;su(u[kn],u,s,t,r),this.previousInputValues.set(t,r),fs(ae(this._tNode.index,u))}}get injector(){return new Ns(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function rC(){const e=hr();Wh(mt()[kn],e)}function ki(e){let t=function D0(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),r=!0;const n=[e];for(;t;){let s;if(Lo(e))s=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new yt(903,!1);s=t.\u0275dir}if(s){if(r){n.push(s);const m=e;m.inputs=au(e.inputs),m.inputTransforms=au(e.inputTransforms),m.declaredInputs=au(e.declaredInputs),m.outputs=au(e.outputs);const b=s.hostBindings;b&&rS(e,b);const T=s.viewQuery,R=s.contentQueries;if(T&&Hy(e,T),R&&Yg(e,R),xs(e.inputs,s.inputs),xs(e.declaredInputs,s.declaredInputs),xs(e.outputs,s.outputs),null!==s.inputTransforms&&(null===m.inputTransforms&&(m.inputTransforms={}),xs(m.inputTransforms,s.inputTransforms)),Lo(s)&&s.data.animation){const z=e.data;z.animation=(z.animation||[]).concat(s.data.animation)}}const u=s.features;if(u)for(let m=0;m<u.length;m++){const b=u[m];b&&b.ngInherit&&b(e),b===ki&&(r=!1)}}t=Object.getPrototypeOf(t)}!function oC(e){let t=0,r=null;for(let n=e.length-1;n>=0;n--){const s=e[n];s.hostVars=t+=s.hostVars,s.hostAttrs=Ks(s.hostAttrs,r=Ks(r,s.hostAttrs))}}(n)}function au(e){return e===Rs?{}:e===ir?[]:e}function Hy(e,t){const r=e.viewQuery;e.viewQuery=r?(n,s)=>{t(n,s),r(n,s)}:t}function Yg(e,t){const r=e.contentQueries;e.contentQueries=r?(n,s,u)=>{t(n,s,u),r(n,s,u)}:t}function rS(e,t){const r=e.hostBindings;e.hostBindings=r?(n,s)=>{t(n,s),r(n,s)}:t}function Jd(e){const t=e.inputConfig,r={};for(const n in t)if(t.hasOwnProperty(n)){const s=t[n];Array.isArray(s)&&s[2]&&(r[n]=s[2])}e.inputTransforms=r}function Xg(e){return!!Df(e)&&(Array.isArray(e)||!(e instanceof Map)&&Symbol.iterator in e)}function Df(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function lu(e,t,r){return e[t]=r}function Ds(e,t,r){return!Object.is(e[t],r)&&(e[t]=r,!0)}function th(e,t,r,n){const s=Ds(e,t,r);return Ds(e,t+1,n)||s}function Fr(e,t,r,n){const s=mt();return Ds(s,Os(),t)&&(un(),zl(bo(),s,e,t,r,n)),Fr}function $p(e,t,r,n){return Ds(e,Os(),r)?t+li(r)+n:Bi}function Gp(e,t,r,n,s,u){const b=th(e,function Yr(){return Ue.lFrame.bindingIndex}(),r,s);return Bo(2),b?t+li(r)+n+li(s)+u:Bi}function Ln(e,t,r,n,s,u,m,b){const T=mt(),R=un(),z=e+Li,W=R.firstCreatePass?function pS(e,t,r,n,s,u,m,b,T){const R=t.consts,z=Zu(t,e,4,m||null,ke(R,b));g0(t,r,z,ke(R,T)),Wh(t,z);const W=z.tView=m0(2,z,n,s,u,t.directiveRegistry,t.pipeRegistry,null,t.schemas,R,null);return null!==t.queries&&(t.queries.template(t,z),W.queries=t.queries.embeddedTView(z)),z}(z,R,T,t,r,n,s,u,m):R.data[z];ci(W,!1);const le=CC(R,T,W,e);$m()&&_g(R,T,le,W),Bs(le,T),Oy(T,T[z]=Yw(le,T,le,W)),Cr(W)&&Ay(R,T,W),null!=m&&p0(T,W,b)}let CC=function EC(e,t,r,n){return Fd(!0),t[wi].createComment("")};function Pa(e){return re(function No(){return Ue.lFrame.contextLView}(),Li+e)}function Be(e,t,r){const n=mt();return Ds(n,Os(),t)&&sl(un(),bo(),n,e,t,n[wi],r,!1),Be}function Xy(e,t,r,n,s){const m=s?"class":"style";su(e,r,t.inputs[m],m,n)}function ce(e,t,r,n){const s=mt(),u=un(),m=Li+e,b=s[wi],T=u.firstCreatePass?function TC(e,t,r,n,s,u){const m=t.consts,T=Zu(t,e,2,n,ke(m,s));return g0(t,r,T,ke(m,u)),null!==T.attrs&&By(T,T.attrs,!1),null!==T.mergedAttrs&&By(T,T.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,T),T}(m,u,s,t,r,n):u.data[m],R=z0(u,s,T,b,t,e);s[m]=R;const z=Cr(T);return ci(T,!0),sy(b,R,T),32!=(32&T.flags)&&$m()&&_g(u,s,R,T),0===function At(){return Ue.lFrame.elementDepthCount}()&&Bs(R,s),function vt(){Ue.lFrame.elementDepthCount++}(),z&&(Ay(u,s,T),ru(u,T,s)),null!==n&&p0(s,T),ce}function ue(){let e=hr();Ni()?fr():(e=e.parent,ci(e,!1));const t=e;(function nn(e){return Ue.skipHydrationRootTNode===e})(t)&&function _n(){Ue.skipHydrationRootTNode=null}(),function an(){Ue.lFrame.elementDepthCount--}();const r=un();return r.firstCreatePass&&(Wh(r,e),fi(e)&&r.queries.elementEnd(e)),null!=t.classesWithoutHost&&function Ls(e){return 0!=(8&e.flags)}(t)&&Xy(r,t,mt(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function Zh(e){return 0!=(16&e.flags)}(t)&&Xy(r,t,mt(),t.stylesWithoutHost,!1),ue}function it(e,t,r,n){return ce(e,t,r,n),ue(),it}let z0=(e,t,r,n,s,u)=>(Fd(!0),dg(n,s,function C1(){return Ue.lFrame.currentNamespace}()));function jr(e,t,r){const n=mt(),s=un(),u=e+Li,m=s.firstCreatePass?function V0(e,t,r,n,s){const u=t.consts,m=ke(u,n),b=Zu(t,e,8,"ng-container",m);return null!==m&&By(b,m,!0),g0(t,r,b,ke(u,s)),null!==t.queries&&t.queries.elementStart(t,b),b}(u,s,n,t,r):s.data[u];ci(m,!0);const b=n_(s,n,m,e);return n[u]=b,$m()&&_g(s,n,b,m),Bs(b,n),Cr(m)&&(Ay(s,n,m),ru(s,m,n)),null!=r&&p0(n,m),jr}function Ur(){let e=hr();const t=un();return Ni()?fr():(e=e.parent,ci(e,!1)),t.firstCreatePass&&(Wh(t,e),fi(e)&&t.queries.elementEnd(e)),Ur}let n_=(e,t,r,n)=>(Fd(!0),ug(t[wi],""));function Sr(){return mt()}function Qp(e){return!!e&&"function"==typeof e.then}function Qy(e){return!!e&&"function"==typeof e.subscribe}function zt(e,t,r,n){const s=mt(),u=un(),m=hr();return Jy(u,s,s[wi],m,e,t,n),zt}function Jp(e,t){const r=hr(),n=mt(),s=un();return Jy(s,n,al(jm(s.data),r,n),r,e,t),Jp}function Jy(e,t,r,n,s,u,m){const b=Cr(n),R=e.firstCreatePass&&qg(e),z=t[sr],W=ou(t);let le=!0;if(3&n.type||m){const Ve=oe(n,t),at=m?m(Ve):Ve,wt=W.length,ft=m?Sn=>m(K(Sn[n.index])):n.index;let Nn=null;if(!m&&b&&(Nn=function yS(e,t,r,n){const s=e.cleanup;if(null!=s)for(let u=0;u<s.length-1;u+=2){const m=s[u];if(m===r&&s[u+1]===n){const b=t[ac],T=s[u+2];return b.length>T?b[T]:null}"string"==typeof m&&(u+=2)}return null}(e,t,s,n.index)),null!==Nn)(Nn.__ngLastListenerFn__||Nn).__ngNextListenerFn__=u,Nn.__ngLastListenerFn__=u,le=!1;else{u=ev(n,t,z,u,!1);const Sn=r.listen(at,s,u);W.push(u,Sn),R&&R.push(s,ft,wt,wt+1)}}else u=ev(n,t,z,u,!1);const he=n.outputs;let Me;if(le&&null!==he&&(Me=he[s])){const Ve=Me.length;if(Ve)for(let at=0;at<Ve;at+=2){const Ri=t[Me[at]][Me[at+1]].subscribe(u),lo=W.length;W.push(u,Ri),R&&R.push(s,n.index,lo,-(lo+1))}}}function U0(e,t,r,n){try{return G(6,t,r),!1!==r(n)}catch(s){return _c(e,s),!1}finally{G(7,t,r)}}function ev(e,t,r,n,s){return function u(m){if(m===Function)return n;fs(e.componentOffset>-1?ae(e.index,t):t);let T=U0(t,r,n,m),R=u.__ngNextListenerFn__;for(;R;)T=U0(t,r,R,m)&&T,R=R.__ngNextListenerFn__;return s&&!1===T&&m.preventDefault(),T}}function Dn(e=1){return function b1(e){return(Ue.lFrame.contextLView=function x1(e,t){for(;e>0;)t=t[Qs],e--;return t}(e,Ue.lFrame.contextLView))[sr]}(e)}function SC(e,t){let r=null;const n=function Dd(e){const t=e.attrs;if(null!=t){const r=t.indexOf(5);if(!(1&r))return t[r+1]}return null}(e);for(let s=0;s<t.length;s++){const u=t[s];if("*"!==u){if(null===n?oi(e,u,!0):sc(n,u))return s}else r=s}return r}function If(e){const t=mt()[no][Pr];if(!t.projection){const n=t.projection=gp(e?e.length:1,null),s=n.slice();let u=t.child;for(;null!==u;){const m=e?SC(u,e):0;null!==m&&(s[m]?s[m].projectionNext=u:n[m]=u,s[m]=u),u=u.next}}}function Ku(e,t=0,r){const n=mt(),s=un(),u=Zu(s,Li+e,16,null,r||null);null===u.projection&&(u.projection=t),fr(),(!n[Js]||mn())&&32!=(32&u.flags)&&function vg(e,t,r){oy(t[wi],0,t,r,fc(e,r,t),mg(r.parent||t[Pr],r,t))}(s,n,u)}function bc(e,t,r){return em(e,"",t,"",r),bc}function em(e,t,r,n,s){const u=mt(),m=$p(u,t,r,n);return m!==Bi&&sl(un(),bo(),u,e,m,u[wi],s,!1),em}function tv(e,t){return e<<17|t<<2}function ih(e){return e>>17&32767}function q0(e){return 2|e}function rh(e){return(131068&e)>>2}function i_(e,t){return-131069&e|t<<2}function nv(e){return 1|e}function i(e,t,r,n,s){const u=e[r+1],m=null===t;let b=n?ih(u):rh(u),T=!1;for(;0!==b&&(!1===T||m);){const z=e[b+1];a(e[b],t)&&(T=!0,e[b+1]=n?nv(z):q0(z)),b=n?ih(z):rh(z)}T&&(e[r+1]=n?q0(u):nv(u))}function a(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&Ta(e,t)>=0}const l={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function d(e){return e.substring(l.key,l.keyEnd)}function y(e,t){const r=l.textEnd;return r===t?-1:(t=l.keyEnd=function k(e,t,r){for(;t<r&&e.charCodeAt(t)>32;)t++;return t}(e,l.key=t,r),M(e,t,r))}function M(e,t,r){for(;t<r&&e.charCodeAt(t)<=32;)t++;return t}function te(e,t,r){return Ie(e,t,r,!1),te}function ie(e,t){return Ie(e,t,null,!0),ie}function pe(e){!function Pe(e,t,r,n){const s=un(),u=Bo(2);s.firstUpdatePass&&je(s,null,u,n);const m=mt();if(r!==Bi&&Ds(m,u,r)){const b=s.data[Fs()];if(Bt(b,n)&&!Ze(s,u)){let T=n?b.classesWithoutHost:b.stylesWithoutHost;null!==T&&(r=ks(T,r||"")),Xy(s,b,m,r,n)}else!function ln(e,t,r,n,s,u,m,b){s===Bi&&(s=ir);let T=0,R=0,z=0<s.length?s[0]:null,W=0<u.length?u[0]:null;for(;null!==z||null!==W;){const le=T<s.length?s[T+1]:void 0,he=R<u.length?u[R+1]:void 0;let Ve,Me=null;z===W?(T+=2,R+=2,le!==he&&(Me=W,Ve=he)):null===W||null!==z&&z<W?(T+=2,Me=z):(R+=2,Me=W,Ve=he),null!==Me&&Gt(e,t,r,n,Me,Ve,m,b),z=T<s.length?s[T]:null,W=R<u.length?u[R]:null}}(s,b,m,m[wi],m[u+1],m[u+1]=function on(e,t,r){if(null==r||""===r)return ir;const n=[],s=zs(r);if(Array.isArray(s))for(let u=0;u<s.length;u++)e(n,s[u],!0);else if("object"==typeof s)for(const u in s)s.hasOwnProperty(u)&&e(n,u,s[u]);else"string"==typeof s&&t(n,s);return n}(e,t,r),n,u)}}(On,Ee,e,!0)}function Ee(e,t){for(let r=function g(e){return function D(e){l.key=0,l.keyEnd=0,l.value=0,l.valueEnd=0,l.textEnd=e.length}(e),y(e,M(e,0,l.textEnd))}(t);r>=0;r=y(t,r))Da(e,d(t),!0)}function Ie(e,t,r,n){const s=mt(),u=un(),m=Bo(2);u.firstUpdatePass&&je(u,e,m,n),t!==Bi&&Ds(s,m,t)&&Gt(u,u.data[Fs()],s,s[wi],e,s[m+1]=function Tn(e,t){return null==e||""===e||("string"==typeof t?e+=t:"object"==typeof e&&(e=jn(zs(e)))),e}(t,r),n,m)}function Ze(e,t){return t>=e.expandoStartIndex}function je(e,t,r,n){const s=e.data;if(null===s[r+1]){const u=s[Fs()],m=Ze(e,r);Bt(u,n)&&null===t&&!m&&(t=!1),t=function dt(e,t,r,n){const s=jm(e);let u=n?t.residualClasses:t.residualStyles;if(null===s)0===(n?t.classBindings:t.styleBindings)&&(r=$t(r=et(null,e,t,r,n),t.attrs,n),u=null);else{const m=t.directiveStylingLast;if(-1===m||e[m]!==s)if(r=et(s,e,t,r,n),null===u){let T=function Pt(e,t,r){const n=r?t.classBindings:t.styleBindings;if(0!==rh(n))return e[ih(n)]}(e,t,n);void 0!==T&&Array.isArray(T)&&(T=et(null,e,t,T[1],n),T=$t(T,t.attrs,n),function st(e,t,r,n){e[ih(r?t.classBindings:t.styleBindings)]=n}(e,t,n,T))}else u=function Tt(e,t,r){let n;const s=t.directiveEnd;for(let u=1+t.directiveStylingLast;u<s;u++)n=$t(n,e[u].hostAttrs,r);return $t(n,t.attrs,r)}(e,t,n)}return void 0!==u&&(n?t.residualClasses=u:t.residualStyles=u),r}(s,u,t,n),function PC(e,t,r,n,s,u){let m=u?t.classBindings:t.styleBindings,b=ih(m),T=rh(m);e[n]=r;let z,R=!1;if(Array.isArray(r)?(z=r[1],(null===z||Ta(r,z)>0)&&(R=!0)):z=r,s)if(0!==T){const le=ih(e[b+1]);e[n+1]=tv(le,b),0!==le&&(e[le+1]=i_(e[le+1],n)),e[b+1]=function vS(e,t){return 131071&e|t<<17}(e[b+1],n)}else e[n+1]=tv(b,0),0!==b&&(e[b+1]=i_(e[b+1],n)),b=n;else e[n+1]=tv(T,0),0===b?b=n:e[T+1]=i_(e[T+1],n),T=n;R&&(e[n+1]=q0(e[n+1])),i(e,z,n,!0),i(e,z,n,!1),function o(e,t,r,n,s){const u=s?e.residualClasses:e.residualStyles;null!=u&&"string"==typeof t&&Ta(u,t)>=0&&(r[n+1]=nv(r[n+1]))}(t,z,e,n,u),m=tv(b,T),u?t.classBindings=m:t.styleBindings=m}(s,u,t,r,m,n)}}function et(e,t,r,n,s){let u=null;const m=r.directiveEnd;let b=r.directiveStylingLast;for(-1===b?b=r.directiveStart:b++;b<m&&(u=t[b],n=$t(n,u.hostAttrs,s),u!==e);)b++;return null!==e&&(r.directiveStylingLast=b),n}function $t(e,t,r){const n=r?1:2;let s=-1;if(null!==t)for(let u=0;u<t.length;u++){const m=t[u];"number"==typeof m?s=m:s===n&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Da(e,m,!!r||t[++u]))}return void 0===e?null:e}function On(e,t,r){const n=String(t);""!==n&&!n.includes(" ")&&Da(e,n,r)}function Gt(e,t,r,n,s,u,m,b){if(!(3&t.type))return;const T=e.data,R=T[b+1],z=function W0(e){return 1==(1&e)}(R)?An(T,t,r,s,rh(R),m):void 0;dn(z)||(dn(u)||function kC(e){return 2==(2&e)}(R)&&(u=An(T,null,r,s,b,m)),function er(e,t,r,n,s){if(t)s?e.addClass(r,n):e.removeClass(r,n);else{let u=-1===n.indexOf("-")?void 0:Vu.DashCase;null==s?e.removeStyle(r,n,u):("string"==typeof s&&s.endsWith("!important")&&(s=s.slice(0,-10),u|=Vu.Important),e.setStyle(r,n,s,u))}}(n,m,J(Fs(),r),s,u))}function An(e,t,r,n,s,u){const m=null===t;let b;for(;s>0;){const T=e[s],R=Array.isArray(T),z=R?T[1]:T,W=null===z;let le=r[s+1];le===Bi&&(le=W?ir:void 0);let he=W?W_(le,n):z===n?le:void 0;if(R&&!dn(he)&&(he=W_(T,n)),dn(he)&&(b=he,m))return b;const Me=e[s+1];s=m?ih(Me):rh(Me)}if(null!==t){let T=u?t.residualClasses:t.residualStyles;null!=T&&(b=W_(T,n))}return b}function dn(e){return void 0!==e}function Bt(e,t){return 0!=(e.flags&(t?8:16))}function Te(e,t=""){const r=mt(),n=un(),s=e+Li,u=n.firstCreatePass?Zu(n,s,1,t,null):n.data[s],m=vi(n,r,u,t,e);r[s]=m,$m()&&_g(n,r,m,u),ci(u,!1)}let vi=(e,t,r,n,s)=>(Fd(!0),function vp(e,t){return e.createText(t)}(t[wi],n));function hn(e){return Xn("",e,""),hn}function Xn(e,t,r){const n=mt(),s=$p(n,e,t,r);return s!==Bi&&ps(n,Fs(),s),Xn}function Kn(e,t,r,n,s){const u=mt(),m=Gp(u,e,t,r,n,s);return m!==Bi&&ps(u,Fs(),m),Kn}function du(e,t,r){const n=mt();return Ds(n,Os(),t)&&sl(un(),bo(),n,e,t,n[wi],r,!0),du}function kf(e,t,r){const n=mt();if(Ds(n,Os(),t)){const u=un(),m=bo();sl(u,m,n,e,t,al(jm(u.data),m,n),r,!0)}return kf}const td=void 0;var oh=["en",[["a","p"],["AM","PM"],td],[["AM","PM"],td,td],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],td,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],td,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",td,"{1} 'at' {0}",td],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function ex(e){const r=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===r&&0===n?1:5}];let sh={};function Hr(e){const t=function oN(e){return e.toLowerCase().replace(/_/g,"-")}(e);let r=tx(t);if(r)return r;const n=t.split("-")[0];if(r=tx(n),r)return r;if("en"===n)return oh;throw new yt(701,!1)}function tx(e){return e in sh||(sh[e]=In.ng&&In.ng.common&&In.ng.common.locales&&In.ng.common.locales[e]),sh[e]}var xo=function(e){return e[e.LocaleId=0]="LocaleId",e[e.DayPeriodsFormat=1]="DayPeriodsFormat",e[e.DayPeriodsStandalone=2]="DayPeriodsStandalone",e[e.DaysFormat=3]="DaysFormat",e[e.DaysStandalone=4]="DaysStandalone",e[e.MonthsFormat=5]="MonthsFormat",e[e.MonthsStandalone=6]="MonthsStandalone",e[e.Eras=7]="Eras",e[e.FirstDayOfWeek=8]="FirstDayOfWeek",e[e.WeekendRange=9]="WeekendRange",e[e.DateFormat=10]="DateFormat",e[e.TimeFormat=11]="TimeFormat",e[e.DateTimeFormat=12]="DateTimeFormat",e[e.NumberSymbols=13]="NumberSymbols",e[e.NumberFormats=14]="NumberFormats",e[e.CurrencyCode=15]="CurrencyCode",e[e.CurrencySymbol=16]="CurrencySymbol",e[e.CurrencyName=17]="CurrencyName",e[e.Currencies=18]="Currencies",e[e.Directionality=19]="Directionality",e[e.PluralCase=20]="PluralCase",e[e.ExtraData=21]="ExtraData",e}(xo||{});const av="en-US";let hI=av;function wS(e,t,r,n,s){if(e=$n(e),Array.isArray(e))for(let u=0;u<e.length;u++)wS(e[u],t,r,n,s);else{const u=un(),m=mt(),b=hr();let T=mc(e)?e:$n(e.provide);const R=xw(e),z=1048575&b.providerIndexes,W=b.directiveStart,le=b.providerIndexes>>20;if(mc(e)||!e.multi){const he=new hp(R,s,xe),Me=ES(T,t,s?z:z+le,W);-1===Me?(Xv(Wc(b,m),u,T),CS(u,e,t.length),t.push(T),b.directiveStart++,b.directiveEnd++,s&&(b.providerIndexes+=1048576),r.push(he),m.push(he)):(r[Me]=he,m[Me]=he)}else{const he=ES(T,t,z+le,W),Me=ES(T,t,z,z+le),at=Me>=0&&r[Me];if(s&&!at||!s&&!(he>=0&&r[he])){Xv(Wc(b,m),u,T);const wt=function iB(e,t,r,n,s){const u=new hp(e,r,xe);return u.multi=[],u.index=t,u.componentProviders=0,NI(u,s,n&&!r),u}(s?nB:tB,r.length,s,n,R);!s&&at&&(r[Me].providerFactory=wt),CS(u,e,t.length,0),t.push(T),b.directiveStart++,b.directiveEnd++,s&&(b.providerIndexes+=1048576),r.push(wt),m.push(wt)}else CS(u,e,he>-1?he:Me,NI(r[s?Me:he],R,!s&&n));!s&&n&&at&&r[Me].componentProviders++}}}function CS(e,t,r,n){const s=mc(t),u=function bw(e){return!!e.useClass}(t);if(s||u){const T=(u?$n(t.useClass):t).prototype.ngOnDestroy;if(T){const R=e.destroyHooks||(e.destroyHooks=[]);if(!s&&t.multi){const z=R.indexOf(r);-1===z?R.push(r,[n,T]):R[z+1].push(n,T)}else R.push(r,T)}}}function NI(e,t,r){return r&&e.componentProviders++,e.multi.push(t)-1}function ES(e,t,r,n){for(let s=r;s<n;s++)if(t[s]===e)return s;return-1}function tB(e,t,r,n){return DS(this.multi,[])}function nB(e,t,r,n){const s=this.multi;let u;if(this.providerFactory){const m=this.providerFactory.componentProviders,b=Xh(r,r[kn],this.providerFactory.index,n);u=b.slice(0,m),DS(s,u);for(let T=m;T<b.length;T++)u.push(b[T])}else u=[],DS(s,u);return u}function DS(e,t){for(let r=0;r<e.length;r++)t.push((0,e[r])());return t}function $r(e,t=[]){return r=>{r.providersResolver=(n,s)=>function eB(e,t,r){const n=un();if(n.firstCreatePass){const s=Lo(e);wS(r,n.data,n.blueprint,s,!0),wS(t,n.data,n.blueprint,s,!1)}}(n,s?s(e):e,t)}}class s_{}class BI{}class TS extends s_{constructor(t,r,n){super(),this._parent=r,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Qw(this);const s=to(t);this._bootstrapComponents=iu(s.bootstrap),this._r3Injector=Pg(t,r,[{provide:s_,useValue:this},{provide:Xd,useValue:this.componentFactoryResolver},...n],jn(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(r=>r()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class SS extends BI{constructor(t){super(),this.moduleType=t}create(t){return new TS(this.moduleType,t,[])}}class zI extends s_{constructor(t){super(),this.componentFactoryResolver=new Qw(this),this.instance=null;const r=new _y([...t.providers,{provide:s_,useValue:this},{provide:Xd,useValue:this.componentFactoryResolver}],t.parent||ff(),t.debugName,new Set(["environment"]));this.injector=r,t.runEnvironmentInitializers&&r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function MS(e,t,r=null){return new zI({providers:e,parent:t,debugName:r,runEnvironmentInitializers:!0}).injector}let sB=(()=>{var e;class t{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const s=fy(0,n.type),u=s.length>0?MS([s],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,u)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}}return(e=t).\u0275prov=Ut({token:e,providedIn:"environment",factory:()=>new e(ze(ra))}),t})();function VC(e){e.getStandaloneInjector=t=>t.get(sB).getOrCreateStandaloneInjector(e)}function Pf(e,t,r,n){return qI(mt(),Er(),e,t,r,n)}function ax(e,t){const r=e[t];return r===Bi?void 0:r}function qI(e,t,r,n,s,u){const m=t+r;return Ds(e,m,s)?lu(e,m+1,u?n.call(u,s):n(s)):ax(e,m+1)}function go(e,t){const r=un();let n;const s=e+Li;r.firstCreatePass?(n=function EB(e,t){if(t)for(let r=t.length-1;r>=0;r--){const n=t[r];if(e===n.name)return n}}(t,r.pipeRegistry),r.data[s]=n,n.onDestroy&&(r.destroyHooks??=[]).push(s,n.onDestroy)):n=r.data[s];const u=n.factory||(n.factory=Sl(n.type)),b=ho(xe);try{const T=fp(!1),R=u();return fp(T),function DC(e,t,r,n){r>=e.data.length&&(e.data[r]=null,e.blueprint[r]=null),t[r]=n}(r,mt(),s,R),R}finally{ho(b)}}function ms(e,t,r){const n=e+Li,s=mt(),u=re(s,n);return lx(s,n)?qI(s,Er(),t,u.transform,r,u):u.transform(r)}function im(e,t,r,n){const s=e+Li,u=mt(),m=re(u,s);return lx(u,s)?function WI(e,t,r,n,s,u,m){const b=t+r;return th(e,b,s,u)?lu(e,b+2,m?n.call(m,s,u):n(s,u)):ax(e,b+2)}(u,Er(),t,m.transform,r,n,m):m.transform(r,n)}function lx(e,t){return e[kn].data[t].pure}function MB(){return this._results[Symbol.iterator]()}class IS{get changes(){return this._changes||(this._changes=new Wn)}constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const r=IS.prototype;r[Symbol.iterator]||(r[Symbol.iterator]=MB)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,r){return this._results.reduce(t,r)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,r){const n=this;n.dirty=!1;const s=function Xo(e){return e.flat(Number.POSITIVE_INFINITY)}(t);(this._changesDetected=!function Jv(e,t,r){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++){let s=e[n],u=t[n];if(r&&(s=r(s),u=r(u)),u!==s)return!1}return!0}(n._results,s,r))&&(n._results=s,n.length=s.length,n.last=s[this.length-1],n.first=s[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function IB(e,t,r,n=!0){const s=t[kn];if(function Fl(e,t,r,n){const s=X+n,u=r.length;n>0&&(r[s-1][Fo]=t),n<u-X?(t[Fo]=r[s],eb(r,X+n,t)):(r.push(t),t[Fo]=null),t[Rr]=r;const m=t[lc];null!==m&&r!==m&&function Ll(e,t){const r=e[L];t[no]!==t[Rr][Rr][no]&&(e[Ka]=!0),null===r?e[L]=[t]:r.push(t)}(m,t);const b=t[Es];null!==b&&b.insertView(e),t[yi]|=128}(s,t,e,r),n){const u=ry(r,e),m=t[wi],b=Qc(m,e[hs]);null!==b&&function tT(e,t,r,n,s,u){n[Vr]=s,n[Pr]=t,yg(e,n,r,1,s,u)}(s,e[Pr],m,t,b,u)}}let ah=(()=>{class t{}return t.__NG_ELEMENT_ID__=PB,t})();const kB=ah,RB=class extends kB{constructor(t,r,n){super(),this._declarationLView=t,this._declarationTContainer=r,this.elementRef=n}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,r){return this.createEmbeddedViewImpl(t,r)}createEmbeddedViewImpl(t,r,n){const s=function AB(e,t,r,n){const s=t.tView,b=Ng(e,s,r,4096&e[yi]?4096:16,null,t,null,null,null,n?.injector??null,n?.hydrationInfo??null);b[lc]=e[t.index];const R=e[Es];return null!==R&&(b[Es]=R.createEmbeddedView(s)),Ly(s,b,r),b}(this._declarationLView,this._declarationTContainer,t,{injector:r,hydrationInfo:n});return new Xu(s)}};function PB(){return jC(hr(),mt())}function jC(e,t){return 4&e.type?new RB(t,e,mf(e,t)):null}let Hl=(()=>{class t{}return t.__NG_ELEMENT_ID__=zB,t})();function zB(){return ik(hr(),mt())}const VB=Hl,tk=class extends VB{constructor(t,r,n){super(),this._lContainer=t,this._hostTNode=r,this._hostLView=n}get element(){return mf(this._hostTNode,this._hostLView)}get injector(){return new Ns(this._hostTNode,this._hostLView)}get parentInjector(){const t=$_(this._hostTNode,this._hostLView);if(H_(t)){const r=Zm(t,this._hostLView),n=qm(t);return new Ns(r[kn].data[n+8],r)}return new Ns(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const r=nk(this._lContainer);return null!==r&&r[t]||null}get length(){return this._lContainer.length-X}createEmbeddedView(t,r,n){let s,u;"number"==typeof n?s=n:null!=n&&(s=n.index,u=n.injector);const b=t.createEmbeddedViewImpl(r||{},u,null);return this.insertImpl(b,s,false),b}createComponent(t,r,n,s,u){const m=t&&!function qn(e){return"function"==typeof e}(t);let b;if(m)b=r;else{const Ve=r||{};b=Ve.index,n=Ve.injector,s=Ve.projectableNodes,u=Ve.environmentInjector||Ve.ngModuleRef}const T=m?t:new Zg(Fi(t)),R=n||this.parentInjector;if(!u&&null==T.ngModule){const at=(m?R:this.parentInjector).get(ra,null);at&&(u=at)}Fi(T.componentType??{});const he=T.create(R,s,null,u);return this.insertImpl(he.hostView,b,false),he}insert(t,r){return this.insertImpl(t,r,!1)}insertImpl(t,r,n){const s=t._lView;if(function Ce(e){return yn(e[Rr])}(s)){const T=this.indexOf(t);if(-1!==T)this.detach(T);else{const R=s[Rr],z=new tk(R,R[Pr],R[Rr]);z.detach(z.indexOf(t))}}const m=this._adjustIndex(r),b=this._lContainer;return IB(b,s,m,!n),t.attachToViewContainerRef(),eb(kS(b),m,t),t}move(t,r){return this.insert(t,r)}indexOf(t){const r=nk(this._lContainer);return null!==r?r.indexOf(t):-1}remove(t){const r=this._adjustIndex(t,-1),n=sf(this._lContainer,r);n&&(Km(kS(this._lContainer),r),ny(n[kn],n))}detach(t){const r=this._adjustIndex(t,-1),n=sf(this._lContainer,r);return n&&null!=Km(kS(this._lContainer),r)?new Xu(n):null}_adjustIndex(t,r=0){return t??this.length+r}};function nk(e){return e[8]}function kS(e){return e[8]||(e[8]=[])}function ik(e,t){let r;const n=t[e.index];return yn(n)?r=n:(r=Yw(n,t,null,e),t[e.index]=r,Oy(t,r)),rk(r,t,e,n),new tk(r,e,t)}let rk=function ok(e,t,r,n){if(e[hs])return;let s;s=8&r.type?K(n):function jB(e,t){const r=e[wi],n=r.createComment(""),s=oe(t,e);return Hd(r,Qc(r,s),n,function pg(e,t){return e.nextSibling(t)}(r,s),!1),n}(t,r),e[hs]=s};class RS{constructor(t){this.queryList=t,this.matches=null}clone(){return new RS(this.queryList)}setDirty(){this.queryList.setDirty()}}class PS{constructor(t=[]){this.queries=t}createEmbeddedView(t){const r=t.queries;if(null!==r){const n=null!==t.contentQueries?t.contentQueries[0]:r.length,s=[];for(let u=0;u<n;u++){const m=r.getByIndex(u);s.push(this.queries[m.indexInDeclarationView].clone())}return new PS(s)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let r=0;r<this.queries.length;r++)null!==dk(t,r).matches&&this.queries[r].setDirty()}}class sk{constructor(t,r,n=null){this.predicate=t,this.flags=r,this.read=n}}class OS{constructor(t=[]){this.queries=t}elementStart(t,r){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(t,r)}elementEnd(t){for(let r=0;r<this.queries.length;r++)this.queries[r].elementEnd(t)}embeddedTView(t){let r=null;for(let n=0;n<this.length;n++){const s=null!==r?r.length:0,u=this.getByIndex(n).embeddedTView(t,s);u&&(u.indexInDeclarationView=n,null!==r?r.push(u):r=[u])}return null!==r?new OS(r):null}template(t,r){for(let n=0;n<this.queries.length;n++)this.queries[n].template(t,r)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class FS{constructor(t,r=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=r}elementStart(t,r){this.isApplyingToNode(r)&&this.matchTNode(t,r)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,r){this.elementStart(t,r)}embeddedTView(t,r){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,r),new FS(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const r=this._declarationNodeIndex;let n=t.parent;for(;null!==n&&8&n.type&&n.index!==r;)n=n.parent;return r===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(t,r){const n=this.metadata.predicate;if(Array.isArray(n))for(let s=0;s<n.length;s++){const u=n[s];this.matchTNodeWithReadOption(t,r,$B(r,u)),this.matchTNodeWithReadOption(t,r,Ym(r,t,u,!1,!1))}else n===ah?4&r.type&&this.matchTNodeWithReadOption(t,r,-1):this.matchTNodeWithReadOption(t,r,Ym(r,t,n,!1,!1))}matchTNodeWithReadOption(t,r,n){if(null!==n){const s=this.metadata.read;if(null!==s)if(s===tr||s===Hl||s===ah&&4&r.type)this.addMatch(r.index,-2);else{const u=Ym(r,t,s,!1,!1);null!==u&&this.addMatch(r.index,u)}else this.addMatch(r.index,n)}}addMatch(t,r){null===this.matches?this.matches=[t,r]:this.matches.push(t,r)}}function $B(e,t){const r=e.localNames;if(null!==r)for(let n=0;n<r.length;n+=2)if(r[n]===t)return r[n+1];return null}function qB(e,t,r,n){return-1===r?function GB(e,t){return 11&e.type?mf(e,t):4&e.type?jC(e,t):null}(t,e):-2===r?function WB(e,t,r){return r===tr?mf(t,e):r===ah?jC(t,e):r===Hl?ik(t,e):void 0}(e,t,n):Xh(e,e[kn],r,t)}function ak(e,t,r,n){const s=t[Es].queries[n];if(null===s.matches){const u=e.data,m=r.matches,b=[];for(let T=0;T<m.length;T+=2){const R=m[T];b.push(R<0?null:qB(t,u[R],m[T+1],r.metadata.read))}s.matches=b}return s.matches}function LS(e,t,r,n){const s=e.queries.getByIndex(r),u=s.matches;if(null!==u){const m=ak(e,t,s,r);for(let b=0;b<u.length;b+=2){const T=u[b];if(T>0)n.push(m[b/2]);else{const R=u[b+1],z=t[-T];for(let W=X;W<z.length;W++){const le=z[W];le[lc]===le[Rr]&&LS(le[kn],le,R,n)}if(null!==z[L]){const W=z[L];for(let le=0;le<W.length;le++){const he=W[le];LS(he[kn],he,R,n)}}}}}return n}function Oa(e){const t=mt(),r=un(),n=F_();Gh(n+1);const s=dk(r,n);if(e.dirty&&function be(e){return 4==(4&e[yi])}(t)===(2==(2&s.metadata.flags))){if(null===s.matches)e.reset([]);else{const u=s.crossesNgTemplate?LS(r,t,n,[]):ak(r,t,s,n);e.reset(u,OT),e.notifyOnChanges()}return!0}return!1}function ul(e,t,r){const n=un();n.firstCreatePass&&(uk(n,new sk(e,t,r),-1),2==(2&t)&&(n.staticViewQueries=!0)),ck(n,mt(),t)}function Fa(){return function ZB(e,t){return e[Es].queries[t].queryList}(mt(),F_())}function ck(e,t,r){const n=new IS(4==(4&r));(function qT(e,t,r,n){const s=ou(t);s.push(r),e.firstCreatePass&&qg(e).push(n,s.length-1)})(e,t,n,n.destroy),null===t[Es]&&(t[Es]=new PS),t[Es].queries.push(new RS(n))}function uk(e,t,r){null===e.queries&&(e.queries=new OS),e.queries.track(new FS(t,r))}function dk(e,t){return e.queries.getByIndex(t)}const US=new Kt("Application Initializer");let HS=(()=>{var e;class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,s)=>{this.resolve=n,this.reject=s}),this.appInits=Jt(US,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const n=[];for(const u of this.appInits){const m=u();if(Qp(m))n.push(m);else if(Qy(m)){const b=new Promise((T,R)=>{m.subscribe({complete:T,error:R})});n.push(b)}}const s=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{s()}).catch(u=>{this.reject(u)}),0===n.length&&s(),this.initialized=!0}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),Mk=(()=>{var e;class t{log(n){console.log(n)}warn(n){console.warn(n)}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"platform"}),t})();const lh=new Kt("LocaleId",{providedIn:"root",factory:()=>Jt(lh,ri.Optional|ri.SkipSelf)||function _z(){return typeof $localize<"u"&&$localize.locale||av}()});let $C=(()=>{var e;class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new ui(!1)}add(){this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();class bz{constructor(t,r){this.ngModuleFactory=t,this.componentFactories=r}}let Ak=(()=>{var e;class t{compileModuleSync(n){return new SS(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const s=this.compileModuleSync(n),m=iu(to(n).declarations).reduce((b,T)=>{const R=Fi(T);return R&&b.push(new Zg(R)),b},[]);return new bz(s,m)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();const Pk=new Kt(""),qC=new Kt("");let ZS,qS=(()=>{var e;class t{constructor(n,s,u){this._ngZone=n,this.registry=s,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,ZS||(function Vz(e){ZS=e}(u),u.addToWindow(s)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{si.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(s=>!s.updateCb||!s.updateCb(n)||(clearTimeout(s.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,s,u){let m=-1;s&&s>0&&(m=setTimeout(()=>{this._callbacks=this._callbacks.filter(b=>b.timeoutId!==m),n(this._didWork,this.getPendingTasks())},s)),this._callbacks.push({doneCb:n,timeoutId:m,updateCb:u})}whenStable(n,s,u){if(u&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,s,u),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,s,u){return[]}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(si),ze(WS),ze(qC))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})(),WS=(()=>{var e;class t{constructor(){this._applications=new Map}registerApplication(n,s){this._applications.set(n,s)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,s=!0){return ZS?.findTestabilityInTree(this,n,s)??null}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"platform"}),t})(),rm=null;const Ok=new Kt("AllowMultipleToken"),YS=new Kt("PlatformDestroyListeners"),XS=new Kt("appBootstrapListener");class Lk{constructor(t,r){this.name=t,this.token=r}}function Bk(e,t,r=[]){const n=`Platform: ${t}`,s=new Kt(n);return(u=[])=>{let m=KS();if(!m||m.injector.get(Ok,!1)){const b=[...r,...u,{provide:s,useValue:!0}];e?e(b):function Hz(e){if(rm&&!rm.get(Ok,!1))throw new yt(400,!1);(function Fk(){!function Vv(e){$h=e}(()=>{throw new yt(600,!1)})})(),rm=e;const t=e.get(Vk);(function Nk(e){e.get(Ig,null)?.forEach(r=>r())})(e)}(function zk(e=[],t){return Xr.create({name:t,providers:[{provide:gy,useValue:"platform"},{provide:YS,useValue:new Set([()=>rm=null])},...e]})}(b,n))}return function Gz(e){const t=KS();if(!t)throw new yt(401,!1);return t}()}}function KS(){return rm?.get(Vk)??null}let Vk=(()=>{var e;class t{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,s){const u=function qz(e="zone.js",t){return"noop"===e?new Fw:"zone.js"===e?new si(t):e}(s?.ngZone,function jk(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}({eventCoalescing:s?.ngZoneEventCoalescing,runCoalescing:s?.ngZoneRunCoalescing}));return u.run(()=>{const m=function oB(e,t,r){return new TS(e,t,r)}(n.moduleType,this.injector,function qk(e){return[{provide:si,useFactory:e},{provide:Eg,multi:!0,useFactory:()=>{const t=Jt(Zz,{optional:!0});return()=>t.initialize()}},{provide:Gk,useFactory:Wz},{provide:Sy,useFactory:r0}]}(()=>u)),b=m.injector.get(qu,null);return u.runOutsideAngular(()=>{const T=u.onError.subscribe({next:R=>{b.handleError(R)}});m.onDestroy(()=>{WC(this._modules,m),T.unsubscribe()})}),function Uk(e,t,r){try{const n=r();return Qp(n)?n.catch(s=>{throw t.runOutsideAngular(()=>e.handleError(s)),s}):n}catch(n){throw t.runOutsideAngular(()=>e.handleError(n)),n}}(b,u,()=>{const T=m.injector.get(HS);return T.runInitializers(),T.donePromise.then(()=>(function fI(e){us(e,"Expected localeId to be defined"),"string"==typeof e&&(hI=e.toLowerCase().replace(/_/g,"-"))}(m.injector.get(lh,av)||av),this._moduleDoBootstrap(m),m))})})}bootstrapModule(n,s=[]){const u=Hk({},s);return function jz(e,t,r){const n=new SS(r);return Promise.resolve(n)}(0,0,n).then(m=>this.bootstrapModuleFactory(m,u))}_moduleDoBootstrap(n){const s=n.injector.get(ch);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(u=>s.bootstrap(u));else{if(!n.instance.ngDoBootstrap)throw new yt(-403,!1);n.instance.ngDoBootstrap(s)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new yt(404,!1);this._modules.slice().forEach(s=>s.destroy()),this._destroyListeners.forEach(s=>s());const n=this._injector.get(YS,null);n&&(n.forEach(s=>s()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Xr))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"platform"}),t})();function Hk(e,t){return Array.isArray(t)?t.reduce(Hk,e):{...e,...t}}let ch=(()=>{var e;class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Jt(Gk),this.zoneIsStable=Jt(Sy),this.componentTypes=[],this.components=[],this.isStable=Jt($C).hasPendingTasks.pipe(pt(n=>n?Gn(!1):this.zoneIsStable),hi(),bh()),this._injector=Jt(ra)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,s){const u=n instanceof Ew;if(!this._injector.get(HS).done)throw!u&&function Ya(e){const t=Fi(e)||kr(e)||Go(e);return null!==t&&t.standalone}(n),new yt(405,!1);let b;b=u?n:this._injector.get(Xd).resolveComponentFactory(n),this.componentTypes.push(b.componentType);const T=function Uz(e){return e.isBoundToModule}(b)?void 0:this._injector.get(s_),z=b.create(Xr.NULL,[],s||b.selector,T),W=z.location.nativeElement,le=z.injector.get(Pk,null);return le?.registerApplication(W),z.onDestroy(()=>{this.detachView(z.hostView),WC(this.components,z),le?.unregisterApplication(W)}),this._loadComponent(z),z}tick(){if(this._runningTick)throw new yt(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1}}attachView(n){const s=n;this._views.push(s),s.attachToAppRef(this)}detachView(n){const s=n;WC(this._views,s),s.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const s=this._injector.get(XS,[]);s.push(...this._bootstrapListeners),s.forEach(u=>u(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>WC(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new yt(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();function WC(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const Gk=new Kt("",{providedIn:"root",factory:()=>Jt(qu).handleError.bind(void 0)});function Wz(){const e=Jt(si),t=Jt(qu);return r=>e.runOutsideAngular(()=>t.handleError(r))}let Zz=(()=>{var e;class t{constructor(){this.zone=Jt(si),this.applicationRef=Jt(ch)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();let La=(()=>{class t{}return t.__NG_ELEMENT_ID__=Xz,t})();function Xz(e){return function Kz(e,t,r){if(pi(e)&&!r){const n=ae(e.index,t);return new Xu(n,n)}return 47&e.type?new Xu(t[no],t):null}(hr(),mt(),16==(16&e))}class Xk{constructor(){}supports(t){return Xg(t)}create(t){return new r4(t)}}const n4=(e,t)=>t;class r4{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||n4}forEachItem(t){let r;for(r=this._itHead;null!==r;r=r._next)t(r)}forEachOperation(t){let r=this._itHead,n=this._removalsHead,s=0,u=null;for(;r||n;){const m=!n||r&&r.currentIndex<Qk(n,s,u)?r:n,b=Qk(m,s,u),T=m.currentIndex;if(m===n)s--,n=n._nextRemoved;else if(r=r._next,null==m.previousIndex)s++;else{u||(u=[]);const R=b-s,z=T-s;if(R!=z){for(let le=0;le<R;le++){const he=le<u.length?u[le]:u[le]=0,Me=he+le;z<=Me&&Me<R&&(u[le]=he+1)}u[m.previousIndex]=z-R}}b!==T&&t(m,b,T)}}forEachPreviousItem(t){let r;for(r=this._previousItHead;null!==r;r=r._nextPrevious)t(r)}forEachAddedItem(t){let r;for(r=this._additionsHead;null!==r;r=r._nextAdded)t(r)}forEachMovedItem(t){let r;for(r=this._movesHead;null!==r;r=r._nextMoved)t(r)}forEachRemovedItem(t){let r;for(r=this._removalsHead;null!==r;r=r._nextRemoved)t(r)}forEachIdentityChange(t){let r;for(r=this._identityChangesHead;null!==r;r=r._nextIdentityChange)t(r)}diff(t){if(null==t&&(t=[]),!Xg(t))throw new yt(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let s,u,m,r=this._itHead,n=!1;if(Array.isArray(t)){this.length=t.length;for(let b=0;b<this.length;b++)u=t[b],m=this._trackByFn(b,u),null!==r&&Object.is(r.trackById,m)?(n&&(r=this._verifyReinsertion(r,u,m,b)),Object.is(r.item,u)||this._addIdentityChange(r,u)):(r=this._mismatch(r,u,m,b),n=!0),r=r._next}else s=0,function lC(e,t){if(Array.isArray(e))for(let r=0;r<e.length;r++)t(e[r]);else{const r=e[Symbol.iterator]();let n;for(;!(n=r.next()).done;)t(n.value)}}(t,b=>{m=this._trackByFn(s,b),null!==r&&Object.is(r.trackById,m)?(n&&(r=this._verifyReinsertion(r,b,m,s)),Object.is(r.item,b)||this._addIdentityChange(r,b)):(r=this._mismatch(r,b,m,s),n=!0),r=r._next,s++}),this.length=s;return this._truncate(r),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,r,n,s){let u;return null===t?u=this._itTail:(u=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(t.item,r)||this._addIdentityChange(t,r),this._reinsertAfter(t,u,s)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,s))?(Object.is(t.item,r)||this._addIdentityChange(t,r),this._moveAfter(t,u,s)):t=this._addAfter(new o4(r,n),u,s),t}_verifyReinsertion(t,r,n,s){let u=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==u?t=this._reinsertAfter(u,t._prev,s):t.currentIndex!=s&&(t.currentIndex=s,this._addToMoves(t,s)),t}_truncate(t){for(;null!==t;){const r=t._next;this._addToRemovals(this._unlink(t)),t=r}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,r,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const s=t._prevRemoved,u=t._nextRemoved;return null===s?this._removalsHead=u:s._nextRemoved=u,null===u?this._removalsTail=s:u._prevRemoved=s,this._insertAfter(t,r,n),this._addToMoves(t,n),t}_moveAfter(t,r,n){return this._unlink(t),this._insertAfter(t,r,n),this._addToMoves(t,n),t}_addAfter(t,r,n){return this._insertAfter(t,r,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,r,n){const s=null===r?this._itHead:r._next;return t._next=s,t._prev=r,null===s?this._itTail=t:s._prev=t,null===r?this._itHead=t:r._next=t,null===this._linkedRecords&&(this._linkedRecords=new Kk),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const r=t._prev,n=t._next;return null===r?this._itHead=n:r._next=n,null===n?this._itTail=r:n._prev=r,t}_addToMoves(t,r){return t.previousIndex===r||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Kk),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,r){return t.item=r,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class o4{constructor(t,r){this.item=t,this.trackById=r,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class s4{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,r){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===r||r<=n.currentIndex)&&Object.is(n.trackById,t))return n;return null}remove(t){const r=t._prevDup,n=t._nextDup;return null===r?this._head=n:r._nextDup=n,null===n?this._tail=r:n._prevDup=r,null===this._head}}class Kk{constructor(){this.map=new Map}put(t){const r=t.trackById;let n=this.map.get(r);n||(n=new s4,this.map.set(r,n)),n.add(t)}get(t,r){const s=this.map.get(t);return s?s.get(t,r):null}remove(t){const r=t.trackById;return this.map.get(r).remove(t)&&this.map.delete(r),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Qk(e,t,r){const n=e.previousIndex;if(null===n)return n;let s=0;return r&&n<r.length&&(s=r[n]),n+t+s}class Jk{constructor(){}supports(t){return t instanceof Map||Df(t)}create(){return new a4}}class a4{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let r;for(r=this._mapHead;null!==r;r=r._next)t(r)}forEachPreviousItem(t){let r;for(r=this._previousMapHead;null!==r;r=r._nextPrevious)t(r)}forEachChangedItem(t){let r;for(r=this._changesHead;null!==r;r=r._nextChanged)t(r)}forEachAddedItem(t){let r;for(r=this._additionsHead;null!==r;r=r._nextAdded)t(r)}forEachRemovedItem(t){let r;for(r=this._removalsHead;null!==r;r=r._nextRemoved)t(r)}diff(t){if(t){if(!(t instanceof Map||Df(t)))throw new yt(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let r=this._mapHead;if(this._appendAfter=null,this._forEach(t,(n,s)=>{if(r&&r.key===s)this._maybeAddToChanges(r,n),this._appendAfter=r,r=r._next;else{const u=this._getOrCreateRecordForKey(s,n);r=this._insertBeforeOrAppend(r,u)}}),r){r._prev&&(r._prev._next=null),this._removalsHead=r;for(let n=r;null!==n;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,r){if(t){const n=t._prev;return r._next=t,r._prev=n,t._prev=r,n&&(n._next=r),t===this._mapHead&&(this._mapHead=r),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=r,r._prev=this._appendAfter):this._mapHead=r,this._appendAfter=r,null}_getOrCreateRecordForKey(t,r){if(this._records.has(t)){const s=this._records.get(t);this._maybeAddToChanges(s,r);const u=s._prev,m=s._next;return u&&(u._next=m),m&&(m._prev=u),s._next=null,s._prev=null,s}const n=new l4(t);return this._records.set(t,n),n.currentValue=r,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,r){Object.is(r,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=r,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,r){t instanceof Map?t.forEach(r):Object.keys(t).forEach(n=>r(t[n],n))}}class l4{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function eR(){return new XC([new Xk])}let XC=(()=>{var e;class t{constructor(n){this.factories=n}static create(n,s){if(null!=s){const u=s.factories.slice();n=n.concat(u)}return new t(n)}static extend(n){return{provide:t,useFactory:s=>t.create(n,s||eR()),deps:[[t,new tf,new Bd]]}}find(n){const s=this.factories.find(u=>u.supports(n));if(null!=s)return s;throw new yt(901,!1)}}return(e=t).\u0275prov=Ut({token:e,providedIn:"root",factory:eR}),t})();function tR(){return new dx([new Jk])}let dx=(()=>{var e;class t{constructor(n){this.factories=n}static create(n,s){if(s){const u=s.factories.slice();n=n.concat(u)}return new t(n)}static extend(n){return{provide:t,useFactory:s=>t.create(n,s||tR()),deps:[[t,new tf,new Bd]]}}find(n){const s=this.factories.find(u=>u.supports(n));if(s)return s;throw new yt(901,!1)}}return(e=t).\u0275prov=Ut({token:e,providedIn:"root",factory:tR}),t})();const d4=Bk(null,"core",[]);let h4=(()=>{var e;class t{constructor(n){}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(ch))},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({}),t})();function uv(e){return"boolean"==typeof e?e:null!=e&&"false"!==e}let iM=null;function om(){return iM}class T4{}const Gi=new Kt("DocumentToken");let rM=(()=>{var e;class t{historyGo(n){throw new Error("Not implemented")}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:function(){return Jt(M4)},providedIn:"platform"}),t})();const S4=new Kt("Location Initialized");let M4=(()=>{var e;class t extends rM{constructor(){super(),this._doc=Jt(Gi),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return om().getBaseHref(this._doc)}onPopState(n){const s=om().getGlobalEventTarget(this._doc,"window");return s.addEventListener("popstate",n,!1),()=>s.removeEventListener("popstate",n)}onHashChange(n){const s=om().getGlobalEventTarget(this._doc,"window");return s.addEventListener("hashchange",n,!1),()=>s.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,s,u){this._history.pushState(n,s,u)}replaceState(n,s,u){this._history.replaceState(n,s,u)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:function(){return new e},providedIn:"platform"}),t})();function oM(e,t){if(0==e.length)return t;if(0==t.length)return e;let r=0;return e.endsWith("/")&&r++,t.startsWith("/")&&r++,2==r?e+t.substring(1):1==r?e+t:e+"/"+t}function uR(e){const t=e.match(/#|\?|$/),r=t&&t.index||e.length;return e.slice(0,r-("/"===e[r-1]?1:0))+e.slice(r)}function Of(e){return e&&"?"!==e[0]?"?"+e:e}let l_=(()=>{var e;class t{historyGo(n){throw new Error("Not implemented")}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:function(){return Jt(hR)},providedIn:"root"}),t})();const dR=new Kt("appBaseHref");let hR=(()=>{var e;class t extends l_{constructor(n,s){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=s??this._platformLocation.getBaseHrefFromDOM()??Jt(Gi).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return oM(this._baseHref,n)}path(n=!1){const s=this._platformLocation.pathname+Of(this._platformLocation.search),u=this._platformLocation.hash;return u&&n?`${s}${u}`:s}pushState(n,s,u,m){const b=this.prepareExternalUrl(u+Of(m));this._platformLocation.pushState(n,s,b)}replaceState(n,s,u,m){const b=this.prepareExternalUrl(u+Of(m));this._platformLocation.replaceState(n,s,b)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(rM),ze(dR,8))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),A4=(()=>{var e;class t extends l_{constructor(n,s){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=s&&(this._baseHref=s)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let s=this._platformLocation.hash;return null==s&&(s="#"),s.length>0?s.substring(1):s}prepareExternalUrl(n){const s=oM(this._baseHref,n);return s.length>0?"#"+s:s}pushState(n,s,u,m){let b=this.prepareExternalUrl(u+Of(m));0==b.length&&(b=this._platformLocation.pathname),this._platformLocation.pushState(n,s,b)}replaceState(n,s,u,m){let b=this.prepareExternalUrl(u+Of(m));0==b.length&&(b=this._platformLocation.pathname),this._platformLocation.replaceState(n,s,b)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(rM),ze(dR,8))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})(),QC=(()=>{var e;class t{constructor(n){this._subject=new Wn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const s=this._locationStrategy.getBaseHref();this._basePath=function R4(e){if(new RegExp("^(https?:)?//").test(e)){const[,r]=e.split(/\/\/[^\/]+/);return r}return e}(uR(fR(s))),this._locationStrategy.onPopState(u=>{this._subject.emit({url:this.path(!0),pop:!0,state:u.state,type:u.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,s=""){return this.path()==this.normalize(n+Of(s))}normalize(n){return t.stripTrailingSlash(function k4(e,t){if(!e||!t.startsWith(e))return t;const r=t.substring(e.length);return""===r||["/",";","?","#"].includes(r[0])?r:t}(this._basePath,fR(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,s="",u=null){this._locationStrategy.pushState(u,"",n,s),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Of(s)),u)}replaceState(n,s="",u=null){this._locationStrategy.replaceState(u,"",n,s),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Of(s)),u)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(s=>{this._notifyUrlChangeListeners(s.url,s.state)})),()=>{const s=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(s,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",s){this._urlChangeListeners.forEach(u=>u(n,s))}subscribe(n,s,u){return this._subject.subscribe({next:n,error:s,complete:u})}}return(e=t).normalizeQueryParams=Of,e.joinWithSlash=oM,e.stripTrailingSlash=uR,e.\u0275fac=function(n){return new(n||e)(ze(l_))},e.\u0275prov=Ut({token:e,factory:function(){return function I4(){return new QC(ze(l_))}()},providedIn:"root"}),t})();function fR(e){return e.replace(/\/index.html$/,"")}var hl=function(e){return e[e.Format=0]="Format",e[e.Standalone=1]="Standalone",e}(hl||{}),_o=function(e){return e[e.Narrow=0]="Narrow",e[e.Abbreviated=1]="Abbreviated",e[e.Wide=2]="Wide",e[e.Short=3]="Short",e}(_o||{}),Cc=function(e){return e[e.Short=0]="Short",e[e.Medium=1]="Medium",e[e.Long=2]="Long",e[e.Full=3]="Full",e}(Cc||{}),as=function(e){return e[e.Decimal=0]="Decimal",e[e.Group=1]="Group",e[e.List=2]="List",e[e.PercentSign=3]="PercentSign",e[e.PlusSign=4]="PlusSign",e[e.MinusSign=5]="MinusSign",e[e.Exponential=6]="Exponential",e[e.SuperscriptingExponent=7]="SuperscriptingExponent",e[e.PerMille=8]="PerMille",e[e.Infinity=9]="Infinity",e[e.NaN=10]="NaN",e[e.TimeSeparator=11]="TimeSeparator",e[e.CurrencyDecimal=12]="CurrencyDecimal",e[e.CurrencyGroup=13]="CurrencyGroup",e}(as||{});function eE(e,t){return fu(Hr(e)[xo.DateFormat],t)}function tE(e,t){return fu(Hr(e)[xo.TimeFormat],t)}function nE(e,t){return fu(Hr(e)[xo.DateTimeFormat],t)}function hu(e,t){const r=Hr(e),n=r[xo.NumberSymbols][t];if(typeof n>"u"){if(t===as.CurrencyDecimal)return r[xo.NumberSymbols][as.Decimal];if(t===as.CurrencyGroup)return r[xo.NumberSymbols][as.Group]}return n}function mR(e){if(!e[xo.ExtraData])throw new Error(`Missing extra locale data for the locale "${e[xo.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function fu(e,t){for(let r=t;r>-1;r--)if(typeof e[r]<"u")return e[r];throw new Error("Locale data API: locale data undefined")}function aM(e){const[t,r]=e.split(":");return{hours:+t,minutes:+r}}const q4=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,hx={},W4=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Ff=function(e){return e[e.Short=0]="Short",e[e.ShortGMT=1]="ShortGMT",e[e.Long=2]="Long",e[e.Extended=3]="Extended",e}(Ff||{}),Nr=function(e){return e[e.FullYear=0]="FullYear",e[e.Month=1]="Month",e[e.Date=2]="Date",e[e.Hours=3]="Hours",e[e.Minutes=4]="Minutes",e[e.Seconds=5]="Seconds",e[e.FractionalSeconds=6]="FractionalSeconds",e[e.Day=7]="Day",e}(Nr||{}),Br=function(e){return e[e.DayPeriods=0]="DayPeriods",e[e.Days=1]="Days",e[e.Months=2]="Months",e[e.Eras=3]="Eras",e}(Br||{});function Z4(e,t,r,n){let s=function r5(e){if(yR(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){const[s,u=1,m=1]=e.split("-").map(b=>+b);return iE(s,u-1,m)}const r=parseFloat(e);if(!isNaN(e-r))return new Date(r);let n;if(n=e.match(q4))return function o5(e){const t=new Date(0);let r=0,n=0;const s=e[8]?t.setUTCFullYear:t.setFullYear,u=e[8]?t.setUTCHours:t.setHours;e[9]&&(r=Number(e[9]+e[10]),n=Number(e[9]+e[11])),s.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));const m=Number(e[4]||0)-r,b=Number(e[5]||0)-n,T=Number(e[6]||0),R=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return u.call(t,m,b,T,R),t}(n)}const t=new Date(e);if(!yR(t))throw new Error(`Unable to convert "${e}" into a date`);return t}(e);t=Lf(r,t)||t;let b,m=[];for(;t;){if(b=W4.exec(t),!b){m.push(t);break}{m=m.concat(b.slice(1));const z=m.pop();if(!z)break;t=z}}let T=s.getTimezoneOffset();n&&(T=_R(n,T),s=function n5(e,t,r){const n=r?-1:1,s=e.getTimezoneOffset();return function t5(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,n*(_R(t,s)-s))}(s,n,!0));let R="";return m.forEach(z=>{const W=function e5(e){if(cM[e])return cM[e];let t;switch(e){case"G":case"GG":case"GGG":t=wo(Br.Eras,_o.Abbreviated);break;case"GGGG":t=wo(Br.Eras,_o.Wide);break;case"GGGGG":t=wo(Br.Eras,_o.Narrow);break;case"y":t=gs(Nr.FullYear,1,0,!1,!0);break;case"yy":t=gs(Nr.FullYear,2,0,!0,!0);break;case"yyy":t=gs(Nr.FullYear,3,0,!1,!0);break;case"yyyy":t=gs(Nr.FullYear,4,0,!1,!0);break;case"Y":t=aE(1);break;case"YY":t=aE(2,!0);break;case"YYY":t=aE(3);break;case"YYYY":t=aE(4);break;case"M":case"L":t=gs(Nr.Month,1,1);break;case"MM":case"LL":t=gs(Nr.Month,2,1);break;case"MMM":t=wo(Br.Months,_o.Abbreviated);break;case"MMMM":t=wo(Br.Months,_o.Wide);break;case"MMMMM":t=wo(Br.Months,_o.Narrow);break;case"LLL":t=wo(Br.Months,_o.Abbreviated,hl.Standalone);break;case"LLLL":t=wo(Br.Months,_o.Wide,hl.Standalone);break;case"LLLLL":t=wo(Br.Months,_o.Narrow,hl.Standalone);break;case"w":t=lM(1);break;case"ww":t=lM(2);break;case"W":t=lM(1,!0);break;case"d":t=gs(Nr.Date,1);break;case"dd":t=gs(Nr.Date,2);break;case"c":case"cc":t=gs(Nr.Day,1);break;case"ccc":t=wo(Br.Days,_o.Abbreviated,hl.Standalone);break;case"cccc":t=wo(Br.Days,_o.Wide,hl.Standalone);break;case"ccccc":t=wo(Br.Days,_o.Narrow,hl.Standalone);break;case"cccccc":t=wo(Br.Days,_o.Short,hl.Standalone);break;case"E":case"EE":case"EEE":t=wo(Br.Days,_o.Abbreviated);break;case"EEEE":t=wo(Br.Days,_o.Wide);break;case"EEEEE":t=wo(Br.Days,_o.Narrow);break;case"EEEEEE":t=wo(Br.Days,_o.Short);break;case"a":case"aa":case"aaa":t=wo(Br.DayPeriods,_o.Abbreviated);break;case"aaaa":t=wo(Br.DayPeriods,_o.Wide);break;case"aaaaa":t=wo(Br.DayPeriods,_o.Narrow);break;case"b":case"bb":case"bbb":t=wo(Br.DayPeriods,_o.Abbreviated,hl.Standalone,!0);break;case"bbbb":t=wo(Br.DayPeriods,_o.Wide,hl.Standalone,!0);break;case"bbbbb":t=wo(Br.DayPeriods,_o.Narrow,hl.Standalone,!0);break;case"B":case"BB":case"BBB":t=wo(Br.DayPeriods,_o.Abbreviated,hl.Format,!0);break;case"BBBB":t=wo(Br.DayPeriods,_o.Wide,hl.Format,!0);break;case"BBBBB":t=wo(Br.DayPeriods,_o.Narrow,hl.Format,!0);break;case"h":t=gs(Nr.Hours,1,-12);break;case"hh":t=gs(Nr.Hours,2,-12);break;case"H":t=gs(Nr.Hours,1);break;case"HH":t=gs(Nr.Hours,2);break;case"m":t=gs(Nr.Minutes,1);break;case"mm":t=gs(Nr.Minutes,2);break;case"s":t=gs(Nr.Seconds,1);break;case"ss":t=gs(Nr.Seconds,2);break;case"S":t=gs(Nr.FractionalSeconds,1);break;case"SS":t=gs(Nr.FractionalSeconds,2);break;case"SSS":t=gs(Nr.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=oE(Ff.Short);break;case"ZZZZZ":t=oE(Ff.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=oE(Ff.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=oE(Ff.Long);break;default:return null}return cM[e]=t,t}(z);R+=W?W(s,r,T):"''"===z?"'":z.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),R}function iE(e,t,r){const n=new Date(0);return n.setFullYear(e,t,r),n.setHours(0,0,0),n}function Lf(e,t){const r=function O4(e){return Hr(e)[xo.LocaleId]}(e);if(hx[r]=hx[r]||{},hx[r][t])return hx[r][t];let n="";switch(t){case"shortDate":n=eE(e,Cc.Short);break;case"mediumDate":n=eE(e,Cc.Medium);break;case"longDate":n=eE(e,Cc.Long);break;case"fullDate":n=eE(e,Cc.Full);break;case"shortTime":n=tE(e,Cc.Short);break;case"mediumTime":n=tE(e,Cc.Medium);break;case"longTime":n=tE(e,Cc.Long);break;case"fullTime":n=tE(e,Cc.Full);break;case"short":const s=Lf(e,"shortTime"),u=Lf(e,"shortDate");n=rE(nE(e,Cc.Short),[s,u]);break;case"medium":const m=Lf(e,"mediumTime"),b=Lf(e,"mediumDate");n=rE(nE(e,Cc.Medium),[m,b]);break;case"long":const T=Lf(e,"longTime"),R=Lf(e,"longDate");n=rE(nE(e,Cc.Long),[T,R]);break;case"full":const z=Lf(e,"fullTime"),W=Lf(e,"fullDate");n=rE(nE(e,Cc.Full),[z,W])}return n&&(hx[r][t]=n),n}function rE(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(r,n){return null!=t&&n in t?t[n]:r})),e}function nd(e,t,r="-",n,s){let u="";(e<0||s&&e<=0)&&(s?e=1-e:(e=-e,u=r));let m=String(e);for(;m.length<t;)m="0"+m;return n&&(m=m.slice(m.length-t)),u+m}function gs(e,t,r=0,n=!1,s=!1){return function(u,m){let b=function X4(e,t){switch(e){case Nr.FullYear:return t.getFullYear();case Nr.Month:return t.getMonth();case Nr.Date:return t.getDate();case Nr.Hours:return t.getHours();case Nr.Minutes:return t.getMinutes();case Nr.Seconds:return t.getSeconds();case Nr.FractionalSeconds:return t.getMilliseconds();case Nr.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${e}".`)}}(e,u);if((r>0||b>-r)&&(b+=r),e===Nr.Hours)0===b&&-12===r&&(b=12);else if(e===Nr.FractionalSeconds)return function Y4(e,t){return nd(e,3).substring(0,t)}(b,t);const T=hu(m,as.MinusSign);return nd(b,t,T,n,s)}}function wo(e,t,r=hl.Format,n=!1){return function(s,u){return function K4(e,t,r,n,s,u){switch(r){case Br.Months:return function N4(e,t,r){const n=Hr(e),u=fu([n[xo.MonthsFormat],n[xo.MonthsStandalone]],t);return fu(u,r)}(t,s,n)[e.getMonth()];case Br.Days:return function L4(e,t,r){const n=Hr(e),u=fu([n[xo.DaysFormat],n[xo.DaysStandalone]],t);return fu(u,r)}(t,s,n)[e.getDay()];case Br.DayPeriods:const m=e.getHours(),b=e.getMinutes();if(u){const R=function j4(e){const t=Hr(e);return mR(t),(t[xo.ExtraData][2]||[]).map(n=>"string"==typeof n?aM(n):[aM(n[0]),aM(n[1])])}(t),z=function U4(e,t,r){const n=Hr(e);mR(n);const u=fu([n[xo.ExtraData][0],n[xo.ExtraData][1]],t)||[];return fu(u,r)||[]}(t,s,n),W=R.findIndex(le=>{if(Array.isArray(le)){const[he,Me]=le,Ve=m>=he.hours&&b>=he.minutes,at=m<Me.hours||m===Me.hours&&b<Me.minutes;if(he.hours<Me.hours){if(Ve&&at)return!0}else if(Ve||at)return!0}else if(le.hours===m&&le.minutes===b)return!0;return!1});if(-1!==W)return z[W]}return function F4(e,t,r){const n=Hr(e),u=fu([n[xo.DayPeriodsFormat],n[xo.DayPeriodsStandalone]],t);return fu(u,r)}(t,s,n)[m<12?0:1];case Br.Eras:return function B4(e,t){return fu(Hr(e)[xo.Eras],t)}(t,n)[e.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${r}`)}}(s,u,e,t,r,n)}}function oE(e){return function(t,r,n){const s=-1*n,u=hu(r,as.MinusSign),m=s>0?Math.floor(s/60):Math.ceil(s/60);switch(e){case Ff.Short:return(s>=0?"+":"")+nd(m,2,u)+nd(Math.abs(s%60),2,u);case Ff.ShortGMT:return"GMT"+(s>=0?"+":"")+nd(m,1,u);case Ff.Long:return"GMT"+(s>=0?"+":"")+nd(m,2,u)+":"+nd(Math.abs(s%60),2,u);case Ff.Extended:return 0===n?"Z":(s>=0?"+":"")+nd(m,2,u)+":"+nd(Math.abs(s%60),2,u);default:throw new Error(`Unknown zone width "${e}"`)}}}const Q4=0,sE=4;function gR(e){return iE(e.getFullYear(),e.getMonth(),e.getDate()+(sE-e.getDay()))}function lM(e,t=!1){return function(r,n){let s;if(t){const u=new Date(r.getFullYear(),r.getMonth(),1).getDay()-1,m=r.getDate();s=1+Math.floor((m+u)/7)}else{const u=gR(r),m=function J4(e){const t=iE(e,Q4,1).getDay();return iE(e,0,1+(t<=sE?sE:sE+7)-t)}(u.getFullYear()),b=u.getTime()-m.getTime();s=1+Math.round(b/6048e5)}return nd(s,e,hu(n,as.MinusSign))}}function aE(e,t=!1){return function(r,n){return nd(gR(r).getFullYear(),e,hu(n,as.MinusSign),t)}}const cM={};function _R(e,t){e=e.replace(/:/g,"");const r=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(r)?t:r}function yR(e){return e instanceof Date&&!isNaN(e.valueOf())}function wR(e,t){t=encodeURIComponent(t);for(const r of e.split(";")){const n=r.indexOf("="),[s,u]=-1==n?[r,""]:[r.slice(0,n),r.slice(n+1)];if(s.trim()===t)return decodeURIComponent(u)}return null}const mM=/\s+/,CR=[];let px=(()=>{var e;class t{constructor(n,s,u,m){this._iterableDiffers=n,this._keyValueDiffers=s,this._ngEl=u,this._renderer=m,this.initialClasses=CR,this.stateMap=new Map}set klass(n){this.initialClasses=null!=n?n.trim().split(mM):CR}set ngClass(n){this.rawClass="string"==typeof n?n.trim().split(mM):n}ngDoCheck(){for(const s of this.initialClasses)this._updateState(s,!0);const n=this.rawClass;if(Array.isArray(n)||n instanceof Set)for(const s of n)this._updateState(s,!0);else if(null!=n)for(const s of Object.keys(n))this._updateState(s,!!n[s]);this._applyStateDiff()}_updateState(n,s){const u=this.stateMap.get(n);void 0!==u?(u.enabled!==s&&(u.changed=!0,u.enabled=s),u.touched=!0):this.stateMap.set(n,{enabled:s,changed:!0,touched:!0})}_applyStateDiff(){for(const n of this.stateMap){const s=n[0],u=n[1];u.changed?(this._toggleClass(s,u.enabled),u.changed=!1):u.touched||(u.enabled&&this._toggleClass(s,!1),this.stateMap.delete(s)),u.touched=!1}}_toggleClass(n,s){(n=n.trim()).length>0&&n.split(mM).forEach(u=>{s?this._renderer.addClass(this._ngEl.nativeElement,u):this._renderer.removeClass(this._ngEl.nativeElement,u)})}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(XC),xe(dx),xe(tr),xe($u))},e.\u0275dir=Bn({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),t})();class y5{constructor(t,r,n,s){this.$implicit=t,this.ngForOf=r,this.index=n,this.count=s}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Gl=(()=>{var e;class t{set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}constructor(n,s,u){this._viewContainer=n,this._template=s,this._differs=u,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const s=this._viewContainer;n.forEachOperation((u,m,b)=>{if(null==u.previousIndex)s.createEmbeddedView(this._template,new y5(u.item,this._ngForOf,-1,-1),null===b?void 0:b);else if(null==b)s.remove(null===m?void 0:m);else if(null!==m){const T=s.get(m);s.move(T,b),DR(T,u)}});for(let u=0,m=s.length;u<m;u++){const T=s.get(u).context;T.index=u,T.count=m,T.ngForOf=this._ngForOf}n.forEachIdentityChange(u=>{DR(s.get(u.currentIndex),u)})}static ngTemplateContextGuard(n,s){return!0}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(Hl),xe(ah),xe(XC))},e.\u0275dir=Bn({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),t})();function DR(e,t){e.context.$implicit=t.item}let Na=(()=>{var e;class t{constructor(n,s){this._viewContainer=n,this._context=new v5,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=s}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){TR("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){TR("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,s){return!0}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(Hl),xe(ah))},e.\u0275dir=Bn({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),t})();class v5{constructor(){this.$implicit=null,this.ngIf=null}}function TR(e,t){if(t&&!t.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${jn(t)}'.`)}class gM{constructor(t,r){this._viewContainerRef=t,this._templateRef=r,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let cE=(()=>{var e;class t{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(n){this._ngSwitch=n,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(n){this._defaultViews.push(n)}_matchCase(n){const s=n==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||s,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),s}_updateDefaultCases(n){if(this._defaultViews.length>0&&n!==this._defaultUsed){this._defaultUsed=n;for(const s of this._defaultViews)s.enforceState(n)}}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275dir=Bn({type:e,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),t})(),SR=(()=>{var e;class t{constructor(n,s,u){this.ngSwitch=u,u._addCase(),this._view=new gM(n,s)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(Hl),xe(ah),xe(cE,9))},e.\u0275dir=Bn({type:e,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),t})();const k5=new Kt("DATE_PIPE_DEFAULT_TIMEZONE"),R5=new Kt("DATE_PIPE_DEFAULT_OPTIONS");let mx=(()=>{var e;class t{constructor(n,s,u){this.locale=n,this.defaultTimezone=s,this.defaultOptions=u}transform(n,s,u,m){if(null==n||""===n||n!=n)return null;try{return Z4(n,s??this.defaultOptions?.dateFormat??"mediumDate",m||this.locale,u??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(b){throw function id(e,t){return new yt(2100,!1)}()}}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(lh,16),xe(k5,24),xe(R5,24))},e.\u0275pipe=vo({name:"date",type:e,pure:!0,standalone:!0}),t})(),hv=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({}),t})();const IR="browser";function kR(e){return"server"===e}let q5=(()=>{var e;class t{}return(e=t).\u0275prov=Ut({token:e,providedIn:"root",factory:()=>new W5(ze(Gi),window)}),t})();class W5{constructor(t,r){this.document=t,this.window=r,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const r=function Z5(e,t){const r=e.getElementById(t)||e.getElementsByName(t)[0];if(r)return r;if("function"==typeof e.createTreeWalker&&e.body&&"function"==typeof e.body.attachShadow){const n=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let s=n.currentNode;for(;s;){const u=s.shadowRoot;if(u){const m=u.getElementById(t)||u.querySelector(`[name="${t}"]`);if(m)return m}s=n.nextNode()}}return null}(this.document,t);r&&(this.scrollToElement(r),r.focus())}setHistoryScrollRestoration(t){this.supportsScrolling()&&(this.window.history.scrollRestoration=t)}scrollToElement(t){const r=t.getBoundingClientRect(),n=r.left+this.window.pageXOffset,s=r.top+this.window.pageYOffset,u=this.offset();this.window.scrollTo(n-u[0],s-u[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class RR{}class _V extends T4{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class xM extends _V{static makeCurrent(){!function D4(e){iM||(iM=e)}(new xM)}onAndCancel(t,r,n){return t.addEventListener(r,n),()=>{t.removeEventListener(r,n)}}dispatchEvent(t,r){t.dispatchEvent(r)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,r){return(r=r||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,r){return"window"===r?window:"document"===r?t:"body"===r?t.body:null}getBaseHref(t){const r=function yV(){return _x=_x||document.querySelector("base"),_x?_x.getAttribute("href"):null}();return null==r?null:function vV(e){hE=hE||document.createElement("a"),hE.setAttribute("href",e);const t=hE.pathname;return"/"===t.charAt(0)?t:`/${t}`}(r)}resetBaseElement(){_x=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return wR(document.cookie,t)}}let hE,_x=null,xV=(()=>{var e;class t{build(){return new XMLHttpRequest}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})();const wM=new Kt("EventManagerPlugins");let NR=(()=>{var e;class t{constructor(n,s){this._zone=s,this._eventNameToPlugin=new Map,n.forEach(u=>{u.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,s,u){return this._findPluginFor(s).addEventListener(n,s,u)}getZone(){return this._zone}_findPluginFor(n){let s=this._eventNameToPlugin.get(n);if(s)return s;if(s=this._plugins.find(m=>m.supports(n)),!s)throw new yt(5101,!1);return this._eventNameToPlugin.set(n,s),s}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(wM),ze(si))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})();class BR{constructor(t){this._doc=t}}const CM="ng-app-id";let zR=(()=>{var e;class t{constructor(n,s,u,m={}){this.doc=n,this.appId=s,this.nonce=u,this.platformId=m,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=kR(m),this.resetHostNodes()}addStyles(n){for(const s of n)1===this.changeUsageCount(s,1)&&this.onStyleAdded(s)}removeStyles(n){for(const s of n)this.changeUsageCount(s,-1)<=0&&this.onStyleRemoved(s)}ngOnDestroy(){const n=this.styleNodesInDOM;n&&(n.forEach(s=>s.remove()),n.clear());for(const s of this.getAllStyles())this.onStyleRemoved(s);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const s of this.getAllStyles())this.addStyleToHost(n,s)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(const s of this.hostNodes)this.addStyleToHost(s,n)}onStyleRemoved(n){const s=this.styleRef;s.get(n)?.elements?.forEach(u=>u.remove()),s.delete(n)}collectServerRenderedStyles(){const n=this.doc.head?.querySelectorAll(`style[${CM}="${this.appId}"]`);if(n?.length){const s=new Map;return n.forEach(u=>{null!=u.textContent&&s.set(u.textContent,u)}),s}return null}changeUsageCount(n,s){const u=this.styleRef;if(u.has(n)){const m=u.get(n);return m.usage+=s,m.usage}return u.set(n,{usage:s,elements:[]}),s}getStyleElement(n,s){const u=this.styleNodesInDOM,m=u?.get(s);if(m?.parentNode===n)return u.delete(s),m.removeAttribute(CM),m;{const b=this.doc.createElement("style");return this.nonce&&b.setAttribute("nonce",this.nonce),b.textContent=s,this.platformIsServer&&b.setAttribute(CM,this.appId),b}}addStyleToHost(n,s){const u=this.getStyleElement(n,s);n.appendChild(u);const m=this.styleRef,b=m.get(s)?.elements;b?b.push(u):m.set(s,{elements:[u],usage:1})}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Gi),ze(Ag),ze(Ub,8),ze(Zd))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})();const EM={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},DM=/%COMP%/g,DV=new Kt("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function jR(e,t){return t.map(r=>r.replace(DM,e))}let TM=(()=>{var e;class t{constructor(n,s,u,m,b,T,R,z=null){this.eventManager=n,this.sharedStylesHost=s,this.appId=u,this.removeStylesOnCompDestroy=m,this.doc=b,this.platformId=T,this.ngZone=R,this.nonce=z,this.rendererByCompId=new Map,this.platformIsServer=kR(T),this.defaultRenderer=new SM(n,b,R,this.platformIsServer)}createRenderer(n,s){if(!n||!s)return this.defaultRenderer;this.platformIsServer&&s.encapsulation===ws.ShadowDom&&(s={...s,encapsulation:ws.Emulated});const u=this.getOrCreateRenderer(n,s);return u instanceof HR?u.applyToHost(n):u instanceof MM&&u.applyStyles(),u}getOrCreateRenderer(n,s){const u=this.rendererByCompId;let m=u.get(s.id);if(!m){const b=this.doc,T=this.ngZone,R=this.eventManager,z=this.sharedStylesHost,W=this.removeStylesOnCompDestroy,le=this.platformIsServer;switch(s.encapsulation){case ws.Emulated:m=new HR(R,z,s,this.appId,W,b,T,le);break;case ws.ShadowDom:return new AV(R,z,n,s,b,T,this.nonce,le);default:m=new MM(R,z,s,W,b,T,le)}u.set(s.id,m)}return m}ngOnDestroy(){this.rendererByCompId.clear()}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(NR),ze(zR),ze(Ag),ze(DV),ze(Gi),ze(Zd),ze(si),ze(Ub))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})();class SM{constructor(t,r,n,s){this.eventManager=t,this.doc=r,this.ngZone=n,this.platformIsServer=s,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,r){return r?this.doc.createElementNS(EM[r]||r,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,r){(UR(t)?t.content:t).appendChild(r)}insertBefore(t,r,n){t&&(UR(t)?t.content:t).insertBefore(r,n)}removeChild(t,r){t&&t.removeChild(r)}selectRootElement(t,r){let n="string"==typeof t?this.doc.querySelector(t):t;if(!n)throw new yt(-5104,!1);return r||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,r,n,s){if(s){r=s+":"+r;const u=EM[s];u?t.setAttributeNS(u,r,n):t.setAttribute(r,n)}else t.setAttribute(r,n)}removeAttribute(t,r,n){if(n){const s=EM[n];s?t.removeAttributeNS(s,r):t.removeAttribute(`${n}:${r}`)}else t.removeAttribute(r)}addClass(t,r){t.classList.add(r)}removeClass(t,r){t.classList.remove(r)}setStyle(t,r,n,s){s&(Vu.DashCase|Vu.Important)?t.style.setProperty(r,n,s&Vu.Important?"important":""):t.style[r]=n}removeStyle(t,r,n){n&Vu.DashCase?t.style.removeProperty(r):t.style[r]=""}setProperty(t,r,n){t[r]=n}setValue(t,r){t.nodeValue=r}listen(t,r,n){if("string"==typeof t&&!(t=om().getGlobalEventTarget(this.doc,t)))throw new Error(`Unsupported event target ${t} for event ${r}`);return this.eventManager.addEventListener(t,r,this.decoratePreventDefault(n))}decoratePreventDefault(t){return r=>{if("__ngUnwrap__"===r)return t;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>t(r)):t(r))&&r.preventDefault()}}}function UR(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class AV extends SM{constructor(t,r,n,s,u,m,b,T){super(t,u,m,T),this.sharedStylesHost=r,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const R=jR(s.id,s.styles);for(const z of R){const W=document.createElement("style");b&&W.setAttribute("nonce",b),W.textContent=z,this.shadowRoot.appendChild(W)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,r){return super.appendChild(this.nodeOrShadowRoot(t),r)}insertBefore(t,r,n){return super.insertBefore(this.nodeOrShadowRoot(t),r,n)}removeChild(t,r){return super.removeChild(this.nodeOrShadowRoot(t),r)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class MM extends SM{constructor(t,r,n,s,u,m,b,T){super(t,u,m,b),this.sharedStylesHost=r,this.removeStylesOnCompDestroy=s,this.styles=T?jR(T,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class HR extends MM{constructor(t,r,n,s,u,m,b,T){const R=s+"-"+n.id;super(t,r,n,u,m,b,T,R),this.contentAttr=function TV(e){return"_ngcontent-%COMP%".replace(DM,e)}(R),this.hostAttr=function SV(e){return"_nghost-%COMP%".replace(DM,e)}(R)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,r){const n=super.createElement(t,r);return super.setAttribute(n,this.contentAttr,""),n}}let IV=(()=>{var e;class t extends BR{constructor(n){super(n)}supports(n){return!0}addEventListener(n,s,u){return n.addEventListener(s,u,!1),()=>this.removeEventListener(n,s,u)}removeEventListener(n,s,u){return n.removeEventListener(s,u)}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Gi))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})();const $R=["alt","control","meta","shift"],kV={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},RV={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let PV=(()=>{var e;class t extends BR{constructor(n){super(n)}supports(n){return null!=t.parseEventName(n)}addEventListener(n,s,u){const m=t.parseEventName(s),b=t.eventCallback(m.fullKey,u,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>om().onAndCancel(n,m.domEventName,b))}static parseEventName(n){const s=n.toLowerCase().split("."),u=s.shift();if(0===s.length||"keydown"!==u&&"keyup"!==u)return null;const m=t._normalizeKey(s.pop());let b="",T=s.indexOf("code");if(T>-1&&(s.splice(T,1),b="code."),$R.forEach(z=>{const W=s.indexOf(z);W>-1&&(s.splice(W,1),b+=z+".")}),b+=m,0!=s.length||0===m.length)return null;const R={};return R.domEventName=u,R.fullKey=b,R}static matchEventFullKeyCode(n,s){let u=kV[n.key]||n.key,m="";return s.indexOf("code.")>-1&&(u=n.code,m="code."),!(null==u||!u)&&(u=u.toLowerCase()," "===u?u="space":"."===u&&(u="dot"),$R.forEach(b=>{b!==u&&(0,RV[b])(n)&&(m+=b+".")}),m+=u,m===s)}static eventCallback(n,s,u){return m=>{t.matchEventFullKeyCode(m,n)&&u.runGuarded(()=>s(m))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Gi))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})();const NV=Bk(d4,"browser",[{provide:Zd,useValue:IR},{provide:Ig,useValue:function OV(){xM.makeCurrent()},multi:!0},{provide:Gi,useFactory:function LV(){return function af(e){ay=e}(document),document},deps:[]}]),BV=new Kt(""),WR=[{provide:qC,useClass:class bV{addToWindow(t){In.getAngularTestability=(n,s=!0)=>{const u=t.findTestabilityInTree(n,s);if(null==u)throw new yt(5103,!1);return u},In.getAllAngularTestabilities=()=>t.getAllTestabilities(),In.getAllAngularRootElements=()=>t.getAllRootElements(),In.frameworkStabilizers||(In.frameworkStabilizers=[]),In.frameworkStabilizers.push(n=>{const s=In.getAllAngularTestabilities();let u=s.length,m=!1;const b=function(T){m=m||T,u--,0==u&&n(m)};s.forEach(T=>{T.whenStable(b)})})}findTestabilityInTree(t,r,n){return null==r?null:t.getTestability(r)??(n?om().isShadowRoot(r)?this.findTestabilityInTree(t,r.host,!0):this.findTestabilityInTree(t,r.parentElement,!0):null)}},deps:[]},{provide:Pk,useClass:qS,deps:[si,WS,qC]},{provide:qS,useClass:qS,deps:[si,WS,qC]}],ZR=[{provide:gy,useValue:"root"},{provide:qu,useFactory:function FV(){return new qu},deps:[]},{provide:wM,useClass:IV,multi:!0,deps:[Gi,si,Zd]},{provide:wM,useClass:PV,multi:!0,deps:[Gi]},TM,zR,NR,{provide:Rg,useExisting:TM},{provide:RR,useClass:xV,deps:[]},[]];let AM=(()=>{var e;class t{constructor(n){}static withServerTransition(n){return{ngModule:t,providers:[{provide:Ag,useValue:n.appId}]}}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(BV,12))},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({providers:[...ZR,...WR],imports:[hv,h4]}),t})(),YR=(()=>{var e;class t{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Gi))},e.\u0275prov=Ut({token:e,factory:function(n){let s=null;return s=n?new n:function VV(){return new YR(ze(Gi))}(),s},providedIn:"root"}),t})();typeof window<"u"&&window;let kM=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:function(n){let s=null;return s=n?new(n||e):ze(QR),s},providedIn:"root"}),t})(),QR=(()=>{var e;class t extends kM{constructor(n){super(),this._doc=n}sanitize(n,s){if(null==s)return null;switch(n){case ka.NONE:return s;case ka.HTML:return nl(s,"HTML")?zs(s):dy(this._doc,String(s)).toString();case ka.STYLE:return nl(s,"Style")?zs(s):s;case ka.SCRIPT:if(nl(s,"Script"))return zs(s);throw new yt(5200,!1);case ka.URL:return nl(s,"URL")?zs(s):bg(String(s));case ka.RESOURCE_URL:if(nl(s,"ResourceURL"))return zs(s);throw new yt(5201,!1);default:throw new yt(5202,!1)}}bypassSecurityTrustHtml(n){return function lw(e){return new Ib(e)}(n)}bypassSecurityTrustStyle(n){return function oT(e){return new aw(e)}(n)}bypassSecurityTrustScript(n){return function cw(e){return new rT(e)}(n)}bypassSecurityTrustUrl(n){return function sT(e){return new eu(e)}(n)}bypassSecurityTrustResourceUrl(n){return function Rb(e){return new Gd(e)}(n)}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Gi))},e.\u0275prov=Ut({token:e,factory:function(n){let s=null;return s=n?new n:function $V(e){return new QR(e.get(Gi))}(ze(Xr)),s},providedIn:"root"}),t})();function am(e){return!!e&&(e instanceof wn||ht(e.lift)&&ht(e.subscribe))}const{isArray:GV}=Array,{getPrototypeOf:qV,prototype:WV,keys:ZV}=Object;function eP(e){if(1===e.length){const t=e[0];if(GV(t))return{args:t,keys:null};if(function YV(e){return e&&"object"==typeof e&&qV(e)===WV}(t)){const r=ZV(t);return{args:r.map(n=>t[n]),keys:r}}}return{args:e,keys:null}}const{isArray:XV}=Array;function RM(e){return ii(t=>function KV(e,t){return XV(t)?e(...t):e(t)}(e,t))}function tP(e,t){return e.reduce((r,n,s)=>(r[n]=t[s],r),{})}function fE(...e){const t=uo(e),r=yh(e),{args:n,keys:s}=eP(e);if(0===n.length)return wr([],t);const u=new wn(function QV(e,t,r=ts){return n=>{nP(t,()=>{const{length:s}=e,u=new Array(s);let m=s,b=s;for(let T=0;T<s;T++)nP(t,()=>{const R=wr(e[T],t);let z=!1;R.subscribe(ai(n,W=>{u[T]=W,z||(z=!0,b--),b||n.next(r(u.slice()))},()=>{--m||n.complete()}))},n)},n)}}(n,t,s?m=>tP(s,m):ts));return r?u.pipe(RM(r)):u}function nP(e,t,r){e?eo(r,e,t):t()}const yx=gt(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function fv(...e){return function JV(){return _l(1)}()(wr(e,uo(e)))}function pE(e){return new wn(t=>{Ai(e()).subscribe(t)})}function vx(e,t){const r=ht(e)?e:()=>e,n=s=>s.error(r());return new wn(t?s=>t.schedule(n,0,s):n)}function PM(){return ur((e,t)=>{let r=null;e._refCount++;const n=ai(t,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(r=null);const s=e._connection,u=r;r=null,s&&(!u||s===u)&&s.unsubscribe(),t.unsubscribe()});e.subscribe(n),n.closed||(r=e.connect())})}class iP extends wn{constructor(t,r){super(),this.source=t,this.subjectFactory=r,this._subject=null,this._refCount=0,this._connection=null,ys(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new me;const r=this.getSubject();t.add(this.source.subscribe(ai(r,void 0,()=>{this._teardown(),r.complete()},n=>{this._teardown(),r.error(n)},()=>this._teardown()))),t.closed&&(this._connection=null,t=me.EMPTY)}return t}refCount(){return PM()(this)}}function Us(e){return e<=0?()=>Eo:ur((t,r)=>{let n=0;t.subscribe(ai(r,s=>{++n<=e&&(r.next(s),e<=n&&r.complete())}))})}function bx(...e){const t=uo(e);return ur((r,n)=>{(t?fv(e,r,t):fv(e,r)).subscribe(n)})}function ql(e,t){return ur((r,n)=>{let s=0;r.subscribe(ai(n,u=>e.call(t,u,s++)&&n.next(u)))})}function mE(e){return ur((t,r)=>{let n=!1;t.subscribe(ai(r,s=>{n=!0,r.next(s)},()=>{n||r.next(e),r.complete()}))})}function rP(e=ej){return ur((t,r)=>{let n=!1;t.subscribe(ai(r,s=>{n=!0,r.next(s)},()=>n?r.complete():r.error(e())))})}function ej(){return new yx}function c_(e,t){const r=arguments.length>=2;return n=>n.pipe(e?ql((s,u)=>e(s,u,n)):ts,Us(1),r?mE(t):rP(()=>new yx))}function u_(e,t){return ht(t)?Wr(e,t,1):Wr(e,1)}function Ba(e,t,r){const n=ht(e)||t||r?{next:e,error:t,complete:r}:e;return n?ur((s,u)=>{var m;null===(m=n.subscribe)||void 0===m||m.call(n);let b=!0;s.subscribe(ai(u,T=>{var R;null===(R=n.next)||void 0===R||R.call(n,T),u.next(T)},()=>{var T;b=!1,null===(T=n.complete)||void 0===T||T.call(n),u.complete()},T=>{var R;b=!1,null===(R=n.error)||void 0===R||R.call(n,T),u.error(T)},()=>{var T,R;b&&(null===(T=n.unsubscribe)||void 0===T||T.call(n)),null===(R=n.finalize)||void 0===R||R.call(n)}))}):ts}function d_(e){return ur((t,r)=>{let u,n=null,s=!1;n=t.subscribe(ai(r,void 0,void 0,m=>{u=Ai(e(m,d_(e)(t))),n?(n.unsubscribe(),n=null,u.subscribe(r)):s=!0})),s&&(n.unsubscribe(),n=null,u.subscribe(r))})}function OM(e){return e<=0?()=>Eo:ur((t,r)=>{let n=[];t.subscribe(ai(r,s=>{n.push(s),e<n.length&&n.shift()},()=>{for(const s of n)r.next(s);r.complete()},void 0,()=>{n=null}))})}function xx(e){return ur((t,r)=>{try{t.subscribe(r)}finally{r.add(e)}})}function Wl(e){return ur((t,r)=>{Ai(e).subscribe(ai(r,()=>r.complete(),pn)),!r.closed&&t.subscribe(r)})}const Zi="primary",wx=Symbol("RouteTitle");class oj{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const r=this.params[t];return Array.isArray(r)?r[0]:r}return null}getAll(t){if(this.has(t)){const r=this.params[t];return Array.isArray(r)?r:[r]}return[]}get keys(){return Object.keys(this.params)}}function pv(e){return new oj(e)}function sj(e,t,r){const n=r.path.split("/");if(n.length>e.length||"full"===r.pathMatch&&(t.hasChildren()||n.length<e.length))return null;const s={};for(let u=0;u<n.length;u++){const m=n[u],b=e[u];if(m.startsWith(":"))s[m.substring(1)]=b;else if(m!==b.path)return null}return{consumed:e.slice(0,n.length),posParams:s}}function uh(e,t){const r=e?Object.keys(e):void 0,n=t?Object.keys(t):void 0;if(!r||!n||r.length!=n.length)return!1;let s;for(let u=0;u<r.length;u++)if(s=r[u],!oP(e[s],t[s]))return!1;return!0}function oP(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;const r=[...e].sort(),n=[...t].sort();return r.every((s,u)=>n[u]===s)}return e===t}function sP(e){return e.length>0?e[e.length-1]:null}function lm(e){return am(e)?e:Qp(e)?wr(Promise.resolve(e)):Gn(e)}const lj={exact:function cP(e,t,r){if(!h_(e.segments,t.segments)||!gE(e.segments,t.segments,r)||e.numberOfChildren!==t.numberOfChildren)return!1;for(const n in t.children)if(!e.children[n]||!cP(e.children[n],t.children[n],r))return!1;return!0},subset:uP},aP={exact:function cj(e,t){return uh(e,t)},subset:function uj(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(r=>oP(e[r],t[r]))},ignored:()=>!0};function lP(e,t,r){return lj[r.paths](e.root,t.root,r.matrixParams)&&aP[r.queryParams](e.queryParams,t.queryParams)&&!("exact"===r.fragment&&e.fragment!==t.fragment)}function uP(e,t,r){return dP(e,t,t.segments,r)}function dP(e,t,r,n){if(e.segments.length>r.length){const s=e.segments.slice(0,r.length);return!(!h_(s,r)||t.hasChildren()||!gE(s,r,n))}if(e.segments.length===r.length){if(!h_(e.segments,r)||!gE(e.segments,r,n))return!1;for(const s in t.children)if(!e.children[s]||!uP(e.children[s],t.children[s],n))return!1;return!0}{const s=r.slice(0,e.segments.length),u=r.slice(e.segments.length);return!!(h_(e.segments,s)&&gE(e.segments,s,n)&&e.children[Zi])&&dP(e.children[Zi],t,u,n)}}function gE(e,t,r){return t.every((n,s)=>aP[r](e[s].parameters,n.parameters))}class mv{constructor(t=new Qr([],{}),r={},n=null){this.root=t,this.queryParams=r,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=pv(this.queryParams)),this._queryParamMap}toString(){return fj.serialize(this)}}class Qr{constructor(t,r){this.segments=t,this.children=r,this.parent=null,Object.values(r).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return _E(this)}}class Cx{constructor(t,r){this.path=t,this.parameters=r}get parameterMap(){return this._parameterMap||(this._parameterMap=pv(this.parameters)),this._parameterMap}toString(){return pP(this)}}function h_(e,t){return e.length===t.length&&e.every((r,n)=>r.path===t[n].path)}let Ex=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:function(){return new FM},providedIn:"root"}),t})();class FM{parse(t){const r=new Ej(t);return new mv(r.parseRootSegment(),r.parseQueryParams(),r.parseFragment())}serialize(t){const r=`/${Dx(t.root,!0)}`,n=function gj(e){const t=Object.keys(e).map(r=>{const n=e[r];return Array.isArray(n)?n.map(s=>`${yE(r)}=${yE(s)}`).join("&"):`${yE(r)}=${yE(n)}`}).filter(r=>!!r);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${r}${n}${"string"==typeof t.fragment?`#${function pj(e){return encodeURI(e)}(t.fragment)}`:""}`}}const fj=new FM;function _E(e){return e.segments.map(t=>pP(t)).join("/")}function Dx(e,t){if(!e.hasChildren())return _E(e);if(t){const r=e.children[Zi]?Dx(e.children[Zi],!1):"",n=[];return Object.entries(e.children).forEach(([s,u])=>{s!==Zi&&n.push(`${s}:${Dx(u,!1)}`)}),n.length>0?`${r}(${n.join("//")})`:r}{const r=function hj(e,t){let r=[];return Object.entries(e.children).forEach(([n,s])=>{n===Zi&&(r=r.concat(t(s,n)))}),Object.entries(e.children).forEach(([n,s])=>{n!==Zi&&(r=r.concat(t(s,n)))}),r}(e,(n,s)=>s===Zi?[Dx(e.children[Zi],!1)]:[`${s}:${Dx(n,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[Zi]?`${_E(e)}/${r[0]}`:`${_E(e)}/(${r.join("//")})`}}function hP(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function yE(e){return hP(e).replace(/%3B/gi,";")}function LM(e){return hP(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function vE(e){return decodeURIComponent(e)}function fP(e){return vE(e.replace(/\+/g,"%20"))}function pP(e){return`${LM(e.path)}${function mj(e){return Object.keys(e).map(t=>`;${LM(t)}=${LM(e[t])}`).join("")}(e.parameters)}`}const _j=/^[^\/()?;#]+/;function NM(e){const t=e.match(_j);return t?t[0]:""}const yj=/^[^\/()?;=#]+/,bj=/^[^=?&#]+/,wj=/^[^&#]+/;class Ej{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Qr([],{}):new Qr([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let r={};this.peekStartsWith("/(")&&(this.capture("/"),r=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(r).length>0)&&(n[Zi]=new Qr(t,r)),n}parseSegment(){const t=NM(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new yt(4009,!1);return this.capture(t),new Cx(vE(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const r=function vj(e){const t=e.match(yj);return t?t[0]:""}(this.remaining);if(!r)return;this.capture(r);let n="";if(this.consumeOptional("=")){const s=NM(this.remaining);s&&(n=s,this.capture(n))}t[vE(r)]=vE(n)}parseQueryParam(t){const r=function xj(e){const t=e.match(bj);return t?t[0]:""}(this.remaining);if(!r)return;this.capture(r);let n="";if(this.consumeOptional("=")){const m=function Cj(e){const t=e.match(wj);return t?t[0]:""}(this.remaining);m&&(n=m,this.capture(n))}const s=fP(r),u=fP(n);if(t.hasOwnProperty(s)){let m=t[s];Array.isArray(m)||(m=[m],t[s]=m),m.push(u)}else t[s]=u}parseParens(t){const r={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=NM(this.remaining),s=this.remaining[n.length];if("/"!==s&&")"!==s&&";"!==s)throw new yt(4010,!1);let u;n.indexOf(":")>-1?(u=n.slice(0,n.indexOf(":")),this.capture(u),this.capture(":")):t&&(u=Zi);const m=this.parseChildren();r[u]=1===Object.keys(m).length?m[Zi]:new Qr([],m),this.consumeOptional("//")}return r}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new yt(4011,!1)}}function mP(e){return e.segments.length>0?new Qr([],{[Zi]:e}):e}function gP(e){const t={};for(const n of Object.keys(e.children)){const u=gP(e.children[n]);if(n===Zi&&0===u.segments.length&&u.hasChildren())for(const[m,b]of Object.entries(u.children))t[m]=b;else(u.segments.length>0||u.hasChildren())&&(t[n]=u)}return function Dj(e){if(1===e.numberOfChildren&&e.children[Zi]){const t=e.children[Zi];return new Qr(e.segments.concat(t.segments),t.children)}return e}(new Qr(e.segments,t))}function f_(e){return e instanceof mv}function _P(e){let t;const s=mP(function r(u){const m={};for(const T of u.children){const R=r(T);m[T.outlet]=R}const b=new Qr(u.url,m);return u===e&&(t=b),b}(e.root));return t??s}function yP(e,t,r,n){let s=e;for(;s.parent;)s=s.parent;if(0===t.length)return BM(s,s,s,r,n);const u=function Sj(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new bP(!0,0,e);let t=0,r=!1;const n=e.reduce((s,u,m)=>{if("object"==typeof u&&null!=u){if(u.outlets){const b={};return Object.entries(u.outlets).forEach(([T,R])=>{b[T]="string"==typeof R?R.split("/"):R}),[...s,{outlets:b}]}if(u.segmentPath)return[...s,u.segmentPath]}return"string"!=typeof u?[...s,u]:0===m?(u.split("/").forEach((b,T)=>{0==T&&"."===b||(0==T&&""===b?r=!0:".."===b?t++:""!=b&&s.push(b))}),s):[...s,u]},[]);return new bP(r,t,n)}(t);if(u.toRoot())return BM(s,s,new Qr([],{}),r,n);const m=function Mj(e,t,r){if(e.isAbsolute)return new xE(t,!0,0);if(!r)return new xE(t,!1,NaN);if(null===r.parent)return new xE(r,!0,0);const n=bE(e.commands[0])?0:1;return function Aj(e,t,r){let n=e,s=t,u=r;for(;u>s;){if(u-=s,n=n.parent,!n)throw new yt(4005,!1);s=n.segments.length}return new xE(n,!1,s-u)}(r,r.segments.length-1+n,e.numberOfDoubleDots)}(u,s,e),b=m.processChildren?Sx(m.segmentGroup,m.index,u.commands):xP(m.segmentGroup,m.index,u.commands);return BM(s,m.segmentGroup,b,r,n)}function bE(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function Tx(e){return"object"==typeof e&&null!=e&&e.outlets}function BM(e,t,r,n,s){let m,u={};n&&Object.entries(n).forEach(([T,R])=>{u[T]=Array.isArray(R)?R.map(z=>`${z}`):`${R}`}),m=e===t?r:vP(e,t,r);const b=mP(gP(m));return new mv(b,u,s)}function vP(e,t,r){const n={};return Object.entries(e.children).forEach(([s,u])=>{n[s]=u===t?r:vP(u,t,r)}),new Qr(e.segments,n)}class bP{constructor(t,r,n){if(this.isAbsolute=t,this.numberOfDoubleDots=r,this.commands=n,t&&n.length>0&&bE(n[0]))throw new yt(4003,!1);const s=n.find(Tx);if(s&&s!==sP(n))throw new yt(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class xE{constructor(t,r,n){this.segmentGroup=t,this.processChildren=r,this.index=n}}function xP(e,t,r){if(e||(e=new Qr([],{})),0===e.segments.length&&e.hasChildren())return Sx(e,t,r);const n=function kj(e,t,r){let n=0,s=t;const u={match:!1,pathIndex:0,commandIndex:0};for(;s<e.segments.length;){if(n>=r.length)return u;const m=e.segments[s],b=r[n];if(Tx(b))break;const T=`${b}`,R=n<r.length-1?r[n+1]:null;if(s>0&&void 0===T)break;if(T&&R&&"object"==typeof R&&void 0===R.outlets){if(!CP(T,R,m))return u;n+=2}else{if(!CP(T,{},m))return u;n++}s++}return{match:!0,pathIndex:s,commandIndex:n}}(e,t,r),s=r.slice(n.commandIndex);if(n.match&&n.pathIndex<e.segments.length){const u=new Qr(e.segments.slice(0,n.pathIndex),{});return u.children[Zi]=new Qr(e.segments.slice(n.pathIndex),e.children),Sx(u,0,s)}return n.match&&0===s.length?new Qr(e.segments,{}):n.match&&!e.hasChildren()?zM(e,t,r):n.match?Sx(e,0,s):zM(e,t,r)}function Sx(e,t,r){if(0===r.length)return new Qr(e.segments,{});{const n=function Ij(e){return Tx(e[0])?e[0].outlets:{[Zi]:e}}(r),s={};if(Object.keys(n).some(u=>u!==Zi)&&e.children[Zi]&&1===e.numberOfChildren&&0===e.children[Zi].segments.length){const u=Sx(e.children[Zi],t,r);return new Qr(e.segments,u.children)}return Object.entries(n).forEach(([u,m])=>{"string"==typeof m&&(m=[m]),null!==m&&(s[u]=xP(e.children[u],t,m))}),Object.entries(e.children).forEach(([u,m])=>{void 0===n[u]&&(s[u]=m)}),new Qr(e.segments,s)}}function zM(e,t,r){const n=e.segments.slice(0,t);let s=0;for(;s<r.length;){const u=r[s];if(Tx(u)){const T=Rj(u.outlets);return new Qr(n,T)}if(0===s&&bE(r[0])){n.push(new Cx(e.segments[t].path,wP(r[0]))),s++;continue}const m=Tx(u)?u.outlets[Zi]:`${u}`,b=s<r.length-1?r[s+1]:null;m&&b&&bE(b)?(n.push(new Cx(m,wP(b))),s+=2):(n.push(new Cx(m,{})),s++)}return new Qr(n,{})}function Rj(e){const t={};return Object.entries(e).forEach(([r,n])=>{"string"==typeof n&&(n=[n]),null!==n&&(t[r]=zM(new Qr([],{}),0,n))}),t}function wP(e){const t={};return Object.entries(e).forEach(([r,n])=>t[r]=`${n}`),t}function CP(e,t,r){return e==r.path&&uh(t,r.parameters)}const Mx="imperative";class dh{constructor(t,r){this.id=t,this.url=r}}class wE extends dh{constructor(t,r,n="imperative",s=null){super(t,r),this.type=0,this.navigationTrigger=n,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class cm extends dh{constructor(t,r,n){super(t,r),this.urlAfterRedirects=n,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Ax extends dh{constructor(t,r,n,s){super(t,r),this.reason=n,this.code=s,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class gv extends dh{constructor(t,r,n,s){super(t,r),this.reason=n,this.code=s,this.type=16}}class CE extends dh{constructor(t,r,n,s){super(t,r),this.error=n,this.target=s,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class EP extends dh{constructor(t,r,n,s){super(t,r),this.urlAfterRedirects=n,this.state=s,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Pj extends dh{constructor(t,r,n,s){super(t,r),this.urlAfterRedirects=n,this.state=s,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Oj extends dh{constructor(t,r,n,s,u){super(t,r),this.urlAfterRedirects=n,this.state=s,this.shouldActivate=u,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Fj extends dh{constructor(t,r,n,s){super(t,r),this.urlAfterRedirects=n,this.state=s,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Lj extends dh{constructor(t,r,n,s){super(t,r),this.urlAfterRedirects=n,this.state=s,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Nj{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Bj{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class zj{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Vj{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class jj{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Uj{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class DP{constructor(t,r,n){this.routerEvent=t,this.position=r,this.anchor=n,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class VM{}class jM{constructor(t){this.url=t}}class Hj{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Ix,this.attachRef=null}}let Ix=(()=>{var e;class t{constructor(){this.contexts=new Map}onChildOutletCreated(n,s){const u=this.getOrCreateContext(n);u.outlet=s,this.contexts.set(n,u)}onChildOutletDestroyed(n){const s=this.getContext(n);s&&(s.outlet=null,s.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let s=this.getContext(n);return s||(s=new Hj,this.contexts.set(n,s)),s}getContext(n){return this.contexts.get(n)||null}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();class TP{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const r=this.pathFromRoot(t);return r.length>1?r[r.length-2]:null}children(t){const r=UM(t,this._root);return r?r.children.map(n=>n.value):[]}firstChild(t){const r=UM(t,this._root);return r&&r.children.length>0?r.children[0].value:null}siblings(t){const r=HM(t,this._root);return r.length<2?[]:r[r.length-2].children.map(s=>s.value).filter(s=>s!==t)}pathFromRoot(t){return HM(t,this._root).map(r=>r.value)}}function UM(e,t){if(e===t.value)return t;for(const r of t.children){const n=UM(e,r);if(n)return n}return null}function HM(e,t){if(e===t.value)return[t];for(const r of t.children){const n=HM(e,r);if(n.length)return n.unshift(t),n}return[]}class Nf{constructor(t,r){this.value=t,this.children=r}toString(){return`TreeNode(${this.value})`}}function _v(e){const t={};return e&&e.children.forEach(r=>t[r.value.outlet]=r),t}class SP extends TP{constructor(t,r){super(t),this.snapshot=r,$M(this,t)}toString(){return this.snapshot.toString()}}function MP(e,t){const r=function $j(e,t){const m=new EE([],{},{},"",{},Zi,t,null,{});return new IP("",new Nf(m,[]))}(0,t),n=new ui([new Cx("",{})]),s=new ui({}),u=new ui({}),m=new ui({}),b=new ui(""),T=new pu(n,s,m,b,u,Zi,t,r.root);return T.snapshot=r.root,new SP(new Nf(T,[]),r)}class pu{constructor(t,r,n,s,u,m,b,T){this.urlSubject=t,this.paramsSubject=r,this.queryParamsSubject=n,this.fragmentSubject=s,this.dataSubject=u,this.outlet=m,this.component=b,this._futureSnapshot=T,this.title=this.dataSubject?.pipe(ii(R=>R[wx]))??Gn(void 0),this.url=t,this.params=r,this.queryParams=n,this.fragment=s,this.data=u}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(ii(t=>pv(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(ii(t=>pv(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function AP(e,t="emptyOnly"){const r=e.pathFromRoot;let n=0;if("always"!==t)for(n=r.length-1;n>=1;){const s=r[n],u=r[n-1];if(s.routeConfig&&""===s.routeConfig.path)n--;else{if(u.component)break;n--}}return function Gj(e){return e.reduce((t,r)=>({params:{...t.params,...r.params},data:{...t.data,...r.data},resolve:{...r.data,...t.resolve,...r.routeConfig?.data,...r._resolvedData}}),{params:{},data:{},resolve:{}})}(r.slice(n))}class EE{get title(){return this.data?.[wx]}constructor(t,r,n,s,u,m,b,T,R){this.url=t,this.params=r,this.queryParams=n,this.fragment=s,this.data=u,this.outlet=m,this.component=b,this.routeConfig=T,this._resolve=R}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=pv(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=pv(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class IP extends TP{constructor(t,r){super(r),this.url=t,$M(this,r)}toString(){return kP(this._root)}}function $M(e,t){t.value._routerState=e,t.children.forEach(r=>$M(e,r))}function kP(e){const t=e.children.length>0?` { ${e.children.map(kP).join(", ")} } `:"";return`${e.value}${t}`}function GM(e){if(e.snapshot){const t=e.snapshot,r=e._futureSnapshot;e.snapshot=r,uh(t.queryParams,r.queryParams)||e.queryParamsSubject.next(r.queryParams),t.fragment!==r.fragment&&e.fragmentSubject.next(r.fragment),uh(t.params,r.params)||e.paramsSubject.next(r.params),function aj(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(!uh(e[r],t[r]))return!1;return!0}(t.url,r.url)||e.urlSubject.next(r.url),uh(t.data,r.data)||e.dataSubject.next(r.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function qM(e,t){const r=uh(e.params,t.params)&&function dj(e,t){return h_(e,t)&&e.every((r,n)=>uh(r.parameters,t[n].parameters))}(e.url,t.url);return r&&!(!e.parent!=!t.parent)&&(!e.parent||qM(e.parent,t.parent))}let WM=(()=>{var e;class t{constructor(){this.activated=null,this._activatedRoute=null,this.name=Zi,this.activateEvents=new Wn,this.deactivateEvents=new Wn,this.attachEvents=new Wn,this.detachEvents=new Wn,this.parentContexts=Jt(Ix),this.location=Jt(Hl),this.changeDetector=Jt(La),this.environmentInjector=Jt(ra),this.inputBinder=Jt(DE,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){const{firstChange:s,previousValue:u}=n.name;if(s)return;this.isTrackedInParentContexts(u)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(u)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new yt(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new yt(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new yt(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,s){this.activated=n,this._activatedRoute=s,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,s){if(this.isActivated)throw new yt(4013,!1);this._activatedRoute=n;const u=this.location,b=n.snapshot.component,T=this.parentContexts.getOrCreateContext(this.name).children,R=new qj(n,T,u.injector);this.activated=u.createComponent(b,{index:u.length,injector:R,environmentInjector:s??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275dir=Bn({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[v]}),t})();class qj{constructor(t,r,n){this.route=t,this.childContexts=r,this.parent=n}get(t,r){return t===pu?this.route:t===Ix?this.childContexts:this.parent.get(t,r)}}const DE=new Kt("");let RP=(()=>{var e;class t{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){const{activatedRoute:s}=n,u=fE([s.queryParams,s.params,s.data]).pipe(pt(([m,b,T],R)=>(T={...m,...b,...T},0===R?Gn(T):Promise.resolve(T)))).subscribe(m=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==s||null===s.component)return void this.unsubscribeFromRouteData(n);const b=function E4(e){const t=Fi(e);if(!t)return null;const r=new Zg(t);return{get selector(){return r.selector},get type(){return r.componentType},get inputs(){return r.inputs},get outputs(){return r.outputs},get ngContentSelectors(){return r.ngContentSelectors},get isStandalone(){return t.standalone},get isSignal(){return t.signals}}}(s.component);if(b)for(const{templateName:T}of b.inputs)n.activatedComponentRef.setInput(T,m[T]);else this.unsubscribeFromRouteData(n)});this.outletDataSubscriptions.set(n,u)}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})();function kx(e,t,r){if(r&&e.shouldReuseRoute(t.value,r.value.snapshot)){const n=r.value;n._futureSnapshot=t.value;const s=function Zj(e,t,r){return t.children.map(n=>{for(const s of r.children)if(e.shouldReuseRoute(n.value,s.value.snapshot))return kx(e,n,s);return kx(e,n)})}(e,t,r);return new Nf(n,s)}{if(e.shouldAttach(t.value)){const u=e.retrieve(t.value);if(null!==u){const m=u.route;return m.value._futureSnapshot=t.value,m.children=t.children.map(b=>kx(e,b)),m}}const n=function Yj(e){return new pu(new ui(e.url),new ui(e.params),new ui(e.queryParams),new ui(e.fragment),new ui(e.data),e.outlet,e.component,e)}(t.value),s=t.children.map(u=>kx(e,u));return new Nf(n,s)}}const ZM="ngNavigationCancelingError";function PP(e,t){const{redirectTo:r,navigationBehaviorOptions:n}=f_(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,s=OP(!1,0,t);return s.url=r,s.navigationBehaviorOptions=n,s}function OP(e,t,r){const n=new Error("NavigationCancelingError: "+(e||""));return n[ZM]=!0,n.cancellationCode=t,r&&(n.url=r),n}function FP(e){return e&&e[ZM]}let LP=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Ci({type:e,selectors:[["ng-component"]],standalone:!0,features:[VC],decls:1,vars:0,template:function(n,s){1&n&&it(0,"router-outlet")},dependencies:[WM],encapsulation:2}),t})();function YM(e){const t=e.children&&e.children.map(YM),r=t?{...e,children:t}:{...e};return!r.component&&!r.loadComponent&&(t||r.loadChildren)&&r.outlet&&r.outlet!==Zi&&(r.component=LP),r}function rd(e){return e.outlet||Zi}function Rx(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let t=e.parent;t;t=t.parent){const r=t.routeConfig;if(r?._loadedInjector)return r._loadedInjector;if(r?._injector)return r._injector}return null}class i6{constructor(t,r,n,s,u){this.routeReuseStrategy=t,this.futureState=r,this.currState=n,this.forwardEvent=s,this.inputBindingEnabled=u}activate(t){const r=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(r,n,t),GM(this.futureState.root),this.activateChildRoutes(r,n,t)}deactivateChildRoutes(t,r,n){const s=_v(r);t.children.forEach(u=>{const m=u.value.outlet;this.deactivateRoutes(u,s[m],n),delete s[m]}),Object.values(s).forEach(u=>{this.deactivateRouteAndItsChildren(u,n)})}deactivateRoutes(t,r,n){const s=t.value,u=r?r.value:null;if(s===u)if(s.component){const m=n.getContext(s.outlet);m&&this.deactivateChildRoutes(t,r,m.children)}else this.deactivateChildRoutes(t,r,n);else u&&this.deactivateRouteAndItsChildren(r,n)}deactivateRouteAndItsChildren(t,r){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,r):this.deactivateRouteAndOutlet(t,r)}detachAndStoreRouteSubtree(t,r){const n=r.getContext(t.value.outlet),s=n&&t.value.component?n.children:r,u=_v(t);for(const m of Object.keys(u))this.deactivateRouteAndItsChildren(u[m],s);if(n&&n.outlet){const m=n.outlet.detach(),b=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:m,route:t,contexts:b})}}deactivateRouteAndOutlet(t,r){const n=r.getContext(t.value.outlet),s=n&&t.value.component?n.children:r,u=_v(t);for(const m of Object.keys(u))this.deactivateRouteAndItsChildren(u[m],s);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(t,r,n){const s=_v(r);t.children.forEach(u=>{this.activateRoutes(u,s[u.value.outlet],n),this.forwardEvent(new Uj(u.value.snapshot))}),t.children.length&&this.forwardEvent(new Vj(t.value.snapshot))}activateRoutes(t,r,n){const s=t.value,u=r?r.value:null;if(GM(s),s===u)if(s.component){const m=n.getOrCreateContext(s.outlet);this.activateChildRoutes(t,r,m.children)}else this.activateChildRoutes(t,r,n);else if(s.component){const m=n.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){const b=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),m.children.onOutletReAttached(b.contexts),m.attachRef=b.componentRef,m.route=b.route.value,m.outlet&&m.outlet.attach(b.componentRef,b.route.value),GM(b.route.value),this.activateChildRoutes(t,null,m.children)}else{const b=Rx(s.snapshot);m.attachRef=null,m.route=s,m.injector=b,m.outlet&&m.outlet.activateWith(s,m.injector),this.activateChildRoutes(t,null,m.children)}}else this.activateChildRoutes(t,null,n)}}class NP{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class TE{constructor(t,r){this.component=t,this.route=r}}function r6(e,t,r){const n=e._root;return Px(n,t?t._root:null,r,[n.value])}function yv(e,t){const r=Symbol(),n=t.get(e,r);return n===r?"function"!=typeof e||function gd(e){return null!==Lc(e)}(e)?t.get(e):e:n}function Px(e,t,r,n,s={canDeactivateChecks:[],canActivateChecks:[]}){const u=_v(t);return e.children.forEach(m=>{(function s6(e,t,r,n,s={canDeactivateChecks:[],canActivateChecks:[]}){const u=e.value,m=t?t.value:null,b=r?r.getContext(e.value.outlet):null;if(m&&u.routeConfig===m.routeConfig){const T=function a6(e,t,r){if("function"==typeof r)return r(e,t);switch(r){case"pathParamsChange":return!h_(e.url,t.url);case"pathParamsOrQueryParamsChange":return!h_(e.url,t.url)||!uh(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!qM(e,t)||!uh(e.queryParams,t.queryParams);default:return!qM(e,t)}}(m,u,u.routeConfig.runGuardsAndResolvers);T?s.canActivateChecks.push(new NP(n)):(u.data=m.data,u._resolvedData=m._resolvedData),Px(e,t,u.component?b?b.children:null:r,n,s),T&&b&&b.outlet&&b.outlet.isActivated&&s.canDeactivateChecks.push(new TE(b.outlet.component,m))}else m&&Ox(t,b,s),s.canActivateChecks.push(new NP(n)),Px(e,null,u.component?b?b.children:null:r,n,s)})(m,u[m.value.outlet],r,n.concat([m.value]),s),delete u[m.value.outlet]}),Object.entries(u).forEach(([m,b])=>Ox(b,r.getContext(m),s)),s}function Ox(e,t,r){const n=_v(e),s=e.value;Object.entries(n).forEach(([u,m])=>{Ox(m,s.component?t?t.children.getContext(u):null:t,r)}),r.canDeactivateChecks.push(new TE(s.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,s))}function Fx(e){return"function"==typeof e}function BP(e){return e instanceof yx||"EmptyError"===e?.name}const SE=Symbol("INITIAL_VALUE");function vv(){return pt(e=>fE(e.map(t=>t.pipe(Us(1),bx(SE)))).pipe(ii(t=>{for(const r of t)if(!0!==r){if(r===SE)return SE;if(!1===r||r instanceof mv)return r}return!0}),ql(t=>t!==SE),Us(1)))}function zP(e){return function Hn(...e){return Is(e)}(Ba(t=>{if(f_(t))throw PP(0,t)}),ii(t=>!0===t))}class ME{constructor(t){this.segmentGroup=t||null}}class VP{constructor(t){this.urlTree=t}}function bv(e){return vx(new ME(e))}function jP(e){return vx(new VP(e))}class S6{constructor(t,r){this.urlSerializer=t,this.urlTree=r}noMatchError(t){return new yt(4002,!1)}lineralizeSegments(t,r){let n=[],s=r.root;for(;;){if(n=n.concat(s.segments),0===s.numberOfChildren)return Gn(n);if(s.numberOfChildren>1||!s.children[Zi])return vx(new yt(4e3,!1));s=s.children[Zi]}}applyRedirectCommands(t,r,n){return this.applyRedirectCreateUrlTree(r,this.urlSerializer.parse(r),t,n)}applyRedirectCreateUrlTree(t,r,n,s){const u=this.createSegmentGroup(t,r.root,n,s);return new mv(u,this.createQueryParams(r.queryParams,this.urlTree.queryParams),r.fragment)}createQueryParams(t,r){const n={};return Object.entries(t).forEach(([s,u])=>{if("string"==typeof u&&u.startsWith(":")){const b=u.substring(1);n[s]=r[b]}else n[s]=u}),n}createSegmentGroup(t,r,n,s){const u=this.createSegments(t,r.segments,n,s);let m={};return Object.entries(r.children).forEach(([b,T])=>{m[b]=this.createSegmentGroup(t,T,n,s)}),new Qr(u,m)}createSegments(t,r,n,s){return r.map(u=>u.path.startsWith(":")?this.findPosParam(t,u,s):this.findOrReturn(u,n))}findPosParam(t,r,n){const s=n[r.path.substring(1)];if(!s)throw new yt(4001,!1);return s}findOrReturn(t,r){let n=0;for(const s of r){if(s.path===t.path)return r.splice(n),s;n++}return t}}const XM={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function M6(e,t,r,n,s){const u=KM(e,t,r);return u.matched?(n=function Kj(e,t){return e.providers&&!e._injector&&(e._injector=MS(e.providers,t,`Route: ${e.path}`)),e._injector??t}(t,n),function E6(e,t,r,n){const s=t.canMatch;return s&&0!==s.length?Gn(s.map(m=>{const b=yv(m,e);return lm(function f6(e){return e&&Fx(e.canMatch)}(b)?b.canMatch(t,r):e.runInContext(()=>b(t,r)))})).pipe(vv(),zP()):Gn(!0)}(n,t,r).pipe(ii(m=>!0===m?u:{...XM}))):Gn(u)}function KM(e,t,r){if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||r.length>0)?{...XM}:{matched:!0,consumedSegments:[],remainingSegments:r,parameters:{},positionalParamSegments:{}};const s=(t.matcher||sj)(r,e,t);if(!s)return{...XM};const u={};Object.entries(s.posParams??{}).forEach(([b,T])=>{u[b]=T.path});const m=s.consumed.length>0?{...u,...s.consumed[s.consumed.length-1].parameters}:u;return{matched:!0,consumedSegments:s.consumed,remainingSegments:r.slice(s.consumed.length),parameters:m,positionalParamSegments:s.posParams??{}}}function UP(e,t,r,n){return r.length>0&&function k6(e,t,r){return r.some(n=>AE(e,t,n)&&rd(n)!==Zi)}(e,r,n)?{segmentGroup:new Qr(t,I6(n,new Qr(r,e.children))),slicedSegments:[]}:0===r.length&&function R6(e,t,r){return r.some(n=>AE(e,t,n))}(e,r,n)?{segmentGroup:new Qr(e.segments,A6(e,0,r,n,e.children)),slicedSegments:r}:{segmentGroup:new Qr(e.segments,e.children),slicedSegments:r}}function A6(e,t,r,n,s){const u={};for(const m of n)if(AE(e,r,m)&&!s[rd(m)]){const b=new Qr([],{});u[rd(m)]=b}return{...s,...u}}function I6(e,t){const r={};r[Zi]=t;for(const n of e)if(""===n.path&&rd(n)!==Zi){const s=new Qr([],{});r[rd(n)]=s}return r}function AE(e,t,r){return(!(e.hasChildren()||t.length>0)||"full"!==r.pathMatch)&&""===r.path}class L6{constructor(t,r,n,s,u,m,b){this.injector=t,this.configLoader=r,this.rootComponentType=n,this.config=s,this.urlTree=u,this.paramsInheritanceStrategy=m,this.urlSerializer=b,this.allowRedirects=!0,this.applyRedirects=new S6(this.urlSerializer,this.urlTree)}noMatchError(t){return new yt(4002,!1)}recognize(){const t=UP(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,Zi).pipe(d_(r=>{if(r instanceof VP)return this.allowRedirects=!1,this.urlTree=r.urlTree,this.match(r.urlTree);throw r instanceof ME?this.noMatchError(r):r}),ii(r=>{const n=new EE([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Zi,this.rootComponentType,null,{}),s=new Nf(n,r),u=new IP("",s),m=function Tj(e,t,r=null,n=null){return yP(_P(e),t,r,n)}(n,[],this.urlTree.queryParams,this.urlTree.fragment);return m.queryParams=this.urlTree.queryParams,u.url=this.urlSerializer.serialize(m),this.inheritParamsAndData(u._root),{state:u,tree:m}}))}match(t){return this.processSegmentGroup(this.injector,this.config,t.root,Zi).pipe(d_(n=>{throw n instanceof ME?this.noMatchError(n):n}))}inheritParamsAndData(t){const r=t.value,n=AP(r,this.paramsInheritanceStrategy);r.params=Object.freeze(n.params),r.data=Object.freeze(n.data),t.children.forEach(s=>this.inheritParamsAndData(s))}processSegmentGroup(t,r,n,s){return 0===n.segments.length&&n.hasChildren()?this.processChildren(t,r,n):this.processSegment(t,r,n,n.segments,s,!0)}processChildren(t,r,n){const s=[];for(const u of Object.keys(n.children))"primary"===u?s.unshift(u):s.push(u);return wr(s).pipe(u_(u=>{const m=n.children[u],b=function t6(e,t){const r=e.filter(n=>rd(n)===t);return r.push(...e.filter(n=>rd(n)!==t)),r}(r,u);return this.processSegmentGroup(t,b,m,u)}),function nj(e,t){return ur(function tj(e,t,r,n,s){return(u,m)=>{let b=r,T=t,R=0;u.subscribe(ai(m,z=>{const W=R++;T=b?e(T,z,W):(b=!0,z),n&&m.next(T)},s&&(()=>{b&&m.next(T),m.complete()})))}}(e,t,arguments.length>=2,!0))}((u,m)=>(u.push(...m),u)),mE(null),function ij(e,t){const r=arguments.length>=2;return n=>n.pipe(e?ql((s,u)=>e(s,u,n)):ts,OM(1),r?mE(t):rP(()=>new yx))}(),Wr(u=>{if(null===u)return bv(n);const m=HP(u);return function N6(e){e.sort((t,r)=>t.value.outlet===Zi?-1:r.value.outlet===Zi?1:t.value.outlet.localeCompare(r.value.outlet))}(m),Gn(m)}))}processSegment(t,r,n,s,u,m){return wr(r).pipe(u_(b=>this.processSegmentAgainstRoute(b._injector??t,r,b,n,s,u,m).pipe(d_(T=>{if(T instanceof ME)return Gn(null);throw T}))),c_(b=>!!b),d_(b=>{if(BP(b))return function O6(e,t,r){return 0===t.length&&!e.children[r]}(n,s,u)?Gn([]):bv(n);throw b}))}processSegmentAgainstRoute(t,r,n,s,u,m,b){return function P6(e,t,r,n){return!!(rd(e)===n||n!==Zi&&AE(t,r,e))&&("**"===e.path||KM(t,e,r).matched)}(n,s,u,m)?void 0===n.redirectTo?this.matchSegmentAgainstRoute(t,s,n,u,m,b):b&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,s,r,n,u,m):bv(s):bv(s)}expandSegmentAgainstRouteUsingRedirect(t,r,n,s,u,m){return"**"===s.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,s,m):this.expandRegularSegmentAgainstRouteUsingRedirect(t,r,n,s,u,m)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,r,n,s){const u=this.applyRedirects.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?jP(u):this.applyRedirects.lineralizeSegments(n,u).pipe(Wr(m=>{const b=new Qr(m,{});return this.processSegment(t,r,b,m,s,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,r,n,s,u,m){const{matched:b,consumedSegments:T,remainingSegments:R,positionalParamSegments:z}=KM(r,s,u);if(!b)return bv(r);const W=this.applyRedirects.applyRedirectCommands(T,s.redirectTo,z);return s.redirectTo.startsWith("/")?jP(W):this.applyRedirects.lineralizeSegments(s,W).pipe(Wr(le=>this.processSegment(t,n,r,le.concat(R),m,!1)))}matchSegmentAgainstRoute(t,r,n,s,u,m){let b;if("**"===n.path){const T=s.length>0?sP(s).parameters:{};b=Gn({snapshot:new EE(s,T,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,$P(n),rd(n),n.component??n._loadedComponent??null,n,GP(n)),consumedSegments:[],remainingSegments:[]}),r.children={}}else b=M6(r,n,s,t).pipe(ii(({matched:T,consumedSegments:R,remainingSegments:z,parameters:W})=>T?{snapshot:new EE(R,W,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,$P(n),rd(n),n.component??n._loadedComponent??null,n,GP(n)),consumedSegments:R,remainingSegments:z}:null));return b.pipe(pt(T=>null===T?bv(r):this.getChildConfig(t=n._injector??t,n,s).pipe(pt(({routes:R})=>{const z=n._loadedInjector??t,{snapshot:W,consumedSegments:le,remainingSegments:he}=T,{segmentGroup:Me,slicedSegments:Ve}=UP(r,le,he,R);if(0===Ve.length&&Me.hasChildren())return this.processChildren(z,R,Me).pipe(ii(wt=>null===wt?null:[new Nf(W,wt)]));if(0===R.length&&0===Ve.length)return Gn([new Nf(W,[])]);const at=rd(n)===u;return this.processSegment(z,R,Me,Ve,at?Zi:u,!0).pipe(ii(wt=>[new Nf(W,wt)]))}))))}getChildConfig(t,r,n){return r.children?Gn({routes:r.children,injector:t}):r.loadChildren?void 0!==r._loadedRoutes?Gn({routes:r._loadedRoutes,injector:r._loadedInjector}):function C6(e,t,r,n){const s=t.canLoad;return void 0===s||0===s.length?Gn(!0):Gn(s.map(m=>{const b=yv(m,e);return lm(function c6(e){return e&&Fx(e.canLoad)}(b)?b.canLoad(t,r):e.runInContext(()=>b(t,r)))})).pipe(vv(),zP())}(t,r,n).pipe(Wr(s=>s?this.configLoader.loadChildren(t,r).pipe(Ba(u=>{r._loadedRoutes=u.routes,r._loadedInjector=u.injector})):function T6(e){return vx(OP(!1,3))}())):Gn({routes:[],injector:t})}}function B6(e){const t=e.value.routeConfig;return t&&""===t.path}function HP(e){const t=[],r=new Set;for(const n of e){if(!B6(n)){t.push(n);continue}const s=t.find(u=>n.value.routeConfig===u.value.routeConfig);void 0!==s?(s.children.push(...n.children),r.add(s)):t.push(n)}for(const n of r){const s=HP(n.children);t.push(new Nf(n.value,s))}return t.filter(n=>!r.has(n))}function $P(e){return e.data||{}}function GP(e){return e.resolve||{}}function qP(e){return"string"==typeof e.title||null===e.title}function QM(e){return pt(t=>{const r=e(t);return r?wr(r).pipe(ii(()=>t)):Gn(t)})}const xv=new Kt("ROUTES");let JM=(()=>{var e;class t{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Jt(Ak)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return Gn(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const s=lm(n.loadComponent()).pipe(ii(WP),Ba(m=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=m}),xx(()=>{this.componentLoaders.delete(n)})),u=new iP(s,()=>new qe).pipe(PM());return this.componentLoaders.set(n,u),u}loadChildren(n,s){if(this.childrenLoaders.get(s))return this.childrenLoaders.get(s);if(s._loadedRoutes)return Gn({routes:s._loadedRoutes,injector:s._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(s);const m=this.loadModuleFactoryOrRoutes(s.loadChildren).pipe(ii(T=>{this.onLoadEndListener&&this.onLoadEndListener(s);let R,z;return Array.isArray(T)?z=T:(R=T.create(n).injector,z=R.get(xv,[],ri.Self|ri.Optional).flat()),{routes:z.map(YM),injector:R}}),xx(()=>{this.childrenLoaders.delete(s)})),b=new iP(m,()=>new qe).pipe(PM());return this.childrenLoaders.set(s,b),b}loadModuleFactoryOrRoutes(n){return lm(n()).pipe(ii(WP),Wr(s=>s instanceof BI||Array.isArray(s)?Gn(s):wr(this.compiler.compileModuleAsync(s))))}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();function WP(e){return function G6(e){return e&&"object"==typeof e&&"default"in e}(e)?e.default:e}let IE=(()=>{var e;class t{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new qe,this.transitionAbortSubject=new qe,this.configLoader=Jt(JM),this.environmentInjector=Jt(ra),this.urlSerializer=Jt(Ex),this.rootContexts=Jt(Ix),this.inputBindingEnabled=null!==Jt(DE,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Gn(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=u=>this.events.next(new Bj(u)),this.configLoader.onLoadStartListener=u=>this.events.next(new Nj(u))}complete(){this.transitions?.complete()}handleNavigationRequest(n){const s=++this.navigationId;this.transitions?.next({...this.transitions.value,...n,id:s})}setupNavigations(n,s,u){return this.transitions=new ui({id:0,currentUrlTree:s,currentRawUrl:s,currentBrowserUrl:s,extractedUrl:n.urlHandlingStrategy.extract(s),urlAfterRedirects:n.urlHandlingStrategy.extract(s),rawUrl:s,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Mx,restoredState:null,currentSnapshot:u.snapshot,targetSnapshot:null,currentRouterState:u,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(ql(m=>0!==m.id),ii(m=>({...m,extractedUrl:n.urlHandlingStrategy.extract(m.rawUrl)})),pt(m=>{this.currentTransition=m;let b=!1,T=!1;return Gn(m).pipe(Ba(R=>{this.currentNavigation={id:R.id,initialUrl:R.rawUrl,extractedUrl:R.extractedUrl,trigger:R.source,extras:R.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),pt(R=>{const z=R.currentBrowserUrl.toString(),W=!n.navigated||R.extractedUrl.toString()!==z||z!==R.currentUrlTree.toString();if(!W&&"reload"!==(R.extras.onSameUrlNavigation??n.onSameUrlNavigation)){const he="";return this.events.next(new gv(R.id,this.urlSerializer.serialize(R.rawUrl),he,0)),R.resolve(null),Eo}if(n.urlHandlingStrategy.shouldProcessUrl(R.rawUrl))return Gn(R).pipe(pt(he=>{const Me=this.transitions?.getValue();return this.events.next(new wE(he.id,this.urlSerializer.serialize(he.extractedUrl),he.source,he.restoredState)),Me!==this.transitions?.getValue()?Eo:Promise.resolve(he)}),function z6(e,t,r,n,s,u){return Wr(m=>function F6(e,t,r,n,s,u,m="emptyOnly"){return new L6(e,t,r,n,s,m,u).recognize()}(e,t,r,n,m.extractedUrl,s,u).pipe(ii(({state:b,tree:T})=>({...m,targetSnapshot:b,urlAfterRedirects:T}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,n.paramsInheritanceStrategy),Ba(he=>{m.targetSnapshot=he.targetSnapshot,m.urlAfterRedirects=he.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:he.urlAfterRedirects};const Me=new EP(he.id,this.urlSerializer.serialize(he.extractedUrl),this.urlSerializer.serialize(he.urlAfterRedirects),he.targetSnapshot);this.events.next(Me)}));if(W&&n.urlHandlingStrategy.shouldProcessUrl(R.currentRawUrl)){const{id:he,extractedUrl:Me,source:Ve,restoredState:at,extras:wt}=R,ft=new wE(he,this.urlSerializer.serialize(Me),Ve,at);this.events.next(ft);const Nn=MP(0,this.rootComponentType).snapshot;return this.currentTransition=m={...R,targetSnapshot:Nn,urlAfterRedirects:Me,extras:{...wt,skipLocationChange:!1,replaceUrl:!1}},Gn(m)}{const he="";return this.events.next(new gv(R.id,this.urlSerializer.serialize(R.extractedUrl),he,1)),R.resolve(null),Eo}}),Ba(R=>{const z=new Pj(R.id,this.urlSerializer.serialize(R.extractedUrl),this.urlSerializer.serialize(R.urlAfterRedirects),R.targetSnapshot);this.events.next(z)}),ii(R=>(this.currentTransition=m={...R,guards:r6(R.targetSnapshot,R.currentSnapshot,this.rootContexts)},m)),function m6(e,t){return Wr(r=>{const{targetSnapshot:n,currentSnapshot:s,guards:{canActivateChecks:u,canDeactivateChecks:m}}=r;return 0===m.length&&0===u.length?Gn({...r,guardsResult:!0}):function g6(e,t,r,n){return wr(e).pipe(Wr(s=>function w6(e,t,r,n,s){const u=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return u&&0!==u.length?Gn(u.map(b=>{const T=Rx(t)??s,R=yv(b,T);return lm(function h6(e){return e&&Fx(e.canDeactivate)}(R)?R.canDeactivate(e,t,r,n):T.runInContext(()=>R(e,t,r,n))).pipe(c_())})).pipe(vv()):Gn(!0)}(s.component,s.route,r,t,n)),c_(s=>!0!==s,!0))}(m,n,s,e).pipe(Wr(b=>b&&function l6(e){return"boolean"==typeof e}(b)?function _6(e,t,r,n){return wr(t).pipe(u_(s=>fv(function v6(e,t){return null!==e&&t&&t(new zj(e)),Gn(!0)}(s.route.parent,n),function y6(e,t){return null!==e&&t&&t(new jj(e)),Gn(!0)}(s.route,n),function x6(e,t,r){const n=t[t.length-1],u=t.slice(0,t.length-1).reverse().map(m=>function o6(e){const t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(m)).filter(m=>null!==m).map(m=>pE(()=>Gn(m.guards.map(T=>{const R=Rx(m.node)??r,z=yv(T,R);return lm(function d6(e){return e&&Fx(e.canActivateChild)}(z)?z.canActivateChild(n,e):R.runInContext(()=>z(n,e))).pipe(c_())})).pipe(vv())));return Gn(u).pipe(vv())}(e,s.path,r),function b6(e,t,r){const n=t.routeConfig?t.routeConfig.canActivate:null;if(!n||0===n.length)return Gn(!0);const s=n.map(u=>pE(()=>{const m=Rx(t)??r,b=yv(u,m);return lm(function u6(e){return e&&Fx(e.canActivate)}(b)?b.canActivate(t,e):m.runInContext(()=>b(t,e))).pipe(c_())}));return Gn(s).pipe(vv())}(e,s.route,r))),c_(s=>!0!==s,!0))}(n,u,e,t):Gn(b)),ii(b=>({...r,guardsResult:b})))})}(this.environmentInjector,R=>this.events.next(R)),Ba(R=>{if(m.guardsResult=R.guardsResult,f_(R.guardsResult))throw PP(0,R.guardsResult);const z=new Oj(R.id,this.urlSerializer.serialize(R.extractedUrl),this.urlSerializer.serialize(R.urlAfterRedirects),R.targetSnapshot,!!R.guardsResult);this.events.next(z)}),ql(R=>!!R.guardsResult||(this.cancelNavigationTransition(R,"",3),!1)),QM(R=>{if(R.guards.canActivateChecks.length)return Gn(R).pipe(Ba(z=>{const W=new Fj(z.id,this.urlSerializer.serialize(z.extractedUrl),this.urlSerializer.serialize(z.urlAfterRedirects),z.targetSnapshot);this.events.next(W)}),pt(z=>{let W=!1;return Gn(z).pipe(function V6(e,t){return Wr(r=>{const{targetSnapshot:n,guards:{canActivateChecks:s}}=r;if(!s.length)return Gn(r);let u=0;return wr(s).pipe(u_(m=>function j6(e,t,r,n){const s=e.routeConfig,u=e._resolve;return void 0!==s?.title&&!qP(s)&&(u[wx]=s.title),function U6(e,t,r,n){const s=function H6(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}(e);if(0===s.length)return Gn({});const u={};return wr(s).pipe(Wr(m=>function $6(e,t,r,n){const s=Rx(t)??n,u=yv(e,s);return lm(u.resolve?u.resolve(t,r):s.runInContext(()=>u(t,r)))}(e[m],t,r,n).pipe(c_(),Ba(b=>{u[m]=b}))),OM(1),function rj(e){return ii(()=>e)}(u),d_(m=>BP(m)?Eo:vx(m)))}(u,e,t,n).pipe(ii(m=>(e._resolvedData=m,e.data=AP(e,r).resolve,s&&qP(s)&&(e.data[wx]=s.title),null)))}(m.route,n,e,t)),Ba(()=>u++),OM(1),Wr(m=>u===s.length?Gn(r):Eo))})}(n.paramsInheritanceStrategy,this.environmentInjector),Ba({next:()=>W=!0,complete:()=>{W||this.cancelNavigationTransition(z,"",2)}}))}),Ba(z=>{const W=new Lj(z.id,this.urlSerializer.serialize(z.extractedUrl),this.urlSerializer.serialize(z.urlAfterRedirects),z.targetSnapshot);this.events.next(W)}))}),QM(R=>{const z=W=>{const le=[];W.routeConfig?.loadComponent&&!W.routeConfig._loadedComponent&&le.push(this.configLoader.loadComponent(W.routeConfig).pipe(Ba(he=>{W.component=he}),ii(()=>{})));for(const he of W.children)le.push(...z(he));return le};return fE(z(R.targetSnapshot.root)).pipe(mE(),Us(1))}),QM(()=>this.afterPreactivation()),ii(R=>{const z=function Wj(e,t,r){const n=kx(e,t._root,r?r._root:void 0);return new SP(n,t)}(n.routeReuseStrategy,R.targetSnapshot,R.currentRouterState);return this.currentTransition=m={...R,targetRouterState:z},m}),Ba(()=>{this.events.next(new VM)}),((e,t,r,n)=>ii(s=>(new i6(t,s.targetRouterState,s.currentRouterState,r,n).activate(e),s)))(this.rootContexts,n.routeReuseStrategy,R=>this.events.next(R),this.inputBindingEnabled),Us(1),Ba({next:R=>{b=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new cm(R.id,this.urlSerializer.serialize(R.extractedUrl),this.urlSerializer.serialize(R.urlAfterRedirects))),n.titleStrategy?.updateTitle(R.targetRouterState.snapshot),R.resolve(!0)},complete:()=>{b=!0}}),Wl(this.transitionAbortSubject.pipe(Ba(R=>{throw R}))),xx(()=>{b||T||this.cancelNavigationTransition(m,"",1),this.currentNavigation?.id===m.id&&(this.currentNavigation=null)}),d_(R=>{if(T=!0,FP(R))this.events.next(new Ax(m.id,this.urlSerializer.serialize(m.extractedUrl),R.message,R.cancellationCode)),function Xj(e){return FP(e)&&f_(e.url)}(R)?this.events.next(new jM(R.url)):m.resolve(!1);else{this.events.next(new CE(m.id,this.urlSerializer.serialize(m.extractedUrl),R,m.targetSnapshot??void 0));try{m.resolve(n.errorHandler(R))}catch(z){m.reject(z)}}return Eo}))}))}cancelNavigationTransition(n,s,u){const m=new Ax(n.id,this.urlSerializer.serialize(n.extractedUrl),s,u);this.events.next(m),n.resolve(!1)}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();function ZP(e){return e!==Mx}let YP=(()=>{var e;class t{buildTitle(n){let s,u=n.root;for(;void 0!==u;)s=this.getResolvedTitleForRoute(u)??s,u=u.children.find(m=>m.outlet===Zi);return s}getResolvedTitleForRoute(n){return n.data[wx]}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:function(){return Jt(q6)},providedIn:"root"}),t})(),q6=(()=>{var e;class t extends YP{constructor(n){super(),this.title=n}updateTitle(n){const s=this.buildTitle(n);void 0!==s&&this.title.setTitle(s)}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(YR))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),W6=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:function(){return Jt(Y6)},providedIn:"root"}),t})();class Z6{shouldDetach(t){return!1}store(t,r){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,r){return t.routeConfig===r.routeConfig}}let Y6=(()=>{var e;class t extends Z6{}return(e=t).\u0275fac=function(){let r;return function(s){return(r||(r=mi(e)))(s||e)}}(),e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();const kE=new Kt("",{providedIn:"root",factory:()=>({})});let X6=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:function(){return Jt(K6)},providedIn:"root"}),t})(),K6=(()=>{var e;class t{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,s){return n}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();var Lx=function(e){return e[e.COMPLETE=0]="COMPLETE",e[e.FAILED=1]="FAILED",e[e.REDIRECTING=2]="REDIRECTING",e}(Lx||{});function XP(e,t){e.events.pipe(ql(r=>r instanceof cm||r instanceof Ax||r instanceof CE||r instanceof gv),ii(r=>r instanceof cm||r instanceof gv?Lx.COMPLETE:r instanceof Ax&&(0===r.code||1===r.code)?Lx.REDIRECTING:Lx.FAILED),ql(r=>r!==Lx.REDIRECTING),Us(1)).subscribe(()=>{t()})}function Q6(e){throw e}function J6(e,t,r){return t.parse("/")}const eU={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},tU={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Jo=(()=>{var e;class t{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=Jt(Mk),this.isNgZoneEnabled=!1,this._events=new qe,this.options=Jt(kE,{optional:!0})||{},this.pendingTasks=Jt($C),this.errorHandler=this.options.errorHandler||Q6,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||J6,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=Jt(X6),this.routeReuseStrategy=Jt(W6),this.titleStrategy=Jt(YP),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=Jt(xv,{optional:!0})?.flat()??[],this.navigationTransitions=Jt(IE),this.urlSerializer=Jt(Ex),this.location=Jt(QC),this.componentInputBindingEnabled=!!Jt(DE,{optional:!0}),this.eventsSubscription=new me,this.isNgZoneEnabled=Jt(si)instanceof si&&si.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new mv,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=MP(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(n=>{this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const n=this.navigationTransitions.events.subscribe(s=>{try{const{currentTransition:u}=this.navigationTransitions;if(null===u)return void(KP(s)&&this._events.next(s));if(s instanceof wE)ZP(u.source)&&(this.browserUrlTree=u.extractedUrl);else if(s instanceof gv)this.rawUrlTree=u.rawUrl;else if(s instanceof EP){if("eager"===this.urlUpdateStrategy){if(!u.extras.skipLocationChange){const m=this.urlHandlingStrategy.merge(u.urlAfterRedirects,u.rawUrl);this.setBrowserUrl(m,u)}this.browserUrlTree=u.urlAfterRedirects}}else if(s instanceof VM)this.currentUrlTree=u.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(u.urlAfterRedirects,u.rawUrl),this.routerState=u.targetRouterState,"deferred"===this.urlUpdateStrategy&&(u.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,u),this.browserUrlTree=u.urlAfterRedirects);else if(s instanceof Ax)0!==s.code&&1!==s.code&&(this.navigated=!0),(3===s.code||2===s.code)&&this.restoreHistory(u);else if(s instanceof jM){const m=this.urlHandlingStrategy.merge(s.url,u.currentRawUrl),b={skipLocationChange:u.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||ZP(u.source)};this.scheduleNavigation(m,Mx,null,b,{resolve:u.resolve,reject:u.reject,promise:u.promise})}s instanceof CE&&this.restoreHistory(u,!0),s instanceof cm&&(this.navigated=!0),KP(s)&&this._events.next(s)}catch(u){this.navigationTransitions.transitionAbortSubject.next(u)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const n=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Mx,n)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const s="popstate"===n.type?"popstate":"hashchange";"popstate"===s&&setTimeout(()=>{this.navigateToSyncWithBrowser(n.url,s,n.state)},0)}))}navigateToSyncWithBrowser(n,s,u){const m={replaceUrl:!0},b=u?.navigationId?u:null;if(u){const R={...u};delete R.navigationId,delete R.\u0275routerPageId,0!==Object.keys(R).length&&(m.state=R)}const T=this.parseUrl(n);this.scheduleNavigation(T,s,b,m)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(YM),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,s={}){const{relativeTo:u,queryParams:m,fragment:b,queryParamsHandling:T,preserveFragment:R}=s,z=R?this.currentUrlTree.fragment:b;let le,W=null;switch(T){case"merge":W={...this.currentUrlTree.queryParams,...m};break;case"preserve":W=this.currentUrlTree.queryParams;break;default:W=m||null}null!==W&&(W=this.removeEmptyProps(W));try{le=_P(u?u.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof n[0]||!n[0].startsWith("/"))&&(n=[]),le=this.currentUrlTree.root}return yP(le,n,W,z??null)}navigateByUrl(n,s={skipLocationChange:!1}){const u=f_(n)?n:this.parseUrl(n),m=this.urlHandlingStrategy.merge(u,this.rawUrlTree);return this.scheduleNavigation(m,Mx,null,s)}navigate(n,s={skipLocationChange:!1}){return function nU(e){for(let t=0;t<e.length;t++)if(null==e[t])throw new yt(4008,!1)}(n),this.navigateByUrl(this.createUrlTree(n,s),s)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let s;try{s=this.urlSerializer.parse(n)}catch(u){s=this.malformedUriErrorHandler(u,this.urlSerializer,n)}return s}isActive(n,s){let u;if(u=!0===s?{...eU}:!1===s?{...tU}:s,f_(n))return lP(this.currentUrlTree,n,u);const m=this.parseUrl(n);return lP(this.currentUrlTree,m,u)}removeEmptyProps(n){return Object.keys(n).reduce((s,u)=>{const m=n[u];return null!=m&&(s[u]=m),s},{})}scheduleNavigation(n,s,u,m,b){if(this.disposed)return Promise.resolve(!1);let T,R,z;b?(T=b.resolve,R=b.reject,z=b.promise):z=new Promise((le,he)=>{T=le,R=he});const W=this.pendingTasks.add();return XP(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(W))}),this.navigationTransitions.handleNavigationRequest({source:s,restoredState:u,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:n,extras:m,resolve:T,reject:R,promise:z,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),z.catch(le=>Promise.reject(le))}setBrowserUrl(n,s){const u=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(u)||s.extras.replaceUrl){const b={...s.extras.state,...this.generateNgRouterState(s.id,this.browserPageId)};this.location.replaceState(u,"",b)}else{const m={...s.extras.state,...this.generateNgRouterState(s.id,this.browserPageId+1)};this.location.go(u,"",m)}}restoreHistory(n,s=!1){if("computed"===this.canceledNavigationResolution){const m=this.currentPageId-this.browserPageId;0!==m?this.location.historyGo(m):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===m&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(s&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,s){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:s}:{navigationId:n}}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();function KP(e){return!(e instanceof VM||e instanceof jM)}let sa=(()=>{var e;class t{constructor(n,s,u,m,b,T){this.router=n,this.route=s,this.tabIndexAttribute=u,this.renderer=m,this.el=b,this.locationStrategy=T,this.href=null,this.commands=null,this.onChanges=new qe,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const R=b.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===R||"area"===R,this.isAnchorElement?this.subscription=n.events.subscribe(z=>{z instanceof cm&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){null!=n?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(n,s,u,m,b){return!!(null===this.urlTree||this.isAnchorElement&&(0!==n||s||u||m||b||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const n=null===this.href?null:function Cg(e,t,r){return function Nb(e,t){return"src"===t&&("embed"===e||"frame"===e||"iframe"===e||"media"===e||"script"===e)||"href"===t&&("base"===e||"link"===e)?gw:qd}(t,r)(e)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",n)}applyAttributeValue(n,s){const u=this.renderer,m=this.el.nativeElement;null!==s?u.setAttribute(m,n,s):u.removeAttribute(m,n)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(Jo),xe(pu),function mp(e){return function LD(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;const r=e.attrs;if(r){const n=r.length;let s=0;for(;s<n;){const u=r[s];if(Do(u))break;if(0===u)s+=2;else if("number"==typeof u)for(s++;s<n&&"string"==typeof r[s];)s++;else{if(u===t)return r[s+1];s+=2}}}return null}(hr(),e)}("tabindex"),xe($u),xe(tr),xe(l_))},e.\u0275dir=Bn({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(n,s){1&n&&zt("click",function(m){return s.onClick(m.button,m.ctrlKey,m.shiftKey,m.altKey,m.metaKey)}),2&n&&Fr("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",uv],skipLocationChange:["skipLocationChange","skipLocationChange",uv],replaceUrl:["replaceUrl","replaceUrl",uv],routerLink:"routerLink"},standalone:!0,features:[Jd,v]}),t})(),QP=(()=>{var e;class t{get isActive(){return this._isActive}constructor(n,s,u,m,b){this.router=n,this.element=s,this.renderer=u,this.cdr=m,this.link=b,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new Wn,this.routerEventsSubscription=n.events.subscribe(T=>{T instanceof cm&&this.update()})}ngAfterContentInit(){Gn(this.links.changes,Gn(null)).pipe(_l()).subscribe(n=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const n=[...this.links.toArray(),this.link].filter(s=>!!s).map(s=>s.onChanges);this.linkInputChangesSubscription=wr(n).pipe(_l()).subscribe(s=>{this._isActive!==this.isLinkActive(this.router)(s)&&this.update()})}set routerLinkActive(n){const s=Array.isArray(n)?n:n.split(" ");this.classes=s.filter(u=>!!u)}ngOnChanges(n){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{const n=this.hasActiveLinks();this._isActive!==n&&(this._isActive=n,this.cdr.markForCheck(),this.classes.forEach(s=>{n?this.renderer.addClass(this.element.nativeElement,s):this.renderer.removeClass(this.element.nativeElement,s)}),n&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this.isActiveChange.emit(n))})}isLinkActive(n){const s=function iU(e){return!!e.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return u=>!!u.urlTree&&n.isActive(u.urlTree,s)}hasActiveLinks(){const n=this.isLinkActive(this.router);return this.link&&n(this.link)||this.links.some(n)}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(Jo),xe(tr),xe($u),xe(La),xe(sa,8))},e.\u0275dir=Bn({type:e,selectors:[["","routerLinkActive",""]],contentQueries:function(n,s,u){if(1&n&&function lk(e,t,r,n){const s=un();if(s.firstCreatePass){const u=hr();uk(s,new sk(t,r,n),u.index),function YB(e,t){const r=e.contentQueries||(e.contentQueries=[]);t!==(r.length?r[r.length-1]:-1)&&r.push(e.queries.length-1,t)}(s,e),2==(2&r)&&(s.staticContentQueries=!0)}ck(s,mt(),r)}(u,sa,5),2&n){let m;Oa(m=Fa())&&(s.links=m)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[v]}),t})();class JP{}let rU=(()=>{var e;class t{constructor(n,s,u,m,b){this.router=n,this.injector=u,this.preloadingStrategy=m,this.loader=b}setUpPreloading(){this.subscription=this.router.events.pipe(ql(n=>n instanceof cm),u_(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,s){const u=[];for(const m of s){m.providers&&!m._injector&&(m._injector=MS(m.providers,n,`Route: ${m.path}`));const b=m._injector??n,T=m._loadedInjector??b;(m.loadChildren&&!m._loadedRoutes&&void 0===m.canLoad||m.loadComponent&&!m._loadedComponent)&&u.push(this.preloadConfig(b,m)),(m.children||m._loadedRoutes)&&u.push(this.processRoutes(T,m.children??m._loadedRoutes))}return wr(u).pipe(_l())}preloadConfig(n,s){return this.preloadingStrategy.preload(s,()=>{let u;u=s.loadChildren&&void 0===s.canLoad?this.loader.loadChildren(n,s):Gn(null);const m=u.pipe(Wr(b=>null===b?Gn(void 0):(s._loadedRoutes=b.routes,s._loadedInjector=b.injector,this.processRoutes(b.injector??n,b.routes))));return s.loadComponent&&!s._loadedComponent?wr([m,this.loader.loadComponent(s)]).pipe(_l()):m})}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Jo),ze(Ak),ze(ra),ze(JP),ze(JM))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();const e2=new Kt("");let eO=(()=>{var e;class t{constructor(n,s,u,m,b={}){this.urlSerializer=n,this.transitions=s,this.viewportScroller=u,this.zone=m,this.options=b,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},b.scrollPositionRestoration=b.scrollPositionRestoration||"disabled",b.anchorScrolling=b.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof wE?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof cm?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof gv&&0===n.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof DP&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,s){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new DP(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,s))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return(e=t).\u0275fac=function(n){ol()},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})();function Bf(e,t){return{\u0275kind:e,\u0275providers:t}}function nO(){const e=Jt(Xr);return t=>{const r=e.get(ch);if(t!==r.components[0])return;const n=e.get(Jo),s=e.get(iO);1===e.get(t2)&&n.initialNavigation(),e.get(rO,null,ri.Optional)?.setUpPreloading(),e.get(e2,null,ri.Optional)?.init(),n.resetRootComponentType(r.componentTypes[0]),s.closed||(s.next(),s.complete(),s.unsubscribe())}}const iO=new Kt("",{factory:()=>new qe}),t2=new Kt("",{providedIn:"root",factory:()=>1}),rO=new Kt("");function lU(e){return Bf(0,[{provide:rO,useExisting:rU},{provide:JP,useExisting:e}])}const oO=new Kt("ROUTER_FORROOT_GUARD"),uU=[QC,{provide:Ex,useClass:FM},Jo,Ix,{provide:pu,useFactory:function tO(e){return e.routerState.root},deps:[Jo]},JM,[]];function dU(){return new Lk("Router",Jo)}let sO=(()=>{var e;class t{constructor(n){}static forRoot(n,s){return{ngModule:t,providers:[uU,[],{provide:xv,multi:!0,useValue:n},{provide:oO,useFactory:mU,deps:[[Jo,new Bd,new tf]]},{provide:kE,useValue:s||{}},s?.useHash?{provide:l_,useClass:A4}:{provide:l_,useClass:hR},{provide:e2,useFactory:()=>{const e=Jt(q5),t=Jt(si),r=Jt(kE),n=Jt(IE),s=Jt(Ex);return r.scrollOffset&&e.setOffset(r.scrollOffset),new eO(s,n,e,t,r)}},s?.preloadingStrategy?lU(s.preloadingStrategy).\u0275providers:[],{provide:Lk,multi:!0,useFactory:dU},s?.initialNavigation?gU(s):[],s?.bindToComponentInputs?Bf(8,[RP,{provide:DE,useExisting:RP}]).\u0275providers:[],[{provide:aO,useFactory:nO},{provide:XS,multi:!0,useExisting:aO}]]}}static forChild(n){return{ngModule:t,providers:[{provide:xv,multi:!0,useValue:n}]}}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(oO,8))},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({}),t})();function mU(e){return"guarded"}function gU(e){return["disabled"===e.initialNavigation?Bf(3,[{provide:US,multi:!0,useFactory:()=>{const t=Jt(Jo);return()=>{t.setUpLocationChangeListener()}}},{provide:t2,useValue:2}]).\u0275providers:[],"enabledBlocking"===e.initialNavigation?Bf(2,[{provide:t2,useValue:0},{provide:US,multi:!0,deps:[Xr],useFactory:t=>{const r=t.get(S4,Promise.resolve());return()=>r.then(()=>new Promise(n=>{const s=t.get(Jo),u=t.get(iO);XP(s,()=>{n(!0)}),t.get(IE).afterPreactivation=()=>(n(!0),u.closed?Gn(void 0):u),s.initialNavigation()}))}}]).\u0275providers:[]]}const aO=new Kt(""),bi_baseBEUrl="https://clickgroup-be.latamhosting.com.ar",bi_mapBox_apiKey="pk.eyJ1IjoibWRhbXB1ZXJvIiwiYSI6ImNsaDlwaW1tdDA5cW0zcnRkYWJxNW00NmMifQ.-UjTToqIopVTq7plocSHhQ",bi_mapBox_defaultLng=-70.64827,bi_mapBox_defaultLat=-33.45694,bi_mapBox_defaultZoom=9;class RE{}class PE{}class hh{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?"string"==typeof t?this.lazyInit=()=>{this.headers=new Map,t.split("\n").forEach(r=>{const n=r.indexOf(":");if(n>0){const s=r.slice(0,n),u=s.toLowerCase(),m=r.slice(n+1).trim();this.maybeSetNormalizedName(s,u),this.headers.has(u)?this.headers.get(u).push(m):this.headers.set(u,[m])}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((r,n)=>{this.setHeaderEntries(n,r)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([r,n])=>{this.setHeaderEntries(r,n)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const r=this.headers.get(t.toLowerCase());return r&&r.length>0?r[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,r){return this.clone({name:t,value:r,op:"a"})}set(t,r){return this.clone({name:t,value:r,op:"s"})}delete(t,r){return this.clone({name:t,value:r,op:"d"})}maybeSetNormalizedName(t,r){this.normalizedNames.has(r)||this.normalizedNames.set(r,t)}init(){this.lazyInit&&(this.lazyInit instanceof hh?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(r=>{this.headers.set(r,t.headers.get(r)),this.normalizedNames.set(r,t.normalizedNames.get(r))})}clone(t){const r=new hh;return r.lazyInit=this.lazyInit&&this.lazyInit instanceof hh?this.lazyInit:this,r.lazyUpdate=(this.lazyUpdate||[]).concat([t]),r}applyUpdate(t){const r=t.name.toLowerCase();switch(t.op){case"a":case"s":let n=t.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(t.name,r);const s=("a"===t.op?this.headers.get(r):void 0)||[];s.push(...n),this.headers.set(r,s);break;case"d":const u=t.value;if(u){let m=this.headers.get(r);if(!m)return;m=m.filter(b=>-1===u.indexOf(b)),0===m.length?(this.headers.delete(r),this.normalizedNames.delete(r)):this.headers.set(r,m)}else this.headers.delete(r),this.normalizedNames.delete(r)}}setHeaderEntries(t,r){const n=(Array.isArray(r)?r:[r]).map(u=>u.toString()),s=t.toLowerCase();this.headers.set(s,n),this.maybeSetNormalizedName(t,s)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(r=>t(this.normalizedNames.get(r),this.headers.get(r)))}}class yU{encodeKey(t){return lO(t)}encodeValue(t){return lO(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const bU=/%(\d[a-f0-9])/gi,xU={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function lO(e){return encodeURIComponent(e).replace(bU,(t,r)=>xU[r]??t)}function OE(e){return`${e}`}class um{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new yU,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function vU(e,t){const r=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(s=>{const u=s.indexOf("="),[m,b]=-1==u?[t.decodeKey(s),""]:[t.decodeKey(s.slice(0,u)),t.decodeValue(s.slice(u+1))],T=r.get(m)||[];T.push(b),r.set(m,T)}),r}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(r=>{const n=t.fromObject[r],s=Array.isArray(n)?n.map(OE):[OE(n)];this.map.set(r,s)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const r=this.map.get(t);return r?r[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,r){return this.clone({param:t,value:r,op:"a"})}appendAll(t){const r=[];return Object.keys(t).forEach(n=>{const s=t[n];Array.isArray(s)?s.forEach(u=>{r.push({param:n,value:u,op:"a"})}):r.push({param:n,value:s,op:"a"})}),this.clone(r)}set(t,r){return this.clone({param:t,value:r,op:"s"})}delete(t,r){return this.clone({param:t,value:r,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const r=this.encoder.encodeKey(t);return this.map.get(t).map(n=>r+"="+this.encoder.encodeValue(n)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const r=new um({encoder:this.encoder});return r.cloneFrom=this.cloneFrom||this,r.updates=(this.updates||[]).concat(t),r}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const r=("a"===t.op?this.map.get(t.param):void 0)||[];r.push(OE(t.value)),this.map.set(t.param,r);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let n=this.map.get(t.param)||[];const s=n.indexOf(OE(t.value));-1!==s&&n.splice(s,1),n.length>0?this.map.set(t.param,n):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class wU{constructor(){this.map=new Map}set(t,r){return this.map.set(t,r),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function cO(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function uO(e){return typeof Blob<"u"&&e instanceof Blob}function dO(e){return typeof FormData<"u"&&e instanceof FormData}class Nx{constructor(t,r,n,s){let u;if(this.url=r,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function CU(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||s?(this.body=void 0!==n?n:null,u=s):u=n,u&&(this.reportProgress=!!u.reportProgress,this.withCredentials=!!u.withCredentials,u.responseType&&(this.responseType=u.responseType),u.headers&&(this.headers=u.headers),u.context&&(this.context=u.context),u.params&&(this.params=u.params)),this.headers||(this.headers=new hh),this.context||(this.context=new wU),this.params){const m=this.params.toString();if(0===m.length)this.urlWithParams=r;else{const b=r.indexOf("?");this.urlWithParams=r+(-1===b?"?":b<r.length-1?"&":"")+m}}else this.params=new um,this.urlWithParams=r}serializeBody(){return null===this.body?null:cO(this.body)||uO(this.body)||dO(this.body)||function EU(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof um?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||dO(this.body)?null:uO(this.body)?this.body.type||null:cO(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof um?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const r=t.method||this.method,n=t.url||this.url,s=t.responseType||this.responseType,u=void 0!==t.body?t.body:this.body,m=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,b=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let T=t.headers||this.headers,R=t.params||this.params;const z=t.context??this.context;return void 0!==t.setHeaders&&(T=Object.keys(t.setHeaders).reduce((W,le)=>W.set(le,t.setHeaders[le]),T)),t.setParams&&(R=Object.keys(t.setParams).reduce((W,le)=>W.set(le,t.setParams[le]),R)),new Nx(r,n,u,{params:R,headers:T,context:z,reportProgress:b,responseType:s,withCredentials:m})}}var wv=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}(wv||{});class n2{constructor(t,r=200,n="OK"){this.headers=t.headers||new hh,this.status=void 0!==t.status?t.status:r,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class r2 extends n2{constructor(t={}){super(t),this.type=wv.ResponseHeader}clone(t={}){return new r2({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Cv extends n2{constructor(t={}){super(t),this.type=wv.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new Cv({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class hO extends n2{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function o2(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let od=(()=>{var e;class t{constructor(n){this.handler=n}request(n,s,u={}){let m;if(n instanceof Nx)m=n;else{let R,z;R=u.headers instanceof hh?u.headers:new hh(u.headers),u.params&&(z=u.params instanceof um?u.params:new um({fromObject:u.params})),m=new Nx(n,s,void 0!==u.body?u.body:null,{headers:R,context:u.context,params:z,reportProgress:u.reportProgress,responseType:u.responseType||"json",withCredentials:u.withCredentials})}const b=Gn(m).pipe(u_(R=>this.handler.handle(R)));if(n instanceof Nx||"events"===u.observe)return b;const T=b.pipe(ql(R=>R instanceof Cv));switch(u.observe||"body"){case"body":switch(m.responseType){case"arraybuffer":return T.pipe(ii(R=>{if(null!==R.body&&!(R.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return R.body}));case"blob":return T.pipe(ii(R=>{if(null!==R.body&&!(R.body instanceof Blob))throw new Error("Response is not a Blob.");return R.body}));case"text":return T.pipe(ii(R=>{if(null!==R.body&&"string"!=typeof R.body)throw new Error("Response is not a string.");return R.body}));default:return T.pipe(ii(R=>R.body))}case"response":return T;default:throw new Error(`Unreachable: unhandled observe type ${u.observe}}`)}}delete(n,s={}){return this.request("DELETE",n,s)}get(n,s={}){return this.request("GET",n,s)}head(n,s={}){return this.request("HEAD",n,s)}jsonp(n,s){return this.request("JSONP",n,{params:(new um).append(s,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,s={}){return this.request("OPTIONS",n,s)}patch(n,s,u={}){return this.request("PATCH",n,o2(u,s))}post(n,s,u={}){return this.request("POST",n,o2(u,s))}put(n,s,u={}){return this.request("PUT",n,o2(u,s))}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(RE))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})();function mO(e,t){return t(e)}function TU(e,t){return(r,n)=>t.intercept(r,{handle:s=>e(s,n)})}const MU=new Kt(""),Bx=new Kt(""),gO=new Kt("");function AU(){let e=null;return(t,r)=>{null===e&&(e=(Jt(MU,{optional:!0})??[]).reduceRight(TU,mO));const n=Jt($C),s=n.add();return e(t,r).pipe(xx(()=>n.remove(s)))}}let _O=(()=>{var e;class t extends RE{constructor(n,s){super(),this.backend=n,this.injector=s,this.chain=null,this.pendingTasks=Jt($C)}handle(n){if(null===this.chain){const u=Array.from(new Set([...this.injector.get(Bx),...this.injector.get(gO,[])]));this.chain=u.reduceRight((m,b)=>function SU(e,t,r){return(n,s)=>r.runInContext(()=>t(n,u=>e(u,s)))}(m,b,this.injector),mO)}const s=this.pendingTasks.add();return this.chain(n,u=>this.backend.handle(u)).pipe(xx(()=>this.pendingTasks.remove(s)))}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(PE),ze(ra))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})();const PU=/^\)\]\}',?\n/;let vO=(()=>{var e;class t{constructor(n){this.xhrFactory=n}handle(n){if("JSONP"===n.method)throw new yt(-2800,!1);const s=this.xhrFactory;return(s.\u0275loadImpl?wr(s.\u0275loadImpl()):Gn(null)).pipe(pt(()=>new wn(m=>{const b=s.build();if(b.open(n.method,n.urlWithParams),n.withCredentials&&(b.withCredentials=!0),n.headers.forEach((at,wt)=>b.setRequestHeader(at,wt.join(","))),n.headers.has("Accept")||b.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){const at=n.detectContentTypeHeader();null!==at&&b.setRequestHeader("Content-Type",at)}if(n.responseType){const at=n.responseType.toLowerCase();b.responseType="json"!==at?at:"text"}const T=n.serializeBody();let R=null;const z=()=>{if(null!==R)return R;const at=b.statusText||"OK",wt=new hh(b.getAllResponseHeaders()),ft=function OU(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(b)||n.url;return R=new r2({headers:wt,status:b.status,statusText:at,url:ft}),R},W=()=>{let{headers:at,status:wt,statusText:ft,url:Nn}=z(),Sn=null;204!==wt&&(Sn=typeof b.response>"u"?b.responseText:b.response),0===wt&&(wt=Sn?200:0);let Ri=wt>=200&&wt<300;if("json"===n.responseType&&"string"==typeof Sn){const lo=Sn;Sn=Sn.replace(PU,"");try{Sn=""!==Sn?JSON.parse(Sn):null}catch(Jr){Sn=lo,Ri&&(Ri=!1,Sn={error:Jr,text:Sn})}}Ri?(m.next(new Cv({body:Sn,headers:at,status:wt,statusText:ft,url:Nn||void 0})),m.complete()):m.error(new hO({error:Sn,headers:at,status:wt,statusText:ft,url:Nn||void 0}))},le=at=>{const{url:wt}=z(),ft=new hO({error:at,status:b.status||0,statusText:b.statusText||"Unknown Error",url:wt||void 0});m.error(ft)};let he=!1;const Me=at=>{he||(m.next(z()),he=!0);let wt={type:wv.DownloadProgress,loaded:at.loaded};at.lengthComputable&&(wt.total=at.total),"text"===n.responseType&&b.responseText&&(wt.partialText=b.responseText),m.next(wt)},Ve=at=>{let wt={type:wv.UploadProgress,loaded:at.loaded};at.lengthComputable&&(wt.total=at.total),m.next(wt)};return b.addEventListener("load",W),b.addEventListener("error",le),b.addEventListener("timeout",le),b.addEventListener("abort",le),n.reportProgress&&(b.addEventListener("progress",Me),null!==T&&b.upload&&b.upload.addEventListener("progress",Ve)),b.send(T),m.next({type:wv.Sent}),()=>{b.removeEventListener("error",le),b.removeEventListener("abort",le),b.removeEventListener("load",W),b.removeEventListener("timeout",le),n.reportProgress&&(b.removeEventListener("progress",Me),null!==T&&b.upload&&b.upload.removeEventListener("progress",Ve)),b.readyState!==b.DONE&&b.abort()}})))}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(RR))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})();const s2=new Kt("XSRF_ENABLED"),bO=new Kt("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),xO=new Kt("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class wO{}let NU=(()=>{var e;class t{constructor(n,s,u){this.doc=n,this.platform=s,this.cookieName=u,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=wR(n,this.cookieName),this.lastCookieString=n),this.lastToken}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Gi),ze(Zd),ze(bO))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})();function BU(e,t){const r=e.url.toLowerCase();if(!Jt(s2)||"GET"===e.method||"HEAD"===e.method||r.startsWith("http://")||r.startsWith("https://"))return t(e);const n=Jt(wO).getToken(),s=Jt(xO);return null!=n&&!e.headers.has(s)&&(e=e.clone({headers:e.headers.set(s,n)})),t(e)}var dm=function(e){return e[e.Interceptors=0]="Interceptors",e[e.LegacyInterceptors=1]="LegacyInterceptors",e[e.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",e[e.NoXsrfProtection=3]="NoXsrfProtection",e[e.JsonpSupport=4]="JsonpSupport",e[e.RequestsMadeViaParent=5]="RequestsMadeViaParent",e[e.Fetch=6]="Fetch",e}(dm||{});function p_(e,t){return{\u0275kind:e,\u0275providers:t}}function zU(...e){const t=[od,vO,_O,{provide:RE,useExisting:_O},{provide:PE,useExisting:vO},{provide:Bx,useValue:BU,multi:!0},{provide:s2,useValue:!0},{provide:wO,useClass:NU}];for(const r of e)t.push(...r.\u0275providers);return hy(t)}const CO=new Kt("LEGACY_INTERCEPTOR_FN");let EO=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({providers:[zU(p_(dm.LegacyInterceptors,[{provide:CO,useFactory:AU},{provide:Bx,useExisting:CO,multi:!0}]))]}),t})(),Hs=(()=>{var e;class t{constructor(){this.channels={}}subscribe(n,s){return this.channels[n]||(this.channels[n]=new qe),this.channels[n].subscribe(s)}publish(n,s){const u=this.channels[n];u&&u.next(s)}destroy(n){const s=this.channels[n];s&&(s.complete(),delete this.channels[n])}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),Ec=(()=>{var e;class t{constructor(){this.durationSession=60,this.loadStorage()}login(n){this.user=n,this.saveStorage()}loadStorage(){JSON.parse(localStorage.getItem("mda-software"))&&(this.user=JSON.parse(localStorage.getItem("mda-software")))}saveStorage(){this.user.lastActivity=this.unixtime(),localStorage.setItem("mda-software",JSON.stringify(this.user))}logout(){localStorage.setItem("mda-software",JSON.stringify(null))}isAutenticate(){return!!this.user}createAuthorizationHeader(){return{headers:{"x-token":this.user.token}}}unixtime(){let n=(new Date).getTime()/1e3;return parseInt(n)}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),zx=(()=>{var e;class t{constructor(n,s,u){this.http=n,this.events=s,this.login=u,this.limit=50,this.offset=0,this.sort="createdAt",this.direction="DESC"}calcOffset(n){this.offset=n*this.limit}setOrder(n){this.direction=this.sort==n&&"ASC"==this.direction?"DESC":"ASC",this.sort=n,this.events.publish("order",{})}get(n){return this.http.get(`${bi_baseBEUrl}/api/integrations?search=${n}&offset=${this.offset}&limit=${this.limit}&sort=${this.sort}&direction=${this.direction}`,this.login.createAuthorizationHeader())}stats(){return this.http.get(`${bi_baseBEUrl}/api/integrations/stats/get`,this.login.createAuthorizationHeader())}getOne(n){return this.http.get(`${bi_baseBEUrl}/api/integrations/${n}`,this.login.createAuthorizationHeader())}getTransactions(n){return this.http.get(`${bi_baseBEUrl}/api/integrations/${n}/transactions/`,this.login.createAuthorizationHeader())}getAll(){return this.http.get(`${bi_baseBEUrl}/api/integrations?search%5Bvalue%5D=&start=0&length=-1&sort=name&direction=ASC`,this.login.createAuthorizationHeader())}save(n){return""!==n.id?this.http.put(`${bi_baseBEUrl}/api/integrations/${n.id}`,n,this.login.createAuthorizationHeader()):this.http.post(`${bi_baseBEUrl}/api/integrations`,n,this.login.createAuthorizationHeader())}delete(n){return this.http.delete(`${bi_baseBEUrl}/api/integrations/${n.id}`,this.login.createAuthorizationHeader())}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(od),ze(Hs),ze(Ec))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),Vx=(()=>{var e;class t{constructor(n,s,u){this.http=n,this.events=s,this.loginService=u,this.limit=30,this.offset=0,this.sort="createdAt",this.direction="DESC"}calcOffset(n){this.offset=n*this.limit}setOrder(n){this.direction=this.sort==n&&"ASC"==this.direction?"DESC":"ASC",this.sort=n,this.events.publish("order",{})}get(n){return this.http.get(`${bi_baseBEUrl}/api/users?search=${n}&start=${this.offset}&length=${this.limit}&sort=${this.sort}&direction=${this.direction}`,this.loginService.createAuthorizationHeader())}stats(){return this.http.get(`${bi_baseBEUrl}/api/users/stats/get`,this.loginService.createAuthorizationHeader())}getOne(n){return this.http.get(`${bi_baseBEUrl}/api/users/${n}`,this.loginService.createAuthorizationHeader())}getAll(){return this.http.get(`${bi_baseBEUrl}/api/users?search%5Bvalue%5D=&start=0&length=-1&sort=name&direction=ASC`,this.loginService.createAuthorizationHeader())}save(n){return""!==n.id?this.http.put(`${bi_baseBEUrl}/api/users/${n.id}`,n,this.loginService.createAuthorizationHeader()):this.http.post(`${bi_baseBEUrl}/api/users`,n,this.loginService.createAuthorizationHeader())}login(n){return this.http.post(`${bi_baseBEUrl}/api/auth/login`,n)}delete(n){return this.http.delete(`${bi_baseBEUrl}/api/users/${n.id}`,this.loginService.createAuthorizationHeader())}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(od),ze(Hs),ze(Ec))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),DO=(()=>{var e;class t{constructor(n,s,u){this.http=n,this.events=s,this.login=u,this.limit=4,this.offset=0,this.sort="createdAt",this.direction="DESC"}calcOffset(n){this.offset=n*this.limit}setOrder(n){this.direction=this.sort==n&&"ASC"==this.direction?"DESC":"ASC",this.sort=n,this.events.publish("order",{})}get(n){return this.http.get(`${bi_baseBEUrl}/api/transactions?search=${n}&offset=${this.offset}&limit=${this.limit}&sort=${this.sort}&direction=${this.direction}`,this.login.createAuthorizationHeader())}stats(){return this.http.get(`${bi_baseBEUrl}/api/transactions/stats/get`,this.login.createAuthorizationHeader())}getOne(n){return this.http.get(`${bi_baseBEUrl}/api/transactions/${n}`,this.login.createAuthorizationHeader())}getAll(){return this.http.get(`${bi_baseBEUrl}/api/transactions?search%5Bvalue%5D=&start=0&length=-1&sort=name&direction=ASC`,this.login.createAuthorizationHeader())}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(od),ze(Hs),ze(Ec))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();function qU(e,t){1&e&&(jr(0),it(1,"i",21),Ur())}function WU(e,t){if(1&e&&(jr(0),Te(1),Ur()),2&e){const r=Dn();we(1),hn(r.integrationStats.total)}}function ZU(e,t){1&e&&(jr(0),it(1,"i",21),Ur())}function YU(e,t){if(1&e&&(jr(0),Te(1),Ur()),2&e){const r=Dn();we(1),hn(r.userStats.total)}}function XU(e,t){1&e&&(jr(0),it(1,"i",21),Ur())}function KU(e,t){if(1&e&&(jr(0),Te(1),Ur()),2&e){const r=Dn();we(1),hn(r.transactionStats.total)}}let TO=(()=>{var e;class t{constructor(n,s,u){this.integration=n,this.user=s,this.transaction=u}ngOnInit(){this.integration.stats().subscribe(n=>this.integrationStats=n),this.user.stats().subscribe(n=>this.userStats=n),this.transaction.stats().subscribe(n=>this.transactionStats=n)}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(zx),xe(Vx),xe(DO))},e.\u0275cmp=Ci({type:e,selectors:[["app-home"]],decls:48,vars:6,consts:[[1,"container-fluid"],[1,"row","page-titles"],[1,"col-md-5","align-self-center"],[1,"text-themecolor"],[1,"row"],[1,"col-lg-4"],[1,"card"],[1,"card-body"],[1,"d-flex"],[1,"m-r-20","align-self-center"],[1,"fa-stack","fa-lg","text-primary",2,"width","3em","height","3em","line-height","3em"],[1,"fa","fa-circle","fa-stack-2x",2,"font-size","3em"],[1,"fa","fa-link","fa-stack-1x","fa-inverse",2,"font-size","1.5em"],[1,"align-self-center"],[1,"text-muted","m-t-10","m-b-0"],[1,"m-t-0"],[4,"ngIf"],[1,"fa-stack","fa-lg","text-warning",2,"width","3em","height","3em","line-height","3em"],[1,"fa","fa-users","fa-stack-1x","fa-inverse",2,"font-size","1.5em"],[1,"fa-stack","fa-lg","text-success",2,"width","3em","height","3em","line-height","3em"],[1,"fa","fa-usd","fa-stack-1x","fa-inverse",2,"font-size","2em"],[1,"fa","fa-refresh","fa-spin","fa-1x","fa-fw"]],template:function(n,s){1&n&&(ce(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),Te(4,"Inicio"),ue()()(),ce(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"span",10),it(12,"i",11)(13,"i",12),ue()(),ce(14,"div",13)(15,"h5",14),Te(16,"Total de Integraciones"),ue(),ce(17,"h2",15),Ln(18,qU,2,0,"ng-container",16),Ln(19,WU,2,1,"ng-container",16),ue()()()()()(),ce(20,"div",5)(21,"div",6)(22,"div",7)(23,"div",8)(24,"div",9)(25,"span",17),it(26,"i",11)(27,"i",18),ue()(),ce(28,"div",13)(29,"h5",14),Te(30,"Total de Usuarios"),ue(),ce(31,"h2",15),Ln(32,ZU,2,0,"ng-container",16),Ln(33,YU,2,1,"ng-container",16),ue()()()()()(),ce(34,"div",5)(35,"div",6)(36,"div",7)(37,"div",8)(38,"div",9)(39,"span",19),it(40,"i",11)(41,"i",20),ue()(),ce(42,"div",13)(43,"h5",14),Te(44,"Total de Transacciones"),ue(),ce(45,"h2",15),Ln(46,XU,2,0,"ng-container",16),Ln(47,KU,2,1,"ng-container",16),ue()()()()()()()()),2&n&&(we(18),Be("ngIf",!s.integrationStats),we(1),Be("ngIf",s.integrationStats),we(13),Be("ngIf",!s.userStats),we(1),Be("ngIf",s.userStats),we(13),Be("ngIf",!s.transactionStats),we(1),Be("ngIf",s.transactionStats))},dependencies:[Na],encapsulation:2}),t})();var QU=Je(519),jx=Je.n(QU);class SO{}class JU{}const zf="*";function m_(e,t){return{type:7,name:e,definitions:t,options:{}}}function Dc(e,t=null){return{type:4,styles:t,timings:e}}function MO(e,t=null){return{type:2,steps:e,options:t}}function es(e){return{type:6,styles:e,offset:null}}function sd(e,t,r){return{type:0,name:e,styles:t,options:r}}function AO(e){return{type:5,steps:e}}function Tc(e,t,r=null){return{type:1,expr:e,animation:t,options:r}}class Ux{constructor(t=0,r=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+r}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const r="start"==t?this._onStartFns:this._onDoneFns;r.forEach(n=>n()),r.length=0}}class IO{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let r=0,n=0,s=0;const u=this.players.length;0==u?queueMicrotask(()=>this._onFinish()):this.players.forEach(m=>{m.onDone(()=>{++r==u&&this._onFinish()}),m.onDestroy(()=>{++n==u&&this._onDestroy()}),m.onStart(()=>{++s==u&&this._onStart()})}),this.totalTime=this.players.reduce((m,b)=>Math.max(m,b.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const r=t*this.totalTime;this.players.forEach(n=>{const s=n.totalTime?Math.min(1,r/n.totalTime):1;n.setPosition(s)})}getPosition(){const t=this.players.reduce((r,n)=>null===r||n.totalTime>r.totalTime?n:r,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const r="start"==t?this._onStartFns:this._onDoneFns;r.forEach(n=>n()),r.length=0}}const e8=["overlay"];function t8(e,t){1&e&&it(0,"div")}function n8(e,t){if(1&e&&(ce(0,"div"),Ln(1,t8,1,0,"div",6),ue()),2&e){const r=Dn(2);pe(r.spinner.class),te("color",r.spinner.color),we(1),Be("ngForOf",r.spinner.divArray)}}function i8(e,t){1&e&&(it(0,"div",7),go(1,"safeHtml")),2&e&&Be("innerHTML",ms(1,1,Dn(2).template),Bl)}function r8(e,t){if(1&e&&(ce(0,"div",1,2),Ln(2,n8,2,5,"div",3),Ln(3,i8,2,3,"div",4),ce(4,"div",5),Ku(5),ue()()),2&e){const r=Dn();te("background-color",r.spinner.bdColor)("z-index",r.spinner.zIndex)("position",r.spinner.fullScreen?"fixed":"absolute"),Be("@.disabled",r.disableAnimation)("@fadeIn","in"),we(2),Be("ngIf",!r.template),we(1),Be("ngIf",r.template),we(1),te("z-index",r.spinner.zIndex)}}const o8=["*"],s8={"ball-8bits":16,"ball-atom":4,"ball-beat":3,"ball-circus":5,"ball-climbing-dot":4,"ball-clip-rotate":1,"ball-clip-rotate-multiple":2,"ball-clip-rotate-pulse":2,"ball-elastic-dots":5,"ball-fall":3,"ball-fussion":4,"ball-grid-beat":9,"ball-grid-pulse":9,"ball-newton-cradle":4,"ball-pulse":3,"ball-pulse-rise":5,"ball-pulse-sync":3,"ball-rotate":1,"ball-running-dots":5,"ball-scale":1,"ball-scale-multiple":3,"ball-scale-pulse":2,"ball-scale-ripple":1,"ball-scale-ripple-multiple":3,"ball-spin":8,"ball-spin-clockwise":8,"ball-spin-clockwise-fade":8,"ball-spin-clockwise-fade-rotating":8,"ball-spin-fade":8,"ball-spin-fade-rotating":8,"ball-spin-rotate":2,"ball-square-clockwise-spin":8,"ball-square-spin":8,"ball-triangle-path":3,"ball-zig-zag":2,"ball-zig-zag-deflect":2,cog:1,"cube-transition":2,fire:3,"line-scale":5,"line-scale-party":5,"line-scale-pulse-out":5,"line-scale-pulse-out-rapid":5,"line-spin-clockwise-fade":8,"line-spin-clockwise-fade-rotating":8,"line-spin-fade":8,"line-spin-fade-rotating":8,pacman:6,"square-jelly-box":2,"square-loader":1,"square-spin":1,timer:1,"triangle-skew-spin":1},c2="primary";class g_{constructor(t){Object.assign(this,t)}static create(t){return!t?.template&&!t?.type&&console.warn('[ngx-spinner]: Property "type" is missed. Please, provide animation type to <ngx-spinner> component\n        and ensure css is added to angular.json file'),new g_(t)}}let fl=(()=>{var e;class t{constructor(){this.spinnerObservable=new ui(null)}getSpinner(n){return this.spinnerObservable.asObservable().pipe(ql(s=>s&&s.name===n))}show(n=c2,s){return new Promise((u,m)=>{setTimeout(()=>{s&&Object.keys(s).length?(s.name=n,this.spinnerObservable.next(new g_({...s,show:!0})),u(!0)):(this.spinnerObservable.next(new g_({name:n,show:!0})),u(!0))},10)})}hide(n=c2,s=10){return new Promise((u,m)=>{setTimeout(()=>{this.spinnerObservable.next(new g_({name:n,show:!1})),u(!0)},s)})}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();const kO=new Kt("NGX_SPINNER_CONFIG");let u2,a8=(()=>{var e;class t{constructor(n){this._sanitizer=n}transform(n){if(n)return this._sanitizer.bypassSecurityTrustHtml(n)}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(kM,16))},e.\u0275pipe=vo({name:"safeHtml",type:e,pure:!0}),t})(),l8=(()=>{var e;class t{constructor(n,s,u,m){this.spinnerService=n,this.changeDetector=s,this.elementRef=u,this.globalConfig=m,this.disableAnimation=!1,this.spinner=new g_,this.ngUnsubscribe=new qe,this.setDefaultOptions=()=>{const{type:b}=this.globalConfig??{};this.spinner=g_.create({name:this.name,bdColor:this.bdColor,size:this.size,color:this.color,type:this.type??b,fullScreen:this.fullScreen,divArray:this.divArray,divCount:this.divCount,show:this.show,zIndex:this.zIndex,template:this.template,showSpinner:this.showSpinner})},this.bdColor="rgba(51,51,51,0.8)",this.zIndex=99999,this.color="#fff",this.size="large",this.fullScreen=!0,this.name=c2,this.template=null,this.showSpinner=!1,this.divArray=[],this.divCount=0,this.show=!1}initObservable(){this.spinnerService.getSpinner(this.name).pipe(Wl(this.ngUnsubscribe)).subscribe(n=>{this.setDefaultOptions(),Object.assign(this.spinner,n),n.show&&this.onInputChange(),this.changeDetector.detectChanges()})}ngOnInit(){this.setDefaultOptions(),this.initObservable()}isSpinnerZone(n){return n===this.elementRef.nativeElement.parentElement||n.parentNode&&this.isSpinnerZone(n.parentNode)}ngOnChanges(n){for(const s in n)if(s){const u=n[s];if(u.isFirstChange())return;typeof u.currentValue<"u"&&u.currentValue!==u.previousValue&&""!==u.currentValue&&(this.spinner[s]=u.currentValue,"showSpinner"===s&&(u.currentValue?this.spinnerService.show(this.spinner.name,this.spinner):this.spinnerService.hide(this.spinner.name)),"name"===s&&this.initObservable())}}getClass(n,s){this.spinner.divCount=s8[n],this.spinner.divArray=Array(this.spinner.divCount).fill(0).map((m,b)=>b);let u="";switch(s.toLowerCase()){case"small":u="la-sm";break;case"medium":u="la-2x";break;case"large":u="la-3x"}return"la-"+n+" "+u}onInputChange(){this.spinner.class=this.getClass(this.spinner.type,this.spinner.size)}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(fl),xe(La),xe(tr),xe(kO,8))},e.\u0275cmp=Ci({type:e,selectors:[["ngx-spinner"]],viewQuery:function(n,s){if(1&n&&ul(e8,5),2&n){let u;Oa(u=Fa())&&(s.spinnerDOM=u.first)}},inputs:{bdColor:"bdColor",size:"size",color:"color",type:"type",fullScreen:"fullScreen",name:"name",zIndex:"zIndex",template:"template",showSpinner:"showSpinner",disableAnimation:"disableAnimation"},features:[v],ngContentSelectors:o8,decls:1,vars:1,consts:[["class","ngx-spinner-overlay",3,"background-color","z-index","position",4,"ngIf"],[1,"ngx-spinner-overlay"],["overlay",""],[3,"class","color",4,"ngIf"],[3,"innerHTML",4,"ngIf"],[1,"loading-text"],[4,"ngFor","ngForOf"],[3,"innerHTML"]],template:function(n,s){1&n&&(If(),Ln(0,r8,6,12,"div",0)),2&n&&Be("ngIf",s.spinner.show)},dependencies:[Gl,Na,a8],styles:[".ngx-spinner-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%}.ngx-spinner-overlay[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(.loading-text){top:50%;left:50%;margin:0;position:absolute;transform:translate(-50%,-50%)}.loading-text[_ngcontent-%COMP%]{position:absolute;top:60%;left:50%;transform:translate(-50%,-60%)}"],data:{animation:[m_("fadeIn",[sd("in",es({opacity:1})),Tc(":enter",[es({opacity:0}),Dc(300)]),Tc(":leave",Dc(200,es({opacity:0})))])]},changeDetection:0}),t})(),c8=(()=>{var e;class t{static forRoot(n){return{ngModule:t,providers:[{provide:kO,useValue:n}]}}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({imports:[hv]}),t})(),RO=(()=>{var e;class t{constructor(n,s,u){this.http=n,this.events=s,this.login=u,this.limit=4,this.offset=0,this.sort="createdAt",this.direction="DESC"}calcOffset(n){this.offset=n*this.limit}setOrder(n){this.direction=this.sort==n&&"ASC"==this.direction?"DESC":"ASC",this.sort=n,this.events.publish("order",{})}get(n){return this.http.get(`${bi_baseBEUrl}/api/demos?search=${n}&offset=${this.offset}&limit=${this.limit}&sort=${this.sort}&direction=${this.direction}`,this.login.createAuthorizationHeader())}stats(){return this.http.get(`${bi_baseBEUrl}/api/demos/stats/get`,this.login.createAuthorizationHeader())}getOne(n){return this.http.get(`${bi_baseBEUrl}/api/demos/${n}`,this.login.createAuthorizationHeader())}getAll(){return this.http.get(`${bi_baseBEUrl}/api/demos?search%5Bvalue%5D=&start=0&length=-1&sort=name&direction=ASC`,this.login.createAuthorizationHeader())}save(n){return""!==n.id?this.http.put(`${bi_baseBEUrl}/api/demos/${n.id}`,n,this.login.createAuthorizationHeader()):this.http.post(`${bi_baseBEUrl}/api/demos`,n,this.login.createAuthorizationHeader())}delete(n){return this.http.delete(`${bi_baseBEUrl}/api/demos/${n.id}`,this.login.createAuthorizationHeader())}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(od),ze(Hs),ze(Ec))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();try{u2=typeof Intl<"u"&&Intl.v8BreakIterator}catch{u2=!1}let Hx,__,d2,Ms=(()=>{var e;class t{constructor(n){this._platformId=n,this.isBrowser=this._platformId?function G5(e){return e===IR}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!u2)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Zd))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();function hm(e){return function u8(){if(null==Hx&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Hx=!0}))}finally{Hx=Hx||!1}return Hx}()?e:!!e.capture}function d8(){if(null==__){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return __=!1,__;if("scrollBehavior"in document.documentElement.style)__=!0;else{const e=Element.prototype.scrollTo;__=!!e&&!/\{\s*\[native code\]\s*\}/.test(e.toString())}}return __}function OO(){let e=typeof document<"u"&&document?document.activeElement:null;for(;e&&e.shadowRoot;){const t=e.shadowRoot.activeElement;if(t===e)break;e=t}return e}function fm(e){return e.composedPath?e.composedPath()[0]:e.target}function h2(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function y_(e,...t){return t.length?t.some(r=>e[r]):e.altKey||e.shiftKey||e.ctrlKey||e.metaKey}function FO(e){return ql((t,r)=>e<=r)}function aa(e){return null!=e&&"false"!=`${e}`}function g2(e,t=0){return function v8(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}(e)?Number(e):t}function jE(e){return Array.isArray(e)?e:[e]}function _s(e){return null==e?"":"string"==typeof e?e:`${e}px`}function Sv(e){return e instanceof tr?e.nativeElement:e}let x8=(()=>{var e;class t{create(n){return typeof MutationObserver>"u"?null:new MutationObserver(n)}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),w8=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({providers:[x8]}),t})();class C8 extends me{constructor(t,r){super()}schedule(t,r=0){return this}}const UE={setInterval(e,t,...r){const{delegate:n}=UE;return n?.setInterval?n.setInterval(e,t,...r):setInterval(e,t,...r)},clearInterval(e){const{delegate:t}=UE;return(t?.clearInterval||clearInterval)(e)},delegate:void 0};class _2 extends C8{constructor(t,r){super(t,r),this.scheduler=t,this.work=r,this.pending=!1}schedule(t,r=0){var n;if(this.closed)return this;this.state=t;const s=this.id,u=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(u,s,r)),this.pending=!0,this.delay=r,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(u,this.id,r),this}requestAsyncId(t,r,n=0){return UE.setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,r,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return r;null!=r&&UE.clearInterval(r)}execute(t,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,r);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,r){let s,n=!1;try{this.work(t)}catch(u){n=!0,s=u||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:t,scheduler:r}=this,{actions:n}=r;this.work=this.state=this.scheduler=null,this.pending=!1,h(n,this),null!=t&&(this.id=this.recycleAsyncId(r,t,null)),this.delay=null,super.unsubscribe()}}}const y2={now:()=>(y2.delegate||Date).now(),delegate:void 0};class qx{constructor(t,r=qx.now){this.schedulerActionCtor=t,this.now=r}schedule(t,r=0,n){return new this.schedulerActionCtor(this,t).schedule(n,r)}}qx.now=y2.now;class v2 extends qx{constructor(t,r=qx.now){super(t,r),this.actions=[],this._active=!1}flush(t){const{actions:r}=this;if(this._active)return void r.push(t);let n;this._active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=r.shift());if(this._active=!1,n){for(;t=r.shift();)t.unsubscribe();throw n}}}const b2=new v2(_2),E8=b2,LO=new Set;let v_,T8=(()=>{var e;class t{constructor(n,s){this._platform=n,this._nonce=s,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):M8}matchMedia(n){return(this._platform.WEBKIT||this._platform.BLINK)&&function S8(e,t){if(!LO.has(e))try{v_||(v_=document.createElement("style"),t&&(v_.nonce=t),v_.setAttribute("type","text/css"),document.head.appendChild(v_)),v_.sheet&&(v_.sheet.insertRule(`@media ${e} {body{ }}`,0),LO.add(e))}catch(r){console.error(r)}}(n,this._nonce),this._matchMedia(n)}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Ms),ze(Ub,8))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();function M8(e){return{matches:"all"===e||""===e,media:e,addListener:()=>{},removeListener:()=>{}}}let x2=(()=>{var e;class t{constructor(n,s){this._mediaMatcher=n,this._zone=s,this._queries=new Map,this._destroySubject=new qe}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(n){return NO(jE(n)).some(u=>this._registerQuery(u).mql.matches)}observe(n){let m=fE(NO(jE(n)).map(b=>this._registerQuery(b).observable));return m=fv(m.pipe(Us(1)),m.pipe(FO(1),function D8(e,t=b2){return ur((r,n)=>{let s=null,u=null,m=null;const b=()=>{if(s){s.unsubscribe(),s=null;const R=u;u=null,n.next(R)}};function T(){const R=m+e,z=t.now();if(z<R)return s=this.schedule(void 0,R-z),void n.add(s);b()}r.subscribe(ai(n,R=>{u=R,m=t.now(),s||(s=t.schedule(T,e),n.add(s))},()=>{b(),n.complete()},void 0,()=>{u=s=null}))})}(0))),m.pipe(ii(b=>{const T={matches:!1,breakpoints:{}};return b.forEach(({matches:R,query:z})=>{T.matches=T.matches||R,T.breakpoints[z]=R}),T}))}_registerQuery(n){if(this._queries.has(n))return this._queries.get(n);const s=this._mediaMatcher.matchMedia(n),m={observable:new wn(b=>{const T=R=>this._zone.run(()=>b.next(R));return s.addListener(T),()=>{s.removeListener(T)}}).pipe(bx(s),ii(({matches:b})=>({query:n,matches:b})),Wl(this._destroySubject)),mql:s};return this._queries.set(n,m),m}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(T8),ze(si))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();function NO(e){return e.map(t=>t.split(",")).reduce((t,r)=>t.concat(r)).map(t=>t.trim())}function HE(e,t){return(e.getAttribute(t)||"").match(/\S+/g)||[]}const zO="cdk-describedby-message",$E="cdk-describedby-host";let w2=0,R8=(()=>{var e;class t{constructor(n,s){this._platform=s,this._messageRegistry=new Map,this._messagesContainer=null,this._id=""+w2++,this._document=n,this._id=Jt(Ag)+"-"+w2++}describe(n,s,u){if(!this._canBeDescribed(n,s))return;const m=C2(s,u);"string"!=typeof s?(VO(s,this._id),this._messageRegistry.set(m,{messageElement:s,referenceCount:0})):this._messageRegistry.has(m)||this._createMessageElement(s,u),this._isElementDescribedByMessage(n,m)||this._addMessageReference(n,m)}removeDescription(n,s,u){if(!s||!this._isElementNode(n))return;const m=C2(s,u);if(this._isElementDescribedByMessage(n,m)&&this._removeMessageReference(n,m),"string"==typeof s){const b=this._messageRegistry.get(m);b&&0===b.referenceCount&&this._deleteMessageElement(m)}0===this._messagesContainer?.childNodes.length&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){const n=this._document.querySelectorAll(`[${$E}="${this._id}"]`);for(let s=0;s<n.length;s++)this._removeCdkDescribedByReferenceIds(n[s]),n[s].removeAttribute($E);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(n,s){const u=this._document.createElement("div");VO(u,this._id),u.textContent=n,s&&u.setAttribute("role",s),this._createMessagesContainer(),this._messagesContainer.appendChild(u),this._messageRegistry.set(C2(n,s),{messageElement:u,referenceCount:0})}_deleteMessageElement(n){this._messageRegistry.get(n)?.messageElement?.remove(),this._messageRegistry.delete(n)}_createMessagesContainer(){if(this._messagesContainer)return;const n="cdk-describedby-message-container",s=this._document.querySelectorAll(`.${n}[platform="server"]`);for(let m=0;m<s.length;m++)s[m].remove();const u=this._document.createElement("div");u.style.visibility="hidden",u.classList.add(n),u.classList.add("cdk-visually-hidden"),this._platform&&!this._platform.isBrowser&&u.setAttribute("platform","server"),this._document.body.appendChild(u),this._messagesContainer=u}_removeCdkDescribedByReferenceIds(n){const s=HE(n,"aria-describedby").filter(u=>0!=u.indexOf(zO));n.setAttribute("aria-describedby",s.join(" "))}_addMessageReference(n,s){const u=this._messageRegistry.get(s);(function I8(e,t,r){const n=HE(e,t);n.some(s=>s.trim()==r.trim())||(n.push(r.trim()),e.setAttribute(t,n.join(" ")))})(n,"aria-describedby",u.messageElement.id),n.setAttribute($E,this._id),u.referenceCount++}_removeMessageReference(n,s){const u=this._messageRegistry.get(s);u.referenceCount--,function k8(e,t,r){const s=HE(e,t).filter(u=>u!=r.trim());s.length?e.setAttribute(t,s.join(" ")):e.removeAttribute(t)}(n,"aria-describedby",u.messageElement.id),n.removeAttribute($E)}_isElementDescribedByMessage(n,s){const u=HE(n,"aria-describedby"),m=this._messageRegistry.get(s),b=m&&m.messageElement.id;return!!b&&-1!=u.indexOf(b)}_canBeDescribed(n,s){if(!this._isElementNode(n))return!1;if(s&&"object"==typeof s)return!0;const u=null==s?"":`${s}`.trim(),m=n.getAttribute("aria-label");return!(!u||m&&m.trim()===u)}_isElementNode(n){return n.nodeType===this._document.ELEMENT_NODE}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Gi),ze(Ms))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();function C2(e,t){return"string"==typeof e?`${t||""}/${e}`:e}function VO(e,t){e.id||(e.id=`${zO}-${t}-${w2++}`)}let P8=(()=>{var e;class t{constructor(n){this._platform=n}isDisabled(n){return n.hasAttribute("disabled")}isVisible(n){return function F8(e){return!!(e.offsetWidth||e.offsetHeight||"function"==typeof e.getClientRects&&e.getClientRects().length)}(n)&&"visible"===getComputedStyle(n).visibility}isTabbable(n){if(!this._platform.isBrowser)return!1;const s=function O8(e){try{return e.frameElement}catch{return null}}(function H8(e){return e.ownerDocument&&e.ownerDocument.defaultView||window}(n));if(s&&(-1===UO(s)||!this.isVisible(s)))return!1;let u=n.nodeName.toLowerCase(),m=UO(n);return n.hasAttribute("contenteditable")?-1!==m:!("iframe"===u||"object"===u||this._platform.WEBKIT&&this._platform.IOS&&!function j8(e){let t=e.nodeName.toLowerCase(),r="input"===t&&e.type;return"text"===r||"password"===r||"select"===t||"textarea"===t}(n))&&("audio"===u?!!n.hasAttribute("controls")&&-1!==m:"video"===u?-1!==m&&(null!==m||this._platform.FIREFOX||n.hasAttribute("controls")):n.tabIndex>=0)}isFocusable(n,s){return function U8(e){return!function N8(e){return function z8(e){return"input"==e.nodeName.toLowerCase()}(e)&&"hidden"==e.type}(e)&&(function L8(e){let t=e.nodeName.toLowerCase();return"input"===t||"select"===t||"button"===t||"textarea"===t}(e)||function B8(e){return function V8(e){return"a"==e.nodeName.toLowerCase()}(e)&&e.hasAttribute("href")}(e)||e.hasAttribute("contenteditable")||jO(e))}(n)&&!this.isDisabled(n)&&(s?.ignoreVisibility||this.isVisible(n))}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Ms))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();function jO(e){if(!e.hasAttribute("tabindex")||void 0===e.tabIndex)return!1;let t=e.getAttribute("tabindex");return!(!t||isNaN(parseInt(t,10)))}function UO(e){if(!jO(e))return null;const t=parseInt(e.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}class $8{get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}constructor(t,r,n,s,u=!1){this._element=t,this._checker=r,this._ngZone=n,this._document=s,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,u||this.attachAnchors()}destroy(){const t=this._startAnchor,r=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.remove()),r&&(r.removeEventListener("focus",this.endAnchorListener),r.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(t){return new Promise(r=>{this._executeOnStable(()=>r(this.focusInitialElement(t)))})}focusFirstTabbableElementWhenReady(t){return new Promise(r=>{this._executeOnStable(()=>r(this.focusFirstTabbableElement(t)))})}focusLastTabbableElementWhenReady(t){return new Promise(r=>{this._executeOnStable(()=>r(this.focusLastTabbableElement(t)))})}_getRegionBoundary(t){const r=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);return"start"==t?r.length?r[0]:this._getFirstTabbableElement(this._element):r.length?r[r.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(t){const r=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(r){if(!this._checker.isFocusable(r)){const n=this._getFirstTabbableElement(r);return n?.focus(t),!!n}return r.focus(t),!0}return this.focusFirstTabbableElement(t)}focusFirstTabbableElement(t){const r=this._getRegionBoundary("start");return r&&r.focus(t),!!r}focusLastTabbableElement(t){const r=this._getRegionBoundary("end");return r&&r.focus(t),!!r}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const r=t.children;for(let n=0;n<r.length;n++){const s=r[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(r[n]):null;if(s)return s}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const r=t.children;for(let n=r.length-1;n>=0;n--){const s=r[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(r[n]):null;if(s)return s}return null}_createAnchor(){const t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,r){t?r.setAttribute("tabindex","0"):r.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._ngZone.isStable?t():this._ngZone.onStable.pipe(Us(1)).subscribe(t)}}let G8=(()=>{var e;class t{constructor(n,s,u){this._checker=n,this._ngZone=s,this._document=u}create(n,s=!1){return new $8(n,this._checker,this._ngZone,this._document,s)}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(P8),ze(si),ze(Gi))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),q8=(()=>{var e;class t{get enabled(){return this.focusTrap.enabled}set enabled(n){this.focusTrap.enabled=aa(n)}get autoCapture(){return this._autoCapture}set autoCapture(n){this._autoCapture=aa(n)}constructor(n,s,u){this._elementRef=n,this._focusTrapFactory=s,this._previouslyFocusedElement=null,this.focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement,!0)}ngOnDestroy(){this.focusTrap.destroy(),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null)}ngAfterContentInit(){this.focusTrap.attachAnchors(),this.autoCapture&&this._captureFocus()}ngDoCheck(){this.focusTrap.hasAttached()||this.focusTrap.attachAnchors()}ngOnChanges(n){const s=n.autoCapture;s&&!s.firstChange&&this.autoCapture&&this.focusTrap.hasAttached()&&this._captureFocus()}_captureFocus(){this._previouslyFocusedElement=OO(),this.focusTrap.focusInitialElementWhenReady()}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(tr),xe(G8),xe(Gi))},e.\u0275dir=Bn({type:e,selectors:[["","cdkTrapFocus",""]],inputs:{enabled:["cdkTrapFocus","enabled"],autoCapture:["cdkTrapFocusAutoCapture","autoCapture"]},exportAs:["cdkTrapFocus"],features:[v]}),t})();function HO(e){return 0===e.buttons||0===e.detail}function $O(e){const t=e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0];return!(!t||-1!==t.identifier||null!=t.radiusX&&1!==t.radiusX||null!=t.radiusY&&1!==t.radiusY)}const W8=new Kt("cdk-input-modality-detector-options"),Z8={ignoreKeys:[18,17,224,91,16]},Mv=hm({passive:!0,capture:!0});let Y8=(()=>{var e;class t{get mostRecentModality(){return this._modality.value}constructor(n,s,u,m){this._platform=n,this._mostRecentTarget=null,this._modality=new ui(null),this._lastTouchMs=0,this._onKeydown=b=>{this._options?.ignoreKeys?.some(T=>T===b.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=fm(b))},this._onMousedown=b=>{Date.now()-this._lastTouchMs<650||(this._modality.next(HO(b)?"keyboard":"mouse"),this._mostRecentTarget=fm(b))},this._onTouchstart=b=>{$O(b)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=fm(b))},this._options={...Z8,...m},this.modalityDetected=this._modality.pipe(FO(1)),this.modalityChanged=this.modalityDetected.pipe(hi()),n.isBrowser&&s.runOutsideAngular(()=>{u.addEventListener("keydown",this._onKeydown,Mv),u.addEventListener("mousedown",this._onMousedown,Mv),u.addEventListener("touchstart",this._onTouchstart,Mv)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Mv),document.removeEventListener("mousedown",this._onMousedown,Mv),document.removeEventListener("touchstart",this._onTouchstart,Mv))}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Ms),ze(si),ze(Gi),ze(W8,8))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();const X8=new Kt("liveAnnouncerElement",{providedIn:"root",factory:function K8(){return null}}),Q8=new Kt("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let J8=0,qO=(()=>{var e;class t{constructor(n,s,u,m){this._ngZone=s,this._defaultOptions=m,this._document=u,this._liveElement=n||this._createLiveElement()}announce(n,...s){const u=this._defaultOptions;let m,b;return 1===s.length&&"number"==typeof s[0]?b=s[0]:[m,b]=s,this.clear(),clearTimeout(this._previousTimeout),m||(m=u&&u.politeness?u.politeness:"polite"),null==b&&u&&(b=u.duration),this._liveElement.setAttribute("aria-live",m),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(T=>this._currentResolve=T)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=n,"number"==typeof b&&(this._previousTimeout=setTimeout(()=>this.clear(),b)),this._currentResolve(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const n="cdk-live-announcer-element",s=this._document.getElementsByClassName(n),u=this._document.createElement("div");for(let m=0;m<s.length;m++)s[m].remove();return u.classList.add(n),u.classList.add("cdk-visually-hidden"),u.setAttribute("aria-atomic","true"),u.setAttribute("aria-live","polite"),u.id="cdk-live-announcer-"+J8++,this._document.body.appendChild(u),u}_exposeAnnouncerToModals(n){const s=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let u=0;u<s.length;u++){const m=s[u],b=m.getAttribute("aria-owns");b?-1===b.indexOf(n)&&m.setAttribute("aria-owns",b+" "+n):m.setAttribute("aria-owns",n)}}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(X8,8),ze(si),ze(Gi),ze(Q8,8))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();const eH=new Kt("cdk-focus-monitor-default-options"),GE=hm({passive:!0,capture:!0});let E2=(()=>{var e;class t{constructor(n,s,u,m,b){this._ngZone=n,this._platform=s,this._inputModalityDetector=u,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new qe,this._rootNodeFocusAndBlurListener=T=>{for(let z=fm(T);z;z=z.parentElement)"focus"===T.type?this._onFocus(T,z):this._onBlur(T,z)},this._document=m,this._detectionMode=b?.detectionMode||0}monitor(n,s=!1){const u=Sv(n);if(!this._platform.isBrowser||1!==u.nodeType)return Gn();const m=function f8(e){if(function h8(){if(null==d2){const e=typeof document<"u"?document.head:null;d2=!(!e||!e.createShadowRoot&&!e.attachShadow)}return d2}()){const t=e.getRootNode?e.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}(u)||this._getDocument(),b=this._elementInfo.get(u);if(b)return s&&(b.checkChildren=!0),b.subject;const T={checkChildren:s,subject:new qe,rootNode:m};return this._elementInfo.set(u,T),this._registerGlobalListeners(T),T.subject}stopMonitoring(n){const s=Sv(n),u=this._elementInfo.get(s);u&&(u.subject.complete(),this._setClasses(s),this._elementInfo.delete(s),this._removeGlobalListeners(u))}focusVia(n,s,u){const m=Sv(n);m===this._getDocument().activeElement?this._getClosestElementsInfo(m).forEach(([T,R])=>this._originChanged(T,s,R)):(this._setOrigin(s),"function"==typeof m.focus&&m.focus(u))}ngOnDestroy(){this._elementInfo.forEach((n,s)=>this.stopMonitoring(s))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(n){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(n)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:n&&this._isLastInteractionFromInputLabel(n)?"mouse":"program"}_shouldBeAttributedToTouch(n){return 1===this._detectionMode||!!n?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(n,s){n.classList.toggle("cdk-focused",!!s),n.classList.toggle("cdk-touch-focused","touch"===s),n.classList.toggle("cdk-keyboard-focused","keyboard"===s),n.classList.toggle("cdk-mouse-focused","mouse"===s),n.classList.toggle("cdk-program-focused","program"===s)}_setOrigin(n,s=!1){this._ngZone.runOutsideAngular(()=>{this._origin=n,this._originFromTouchInteraction="touch"===n&&s,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(n,s){const u=this._elementInfo.get(s),m=fm(n);!u||!u.checkChildren&&s!==m||this._originChanged(s,this._getFocusOrigin(m),u)}_onBlur(n,s){const u=this._elementInfo.get(s);!u||u.checkChildren&&n.relatedTarget instanceof Node&&s.contains(n.relatedTarget)||(this._setClasses(s),this._emitOrigin(u,null))}_emitOrigin(n,s){n.subject.observers.length&&this._ngZone.run(()=>n.subject.next(s))}_registerGlobalListeners(n){if(!this._platform.isBrowser)return;const s=n.rootNode,u=this._rootNodeFocusListenerCount.get(s)||0;u||this._ngZone.runOutsideAngular(()=>{s.addEventListener("focus",this._rootNodeFocusAndBlurListener,GE),s.addEventListener("blur",this._rootNodeFocusAndBlurListener,GE)}),this._rootNodeFocusListenerCount.set(s,u+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Wl(this._stopInputModalityDetector)).subscribe(m=>{this._setOrigin(m,!0)}))}_removeGlobalListeners(n){const s=n.rootNode;if(this._rootNodeFocusListenerCount.has(s)){const u=this._rootNodeFocusListenerCount.get(s);u>1?this._rootNodeFocusListenerCount.set(s,u-1):(s.removeEventListener("focus",this._rootNodeFocusAndBlurListener,GE),s.removeEventListener("blur",this._rootNodeFocusAndBlurListener,GE),this._rootNodeFocusListenerCount.delete(s))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(n,s,u){this._setClasses(n,s),this._emitOrigin(u,s),this._lastFocusOrigin=s}_getClosestElementsInfo(n){const s=[];return this._elementInfo.forEach((u,m)=>{(m===n||u.checkChildren&&m.contains(n))&&s.push([m,u])}),s}_isLastInteractionFromInputLabel(n){const{_mostRecentTarget:s,mostRecentModality:u}=this._inputModalityDetector;if("mouse"!==u||!s||s===n||"INPUT"!==n.nodeName&&"TEXTAREA"!==n.nodeName||n.disabled)return!1;const m=n.labels;if(m)for(let b=0;b<m.length;b++)if(m[b].contains(s))return!0;return!1}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(si),ze(Ms),ze(Y8),ze(Gi,8),ze(eH,8))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),tH=(()=>{var e;class t{constructor(n,s){this._elementRef=n,this._focusMonitor=s,this._focusOrigin=null,this.cdkFocusChange=new Wn}get focusOrigin(){return this._focusOrigin}ngAfterViewInit(){const n=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(n,1===n.nodeType&&n.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(s=>{this._focusOrigin=s,this.cdkFocusChange.emit(s)})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(tr),xe(E2))},e.\u0275dir=Bn({type:e,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"},exportAs:["cdkMonitorFocus"]}),t})();const WO="cdk-high-contrast-black-on-white",ZO="cdk-high-contrast-white-on-black",D2="cdk-high-contrast-active";let YO=(()=>{var e;class t{constructor(n,s){this._platform=n,this._document=s,this._breakpointSubscription=Jt(x2).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const n=this._document.createElement("div");n.style.backgroundColor="rgb(1,2,3)",n.style.position="absolute",this._document.body.appendChild(n);const s=this._document.defaultView||window,u=s&&s.getComputedStyle?s.getComputedStyle(n):null,m=(u&&u.backgroundColor||"").replace(/ /g,"");switch(n.remove(),m){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const n=this._document.body.classList;n.remove(D2,WO,ZO),this._hasCheckedHighContrastMode=!0;const s=this.getHighContrastMode();1===s?n.add(D2,WO):2===s&&n.add(D2,ZO)}}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Ms),ze(Gi))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),XO=(()=>{var e;class t{constructor(n){n._applyBodyHighContrastModeCssClasses()}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(YO))},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({imports:[w8]}),t})();const nH=new Kt("cdk-dir-doc",{providedIn:"root",factory:function iH(){return Jt(Gi)}}),rH=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Av=(()=>{var e;class t{constructor(n){this.value="ltr",this.change=new Wn,n&&(this.value=function oH(e){const t=e?.toLowerCase()||"";return"auto"===t&&typeof navigator<"u"&&navigator?.language?rH.test(navigator.language)?"rtl":"ltr":"rtl"===t?"rtl":"ltr"}((n.body?n.body.dir:null)||(n.documentElement?n.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(nH,8))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),Wx=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({}),t})();const aH=new Kt("mat-sanity-checks",{providedIn:"root",factory:function sH(){return!0}});let ad=(()=>{var e;class t{constructor(n,s,u){this._sanityChecks=s,this._document=u,this._hasDoneGlobalChecks=!1,n._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(n){return!h2()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[n])}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(YO),ze(aH,8),ze(Gi))},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({imports:[Wx,Wx]}),t})();function eF(e){return class extends e{get disabled(){return this._disabled}set disabled(t){this._disabled=aa(t)}constructor(...t){super(...t),this._disabled=!1}}}function T2(e,t){return class extends e{get color(){return this._color}set color(r){const n=r||this.defaultColor;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),n&&this._elementRef.nativeElement.classList.add(`mat-${n}`),this._color=n)}constructor(...r){super(...r),this.defaultColor=t,this.color=t}}}function tF(e){return class extends e{get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=aa(t)}constructor(...t){super(...t),this._disableRipple=!1}}}const nF=new Kt("MAT_DATE_LOCALE",{providedIn:"root",factory:function cH(){return Jt(lh)}});class la{constructor(){this._localeChanges=new qe,this.localeChanges=this._localeChanges}getValidDateOrNull(t){return this.isDateInstance(t)&&this.isValid(t)?t:null}deserialize(t){return null==t||this.isDateInstance(t)&&this.isValid(t)?t:this.invalid()}setLocale(t){this.locale=t,this._localeChanges.next()}compareDate(t,r){return this.getYear(t)-this.getYear(r)||this.getMonth(t)-this.getMonth(r)||this.getDate(t)-this.getDate(r)}sameDate(t,r){if(t&&r){let n=this.isValid(t),s=this.isValid(r);return n&&s?!this.compareDate(t,r):n==s}return t==r}clampDate(t,r,n){return r&&this.compareDate(t,r)<0?r:n&&this.compareDate(t,n)>0?n:t}}const pm=new Kt("mat-date-formats"),uH=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/;function S2(e,t){const r=Array(e);for(let n=0;n<e;n++)r[n]=t(n);return r}let dH=(()=>{var e;class t extends la{constructor(n,s){super(),this.useUtcForDisplay=!1,super.setLocale(n)}getYear(n){return n.getFullYear()}getMonth(n){return n.getMonth()}getDate(n){return n.getDate()}getDayOfWeek(n){return n.getDay()}getMonthNames(n){const s=new Intl.DateTimeFormat(this.locale,{month:n,timeZone:"utc"});return S2(12,u=>this._format(s,new Date(2017,u,1)))}getDateNames(){const n=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return S2(31,s=>this._format(n,new Date(2017,0,s+1)))}getDayOfWeekNames(n){const s=new Intl.DateTimeFormat(this.locale,{weekday:n,timeZone:"utc"});return S2(7,u=>this._format(s,new Date(2017,0,u+1)))}getYearName(n){const s=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._format(s,n)}getFirstDayOfWeek(){return 0}getNumDaysInMonth(n){return this.getDate(this._createDateWithOverflow(this.getYear(n),this.getMonth(n)+1,0))}clone(n){return new Date(n.getTime())}createDate(n,s,u){let m=this._createDateWithOverflow(n,s,u);return m.getMonth(),m}today(){return new Date}parse(n,s){return"number"==typeof n?new Date(n):n?new Date(Date.parse(n)):null}format(n,s){if(!this.isValid(n))throw Error("NativeDateAdapter: Cannot format invalid date.");const u=new Intl.DateTimeFormat(this.locale,{...s,timeZone:"utc"});return this._format(u,n)}addCalendarYears(n,s){return this.addCalendarMonths(n,12*s)}addCalendarMonths(n,s){let u=this._createDateWithOverflow(this.getYear(n),this.getMonth(n)+s,this.getDate(n));return this.getMonth(u)!=((this.getMonth(n)+s)%12+12)%12&&(u=this._createDateWithOverflow(this.getYear(u),this.getMonth(u),0)),u}addCalendarDays(n,s){return this._createDateWithOverflow(this.getYear(n),this.getMonth(n),this.getDate(n)+s)}toIso8601(n){return[n.getUTCFullYear(),this._2digit(n.getUTCMonth()+1),this._2digit(n.getUTCDate())].join("-")}deserialize(n){if("string"==typeof n){if(!n)return null;if(uH.test(n)){let s=new Date(n);if(this.isValid(s))return s}}return super.deserialize(n)}isDateInstance(n){return n instanceof Date}isValid(n){return!isNaN(n.getTime())}invalid(){return new Date(NaN)}_createDateWithOverflow(n,s,u){const m=new Date;return m.setFullYear(n,s,u),m.setHours(0,0,0,0),m}_2digit(n){return("00"+n).slice(-2)}_format(n,s){const u=new Date;return u.setUTCFullYear(s.getFullYear(),s.getMonth(),s.getDate()),u.setUTCHours(s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()),n.format(u)}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(nF,8),ze(Ms))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})();const hH={parse:{dateInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"}}};let fH=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({providers:[{provide:la,useClass:dH}]}),t})(),pH=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({providers:[{provide:pm,useValue:hH}],imports:[fH]}),t})();class mH{constructor(t,r,n,s=!1){this._renderer=t,this.element=r,this.config=n,this._animationForciblyDisabledThroughCss=s,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const iF=hm({passive:!0,capture:!0});class gH{constructor(){this._events=new Map,this._delegateEventHandler=t=>{const r=fm(t);r&&this._events.get(t.type)?.forEach((n,s)=>{(s===r||s.contains(r))&&n.forEach(u=>u.handleEvent(t))})}}addHandler(t,r,n,s){const u=this._events.get(r);if(u){const m=u.get(n);m?m.add(s):u.set(n,new Set([s]))}else this._events.set(r,new Map([[n,new Set([s])]])),t.runOutsideAngular(()=>{document.addEventListener(r,this._delegateEventHandler,iF)})}removeHandler(t,r,n){const s=this._events.get(t);if(!s)return;const u=s.get(r);u&&(u.delete(n),0===u.size&&s.delete(r),0===s.size&&(this._events.delete(t),document.removeEventListener(t,this._delegateEventHandler,iF)))}}const rF={enterDuration:225,exitDuration:150},oF=hm({passive:!0,capture:!0}),sF=["mousedown","touchstart"],aF=["mouseup","mouseleave","touchend","touchcancel"];class Yx{constructor(t,r,n,s){this._target=t,this._ngZone=r,this._platform=s,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,s.isBrowser&&(this._containerElement=Sv(n))}fadeInRipple(t,r,n={}){const s=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),u={...rF,...n.animation};n.centered&&(t=s.left+s.width/2,r=s.top+s.height/2);const m=n.radius||function yH(e,t,r){const n=Math.max(Math.abs(e-r.left),Math.abs(e-r.right)),s=Math.max(Math.abs(t-r.top),Math.abs(t-r.bottom));return Math.sqrt(n*n+s*s)}(t,r,s),b=t-s.left,T=r-s.top,R=u.enterDuration,z=document.createElement("div");z.classList.add("mat-ripple-element"),z.style.left=b-m+"px",z.style.top=T-m+"px",z.style.height=2*m+"px",z.style.width=2*m+"px",null!=n.color&&(z.style.backgroundColor=n.color),z.style.transitionDuration=`${R}ms`,this._containerElement.appendChild(z);const W=window.getComputedStyle(z),he=W.transitionDuration,Me="none"===W.transitionProperty||"0s"===he||"0s, 0s"===he||0===s.width&&0===s.height,Ve=new mH(this,z,n,Me);z.style.transform="scale3d(1, 1, 1)",Ve.state=0,n.persistent||(this._mostRecentTransientRipple=Ve);let at=null;return!Me&&(R||u.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const wt=()=>this._finishRippleTransition(Ve),ft=()=>this._destroyRipple(Ve);z.addEventListener("transitionend",wt),z.addEventListener("transitioncancel",ft),at={onTransitionEnd:wt,onTransitionCancel:ft}}),this._activeRipples.set(Ve,at),(Me||!R)&&this._finishRippleTransition(Ve),Ve}fadeOutRipple(t){if(2===t.state||3===t.state)return;const r=t.element,n={...rF,...t.config.animation};r.style.transitionDuration=`${n.exitDuration}ms`,r.style.opacity="0",t.state=2,(t._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(t)}fadeOutAll(){this._getActiveRipples().forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){const r=Sv(t);!this._platform.isBrowser||!r||r===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=r,sF.forEach(n=>{Yx._eventManager.addHandler(this._ngZone,n,r,this)}))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{aF.forEach(r=>{this._triggerElement.addEventListener(r,this,oF)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(t){0===t.state?this._startFadeOutTransition(t):2===t.state&&this._destroyRipple(t)}_startFadeOutTransition(t){const r=t===this._mostRecentTransientRipple,{persistent:n}=t.config;t.state=1,!n&&(!r||!this._isPointerDown)&&t.fadeOut()}_destroyRipple(t){const r=this._activeRipples.get(t)??null;this._activeRipples.delete(t),this._activeRipples.size||(this._containerRect=null),t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),t.state=3,null!==r&&(t.element.removeEventListener("transitionend",r.onTransitionEnd),t.element.removeEventListener("transitioncancel",r.onTransitionCancel)),t.element.remove()}_onMousedown(t){const r=HO(t),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!r&&!n&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!$O(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const r=t.changedTouches;if(r)for(let n=0;n<r.length;n++)this.fadeInRipple(r[n].clientX,r[n].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(t=>{!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const t=this._triggerElement;t&&(sF.forEach(r=>Yx._eventManager.removeHandler(r,t,this)),this._pointerUpEventsRegistered&&aF.forEach(r=>t.removeEventListener(r,this,oF)))}}Yx._eventManager=new gH;const lF=new Kt("mat-ripple-global-options");let M2=(()=>{var e;class t{get disabled(){return this._disabled}set disabled(n){n&&this.fadeOutAllNonPersistent(),this._disabled=n,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(n){this._trigger=n,this._setupTriggerEventsIfEnabled()}constructor(n,s,u,m,b){this._elementRef=n,this._animationMode=b,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=m||{},this._rippleRenderer=new Yx(this,s,n,u)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(n,s=0,u){return"number"==typeof n?this._rippleRenderer.fadeInRipple(n,s,{...this.rippleConfig,...u}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...n})}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(tr),xe(si),xe(Ms),xe(lF,8),xe(oa,8))},e.\u0275dir=Bn({type:e,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(n,s){2&n&&ie("mat-ripple-unbounded",s.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),t})(),cF=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({imports:[ad,ad]}),t})();const uF={capture:!0},dF=["focus","click","mouseenter","touchstart"],A2="mat-ripple-loader-uninitialized",I2="mat-ripple-loader-class-name",hF="mat-ripple-loader-centered",qE="mat-ripple-loader-disabled";let vH=(()=>{var e;class t{constructor(){this._document=Jt(Gi,{optional:!0}),this._animationMode=Jt(oa,{optional:!0}),this._globalRippleOptions=Jt(lF,{optional:!0}),this._platform=Jt(Ms),this._ngZone=Jt(si),this._onInteraction=n=>{if(!(n.target instanceof HTMLElement))return;const u=n.target.closest(`[${A2}]`);u&&this.createRipple(u)},this._ngZone.runOutsideAngular(()=>{for(const n of dF)this._document?.addEventListener(n,this._onInteraction,uF)})}ngOnDestroy(){for(const n of dF)this._document?.removeEventListener(n,this._onInteraction,uF)}configureRipple(n,s){n.setAttribute(A2,""),(s.className||!n.hasAttribute(I2))&&n.setAttribute(I2,s.className||""),s.centered&&n.setAttribute(hF,""),s.disabled&&n.setAttribute(qE,"")}getRipple(n){return n.matRipple?n.matRipple:this.createRipple(n)}setDisabled(n,s){const u=n.matRipple;u?u.disabled=s:s?n.setAttribute(qE,""):n.removeAttribute(qE)}createRipple(n){if(!this._document)return;n.querySelector(".mat-ripple")?.remove();const s=this._document.createElement("span");s.classList.add("mat-ripple",n.getAttribute(I2)),n.append(s);const u=new M2(new tr(s),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return u._isInitialized=!0,u.trigger=n,u.centered=n.hasAttribute(hF),u.disabled=n.hasAttribute(qE),this.attachRipple(n,u),u}attachRipple(n,s){n.removeAttribute(A2),n.matRipple=s}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();const bH=["mat-button",""],xH=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],wH=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],EH=["mat-icon-button",""],DH=["*"],TH=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],SH=T2(eF(tF(class{constructor(e){this._elementRef=e}})));let fF=(()=>{var e;class t extends SH{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(n){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,n)}get disableRipple(){return this._disableRipple}set disableRipple(n){this._disableRipple=aa(n),this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(n){this._disabled=aa(n),this._updateRippleDisabled()}constructor(n,s,u,m){super(n),this._platform=s,this._ngZone=u,this._animationMode=m,this._focusMonitor=Jt(E2),this._rippleLoader=Jt(vH),this._isFab=!1,this._disableRipple=!1,this._disabled=!1,this._rippleLoader?.configureRipple(this._elementRef.nativeElement,{className:"mat-mdc-button-ripple"});const b=n.nativeElement.classList;for(const T of TH)this._hasHostAttributes(T.selector)&&T.mdcClasses.forEach(R=>{b.add(R)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(n="program",s){n?this._focusMonitor.focusVia(this._elementRef.nativeElement,n,s):this._elementRef.nativeElement.focus(s)}_hasHostAttributes(...n){return n.some(s=>this._elementRef.nativeElement.hasAttribute(s))}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}}return(e=t).\u0275fac=function(n){ol()},e.\u0275dir=Bn({type:e,features:[ki]}),t})(),k2=(()=>{var e;class t extends fF{constructor(n,s,u,m){super(n,s,u,m)}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(tr),xe(Ms),xe(si),xe(oa,8))},e.\u0275cmp=Ci({type:e,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:7,hostBindings:function(n,s){2&n&&(Fr("disabled",s.disabled||null),ie("_mat-animation-noopable","NoopAnimations"===s._animationMode)("mat-unthemed",!s.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[ki],attrs:bH,ngContentSelectors:wH,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(n,s){1&n&&(If(xH),it(0,"span",0),Ku(1),ce(2,"span",1),Ku(3,1),ue(),Ku(4,2),it(5,"span",2)(6,"span",3)),2&n&&ie("mdc-button__ripple",!s._isFab)("mdc-fab__ripple",s._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(\n      100% + 4px\n    );width:calc(\n      100% + 4px\n    );display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{height:var(--mdc-text-button-container-height, 36px);border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, inherit)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button{height:var(--mdc-filled-button-container-height, 36px);border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color, transparent)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, inherit)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button{height:var(--mdc-protected-button-container-height, 36px);border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px));box-shadow:var(--mdc-protected-button-container-elevation, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color, transparent)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, inherit)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button.mdc-ripple-upgraded--background-focused,.mat-mdc-raised-button:not(.mdc-ripple-upgraded):focus{box-shadow:var(--mdc-protected-button-focus-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled):active{box-shadow:var(--mdc-protected-button-pressed-container-elevation, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button{height:var(--mdc-outlined-button-container-height, 36px);border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px));padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, inherit)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width, 1px));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width, 1px))}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-button .mat-ripple-element,.mat-mdc-unelevated-button .mat-ripple-element,.mat-mdc-raised-button .mat-ripple-element,.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button[disabled],.mat-mdc-unelevated-button[disabled],.mat-mdc-raised-button[disabled],.mat-mdc-outlined-button[disabled]{cursor:default;pointer-events:none}.mat-mdc-button .mat-mdc-button-touch-target,.mat-mdc-unelevated-button .mat-mdc-button-touch-target,.mat-mdc-raised-button .mat-mdc-button-touch-target,.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}[dir=rtl] .mat-mdc-button>.mat-icon,.mat-mdc-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}.mat-mdc-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon,.mat-mdc-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem;margin-left:-4px;margin-right:8px}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:-4px}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon,.mat-mdc-raised-button .mdc-button__label+.mat-icon,.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:-4px}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon,.mat-mdc-unelevated-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-raised-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-outlined-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:-4px;margin-right:8px}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px) * -1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),t})(),IH=(()=>{var e;class t extends fF{constructor(n,s,u,m){super(n,s,u,m),this._rippleLoader.configureRipple(this._elementRef.nativeElement,{centered:!0})}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(tr),xe(Ms),xe(si),xe(oa,8))},e.\u0275cmp=Ci({type:e,selectors:[["button","mat-icon-button",""]],hostVars:7,hostBindings:function(n,s){2&n&&(Fr("disabled",s.disabled||null),ie("_mat-animation-noopable","NoopAnimations"===s._animationMode)("mat-unthemed",!s.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[ki],attrs:EH,ngContentSelectors:DH,decls:4,vars:0,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(n,s){1&n&&(If(),it(0,"span",0),Ku(1),it(2,"span",1)(3,"span",2))},styles:['.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size);width:var(--mdc-icon-button-state-layer-size);color:var(--mdc-icon-button-icon-color);--mdc-icon-button-state-layer-size:48px;--mdc-icon-button-icon-size:24px;--mdc-icon-button-disabled-icon-color:black;--mdc-icon-button-disabled-icon-opacity:0.38}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size);height:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button{padding:12px;font-size:var(--mdc-icon-button-icon-size);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),t})(),pF=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({imports:[ad,cF,ad]}),t})();class R2{attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null!=t&&(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class Iv extends R2{constructor(t,r,n,s,u){super(),this.component=t,this.viewContainerRef=r,this.injector=n,this.componentFactoryResolver=s,this.projectableNodes=u}}class mF extends R2{constructor(t,r,n,s){super(),this.templateRef=t,this.viewContainerRef=r,this.context=n,this.injector=s}get origin(){return this.templateRef.elementRef}attach(t,r=this.context){return this.context=r,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class kH extends R2{constructor(t){super(),this.element=t instanceof tr?t.nativeElement:t}}class P2{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){return t instanceof Iv?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof mF?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof kH?(this._attachedPortal=t,this.attachDomPortal(t)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class RH extends P2{constructor(t,r,n,s,u){super(),this.outletElement=t,this._componentFactoryResolver=r,this._appRef=n,this._defaultInjector=s,this.attachDomPortal=m=>{const b=m.element,T=this._document.createComment("dom-portal");b.parentNode.insertBefore(T,b),this.outletElement.appendChild(b),this._attachedPortal=m,super.setDisposeFn(()=>{T.parentNode&&T.parentNode.replaceChild(b,T)})},this._document=u}attachComponentPortal(t){const n=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let s;return t.viewContainerRef?(s=t.viewContainerRef.createComponent(n,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector,t.projectableNodes||void 0),this.setDisposeFn(()=>s.destroy())):(s=n.create(t.injector||this._defaultInjector||Xr.NULL),this._appRef.attachView(s.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(s.hostView),s.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(s)),this._attachedPortal=t,s}attachTemplatePortal(t){let r=t.viewContainerRef,n=r.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return n.rootNodes.forEach(s=>this.outletElement.appendChild(s)),n.detectChanges(),this.setDisposeFn(()=>{let s=r.indexOf(n);-1!==s&&r.remove(s)}),this._attachedPortal=t,n}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let WE=(()=>{var e;class t extends P2{constructor(n,s,u){super(),this._componentFactoryResolver=n,this._viewContainerRef=s,this._isInitialized=!1,this.attached=new Wn,this.attachDomPortal=m=>{const b=m.element,T=this._document.createComment("dom-portal");m.setAttachedHost(this),b.parentNode.insertBefore(T,b),this._getRootNode().appendChild(b),this._attachedPortal=m,super.setDisposeFn(()=>{T.parentNode&&T.parentNode.replaceChild(b,T)})},this._document=u}get portal(){return this._attachedPortal}set portal(n){this.hasAttached()&&!n&&!this._isInitialized||(this.hasAttached()&&super.detach(),n&&super.attach(n),this._attachedPortal=n||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(n){n.setAttachedHost(this);const s=null!=n.viewContainerRef?n.viewContainerRef:this._viewContainerRef,m=(n.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(n.component),b=s.createComponent(m,s.length,n.injector||s.injector,n.projectableNodes||void 0);return s!==this._viewContainerRef&&this._getRootNode().appendChild(b.hostView.rootNodes[0]),super.setDisposeFn(()=>b.destroy()),this._attachedPortal=n,this._attachedRef=b,this.attached.emit(b),b}attachTemplatePortal(n){n.setAttachedHost(this);const s=this._viewContainerRef.createEmbeddedView(n.templateRef,n.context,{injector:n.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=n,this._attachedRef=s,this.attached.emit(s),s}_getRootNode(){const n=this._viewContainerRef.element.nativeElement;return n.nodeType===n.ELEMENT_NODE?n:n.parentNode}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(Xd),xe(Hl),xe(Gi))},e.\u0275dir=Bn({type:e,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[ki]}),t})(),O2=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({}),t})();const PH=["addListener","removeListener"],OH=["addEventListener","removeEventListener"],FH=["on","off"];function F2(e,t,r,n){if(ht(r)&&(n=r,r=void 0),n)return F2(e,t,r).pipe(RM(n));const[s,u]=function BH(e){return ht(e.addEventListener)&&ht(e.removeEventListener)}(e)?OH.map(m=>b=>e[m](t,b,r)):function LH(e){return ht(e.addListener)&&ht(e.removeListener)}(e)?PH.map(gF(e,t)):function NH(e){return ht(e.on)&&ht(e.off)}(e)?FH.map(gF(e,t)):[];if(!s&&Mt(e))return Wr(m=>F2(m,t,r))(Ai(e));if(!s)throw new TypeError("Invalid event target");return new wn(m=>{const b=(...T)=>m.next(1<T.length?T:T[0]);return s(b),()=>u(b)})}function gF(e,t){return r=>n=>e[r](t,n)}const Xx={schedule(e){let t=requestAnimationFrame,r=cancelAnimationFrame;const{delegate:n}=Xx;n&&(t=n.requestAnimationFrame,r=n.cancelAnimationFrame);const s=t(u=>{r=void 0,e(u)});return new me(()=>r?.(s))},requestAnimationFrame(...e){const{delegate:t}=Xx;return(t?.requestAnimationFrame||requestAnimationFrame)(...e)},cancelAnimationFrame(...e){const{delegate:t}=Xx;return(t?.cancelAnimationFrame||cancelAnimationFrame)(...e)},delegate:void 0};new class VH extends v2{flush(t){this._active=!0;const r=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let s;t=t||n.shift();do{if(s=t.execute(t.state,t.delay))break}while((t=n[0])&&t.id===r&&n.shift());if(this._active=!1,s){for(;(t=n[0])&&t.id===r&&n.shift();)t.unsubscribe();throw s}}}(class zH extends _2{constructor(t,r){super(t,r),this.scheduler=t,this.work=r}requestAsyncId(t,r,n=0){return null!==n&&n>0?super.requestAsyncId(t,r,n):(t.actions.push(this),t._scheduled||(t._scheduled=Xx.requestAnimationFrame(()=>t.flush(void 0))))}recycleAsyncId(t,r,n=0){var s;if(null!=n?n>0:this.delay>0)return super.recycleAsyncId(t,r,n);const{actions:u}=t;null!=r&&(null===(s=u[u.length-1])||void 0===s?void 0:s.id)!==r&&(Xx.cancelAnimationFrame(r),t._scheduled=void 0)}});let L2,UH=1;const ZE={};function _F(e){return e in ZE&&(delete ZE[e],!0)}const HH={setImmediate(e){const t=UH++;return ZE[t]=!0,L2||(L2=Promise.resolve()),L2.then(()=>_F(t)&&e()),t},clearImmediate(e){_F(e)}},{setImmediate:$H,clearImmediate:GH}=HH,YE={setImmediate(...e){const{delegate:t}=YE;return(t?.setImmediate||$H)(...e)},clearImmediate(e){const{delegate:t}=YE;return(t?.clearImmediate||GH)(e)},delegate:void 0};new class WH extends v2{flush(t){this._active=!0;const r=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let s;t=t||n.shift();do{if(s=t.execute(t.state,t.delay))break}while((t=n[0])&&t.id===r&&n.shift());if(this._active=!1,s){for(;(t=n[0])&&t.id===r&&n.shift();)t.unsubscribe();throw s}}}(class qH extends _2{constructor(t,r){super(t,r),this.scheduler=t,this.work=r}requestAsyncId(t,r,n=0){return null!==n&&n>0?super.requestAsyncId(t,r,n):(t.actions.push(this),t._scheduled||(t._scheduled=YE.setImmediate(t.flush.bind(t,void 0))))}recycleAsyncId(t,r,n=0){var s;if(null!=n?n>0:this.delay>0)return super.recycleAsyncId(t,r,n);const{actions:u}=t;null!=r&&(null===(s=u[u.length-1])||void 0===s?void 0:s.id)!==r&&(YE.clearImmediate(r),t._scheduled===r&&(t._scheduled=void 0))}});function yF(e,t=b2){return function YH(e){return ur((t,r)=>{let n=!1,s=null,u=null,m=!1;const b=()=>{if(u?.unsubscribe(),u=null,n){n=!1;const R=s;s=null,r.next(R)}m&&r.complete()},T=()=>{u=null,m&&r.complete()};t.subscribe(ai(r,R=>{n=!0,s=R,u||Ai(e(R)).subscribe(u=ai(r,b,T))},()=>{m=!0,(!n||!u||u.closed)&&r.complete()}))})}(()=>function KH(e=0,t,r=E8){let n=-1;return null!=t&&(Oc(t)?r=t:n=t),new wn(s=>{let u=function XH(e){return e instanceof Date&&!isNaN(e)}(e)?+e-r.now():e;u<0&&(u=0);let m=0;return r.schedule(function(){s.closed||(s.next(m++),0<=n?this.schedule(void 0,n):s.complete())},u)})}(e,t))}let vF=(()=>{var e;class t{constructor(n,s,u){this._ngZone=n,this._platform=s,this._scrolled=new qe,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=u}register(n){this.scrollContainers.has(n)||this.scrollContainers.set(n,n.elementScrolled().subscribe(()=>this._scrolled.next(n)))}deregister(n){const s=this.scrollContainers.get(n);s&&(s.unsubscribe(),this.scrollContainers.delete(n))}scrolled(n=20){return this._platform.isBrowser?new wn(s=>{this._globalSubscription||this._addGlobalListener();const u=n>0?this._scrolled.pipe(yF(n)).subscribe(s):this._scrolled.subscribe(s);return this._scrolledCount++,()=>{u.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Gn()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((n,s)=>this.deregister(s)),this._scrolled.complete()}ancestorScrolled(n,s){const u=this.getAncestorScrollContainers(n);return this.scrolled(s).pipe(ql(m=>!m||u.indexOf(m)>-1))}getAncestorScrollContainers(n){const s=[];return this.scrollContainers.forEach((u,m)=>{this._scrollableContainsElement(m,n)&&s.push(m)}),s}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(n,s){let u=Sv(s),m=n.getElementRef().nativeElement;do{if(u==m)return!0}while(u=u.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>F2(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(si),ze(Ms),ze(Gi,8))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),bF=(()=>{var e;class t{constructor(n,s,u){this._platform=n,this._change=new qe,this._changeListener=m=>{this._change.next(m)},this._document=u,s.runOutsideAngular(()=>{if(n.isBrowser){const m=this._getWindow();m.addEventListener("resize",this._changeListener),m.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const n=this._getWindow();n.removeEventListener("resize",this._changeListener),n.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const n={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),n}getViewportRect(){const n=this.getViewportScrollPosition(),{width:s,height:u}=this.getViewportSize();return{top:n.top,left:n.left,bottom:n.top+u,right:n.left+s,height:u,width:s}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const n=this._document,s=this._getWindow(),u=n.documentElement,m=u.getBoundingClientRect();return{top:-m.top||n.body.scrollTop||s.scrollY||u.scrollTop||0,left:-m.left||n.body.scrollLeft||s.scrollX||u.scrollLeft||0}}change(n=20){return n>0?this._change.pipe(yF(n)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const n=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:n.innerWidth,height:n.innerHeight}:{width:0,height:0}}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Ms),ze(si),ze(Gi,8))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),XE=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({}),t})(),xF=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({imports:[Wx,XE,Wx,XE]}),t})();const wF=d8();class e${constructor(t,r){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=r}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=_s(-this._previousScrollPosition.left),t.style.top=_s(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,n=t.style,s=this._document.body.style,u=n.scrollBehavior||"",m=s.scrollBehavior||"";this._isEnabled=!1,n.left=this._previousHTMLStyles.left,n.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),wF&&(n.scrollBehavior=s.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),wF&&(n.scrollBehavior=u,s.scrollBehavior=m)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const r=this._document.body,n=this._viewportRuler.getViewportSize();return r.scrollHeight>n.height||r.scrollWidth>n.width}}class t${constructor(t,r,n,s){this._scrollDispatcher=t,this._ngZone=r,this._viewportRuler=n,this._config=s,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0).pipe(ql(r=>!r||!this._overlayRef.overlayElement.contains(r.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const r=this._viewportRuler.getViewportScrollPosition().top;Math.abs(r-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class CF{enable(){}disable(){}attach(){}}function N2(e,t){return t.some(r=>e.bottom<r.top||e.top>r.bottom||e.right<r.left||e.left>r.right)}function EF(e,t){return t.some(r=>e.top<r.top||e.bottom>r.bottom||e.left<r.left||e.right>r.right)}class n${constructor(t,r,n,s){this._scrollDispatcher=t,this._viewportRuler=r,this._ngZone=n,this._config=s,this._scrollSubscription=null}attach(t){this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const r=this._overlayRef.overlayElement.getBoundingClientRect(),{width:n,height:s}=this._viewportRuler.getViewportSize();N2(r,[{width:n,height:s,bottom:s,right:n,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let i$=(()=>{var e;class t{constructor(n,s,u,m){this._scrollDispatcher=n,this._viewportRuler=s,this._ngZone=u,this.noop=()=>new CF,this.close=b=>new t$(this._scrollDispatcher,this._ngZone,this._viewportRuler,b),this.block=()=>new e$(this._viewportRuler,this._document),this.reposition=b=>new n$(this._scrollDispatcher,this._viewportRuler,this._ngZone,b),this._document=m}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(vF),ze(bF),ze(si),ze(Gi))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();class B2{constructor(t){if(this.scrollStrategy=new CF,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){const r=Object.keys(t);for(const n of r)void 0!==t[n]&&(this[n]=t[n])}}}class r${constructor(t,r){this.connectionPair=t,this.scrollableViewProperties=r}}let DF=(()=>{var e;class t{constructor(n){this._attachedOverlays=[],this._document=n}ngOnDestroy(){this.detach()}add(n){this.remove(n),this._attachedOverlays.push(n)}remove(n){const s=this._attachedOverlays.indexOf(n);s>-1&&this._attachedOverlays.splice(s,1),0===this._attachedOverlays.length&&this.detach()}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Gi))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),o$=(()=>{var e;class t extends DF{constructor(n,s){super(n),this._ngZone=s,this._keydownListener=u=>{const m=this._attachedOverlays;for(let b=m.length-1;b>-1;b--)if(m[b]._keydownEvents.observers.length>0){const T=m[b]._keydownEvents;this._ngZone?this._ngZone.run(()=>T.next(u)):T.next(u);break}}}add(n){super.add(n),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Gi),ze(si,8))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),s$=(()=>{var e;class t extends DF{constructor(n,s,u){super(n),this._platform=s,this._ngZone=u,this._cursorStyleIsSet=!1,this._pointerDownListener=m=>{this._pointerDownEventTarget=fm(m)},this._clickListener=m=>{const b=fm(m),T="click"===m.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:b;this._pointerDownEventTarget=null;const R=this._attachedOverlays.slice();for(let z=R.length-1;z>-1;z--){const W=R[z];if(W._outsidePointerEvents.observers.length<1||!W.hasAttached())continue;if(W.overlayElement.contains(b)||W.overlayElement.contains(T))break;const le=W._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>le.next(m)):le.next(m)}}}add(n){if(super.add(n),!this._isAttached){const s=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(s)):this._addEventListeners(s),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=s.style.cursor,s.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const n=this._document.body;n.removeEventListener("pointerdown",this._pointerDownListener,!0),n.removeEventListener("click",this._clickListener,!0),n.removeEventListener("auxclick",this._clickListener,!0),n.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(n.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(n){n.addEventListener("pointerdown",this._pointerDownListener,!0),n.addEventListener("click",this._clickListener,!0),n.addEventListener("auxclick",this._clickListener,!0),n.addEventListener("contextmenu",this._clickListener,!0)}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Gi),ze(Ms),ze(si,8))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),TF=(()=>{var e;class t{constructor(n,s){this._platform=s,this._document=n}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const n="cdk-overlay-container";if(this._platform.isBrowser||h2()){const u=this._document.querySelectorAll(`.${n}[platform="server"], .${n}[platform="test"]`);for(let m=0;m<u.length;m++)u[m].remove()}const s=this._document.createElement("div");s.classList.add(n),h2()?s.setAttribute("platform","test"):this._platform.isBrowser||s.setAttribute("platform","server"),this._document.body.appendChild(s),this._containerElement=s}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Gi),ze(Ms))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();class a${constructor(t,r,n,s,u,m,b,T,R,z=!1){this._portalOutlet=t,this._host=r,this._pane=n,this._config=s,this._ngZone=u,this._keyboardDispatcher=m,this._document=b,this._location=T,this._outsideClickDispatcher=R,this._animationsDisabled=z,this._backdropElement=null,this._backdropClick=new qe,this._attachments=new qe,this._detachments=new qe,this._locationChanges=me.EMPTY,this._backdropClickHandler=W=>this._backdropClick.next(W),this._backdropTransitionendHandler=W=>{this._disposeBackdrop(W.target)},this._keydownEvents=new qe,this._outsidePointerEvents=new qe,s.scrollStrategy&&(this._scrollStrategy=s.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=s.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const r=this._portalOutlet.attach(t);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(Us(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof r?.onDestroy&&r.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),r}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){const t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,t&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config={...this._config,...t},this._updateElementSize()}setDirection(t){this._config={...this._config,direction:t},this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=_s(this._config.width),t.height=_s(this._config.height),t.minWidth=_s(this._config.minWidth),t.minHeight=_s(this._config.minHeight),t.maxWidth=_s(this._config.maxWidth),t.maxHeight=_s(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachBackdrop(){const t="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(t)})}):this._backdropElement.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const t=this._backdropElement;if(t){if(this._animationsDisabled)return void this._disposeBackdrop(t);t.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{t.addEventListener("transitionend",this._backdropTransitionendHandler)}),t.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(t)},500))}}_toggleClasses(t,r,n){const s=jE(r||[]).filter(u=>!!u);s.length&&(n?t.classList.add(...s):t.classList.remove(...s))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const t=this._ngZone.onStable.pipe(Wl(vh(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}_disposeBackdrop(t){t&&(t.removeEventListener("click",this._backdropClickHandler),t.removeEventListener("transitionend",this._backdropTransitionendHandler),t.remove(),this._backdropElement===t&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const SF="cdk-overlay-connected-position-bounding-box",l$=/([A-Za-z%]+)$/;class MF{get positions(){return this._preferredPositions}constructor(t,r,n,s,u){this._viewportRuler=r,this._document=n,this._platform=s,this._overlayContainer=u,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new qe,this._resizeSubscription=me.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(t)}attach(t){this._validatePositions(),t.hostElement.classList.add(SF),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._originRect,r=this._overlayRect,n=this._viewportRect,s=this._containerRect,u=[];let m;for(let b of this._preferredPositions){let T=this._getOriginPoint(t,s,b),R=this._getOverlayPoint(T,r,b),z=this._getOverlayFit(R,r,n,b);if(z.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(b,T);this._canFitWithFlexibleDimensions(z,R,n)?u.push({position:b,origin:T,overlayRect:r,boundingBoxRect:this._calculateBoundingBoxRect(T,b)}):(!m||m.overlayFit.visibleArea<z.visibleArea)&&(m={overlayFit:z,overlayPoint:R,originPoint:T,position:b,overlayRect:r})}if(u.length){let b=null,T=-1;for(const R of u){const z=R.boundingBoxRect.width*R.boundingBoxRect.height*(R.position.weight||1);z>T&&(T=z,b=R)}return this._isPushed=!1,void this._applyPosition(b.position,b.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(m.position,m.originPoint);this._applyPosition(m.position,m.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&b_(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(SF),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const t=this._lastPosition;if(t){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const r=this._getOriginPoint(this._originRect,this._containerRect,t);this._applyPosition(t,r)}else this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,r,n){let s,u;if("center"==n.originX)s=t.left+t.width/2;else{const m=this._isRtl()?t.right:t.left,b=this._isRtl()?t.left:t.right;s="start"==n.originX?m:b}return r.left<0&&(s-=r.left),u="center"==n.originY?t.top+t.height/2:"top"==n.originY?t.top:t.bottom,r.top<0&&(u-=r.top),{x:s,y:u}}_getOverlayPoint(t,r,n){let s,u;return s="center"==n.overlayX?-r.width/2:"start"===n.overlayX?this._isRtl()?-r.width:0:this._isRtl()?0:-r.width,u="center"==n.overlayY?-r.height/2:"top"==n.overlayY?0:-r.height,{x:t.x+s,y:t.y+u}}_getOverlayFit(t,r,n,s){const u=IF(r);let{x:m,y:b}=t,T=this._getOffset(s,"x"),R=this._getOffset(s,"y");T&&(m+=T),R&&(b+=R);let le=0-b,he=b+u.height-n.height,Me=this._subtractOverflows(u.width,0-m,m+u.width-n.width),Ve=this._subtractOverflows(u.height,le,he),at=Me*Ve;return{visibleArea:at,isCompletelyWithinViewport:u.width*u.height===at,fitsInViewportVertically:Ve===u.height,fitsInViewportHorizontally:Me==u.width}}_canFitWithFlexibleDimensions(t,r,n){if(this._hasFlexibleDimensions){const s=n.bottom-r.y,u=n.right-r.x,m=AF(this._overlayRef.getConfig().minHeight),b=AF(this._overlayRef.getConfig().minWidth);return(t.fitsInViewportVertically||null!=m&&m<=s)&&(t.fitsInViewportHorizontally||null!=b&&b<=u)}return!1}_pushOverlayOnScreen(t,r,n){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const s=IF(r),u=this._viewportRect,m=Math.max(t.x+s.width-u.width,0),b=Math.max(t.y+s.height-u.height,0),T=Math.max(u.top-n.top-t.y,0),R=Math.max(u.left-n.left-t.x,0);let z=0,W=0;return z=s.width<=u.width?R||-m:t.x<this._viewportMargin?u.left-n.left-t.x:0,W=s.height<=u.height?T||-b:t.y<this._viewportMargin?u.top-n.top-t.y:0,this._previousPushAmount={x:z,y:W},{x:t.x+z,y:t.y+W}}_applyPosition(t,r){if(this._setTransformOrigin(t),this._setOverlayElementStyles(r,t),this._setBoundingBoxStyles(r,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._lastPosition=t,this._positionChanges.observers.length){const n=this._getScrollVisibility(),s=new r$(t,n);this._positionChanges.next(s)}this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const r=this._boundingBox.querySelectorAll(this._transformOriginSelector);let n,s=t.overlayY;n="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let u=0;u<r.length;u++)r[u].style.transformOrigin=`${n} ${s}`}_calculateBoundingBoxRect(t,r){const n=this._viewportRect,s=this._isRtl();let u,m,b,z,W,le;if("top"===r.overlayY)m=t.y,u=n.height-m+this._viewportMargin;else if("bottom"===r.overlayY)b=n.height-t.y+2*this._viewportMargin,u=n.height-b+this._viewportMargin;else{const he=Math.min(n.bottom-t.y+n.top,t.y),Me=this._lastBoundingBoxSize.height;u=2*he,m=t.y-he,u>Me&&!this._isInitialRender&&!this._growAfterOpen&&(m=t.y-Me/2)}if("end"===r.overlayX&&!s||"start"===r.overlayX&&s)le=n.width-t.x+this._viewportMargin,z=t.x-this._viewportMargin;else if("start"===r.overlayX&&!s||"end"===r.overlayX&&s)W=t.x,z=n.right-t.x;else{const he=Math.min(n.right-t.x+n.left,t.x),Me=this._lastBoundingBoxSize.width;z=2*he,W=t.x-he,z>Me&&!this._isInitialRender&&!this._growAfterOpen&&(W=t.x-Me/2)}return{top:m,left:W,bottom:b,right:le,width:z,height:u}}_setBoundingBoxStyles(t,r){const n=this._calculateBoundingBoxRect(t,r);!this._isInitialRender&&!this._growAfterOpen&&(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));const s={};if(this._hasExactPosition())s.top=s.left="0",s.bottom=s.right=s.maxHeight=s.maxWidth="",s.width=s.height="100%";else{const u=this._overlayRef.getConfig().maxHeight,m=this._overlayRef.getConfig().maxWidth;s.height=_s(n.height),s.top=_s(n.top),s.bottom=_s(n.bottom),s.width=_s(n.width),s.left=_s(n.left),s.right=_s(n.right),s.alignItems="center"===r.overlayX?"center":"end"===r.overlayX?"flex-end":"flex-start",s.justifyContent="center"===r.overlayY?"center":"bottom"===r.overlayY?"flex-end":"flex-start",u&&(s.maxHeight=_s(u)),m&&(s.maxWidth=_s(m))}this._lastBoundingBoxSize=n,b_(this._boundingBox.style,s)}_resetBoundingBoxStyles(){b_(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){b_(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,r){const n={},s=this._hasExactPosition(),u=this._hasFlexibleDimensions,m=this._overlayRef.getConfig();if(s){const z=this._viewportRuler.getViewportScrollPosition();b_(n,this._getExactOverlayY(r,t,z)),b_(n,this._getExactOverlayX(r,t,z))}else n.position="static";let b="",T=this._getOffset(r,"x"),R=this._getOffset(r,"y");T&&(b+=`translateX(${T}px) `),R&&(b+=`translateY(${R}px)`),n.transform=b.trim(),m.maxHeight&&(s?n.maxHeight=_s(m.maxHeight):u&&(n.maxHeight="")),m.maxWidth&&(s?n.maxWidth=_s(m.maxWidth):u&&(n.maxWidth="")),b_(this._pane.style,n)}_getExactOverlayY(t,r,n){let s={top:"",bottom:""},u=this._getOverlayPoint(r,this._overlayRect,t);return this._isPushed&&(u=this._pushOverlayOnScreen(u,this._overlayRect,n)),"bottom"===t.overlayY?s.bottom=this._document.documentElement.clientHeight-(u.y+this._overlayRect.height)+"px":s.top=_s(u.y),s}_getExactOverlayX(t,r,n){let m,s={left:"",right:""},u=this._getOverlayPoint(r,this._overlayRect,t);return this._isPushed&&(u=this._pushOverlayOnScreen(u,this._overlayRect,n)),m=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left","right"===m?s.right=this._document.documentElement.clientWidth-(u.x+this._overlayRect.width)+"px":s.left=_s(u.x),s}_getScrollVisibility(){const t=this._getOriginRect(),r=this._pane.getBoundingClientRect(),n=this._scrollables.map(s=>s.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:EF(t,n),isOriginOutsideView:N2(t,n),isOverlayClipped:EF(r,n),isOverlayOutsideView:N2(r,n)}}_subtractOverflows(t,...r){return r.reduce((n,s)=>n-Math.max(s,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,r=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+t-this._viewportMargin,bottom:n.top+r-this._viewportMargin,width:t-2*this._viewportMargin,height:r-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,r){return"x"===r?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&jE(t).forEach(r=>{""!==r&&-1===this._appliedPanelClasses.indexOf(r)&&(this._appliedPanelClasses.push(r),this._pane.classList.add(r))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;if(t instanceof tr)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();const r=t.width||0,n=t.height||0;return{top:t.y,bottom:t.y+n,left:t.x,right:t.x+r,height:n,width:r}}}function b_(e,t){for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function AF(e){if("number"!=typeof e&&null!=e){const[t,r]=e.split(l$);return r&&"px"!==r?null:parseFloat(t)}return e||null}function IF(e){return{top:Math.floor(e.top),right:Math.floor(e.right),bottom:Math.floor(e.bottom),left:Math.floor(e.left),width:Math.floor(e.width),height:Math.floor(e.height)}}const kF="cdk-global-overlay-wrapper";class c${constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(t){const r=t.getConfig();this._overlayRef=t,this._width&&!r.width&&t.updateSize({width:this._width}),this._height&&!r.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(kF),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._xOffset=t,this._xPosition="left",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._xOffset=t,this._xPosition="right",this}start(t=""){return this._xOffset=t,this._xPosition="start",this}end(t=""){return this._xOffset=t,this._xPosition="end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._xPosition="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,r=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:s,height:u,maxWidth:m,maxHeight:b}=n,T=!("100%"!==s&&"100vw"!==s||m&&"100%"!==m&&"100vw"!==m),R=!("100%"!==u&&"100vh"!==u||b&&"100%"!==b&&"100vh"!==b),z=this._xPosition,W=this._xOffset,le="rtl"===this._overlayRef.getConfig().direction;let he="",Me="",Ve="";T?Ve="flex-start":"center"===z?(Ve="center",le?Me=W:he=W):le?"left"===z||"end"===z?(Ve="flex-end",he=W):("right"===z||"start"===z)&&(Ve="flex-start",Me=W):"left"===z||"start"===z?(Ve="flex-start",he=W):("right"===z||"end"===z)&&(Ve="flex-end",Me=W),t.position=this._cssPosition,t.marginLeft=T?"0":he,t.marginTop=R?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=T?"0":Me,r.justifyContent=Ve,r.alignItems=R?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,r=this._overlayRef.hostElement,n=r.style;r.classList.remove(kF),n.justifyContent=n.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let u$=(()=>{var e;class t{constructor(n,s,u,m){this._viewportRuler=n,this._document=s,this._platform=u,this._overlayContainer=m}global(){return new c$}flexibleConnectedTo(n){return new MF(n,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(bF),ze(Gi),ze(Ms),ze(TF))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),d$=0,mm=(()=>{var e;class t{constructor(n,s,u,m,b,T,R,z,W,le,he,Me){this.scrollStrategies=n,this._overlayContainer=s,this._componentFactoryResolver=u,this._positionBuilder=m,this._keyboardDispatcher=b,this._injector=T,this._ngZone=R,this._document=z,this._directionality=W,this._location=le,this._outsideClickDispatcher=he,this._animationsModuleType=Me}create(n){const s=this._createHostElement(),u=this._createPaneElement(s),m=this._createPortalOutlet(u),b=new B2(n);return b.direction=b.direction||this._directionality.value,new a$(m,s,u,b,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(n){const s=this._document.createElement("div");return s.id="cdk-overlay-"+d$++,s.classList.add("cdk-overlay-pane"),n.appendChild(s),s}_createHostElement(){const n=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(n),n}_createPortalOutlet(n){return this._appRef||(this._appRef=this._injector.get(ch)),new RH(n,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(i$),ze(TF),ze(Xd),ze(u$),ze(o$),ze(Xr),ze(si),ze(Gi),ze(Av),ze(QC),ze(s$),ze(oa,8))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();const p$={provide:new Kt("cdk-connected-overlay-scroll-strategy"),deps:[mm],useFactory:function f$(e){return()=>e.scrollStrategies.reposition()}};let z2=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({providers:[mm,p$],imports:[Wx,O2,xF,xF]}),t})();function m$(e,t){if(1&e){const r=Sr();ce(0,"div",2)(1,"button",3),zt("click",function(){return Mn(r),Cn(Dn().action())}),Te(2),ue()()}if(2&e){const r=Dn();we(2),Xn(" ",r.data.action," ")}}const g$=["label"];function _$(e,t){}const y$=Math.pow(2,31)-1;class V2{constructor(t,r){this._overlayRef=r,this._afterDismissed=new qe,this._afterOpened=new qe,this._onAction=new qe,this._dismissedByAction=!1,this.containerInstance=t,t._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(t){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(t,y$))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}}const RF=new Kt("MatSnackBarData");class KE{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}}let v$=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275dir=Bn({type:e,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"]}),t})(),b$=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275dir=Bn({type:e,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"]}),t})(),x$=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275dir=Bn({type:e,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"]}),t})(),w$=(()=>{var e;class t{constructor(n,s){this.snackBarRef=n,this.data=s}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(V2),xe(RF))},e.\u0275cmp=Ci({type:e,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions","",4,"ngIf"],["matSnackBarActions",""],["mat-button","","matSnackBarAction","",3,"click"]],template:function(n,s){1&n&&(ce(0,"div",0),Te(1),ue(),Ln(2,m$,3,1,"div",1)),2&n&&(we(1),Xn(" ",s.data.message,"\n"),we(1),Be("ngIf",s.hasAction))},dependencies:[Na,k2,v$,b$,x$],styles:[".mat-mdc-simple-snack-bar{display:flex}"],encapsulation:2,changeDetection:0}),t})();const C$={snackBarState:m_("state",[sd("void, hidden",es({transform:"scale(0.8)",opacity:0})),sd("visible",es({transform:"scale(1)",opacity:1})),Tc("* => visible",Dc("150ms cubic-bezier(0, 0, 0.2, 1)")),Tc("* => void, * => hidden",Dc("75ms cubic-bezier(0.4, 0.0, 1, 1)",es({opacity:0})))])};let E$=0,D$=(()=>{var e;class t extends P2{constructor(n,s,u,m,b){super(),this._ngZone=n,this._elementRef=s,this._changeDetectorRef=u,this._platform=m,this.snackBarConfig=b,this._document=Jt(Gi),this._trackedModals=new Set,this._announceDelay=150,this._destroyed=!1,this._onAnnounce=new qe,this._onExit=new qe,this._onEnter=new qe,this._animationState="void",this._liveElementId="mat-snack-bar-container-live-"+E$++,this.attachDomPortal=T=>{this._assertNotAttached();const R=this._portalOutlet.attachDomPortal(T);return this._afterPortalAttached(),R},this._live="assertive"!==b.politeness||b.announcementMessage?"off"===b.politeness?"off":"polite":"assertive",this._platform.FIREFOX&&("polite"===this._live&&(this._role="status"),"assertive"===this._live&&(this._role="alert"))}attachComponentPortal(n){this._assertNotAttached();const s=this._portalOutlet.attachComponentPortal(n);return this._afterPortalAttached(),s}attachTemplatePortal(n){this._assertNotAttached();const s=this._portalOutlet.attachTemplatePortal(n);return this._afterPortalAttached(),s}onAnimationEnd(n){const{fromState:s,toState:u}=n;if(("void"===u&&"void"!==s||"hidden"===u)&&this._completeExit(),"visible"===u){const m=this._onEnter;this._ngZone.run(()=>{m.next(),m.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce())}exit(){return this._ngZone.run(()=>{this._animationState="hidden",this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId)}),this._onExit}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit()}_completeExit(){this._ngZone.onMicrotaskEmpty.pipe(Us(1)).subscribe(()=>{this._ngZone.run(()=>{this._onExit.next(),this._onExit.complete()})})}_afterPortalAttached(){const n=this._elementRef.nativeElement,s=this.snackBarConfig.panelClass;s&&(Array.isArray(s)?s.forEach(u=>n.classList.add(u)):n.classList.add(s)),this._exposeToModals()}_exposeToModals(){const n=this._liveElementId,s=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let u=0;u<s.length;u++){const m=s[u],b=m.getAttribute("aria-owns");this._trackedModals.add(m),b?-1===b.indexOf(n)&&m.setAttribute("aria-owns",b+" "+n):m.setAttribute("aria-owns",n)}}_clearFromModals(){this._trackedModals.forEach(n=>{const s=n.getAttribute("aria-owns");if(s){const u=s.replace(this._liveElementId,"").trim();u.length>0?n.setAttribute("aria-owns",u):n.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{const n=this._elementRef.nativeElement.querySelector("[aria-hidden]"),s=this._elementRef.nativeElement.querySelector("[aria-live]");if(n&&s){let u=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&n.contains(document.activeElement)&&(u=document.activeElement),n.removeAttribute("aria-hidden"),s.appendChild(n),u?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(si),xe(tr),xe(La),xe(Ms),xe(KE))},e.\u0275dir=Bn({type:e,viewQuery:function(n,s){if(1&n&&ul(WE,7),2&n){let u;Oa(u=Fa())&&(s._portalOutlet=u.first)}},features:[ki]}),t})(),T$=(()=>{var e;class t extends D${_afterPortalAttached(){super._afterPortalAttached();const n=this._label.nativeElement,s="mdc-snackbar__label";n.classList.toggle(s,!n.querySelector(`.${s}`))}}return(e=t).\u0275fac=function(){let r;return function(s){return(r||(r=mi(e)))(s||e)}}(),e.\u0275cmp=Ci({type:e,selectors:[["mat-snack-bar-container"]],viewQuery:function(n,s){if(1&n&&ul(g$,7),2&n){let u;Oa(u=Fa())&&(s._label=u.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container","mdc-snackbar--open"],hostVars:1,hostBindings:function(n,s){1&n&&Jp("@state.done",function(m){return s.onAnimationEnd(m)}),2&n&&kf("@state",s._animationState)},features:[ki],decls:6,vars:3,consts:[[1,"mdc-snackbar__surface"],[1,"mat-mdc-snack-bar-label"],["label",""],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(n,s){1&n&&(ce(0,"div",0)(1,"div",1,2)(3,"div",3),Ln(4,_$,0,0,"ng-template",4),ue(),it(5,"div"),ue()()),2&n&&(we(5),Fr("aria-live",s._live)("role",s._role)("id",s._liveElementId))},dependencies:[WE],styles:['.mdc-snackbar{display:none;position:fixed;right:0;bottom:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;pointer-events:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mdc-snackbar--opening,.mdc-snackbar--open,.mdc-snackbar--closing{display:flex}.mdc-snackbar--open .mdc-snackbar__label,.mdc-snackbar--open .mdc-snackbar__actions{visibility:visible}.mdc-snackbar__surface{padding-left:0;padding-right:8px;display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;transform:scale(0.8);opacity:0}.mdc-snackbar__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-snackbar__surface::before{border-color:CanvasText}}[dir=rtl] .mdc-snackbar__surface,.mdc-snackbar__surface[dir=rtl]{padding-left:8px;padding-right:0}.mdc-snackbar--open .mdc-snackbar__surface{transform:scale(1);opacity:1;pointer-events:auto}.mdc-snackbar--closing .mdc-snackbar__surface{transform:scale(1)}.mdc-snackbar__label{padding-left:16px;padding-right:8px;width:100%;flex-grow:1;box-sizing:border-box;margin:0;visibility:hidden;padding-top:14px;padding-bottom:14px}[dir=rtl] .mdc-snackbar__label,.mdc-snackbar__label[dir=rtl]{padding-left:8px;padding-right:16px}.mdc-snackbar__label::before{display:inline;content:attr(data-mdc-snackbar-label-text)}.mdc-snackbar__actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box;visibility:hidden}.mdc-snackbar__action+.mdc-snackbar__dismiss{margin-left:8px;margin-right:0}[dir=rtl] .mdc-snackbar__action+.mdc-snackbar__dismiss,.mdc-snackbar__action+.mdc-snackbar__dismiss[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-snack-bar-container{margin:8px;--mdc-snackbar-container-shape:4px;position:static}.mat-mdc-snack-bar-container .mdc-snackbar__surface{min-width:344px}@media(max-width: 480px),(max-width: 344px){.mat-mdc-snack-bar-container .mdc-snackbar__surface{min-width:100%}}@media(max-width: 480px),(max-width: 344px){.mat-mdc-snack-bar-container{width:100vw}}.mat-mdc-snack-bar-container .mdc-snackbar__surface{max-width:672px}.mat-mdc-snack-bar-container .mdc-snackbar__surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12)}.mat-mdc-snack-bar-container .mdc-snackbar__surface{background-color:var(--mdc-snackbar-container-color)}.mat-mdc-snack-bar-container .mdc-snackbar__surface{border-radius:var(--mdc-snackbar-container-shape)}.mat-mdc-snack-bar-container .mdc-snackbar__label{color:var(--mdc-snackbar-supporting-text-color)}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-size:var(--mdc-snackbar-supporting-text-size);font-family:var(--mdc-snackbar-supporting-text-font);font-weight:var(--mdc-snackbar-supporting-text-weight);line-height:var(--mdc-snackbar-supporting-text-line-height)}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){color:var(--mat-snack-bar-button-color);--mat-mdc-button-persistent-ripple-color: currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{background-color:currentColor;opacity:.1}.mat-mdc-snack-bar-container .mdc-snackbar__label::before{display:none}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-handset .mdc-snackbar__surface{width:100%}'],encapsulation:2,data:{animation:[C$.snackBarState]}}),t})(),PF=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({imports:[z2,O2,hv,pF,ad,ad]}),t})();const OF=new Kt("mat-snack-bar-default-options",{providedIn:"root",factory:function S$(){return new KE}});let M$=(()=>{var e;class t{get _openedSnackBarRef(){const n=this._parentSnackBar;return n?n._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(n){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=n:this._snackBarRefAtThisLevel=n}constructor(n,s,u,m,b,T){this._overlay=n,this._live=s,this._injector=u,this._breakpointObserver=m,this._parentSnackBar=b,this._defaultConfig=T,this._snackBarRefAtThisLevel=null}openFromComponent(n,s){return this._attach(n,s)}openFromTemplate(n,s){return this._attach(n,s)}open(n,s="",u){const m={...this._defaultConfig,...u};return m.data={message:n,action:s},m.announcementMessage===n&&(m.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,m)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(n,s){const m=Xr.create({parent:s&&s.viewContainerRef&&s.viewContainerRef.injector||this._injector,providers:[{provide:KE,useValue:s}]}),b=new Iv(this.snackBarContainerComponent,s.viewContainerRef,m),T=n.attach(b);return T.instance.snackBarConfig=s,T.instance}_attach(n,s){const u={...new KE,...this._defaultConfig,...s},m=this._createOverlay(u),b=this._attachSnackBarContainer(m,u),T=new V2(b,m);if(n instanceof ah){const R=new mF(n,null,{$implicit:u.data,snackBarRef:T});T.instance=b.attachTemplatePortal(R)}else{const R=this._createInjector(u,T),z=new Iv(n,void 0,R),W=b.attachComponentPortal(z);T.instance=W.instance}return this._breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait)").pipe(Wl(m.detachments())).subscribe(R=>{m.overlayElement.classList.toggle(this.handsetCssClass,R.matches)}),u.announcementMessage&&b._onAnnounce.subscribe(()=>{this._live.announce(u.announcementMessage,u.politeness)}),this._animateSnackBar(T,u),this._openedSnackBarRef=T,this._openedSnackBarRef}_animateSnackBar(n,s){n.afterDismissed().subscribe(()=>{this._openedSnackBarRef==n&&(this._openedSnackBarRef=null),s.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{n.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):n.containerInstance.enter(),s.duration&&s.duration>0&&n.afterOpened().subscribe(()=>n._dismissAfter(s.duration))}_createOverlay(n){const s=new B2;s.direction=n.direction;let u=this._overlay.position().global();const m="rtl"===n.direction,b="left"===n.horizontalPosition||"start"===n.horizontalPosition&&!m||"end"===n.horizontalPosition&&m,T=!b&&"center"!==n.horizontalPosition;return b?u.left("0"):T?u.right("0"):u.centerHorizontally(),"top"===n.verticalPosition?u.top("0"):u.bottom("0"),s.positionStrategy=u,this._overlay.create(s)}_createInjector(n,s){return Xr.create({parent:n&&n.viewContainerRef&&n.viewContainerRef.injector||this._injector,providers:[{provide:V2,useValue:s},{provide:RF,useValue:n.data}]})}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(mm),ze(qO),ze(Xr),ze(x2),ze(e,12),ze(OF))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})(),Sc=(()=>{var e;class t extends M${constructor(n,s,u,m,b,T){super(n,s,u,m,b,T),this.simpleSnackBarComponent=w$,this.snackBarContainerComponent=T$,this.handsetCssClass="mat-mdc-snack-bar-handset"}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(mm),ze(qO),ze(Xr),ze(x2),ze(e,12),ze(OF))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:PF}),t})();function Kx(...e){const t=yh(e),{args:r,keys:n}=eP(e),s=new wn(u=>{const{length:m}=r;if(!m)return void u.complete();const b=new Array(m);let T=m,R=m;for(let z=0;z<m;z++){let W=!1;Ai(r[z]).subscribe(ai(u,le=>{W||(W=!0,R--),b[z]=le},()=>T--,void 0,()=>{(!T||!W)&&(R||u.next(n?tP(n,b):b),u.complete())}))}});return t?s.pipe(RM(t)):s}let FF=(()=>{var e;class t{constructor(n,s){this._renderer=n,this._elementRef=s,this.onChange=u=>{},this.onTouched=()=>{}}setProperty(n,s){this._renderer.setProperty(this._elementRef.nativeElement,n,s)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}}return(e=t).\u0275fac=function(n){return new(n||e)(xe($u),xe(tr))},e.\u0275dir=Bn({type:e}),t})(),x_=(()=>{var e;class t extends FF{}return(e=t).\u0275fac=function(){let r;return function(s){return(r||(r=mi(e)))(s||e)}}(),e.\u0275dir=Bn({type:e,features:[ki]}),t})();const mu=new Kt("NgValueAccessor"),I$={provide:mu,useExisting:Ki(()=>pl),multi:!0},R$=new Kt("CompositionEventMode");let pl=(()=>{var e;class t extends FF{constructor(n,s,u){super(n,s),this._compositionMode=u,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function k$(){const e=om()?om().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(n){this.setProperty("value",n??"")}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}}return(e=t).\u0275fac=function(n){return new(n||e)(xe($u),xe(tr),xe(R$,8))},e.\u0275dir=Bn({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,s){1&n&&zt("input",function(m){return s._handleInput(m.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(m){return s._compositionEnd(m.target.value)})},features:[$r([I$]),ki]}),t})();function gm(e){return null==e||("string"==typeof e||Array.isArray(e))&&0===e.length}function NF(e){return null!=e&&"number"==typeof e.length}const $s=new Kt("NgValidators"),_m=new Kt("NgAsyncValidators"),P$=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class O${static min(t){return function BF(e){return t=>{if(gm(t.value)||gm(e))return null;const r=parseFloat(t.value);return!isNaN(r)&&r<e?{min:{min:e,actual:t.value}}:null}}(t)}static max(t){return function zF(e){return t=>{if(gm(t.value)||gm(e))return null;const r=parseFloat(t.value);return!isNaN(r)&&r>e?{max:{max:e,actual:t.value}}:null}}(t)}static required(t){return function VF(e){return gm(e.value)?{required:!0}:null}(t)}static requiredTrue(t){return function jF(e){return!0===e.value?null:{required:!0}}(t)}static email(t){return function UF(e){return gm(e.value)||P$.test(e.value)?null:{email:!0}}(t)}static minLength(t){return function HF(e){return t=>gm(t.value)||!NF(t.value)?null:t.value.length<e?{minlength:{requiredLength:e,actualLength:t.value.length}}:null}(t)}static maxLength(t){return $F(t)}static pattern(t){return function GF(e){if(!e)return QE;let t,r;return"string"==typeof e?(r="","^"!==e.charAt(0)&&(r+="^"),r+=e,"$"!==e.charAt(e.length-1)&&(r+="$"),t=new RegExp(r)):(r=e.toString(),t=e),n=>{if(gm(n.value))return null;const s=n.value;return t.test(s)?null:{pattern:{requiredPattern:r,actualValue:s}}}}(t)}static nullValidator(t){return null}static compose(t){return KF(t)}static composeAsync(t){return QF(t)}}function $F(e){return t=>NF(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null}function QE(e){return null}function qF(e){return null!=e}function WF(e){return Qp(e)?wr(e):e}function ZF(e){let t={};return e.forEach(r=>{t=null!=r?{...t,...r}:t}),0===Object.keys(t).length?null:t}function YF(e,t){return t.map(r=>r(e))}function XF(e){return e.map(t=>function F$(e){return!e.validate}(t)?t:r=>t.validate(r))}function KF(e){if(!e)return null;const t=e.filter(qF);return 0==t.length?null:function(r){return ZF(YF(r,t))}}function j2(e){return null!=e?KF(XF(e)):null}function QF(e){if(!e)return null;const t=e.filter(qF);return 0==t.length?null:function(r){return Kx(YF(r,t).map(WF)).pipe(ii(ZF))}}function U2(e){return null!=e?QF(XF(e)):null}function JF(e,t){return null===e?[t]:Array.isArray(e)?[...e,t]:[e,t]}function H2(e){return e?Array.isArray(e)?e:[e]:[]}function JE(e,t){return Array.isArray(e)?e.includes(t):e===t}function nL(e,t){const r=H2(t);return H2(e).forEach(s=>{JE(r,s)||r.push(s)}),r}function iL(e,t){return H2(t).filter(r=>!JE(e,r))}class rL{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=j2(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=U2(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,r){return!!this.control&&this.control.hasError(t,r)}getError(t,r){return this.control?this.control.getError(t,r):null}}class ml extends rL{get formDirective(){return null}get path(){return null}}class ym extends rL{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class oL{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Mc=(()=>{var e;class t extends oL{constructor(n){super(n)}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(ym,2))},e.\u0275dir=Bn({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,s){2&n&&ie("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[ki]}),t})(),vm=(()=>{var e;class t extends oL{constructor(n){super(n)}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(ml,10))},e.\u0275dir=Bn({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,s){2&n&&ie("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[ki]}),t})();const Qx="VALID",tD="INVALID",kv="PENDING",Jx="DISABLED";function q2(e){return(nD(e)?e.validators:e)||null}function W2(e,t){return(nD(t)?t.asyncValidators:e)||null}function nD(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}class cL{constructor(t,r){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(t),this._assignAsyncValidators(r)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===Qx}get invalid(){return this.status===tD}get pending(){return this.status==kv}get disabled(){return this.status===Jx}get enabled(){return this.status!==Jx}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(nL(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(nL(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(iL(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(iL(t,this._rawAsyncValidators))}hasValidator(t){return JE(this._rawValidators,t)}hasAsyncValidator(t){return JE(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(r=>{r.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=kv,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const r=this._parentMarkedDirty(t.onlySelf);this.status=Jx,this.errors=null,this._forEachChild(n=>{n.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:r}),this._onDisabledChange.forEach(n=>n(!0))}enable(t={}){const r=this._parentMarkedDirty(t.onlySelf);this.status=Qx,this._forEachChild(n=>{n.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:r}),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Qx||this.status===kv)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(r=>r._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Jx:Qx}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=kv,this._hasOwnPendingAsyncValidator=!0;const r=WF(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,r={}){this.errors=t,this._updateControlsErrors(!1!==r.emitEvent)}get(t){let r=t;return null==r||(Array.isArray(r)||(r=r.split(".")),0===r.length)?null:r.reduce((n,s)=>n&&n._find(s),this)}getError(t,r){const n=r?this.get(r):this;return n&&n.errors?n.errors[t]:null}hasError(t,r){return!!this.getError(t,r)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Wn,this.statusChanges=new Wn}_calculateStatus(){return this._allControlsDisabled()?Jx:this.errors?tD:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(kv)?kv:this._anyControlsHaveStatus(tD)?tD:Qx}_anyControlsHaveStatus(t){return this._anyControls(r=>r.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){nD(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=function z$(e){return Array.isArray(e)?j2(e):e||null}(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=function V$(e){return Array.isArray(e)?U2(e):e||null}(this._rawAsyncValidators)}}class Z2 extends cL{constructor(t,r,n){super(q2(r),W2(n,r)),this.controls=t,this._initObservables(),this._setUpdateStrategy(r),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,r){return this.controls[t]?this.controls[t]:(this.controls[t]=r,r.setParent(this),r._registerOnCollectionChange(this._onCollectionChange),r)}addControl(t,r,n={}){this.registerControl(t,r),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(t,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}setControl(t,r,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],r&&this.registerControl(t,r),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,r={}){(function lL(e,t,r){e._forEachChild((n,s)=>{if(void 0===r[s])throw new yt(1002,"")})})(this,0,t),Object.keys(t).forEach(n=>{(function aL(e,t,r){const n=e.controls;if(!(t?Object.keys(n):n).length)throw new yt(1e3,"");if(!n[r])throw new yt(1001,"")})(this,!0,n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r)}patchValue(t,r={}){null!=t&&(Object.keys(t).forEach(n=>{const s=this.controls[n];s&&s.patchValue(t[n],{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r))}reset(t={},r={}){this._forEachChild((n,s)=>{n.reset(t[s],{onlySelf:!0,emitEvent:r.emitEvent})}),this._updatePristine(r),this._updateTouched(r),this.updateValueAndValidity(r)}getRawValue(){return this._reduceChildren({},(t,r,n)=>(t[n]=r.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(r,n)=>!!n._syncPendingControls()||r);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(r=>{const n=this.controls[r];n&&t(n,r)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[r,n]of Object.entries(this.controls))if(this.contains(r)&&t(n))return!0;return!1}_reduceValue(){return this._reduceChildren({},(r,n,s)=>((n.enabled||this.disabled)&&(r[s]=n.value),r))}_reduceChildren(t,r){let n=t;return this._forEachChild((s,u)=>{n=r(n,s,u)}),n}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}const Rv=new Kt("CallSetDisabledState",{providedIn:"root",factory:()=>iD}),iD="always";function e1(e,t,r=iD){Y2(e,t),t.valueAccessor.writeValue(e.value),(e.disabled||"always"===r)&&t.valueAccessor.setDisabledState?.(e.disabled),function H$(e,t){t.valueAccessor.registerOnChange(r=>{e._pendingValue=r,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&uL(e,t)})}(e,t),function G$(e,t){const r=(n,s)=>{t.valueAccessor.writeValue(n),s&&t.viewToModelUpdate(n)};e.registerOnChange(r),t._registerOnDestroy(()=>{e._unregisterOnChange(r)})}(e,t),function $$(e,t){t.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&uL(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function U$(e,t){if(t.valueAccessor.setDisabledState){const r=n=>{t.valueAccessor.setDisabledState(n)};e.registerOnDisabledChange(r),t._registerOnDestroy(()=>{e._unregisterOnDisabledChange(r)})}}(e,t)}function sD(e,t){e.forEach(r=>{r.registerOnValidatorChange&&r.registerOnValidatorChange(t)})}function Y2(e,t){const r=function eL(e){return e._rawValidators}(e);null!==t.validator?e.setValidators(JF(r,t.validator)):"function"==typeof r&&e.setValidators([r]);const n=function tL(e){return e._rawAsyncValidators}(e);null!==t.asyncValidator?e.setAsyncValidators(JF(n,t.asyncValidator)):"function"==typeof n&&e.setAsyncValidators([n]);const s=()=>e.updateValueAndValidity();sD(t._rawValidators,s),sD(t._rawAsyncValidators,s)}function uL(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}const X$={provide:ml,useExisting:Ki(()=>fh)},t1=(()=>Promise.resolve())();let fh=(()=>{var e;class t extends ml{constructor(n,s,u){super(),this.callSetDisabledState=u,this.submitted=!1,this._directives=new Set,this.ngSubmit=new Wn,this.form=new Z2({},j2(n),U2(s))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(n){t1.then(()=>{const s=this._findContainer(n.path);n.control=s.registerControl(n.name,n.control),e1(n.control,n,this.callSetDisabledState),n.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(n)})}getControl(n){return this.form.get(n.path)}removeControl(n){t1.then(()=>{const s=this._findContainer(n.path);s&&s.removeControl(n.name),this._directives.delete(n)})}addFormGroup(n){t1.then(()=>{const s=this._findContainer(n.path),u=new Z2({});(function dL(e,t){Y2(e,t)})(u,n),s.registerControl(n.name,u),u.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(n){t1.then(()=>{const s=this._findContainer(n.path);s&&s.removeControl(n.name)})}getFormGroup(n){return this.form.get(n.path)}updateModel(n,s){t1.then(()=>{this.form.get(n.path).setValue(s)})}setValue(n){this.control.setValue(n)}onSubmit(n){return this.submitted=!0,function hL(e,t){e._syncPendingControls(),t.forEach(r=>{const n=r.control;"submit"===n.updateOn&&n._pendingChange&&(r.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(n),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(n){return n.pop(),n.length?this.form.get(n):this.form}}return(e=t).\u0275fac=function(n){return new(n||e)(xe($s,10),xe(_m,10),xe(Rv,8))},e.\u0275dir=Bn({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(n,s){1&n&&zt("submit",function(m){return s.onSubmit(m)})("reset",function(){return s.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[$r([X$]),ki]}),t})();function fL(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}function pL(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}const mL=class extends cL{constructor(t=null,r,n){super(q2(r),W2(n,r)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(r),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),nD(r)&&(r.nonNullable||r.initialValueIsDefault)&&(this.defaultValue=pL(t)?t.value:t)}setValue(t,r={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==r.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==r.emitViewToModelChange)),this.updateValueAndValidity(r)}patchValue(t,r={}){this.setValue(t,r)}reset(t=this.defaultValue,r={}){this._applyFormState(t),this.markAsPristine(r),this.markAsUntouched(r),this.setValue(this.value,r),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){fL(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){fL(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){pL(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}},J$={provide:ym,useExisting:Ki(()=>Zl)},yL=(()=>Promise.resolve())();let Zl=(()=>{var e;class t extends ym{constructor(n,s,u,m,b,T){super(),this._changeDetectorRef=b,this.callSetDisabledState=T,this.control=new mL,this._registered=!1,this.name="",this.update=new Wn,this._parent=n,this._setValidators(s),this._setAsyncValidators(u),this.valueAccessor=function Q2(e,t){if(!t)return null;let r,n,s;return Array.isArray(t),t.forEach(u=>{u.constructor===pl?r=u:function Z$(e){return Object.getPrototypeOf(e.constructor)===x_}(u)?n=u:s=u}),s||n||r||null}(0,m)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){const s=n.name.previousValue;this.formDirective.removeControl({name:s,path:this._getPath(s)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),function K2(e,t){if(!e.hasOwnProperty("model"))return!1;const r=e.model;return!!r.isFirstChange()||!Object.is(t,r.currentValue)}(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){e1(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(n){yL.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){const s=n.isDisabled.currentValue,u=0!==s&&uv(s);yL.then(()=>{u&&!this.control.disabled?this.control.disable():!u&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?function rD(e,t){return[...t.path,e]}(n,this._parent):[n]}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(ml,9),xe($s,10),xe(_m,10),xe(mu,10),xe(La,8),xe(Rv,8))},e.\u0275dir=Bn({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[$r([J$]),ki,v]}),t})(),bm=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275dir=Bn({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const e7={provide:mu,useExisting:Ki(()=>J2),multi:!0};let J2=(()=>{var e;class t extends x_{writeValue(n){this.setProperty("value",n??"")}registerOnChange(n){this.onChange=s=>{n(""==s?null:parseFloat(s))}}}return(e=t).\u0275fac=function(){let r;return function(s){return(r||(r=mi(e)))(s||e)}}(),e.\u0275dir=Bn({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(n,s){1&n&&zt("input",function(m){return s.onChange(m.target.value)})("blur",function(){return s.onTouched()})},features:[$r([e7]),ki]}),t})(),vL=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({}),t})();const c7={provide:mu,useExisting:Ki(()=>w_),multi:!0};function TL(e,t){return null==e?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let w_=(()=>{var e;class t extends x_{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;const u=TL(this._getOptionId(n),n);this.setProperty("value",u)}registerOnChange(n){this.onChange=s=>{this.value=this._getOptionValue(s),n(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(n){for(const s of this._optionMap.keys())if(this._compareWith(this._optionMap.get(s),n))return s;return null}_getOptionValue(n){const s=function u7(e){return e.split(":")[0]}(n);return this._optionMap.has(s)?this._optionMap.get(s):n}}return(e=t).\u0275fac=function(){let r;return function(s){return(r||(r=mi(e)))(s||e)}}(),e.\u0275dir=Bn({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,s){1&n&&zt("change",function(m){return s.onChange(m.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[$r([c7]),ki]}),t})(),n1=(()=>{var e;class t{constructor(n,s,u){this._element=n,this._renderer=s,this._select=u,this._select&&(this.id=this._select._registerOption())}set ngValue(n){null!=this._select&&(this._select._optionMap.set(this.id,n),this._setElementValue(TL(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._setElementValue(n),this._select&&this._select.writeValue(this._select.value)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(tr),xe($u),xe(w_,9))},e.\u0275dir=Bn({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const d7={provide:mu,useExisting:Ki(()=>iA),multi:!0};function SL(e,t){return null==e?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let iA=(()=>{var e;class t extends x_{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){let s;if(this.value=n,Array.isArray(n)){const u=n.map(m=>this._getOptionId(m));s=(m,b)=>{m._setSelected(u.indexOf(b.toString())>-1)}}else s=(u,m)=>{u._setSelected(!1)};this._optionMap.forEach(s)}registerOnChange(n){this.onChange=s=>{const u=[],m=s.selectedOptions;if(void 0!==m){const b=m;for(let T=0;T<b.length;T++){const z=this._getOptionValue(b[T].value);u.push(z)}}else{const b=s.options;for(let T=0;T<b.length;T++){const R=b[T];if(R.selected){const z=this._getOptionValue(R.value);u.push(z)}}}this.value=u,n(u)}}_registerOption(n){const s=(this._idCounter++).toString();return this._optionMap.set(s,n),s}_getOptionId(n){for(const s of this._optionMap.keys())if(this._compareWith(this._optionMap.get(s)._value,n))return s;return null}_getOptionValue(n){const s=function h7(e){return e.split(":")[0]}(n);return this._optionMap.has(s)?this._optionMap.get(s)._value:n}}return(e=t).\u0275fac=function(){let r;return function(s){return(r||(r=mi(e)))(s||e)}}(),e.\u0275dir=Bn({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,s){1&n&&zt("change",function(m){return s.onChange(m.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[$r([d7]),ki]}),t})(),r1=(()=>{var e;class t{constructor(n,s,u){this._element=n,this._renderer=s,this._select=u,this._select&&(this.id=this._select._registerOption(this))}set ngValue(n){null!=this._select&&(this._value=n,this._setElementValue(SL(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._select?(this._value=n,this._setElementValue(SL(this.id,n)),this._select.writeValue(this._select.value)):this._setElementValue(n)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}_setSelected(n){this._renderer.setProperty(this._element.nativeElement,"selected",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(tr),xe($u),xe(iA,9))},e.\u0275dir=Bn({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();let C_=(()=>{var e;class t{constructor(){this._validator=QE}ngOnChanges(n){if(this.inputName in n){const s=this.normalizeInput(n[this.inputName].currentValue);this._enabled=this.enabled(s),this._validator=this._enabled?this.createValidator(s):QE,this._onChange&&this._onChange()}}validate(n){return this._validator(n)}registerOnValidatorChange(n){this._onChange=n}enabled(n){return null!=n}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275dir=Bn({type:e,features:[v]}),t})();const v7={provide:$s,useExisting:Ki(()=>sA),multi:!0};let sA=(()=>{var e;class t extends C_{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=n=>function ML(e){return"number"==typeof e?e:parseInt(e,10)}(n),this.createValidator=n=>$F(n)}}return(e=t).\u0275fac=function(){let r;return function(s){return(r||(r=mi(e)))(s||e)}}(),e.\u0275dir=Bn({type:e,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(n,s){2&n&&Fr("maxlength",s._enabled?s.maxlength:null)},inputs:{maxlength:"maxlength"},features:[$r([v7]),ki]}),t})(),x7=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({imports:[vL]}),t})(),C7=(()=>{var e;class t{static withConfig(n){return{ngModule:t,providers:[{provide:Rv,useValue:n.callSetDisabledState??iD}]}}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({imports:[x7]}),t})();const E7=["tooltip"],FL=new Kt("mat-tooltip-scroll-strategy"),S7={provide:FL,deps:[mm],useFactory:function T7(e){return()=>e.scrollStrategies.reposition({scrollThrottle:20})}},A7=new Kt("mat-tooltip-default-options",{providedIn:"root",factory:function M7(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}}),LL="tooltip-panel",NL=hm({passive:!0});let F7=(()=>{var e;class t{get position(){return this._position}set position(n){n!==this._position&&(this._position=n,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(n){this._positionAtOrigin=aa(n),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(n){this._disabled=aa(n),this._disabled?this.hide(0):this._setupPointerEnterEventsIfNeeded()}get showDelay(){return this._showDelay}set showDelay(n){this._showDelay=g2(n)}get hideDelay(){return this._hideDelay}set hideDelay(n){this._hideDelay=g2(n),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(n){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message,"tooltip"),this._message=null!=n?String(n).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage(),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}get tooltipClass(){return this._tooltipClass}set tooltipClass(n){this._tooltipClass=n,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}constructor(n,s,u,m,b,T,R,z,W,le,he,Me){this._overlay=n,this._elementRef=s,this._scrollDispatcher=u,this._viewContainerRef=m,this._ngZone=b,this._platform=T,this._ariaDescriber=R,this._focusMonitor=z,this._dir=le,this._defaultOptions=he,this._position="below",this._positionAtOrigin=!1,this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._viewportMargin=8,this._cssClassPrefix="mat",this.touchGestures="auto",this._message="",this._passiveListeners=[],this._destroyed=new qe,this._scrollStrategy=W,this._document=Me,he&&(this._showDelay=he.showDelay,this._hideDelay=he.hideDelay,he.position&&(this.position=he.position),he.positionAtOrigin&&(this.positionAtOrigin=he.positionAtOrigin),he.touchGestures&&(this.touchGestures=he.touchGestures)),le.change.pipe(Wl(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(Wl(this._destroyed)).subscribe(n=>{n?"keyboard"===n&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){const n=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([s,u])=>{n.removeEventListener(s,u,NL)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(n,this.message,"tooltip"),this._focusMonitor.stopMonitoring(n)}show(n=this.showDelay,s){if(this.disabled||!this.message||this._isTooltipVisible())return void this._tooltipInstance?._cancelPendingAnimations();const u=this._createOverlay(s);this._detach(),this._portal=this._portal||new Iv(this._tooltipComponent,this._viewContainerRef);const m=this._tooltipInstance=u.attach(this._portal).instance;m._triggerElement=this._elementRef.nativeElement,m._mouseLeaveHideDelay=this._hideDelay,m.afterHidden().pipe(Wl(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),m.show(n)}hide(n=this.hideDelay){const s=this._tooltipInstance;s&&(s.isVisible()?s.hide(n):(s._cancelPendingAnimations(),this._detach()))}toggle(n){this._isTooltipVisible()?this.hide():this.show(void 0,n)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(n){if(this._overlayRef){const m=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!n)&&m._origin instanceof tr)return this._overlayRef;this._detach()}const s=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),u=this._overlay.position().flexibleConnectedTo(this.positionAtOrigin&&n||this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(s);return u.positionChanges.pipe(Wl(this._destroyed)).subscribe(m=>{this._updateCurrentPositionClass(m.connectionPair),this._tooltipInstance&&m.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:u,panelClass:`${this._cssClassPrefix}-${LL}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(Wl(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(Wl(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(Wl(this._destroyed)).subscribe(m=>{this._isTooltipVisible()&&27===m.keyCode&&!y_(m)&&(m.preventDefault(),m.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(n){const s=n.getConfig().positionStrategy,u=this._getOrigin(),m=this._getOverlayPosition();s.withPositions([this._addOffset({...u.main,...m.main}),this._addOffset({...u.fallback,...m.fallback})])}_addOffset(n){return n}_getOrigin(){const n=!this._dir||"ltr"==this._dir.value,s=this.position;let u;"above"==s||"below"==s?u={originX:"center",originY:"above"==s?"top":"bottom"}:"before"==s||"left"==s&&n||"right"==s&&!n?u={originX:"start",originY:"center"}:("after"==s||"right"==s&&n||"left"==s&&!n)&&(u={originX:"end",originY:"center"});const{x:m,y:b}=this._invertPosition(u.originX,u.originY);return{main:u,fallback:{originX:m,originY:b}}}_getOverlayPosition(){const n=!this._dir||"ltr"==this._dir.value,s=this.position;let u;"above"==s?u={overlayX:"center",overlayY:"bottom"}:"below"==s?u={overlayX:"center",overlayY:"top"}:"before"==s||"left"==s&&n||"right"==s&&!n?u={overlayX:"end",overlayY:"center"}:("after"==s||"right"==s&&n||"left"==s&&!n)&&(u={overlayX:"start",overlayY:"center"});const{x:m,y:b}=this._invertPosition(u.overlayX,u.overlayY);return{main:u,fallback:{overlayX:m,overlayY:b}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.pipe(Us(1),Wl(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()}))}_setTooltipClass(n){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=n,this._tooltipInstance._markForCheck())}_invertPosition(n,s){return"above"===this.position||"below"===this.position?"top"===s?s="bottom":"bottom"===s&&(s="top"):"end"===n?n="start":"start"===n&&(n="end"),{x:n,y:s}}_updateCurrentPositionClass(n){const{overlayY:s,originX:u,originY:m}=n;let b;if(b="center"===s?this._dir&&"rtl"===this._dir.value?"end"===u?"left":"right":"start"===u?"left":"right":"bottom"===s&&"top"===m?"above":"below",b!==this._currentPosition){const T=this._overlayRef;if(T){const R=`${this._cssClassPrefix}-${LL}-`;T.removePanelClass(R+this._currentPosition),T.addPanelClass(R+b)}this._currentPosition=b}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",n=>{let s;this._setupPointerExitEventsIfNeeded(),void 0!==n.x&&void 0!==n.y&&(s=n),this.show(void 0,s)}]):"off"!==this.touchGestures&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",n=>{const s=n.targetTouches?.[0],u=s?{x:s.clientX,y:s.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(void 0,u),500)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;const n=[];if(this._platformSupportsMouseEvents())n.push(["mouseleave",s=>{const u=s.relatedTarget;(!u||!this._overlayRef?.overlayElement.contains(u))&&this.hide()}],["wheel",s=>this._wheelListener(s)]);else if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const s=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};n.push(["touchend",s],["touchcancel",s])}this._addListeners(n),this._passiveListeners.push(...n)}_addListeners(n){n.forEach(([s,u])=>{this._elementRef.nativeElement.addEventListener(s,u,NL)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(n){if(this._isTooltipVisible()){const s=this._document.elementFromPoint(n.clientX,n.clientY),u=this._elementRef.nativeElement;s!==u&&!u.contains(s)&&this.hide()}}_disableNativeGesturesIfNecessary(){const n=this.touchGestures;if("off"!==n){const s=this._elementRef.nativeElement,u=s.style;("on"===n||"INPUT"!==s.nodeName&&"TEXTAREA"!==s.nodeName)&&(u.userSelect=u.msUserSelect=u.webkitUserSelect=u.MozUserSelect="none"),("on"===n||!s.draggable)&&(u.webkitUserDrag="none"),u.touchAction="none",u.webkitTapHighlightColor="transparent"}}}return(e=t).\u0275fac=function(n){ol()},e.\u0275dir=Bn({type:e,inputs:{position:["matTooltipPosition","position"],positionAtOrigin:["matTooltipPositionAtOrigin","positionAtOrigin"],disabled:["matTooltipDisabled","disabled"],showDelay:["matTooltipShowDelay","showDelay"],hideDelay:["matTooltipHideDelay","hideDelay"],touchGestures:["matTooltipTouchGestures","touchGestures"],message:["matTooltip","message"],tooltipClass:["matTooltipClass","tooltipClass"]}}),t})(),Pv=(()=>{var e;class t extends F7{constructor(n,s,u,m,b,T,R,z,W,le,he,Me){super(n,s,u,m,b,T,R,z,W,le,he,Me),this._tooltipComponent=N7,this._cssClassPrefix="mat-mdc",this._viewportMargin=8}_addOffset(n){const u=!this._dir||"ltr"==this._dir.value;return"top"===n.originY?n.offsetY=-8:"bottom"===n.originY?n.offsetY=8:"start"===n.originX?n.offsetX=u?-8:8:"end"===n.originX&&(n.offsetX=u?8:-8),n}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(mm),xe(tr),xe(vF),xe(Hl),xe(si),xe(Ms),xe(R8),xe(E2),xe(FL),xe(Av,8),xe(A7,8),xe(Gi))},e.\u0275dir=Bn({type:e,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(n,s){2&n&&ie("mat-mdc-tooltip-disabled",s.disabled)},exportAs:["matTooltip"],features:[ki]}),t})(),L7=(()=>{var e;class t{constructor(n,s){this._changeDetectorRef=n,this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new qe,this._animationsDisabled="NoopAnimations"===s}show(n){null!=this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},n)}hide(n){null!=this._showTimeoutId&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},n)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:n}){(!n||!this._triggerElement.contains(n))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){}_handleAnimationEnd({animationName:n}){(n===this._showAnimation||n===this._hideAnimation)&&this._finalizeAnimation(n===this._showAnimation)}_cancelPendingAnimations(){null!=this._showTimeoutId&&clearTimeout(this._showTimeoutId),null!=this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(n){n?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(n){const s=this._tooltip.nativeElement,u=this._showAnimation,m=this._hideAnimation;if(s.classList.remove(n?m:u),s.classList.add(n?u:m),this._isVisible=n,n&&!this._animationsDisabled&&"function"==typeof getComputedStyle){const b=getComputedStyle(s);("0s"===b.getPropertyValue("animation-duration")||"none"===b.getPropertyValue("animation-name"))&&(this._animationsDisabled=!0)}n&&this._onShow(),this._animationsDisabled&&(s.classList.add("_mat-animation-noopable"),this._finalizeAnimation(n))}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(La),xe(oa,8))},e.\u0275dir=Bn({type:e}),t})(),N7=(()=>{var e;class t extends L7{constructor(n,s,u){super(n,u),this._elementRef=s,this._isMultiline=!1,this._showAnimation="mat-mdc-tooltip-show",this._hideAnimation="mat-mdc-tooltip-hide"}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){const n=this._elementRef.nativeElement.getBoundingClientRect();return n.height>24&&n.width>=200}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(La),xe(tr),xe(oa,8))},e.\u0275cmp=Ci({type:e,selectors:[["mat-tooltip-component"]],viewQuery:function(n,s){if(1&n&&ul(E7,7),2&n){let u;Oa(u=Fa())&&(s._tooltip=u.first)}},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(n,s){1&n&&zt("mouseleave",function(m){return s._handleMouseLeave(m)}),2&n&&te("zoom",s.isVisible()?1:null)},features:[ki],decls:4,vars:4,consts:[[1,"mdc-tooltip","mdc-tooltip--shown","mat-mdc-tooltip",3,"ngClass","animationend"],["tooltip",""],[1,"mdc-tooltip__surface","mdc-tooltip__surface-animation"]],template:function(n,s){1&n&&(ce(0,"div",0,1),zt("animationend",function(m){return s._handleAnimationEnd(m)}),ce(2,"div",2),Te(3),ue()()),2&n&&(ie("mdc-tooltip--multiline",s._isMultiline),Be("ngClass",s.tooltipClass),we(3),hn(s.message))},dependencies:[px],styles:['.mdc-tooltip__surface{word-break:break-all;word-break:var(--mdc-tooltip-word-break, normal);overflow-wrap:anywhere}.mdc-tooltip--showing-transition .mdc-tooltip__surface-animation{transition:opacity 150ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-tooltip--hide-transition .mdc-tooltip__surface-animation{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-tooltip{position:fixed;display:none;z-index:9}.mdc-tooltip-wrapper--rich{position:relative}.mdc-tooltip--shown,.mdc-tooltip--showing,.mdc-tooltip--hide{display:inline-flex}.mdc-tooltip--shown.mdc-tooltip--rich,.mdc-tooltip--showing.mdc-tooltip--rich,.mdc-tooltip--hide.mdc-tooltip--rich{display:inline-block;left:-320px;position:absolute}.mdc-tooltip__surface{line-height:16px;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center}.mdc-tooltip__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-tooltip__surface::before{border-color:CanvasText}}.mdc-tooltip--rich .mdc-tooltip__surface{align-items:flex-start;display:flex;flex-direction:column;min-height:24px;min-width:40px;max-width:320px;position:relative}.mdc-tooltip--multiline .mdc-tooltip__surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mdc-tooltip__surface,.mdc-tooltip--multiline .mdc-tooltip__surface[dir=rtl]{text-align:right}.mdc-tooltip__surface .mdc-tooltip__title{margin:0 8px}.mdc-tooltip__surface .mdc-tooltip__content{max-width:calc(200px - (2 * 8px));margin:8px;text-align:left}[dir=rtl] .mdc-tooltip__surface .mdc-tooltip__content,.mdc-tooltip__surface .mdc-tooltip__content[dir=rtl]{text-align:right}.mdc-tooltip--rich .mdc-tooltip__surface .mdc-tooltip__content{max-width:calc(320px - (2 * 8px));align-self:stretch}.mdc-tooltip__surface .mdc-tooltip__content-link{text-decoration:none}.mdc-tooltip--rich-actions,.mdc-tooltip__content,.mdc-tooltip__title{z-index:1}.mdc-tooltip__surface-animation{opacity:0;transform:scale(0.8);will-change:transform,opacity}.mdc-tooltip--shown .mdc-tooltip__surface-animation{transform:scale(1);opacity:1}.mdc-tooltip--hide .mdc-tooltip__surface-animation{transform:scale(1)}.mdc-tooltip__caret-surface-top,.mdc-tooltip__caret-surface-bottom{position:absolute;height:24px;width:24px;transform:rotate(35deg) skewY(20deg) scaleX(0.9396926208)}.mdc-tooltip__caret-surface-top .mdc-elevation-overlay,.mdc-tooltip__caret-surface-bottom .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-tooltip__caret-surface-bottom{box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12);outline:1px solid rgba(0,0,0,0);z-index:-1}@media screen and (forced-colors: active){.mdc-tooltip__caret-surface-bottom{outline-color:CanvasText}}.mat-mdc-tooltip{--mdc-plain-tooltip-container-shape:4px;--mdc-plain-tooltip-supporting-text-line-height:16px}.mat-mdc-tooltip .mdc-tooltip__surface{background-color:var(--mdc-plain-tooltip-container-color)}.mat-mdc-tooltip .mdc-tooltip__surface{border-radius:var(--mdc-plain-tooltip-container-shape)}.mat-mdc-tooltip .mdc-tooltip__caret-surface-top,.mat-mdc-tooltip .mdc-tooltip__caret-surface-bottom{border-radius:var(--mdc-plain-tooltip-container-shape)}.mat-mdc-tooltip .mdc-tooltip__surface{color:var(--mdc-plain-tooltip-supporting-text-color)}.mat-mdc-tooltip .mdc-tooltip__surface{font-family:var(--mdc-plain-tooltip-supporting-text-font);line-height:var(--mdc-plain-tooltip-supporting-text-line-height);font-size:var(--mdc-plain-tooltip-supporting-text-size);font-weight:var(--mdc-plain-tooltip-supporting-text-weight);letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking)}.mat-mdc-tooltip{position:relative;transform:scale(0)}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}'],encapsulation:2,changeDetection:0}),t})(),B7=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({providers:[S7],imports:[XO,hv,z2,ad,ad,XE]}),t})();function o1(e){return(o1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function xt(e,t,r){return(t=function V7(e){var t=function z7(e,t){if("object"!==o1(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==o1(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===o1(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class j7 extends qe{constructor(t=1/0,r=1/0,n=y2){super(),this._bufferSize=t,this._windowTime=r,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=r===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,r)}next(t){const{isStopped:r,_buffer:n,_infiniteTimeWindow:s,_timestampProvider:u,_windowTime:m}=this;r||(n.push(t),!s&&n.push(u.now()+m)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const r=this._innerSubscribe(t),{_infiniteTimeWindow:n,_buffer:s}=this,u=s.slice();for(let m=0;m<u.length&&!t.closed;m+=n?1:2)t.next(u[m]);return this._checkFinalizedStatuses(t),r}_trimBuffer(){const{_bufferSize:t,_timestampProvider:r,_buffer:n,_infiniteTimeWindow:s}=this,u=(s?1:2)*t;if(t<1/0&&u<n.length&&n.splice(0,n.length-u),!s){const m=r.now();let b=0;for(let T=1;T<n.length&&n[T]<=m;T+=2)b=T;b&&n.splice(0,b+1)}}}function BL(e,t,r){let n,s=!1;return e&&"object"==typeof e?({bufferSize:n=1/0,windowTime:t=1/0,refCount:s=!1,scheduler:r}=e):n=e??1/0,bh({connector:()=>new j7(n,t,r),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:s})}class s1{}let zL=(()=>{var e;class t extends s1{getTranslation(n){return Gn({})}}return e=t,xt(t,"\u0275fac",function(){let r;return function(s){return(r||(r=mi(e)))(s||e)}}()),xt(t,"\u0275prov",Ut({token:e,factory:e.\u0275fac})),t})();class aA{}let VL=(()=>{var e;class t{handle(n){return n.key}}return e=t,xt(t,"\u0275fac",function(n){return new(n||e)}),xt(t,"\u0275prov",Ut({token:e,factory:e.\u0275fac})),t})();function lD(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e!=e&&t!=t)return!0;let s,u,m,r=typeof e;if(r==typeof t&&"object"==r){if(!Array.isArray(e)){if(Array.isArray(t))return!1;for(u in m=Object.create(null),e){if(!lD(e[u],t[u]))return!1;m[u]=!0}for(u in t)if(!(u in m)&&typeof t[u]<"u")return!1;return!0}if(!Array.isArray(t))return!1;if((s=e.length)==t.length){for(u=0;u<s;u++)if(!lD(e[u],t[u]))return!1;return!0}}return!1}function xm(e){return typeof e<"u"&&null!==e}function lA(e){return e&&"object"==typeof e&&!Array.isArray(e)}function jL(e,t){let r=Object.assign({},e);return lA(e)&&lA(t)&&Object.keys(t).forEach(n=>{lA(t[n])?n in e?r[n]=jL(e[n],t[n]):Object.assign(r,{[n]:t[n]}):Object.assign(r,{[n]:t[n]})}),r}class cD{}let UL=(()=>{var e;class t extends cD{constructor(...n){super(...n),xt(this,"templateMatcher",/{{\s?([^{}\s]*)\s?}}/g)}interpolate(n,s){let u;return u="string"==typeof n?this.interpolateString(n,s):"function"==typeof n?this.interpolateFunction(n,s):n,u}getValue(n,s){let u="string"==typeof s?s.split("."):[s];s="";do{s+=u.shift(),!xm(n)||!xm(n[s])||"object"!=typeof n[s]&&u.length?u.length?s+=".":n=void 0:(n=n[s],s="")}while(u.length);return n}interpolateFunction(n,s){return n(s)}interpolateString(n,s){return s?n.replace(this.templateMatcher,(u,m)=>{let b=this.getValue(s,m);return xm(b)?b:u}):n}}return e=t,xt(t,"\u0275fac",function(){let r;return function(s){return(r||(r=mi(e)))(s||e)}}()),xt(t,"\u0275prov",Ut({token:e,factory:e.\u0275fac})),t})();class uD{}let HL=(()=>{var e;class t extends uD{compile(n,s){return n}compileTranslations(n,s){return n}}return e=t,xt(t,"\u0275fac",function(){let r;return function(s){return(r||(r=mi(e)))(s||e)}}()),xt(t,"\u0275prov",Ut({token:e,factory:e.\u0275fac})),t})();class $L{constructor(){xt(this,"defaultLang",void 0),xt(this,"currentLang",this.defaultLang),xt(this,"translations",{}),xt(this,"langs",[]),xt(this,"onTranslationChange",new Wn),xt(this,"onLangChange",new Wn),xt(this,"onDefaultLangChange",new Wn)}}const cA=new Kt("USE_STORE"),uA=new Kt("USE_DEFAULT_LANG"),dA=new Kt("DEFAULT_LANGUAGE"),hA=new Kt("USE_EXTEND");let a1=(()=>{var e;class t{get onTranslationChange(){return this.isolate?this._onTranslationChange:this.store.onTranslationChange}get onLangChange(){return this.isolate?this._onLangChange:this.store.onLangChange}get onDefaultLangChange(){return this.isolate?this._onDefaultLangChange:this.store.onDefaultLangChange}get defaultLang(){return this.isolate?this._defaultLang:this.store.defaultLang}set defaultLang(n){this.isolate?this._defaultLang=n:this.store.defaultLang=n}get currentLang(){return this.isolate?this._currentLang:this.store.currentLang}set currentLang(n){this.isolate?this._currentLang=n:this.store.currentLang=n}get langs(){return this.isolate?this._langs:this.store.langs}set langs(n){this.isolate?this._langs=n:this.store.langs=n}get translations(){return this.isolate?this._translations:this.store.translations}set translations(n){this.isolate?this._translations=n:this.store.translations=n}constructor(n,s,u,m,b,T=!0,R=!1,z=!1,W){xt(this,"store",void 0),xt(this,"currentLoader",void 0),xt(this,"compiler",void 0),xt(this,"parser",void 0),xt(this,"missingTranslationHandler",void 0),xt(this,"useDefaultLang",void 0),xt(this,"isolate",void 0),xt(this,"extend",void 0),xt(this,"loadingTranslations",void 0),xt(this,"pending",!1),xt(this,"_onTranslationChange",new Wn),xt(this,"_onLangChange",new Wn),xt(this,"_onDefaultLangChange",new Wn),xt(this,"_defaultLang",void 0),xt(this,"_currentLang",void 0),xt(this,"_langs",[]),xt(this,"_translations",{}),xt(this,"_translationRequests",{}),this.store=n,this.currentLoader=s,this.compiler=u,this.parser=m,this.missingTranslationHandler=b,this.useDefaultLang=T,this.isolate=R,this.extend=z,W&&this.setDefaultLang(W)}setDefaultLang(n){if(n===this.defaultLang)return;let s=this.retrieveTranslations(n);typeof s<"u"?(null==this.defaultLang&&(this.defaultLang=n),s.pipe(Us(1)).subscribe(u=>{this.changeDefaultLang(n)})):this.changeDefaultLang(n)}getDefaultLang(){return this.defaultLang}use(n){if(n===this.currentLang)return Gn(this.translations[n]);let s=this.retrieveTranslations(n);return typeof s<"u"?(this.currentLang||(this.currentLang=n),s.pipe(Us(1)).subscribe(u=>{this.changeLang(n)}),s):(this.changeLang(n),Gn(this.translations[n]))}retrieveTranslations(n){let s;return(typeof this.translations[n]>"u"||this.extend)&&(this._translationRequests[n]=this._translationRequests[n]||this.getTranslation(n),s=this._translationRequests[n]),s}getTranslation(n){this.pending=!0;const s=this.currentLoader.getTranslation(n).pipe(BL(1),Us(1));return this.loadingTranslations=s.pipe(ii(u=>this.compiler.compileTranslations(u,n)),BL(1),Us(1)),this.loadingTranslations.subscribe({next:u=>{this.translations[n]=this.extend&&this.translations[n]?{...u,...this.translations[n]}:u,this.updateLangs(),this.pending=!1},error:u=>{this.pending=!1}}),s}setTranslation(n,s,u=!1){s=this.compiler.compileTranslations(s,n),this.translations[n]=(u||this.extend)&&this.translations[n]?jL(this.translations[n],s):s,this.updateLangs(),this.onTranslationChange.emit({lang:n,translations:this.translations[n]})}getLangs(){return this.langs}addLangs(n){n.forEach(s=>{-1===this.langs.indexOf(s)&&this.langs.push(s)})}updateLangs(){this.addLangs(Object.keys(this.translations))}getParsedResult(n,s,u){let m;if(s instanceof Array){let b={},T=!1;for(let R of s)b[R]=this.getParsedResult(n,R,u),am(b[R])&&(T=!0);return T?Kx(s.map(z=>am(b[z])?b[z]:Gn(b[z]))).pipe(ii(z=>{let W={};return z.forEach((le,he)=>{W[s[he]]=le}),W})):b}if(n&&(m=this.parser.interpolate(this.parser.getValue(n,s),u)),typeof m>"u"&&null!=this.defaultLang&&this.defaultLang!==this.currentLang&&this.useDefaultLang&&(m=this.parser.interpolate(this.parser.getValue(this.translations[this.defaultLang],s),u)),typeof m>"u"){let b={key:s,translateService:this};typeof u<"u"&&(b.interpolateParams=u),m=this.missingTranslationHandler.handle(b)}return typeof m<"u"?m:s}get(n,s){if(!xm(n)||!n.length)throw new Error('Parameter "key" required');if(this.pending)return this.loadingTranslations.pipe(u_(u=>am(u=this.getParsedResult(u,n,s))?u:Gn(u)));{let u=this.getParsedResult(this.translations[this.currentLang],n,s);return am(u)?u:Gn(u)}}getStreamOnTranslationChange(n,s){if(!xm(n)||!n.length)throw new Error('Parameter "key" required');return fv(pE(()=>this.get(n,s)),this.onTranslationChange.pipe(pt(u=>{const m=this.getParsedResult(u.translations,n,s);return"function"==typeof m.subscribe?m:Gn(m)})))}stream(n,s){if(!xm(n)||!n.length)throw new Error('Parameter "key" required');return fv(pE(()=>this.get(n,s)),this.onLangChange.pipe(pt(u=>{const m=this.getParsedResult(u.translations,n,s);return am(m)?m:Gn(m)})))}instant(n,s){if(!xm(n)||!n.length)throw new Error('Parameter "key" required');let u=this.getParsedResult(this.translations[this.currentLang],n,s);if(am(u)){if(n instanceof Array){let m={};return n.forEach((b,T)=>{m[n[T]]=n[T]}),m}return n}return u}set(n,s,u=this.currentLang){this.translations[u][n]=this.compiler.compile(s,u),this.updateLangs(),this.onTranslationChange.emit({lang:u,translations:this.translations[u]})}changeLang(n){this.currentLang=n,this.onLangChange.emit({lang:n,translations:this.translations[n]}),null==this.defaultLang&&this.changeDefaultLang(n)}changeDefaultLang(n){this.defaultLang=n,this.onDefaultLangChange.emit({lang:n,translations:this.translations[n]})}reloadLang(n){return this.resetLang(n),this.getTranslation(n)}resetLang(n){this._translationRequests[n]=void 0,this.translations[n]=void 0}getBrowserLang(){if(typeof window>"u"||typeof window.navigator>"u")return;let n=window.navigator.languages?window.navigator.languages[0]:null;return n=n||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,typeof n>"u"?void 0:(-1!==n.indexOf("-")&&(n=n.split("-")[0]),-1!==n.indexOf("_")&&(n=n.split("_")[0]),n)}getBrowserCultureLang(){if(typeof window>"u"||typeof window.navigator>"u")return;let n=window.navigator.languages?window.navigator.languages[0]:null;return n=n||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,n}}return e=t,xt(t,"\u0275fac",function(n){return new(n||e)(ze($L),ze(s1),ze(uD),ze(cD),ze(aA),ze(uA),ze(cA),ze(hA),ze(dA))}),xt(t,"\u0275prov",Ut({token:e,factory:e.\u0275fac})),t})(),dD=(()=>{var e;class t{constructor(n,s){xt(this,"translate",void 0),xt(this,"_ref",void 0),xt(this,"value",""),xt(this,"lastKey",null),xt(this,"lastParams",[]),xt(this,"onTranslationChange",void 0),xt(this,"onLangChange",void 0),xt(this,"onDefaultLangChange",void 0),this.translate=n,this._ref=s}updateValue(n,s,u){let m=b=>{this.value=void 0!==b?b:n,this.lastKey=n,this._ref.markForCheck()};if(u){let b=this.translate.getParsedResult(u,n,s);am(b.subscribe)?b.subscribe(m):m(b)}this.translate.get(n,s).subscribe(m)}transform(n,...s){if(!n||!n.length)return n;if(lD(n,this.lastKey)&&lD(s,this.lastParams))return this.value;let u;if(xm(s[0])&&s.length)if("string"==typeof s[0]&&s[0].length){let m=s[0].replace(/(\')?([a-zA-Z0-9_]+)(\')?(\s)?:/g,'"$2":').replace(/:(\s)?(\')(.*?)(\')/g,':"$3"');try{u=JSON.parse(m)}catch{throw new SyntaxError(`Wrong parameter in TranslatePipe. Expected a valid Object, received: ${s[0]}`)}}else"object"==typeof s[0]&&!Array.isArray(s[0])&&(u=s[0]);return this.lastKey=n,this.lastParams=s,this.updateValue(n,u),this._dispose(),this.onTranslationChange||(this.onTranslationChange=this.translate.onTranslationChange.subscribe(m=>{this.lastKey&&m.lang===this.translate.currentLang&&(this.lastKey=null,this.updateValue(n,u,m.translations))})),this.onLangChange||(this.onLangChange=this.translate.onLangChange.subscribe(m=>{this.lastKey&&(this.lastKey=null,this.updateValue(n,u,m.translations))})),this.onDefaultLangChange||(this.onDefaultLangChange=this.translate.onDefaultLangChange.subscribe(()=>{this.lastKey&&(this.lastKey=null,this.updateValue(n,u))})),this.value}_dispose(){typeof this.onTranslationChange<"u"&&(this.onTranslationChange.unsubscribe(),this.onTranslationChange=void 0),typeof this.onLangChange<"u"&&(this.onLangChange.unsubscribe(),this.onLangChange=void 0),typeof this.onDefaultLangChange<"u"&&(this.onDefaultLangChange.unsubscribe(),this.onDefaultLangChange=void 0)}ngOnDestroy(){this._dispose()}}return e=t,xt(t,"\u0275fac",function(n){return new(n||e)(xe(a1,16),xe(La,16))}),xt(t,"\u0275pipe",vo({name:"translate",type:e,pure:!1})),xt(t,"\u0275prov",Ut({token:e,factory:e.\u0275fac})),t})(),U7=(()=>{var e;class t{static forRoot(n={}){return{ngModule:t,providers:[n.loader||{provide:s1,useClass:zL},n.compiler||{provide:uD,useClass:HL},n.parser||{provide:cD,useClass:UL},n.missingTranslationHandler||{provide:aA,useClass:VL},$L,{provide:cA,useValue:n.isolate},{provide:uA,useValue:n.useDefaultLang},{provide:hA,useValue:n.extend},{provide:dA,useValue:n.defaultLanguage},a1]}}static forChild(n={}){return{ngModule:t,providers:[n.loader||{provide:s1,useClass:zL},n.compiler||{provide:uD,useClass:HL},n.parser||{provide:cD,useClass:UL},n.missingTranslationHandler||{provide:aA,useClass:VL},{provide:cA,useValue:n.isolate},{provide:uA,useValue:n.useDefaultLang},{provide:hA,useValue:n.extend},{provide:dA,useValue:n.defaultLanguage},a1]}}}return e=t,xt(t,"\u0275fac",function(n){return new(n||e)}),xt(t,"\u0275mod",Ji({type:e})),xt(t,"\u0275inj",Oi({})),t})();function H7(e,t){if(1&e&&(ce(0,"li",8)(1,"a",9),Te(2),go(3,"translate"),ue()()),2&e){const r=Dn().$implicit;we(1),bc("routerLink",r.url),we(1),hn(ms(3,2,r.title))}}function $7(e,t){if(1&e&&(ce(0,"li",10),Te(1),go(2,"translate"),ue()),2&e){const r=Dn().$implicit;we(1),hn(ms(2,1,r.title))}}function G7(e,t){if(1&e&&(jr(0),Ln(1,H7,4,4,"li",6),Ln(2,$7,3,3,"li",7),Ur()),2&e){const r=t.$implicit;we(1),Be("ngIf",""!=r.url),we(1),Be("ngIf",""==r.url)}}let gu=(()=>{var e;class t{constructor(){this.title="",this.breadcrumbs=[]}ngOnInit(){}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Ci({type:e,selectors:[["app-breadcrumb"]],inputs:{title:"title",breadcrumbs:"breadcrumbs"},decls:8,vars:4,consts:[[1,"row","page-titles"],[1,"col-md-5","align-self-center","animated","fadeInLeft"],[1,"text-themecolor"],[1,"col-md-7","align-self-center","animated","fadeInRight"],[1,"breadcrumb"],[4,"ngFor","ngForOf"],["class","breadcrumb-item",4,"ngIf"],["class","breadcrumb-item active",4,"ngIf"],[1,"breadcrumb-item"],[3,"routerLink"],[1,"breadcrumb-item","active"]],template:function(n,s){1&n&&(ce(0,"div",0)(1,"div",1)(2,"h3",2),Te(3),go(4,"translate"),ue()(),ce(5,"div",3)(6,"ol",4),Ln(7,G7,3,2,"ng-container",5),ue()()()),2&n&&(we(3),hn(ms(4,2,s.title)),we(4),Be("ngForOf",s.breadcrumbs))},dependencies:[Gl,Na,sa,dD]}),t})();function q7(e,t){1&e&&it(0,"i",4)}function W7(e,t){1&e&&it(0,"i",5)}function Z7(e,t){if(1&e&&(jr(0),Ln(1,q7,1,0,"i",2),Ln(2,W7,1,0,"i",3),Ur()),2&e){const r=Dn();we(1),Be("ngIf","ASC"==r.direction),we(1),Be("ngIf","DESC"==r.direction)}}let l1=(()=>{var e;class t{constructor(){this.title="",this.direction="",this.sort="",this.field=""}ngOnInit(){}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Ci({type:e,selectors:[["app-table-th"]],inputs:{title:"title",direction:"direction",sort:"sort",field:"field"},decls:3,vars:2,consts:[["href","javascript:void(0)"],[4,"ngIf"],["class","fa fa-sort-up ",4,"ngIf"],["class","fa fa-sort-down ",4,"ngIf"],[1,"fa","fa-sort-up"],[1,"fa","fa-sort-down"]],template:function(n,s){1&n&&(ce(0,"a",0),Te(1),Ln(2,Z7,3,2,"ng-container",1),ue()),2&n&&(we(1),Xn("",s.title," "),we(1),Be("ngIf",s.sort==s.field))},dependencies:[Na]}),t})();const GL=function(e){return{disabled:e}};function Y7(e,t){if(1&e){const r=Sr();jr(0),ce(1,"li",3)(2,"a",4),zt("click",function(){return Mn(r),Cn(Dn().previus())}),it(3,"i",5),ue()(),ce(4,"li",6)(5,"a",7),Te(6),ue()(),ce(7,"li",3)(8,"a",8),zt("click",function(){return Mn(r),Cn(Dn().next())}),it(9,"i",9),ue()(),Ur()}if(2&e){const r=Dn();we(1),Be("ngClass",Pf(4,GL,0==r.currentPage)),we(5),Kn(" ",r.currentPage+1," / ",r.pages," "),we(1),Be("ngClass",Pf(6,GL,r.currentPage+1==r.pages||r.pages<1))}}let c1=(()=>{var e;class t{constructor(n){this.events=n,this.total=0,this.limit=0,this.pages=0,this.currentPage=0,this.events.subscribe("paginationOffset",s=>{this.currentPage=0}),this.events.subscribe("pagination",s=>{this.currentPage=s.currentPage})}ngOnInit(){}next(){this.currentPage<this.pages&&(this.currentPage++,this.emmit())}previus(){this.currentPage>0&&(this.currentPage--,this.emmit())}emmit(){this.events.publish("pagination",{currentPage:this.currentPage})}ngOnDestroy(){this.events.destroy("paginationOffset"),this.events.destroy("pagination")}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(Hs))},e.\u0275cmp=Ci({type:e,selectors:[["app-pagination"]],inputs:{total:"total",limit:"limit",pages:"pages"},decls:3,vars:1,consts:[[1,"float-right"],[1,"pagination"],[4,"ngIf"],[1,"page-item",3,"ngClass"],["matTooltip","Anterior","matTooltipPosition","above","href","javascript:void(0)",1,"page-link",3,"click"],[1,"fa","fa-chevron-left"],[1,"page-item"],[1,"page-link"],["matTooltip","Siguiente","matTooltipPosition","above","href","javascript:void(0)",1,"page-link",3,"click"],[1,"fa","fa-chevron-right"]],template:function(n,s){1&n&&(ce(0,"nav",0)(1,"ul",1),Ln(2,Y7,10,8,"ng-container",2),ue()()),2&n&&(we(2),Be("ngIf",s.pages>1))},dependencies:[px,Na,Pv]}),t})(),u1=(()=>{var e;class t{constructor(){this.total=0,this.limit=0,this.pages=0}ngOnInit(){}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Ci({type:e,selectors:[["app-count-results"]],inputs:{total:"total",limit:"limit",pages:"pages"},decls:2,vars:1,consts:[[1,"text-muted"]],template:function(n,s){1&n&&(ce(0,"p",0),Te(1),ue()),2&n&&(we(1),Xn("",s.total," resultados encontrados."))}}),t})();const X7=function(e){return["/admin/demos/editar",e]};function K7(e,t){if(1&e){const r=Sr();ce(0,"tr")(1,"td"),Te(2),ue(),ce(3,"td"),Te(4),ue(),ce(5,"td",23)(6,"a",24),it(7,"i",25),ue(),ce(8,"a",26),zt("click",function(){const u=Mn(r).index;return Cn(Dn().remove(u))}),it(9,"i",27),ue()()()}if(2&e){const r=t.$implicit;we(2),hn(r.name),we(2),hn(r.description),we(2),Be("routerLink",Pf(3,X7,r.id))}}let Q7=(()=>{var e;class t{constructor(n,s,u,m){this.spinner=n,this.demoService=s,this.events=u,this._snackBar=m,this.data={},this.query="",this.breadcrumbs=[{url:"/admin/inicio",title:"Inicio"},{url:"",title:"Demos"}],this.events.subscribe("pagination",b=>{this.demoService.calcOffset(b.currentPage),this.getResult()}),this.events.subscribe("order",()=>this.getResult())}ngOnInit(){this.getResult()}ngOnDestroy(){this.events.destroy("pagination"),this.events.destroy("order")}search(){this.events.publish("paginationOffset",{}),this.demoService.offset=0,this.getResult()}getResult(){this.spinner.show(),this.demoService.get(this.query).subscribe(n=>{this.data=n,console.log(n)},n=>this.spinner.hide(),()=>this.spinner.hide())}remove(n){jx().fire({text:"\xbfEst\xe1 seguro que desea eliminar este registro?",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"}).then(s=>{s.isConfirmed&&(this.demoService.delete(this.data.data[n]).subscribe(()=>this.getResult()),this._snackBar.open("Registro eliminado","Aceptar",{duration:3e3}))})}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(fl),xe(RO),xe(Hs),xe(Sc))},e.\u0275cmp=Ci({type:e,selectors:[["app-demo"]],decls:32,vars:18,consts:[[1,"container-fluid","animated","fadeIn"],[3,"title","breadcrumbs"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"row","form-material"],[1,"col-md-4"],[1,"text-left","animated","fadeInLeft"],["role","button","routerLink","nuevo",1,"btn","btn-success"],[1,"fa","fa-plus"],[1,"col-md-4","animated","fadeInDown"],["type","text","placeholder","Buscar...",1,"form-control",3,"ngModel","ngModelChange","keyUp.enter"],[1,"text-right","animated","fadeInRight"],[3,"total","limit","pages"],[1,"table-responsive","animated","fadeInUp"],[1,"table","table-hover","table-striped","table-bordered","mt-3"],[3,"click"],[3,"title","field","sort","direction"],[4,"ngFor","ngForOf"],[1,"float-left"],[3,"total"],[3,"limit","pages"],[1,"text-right"],["matTooltip","Editar","matTooltipPosition","above","role","button",1,"btn-edit","btn","btn-outline-info","btn-xs","mr-1",3,"routerLink"],[1,"fa","fa-pencil","text-info"],["matTooltip","Eliminar","matTooltipPosition","above","role","button",1,"btn-remove","btn","btn-outline-danger","btn-xs",3,"click"],[1,"fa","fa-trash","text-danger"]],template:function(n,s){1&n&&(ce(0,"div",0),it(1,"app-breadcrumb",1),ce(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"a",9),it(10,"i",10),Te(11," Nuevo"),ue()()(),ce(12,"div",11)(13,"div")(14,"input",12),zt("ngModelChange",function(m){return s.query=m})("keyUp.enter",function(){return s.search()}),ue()()(),ce(15,"div",7)(16,"div",13),it(17,"app-pagination",14),ue()()(),ce(18,"div",15)(19,"table",16)(20,"thead")(21,"tr")(22,"th",17),zt("click",function(){return s.demoService.setOrder("name")}),it(23,"app-table-th",18),ue(),ce(24,"th",17),zt("click",function(){return s.demoService.setOrder("description")}),it(25,"app-table-th",18),ue(),it(26,"th"),ue()(),ce(27,"tbody"),Ln(28,K7,10,5,"tr",19),ue()(),ce(29,"div",20),it(30,"app-count-results",21),ue(),it(31,"app-pagination",22),ue()()()()()()),2&n&&(we(1),Be("title","Demos")("breadcrumbs",s.breadcrumbs),we(13),Be("ngModel",s.query),we(3),Be("total",s.data.recordsFiltered)("limit",s.demoService.limit)("pages",s.data.pages),we(6),Be("title","Nombre")("field","name")("sort",s.demoService.sort)("direction",s.demoService.direction),we(2),Be("title","Descripci\xf3n")("field","description")("sort",s.demoService.sort)("direction",s.demoService.direction),we(3),Be("ngForOf",s.data.data),we(2),Be("total",s.data.total),we(1),Be("limit",s.demoService.limit)("pages",s.data.pages))},dependencies:[Gl,pl,Mc,Zl,sa,Pv,gu,l1,c1,u1],encapsulation:2}),t})();const qL=["toast-component",""];function J7(e,t){if(1&e){const r=Sr();ce(0,"button",5),zt("click",function(){return Mn(r),Cn(Dn().remove())}),ce(1,"span",6),Te(2,"\xd7"),ue()()}}function eG(e,t){if(1&e&&(jr(0),Te(1),Ur()),2&e){const r=Dn(2);we(1),Xn("[",r.duplicatesCount+1,"]")}}function tG(e,t){if(1&e&&(ce(0,"div"),Te(1),Ln(2,eG,2,1,"ng-container",4),ue()),2&e){const r=Dn();pe(r.options.titleClass),Fr("aria-label",r.title),we(1),Xn(" ",r.title," "),we(1),Be("ngIf",r.duplicatesCount)}}function nG(e,t){if(1&e&&it(0,"div",7),2&e){const r=Dn();pe(r.options.messageClass),Be("innerHTML",r.message,Bl)}}function iG(e,t){if(1&e&&(ce(0,"div",8),Te(1),ue()),2&e){const r=Dn();pe(r.options.messageClass),Fr("aria-label",r.message),we(1),Xn(" ",r.message," ")}}function rG(e,t){if(1&e&&(ce(0,"div"),it(1,"div",9),ue()),2&e){const r=Dn();we(1),te("width",r.width+"%")}}class dG{constructor(t,r){xt(this,"_attachedHost",void 0),xt(this,"component",void 0),xt(this,"viewContainerRef",void 0),xt(this,"injector",void 0),this.component=t,this.injector=r}attach(t,r){return this._attachedHost=t,t.attach(this,r)}detach(){const t=this._attachedHost;if(t)return this._attachedHost=void 0,t.detach()}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class hG{constructor(){xt(this,"_attachedPortal",void 0),xt(this,"_disposeFn",void 0)}attach(t,r){return this._attachedPortal=t,this.attachComponentPortal(t,r)}detach(){this._attachedPortal&&this._attachedPortal.setAttachedHost(),this._attachedPortal=void 0,this._disposeFn&&(this._disposeFn(),this._disposeFn=void 0)}setDisposeFn(t){this._disposeFn=t}}class fG{constructor(t){xt(this,"_overlayRef",void 0),xt(this,"componentInstance",void 0),xt(this,"duplicatesCount",0),xt(this,"_afterClosed",new qe),xt(this,"_activate",new qe),xt(this,"_manualClose",new qe),xt(this,"_resetTimeout",new qe),xt(this,"_countDuplicate",new qe),this._overlayRef=t}manualClose(){this._manualClose.next(),this._manualClose.complete()}manualClosed(){return this._manualClose.asObservable()}timeoutReset(){return this._resetTimeout.asObservable()}countDuplicate(){return this._countDuplicate.asObservable()}close(){this._overlayRef.detach(),this._afterClosed.next(),this._manualClose.next(),this._afterClosed.complete(),this._manualClose.complete(),this._activate.complete(),this._resetTimeout.complete(),this._countDuplicate.complete()}afterClosed(){return this._afterClosed.asObservable()}isInactive(){return this._activate.isStopped}activate(){this._activate.next(),this._activate.complete()}afterActivate(){return this._activate.asObservable()}onDuplicate(t,r){t&&this._resetTimeout.next(),r&&this._countDuplicate.next(++this.duplicatesCount)}}class hD{constructor(t,r,n,s,u,m){xt(this,"toastId",void 0),xt(this,"config",void 0),xt(this,"message",void 0),xt(this,"title",void 0),xt(this,"toastType",void 0),xt(this,"toastRef",void 0),xt(this,"_onTap",new qe),xt(this,"_onAction",new qe),this.toastId=t,this.config=r,this.message=n,this.title=s,this.toastType=u,this.toastRef=m,this.toastRef.afterClosed().subscribe(()=>{this._onAction.complete(),this._onTap.complete()})}triggerTap(){this._onTap.next(),this.config.tapToDismiss&&this._onTap.complete()}onTap(){return this._onTap.asObservable()}triggerAction(t){this._onAction.next(t)}onAction(){return this._onAction.asObservable()}}const ZL=new Kt("ToastConfig");class pG extends hG{constructor(t,r,n){super(),xt(this,"_hostDomElement",void 0),xt(this,"_componentFactoryResolver",void 0),xt(this,"_appRef",void 0),this._hostDomElement=t,this._componentFactoryResolver=r,this._appRef=n}attachComponentPortal(t,r){const n=this._componentFactoryResolver.resolveComponentFactory(t.component);let s;return s=n.create(t.injector),this._appRef.attachView(s.hostView),this.setDisposeFn(()=>{this._appRef.detachView(s.hostView),s.destroy()}),r?this._hostDomElement.insertBefore(this._getComponentRootNode(s),this._hostDomElement.firstChild):this._hostDomElement.appendChild(this._getComponentRootNode(s)),s}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let mG=(()=>{var e;class t{constructor(){xt(this,"_document",Jt(Gi)),xt(this,"_containerElement",void 0)}ngOnDestroy(){this._containerElement&&this._containerElement.parentNode&&this._containerElement.parentNode.removeChild(this._containerElement)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const n=this._document.createElement("div");n.classList.add("overlay-container"),n.setAttribute("aria-live","polite"),this._document.body.appendChild(n),this._containerElement=n}}return e=t,xt(t,"\u0275fac",function(n){return new(n||e)}),xt(t,"\u0275prov",Ut({token:e,factory:e.\u0275fac,providedIn:"root"})),t})();class gG{constructor(t){xt(this,"_portalHost",void 0),this._portalHost=t}attach(t,r=!0){return this._portalHost.attach(t,r)}detach(){return this._portalHost.detach()}}let _G=(()=>{var e;class t{constructor(){xt(this,"_overlayContainer",Jt(mG)),xt(this,"_componentFactoryResolver",Jt(Xd)),xt(this,"_appRef",Jt(ch)),xt(this,"_document",Jt(Gi)),xt(this,"_paneElements",new Map)}create(n,s){return this._createOverlayRef(this.getPaneElement(n,s))}getPaneElement(n="",s){return this._paneElements.get(s)||this._paneElements.set(s,{}),this._paneElements.get(s)[n]||(this._paneElements.get(s)[n]=this._createPaneElement(n,s)),this._paneElements.get(s)[n]}_createPaneElement(n,s){const u=this._document.createElement("div");return u.id="toast-container",u.classList.add(n),u.classList.add("toast-container"),s?s.getContainerElement().appendChild(u):this._overlayContainer.getContainerElement().appendChild(u),u}_createPortalHost(n){return new pG(n,this._componentFactoryResolver,this._appRef)}_createOverlayRef(n){return new gG(this._createPortalHost(n))}}return e=t,xt(t,"\u0275fac",function(n){return new(n||e)}),xt(t,"\u0275prov",Ut({token:e,factory:e.\u0275fac,providedIn:"root"})),t})(),fA=(()=>{var e;class t{constructor(n,s,u,m,b){xt(this,"overlay",void 0),xt(this,"_injector",void 0),xt(this,"sanitizer",void 0),xt(this,"ngZone",void 0),xt(this,"toastrConfig",void 0),xt(this,"currentlyActive",0),xt(this,"toasts",[]),xt(this,"overlayContainer",void 0),xt(this,"previousToastMessage",void 0),xt(this,"index",0),this.overlay=s,this._injector=u,this.sanitizer=m,this.ngZone=b,this.toastrConfig={...n.default,...n.config},n.config.iconClasses&&(this.toastrConfig.iconClasses={...n.default.iconClasses,...n.config.iconClasses})}show(n,s,u={},m=""){return this._preBuildNotification(m,n,s,this.applyConfig(u))}success(n,s,u={}){return this._preBuildNotification(this.toastrConfig.iconClasses.success||"",n,s,this.applyConfig(u))}error(n,s,u={}){return this._preBuildNotification(this.toastrConfig.iconClasses.error||"",n,s,this.applyConfig(u))}info(n,s,u={}){return this._preBuildNotification(this.toastrConfig.iconClasses.info||"",n,s,this.applyConfig(u))}warning(n,s,u={}){return this._preBuildNotification(this.toastrConfig.iconClasses.warning||"",n,s,this.applyConfig(u))}clear(n){for(const s of this.toasts)if(void 0!==n){if(s.toastId===n)return void s.toastRef.manualClose()}else s.toastRef.manualClose()}remove(n){const s=this._findToast(n);if(!s||(s.activeToast.toastRef.close(),this.toasts.splice(s.index,1),this.currentlyActive=this.currentlyActive-1,!this.toastrConfig.maxOpened||!this.toasts.length))return!1;if(this.currentlyActive<this.toastrConfig.maxOpened&&this.toasts[this.currentlyActive]){const u=this.toasts[this.currentlyActive].toastRef;u.isInactive()||(this.currentlyActive=this.currentlyActive+1,u.activate())}return!0}findDuplicate(n="",s="",u,m){const{includeTitleDuplicates:b}=this.toastrConfig;for(const T of this.toasts)if((!b||b&&T.title===n)&&T.message===s)return T.toastRef.onDuplicate(u,m),T;return null}applyConfig(n={}){return{...this.toastrConfig,...n}}_findToast(n){for(let s=0;s<this.toasts.length;s++)if(this.toasts[s].toastId===n)return{index:s,activeToast:this.toasts[s]};return null}_preBuildNotification(n,s,u,m){return m.onActivateTick?this.ngZone.run(()=>this._buildNotification(n,s,u,m)):this._buildNotification(n,s,u,m)}_buildNotification(n,s,u,m){if(!m.toastComponent)throw new Error("toastComponent required");const b=this.findDuplicate(u,s,this.toastrConfig.resetTimeoutOnDuplicate&&m.timeOut>0,this.toastrConfig.countDuplicates);if((this.toastrConfig.includeTitleDuplicates&&u||s)&&this.toastrConfig.preventDuplicates&&null!==b)return b;this.previousToastMessage=s;let T=!1;this.toastrConfig.maxOpened&&this.currentlyActive>=this.toastrConfig.maxOpened&&(T=!0,this.toastrConfig.autoDismiss&&this.clear(this.toasts[0].toastId));const R=this.overlay.create(m.positionClass,this.overlayContainer);this.index=this.index+1;let z=s;s&&m.enableHtml&&(z=this.sanitizer.sanitize(ka.HTML,s));const W=new fG(R),le=new hD(this.index,m,z,u,n,W),Me=Xr.create({providers:[{provide:hD,useValue:le}],parent:this._injector}),Ve=new dG(m.toastComponent,Me),at=R.attach(Ve,m.newestOnTop);W.componentInstance=at.instance;const wt={toastId:this.index,title:u||"",message:s||"",toastRef:W,onShown:W.afterActivate(),onHidden:W.afterClosed(),onTap:le.onTap(),onAction:le.onAction(),portal:at};return T||(this.currentlyActive=this.currentlyActive+1,setTimeout(()=>{wt.toastRef.activate()})),this.toasts.push(wt),wt}}return e=t,xt(t,"\u0275fac",function(n){return new(n||e)(ze(ZL),ze(_G),ze(Xr),ze(kM),ze(si))}),xt(t,"\u0275prov",Ut({token:e,factory:e.\u0275fac,providedIn:"root"})),t})();const yG={maxOpened:0,autoDismiss:!1,newestOnTop:!0,preventDuplicates:!1,countDuplicates:!1,resetTimeoutOnDuplicate:!1,includeTitleDuplicates:!1,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},closeButton:!1,disableTimeOut:!1,timeOut:5e3,extendedTimeOut:1e3,enableHtml:!1,progressBar:!1,toastClass:"ngx-toastr",positionClass:"toast-top-right",titleClass:"toast-title",messageClass:"toast-message",easing:"ease-in",easeTime:300,tapToDismiss:!0,onActivateTick:!1,progressAnimation:"decreasing",toastComponent:(()=>{var e;class t{get displayStyle(){if("inactive"===this.state.value)return"none"}constructor(n,s,u){xt(this,"toastrService",void 0),xt(this,"toastPackage",void 0),xt(this,"ngZone",void 0),xt(this,"message",void 0),xt(this,"title",void 0),xt(this,"options",void 0),xt(this,"duplicatesCount",void 0),xt(this,"originalTimeout",void 0),xt(this,"width",-1),xt(this,"toastClasses",""),xt(this,"state",void 0),xt(this,"timeout",void 0),xt(this,"intervalId",void 0),xt(this,"hideTime",void 0),xt(this,"sub",void 0),xt(this,"sub1",void 0),xt(this,"sub2",void 0),xt(this,"sub3",void 0),this.toastrService=n,this.toastPackage=s,this.ngZone=u,this.message=s.message,this.title=s.title,this.options=s.config,this.originalTimeout=s.config.timeOut,this.toastClasses=`${s.toastType} ${s.config.toastClass}`,this.sub=s.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=s.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=s.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=s.toastRef.countDuplicate().subscribe(m=>{this.duplicatesCount=m}),this.state={value:"inactive",params:{easeTime:this.toastPackage.config.easeTime,easing:"ease-in"}}}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state={...this.state,value:"active"},!0!==this.options.disableTimeOut&&"timeOut"!==this.options.disableTimeOut&&this.options.timeOut&&(this.outsideTimeout(()=>this.remove(),this.options.timeOut),this.hideTime=(new Date).getTime()+this.options.timeOut,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}updateProgress(){if(0===this.width||100===this.width||!this.options.timeOut)return;const n=(new Date).getTime();this.width=(this.hideTime-n)/this.options.timeOut*100,"increasing"===this.options.progressAnimation&&(this.width=100-this.width),this.width<=0&&(this.width=0),this.width>=100&&(this.width=100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state={...this.state,value:"active"},this.outsideTimeout(()=>this.remove(),this.originalTimeout),this.options.timeOut=this.originalTimeout,this.hideTime=(new Date).getTime()+(this.options.timeOut||0),this.width=-1,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10)}remove(){"removed"!==this.state.value&&(clearTimeout(this.timeout),this.state={...this.state,value:"removed"},this.outsideTimeout(()=>this.toastrService.remove(this.toastPackage.toastId),+this.toastPackage.config.easeTime))}tapToast(){"removed"!==this.state.value&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){"removed"!==this.state.value&&"extendedTimeOut"!==this.options.disableTimeOut&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width=0)}delayedHideToast(){!0===this.options.disableTimeOut||"extendedTimeOut"===this.options.disableTimeOut||0===this.options.extendedTimeOut||"removed"===this.state.value||(this.outsideTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=(new Date).getTime()+(this.options.timeOut||0),this.width=-1,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}outsideTimeout(n,s){this.ngZone?this.ngZone.runOutsideAngular(()=>this.timeout=setTimeout(()=>this.runInsideAngular(n),s)):this.timeout=setTimeout(()=>n(),s)}outsideInterval(n,s){this.ngZone?this.ngZone.runOutsideAngular(()=>this.intervalId=setInterval(()=>this.runInsideAngular(n),s)):this.intervalId=setInterval(()=>n(),s)}runInsideAngular(n){this.ngZone?this.ngZone.run(()=>n()):n()}}return e=t,xt(t,"\u0275fac",function(n){return new(n||e)(xe(fA),xe(hD),xe(si))}),xt(t,"\u0275cmp",Ci({type:e,selectors:[["","toast-component",""]],hostVars:5,hostBindings:function(n,s){1&n&&zt("click",function(){return s.tapToast()})("mouseenter",function(){return s.stickAround()})("mouseleave",function(){return s.delayedHideToast()}),2&n&&(kf("@flyInOut",s.state),pe(s.toastClasses),te("display",s.displayStyle))},standalone:!0,features:[VC],attrs:qL,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(n,s){1&n&&(Ln(0,J7,3,0,"button",0),Ln(1,tG,3,5,"div",1),Ln(2,nG,1,3,"div",2),Ln(3,iG,2,4,"div",3),Ln(4,rG,2,2,"div",4)),2&n&&(Be("ngIf",s.options.closeButton),we(1),Be("ngIf",s.title),we(1),Be("ngIf",s.message&&s.options.enableHtml),we(1),Be("ngIf",s.message&&!s.options.enableHtml),we(1),Be("ngIf",s.options.progressBar))},dependencies:[Na],encapsulation:2,data:{animation:[m_("flyInOut",[sd("inactive",es({opacity:0})),sd("active",es({opacity:1})),sd("removed",es({opacity:0})),Tc("inactive => active",Dc("{{ easeTime }}ms {{ easing }}")),Tc("active => removed",Dc("{{ easeTime }}ms {{ easing }}"))])]}})),t})()},vG=(e={})=>hy([{provide:ZL,useValue:{default:yG,config:e}}]);let bG=(()=>{var e;class t{static forRoot(n={}){return{ngModule:t,providers:[vG(n)]}}}return e=t,xt(t,"\u0275fac",function(n){return new(n||e)}),xt(t,"\u0275mod",Ji({type:e})),xt(t,"\u0275inj",Oi({})),t})(),E_=(()=>{var e;class t{constructor(n,s,u,m,b){this.loginService=n,this.router=s,this.toastr=u,this.spinner=m,this.translateService=b}show(n){this.spinner.hide(),400==n.status&&n.error.data.errors.forEach(u=>{this.toastr.error(this.translateService.instant(u.msg),"Atenci\xf3n")})}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Ec),ze(Jo),ze(fA),ze(fl),ze(a1))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),YL=(()=>{var e;class t{constructor(n,s,u,m,b,T){this._msgErrors=n,this.spinner=s,this.router=u,this._snackBar=m,this.activatedRoute=b,this.demoService=T,this.form={id:"",name:"",description:""},this.titlePage="Nuevo",this.breadcrumbs=[{url:"/admin/inicio",title:"Inicio"},{url:"/admin/demos",title:"Demos"},{url:"",title:"Nuevo"}];let R=this.activatedRoute.snapshot.paramMap.get("id");R&&(this.getOne(R),this.breadcrumbs[this.breadcrumbs.length-1].title="Editar",this.titlePage="Editar")}getOne(n){this.spinner.show(),this.demoService.getOne(n).subscribe(s=>{this.form=s.demo,this.spinner.hide()},()=>this.spinner.hide())}ngOnInit(){}save(n){this.spinner.show(),this.demoService.save(this.form).subscribe(s=>{this._snackBar.open("Registro creado","Aceptar",{duration:3e3}),this.router.navigate(["/admin/demos"])},s=>this._msgErrors.show(s))}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(E_),xe(fl),xe(Jo),xe(Sc),xe(pu),xe(RO))},e.\u0275cmp=Ci({type:e,selectors:[["app-demo-form"]],decls:28,vars:5,consts:[[1,"container-fluid","animated","fadeIn"],[3,"title","breadcrumbs"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"card-title","animated","fadeInDown"],[1,"form-material","m-t-40",3,"ngSubmit"],["demo","ngForm"],[1,"col-sm-6"],[1,"form-group"],["type","text","name","name","placeholder","",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-sm-12"],["name","description","rows","5",1,"form-control",3,"ngModel","ngModelChange"],[1,"animated","fadeInUp"],["type","submit",1,"btn","btn-success","waves-effect","waves-light","m-r-10"],[1,"fa","fa-save"],["role","button","routerLink","/admin/demos","type","button",1,"btn","btn-inverse","waves-effect","waves-light"],[1,"fa","fa-remove"]],template:function(n,s){if(1&n){const u=Sr();ce(0,"div",0),it(1,"app-breadcrumb",1),ce(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h4",6),Te(7),ue(),ce(8,"form",7,8),zt("ngSubmit",function(){Mn(u);const b=Pa(9);return Cn(s.save(b))}),ce(10,"div",2)(11,"div",9)(12,"div",10)(13,"label"),Te(14,"Nombre"),ue(),ce(15,"input",11),zt("ngModelChange",function(b){return s.form.name=b}),ue()()(),ce(16,"div",12)(17,"div",10)(18,"label"),Te(19,"Descripci\xf3n"),ue(),ce(20,"textarea",13),zt("ngModelChange",function(b){return s.form.description=b}),ue()()()(),ce(21,"div",14)(22,"button",15),it(23,"i",16),Te(24," Guardar"),ue(),ce(25,"a",17),it(26,"i",18),Te(27," Cancelar"),ue()()()()()()()()}2&n&&(we(1),Be("title","Demos")("breadcrumbs",s.breadcrumbs),we(6),hn(s.breadcrumbs[s.breadcrumbs.length-1].title),we(8),Be("ngModel",s.form.name),we(5),Be("ngModel",s.form.description))},dependencies:[bm,pl,Mc,vm,Zl,fh,sa,gu],encapsulation:2}),t})(),As=(()=>{var e;class t{constructor(n,s){this.loginService=n,this.router=s}canActivate(n,s){return this.loginService.isAutenticate()?this.loginService.unixtime()-this.loginService.user.lastActivity>60*this.loginService.durationSession?(this.loginService.logout(),location.href="/admin/login",!1):(this.loginService.saveStorage(),!0):(this.router.navigate(["/admin/login"]),!1)}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Ec),ze(Jo))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),xG=(()=>{var e;class t{constructor(n,s,u,m,b){this._msgErrors=n,this.spinner=s,this.router=u,this.usersService=m,this.loginService=b,this.form={email:"",password:""}}ngOnInit(){}save(n){this.spinner.show(),this.usersService.login(this.form).subscribe(s=>{this.loginService.login(s),this.spinner.hide(),this.router.navigate(["/admin/inicio"])},s=>this._msgErrors.show(s))}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(E_),xe(fl),xe(Jo),xe(Vx),xe(Ec))},e.\u0275cmp=Ci({type:e,selectors:[["app-login"]],decls:18,vars:2,consts:[["id","wrapper"],[1,"login-register",2,"background-image","url('assets/images/background/login-register.jpg')"],[1,"login-box","card"],[1,"card-body"],["novalidate","","autocomplete","off",1,"form-horizontal","form-material",3,"ngSubmit"],["login","ngForm"],[1,"box-title","m-b-20","py-3",2,"padding-left","4rem","padding-right","4rem","background-color","rgba(16,24,28,0.9)"],["src","assets/images/logo-light-full.png",1,"w-100"],[1,"form-group"],[1,"col-xs-12"],["autocomplete","off","name","email","type","text","placeholder","Email",1,"form-control",3,"ngModel","ngModelChange"],["autocomplete","off","type","password","name","password","placeholder","Contrase\xf1a",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-group","text-center"],[1,"col-xs-12","p-b-20"],["type","submit",1,"btn","btn-block","btn-lg","btn-info","btn-rounded"]],template:function(n,s){if(1&n){const u=Sr();ce(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4,5),zt("ngSubmit",function(){Mn(u);const b=Pa(5);return Cn(s.save(b))}),ce(6,"h3",6),it(7,"img",7),ue(),ce(8,"div",8)(9,"div",9)(10,"input",10),zt("ngModelChange",function(b){return s.form.email=b}),ue()()(),ce(11,"div",8)(12,"div",9)(13,"input",11),zt("ngModelChange",function(b){return s.form.password=b}),ue()()(),ce(14,"div",12)(15,"div",13)(16,"button",14),Te(17,"Ingresar"),ue()()()()()()()()}2&n&&(we(10),Be("ngModel",s.form.email),we(3),Be("ngModel",s.form.password))},dependencies:[bm,pl,Mc,vm,Zl,fh]}),t})(),d1=(()=>{var e;class t{transform(n,...s){return!0===n?'<span class="badge badge-pill badge-success">SI</span>':'<span class="badge badge-pill badge-danger">NO</span>'}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275pipe=vo({name:"badgeBinary",type:e,pure:!0}),t})();const wG=function(e){return["/admin/integraciones",e]},CG=function(e){return["/admin/integraciones/editar",e]};function EG(e,t){if(1&e){const r=Sr();ce(0,"tr")(1,"td"),Te(2),go(3,"translate"),ue(),ce(4,"td"),Te(5),ue(),ce(6,"td"),Te(7),go(8,"translate"),ue(),it(9,"td",23),go(10,"badgeBinary"),ce(11,"td"),Te(12),go(13,"date"),ue(),ce(14,"td",24)(15,"a",25),it(16,"i",26),ue(),ce(17,"a",27),it(18,"i",28),ue(),ce(19,"a",29),zt("click",function(){const u=Mn(r).index;return Cn(Dn().remove(u))}),it(20,"i",30),ue()()()}if(2&e){const r=t.$implicit;we(2),hn(ms(3,7,r.type)),we(3),hn(r.event.name),we(2),hn(ms(8,9,r.item_currency)),we(2),Be("innerHTML",ms(10,11,r.isActive),Bl),we(3),hn(im(13,13,r.created_at,"dd/MM/yyyy HH:mm")),we(3),Be("routerLink",Pf(16,wG,r.id)),we(2),Be("routerLink",Pf(18,CG,r.id))}}let DG=(()=>{var e;class t{constructor(n,s,u,m){this.spinner=n,this.integrationService=s,this.events=u,this._snackBar=m,this.data={},this.query="",this.breadcrumbs=[{url:"/admin/inicio",title:"Inicio"},{url:"",title:"Integrations"}],this.events.subscribe("pagination",b=>{this.integrationService.calcOffset(b.currentPage),this.getResult()}),this.events.subscribe("order",()=>this.getResult())}ngOnInit(){this.getResult()}ngOnDestroy(){this.events.destroy("pagination"),this.events.destroy("order")}search(){this.events.publish("paginationOffset",{}),this.integrationService.offset=0,this.getResult()}getResult(){this.spinner.show(),this.integrationService.get(this.query).subscribe(n=>{this.data=n},n=>this.spinner.hide(),()=>this.spinner.hide())}remove(n){jx().fire({text:"\xbfEst\xe1 seguro que desea eliminar este registro?",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"}).then(s=>{s.isConfirmed&&(this.integrationService.delete(this.data.data[n]).subscribe(()=>this.getResult()),this._snackBar.open("Registro eliminado","Aceptar",{duration:3e3}))})}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(fl),xe(zx),xe(Hs),xe(Sc))},e.\u0275cmp=Ci({type:e,selectors:[["app-integration"]],decls:38,vars:30,consts:[[1,"container-fluid","animated","fadeIn"],[3,"title","breadcrumbs"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"row","form-material"],[1,"col-md-4"],[1,"text-left","animated","fadeInLeft"],["role","button","routerLink","nuevo",1,"btn","btn-success"],[1,"fa","fa-plus"],[1,"col-md-4","animated","fadeInDown"],["type","text","placeholder","Buscar...",1,"form-control",3,"ngModel","ngModelChange","keyUp.enter"],[1,"text-right","animated","fadeInRight"],[3,"total","limit","pages"],[1,"table-responsive","animated","fadeInUp"],[1,"table","table-hover","table-striped","table-bordered","mt-3"],[3,"click"],[3,"title","field","sort","direction"],[4,"ngFor","ngForOf"],[1,"float-left"],[3,"total"],[3,"limit","pages"],[3,"innerHTML"],[1,"text-right"],["matTooltip","Detalle","matTooltipPosition","above","role","button",1,"btn","btn-outline-success","btn-xs","mr-1",3,"routerLink"],[1,"fa","fa-eye","text-succes"],["matTooltip","Editar","matTooltipPosition","above","role","button",1,"btn","btn-outline-info","btn-xs","mr-1",3,"routerLink"],[1,"fa","fa-pencil","text-info"],["matTooltip","Eliminar","matTooltipPosition","above","role","button",1,"btn-remove","btn","btn-outline-danger","btn-xs",3,"click"],[1,"fa","fa-trash","text-danger"]],template:function(n,s){1&n&&(ce(0,"div",0),it(1,"app-breadcrumb",1),ce(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"a",9),it(10,"i",10),Te(11," Nuevo"),ue()()(),ce(12,"div",11)(13,"div")(14,"input",12),zt("ngModelChange",function(m){return s.query=m})("keyUp.enter",function(){return s.search()}),ue()()(),ce(15,"div",7)(16,"div",13),it(17,"app-pagination",14),ue()()(),ce(18,"div",15)(19,"table",16)(20,"thead")(21,"tr")(22,"th",17),zt("click",function(){return s.integrationService.setOrder("type")}),it(23,"app-table-th",18),ue(),ce(24,"th",17),zt("click",function(){return s.integrationService.setOrder("event_id")}),it(25,"app-table-th",18),ue(),ce(26,"th",17),zt("click",function(){return s.integrationService.setOrder("item_currency")}),it(27,"app-table-th",18),ue(),ce(28,"th",17),zt("click",function(){return s.integrationService.setOrder("isActive")}),it(29,"app-table-th",18),ue(),ce(30,"th",17),zt("click",function(){return s.integrationService.setOrder("created_at")}),it(31,"app-table-th",18),ue(),it(32,"th"),ue()(),ce(33,"tbody"),Ln(34,EG,21,20,"tr",19),ue()(),ce(35,"div",20),it(36,"app-count-results",21),ue(),it(37,"app-pagination",22),ue()()()()()()),2&n&&(we(1),Be("title","Integraciones")("breadcrumbs",s.breadcrumbs),we(13),Be("ngModel",s.query),we(3),Be("total",s.data.recordsFiltered)("limit",s.integrationService.limit)("pages",s.data.pages),we(6),Be("title","Tipo")("field","type")("sort",s.integrationService.sort)("direction",s.integrationService.direction),we(2),Be("title","Evento")("field","event_id")("sort",s.integrationService.sort)("direction",s.integrationService.direction),we(2),Be("title","Moneda")("field","item_currency")("sort",s.integrationService.sort)("direction",s.integrationService.direction),we(2),Be("title","Activo")("field","isActive")("sort",s.integrationService.sort)("direction",s.integrationService.direction),we(2),Be("title","Creada")("field","created_at")("sort",s.integrationService.sort)("direction",s.integrationService.direction),we(3),Be("ngForOf",s.data.data),we(2),Be("total",s.data.total),we(1),Be("limit",s.integrationService.limit)("pages",s.data.pages))},dependencies:[Gl,pl,Mc,Zl,sa,Pv,gu,l1,c1,u1,mx,dD,d1],encapsulation:2}),t})(),XL=(()=>{var e;class t{constructor(n,s,u){this.http=n,this.events=s,this.login=u}getAll(){return this.http.get(`${bi_baseBEUrl}/api/eventSwoogos?fields=*`,this.login.createAuthorizationHeader())}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(od),ze(Hs),ze(Ec))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),TG=(()=>{var e;class t{constructor(){}generatePassword(){let u="";for(let m=0;m<48;m++)u+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!#$&_-+="[Math.floor(70*Math.random())];return u}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();function SG(e,t){if(1&e&&(ce(0,"option",23),Te(1),ue()),2&e){const r=t.$implicit;bc("value",r.id),we(1),hn(r.name)}}function MG(e,t){if(1&e&&(ce(0,"option",23),Te(1),ue()),2&e){const r=t.$implicit;bc("value",r.value),we(1),hn(r.label)}}function AG(e,t){if(1&e&&(ce(0,"option",23),Te(1),ue()),2&e){const r=t.$implicit;bc("value",r.value),we(1),Kn("",r.label," (",r.value,")")}}function IG(e,t){if(1&e){const r=Sr();jr(0),ce(1,"div",9)(2,"div",10)(3,"label"),Te(4,"Access Token *"),ue(),ce(5,"input",24),zt("ngModelChange",function(s){return Mn(r),Cn(Dn().form.access_token=s)}),ue()()(),ce(6,"div",25)(7,"div",10)(8,"label"),Te(9,"Moneda *"),ue(),ce(10,"select",26),zt("ngModelChange",function(s){return Mn(r),Cn(Dn().form.item_currency=s)}),ce(11,"option",12),Te(12,"--Seleccione una opci\xf3n--"),ue(),Ln(13,AG,2,3,"option",13),ue()()(),ce(14,"div",25)(15,"div",10)(16,"label"),Te(17,"Activo"),ue(),ce(18,"select",27),zt("ngModelChange",function(s){return Mn(r),Cn(Dn().form.isActive=s)}),ce(19,"option",28),Te(20,"SI"),ue(),ce(21,"option",29),Te(22,"NO"),ue()()()(),Ur()}if(2&e){const r=Dn();we(5),Be("ngModel",r.form.access_token),we(5),Be("ngModel",r.form.item_currency),we(3),Be("ngForOf",r.currencies),we(5),Be("ngModel",r.form.isActive)}}function kG(e,t){if(1&e){const r=Sr();jr(0),ce(1,"div",9)(2,"div",10)(3,"label"),Te(4,"Access Token *"),ue(),ce(5,"input",24),zt("ngModelChange",function(s){return Mn(r),Cn(Dn().form.access_token=s)}),ue()()(),ce(6,"div",25)(7,"div",10)(8,"button",30),zt("click",function(){return Mn(r),Cn(Dn().generatePassword())}),Te(9,"Regenerar token"),ue()()(),ce(10,"div",25)(11,"div",10)(12,"label"),Te(13,"Activo"),ue(),ce(14,"select",27),zt("ngModelChange",function(s){return Mn(r),Cn(Dn().form.isActive=s)}),ce(15,"option",28),Te(16,"SI"),ue(),ce(17,"option",29),Te(18,"NO"),ue()()()(),Ur()}if(2&e){const r=Dn();we(5),Be("ngModel",r.form.access_token),we(9),Be("ngModel",r.form.isActive)}}let KL=(()=>{var e;class t{constructor(n,s,u,m,b,T,R,z){this._msgErrors=n,this.spinner=s,this.router=u,this._snackBar=m,this.activatedRoute=b,this.integrationService=T,this.eventService=R,this.utilsService=z,this.form={id:"",type:"",description:"",event_id:"",event:{},item_currency:"",access_token:"",isActive:1,password:""},this.types=[{value:"MERCADOPAGO",label:"Mercado Pago"},{value:"WEBSERVICE",label:"Web service"}],this.currencies=[{value:"CLP",label:"Pesos chilenos"},{value:"ARS",label:"Pesos argentinos"}],this.titlePage="Nuevo",this.breadcrumbs=[{url:"/admin/inicio",title:"Inicio"},{url:"/admin/integraciones",title:"Integrations"},{url:"",title:"Nuevo"}];let W=this.activatedRoute.snapshot.paramMap.get("id");W?(this.loadForm(W),this.breadcrumbs[this.breadcrumbs.length-1].title="Editar",this.titlePage="Editar"):this.loadForm("")}loadForm(n){this.spinner.show(),n?Kx({events:this.eventService.getAll(),integration:this.integrationService.getOne(n)}).subscribe({next:s=>{this.form=s.integration.integration,this.events=s.events.data,this.form.isActive=s.integration.integration.isActive?1:0},complete:()=>this.spinner.hide()}):this.eventService.getAll().subscribe({next:s=>this.events=s.data,complete:()=>this.spinner.hide()})}typeChange(n){"WEBSERVICE"===n.target.value&&this.generatePassword()}generatePassword(){this.form.access_token=this.utilsService.generatePassword()}ngOnInit(){}save(n){this.spinner.show(),this.form.event=this.events.find(s=>s.id==this.form.event_id),this.integrationService.save(this.form).subscribe(s=>{this._snackBar.open("Registro creado","Aceptar",{duration:3e3}),this.router.navigate(["/admin/integraciones"])},s=>this._msgErrors.show(s))}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(E_),xe(fl),xe(Jo),xe(Sc),xe(pu),xe(zx),xe(XL),xe(TG))},e.\u0275cmp=Ci({type:e,selectors:[["app-integration-form"]],decls:41,vars:10,consts:[[1,"container-fluid","animated","fadeIn"],[3,"title","breadcrumbs"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"card-title","animated","fadeInDown"],[1,"form-material","m-t-40",3,"ngSubmit"],["integration","ngForm"],[1,"col-sm-6"],[1,"form-group"],["name","event_id",1,"form-control",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["name","type",1,"form-control",3,"ngModel","ngModelChange","change"],[4,"ngIf"],[1,"col-sm-12"],["name","description","rows","5",1,"form-control",3,"ngModel","ngModelChange"],[1,"animated","fadeInUp"],["type","submit",1,"btn","btn-success","waves-effect","waves-light","m-r-10"],[1,"fa","fa-save"],["role","button","routerLink","/admin/integraciones","type","button",1,"btn","btn-inverse","waves-effect","waves-light"],[1,"fa","fa-remove"],[3,"value"],["type","text","name","access_token","placeholder","",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-sm-3"],["name","item_currency",1,"form-control",3,"ngModel","ngModelChange"],["name","isActive",1,"form-control",3,"ngModel","ngModelChange"],["value","1"],["value","0"],["type","button",1,"mt-2","btn-sm","btn","btn-info",3,"click"]],template:function(n,s){if(1&n){const u=Sr();ce(0,"div",0),it(1,"app-breadcrumb",1),ce(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h4",6),Te(7),ue(),ce(8,"form",7,8),zt("ngSubmit",function(){Mn(u);const b=Pa(9);return Cn(s.save(b))}),ce(10,"div",2)(11,"div",9)(12,"div",10)(13,"label"),Te(14,"Evento *"),ue(),ce(15,"select",11),zt("ngModelChange",function(b){return s.form.event_id=b}),ce(16,"option",12),Te(17,"--Seleccione una opci\xf3n--"),ue(),Ln(18,SG,2,2,"option",13),ue()()(),ce(19,"div",9)(20,"div",10)(21,"label"),Te(22,"Tipo *"),ue(),ce(23,"select",14),zt("ngModelChange",function(b){return s.form.type=b})("change",function(b){return s.typeChange(b)}),ce(24,"option",12),Te(25,"--Seleccione una opci\xf3n--"),ue(),Ln(26,MG,2,2,"option",13),ue()()(),Ln(27,IG,23,4,"ng-container",15),Ln(28,kG,19,2,"ng-container",15),ce(29,"div",16)(30,"div",10)(31,"label"),Te(32,"Descripci\xf3n"),ue(),ce(33,"textarea",17),zt("ngModelChange",function(b){return s.form.description=b}),ue()()()(),ce(34,"div",18)(35,"button",19),it(36,"i",20),Te(37," Guardar"),ue(),ce(38,"a",21),it(39,"i",22),Te(40," Cancelar"),ue()()()()()()()()}2&n&&(we(1),Be("title","Integraciones")("breadcrumbs",s.breadcrumbs),we(6),hn(s.breadcrumbs[s.breadcrumbs.length-1].title),we(8),Be("ngModel",s.form.event_id),we(3),Be("ngForOf",s.events),we(5),Be("ngModel",s.form.type),we(3),Be("ngForOf",s.types),we(1),Be("ngIf","MERCADOPAGO"==s.form.type),we(1),Be("ngIf","WEBSERVICE"==s.form.type),we(5),Be("ngModel",s.form.description))},dependencies:[Gl,Na,bm,n1,r1,pl,w_,Mc,vm,Zl,fh,sa,gu],encapsulation:2}),t})();function QL(e,t,r,n,s,u,m){try{var b=e[u](m),T=b.value}catch(R){return void r(R)}b.done?t(T):Promise.resolve(T).then(n,s)}function JL(e,t){const r="object"==typeof t;return new Promise((n,s)=>{let m,u=!1;e.subscribe({next:b=>{m=b,u=!0},error:s,complete:()=>{u?n(m):r?n(t.defaultValue):s(new yx)}})})}let PG=(()=>{var e;class t{constructor(n,s){this.http=n,this.login=s}getAll(n){return this.http.get(`${bi_baseBEUrl}/api/registrants?event_id=${n}`,this.login.createAuthorizationHeader())}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(od),ze(Ec))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();class OG{constructor(t,r){this._document=r;const n=this._textarea=this._document.createElement("textarea"),s=n.style;s.position="fixed",s.top=s.opacity="0",s.left="-999em",n.setAttribute("aria-hidden","true"),n.value=t,n.readOnly=!0,(this._document.fullscreenElement||this._document.body).appendChild(n)}copy(){const t=this._textarea;let r=!1;try{if(t){const n=this._document.activeElement;t.select(),t.setSelectionRange(0,t.value.length),r=this._document.execCommand("copy"),n&&n.focus()}}catch{}return r}destroy(){const t=this._textarea;t&&(t.remove(),this._textarea=void 0)}}let FG=(()=>{var e;class t{constructor(n){this._document=n}copy(n){const s=this.beginCopy(n),u=s.copy();return s.destroy(),u}beginCopy(n){return new OG(n,this._document)}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Gi))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})(),LG=(()=>{var e;class t{constructor(n,s){this.clipboard=n,this._snackBar=s,this.text="",this.defaultText="Copiar",this.btnText="",this.btnText=this.defaultText}copy(){this.clipboard.copy(this.text),this._snackBar.open("Copiado","",{duration:1500})}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(FG),xe(Sc))},e.\u0275cmp=Ci({type:e,selectors:[["app-btn-copy"]],inputs:{text:"text"},decls:3,vars:1,consts:[["title","Copiar",1,"pull-right","cursor-pointer","text-white",3,"click"],[1,"fa","fa-copy"]],template:function(n,s){1&n&&(ce(0,"a",0),zt("click",function(){return s.copy()}),it(1,"i",1),Te(2),ue()),2&n&&(we(2),Xn(" ",s.btnText,""))}}),t})(),NG=(()=>{var e;class t{transform(n,...s){return new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:0,maximumFractionDigits:0}).format(n)}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275pipe=vo({name:"formatNumber",type:e,pure:!0}),t})(),BG=(()=>{var e;class t{transform(n,...s){switch(n){case"approved":return'<span class="badge badge-pill badge-success">Aprobado</span>';case"pending":return'<span class="badge badge-pill badge-warning">Pendiente</span>';default:return'<span class="badge badge-pill badge-danger">Pendiente</span>'}}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275pipe=vo({name:"badgeStatus",type:e,pure:!0}),t})();function zG(e,t){if(1&e&&(jr(0),Te(1),go(2,"formatNumber"),Ur()),2&e){const r=Dn().$implicit;we(1),Kn("",r.response.body.currency_id," ",ms(2,2,r.amount),"")}}function VG(e,t){if(1&e&&(jr(0),Te(1),Ur()),2&e){const r=Dn().$implicit;we(1),Kn("",r.swoogo_data.first_name," ",r.swoogo_data.last_name,"")}}function jG(e,t){if(1&e&&(jr(0),Te(1),Ur()),2&e){const r=Dn(2).$implicit;we(1),hn(r.response.body.currency_id)}}function UG(e,t){if(1&e&&(ce(0,"tr")(1,"td"),Te(2),ue(),ce(3,"td")(4,"a",20),Te(5),ue()(),ce(6,"td"),Ln(7,VG,2,2,"ng-container",13),ue(),ce(8,"td"),Ln(9,jG,2,1,"ng-container",13),Te(10),go(11,"formatNumber"),ue()()),2&e){const r=t.$implicit,n=Dn().$implicit;we(2),hn(r.swoogo_id),we(2),em("href","mailto:",r.email,"",qd),we(1),hn(r.email),we(2),Be("ngIf",r.swoogo_data),we(2),Be("ngIf",n.response),we(1),Xn(" ",ms(11,6,r.price),"")}}function HG(e,t){if(1&e&&(ce(0,"tr")(1,"td"),Te(2),go(3,"date"),ue(),it(4,"td",12),go(5,"badgeStatus"),ce(6,"td"),Ln(7,zG,3,4,"ng-container",13),ue(),ce(8,"td")(9,"table",19),Ln(10,UG,12,8,"tr",18),ue()()()),2&e){const r=t.$implicit;we(2),hn(im(3,4,r.created_at,"dd/MM/Y HH:mm")),we(2),Be("innerHTML",ms(5,7,r.status),Bl),we(3),Be("ngIf",r.response),we(3),Be("ngForOf",r.registrants)}}function $G(e,t){if(1&e&&(jr(0),ce(1,"div",8)(2,"h4",14)(3,"b"),Te(4,"SDK"),ue(),it(5,"app-btn-copy",15),ue(),ce(6,"div",4)(7,"p"),Te(8),ue()()(),ce(9,"div",8)(10,"h4",16)(11,"b"),Te(12,"Transacciones"),ue()(),ce(13,"div",4)(14,"table",17)(15,"thead")(16,"tr")(17,"th"),Te(18,"Fecha"),ue(),ce(19,"th"),Te(20,"Estado"),ue(),ce(21,"th"),Te(22,"Monto"),ue(),ce(23,"th"),Te(24,"Registrantes"),ue()()(),ce(25,"tbody"),Ln(26,HG,11,9,"tr",18),ue()()()(),Ur()),2&e){const r=Dn(2);we(5),Be("text",r.sdkString),we(3),hn(r.sdkString),we(18),Be("ngForOf",r.data.transactions)}}function GG(e,t){if(1&e&&(jr(0),ce(1,"div",8)(2,"h4",14)(3,"b"),Te(4,"Documentaci\xf3n"),ue(),it(5,"app-btn-copy",15),ue(),ce(6,"div",4)(7,"p"),Te(8),ue()()(),Ur()),2&e){const r=Dn(2);we(5),Be("text",r.sdkString),we(3),hn(r.sdkString)}}function qG(e,t){if(1&e&&(ce(0,"div",1),it(1,"app-breadcrumb",2),ce(2,"div",3)(3,"div",4)(4,"h3",5),Te(5," Integraci\xf3n: "),ce(6,"b"),Te(7,"N\xba"),ue(),Te(8),ue(),it(9,"hr"),ce(10,"div",6)(11,"div",7)(12,"div",8)(13,"h4",9)(14,"b"),Te(15,"Datos de la integraci\xf3n"),ue()(),ce(16,"div",4)(17,"p")(18,"b"),Te(19,"N\xba:"),ue(),Te(20),ue(),ce(21,"p")(22,"b"),Te(23,"Tipo:"),ue(),Te(24),go(25,"translate"),ue(),ce(26,"p")(27,"b"),Te(28,"Evento:"),ue(),Te(29),ue(),ce(30,"p")(31,"b"),Te(32,"Descripci\xf3n:"),ue(),Te(33),ue()()()(),ce(34,"div",10)(35,"div",8)(36,"h4",11)(37,"b"),Te(38,"Configuraci\xf3n"),ue()(),ce(39,"div",4)(40,"p")(41,"b"),Te(42,"Access Token:"),ue(),Te(43),ue(),ce(44,"p")(45,"b"),Te(46,"Activo: "),ue(),it(47,"span",12),go(48,"badgeBinary"),ue(),ce(49,"p")(50,"b"),Te(51,"Creada: "),ue(),Te(52),go(53,"date"),ue()()()()(),Ln(54,$G,27,3,"ng-container",13),Ln(55,GG,9,2,"ng-container",13),ue()()()),2&e){const r=Dn();we(1),Be("title","Integraciones")("breadcrumbs",r.breadcrumbs),we(7),Xn(" ",r.data.id," "),we(12),Xn(" ",r.data.id,""),we(4),Xn(" ",ms(25,12,r.data.type),""),we(5),Xn(" ",r.data.event.name,""),we(4),Xn(" ",r.data.description,""),we(10),Xn(" ",r.data.access_token,""),we(4),Be("innerHTML",ms(48,14,r.data.isActive),Bl),we(5),Xn(" ",im(53,16,r.data.created_at,"dd/MM/yyyy HH:mm"),""),we(2),Be("ngIf","MERCADOPAGO"==r.data.type),we(1),Be("ngIf","WEBSERVICE"==r.data.type)}}let WG=(()=>{var e;class t{constructor(n,s,u,m,b,T,R){this.spinner=n,this.router=s,this.events=u,this.registrants=m,this._snackBar=b,this.activatedRoute=T,this.integration=R,this.sdkString="",this.breadcrumbs=[{url:"/admin/inicio",title:"Inicio"},{url:"/admin/integraciones",title:"Integraciones"},{url:"",title:""}],this.id=this.activatedRoute.snapshot.paramMap.get("id")}ngOnInit(){this.getData()}getData(){var n=this;return function RG(e){return function(){var t=this,r=arguments;return new Promise(function(n,s){var u=e.apply(t,r);function m(T){QL(u,n,s,m,b,"next",T)}function b(T){QL(u,n,s,m,b,"throw",T)}m(void 0)})}}(function*(){n.spinner.show();const s=yield JL(n.integration.getOne(n.id)),u=yield JL(n.integration.getTransactions(n.id));switch(n.data=s.integration,n.data.transactions=u.data,n.data.type){case"MERCADOPAGO":let m="";m=`<script type="text/javascript" src="https://clickgroup-be.latamhosting.com.ar/swoogo-integration.1.0.0.js"><\/script>    \n\t\t\t\t\t\t<script>\n\t\t\t\t\t\tconst integration_id="##INTEGRATION_ID##";\n\t\t\t\t\t\tconst gateway="${bi_baseBEUrl}/";\n\t\t\t\t\t\tconst registrantForm="#registrant-form"; \n\t\t\t\t\t\tconst mode="prod";\n\t\t\t\t\t\tjQuery(function(){captureForm()});<\/script>`,n.sdkString=m.replace(new RegExp("\\##INTEGRATION_ID##","gm"),n.id);break;case"WEBSERVICE":n.sdkString="https://documenter.getpostman.com/view/8526806/2s9Yyy8e8L"}n.breadcrumbs[2].title=n.data.id,n.spinner.hide()})()}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(fl),xe(Jo),xe(Hs),xe(PG),xe(Sc),xe(pu),xe(zx))},e.\u0275cmp=Ci({type:e,selectors:[["app-integration-detail"]],decls:1,vars:1,consts:[["class","container-fluid animated fadeIn",4,"ngIf"],[1,"container-fluid","animated","fadeIn"],[3,"title","breadcrumbs"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"row"],[1,"col-md-5"],[1,"card","bg-light"],[1,"card-header","bg-info","text-white"],[1,"col-md-7"],[1,"card-header","bg-success","text-white"],[3,"innerHTML"],[4,"ngIf"],[1,"card-header","bg-warning","text-white"],[3,"text"],[1,"card-header","bg-primary","text-white"],[1,"table","table-hover","table-bordered"],[4,"ngFor","ngForOf"],[1,"table-condensed"],[3,"href"]],template:function(n,s){1&n&&Ln(0,qG,56,19,"div",0),2&n&&Be("ngIf",s.data)},dependencies:[Gl,Na,gu,LG,mx,dD,NG,BG,d1],encapsulation:2}),t})();const ZG=function(e){return["/admin/usuarios/editar",e]};function YG(e,t){if(1&e){const r=Sr();ce(0,"tr")(1,"td"),Te(2),ue(),ce(3,"td"),Te(4),ue(),it(5,"td",23),go(6,"badgeBinary"),ce(7,"td",24)(8,"a",25),it(9,"i",26),ue(),ce(10,"a",27),zt("click",function(){const u=Mn(r).index;return Cn(Dn().remove(u))}),it(11,"i",28),ue()()()}if(2&e){const r=t.$implicit;we(2),hn(r.name),we(2),hn(r.email),we(1),Be("innerHTML",ms(6,4,r.isActive),Bl),we(3),Be("routerLink",Pf(6,ZG,r.id))}}let XG=(()=>{var e;class t{constructor(n,s,u,m){this.spinner=n,this.usersService=s,this.events=u,this._snackBar=m,this.data={},this.query="",this.breadcrumbs=[{url:"/admin/inicio",title:"Inicio"},{url:"",title:"Usuarios"}],this.events.subscribe("pagination",b=>{this.usersService.calcOffset(b.currentPage),this.getResult()}),this.events.subscribe("order",()=>this.getResult())}ngOnInit(){this.getResult()}ngOnDestroy(){this.events.destroy("pagination"),this.events.destroy("order")}search(){this.events.publish("paginationOffset",{}),this.usersService.offset=0,this.getResult()}getResult(){this.spinner.show(),this.usersService.get(this.query).subscribe(n=>{this.data=n,console.log(n)},n=>this.spinner.hide(),()=>this.spinner.hide())}remove(n){jx().fire({text:"\xbfEst\xe1 seguro que desea eliminar este registro?",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"}).then(s=>{s.isConfirmed&&(this.usersService.delete(this.data.data[n]).subscribe(()=>this.getResult()),this._snackBar.open("Registro eliminado","Aceptar",{duration:3e3}))})}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(fl),xe(Vx),xe(Hs),xe(Sc))},e.\u0275cmp=Ci({type:e,selectors:[["app-users"]],decls:34,vars:23,consts:[[1,"container-fluid","animated","fadeIn"],[3,"title","breadcrumbs"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"row","form-material"],[1,"col-md-4"],[1,"text-left","animated","fadeInLeft"],["role","button","routerLink","nuevo",1,"btn","btn-success"],[1,"fa","fa-plus"],[1,"col-md-4","animated","fadeInDown"],["type","text","placeholder","Buscar...",1,"form-control",3,"ngModel","ngModelChange","keyUp.enter"],[1,"text-right","animated","fadeInRight"],[3,"total","limit","pages"],[1,"animated","fadeInUp"],[1,"table","table-hover","table-striped","table-bordered","mt-3"],[3,"click"],[3,"title","field","sort","direction"],[1,"text-center",3,"click"],[4,"ngFor","ngForOf"],[1,"float-left"],[3,"total"],[1,"text-center",3,"innerHTML"],[1,"text-center"],["matTooltip","Editar","matTooltipPosition","above","role","button","href","",1,"btn-edit","btn-xs","btn","btn-outline-info","mr-1",3,"routerLink"],[1,"fa","fa-pencil","text-info"],["matTooltip","Eliminar","matTooltipPosition","above","role","button",1,"btn-remove","btn-xs","btn","btn-outline-danger",3,"click"],[1,"fa","fa-trash","text-danger"]],template:function(n,s){1&n&&(ce(0,"div",0),it(1,"app-breadcrumb",1),ce(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"a",9),it(10,"i",10),Te(11," Nuevo"),ue()()(),ce(12,"div",11)(13,"div")(14,"input",12),zt("ngModelChange",function(m){return s.query=m})("keyUp.enter",function(){return s.search()}),ue()()(),ce(15,"div",7)(16,"div",13),it(17,"app-pagination",14),ue()()(),ce(18,"div",15)(19,"table",16)(20,"thead")(21,"tr")(22,"th",17),zt("click",function(){return s.usersService.setOrder("name")}),it(23,"app-table-th",18),ue(),ce(24,"th",17),zt("click",function(){return s.usersService.setOrder("email")}),it(25,"app-table-th",18),ue(),ce(26,"th",19),zt("click",function(){return s.usersService.setOrder("isActive")}),it(27,"app-table-th",18),ue(),it(28,"th"),ue()(),ce(29,"tbody"),Ln(30,YG,12,8,"tr",20),ue()(),ce(31,"div",21),it(32,"app-count-results",22),ue(),it(33,"app-pagination",14),ue()()()()()()),2&n&&(we(1),Be("title","Usuarios")("breadcrumbs",s.breadcrumbs),we(13),Be("ngModel",s.query),we(3),Be("total",s.data.total)("limit",s.data.limit)("pages",s.data.pages),we(6),Be("title","Nombre")("field","name")("sort",s.usersService.sort)("direction",s.usersService.direction),we(2),Be("title","Email")("field","email")("sort",s.usersService.sort)("direction",s.usersService.direction),we(2),Be("title","Activo")("field","isActive")("sort",s.usersService.sort)("direction",s.usersService.direction),we(3),Be("ngForOf",s.data.data),we(2),Be("total",s.data.total),we(1),Be("total",s.data.total)("limit",s.usersService.limit)("pages",s.data.pages))},dependencies:[Gl,pl,Mc,Zl,sa,Pv,gu,l1,c1,u1,d1],encapsulation:2}),t})(),e3=(()=>{var e;class t{constructor(n,s,u,m,b,T){this._msgErrors=n,this.spinner=s,this.router=u,this._snackBar=m,this.activatedRoute=b,this.usersService=T,this.form={id:"",name:"",email:"",password:"",passwordRepeat:"",plainPassword:{},role:"",isActive:1},this.titlePage="Nuevo",this.breadcrumbs=[{url:"/admin/inicio",title:"Inicio"},{url:"/admin/usuarios",title:"Usuarios"},{url:"",title:"Nuevo"}];let R=this.activatedRoute.snapshot.paramMap.get("id");R&&(this.getOne(R),this.breadcrumbs[this.breadcrumbs.length-1].title="Editar",this.titlePage="Editar")}getOne(n){this.spinner.show(),this.usersService.getOne(n).subscribe(s=>{this.form=s.user,this.form.isActive=s.user.isActive?1:0,console.log(this.form),this.spinner.hide()},()=>this.spinner.hide())}ngOnInit(){}save(n){this.spinner.show(),this.usersService.save(this.form).subscribe(s=>{this._snackBar.open("Registro creado","Aceptar",{duration:3e3}),this.router.navigate(["/usuarios"])},s=>this._msgErrors.show(s))}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(E_),xe(fl),xe(Jo),xe(Sc),xe(pu),xe(Vx))},e.\u0275cmp=Ci({type:e,selectors:[["app-users-form"]],decls:42,vars:7,consts:[[1,"container-fluid","animated","fadeIn"],[3,"title","breadcrumbs"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"card-title","animated","fadeInDown"],[1,"form-material","m-t-40",3,"ngSubmit"],["users","ngForm"],[1,"col-sm-6"],[1,"form-group"],["type","text","name","name","placeholder","",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","email","placeholder","",1,"form-control",3,"ngModel","ngModelChange"],["type","password","name","password","placeholder","",1,"form-control",3,"ngModel","ngModelChange"],["name","isActive",1,"form-control",3,"ngModel","ngModelChange"],["value","1"],["value","0"],[1,"animated","fadeInUp"],["type","submit",1,"btn","btn-success","waves-effect","waves-light","m-r-10"],[1,"fa","fa-save"],["role","button","routerLink","/admin/usuarios","type","button",1,"btn","btn-inverse","waves-effect","waves-light"],[1,"fa","fa-remove"]],template:function(n,s){if(1&n){const u=Sr();ce(0,"div",0),it(1,"app-breadcrumb",1),ce(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h4",6),Te(7),ue(),ce(8,"form",7,8),zt("ngSubmit",function(){Mn(u);const b=Pa(9);return Cn(s.save(b))}),ce(10,"div",2)(11,"div",9)(12,"div",10)(13,"label"),Te(14,"Nombre *"),ue(),ce(15,"input",11),zt("ngModelChange",function(b){return s.form.name=b}),ue()()(),ce(16,"div",9)(17,"div",10)(18,"label"),Te(19,"Email *"),ue(),ce(20,"input",12),zt("ngModelChange",function(b){return s.form.email=b}),ue()()(),ce(21,"div",9)(22,"div",10)(23,"label"),Te(24,"Contrase\xf1a *"),ue(),ce(25,"input",13),zt("ngModelChange",function(b){return s.form.password=b}),ue()()(),ce(26,"div",9)(27,"div",10)(28,"label"),Te(29,"Activo"),ue(),ce(30,"select",14),zt("ngModelChange",function(b){return s.form.isActive=b}),ce(31,"option",15),Te(32,"SI"),ue(),ce(33,"option",16),Te(34,"NO"),ue()()()()(),ce(35,"div",17)(36,"button",18),it(37,"i",19),Te(38," Guardar"),ue(),ce(39,"a",20),it(40,"i",21),Te(41," Cancelar"),ue()()()()()()()()}2&n&&(we(1),Be("title","Usuarios")("breadcrumbs",s.breadcrumbs),we(6),hn(s.breadcrumbs[s.breadcrumbs.length-1].title),we(8),Be("ngModel",s.form.name),we(5),Be("ngModel",s.form.email),we(5),Be("ngModel",s.form.password),we(5),Be("ngModel",s.form.isActive))},dependencies:[bm,n1,r1,pl,w_,Mc,vm,Zl,fh,sa,gu],encapsulation:2}),t})(),t3=(()=>{var e;class t{constructor(n,s,u){this.integration=n,this.user=s,this.transaction=u}ngOnInit(){}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(zx),xe(Vx),xe(DO))},e.\u0275cmp=Ci({type:e,selectors:[["app-home"]],decls:5,vars:0,consts:[[1,"container-fluid"],[1,"row","page-titles"],[1,"col-md-5","align-self-center"],[1,"text-themecolor"]],template:function(n,s){1&n&&(ce(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),Te(4,"FE"),ue()()()())},encapsulation:2}),t})(),pA=(()=>{var e;class t{constructor(n,s,u){this.http=n,this.events=s,this.login=u,this.limit=50,this.offset=0,this.sort="createdAt",this.direction="DESC"}calcOffset(n){this.offset=n*this.limit}setOrder(n){this.direction=this.sort==n&&"ASC"==this.direction?"DESC":"ASC",this.sort=n,this.events.publish("order",{})}get(n){return this.http.get(`${bi_baseBEUrl}/api/events?search=${n}&offset=${this.offset}&limit=${this.limit}&sort=${this.sort}&direction=${this.direction}`,this.login.createAuthorizationHeader())}getHome(){return this.http.get(`${bi_baseBEUrl}/api/events/sliderHome`)}stats(){return this.http.get(`${bi_baseBEUrl}/api/events/stats/get`,this.login.createAuthorizationHeader())}getOne(n){return this.http.get(`${bi_baseBEUrl}/api/events/${n}`,this.login.createAuthorizationHeader())}getAll(){return this.http.get(`${bi_baseBEUrl}/api/events?search%5Bvalue%5D=&start=0&length=-1&sort=name&direction=ASC`,this.login.createAuthorizationHeader())}save(n){return""!==n.id?this.http.put(`${bi_baseBEUrl}/api/events/${n.id}`,n,this.login.createAuthorizationHeader()):this.http.post(`${bi_baseBEUrl}/api/events`,n,this.login.createAuthorizationHeader())}delete(n){return this.http.delete(`${bi_baseBEUrl}/api/events/${n.id}`,this.login.createAuthorizationHeader())}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(od),ze(Hs),ze(Ec))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();const KG=function(e){return["/admin/events/editar",e]};function QG(e,t){if(1&e){const r=Sr();ce(0,"tr")(1,"td"),Te(2),ue(),ce(3,"td"),Te(4),ue(),it(5,"td",23),go(6,"badgeBinary"),it(7,"td",23),go(8,"badgeBinary"),it(9,"td",23),go(10,"badgeBinary"),ce(11,"td"),Te(12),go(13,"date"),ue(),ce(14,"td"),Te(15),go(16,"date"),ue(),ce(17,"td",24)(18,"a",25),it(19,"i",26),ue(),ce(20,"a",27),zt("click",function(){const u=Mn(r).index;return Cn(Dn().remove(u))}),it(21,"i",28),ue()()()}if(2&e){const r=t.$implicit;we(2),hn(r.category.name),we(2),hn(r.name),we(1),Be("innerHTML",ms(6,8,r.isActive),Bl),we(2),Be("innerHTML",ms(8,10,r.inHome),Bl),we(2),Be("innerHTML",ms(10,12,r.inSwoogo),Bl),we(3),hn(im(13,14,r.start_date,"dd/MM/yyyy HH:mm")),we(3),hn(im(16,17,r.end_date,"dd/MM/yyyy HH:mm")),we(3),Be("routerLink",Pf(20,KG,r.id))}}let JG=(()=>{var e;class t{constructor(n,s,u,m){this.spinner=n,this.eventService=s,this.events=u,this._snackBar=m,this.data={},this.query="",this.breadcrumbs=[{url:"/admin/inicio",title:"Inicio"},{url:"",title:"Eventos"}],this.events.subscribe("pagination",b=>{this.eventService.calcOffset(b.currentPage),this.getResult()}),this.events.subscribe("order",()=>this.getResult())}ngOnInit(){this.getResult()}ngOnDestroy(){this.events.destroy("pagination"),this.events.destroy("order")}search(){this.events.publish("paginationOffset",{}),this.eventService.offset=0,this.getResult()}getResult(){this.spinner.show(),this.eventService.get(this.query).subscribe(n=>{this.data=n,console.log(n)},n=>this.spinner.hide(),()=>this.spinner.hide())}remove(n){jx().fire({text:"\xbfEst\xe1 seguro que desea eliminar este registro?",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"}).then(s=>{s.isConfirmed&&(this.eventService.delete(this.data.data[n]).subscribe(()=>this.getResult()),this._snackBar.open("Registro eliminado","Aceptar",{duration:3e3}))})}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(fl),xe(pA),xe(Hs),xe(Sc))},e.\u0275cmp=Ci({type:e,selectors:[["app-event"]],decls:42,vars:38,consts:[[1,"container-fluid","animated","fadeIn"],[3,"title","breadcrumbs"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"row","form-material"],[1,"col-md-4"],[1,"text-left","animated","fadeInLeft"],["role","button","routerLink","nuevo",1,"btn","btn-success"],[1,"fa","fa-plus"],[1,"col-md-4","animated","fadeInDown"],["type","text","placeholder","Buscar...",1,"form-control",3,"ngModel","ngModelChange","keyUp.enter"],[1,"text-right","animated","fadeInRight"],[3,"total","limit","pages"],[1,"table-responsive","animated","fadeInUp"],[1,"table","table-hover","table-striped","table-bordered","mt-3"],[3,"click"],[3,"title","field","sort","direction"],[4,"ngFor","ngForOf"],[1,"float-left"],[3,"total"],[3,"limit","pages"],[3,"innerHTML"],[1,"text-right"],["matTooltip","Editar","matTooltipPosition","above","role","button",1,"btn-edit","btn","btn-outline-info","btn-xs","mr-1",3,"routerLink"],[1,"fa","fa-pencil","text-info"],["matTooltip","Eliminar","matTooltipPosition","above","role","button",1,"btn-remove","btn","btn-outline-danger","btn-xs",3,"click"],[1,"fa","fa-trash","text-danger"]],template:function(n,s){1&n&&(ce(0,"div",0),it(1,"app-breadcrumb",1),ce(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"a",9),it(10,"i",10),Te(11," Nuevo"),ue()()(),ce(12,"div",11)(13,"div")(14,"input",12),zt("ngModelChange",function(m){return s.query=m})("keyUp.enter",function(){return s.search()}),ue()()(),ce(15,"div",7)(16,"div",13),it(17,"app-pagination",14),ue()()(),ce(18,"div",15)(19,"table",16)(20,"thead")(21,"tr")(22,"th",17),zt("click",function(){return s.eventService.setOrder("category.name")}),it(23,"app-table-th",18),ue(),ce(24,"th",17),zt("click",function(){return s.eventService.setOrder("name")}),it(25,"app-table-th",18),ue(),ce(26,"th",17),zt("click",function(){return s.eventService.setOrder("isActive")}),it(27,"app-table-th",18),ue(),ce(28,"th",17),zt("click",function(){return s.eventService.setOrder("inHome")}),it(29,"app-table-th",18),ue(),ce(30,"th",17),zt("click",function(){return s.eventService.setOrder("inSwoogo")}),it(31,"app-table-th",18),ue(),ce(32,"th",17),zt("click",function(){return s.eventService.setOrder("start_date")}),it(33,"app-table-th",18),ue(),ce(34,"th",17),zt("click",function(){return s.eventService.setOrder("end_date")}),it(35,"app-table-th",18),ue(),it(36,"th"),ue()(),ce(37,"tbody"),Ln(38,QG,22,22,"tr",19),ue()(),ce(39,"div",20),it(40,"app-count-results",21),ue(),it(41,"app-pagination",22),ue()()()()()()),2&n&&(we(1),Be("title","Eventos")("breadcrumbs",s.breadcrumbs),we(13),Be("ngModel",s.query),we(3),Be("total",s.data.recordsFiltered)("limit",s.eventService.limit)("pages",s.data.pages),we(6),Be("title","Categor\xeda")("field","category.name")("sort",s.eventService.sort)("direction",s.eventService.direction),we(2),Be("title","Nombre")("field","name")("sort",s.eventService.sort)("direction",s.eventService.direction),we(2),Be("title","Activo")("field","isActive")("sort",s.eventService.sort)("direction",s.eventService.direction),we(2),Be("title","Home")("field","inHome")("sort",s.eventService.sort)("direction",s.eventService.direction),we(2),Be("title","Evento de Swoogo")("field","inSwoogo")("sort",s.eventService.sort)("direction",s.eventService.direction),we(2),Be("title","Inicio")("field","start_date")("sort",s.eventService.sort)("direction",s.eventService.direction),we(2),Be("title","Fin")("field","end_date")("sort",s.eventService.sort)("direction",s.eventService.direction),we(3),Be("ngForOf",s.data.data),we(2),Be("total",s.data.total),we(1),Be("limit",s.eventService.limit)("pages",s.data.pages))},dependencies:[Gl,pl,Mc,Zl,sa,Pv,gu,l1,c1,u1,mx,d1],encapsulation:2}),t})(),mA=(()=>{var e;class t{constructor(n,s,u){this.http=n,this.events=s,this.login=u,this.limit=50,this.offset=0,this.sort="createdAt",this.direction="DESC"}calcOffset(n){this.offset=n*this.limit}setOrder(n){this.direction=this.sort==n&&"ASC"==this.direction?"DESC":"ASC",this.sort=n,this.events.publish("order",{})}get(n){return this.http.get(`${bi_baseBEUrl}/api/categories?search=${n}&offset=${this.offset}&limit=${this.limit}&sort=${this.sort}&direction=${this.direction}`,this.login.createAuthorizationHeader())}stats(){return this.http.get(`${bi_baseBEUrl}/api/categories/stats/get`,this.login.createAuthorizationHeader())}getOne(n){return this.http.get(`${bi_baseBEUrl}/api/categories/${n}`,this.login.createAuthorizationHeader())}getAll(){return this.http.get(`${bi_baseBEUrl}/api/categories?search%5Bvalue%5D=&start=0&length=-1&sort=name&direction=ASC`,this.login.createAuthorizationHeader())}save(n){return""!==n.id?this.http.put(`${bi_baseBEUrl}/api/categories/${n.id}`,n,this.login.createAuthorizationHeader()):this.http.post(`${bi_baseBEUrl}/api/categories`,n,this.login.createAuthorizationHeader())}delete(n){return this.http.delete(`${bi_baseBEUrl}/api/categories/${n.id}`,this.login.createAuthorizationHeader())}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(od),ze(Hs),ze(Ec))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();const s9=new Kt("MatFormField"),a9=new Kt("MAT_INPUT_VALUE_ACCESSOR"),l9=["mat-calendar-body",""];function c9(e,t){if(1&e&&(ce(0,"tr",3)(1,"td",4),Te(2),ue()()),2&e){const r=Dn();we(1),te("padding-top",r._cellPadding)("padding-bottom",r._cellPadding),Fr("colspan",r.numCols),we(1),Xn(" ",r.label," ")}}function u9(e,t){if(1&e&&(ce(0,"td",4),Te(1),ue()),2&e){const r=Dn(2);te("padding-top",r._cellPadding)("padding-bottom",r._cellPadding),Fr("colspan",r._firstRowOffset),we(1),Xn(" ",r._firstRowOffset>=r.labelMinRequiredCells?r.label:""," ")}}function d9(e,t){if(1&e){const r=Sr();ce(0,"td",8)(1,"button",9),zt("click",function(s){const m=Mn(r).$implicit;return Cn(Dn(2)._cellClicked(m,s))})("focus",function(s){const m=Mn(r).$implicit;return Cn(Dn(2)._emitActiveDateChange(m,s))}),ce(2,"span",10),Te(3),ue(),it(4,"span",11),ue()()}if(2&e){const r=t.$implicit,n=t.index,s=Dn().index,u=Dn();te("width",u._cellWidth)("padding-top",u._cellPadding)("padding-bottom",u._cellPadding),Fr("data-mat-row",s)("data-mat-col",n),we(1),ie("mat-calendar-body-disabled",!r.enabled)("mat-calendar-body-active",u._isActiveCell(s,n))("mat-calendar-body-range-start",u._isRangeStart(r.compareValue))("mat-calendar-body-range-end",u._isRangeEnd(r.compareValue))("mat-calendar-body-in-range",u._isInRange(r.compareValue))("mat-calendar-body-comparison-bridge-start",u._isComparisonBridgeStart(r.compareValue,s,n))("mat-calendar-body-comparison-bridge-end",u._isComparisonBridgeEnd(r.compareValue,s,n))("mat-calendar-body-comparison-start",u._isComparisonStart(r.compareValue))("mat-calendar-body-comparison-end",u._isComparisonEnd(r.compareValue))("mat-calendar-body-in-comparison-range",u._isInComparisonRange(r.compareValue))("mat-calendar-body-preview-start",u._isPreviewStart(r.compareValue))("mat-calendar-body-preview-end",u._isPreviewEnd(r.compareValue))("mat-calendar-body-in-preview",u._isInPreview(r.compareValue)),Be("ngClass",r.cssClasses)("tabindex",u._isActiveCell(s,n)?0:-1),Fr("aria-label",r.ariaLabel)("aria-disabled",!r.enabled||null)("aria-pressed",u._isSelected(r.compareValue))("aria-current",u.todayValue===r.compareValue?"date":null)("aria-describedby",u._getDescribedby(r.compareValue)),we(1),ie("mat-calendar-body-selected",u._isSelected(r.compareValue))("mat-calendar-body-comparison-identical",u._isComparisonIdentical(r.compareValue))("mat-calendar-body-today",u.todayValue===r.compareValue),we(1),Xn(" ",r.displayValue," ")}}function h9(e,t){if(1&e&&(ce(0,"tr",5),Ln(1,u9,2,6,"td",6),Ln(2,d9,5,48,"td",7),ue()),2&e){const r=t.$implicit,n=t.index,s=Dn();we(1),Be("ngIf",0===n&&s._firstRowOffset),we(1),Be("ngForOf",r)}}function f9(e,t){if(1&e&&(ce(0,"th",5)(1,"span",6),Te(2),ue(),ce(3,"span",7),Te(4),ue()()),2&e){const r=t.$implicit;we(2),hn(r.long),we(2),hn(r.narrow)}}const p9=["*"];function m9(e,t){}function g9(e,t){if(1&e){const r=Sr();ce(0,"mat-month-view",5),zt("activeDateChange",function(s){return Mn(r),Cn(Dn().activeDate=s)})("_userSelection",function(s){return Mn(r),Cn(Dn()._dateSelected(s))})("dragStarted",function(s){return Mn(r),Cn(Dn()._dragStarted(s))})("dragEnded",function(s){return Mn(r),Cn(Dn()._dragEnded(s))}),ue()}if(2&e){const r=Dn();Be("activeDate",r.activeDate)("selected",r.selected)("dateFilter",r.dateFilter)("maxDate",r.maxDate)("minDate",r.minDate)("dateClass",r.dateClass)("comparisonStart",r.comparisonStart)("comparisonEnd",r.comparisonEnd)("startDateAccessibleName",r.startDateAccessibleName)("endDateAccessibleName",r.endDateAccessibleName)("activeDrag",r._activeDrag)}}function _9(e,t){if(1&e){const r=Sr();ce(0,"mat-year-view",6),zt("activeDateChange",function(s){return Mn(r),Cn(Dn().activeDate=s)})("monthSelected",function(s){return Mn(r),Cn(Dn()._monthSelectedInYearView(s))})("selectedChange",function(s){return Mn(r),Cn(Dn()._goToDateInView(s,"month"))}),ue()}if(2&e){const r=Dn();Be("activeDate",r.activeDate)("selected",r.selected)("dateFilter",r.dateFilter)("maxDate",r.maxDate)("minDate",r.minDate)("dateClass",r.dateClass)}}function y9(e,t){if(1&e){const r=Sr();ce(0,"mat-multi-year-view",7),zt("activeDateChange",function(s){return Mn(r),Cn(Dn().activeDate=s)})("yearSelected",function(s){return Mn(r),Cn(Dn()._yearSelectedInMultiYearView(s))})("selectedChange",function(s){return Mn(r),Cn(Dn()._goToDateInView(s,"year"))}),ue()}if(2&e){const r=Dn();Be("activeDate",r.activeDate)("selected",r.selected)("dateFilter",r.dateFilter)("maxDate",r.maxDate)("minDate",r.minDate)("dateClass",r.dateClass)}}function v9(e,t){}let fD=(()=>{var e;class t{constructor(){this.changes=new qe,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.closeCalendarLabel="Close calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 24 years",this.nextMultiYearLabel="Next 24 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year",this.startDateLabel="Start date",this.endDateLabel="End date"}formatYearRange(n,s){return`${n} \u2013 ${s}`}formatYearRangeLabel(n,s){return`${n} to ${s}`}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();class gA{constructor(t,r,n,s,u={},m=t,b){this.value=t,this.displayValue=r,this.ariaLabel=n,this.enabled=s,this.cssClasses=u,this.compareValue=m,this.rawValue=b}}let b9=1;const n3=hm({passive:!1,capture:!0}),wm=hm({passive:!0,capture:!0}),pD=hm({passive:!0});let Ov=(()=>{var e;class t{ngAfterViewChecked(){this._focusActiveCellAfterViewChecked&&(this._focusActiveCell(),this._focusActiveCellAfterViewChecked=!1)}constructor(n,s){this._elementRef=n,this._ngZone=s,this._platform=Jt(Ms),this._focusActiveCellAfterViewChecked=!1,this.numCols=7,this.activeCell=0,this.isRange=!1,this.cellAspectRatio=1,this.previewStart=null,this.previewEnd=null,this.selectedValueChange=new Wn,this.previewChange=new Wn,this.activeDateChange=new Wn,this.dragStarted=new Wn,this.dragEnded=new Wn,this._didDragSinceMouseDown=!1,this._enterHandler=u=>{if(this._skipNextFocus&&"focus"===u.type)this._skipNextFocus=!1;else if(u.target&&this.isRange){const m=this._getCellFromElement(u.target);m&&this._ngZone.run(()=>this.previewChange.emit({value:m.enabled?m:null,event:u}))}},this._touchmoveHandler=u=>{if(!this.isRange)return;const m=r3(u),b=m?this._getCellFromElement(m):null;m!==u.target&&(this._didDragSinceMouseDown=!0),yA(u.target)&&u.preventDefault(),this._ngZone.run(()=>this.previewChange.emit({value:b?.enabled?b:null,event:u}))},this._leaveHandler=u=>{null!==this.previewEnd&&this.isRange&&("blur"!==u.type&&(this._didDragSinceMouseDown=!0),u.target&&this._getCellFromElement(u.target)&&(!u.relatedTarget||!this._getCellFromElement(u.relatedTarget))&&this._ngZone.run(()=>this.previewChange.emit({value:null,event:u})))},this._mousedownHandler=u=>{if(!this.isRange)return;this._didDragSinceMouseDown=!1;const m=u.target&&this._getCellFromElement(u.target);!m||!this._isInRange(m.rawValue)||this._ngZone.run(()=>{this.dragStarted.emit({value:m.rawValue,event:u})})},this._mouseupHandler=u=>{if(!this.isRange)return;const m=yA(u.target);m?m.closest(".mat-calendar-body")===this._elementRef.nativeElement&&this._ngZone.run(()=>{const b=this._getCellFromElement(m);this.dragEnded.emit({value:b?.rawValue??null,event:u})}):this._ngZone.run(()=>{this.dragEnded.emit({value:null,event:u})})},this._touchendHandler=u=>{const m=r3(u);m&&this._mouseupHandler({target:m})},this._id="mat-calendar-body-"+b9++,this._startDateLabelId=`${this._id}-start-date`,this._endDateLabelId=`${this._id}-end-date`,s.runOutsideAngular(()=>{const u=n.nativeElement;u.addEventListener("touchmove",this._touchmoveHandler,n3),u.addEventListener("mouseenter",this._enterHandler,wm),u.addEventListener("focus",this._enterHandler,wm),u.addEventListener("mouseleave",this._leaveHandler,wm),u.addEventListener("blur",this._leaveHandler,wm),u.addEventListener("mousedown",this._mousedownHandler,pD),u.addEventListener("touchstart",this._mousedownHandler,pD),this._platform.isBrowser&&(window.addEventListener("mouseup",this._mouseupHandler),window.addEventListener("touchend",this._touchendHandler))})}_cellClicked(n,s){this._didDragSinceMouseDown||n.enabled&&this.selectedValueChange.emit({value:n.value,event:s})}_emitActiveDateChange(n,s){n.enabled&&this.activeDateChange.emit({value:n.value,event:s})}_isSelected(n){return this.startValue===n||this.endValue===n}ngOnChanges(n){const s=n.numCols,{rows:u,numCols:m}=this;(n.rows||s)&&(this._firstRowOffset=u&&u.length&&u[0].length?m-u[0].length:0),(n.cellAspectRatio||s||!this._cellPadding)&&(this._cellPadding=50*this.cellAspectRatio/m+"%"),(s||!this._cellWidth)&&(this._cellWidth=100/m+"%")}ngOnDestroy(){const n=this._elementRef.nativeElement;n.removeEventListener("touchmove",this._touchmoveHandler,n3),n.removeEventListener("mouseenter",this._enterHandler,wm),n.removeEventListener("focus",this._enterHandler,wm),n.removeEventListener("mouseleave",this._leaveHandler,wm),n.removeEventListener("blur",this._leaveHandler,wm),n.removeEventListener("mousedown",this._mousedownHandler,pD),n.removeEventListener("touchstart",this._mousedownHandler,pD),this._platform.isBrowser&&(window.removeEventListener("mouseup",this._mouseupHandler),window.removeEventListener("touchend",this._touchendHandler))}_isActiveCell(n,s){let u=n*this.numCols+s;return n&&(u-=this._firstRowOffset),u==this.activeCell}_focusActiveCell(n=!0){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(Us(1)).subscribe(()=>{setTimeout(()=>{const s=this._elementRef.nativeElement.querySelector(".mat-calendar-body-active");s&&(n||(this._skipNextFocus=!0),s.focus())})})})}_scheduleFocusActiveCellAfterViewChecked(){this._focusActiveCellAfterViewChecked=!0}_isRangeStart(n){return vA(n,this.startValue,this.endValue)}_isRangeEnd(n){return bA(n,this.startValue,this.endValue)}_isInRange(n){return xA(n,this.startValue,this.endValue,this.isRange)}_isComparisonStart(n){return vA(n,this.comparisonStart,this.comparisonEnd)}_isComparisonBridgeStart(n,s,u){if(!this._isComparisonStart(n)||this._isRangeStart(n)||!this._isInRange(n))return!1;let m=this.rows[s][u-1];if(!m){const b=this.rows[s-1];m=b&&b[b.length-1]}return m&&!this._isRangeEnd(m.compareValue)}_isComparisonBridgeEnd(n,s,u){if(!this._isComparisonEnd(n)||this._isRangeEnd(n)||!this._isInRange(n))return!1;let m=this.rows[s][u+1];if(!m){const b=this.rows[s+1];m=b&&b[0]}return m&&!this._isRangeStart(m.compareValue)}_isComparisonEnd(n){return bA(n,this.comparisonStart,this.comparisonEnd)}_isInComparisonRange(n){return xA(n,this.comparisonStart,this.comparisonEnd,this.isRange)}_isComparisonIdentical(n){return this.comparisonStart===this.comparisonEnd&&n===this.comparisonStart}_isPreviewStart(n){return vA(n,this.previewStart,this.previewEnd)}_isPreviewEnd(n){return bA(n,this.previewStart,this.previewEnd)}_isInPreview(n){return xA(n,this.previewStart,this.previewEnd,this.isRange)}_getDescribedby(n){return this.isRange?this.startValue===n&&this.endValue===n?`${this._startDateLabelId} ${this._endDateLabelId}`:this.startValue===n?this._startDateLabelId:this.endValue===n?this._endDateLabelId:null:null}_getCellFromElement(n){const s=yA(n);if(s){const u=s.getAttribute("data-mat-row"),m=s.getAttribute("data-mat-col");if(u&&m)return this.rows[parseInt(u)][parseInt(m)]}return null}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(tr),xe(si))},e.\u0275cmp=Ci({type:e,selectors:[["","mat-calendar-body",""]],hostAttrs:[1,"mat-calendar-body"],inputs:{label:"label",rows:"rows",todayValue:"todayValue",startValue:"startValue",endValue:"endValue",labelMinRequiredCells:"labelMinRequiredCells",numCols:"numCols",activeCell:"activeCell",isRange:"isRange",cellAspectRatio:"cellAspectRatio",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",previewStart:"previewStart",previewEnd:"previewEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedValueChange:"selectedValueChange",previewChange:"previewChange",activeDateChange:"activeDateChange",dragStarted:"dragStarted",dragEnded:"dragEnded"},exportAs:["matCalendarBody"],features:[v],attrs:l9,decls:6,vars:6,consts:[["aria-hidden","true",4,"ngIf"],["role","row",4,"ngFor","ngForOf"],[1,"mat-calendar-body-hidden-label",3,"id"],["aria-hidden","true"],[1,"mat-calendar-body-label"],["role","row"],["class","mat-calendar-body-label",3,"paddingTop","paddingBottom",4,"ngIf"],["role","gridcell","class","mat-calendar-body-cell-container",3,"width","paddingTop","paddingBottom",4,"ngFor","ngForOf"],["role","gridcell",1,"mat-calendar-body-cell-container"],["type","button",1,"mat-calendar-body-cell",3,"ngClass","tabindex","click","focus"],[1,"mat-calendar-body-cell-content","mat-focus-indicator"],["aria-hidden","true",1,"mat-calendar-body-cell-preview"]],template:function(n,s){1&n&&(Ln(0,c9,3,6,"tr",0),Ln(1,h9,3,2,"tr",1),ce(2,"label",2),Te(3),ue(),ce(4,"label",2),Te(5),ue()),2&n&&(Be("ngIf",s._firstRowOffset<s.labelMinRequiredCells),we(1),Be("ngForOf",s.rows),we(1),Be("id",s._startDateLabelId),we(1),Xn(" ",s.startDateAccessibleName,"\n"),we(1),Be("id",s._endDateLabelId),we(1),Xn(" ",s.endDateAccessibleName,"\n"))},dependencies:[px,Gl,Na],styles:['.mat-calendar-body{min-width:224px}.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-outline-color)}.mat-calendar-body-label{height:0;line-height:0;text-align:left;padding-left:4.7142857143%;padding-right:4.7142857143%;font-size:var(--mat-datepicker-calendar-body-label-text-size);font-weight:var(--mat-datepicker-calendar-body-label-text-weight);color:var(--mat-datepicker-calendar-body-label-text-color)}.mat-calendar-body-hidden-label{display:none}.mat-calendar-body-cell-container{position:relative;height:0;line-height:0}.mat-calendar-body-cell{-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);position:absolute;top:0;left:0;width:100%;height:100%;background:none;text-align:center;outline:none;font-family:inherit;margin:0}.mat-calendar-body-cell::-moz-focus-inner{border:0}.mat-calendar-body-cell::before,.mat-calendar-body-cell::after,.mat-calendar-body-cell-preview{content:"";position:absolute;top:5%;left:0;z-index:0;box-sizing:border-box;display:block;height:90%;width:100%}.mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-start::after,.mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,.mat-calendar-body-comparison-start::after,.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:5%;width:95%;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,[dir=rtl] .mat-calendar-body-comparison-start::after,[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:0;border-radius:0;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,.mat-calendar-body-comparison-end::after,.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}[dir=rtl] .mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,[dir=rtl] .mat-calendar-body-comparison-end::after,[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{left:5%;border-radius:0;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-comparison-bridge-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-bridge-end.mat-calendar-body-range-start::after{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end.mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-end.mat-calendar-body-range-start::after{width:90%}.mat-calendar-body-in-preview{color:var(--mat-datepicker-calendar-date-preview-state-outline-color)}.mat-calendar-body-in-preview .mat-calendar-body-cell-preview{border-top:dashed 1px;border-bottom:dashed 1px}.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:dashed 1px}[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:0;border-right:dashed 1px}.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:dashed 1px}[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:0;border-left:dashed 1px}.mat-calendar-body-disabled{cursor:default}.mat-calendar-body-disabled>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){color:var(--mat-datepicker-calendar-date-disabled-state-text-color)}.mat-calendar-body-disabled>.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-disabled-state-outline-color)}.cdk-high-contrast-active .mat-calendar-body-disabled{opacity:.5}.mat-calendar-body-cell-content{top:5%;left:5%;z-index:1;display:flex;align-items:center;justify-content:center;box-sizing:border-box;width:90%;height:90%;line-height:1;border-width:1px;border-style:solid;border-radius:999px;color:var(--mat-datepicker-calendar-date-text-color);border-color:var(--mat-datepicker-calendar-date-outline-color)}.mat-calendar-body-cell-content.mat-focus-indicator{position:absolute}.cdk-high-contrast-active .mat-calendar-body-cell-content{border:none}.cdk-keyboard-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical),.cdk-program-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-focus-state-background-color)}@media(hover: hover){.mat-calendar-body-cell:not(.mat-calendar-body-disabled):hover>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-hover-state-background-color)}}.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-state-background-color);color:var(--mat-datepicker-calendar-date-selected-state-text-color)}.mat-calendar-body-disabled>.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-disabled-state-background-color)}.mat-calendar-body-selected.mat-calendar-body-today{box-shadow:inset 0 0 0 1px var(--mat-datepicker-calendar-date-today-selected-state-outline-color)}.mat-calendar-body-in-range::before{background:var(--mat-datepicker-calendar-date-in-range-state-background-color)}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color)}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color)}.mat-calendar-body-comparison-bridge-start::before,[dir=rtl] .mat-calendar-body-comparison-bridge-end::before{background:linear-gradient(to right, var(--mat-datepicker-calendar-date-in-range-state-background-color) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color) 50%)}.mat-calendar-body-comparison-bridge-end::before,[dir=rtl] .mat-calendar-body-comparison-bridge-start::before{background:linear-gradient(to left, var(--mat-datepicker-calendar-date-in-range-state-background-color) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color) 50%)}.mat-calendar-body-in-range>.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range.mat-calendar-body-in-range::after{background:var(--mat-datepicker-calendar-date-in-overlap-range-state-background-color)}.mat-calendar-body-comparison-identical.mat-calendar-body-selected,.mat-calendar-body-in-comparison-range>.mat-calendar-body-selected{background:var(--mat-datepicker-calendar-date-in-overlap-range-selected-state-background-color)}.cdk-high-contrast-active .mat-datepicker-popup:not(:empty),.cdk-high-contrast-active .mat-calendar-body-cell:not(.mat-calendar-body-in-range) .mat-calendar-body-selected{outline:solid 1px}.cdk-high-contrast-active .mat-calendar-body-today{outline:dotted 1px}.cdk-high-contrast-active .mat-calendar-body-cell::before,.cdk-high-contrast-active .mat-calendar-body-cell::after,.cdk-high-contrast-active .mat-calendar-body-selected{background:none}.cdk-high-contrast-active .mat-calendar-body-in-range::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-start::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-end::before{border-top:solid 1px;border-bottom:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:0;border-right:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:0;border-left:solid 1px}.cdk-high-contrast-active .mat-calendar-body-in-comparison-range::before{border-top:dashed 1px;border-bottom:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:0;border-right:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:0;border-left:dashed 1px}[dir=rtl] .mat-calendar-body-label{text-align:right}'],encapsulation:2,changeDetection:0}),t})();function _A(e){return"TD"===e?.nodeName}function yA(e){let t;return _A(e)?t=e:_A(e.parentNode)?t=e.parentNode:_A(e.parentNode?.parentNode)&&(t=e.parentNode.parentNode),null!=t?.getAttribute("data-mat-row")?t:null}function vA(e,t,r){return null!==r&&t!==r&&e<r&&e===t}function bA(e,t,r){return null!==t&&t!==r&&e>=t&&e===r}function xA(e,t,r,n){return n&&null!==t&&null!==r&&t!==r&&e>=t&&e<=r}function r3(e){const t=e.changedTouches[0];return document.elementFromPoint(t.clientX,t.clientY)}class gl{constructor(t,r){this.start=t,this.end=r}}let Cm=(()=>{var e;class t{constructor(n,s){this.selection=n,this._adapter=s,this._selectionChanged=new qe,this.selectionChanged=this._selectionChanged,this.selection=n}updateSelection(n,s){const u=this.selection;this.selection=n,this._selectionChanged.next({selection:n,source:s,oldValue:u})}ngOnDestroy(){this._selectionChanged.complete()}_isValidDateInstance(n){return this._adapter.isDateInstance(n)&&this._adapter.isValid(n)}}return(e=t).\u0275fac=function(n){ol()},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})(),x9=(()=>{var e;class t extends Cm{constructor(n){super(null,n)}add(n){super.updateSelection(n,this)}isValid(){return null!=this.selection&&this._isValidDateInstance(this.selection)}isComplete(){return null!=this.selection}clone(){const n=new t(this._adapter);return n.updateSelection(this.selection,this),n}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(la))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})();const o3={provide:Cm,deps:[[new Bd,new tf,Cm],la],useFactory:function C9(e,t){return e||new x9(t)}},mD=new Kt("MAT_DATE_RANGE_SELECTION_STRATEGY");let s3=(()=>{var e;class t{get activeDate(){return this._activeDate}set activeDate(n){const s=this._activeDate,u=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(u,this.minDate,this.maxDate),this._hasSameMonthAndYear(s,this._activeDate)||this._init()}get selected(){return this._selected}set selected(n){this._selected=n instanceof gl?n:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n)),this._setRanges(this._selected)}get minDate(){return this._minDate}set minDate(n){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}get maxDate(){return this._maxDate}set maxDate(n){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}constructor(n,s,u,m,b){this._changeDetectorRef=n,this._dateFormats=s,this._dateAdapter=u,this._dir=m,this._rangeStrategy=b,this._rerenderSubscription=me.EMPTY,this.activeDrag=null,this.selectedChange=new Wn,this._userSelection=new Wn,this.dragStarted=new Wn,this.dragEnded=new Wn,this.activeDateChange=new Wn,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(bx(null)).subscribe(()=>this._init())}ngOnChanges(n){const s=n.comparisonStart||n.comparisonEnd;s&&!s.firstChange&&this._setRanges(this.selected),n.activeDrag&&!this.activeDrag&&this._clearPreview()}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_dateSelected(n){const s=n.value,u=this._getDateFromDayOfMonth(s);let m,b;this._selected instanceof gl?(m=this._getDateInCurrentMonth(this._selected.start),b=this._getDateInCurrentMonth(this._selected.end)):m=b=this._getDateInCurrentMonth(this._selected),(m!==s||b!==s)&&this.selectedChange.emit(u),this._userSelection.emit({value:u,event:n.event}),this._clearPreview(),this._changeDetectorRef.markForCheck()}_updateActiveDate(n){const u=this._activeDate;this.activeDate=this._getDateFromDayOfMonth(n.value),this._dateAdapter.compareDate(u,this.activeDate)&&this.activeDateChange.emit(this._activeDate)}_handleCalendarBodyKeydown(n){const s=this._activeDate,u=this._isRtl();switch(n.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,u?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,u?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,-7);break;case 40:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,7);break;case 36:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,1-this._dateAdapter.getDate(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,this._dateAdapter.getNumDaysInMonth(this._activeDate)-this._dateAdapter.getDate(this._activeDate));break;case 33:this.activeDate=n.altKey?this._dateAdapter.addCalendarYears(this._activeDate,-1):this._dateAdapter.addCalendarMonths(this._activeDate,-1);break;case 34:this.activeDate=n.altKey?this._dateAdapter.addCalendarYears(this._activeDate,1):this._dateAdapter.addCalendarMonths(this._activeDate,1);break;case 13:case 32:return this._selectionKeyPressed=!0,void(this._canSelect(this._activeDate)&&n.preventDefault());case 27:return void(null!=this._previewEnd&&!y_(n)&&(this._clearPreview(),this.activeDrag?this.dragEnded.emit({value:null,event:n}):(this.selectedChange.emit(null),this._userSelection.emit({value:null,event:n})),n.preventDefault(),n.stopPropagation()));default:return}this._dateAdapter.compareDate(s,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),n.preventDefault()}_handleCalendarBodyKeyup(n){(32===n.keyCode||13===n.keyCode)&&(this._selectionKeyPressed&&this._canSelect(this._activeDate)&&this._dateSelected({value:this._dateAdapter.getDate(this._activeDate),event:n}),this._selectionKeyPressed=!1)}_init(){this._setRanges(this.selected),this._todayDate=this._getCellCompareValue(this._dateAdapter.today()),this._monthLabel=this._dateFormats.display.monthLabel?this._dateAdapter.format(this.activeDate,this._dateFormats.display.monthLabel):this._dateAdapter.getMonthNames("short")[this._dateAdapter.getMonth(this.activeDate)].toLocaleUpperCase();let n=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),1);this._firstWeekOffset=(7+this._dateAdapter.getDayOfWeek(n)-this._dateAdapter.getFirstDayOfWeek())%7,this._initWeekdays(),this._createWeekCells(),this._changeDetectorRef.markForCheck()}_focusActiveCell(n){this._matCalendarBody._focusActiveCell(n)}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_previewChanged({event:n,value:s}){if(this._rangeStrategy){const u=s?s.rawValue:null,m=this._rangeStrategy.createPreview(u,this.selected,n);if(this._previewStart=this._getCellCompareValue(m.start),this._previewEnd=this._getCellCompareValue(m.end),this.activeDrag&&u){const b=this._rangeStrategy.createDrag?.(this.activeDrag.value,this.selected,u,n);b&&(this._previewStart=this._getCellCompareValue(b.start),this._previewEnd=this._getCellCompareValue(b.end))}this._changeDetectorRef.detectChanges()}}_dragEnded(n){if(this.activeDrag)if(n.value){const s=this._rangeStrategy?.createDrag?.(this.activeDrag.value,this.selected,n.value,n.event);this.dragEnded.emit({value:s??null,event:n.event})}else this.dragEnded.emit({value:null,event:n.event})}_getDateFromDayOfMonth(n){return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),n)}_initWeekdays(){const n=this._dateAdapter.getFirstDayOfWeek(),s=this._dateAdapter.getDayOfWeekNames("narrow");let m=this._dateAdapter.getDayOfWeekNames("long").map((b,T)=>({long:b,narrow:s[T]}));this._weekdays=m.slice(n).concat(m.slice(0,n))}_createWeekCells(){const n=this._dateAdapter.getNumDaysInMonth(this.activeDate),s=this._dateAdapter.getDateNames();this._weeks=[[]];for(let u=0,m=this._firstWeekOffset;u<n;u++,m++){7==m&&(this._weeks.push([]),m=0);const b=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),u+1),T=this._shouldEnableDate(b),R=this._dateAdapter.format(b,this._dateFormats.display.dateA11yLabel),z=this.dateClass?this.dateClass(b,"month"):void 0;this._weeks[this._weeks.length-1].push(new gA(u+1,s[u],R,T,z,this._getCellCompareValue(b),b))}}_shouldEnableDate(n){return!!n&&(!this.minDate||this._dateAdapter.compareDate(n,this.minDate)>=0)&&(!this.maxDate||this._dateAdapter.compareDate(n,this.maxDate)<=0)&&(!this.dateFilter||this.dateFilter(n))}_getDateInCurrentMonth(n){return n&&this._hasSameMonthAndYear(n,this.activeDate)?this._dateAdapter.getDate(n):null}_hasSameMonthAndYear(n,s){return!(!n||!s||this._dateAdapter.getMonth(n)!=this._dateAdapter.getMonth(s)||this._dateAdapter.getYear(n)!=this._dateAdapter.getYear(s))}_getCellCompareValue(n){if(n){const s=this._dateAdapter.getYear(n),u=this._dateAdapter.getMonth(n),m=this._dateAdapter.getDate(n);return new Date(s,u,m).getTime()}return null}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setRanges(n){n instanceof gl?(this._rangeStart=this._getCellCompareValue(n.start),this._rangeEnd=this._getCellCompareValue(n.end),this._isRange=!0):(this._rangeStart=this._rangeEnd=this._getCellCompareValue(n),this._isRange=!1),this._comparisonRangeStart=this._getCellCompareValue(this.comparisonStart),this._comparisonRangeEnd=this._getCellCompareValue(this.comparisonEnd)}_canSelect(n){return!this.dateFilter||this.dateFilter(n)}_clearPreview(){this._previewStart=this._previewEnd=null}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(La),xe(pm,8),xe(la,8),xe(Av,8),xe(mD,8))},e.\u0275cmp=Ci({type:e,selectors:[["mat-month-view"]],viewQuery:function(n,s){if(1&n&&ul(Ov,5),2&n){let u;Oa(u=Fa())&&(s._matCalendarBody=u.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName",activeDrag:"activeDrag"},outputs:{selectedChange:"selectedChange",_userSelection:"_userSelection",dragStarted:"dragStarted",dragEnded:"dragEnded",activeDateChange:"activeDateChange"},exportAs:["matMonthView"],features:[v],decls:7,vars:15,consts:[["role","grid",1,"mat-calendar-table"],[1,"mat-calendar-table-header"],["scope","col",4,"ngFor","ngForOf"],["aria-hidden","true","colspan","7",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"label","rows","todayValue","startValue","endValue","comparisonStart","comparisonEnd","previewStart","previewEnd","isRange","labelMinRequiredCells","activeCell","startDateAccessibleName","endDateAccessibleName","selectedValueChange","activeDateChange","previewChange","dragStarted","dragEnded","keyup","keydown"],["scope","col"],[1,"cdk-visually-hidden"],["aria-hidden","true"]],template:function(n,s){1&n&&(ce(0,"table",0)(1,"thead",1)(2,"tr"),Ln(3,f9,5,2,"th",2),ue(),ce(4,"tr"),it(5,"th",3),ue()(),ce(6,"tbody",4),zt("selectedValueChange",function(m){return s._dateSelected(m)})("activeDateChange",function(m){return s._updateActiveDate(m)})("previewChange",function(m){return s._previewChanged(m)})("dragStarted",function(m){return s.dragStarted.emit(m)})("dragEnded",function(m){return s._dragEnded(m)})("keyup",function(m){return s._handleCalendarBodyKeyup(m)})("keydown",function(m){return s._handleCalendarBodyKeydown(m)}),ue()()),2&n&&(we(3),Be("ngForOf",s._weekdays),we(3),Be("label",s._monthLabel)("rows",s._weeks)("todayValue",s._todayDate)("startValue",s._rangeStart)("endValue",s._rangeEnd)("comparisonStart",s._comparisonRangeStart)("comparisonEnd",s._comparisonRangeEnd)("previewStart",s._previewStart)("previewEnd",s._previewEnd)("isRange",s._isRange)("labelMinRequiredCells",3)("activeCell",s._dateAdapter.getDate(s.activeDate)-1)("startDateAccessibleName",s.startDateAccessibleName)("endDateAccessibleName",s.endDateAccessibleName))},dependencies:[Gl,Ov],encapsulation:2,changeDetection:0}),t})();const Ac=24;let a3=(()=>{var e;class t{get activeDate(){return this._activeDate}set activeDate(n){let s=this._activeDate;const u=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(u,this.minDate,this.maxDate),l3(this._dateAdapter,s,this._activeDate,this.minDate,this.maxDate)||this._init()}get selected(){return this._selected}set selected(n){this._selected=n instanceof gl?n:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n)),this._setSelectedYear(n)}get minDate(){return this._minDate}set minDate(n){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}get maxDate(){return this._maxDate}set maxDate(n){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}constructor(n,s,u){this._changeDetectorRef=n,this._dateAdapter=s,this._dir=u,this._rerenderSubscription=me.EMPTY,this.selectedChange=new Wn,this.yearSelected=new Wn,this.activeDateChange=new Wn,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(bx(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_init(){this._todayYear=this._dateAdapter.getYear(this._dateAdapter.today());const s=this._dateAdapter.getYear(this._activeDate)-h1(this._dateAdapter,this.activeDate,this.minDate,this.maxDate);this._years=[];for(let u=0,m=[];u<Ac;u++)m.push(s+u),4==m.length&&(this._years.push(m.map(b=>this._createCellForYear(b))),m=[]);this._changeDetectorRef.markForCheck()}_yearSelected(n){const s=n.value,u=this._dateAdapter.createDate(s,0,1),m=this._getDateFromYear(s);this.yearSelected.emit(u),this.selectedChange.emit(m)}_updateActiveDate(n){const u=this._activeDate;this.activeDate=this._getDateFromYear(n.value),this._dateAdapter.compareDate(u,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(n){const s=this._activeDate,u=this._isRtl();switch(n.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,u?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,u?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-h1(this._dateAdapter,this.activeDate,this.minDate,this.maxDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,Ac-h1(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)-1);break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,n.altKey?10*-Ac:-Ac);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,n.altKey?10*Ac:Ac);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(s,this.activeDate)&&this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked(),n.preventDefault()}_handleCalendarBodyKeyup(n){(32===n.keyCode||13===n.keyCode)&&(this._selectionKeyPressed&&this._yearSelected({value:this._dateAdapter.getYear(this._activeDate),event:n}),this._selectionKeyPressed=!1)}_getActiveCell(){return h1(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getDateFromYear(n){const s=this._dateAdapter.getMonth(this.activeDate),u=this._dateAdapter.getNumDaysInMonth(this._dateAdapter.createDate(n,s,1));return this._dateAdapter.createDate(n,s,Math.min(this._dateAdapter.getDate(this.activeDate),u))}_createCellForYear(n){const s=this._dateAdapter.createDate(n,0,1),u=this._dateAdapter.getYearName(s),m=this.dateClass?this.dateClass(s,"multi-year"):void 0;return new gA(n,u,u,this._shouldEnableYear(n),m)}_shouldEnableYear(n){if(null==n||this.maxDate&&n>this._dateAdapter.getYear(this.maxDate)||this.minDate&&n<this._dateAdapter.getYear(this.minDate))return!1;if(!this.dateFilter)return!0;for(let u=this._dateAdapter.createDate(n,0,1);this._dateAdapter.getYear(u)==n;u=this._dateAdapter.addCalendarDays(u,1))if(this.dateFilter(u))return!0;return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedYear(n){if(this._selectedYear=null,n instanceof gl){const s=n.start||n.end;s&&(this._selectedYear=this._dateAdapter.getYear(s))}else n&&(this._selectedYear=this._dateAdapter.getYear(n))}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(La),xe(la,8),xe(Av,8))},e.\u0275cmp=Ci({type:e,selectors:[["mat-multi-year-view"]],viewQuery:function(n,s){if(1&n&&ul(Ov,5),2&n){let u;Oa(u=Fa())&&(s._matCalendarBody=u.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",activeDateChange:"activeDateChange"},exportAs:["matMultiYearView"],decls:5,vars:7,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"rows","todayValue","startValue","endValue","numCols","cellAspectRatio","activeCell","selectedValueChange","activeDateChange","keyup","keydown"]],template:function(n,s){1&n&&(ce(0,"table",0)(1,"thead",1)(2,"tr"),it(3,"th",2),ue()(),ce(4,"tbody",3),zt("selectedValueChange",function(m){return s._yearSelected(m)})("activeDateChange",function(m){return s._updateActiveDate(m)})("keyup",function(m){return s._handleCalendarBodyKeyup(m)})("keydown",function(m){return s._handleCalendarBodyKeydown(m)}),ue()()),2&n&&(we(4),Be("rows",s._years)("todayValue",s._todayYear)("startValue",s._selectedYear)("endValue",s._selectedYear)("numCols",4)("cellAspectRatio",4/7)("activeCell",s._getActiveCell()))},dependencies:[Ov],encapsulation:2,changeDetection:0}),t})();function l3(e,t,r,n,s){const u=e.getYear(t),m=e.getYear(r),b=c3(e,n,s);return Math.floor((u-b)/Ac)===Math.floor((m-b)/Ac)}function h1(e,t,r,n){return function S9(e,t){return(e%t+t)%t}(e.getYear(t)-c3(e,r,n),Ac)}function c3(e,t,r){let n=0;return r?n=e.getYear(r)-Ac+1:t&&(n=e.getYear(t)),n}let u3=(()=>{var e;class t{get activeDate(){return this._activeDate}set activeDate(n){let s=this._activeDate;const u=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(u,this.minDate,this.maxDate),this._dateAdapter.getYear(s)!==this._dateAdapter.getYear(this._activeDate)&&this._init()}get selected(){return this._selected}set selected(n){this._selected=n instanceof gl?n:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n)),this._setSelectedMonth(n)}get minDate(){return this._minDate}set minDate(n){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}get maxDate(){return this._maxDate}set maxDate(n){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}constructor(n,s,u,m){this._changeDetectorRef=n,this._dateFormats=s,this._dateAdapter=u,this._dir=m,this._rerenderSubscription=me.EMPTY,this.selectedChange=new Wn,this.monthSelected=new Wn,this.activeDateChange=new Wn,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(bx(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_monthSelected(n){const s=n.value,u=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),s,1);this.monthSelected.emit(u);const m=this._getDateFromMonth(s);this.selectedChange.emit(m)}_updateActiveDate(n){const u=this._activeDate;this.activeDate=this._getDateFromMonth(n.value),this._dateAdapter.compareDate(u,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(n){const s=this._activeDate,u=this._isRtl();switch(n.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,u?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,u?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-this._dateAdapter.getMonth(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,11-this._dateAdapter.getMonth(this._activeDate));break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,n.altKey?-10:-1);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,n.altKey?10:1);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(s,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),n.preventDefault()}_handleCalendarBodyKeyup(n){(32===n.keyCode||13===n.keyCode)&&(this._selectionKeyPressed&&this._monthSelected({value:this._dateAdapter.getMonth(this._activeDate),event:n}),this._selectionKeyPressed=!1)}_init(){this._setSelectedMonth(this.selected),this._todayMonth=this._getMonthInCurrentYear(this._dateAdapter.today()),this._yearLabel=this._dateAdapter.getYearName(this.activeDate);let n=this._dateAdapter.getMonthNames("short");this._months=[[0,1,2,3],[4,5,6,7],[8,9,10,11]].map(s=>s.map(u=>this._createCellForMonth(u,n[u]))),this._changeDetectorRef.markForCheck()}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getMonthInCurrentYear(n){return n&&this._dateAdapter.getYear(n)==this._dateAdapter.getYear(this.activeDate)?this._dateAdapter.getMonth(n):null}_getDateFromMonth(n){const s=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),n,1),u=this._dateAdapter.getNumDaysInMonth(s);return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),n,Math.min(this._dateAdapter.getDate(this.activeDate),u))}_createCellForMonth(n,s){const u=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),n,1),m=this._dateAdapter.format(u,this._dateFormats.display.monthYearA11yLabel),b=this.dateClass?this.dateClass(u,"year"):void 0;return new gA(n,s.toLocaleUpperCase(),m,this._shouldEnableMonth(n),b)}_shouldEnableMonth(n){const s=this._dateAdapter.getYear(this.activeDate);if(null==n||this._isYearAndMonthAfterMaxDate(s,n)||this._isYearAndMonthBeforeMinDate(s,n))return!1;if(!this.dateFilter)return!0;for(let m=this._dateAdapter.createDate(s,n,1);this._dateAdapter.getMonth(m)==n;m=this._dateAdapter.addCalendarDays(m,1))if(this.dateFilter(m))return!0;return!1}_isYearAndMonthAfterMaxDate(n,s){if(this.maxDate){const u=this._dateAdapter.getYear(this.maxDate),m=this._dateAdapter.getMonth(this.maxDate);return n>u||n===u&&s>m}return!1}_isYearAndMonthBeforeMinDate(n,s){if(this.minDate){const u=this._dateAdapter.getYear(this.minDate),m=this._dateAdapter.getMonth(this.minDate);return n<u||n===u&&s<m}return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedMonth(n){this._selectedMonth=n instanceof gl?this._getMonthInCurrentYear(n.start)||this._getMonthInCurrentYear(n.end):this._getMonthInCurrentYear(n)}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(La),xe(pm,8),xe(la,8),xe(Av,8))},e.\u0275cmp=Ci({type:e,selectors:[["mat-year-view"]],viewQuery:function(n,s){if(1&n&&ul(Ov,5),2&n){let u;Oa(u=Fa())&&(s._matCalendarBody=u.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",monthSelected:"monthSelected",activeDateChange:"activeDateChange"},exportAs:["matYearView"],decls:5,vars:9,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"label","rows","todayValue","startValue","endValue","labelMinRequiredCells","numCols","cellAspectRatio","activeCell","selectedValueChange","activeDateChange","keyup","keydown"]],template:function(n,s){1&n&&(ce(0,"table",0)(1,"thead",1)(2,"tr"),it(3,"th",2),ue()(),ce(4,"tbody",3),zt("selectedValueChange",function(m){return s._monthSelected(m)})("activeDateChange",function(m){return s._updateActiveDate(m)})("keyup",function(m){return s._handleCalendarBodyKeyup(m)})("keydown",function(m){return s._handleCalendarBodyKeydown(m)}),ue()()),2&n&&(we(4),Be("label",s._yearLabel)("rows",s._months)("todayValue",s._todayMonth)("startValue",s._selectedMonth)("endValue",s._selectedMonth)("labelMinRequiredCells",2)("numCols",4)("cellAspectRatio",4/7)("activeCell",s._dateAdapter.getMonth(s.activeDate)))},dependencies:[Ov],encapsulation:2,changeDetection:0}),t})(),M9=1,A9=(()=>{var e;class t{constructor(n,s,u,m,b){this._intl=n,this.calendar=s,this._dateAdapter=u,this._dateFormats=m,this._id="mat-calendar-header-"+M9++,this._periodButtonLabelId=`${this._id}-period-label`,this.calendar.stateChanges.subscribe(()=>b.markForCheck())}get periodButtonText(){return"month"==this.calendar.currentView?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():"year"==this.calendar.currentView?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRange(...this._formatMinAndMaxYearLabels())}get periodButtonDescription(){return"month"==this.calendar.currentView?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():"year"==this.calendar.currentView?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRangeLabel(...this._formatMinAndMaxYearLabels())}get periodButtonLabel(){return"month"==this.calendar.currentView?this._intl.switchToMultiYearViewLabel:this._intl.switchToMonthViewLabel}get prevButtonLabel(){return{month:this._intl.prevMonthLabel,year:this._intl.prevYearLabel,"multi-year":this._intl.prevMultiYearLabel}[this.calendar.currentView]}get nextButtonLabel(){return{month:this._intl.nextMonthLabel,year:this._intl.nextYearLabel,"multi-year":this._intl.nextMultiYearLabel}[this.calendar.currentView]}currentPeriodClicked(){this.calendar.currentView="month"==this.calendar.currentView?"multi-year":"month"}previousClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,-1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?-1:-Ac)}nextClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?1:Ac)}previousEnabled(){return!this.calendar.minDate||!this.calendar.minDate||!this._isSameView(this.calendar.activeDate,this.calendar.minDate)}nextEnabled(){return!this.calendar.maxDate||!this._isSameView(this.calendar.activeDate,this.calendar.maxDate)}_isSameView(n,s){return"month"==this.calendar.currentView?this._dateAdapter.getYear(n)==this._dateAdapter.getYear(s)&&this._dateAdapter.getMonth(n)==this._dateAdapter.getMonth(s):"year"==this.calendar.currentView?this._dateAdapter.getYear(n)==this._dateAdapter.getYear(s):l3(this._dateAdapter,n,s,this.calendar.minDate,this.calendar.maxDate)}_formatMinAndMaxYearLabels(){const s=this._dateAdapter.getYear(this.calendar.activeDate)-h1(this._dateAdapter,this.calendar.activeDate,this.calendar.minDate,this.calendar.maxDate),u=s+Ac-1;return[this._dateAdapter.getYearName(this._dateAdapter.createDate(s,0,1)),this._dateAdapter.getYearName(this._dateAdapter.createDate(u,0,1))]}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(fD),xe(Ki(()=>EA)),xe(la,8),xe(pm,8),xe(La))},e.\u0275cmp=Ci({type:e,selectors:[["mat-calendar-header"]],exportAs:["matCalendarHeader"],ngContentSelectors:p9,decls:13,vars:11,consts:[[1,"mat-calendar-header"],[1,"mat-calendar-controls"],["mat-button","","type","button","aria-live","polite",1,"mat-calendar-period-button",3,"click"],["aria-hidden","true"],["viewBox","0 0 10 5","focusable","false","aria-hidden","true",1,"mat-calendar-arrow"],["points","0,0 5,5 10,0"],[1,"mat-calendar-spacer"],["mat-icon-button","","type","button",1,"mat-calendar-previous-button",3,"disabled","click"],["mat-icon-button","","type","button",1,"mat-calendar-next-button",3,"disabled","click"],[1,"mat-calendar-hidden-label",3,"id"]],template:function(n,s){1&n&&(If(),ce(0,"div",0)(1,"div",1)(2,"button",2),zt("click",function(){return s.currentPeriodClicked()}),ce(3,"span",3),Te(4),ue(),function z_(){Ue.lFrame.currentNamespace="svg"}(),ce(5,"svg",4),it(6,"polygon",5),ue()(),function V_(){!function PD(){Ue.lFrame.currentNamespace=null}()}(),it(7,"div",6),Ku(8),ce(9,"button",7),zt("click",function(){return s.previousClicked()}),ue(),ce(10,"button",8),zt("click",function(){return s.nextClicked()}),ue()()(),ce(11,"label",9),Te(12),ue()),2&n&&(we(2),Fr("aria-label",s.periodButtonLabel)("aria-describedby",s._periodButtonLabelId),we(2),hn(s.periodButtonText),we(1),ie("mat-calendar-invert","month"!==s.calendar.currentView),we(4),Be("disabled",!s.previousEnabled()),Fr("aria-label",s.prevButtonLabel),we(1),Be("disabled",!s.nextEnabled()),Fr("aria-label",s.nextButtonLabel),we(1),Be("id",s._periodButtonLabelId),we(1),hn(s.periodButtonDescription))},dependencies:[k2,IH],encapsulation:2,changeDetection:0}),t})(),EA=(()=>{var e;class t{get startAt(){return this._startAt}set startAt(n){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}get selected(){return this._selected}set selected(n){this._selected=n instanceof gl?n:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}get minDate(){return this._minDate}set minDate(n){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}get maxDate(){return this._maxDate}set maxDate(n){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}get activeDate(){return this._clampedActiveDate}set activeDate(n){this._clampedActiveDate=this._dateAdapter.clampDate(n,this.minDate,this.maxDate),this.stateChanges.next(),this._changeDetectorRef.markForCheck()}get currentView(){return this._currentView}set currentView(n){const s=this._currentView!==n?n:null;this._currentView=n,this._moveFocusOnNextTick=!0,this._changeDetectorRef.markForCheck(),s&&this.viewChanged.emit(s)}constructor(n,s,u,m){this._dateAdapter=s,this._dateFormats=u,this._changeDetectorRef=m,this._moveFocusOnNextTick=!1,this.startView="month",this.selectedChange=new Wn,this.yearSelected=new Wn,this.monthSelected=new Wn,this.viewChanged=new Wn(!0),this._userSelection=new Wn,this._userDragDrop=new Wn,this._activeDrag=null,this.stateChanges=new qe,this._intlChanges=n.changes.subscribe(()=>{m.markForCheck(),this.stateChanges.next()})}ngAfterContentInit(){this._calendarHeaderPortal=new Iv(this.headerComponent||A9),this.activeDate=this.startAt||this._dateAdapter.today(),this._currentView=this.startView}ngAfterViewChecked(){this._moveFocusOnNextTick&&(this._moveFocusOnNextTick=!1,this.focusActiveCell())}ngOnDestroy(){this._intlChanges.unsubscribe(),this.stateChanges.complete()}ngOnChanges(n){const s=n.minDate&&!this._dateAdapter.sameDate(n.minDate.previousValue,n.minDate.currentValue)?n.minDate:void 0,u=n.maxDate&&!this._dateAdapter.sameDate(n.maxDate.previousValue,n.maxDate.currentValue)?n.maxDate:void 0,m=s||u||n.dateFilter;if(m&&!m.firstChange){const b=this._getCurrentViewComponent();b&&(this._changeDetectorRef.detectChanges(),b._init())}this.stateChanges.next()}focusActiveCell(){this._getCurrentViewComponent()._focusActiveCell(!1)}updateTodaysDate(){this._getCurrentViewComponent()._init()}_dateSelected(n){const s=n.value;(this.selected instanceof gl||s&&!this._dateAdapter.sameDate(s,this.selected))&&this.selectedChange.emit(s),this._userSelection.emit(n)}_yearSelectedInMultiYearView(n){this.yearSelected.emit(n)}_monthSelectedInYearView(n){this.monthSelected.emit(n)}_goToDateInView(n,s){this.activeDate=n,this.currentView=s}_dragStarted(n){this._activeDrag=n}_dragEnded(n){this._activeDrag&&(n.value&&this._userDragDrop.emit(n),this._activeDrag=null)}_getCurrentViewComponent(){return this.monthView||this.yearView||this.multiYearView}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(fD),xe(la,8),xe(pm,8),xe(La))},e.\u0275cmp=Ci({type:e,selectors:[["mat-calendar"]],viewQuery:function(n,s){if(1&n&&(ul(s3,5),ul(u3,5),ul(a3,5)),2&n){let u;Oa(u=Fa())&&(s.monthView=u.first),Oa(u=Fa())&&(s.yearView=u.first),Oa(u=Fa())&&(s.multiYearView=u.first)}},hostAttrs:[1,"mat-calendar"],inputs:{headerComponent:"headerComponent",startAt:"startAt",startView:"startView",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",_userSelection:"_userSelection",_userDragDrop:"_userDragDrop"},exportAs:["matCalendar"],features:[$r([o3]),v],decls:5,vars:5,consts:[[3,"cdkPortalOutlet"],["cdkMonitorSubtreeFocus","","tabindex","-1",1,"mat-calendar-content",3,"ngSwitch"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag","activeDateChange","_userSelection","dragStarted","dragEnded",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","monthSelected","selectedChange",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","yearSelected","selectedChange",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag","activeDateChange","_userSelection","dragStarted","dragEnded"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","monthSelected","selectedChange"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","yearSelected","selectedChange"]],template:function(n,s){1&n&&(Ln(0,m9,0,0,"ng-template",0),ce(1,"div",1),Ln(2,g9,1,11,"mat-month-view",2),Ln(3,_9,1,6,"mat-year-view",3),Ln(4,y9,1,6,"mat-multi-year-view",4),ue()),2&n&&(Be("cdkPortalOutlet",s._calendarHeaderPortal),we(1),Be("ngSwitch",s.currentView),we(1),Be("ngSwitchCase","month"),we(1),Be("ngSwitchCase","year"),we(1),Be("ngSwitchCase","multi-year"))},dependencies:[cE,SR,tH,WE,s3,u3,a3],styles:['.mat-calendar{display:block;font-family:var(--mat-datepicker-calendar-text-font);font-size:var(--mat-datepicker-calendar-text-size)}.mat-calendar-header{padding:8px 8px 0 8px}.mat-calendar-content{padding:0 8px 8px 8px;outline:none}.mat-calendar-controls{display:flex;align-items:center;margin:5% calc(4.7142857143% - 16px)}.mat-calendar-spacer{flex:1 1 auto}.mat-calendar-period-button{min-width:0;margin:0 8px;font-size:var(--mat-datepicker-calendar-period-button-text-size);font-weight:var(--mat-datepicker-calendar-period-button-text-weight)}.mat-calendar-arrow{display:inline-block;width:10px;height:5px;margin:0 0 0 5px;vertical-align:middle;fill:var(--mat-datepicker-calendar-period-button-icon-color)}.mat-calendar-arrow.mat-calendar-invert{transform:rotate(180deg)}[dir=rtl] .mat-calendar-arrow{margin:0 5px 0 0}.cdk-high-contrast-active .mat-calendar-arrow{fill:CanvasText}.mat-calendar-previous-button,.mat-calendar-next-button{position:relative}.mat-datepicker-content .mat-calendar-previous-button,.mat-datepicker-content .mat-calendar-next-button{color:var(--mat-datepicker-calendar-navigation-button-icon-color)}.mat-calendar-previous-button::after,.mat-calendar-next-button::after{top:0;left:0;right:0;bottom:0;position:absolute;content:"";margin:15.5px;border:0 solid currentColor;border-top-width:2px}[dir=rtl] .mat-calendar-previous-button,[dir=rtl] .mat-calendar-next-button{transform:rotate(180deg)}.mat-calendar-previous-button::after{border-left-width:2px;transform:translateX(2px) rotate(-45deg)}.mat-calendar-next-button::after{border-right-width:2px;transform:translateX(-2px) rotate(45deg)}.mat-calendar-table{border-spacing:0;border-collapse:collapse;width:100%}.mat-calendar-table-header th{text-align:center;padding:0 0 8px 0;color:var(--mat-datepicker-calendar-header-text-color);font-size:var(--mat-datepicker-calendar-header-text-size);font-weight:var(--mat-datepicker-calendar-header-text-weight)}.mat-calendar-table-header-divider{position:relative;height:1px}.mat-calendar-table-header-divider::after{content:"";position:absolute;top:0;left:-8px;right:-8px;height:1px;background:var(--mat-datepicker-calendar-header-divider-color)}.mat-calendar-body-cell-content::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px) * -1)}.mat-calendar-body-cell:focus .mat-focus-indicator::before{content:""}.mat-calendar-hidden-label{display:none}'],encapsulation:2,changeDetection:0}),t})();const d3={transformPanel:m_("transformPanel",[Tc("void => enter-dropdown",Dc("120ms cubic-bezier(0, 0, 0.2, 1)",AO([es({opacity:0,transform:"scale(1, 0.8)"}),es({opacity:1,transform:"scale(1, 1)"})]))),Tc("void => enter-dialog",Dc("150ms cubic-bezier(0, 0, 0.2, 1)",AO([es({opacity:0,transform:"scale(0.7)"}),es({transform:"none",opacity:1})]))),Tc("* => void",Dc("100ms linear",es({opacity:0})))]),fadeInCalendar:m_("fadeInCalendar",[sd("void",es({opacity:0})),sd("enter",es({opacity:1})),Tc("void => *",Dc("120ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)"))])};let I9=0;const h3=new Kt("mat-datepicker-scroll-strategy"),R9={provide:h3,deps:[mm],useFactory:function k9(e){return()=>e.scrollStrategies.reposition()}},P9=T2(class{constructor(e){this._elementRef=e}});let O9=(()=>{var e;class t extends P9{constructor(n,s,u,m,b,T){super(n),this._changeDetectorRef=s,this._globalModel=u,this._dateAdapter=m,this._rangeSelectionStrategy=b,this._subscriptions=new me,this._animationDone=new qe,this._isAnimating=!1,this._actionsPortal=null,this._closeButtonText=T.closeCalendarLabel}ngOnInit(){this._animationState=this.datepicker.touchUi?"enter-dialog":"enter-dropdown"}ngAfterViewInit(){this._subscriptions.add(this.datepicker.stateChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})),this._calendar.focusActiveCell()}ngOnDestroy(){this._subscriptions.unsubscribe(),this._animationDone.complete()}_handleUserSelection(n){const s=this._model.selection,u=n.value,m=s instanceof gl;if(m&&this._rangeSelectionStrategy){const b=this._rangeSelectionStrategy.selectionFinished(u,s,n.event);this._model.updateSelection(b,this)}else u&&(m||!this._dateAdapter.sameDate(u,s))&&this._model.add(u);(!this._model||this._model.isComplete())&&!this._actionsPortal&&this.datepicker.close()}_handleUserDragDrop(n){this._model.updateSelection(n.value,this)}_startExitAnimation(){this._animationState="void",this._changeDetectorRef.markForCheck()}_handleAnimationEvent(n){this._isAnimating="start"===n.phaseName,this._isAnimating||this._animationDone.next()}_getSelected(){return this._model.selection}_applyPendingSelection(){this._model!==this._globalModel&&this._globalModel.updateSelection(this._model.selection,this)}_assignActions(n,s){this._model=n?this._globalModel.clone():this._globalModel,this._actionsPortal=n,s&&this._changeDetectorRef.detectChanges()}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(tr),xe(La),xe(Cm),xe(la),xe(mD,8),xe(fD))},e.\u0275cmp=Ci({type:e,selectors:[["mat-datepicker-content"]],viewQuery:function(n,s){if(1&n&&ul(EA,5),2&n){let u;Oa(u=Fa())&&(s._calendar=u.first)}},hostAttrs:[1,"mat-datepicker-content"],hostVars:3,hostBindings:function(n,s){1&n&&Jp("@transformPanel.start",function(m){return s._handleAnimationEvent(m)})("@transformPanel.done",function(m){return s._handleAnimationEvent(m)}),2&n&&(kf("@transformPanel",s._animationState),ie("mat-datepicker-content-touch",s.datepicker.touchUi))},inputs:{color:"color"},exportAs:["matDatepickerContent"],features:[ki],decls:5,vars:26,consts:[["cdkTrapFocus","","role","dialog",1,"mat-datepicker-content-container"],[3,"id","ngClass","startAt","startView","minDate","maxDate","dateFilter","headerComponent","selected","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","yearSelected","monthSelected","viewChanged","_userSelection","_userDragDrop"],[3,"cdkPortalOutlet"],["type","button","mat-raised-button","",1,"mat-datepicker-close-button",3,"color","focus","blur","click"]],template:function(n,s){if(1&n&&(ce(0,"div",0)(1,"mat-calendar",1),zt("yearSelected",function(m){return s.datepicker._selectYear(m)})("monthSelected",function(m){return s.datepicker._selectMonth(m)})("viewChanged",function(m){return s.datepicker._viewChanged(m)})("_userSelection",function(m){return s._handleUserSelection(m)})("_userDragDrop",function(m){return s._handleUserDragDrop(m)}),ue(),Ln(2,v9,0,0,"ng-template",2),ce(3,"button",3),zt("focus",function(){return s._closeButtonFocused=!0})("blur",function(){return s._closeButtonFocused=!1})("click",function(){return s.datepicker.close()}),Te(4),ue()()),2&n){let u;ie("mat-datepicker-content-container-with-custom-header",s.datepicker.calendarHeaderComponent)("mat-datepicker-content-container-with-actions",s._actionsPortal),Fr("aria-modal",!0)("aria-labelledby",null!==(u=s._dialogLabelId)&&void 0!==u?u:void 0),we(1),Be("id",s.datepicker.id)("ngClass",s.datepicker.panelClass)("startAt",s.datepicker.startAt)("startView",s.datepicker.startView)("minDate",s.datepicker._getMinDate())("maxDate",s.datepicker._getMaxDate())("dateFilter",s.datepicker._getDateFilter())("headerComponent",s.datepicker.calendarHeaderComponent)("selected",s._getSelected())("dateClass",s.datepicker.dateClass)("comparisonStart",s.comparisonStart)("comparisonEnd",s.comparisonEnd)("@fadeInCalendar","enter")("startDateAccessibleName",s.startDateAccessibleName)("endDateAccessibleName",s.endDateAccessibleName),we(1),Be("cdkPortalOutlet",s._actionsPortal),we(1),ie("cdk-visually-hidden",!s._closeButtonFocused),Be("color",s.color||"primary"),we(1),hn(s._closeButtonText)}},dependencies:[px,k2,q8,WE,EA],styles:[".mat-datepicker-content{box-shadow:0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12);display:block;border-radius:4px;background-color:var(--mat-datepicker-calendar-container-background-color);color:var(--mat-datepicker-calendar-container-text-color)}.mat-datepicker-content .mat-calendar{width:296px;height:354px}.mat-datepicker-content .mat-datepicker-content-container-with-custom-header .mat-calendar{height:auto}.mat-datepicker-content .mat-datepicker-close-button{position:absolute;top:100%;left:0;margin-top:8px}.ng-animating .mat-datepicker-content .mat-datepicker-close-button{display:none}.mat-datepicker-content-container{display:flex;flex-direction:column;justify-content:space-between}.mat-datepicker-content-touch{box-shadow:0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12);display:block;max-height:80vh;position:relative;overflow:visible}.mat-datepicker-content-touch .mat-datepicker-content-container{min-height:312px;max-height:788px;min-width:250px;max-width:750px}.mat-datepicker-content-touch .mat-calendar{width:100%;height:auto}@media all and (orientation: landscape){.mat-datepicker-content-touch .mat-datepicker-content-container{width:64vh;height:80vh}}@media all and (orientation: portrait){.mat-datepicker-content-touch .mat-datepicker-content-container{width:80vw;height:100vw}.mat-datepicker-content-touch .mat-datepicker-content-container-with-actions{height:115vw}}"],encapsulation:2,data:{animation:[d3.transformPanel,d3.fadeInCalendar]},changeDetection:0}),t})(),f3=(()=>{var e;class t{get startAt(){return this._startAt||(this.datepickerInput?this.datepickerInput.getStartValue():null)}set startAt(n){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n))}get color(){return this._color||(this.datepickerInput?this.datepickerInput.getThemePalette():void 0)}set color(n){this._color=n}get touchUi(){return this._touchUi}set touchUi(n){this._touchUi=aa(n)}get disabled(){return void 0===this._disabled&&this.datepickerInput?this.datepickerInput.disabled:!!this._disabled}set disabled(n){const s=aa(n);s!==this._disabled&&(this._disabled=s,this.stateChanges.next(void 0))}get restoreFocus(){return this._restoreFocus}set restoreFocus(n){this._restoreFocus=aa(n)}get panelClass(){return this._panelClass}set panelClass(n){this._panelClass=function b8(e,t=/\s+/){const r=[];if(null!=e){const n=Array.isArray(e)?e:`${e}`.split(t);for(const s of n){const u=`${s}`.trim();u&&r.push(u)}}return r}(n)}get opened(){return this._opened}set opened(n){aa(n)?this.open():this.close()}_getMinDate(){return this.datepickerInput&&this.datepickerInput.min}_getMaxDate(){return this.datepickerInput&&this.datepickerInput.max}_getDateFilter(){return this.datepickerInput&&this.datepickerInput.dateFilter}constructor(n,s,u,m,b,T,R){this._overlay=n,this._ngZone=s,this._viewContainerRef=u,this._dateAdapter=b,this._dir=T,this._model=R,this._inputStateChanges=me.EMPTY,this._document=Jt(Gi),this.startView="month",this._touchUi=!1,this.xPosition="start",this.yPosition="below",this._restoreFocus=!0,this.yearSelected=new Wn,this.monthSelected=new Wn,this.viewChanged=new Wn(!0),this.openedStream=new Wn,this.closedStream=new Wn,this._opened=!1,this.id="mat-datepicker-"+I9++,this._focusedElementBeforeOpen=null,this._backdropHarnessClass=`${this.id}-backdrop`,this.stateChanges=new qe,this._scrollStrategy=m}ngOnChanges(n){const s=n.xPosition||n.yPosition;if(s&&!s.firstChange&&this._overlayRef){const u=this._overlayRef.getConfig().positionStrategy;u instanceof MF&&(this._setConnectedPositions(u),this.opened&&this._overlayRef.updatePosition())}this.stateChanges.next(void 0)}ngOnDestroy(){this._destroyOverlay(),this.close(),this._inputStateChanges.unsubscribe(),this.stateChanges.complete()}select(n){this._model.add(n)}_selectYear(n){this.yearSelected.emit(n)}_selectMonth(n){this.monthSelected.emit(n)}_viewChanged(n){this.viewChanged.emit(n)}registerInput(n){return this._inputStateChanges.unsubscribe(),this.datepickerInput=n,this._inputStateChanges=n.stateChanges.subscribe(()=>this.stateChanges.next(void 0)),this._model}registerActions(n){this._actionsPortal=n,this._componentRef?.instance._assignActions(n,!0)}removeActions(n){n===this._actionsPortal&&(this._actionsPortal=null,this._componentRef?.instance._assignActions(null,!0))}open(){this._opened||this.disabled||this._componentRef?.instance._isAnimating||(this._focusedElementBeforeOpen=OO(),this._openOverlay(),this._opened=!0,this.openedStream.emit())}close(){if(!this._opened||this._componentRef?.instance._isAnimating)return;const n=this._restoreFocus&&this._focusedElementBeforeOpen&&"function"==typeof this._focusedElementBeforeOpen.focus,s=()=>{this._opened&&(this._opened=!1,this.closedStream.emit())};if(this._componentRef){const{instance:u,location:m}=this._componentRef;u._startExitAnimation(),u._animationDone.pipe(Us(1)).subscribe(()=>{const b=this._document.activeElement;n&&(!b||b===this._document.activeElement||m.nativeElement.contains(b))&&this._focusedElementBeforeOpen.focus(),this._focusedElementBeforeOpen=null,this._destroyOverlay()})}n?setTimeout(s):s()}_applyPendingSelection(){this._componentRef?.instance?._applyPendingSelection()}_forwardContentValues(n){n.datepicker=this,n.color=this.color,n._dialogLabelId=this.datepickerInput.getOverlayLabelId(),n._assignActions(this._actionsPortal,!1)}_openOverlay(){this._destroyOverlay();const n=this.touchUi,s=new Iv(O9,this._viewContainerRef),u=this._overlayRef=this._overlay.create(new B2({positionStrategy:n?this._getDialogStrategy():this._getDropdownStrategy(),hasBackdrop:!0,backdropClass:[n?"cdk-overlay-dark-backdrop":"mat-overlay-transparent-backdrop",this._backdropHarnessClass],direction:this._dir,scrollStrategy:n?this._overlay.scrollStrategies.block():this._scrollStrategy(),panelClass:"mat-datepicker-"+(n?"dialog":"popup")}));this._getCloseStream(u).subscribe(m=>{m&&m.preventDefault(),this.close()}),u.keydownEvents().subscribe(m=>{const b=m.keyCode;(38===b||40===b||37===b||39===b||33===b||34===b)&&m.preventDefault()}),this._componentRef=u.attach(s),this._forwardContentValues(this._componentRef.instance),n||this._ngZone.onStable.pipe(Us(1)).subscribe(()=>u.updatePosition())}_destroyOverlay(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=this._componentRef=null)}_getDialogStrategy(){return this._overlay.position().global().centerHorizontally().centerVertically()}_getDropdownStrategy(){const n=this._overlay.position().flexibleConnectedTo(this.datepickerInput.getConnectedOverlayOrigin()).withTransformOriginOn(".mat-datepicker-content").withFlexibleDimensions(!1).withViewportMargin(8).withLockedPosition();return this._setConnectedPositions(n)}_setConnectedPositions(n){const s="end"===this.xPosition?"end":"start",u="start"===s?"end":"start",m="above"===this.yPosition?"bottom":"top",b="top"===m?"bottom":"top";return n.withPositions([{originX:s,originY:b,overlayX:s,overlayY:m},{originX:s,originY:m,overlayX:s,overlayY:b},{originX:u,originY:b,overlayX:u,overlayY:m},{originX:u,originY:m,overlayX:u,overlayY:b}])}_getCloseStream(n){const s=["ctrlKey","shiftKey","metaKey"];return vh(n.backdropClick(),n.detachments(),n.keydownEvents().pipe(ql(u=>27===u.keyCode&&!y_(u)||this.datepickerInput&&y_(u,"altKey")&&38===u.keyCode&&s.every(m=>!y_(u,m)))))}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(mm),xe(si),xe(Hl),xe(h3),xe(la,8),xe(Av,8),xe(Cm))},e.\u0275dir=Bn({type:e,inputs:{calendarHeaderComponent:"calendarHeaderComponent",startAt:"startAt",startView:"startView",color:"color",touchUi:"touchUi",disabled:"disabled",xPosition:"xPosition",yPosition:"yPosition",restoreFocus:"restoreFocus",dateClass:"dateClass",panelClass:"panelClass",opened:"opened"},outputs:{yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",openedStream:"opened",closedStream:"closed"},features:[v]}),t})(),F9=(()=>{var e;class t extends f3{}return(e=t).\u0275fac=function(){let r;return function(s){return(r||(r=mi(e)))(s||e)}}(),e.\u0275cmp=Ci({type:e,selectors:[["mat-datepicker"]],exportAs:["matDatepicker"],features:[$r([o3,{provide:f3,useExisting:e}]),ki],decls:0,vars:0,template:function(n,s){},encapsulation:2,changeDetection:0}),t})();class gD{constructor(t,r){this.target=t,this.targetElement=r,this.value=this.target.value}}let L9=(()=>{var e;class t{get value(){return this._model?this._getValueFromModel(this._model.selection):this._pendingValue}set value(n){this._assignValueProgrammatically(n)}get disabled(){return!!this._disabled||this._parentDisabled()}set disabled(n){const s=aa(n),u=this._elementRef.nativeElement;this._disabled!==s&&(this._disabled=s,this.stateChanges.next(void 0)),s&&this._isInitialized&&u.blur&&u.blur()}_getValidators(){return[this._parseValidator,this._minValidator,this._maxValidator,this._filterValidator]}_registerModel(n){this._model=n,this._valueChangesSubscription.unsubscribe(),this._pendingValue&&this._assignValue(this._pendingValue),this._valueChangesSubscription=this._model.selectionChanged.subscribe(s=>{if(this._shouldHandleChangeEvent(s)){const u=this._getValueFromModel(s.selection);this._lastValueValid=this._isValidValue(u),this._cvaOnChange(u),this._onTouched(),this._formatValue(u),this.dateInput.emit(new gD(this,this._elementRef.nativeElement)),this.dateChange.emit(new gD(this,this._elementRef.nativeElement))}})}constructor(n,s,u){this._elementRef=n,this._dateAdapter=s,this._dateFormats=u,this.dateChange=new Wn,this.dateInput=new Wn,this.stateChanges=new qe,this._onTouched=()=>{},this._validatorOnChange=()=>{},this._cvaOnChange=()=>{},this._valueChangesSubscription=me.EMPTY,this._localeSubscription=me.EMPTY,this._parseValidator=()=>this._lastValueValid?null:{matDatepickerParse:{text:this._elementRef.nativeElement.value}},this._filterValidator=m=>{const b=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(m.value));return!b||this._matchesFilter(b)?null:{matDatepickerFilter:!0}},this._minValidator=m=>{const b=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(m.value)),T=this._getMinDate();return!T||!b||this._dateAdapter.compareDate(T,b)<=0?null:{matDatepickerMin:{min:T,actual:b}}},this._maxValidator=m=>{const b=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(m.value)),T=this._getMaxDate();return!T||!b||this._dateAdapter.compareDate(T,b)>=0?null:{matDatepickerMax:{max:T,actual:b}}},this._lastValueValid=!1,this._localeSubscription=s.localeChanges.subscribe(()=>{this._assignValueProgrammatically(this.value)})}ngAfterViewInit(){this._isInitialized=!0}ngOnChanges(n){(function N9(e,t){const r=Object.keys(e);for(let n of r){const{previousValue:s,currentValue:u}=e[n];if(!t.isDateInstance(s)||!t.isDateInstance(u))return!0;if(!t.sameDate(s,u))return!0}return!1})(n,this._dateAdapter)&&this.stateChanges.next(void 0)}ngOnDestroy(){this._valueChangesSubscription.unsubscribe(),this._localeSubscription.unsubscribe(),this.stateChanges.complete()}registerOnValidatorChange(n){this._validatorOnChange=n}validate(n){return this._validator?this._validator(n):null}writeValue(n){this._assignValueProgrammatically(n)}registerOnChange(n){this._cvaOnChange=n}registerOnTouched(n){this._onTouched=n}setDisabledState(n){this.disabled=n}_onKeydown(n){y_(n,"altKey")&&40===n.keyCode&&["ctrlKey","shiftKey","metaKey"].every(m=>!y_(n,m))&&!this._elementRef.nativeElement.readOnly&&(this._openPopup(),n.preventDefault())}_onInput(n){const s=this._lastValueValid;let u=this._dateAdapter.parse(n,this._dateFormats.parse.dateInput);this._lastValueValid=this._isValidValue(u),u=this._dateAdapter.getValidDateOrNull(u);const m=!this._dateAdapter.sameDate(u,this.value);!u||m?this._cvaOnChange(u):(n&&!this.value&&this._cvaOnChange(u),s!==this._lastValueValid&&this._validatorOnChange()),m&&(this._assignValue(u),this.dateInput.emit(new gD(this,this._elementRef.nativeElement)))}_onChange(){this.dateChange.emit(new gD(this,this._elementRef.nativeElement))}_onBlur(){this.value&&this._formatValue(this.value),this._onTouched()}_formatValue(n){this._elementRef.nativeElement.value=null!=n?this._dateAdapter.format(n,this._dateFormats.display.dateInput):""}_assignValue(n){this._model?(this._assignValueToModel(n),this._pendingValue=null):this._pendingValue=n}_isValidValue(n){return!n||this._dateAdapter.isValid(n)}_parentDisabled(){return!1}_assignValueProgrammatically(n){n=this._dateAdapter.deserialize(n),this._lastValueValid=this._isValidValue(n),n=this._dateAdapter.getValidDateOrNull(n),this._assignValue(n),this._formatValue(n)}_matchesFilter(n){const s=this._getDateFilter();return!s||s(n)}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(tr),xe(la,8),xe(pm,8))},e.\u0275dir=Bn({type:e,inputs:{value:"value",disabled:"disabled"},outputs:{dateChange:"dateChange",dateInput:"dateInput"},features:[v]}),t})();const B9={provide:mu,useExisting:Ki(()=>DA),multi:!0},z9={provide:$s,useExisting:Ki(()=>DA),multi:!0};let DA=(()=>{var e;class t extends L9{set matDatepicker(n){n&&(this._datepicker=n,this._closedSubscription=n.closedStream.subscribe(()=>this._onTouched()),this._registerModel(n.registerInput(this)))}get min(){return this._min}set min(n){const s=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n));this._dateAdapter.sameDate(s,this._min)||(this._min=s,this._validatorOnChange())}get max(){return this._max}set max(n){const s=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(n));this._dateAdapter.sameDate(s,this._max)||(this._max=s,this._validatorOnChange())}get dateFilter(){return this._dateFilter}set dateFilter(n){const s=this._matchesFilter(this.value);this._dateFilter=n,this._matchesFilter(this.value)!==s&&this._validatorOnChange()}constructor(n,s,u,m){super(n,s,u),this._formField=m,this._closedSubscription=me.EMPTY,this._validator=O$.compose(super._getValidators())}getConnectedOverlayOrigin(){return this._formField?this._formField.getConnectedOverlayOrigin():this._elementRef}getOverlayLabelId(){return this._formField?this._formField.getLabelId():this._elementRef.nativeElement.getAttribute("aria-labelledby")}getThemePalette(){return this._formField?this._formField.color:void 0}getStartValue(){return this.value}ngOnDestroy(){super.ngOnDestroy(),this._closedSubscription.unsubscribe()}_openPopup(){this._datepicker&&this._datepicker.open()}_getValueFromModel(n){return n}_assignValueToModel(n){this._model&&this._model.updateSelection(n,this)}_getMinDate(){return this._min}_getMaxDate(){return this._max}_getDateFilter(){return this._dateFilter}_shouldHandleChangeEvent(n){return n.source!==this}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(tr),xe(la,8),xe(pm,8),xe(s9,8))},e.\u0275dir=Bn({type:e,selectors:[["input","matDatepicker",""]],hostAttrs:[1,"mat-datepicker-input"],hostVars:6,hostBindings:function(n,s){1&n&&zt("input",function(m){return s._onInput(m.target.value)})("change",function(){return s._onChange()})("blur",function(){return s._onBlur()})("keydown",function(m){return s._onKeydown(m)}),2&n&&(du("disabled",s.disabled),Fr("aria-haspopup",s._datepicker?"dialog":null)("aria-owns",(null==s._datepicker?null:s._datepicker.opened)&&s._datepicker.id||null)("min",s.min?s._dateAdapter.toIso8601(s.min):null)("max",s.max?s._dateAdapter.toIso8601(s.max):null)("data-mat-calendar",s._datepicker?s._datepicker.id:null))},inputs:{matDatepicker:"matDatepicker",min:"min",max:"max",dateFilter:["matDatepickerFilter","dateFilter"]},exportAs:["matDatepickerInput"],features:[$r([B9,z9,{provide:a9,useExisting:e}]),ki]}),t})(),U9=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({providers:[fD,R9],imports:[hv,pF,z2,XO,O2,ad,XE]}),t})();function H9(e,t){if(1&e&&(ce(0,"h3",8),Te(1),ue()),2&e){const r=Dn();we(1),hn(r.title)}}function $9(e,t){if(1&e&&(ce(0,"small"),Te(1),ue()),2&e){const r=Dn();we(1),hn(r.subtitle)}}let m3=(()=>{var e;class t{constructor(){this.path="",this.title="",this.subtitle="",this.default="",this.defaultPicture="assets/images/no-photo.png"}ngOnInit(){""!=this.default&&(this.defaultPicture=this.default)}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Ci({type:e,selectors:[["app-card-picture"]],inputs:{path:"path",title:"title",subtitle:"subtitle",default:"default"},decls:8,vars:4,consts:[[1,"card"],[1,"el-card-item"],[1,"el-card-avatar","el-overlay-1"],["onerror","this.onerror=null; this.src=defaultPicture",1,"max-w-100",3,"src"],[1,"el-overlay"],[1,"el-card-content"],["class","box-title",4,"ngIf"],[4,"ngIf"],[1,"box-title"]],template:function(n,s){1&n&&(ce(0,"div",0)(1,"div",1)(2,"div",2),it(3,"img",3)(4,"div",4),ue(),ce(5,"div",5),Ln(6,H9,2,1,"h3",6),Ln(7,$9,2,1,"small",7),ue()()()),2&n&&(we(3),bc("src",s.path,qd),bc("src",s.defaultPicture,qd),we(3),Be("ngIf",s.title),we(1),Be("ngIf",s.subtitle))},dependencies:[Na]}),t})(),g3=(()=>{var e;class t{constructor(n){this.events=n,this.accept="",this.maxSize=0,this.inputName="",this.inputNamePreview="",this.label="Cambiar",this.error=""}ngOnInit(){$(".dropify").dropify()}handleUpload(n){this.error="";const s=n.target.files[0];if(s&&(s.size/1024>this.maxSize&&(this.error="El archivo es demasiado grande."),""==this.error)){const u=new FileReader;u.readAsDataURL(s),u.onload=()=>{this.events.publish("app-input-file",{base64:u.result,name:s.name,size:s.size,inputName:this.inputName,inputNamePreview:this.inputNamePreview})}}}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(Hs))},e.\u0275cmp=Ci({type:e,selectors:[["app-input-file"]],inputs:{accept:"accept",maxSize:"maxSize",inputName:"inputName",inputNamePreview:"inputNamePreview",label:"label"},decls:8,vars:3,consts:[[1,"form-group"],[1,"custom-file","d-block"],["type","file","name","file",3,"accept","change"],[1,"custom-file-control"],[1,"form-control-feedback","text-danger"]],template:function(n,s){1&n&&(ce(0,"fieldset",0)(1,"label"),Te(2),ue(),ce(3,"label",1)(4,"input",2),zt("change",function(m){return s.handleUpload(m)}),ue(),it(5,"span",3),ue(),ce(6,"small",4),Te(7),ue()()),2&n&&(we(2),hn(s.label),we(2),bc("accept",s.accept),we(3),hn(s.error))}}),t})();var G9=Je(574),Fv=Je.n(G9),q9=Je(904),W9=Je.n(q9);let Z9=(()=>{var e;class t{constructor(n){this.events=n,this.lat=0,this.lng=0,this.zoom=0}ngOnInit(){this.lat=this.inputLat?this.inputLat:bi_mapBox_defaultLat,this.lng=this.inputLng?this.inputLng:bi_mapBox_defaultLng,this.zoom=this.inputZoom?this.inputZoom:bi_mapBox_defaultZoom,Fv().accessToken=bi_mapBox_apiKey,this.map=new(Fv().Map)({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[this.lng,this.lat],zoom:this.zoom}),this.map.scrollZoom.disable(),this.map.on("zoomend",()=>{this.listenerMap()}),this.map.addControl(new(Fv().NavigationControl));const n=new(W9())({accessToken:Fv().accessToken,mapboxgl:Fv(),marker:!1});this.map.on("wheel",s=>{if(s.originalEvent.ctrlKey){s.preventDefault();var u=s.deltaY||s.detail||s.wheelDelta,m=this.map.getZoom();m+=u>0?-.1:.1,m=Math.min(Math.max(m,0),20),this.map.setZoom(m)}}),this.map.addControl(n),this.marker=new(Fv().Marker)({draggable:!0}).setLngLat([this.lng,this.lat]).addTo(this.map),this.marker.on("dragend",()=>{this.listenerMap()}),n.on("result",s=>{this.marker.setLngLat(s.result.geometry.coordinates)})}listenerMap(){const n=this.marker.getLngLat(),s=n.lng,u=n.lat,m=this.map.getZoom();this.events.publish("mapbox",{lng:s,lat:u,zoom:m})}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(Hs))},e.\u0275cmp=Ci({type:e,selectors:[["app-mapbox"]],inputs:{inputLat:"inputLat",inputLng:"inputLng",inputZoom:"inputZoom"},decls:1,vars:0,consts:[["id","map",2,"width","100%","height","400px"]],template:function(n,s){1&n&&it(0,"div",0)}}),t})();function Y9(e,t){if(1&e&&(ce(0,"option",50),Te(1),ue()),2&e){const r=t.$implicit;bc("value",r.id),we(1),hn(r.name)}}function X9(e,t){if(1&e&&(ce(0,"option",50),Te(1),ue()),2&e){const r=t.$implicit;bc("value",r.id),we(1),hn(r.name)}}function K9(e,t){if(1&e){const r=Sr();ce(0,"select",51),zt("ngModelChange",function(s){return Mn(r),Cn(Dn().form.eventSwoogo=s)})("change",function(){return Mn(r),Cn(Dn().onSelectEvent())}),ce(1,"option",12),Te(2,"--Seleccione una opci\xf3n--"),ue(),Ln(3,X9,2,2,"option",13),ue()}if(2&e){const r=Dn();Be("ngModel",r.form.eventSwoogo),we(3),Be("ngForOf",r.eventsSwoogo)}}function Q9(e,t){1&e&&(ce(0,"select",52),it(1,"option",12),ue())}function J9(e,t){if(1&e){const r=Sr();ce(0,"button",53),zt("click",function(){return Mn(r),Cn(Dn().removePictureBackground("assets/images/default-background.jpg"))}),it(1,"i",42),Te(2," Quitar imagen"),ue()}}function eq(e,t){if(1&e){const r=Sr();ce(0,"button",53),zt("click",function(){return Mn(r),Cn(Dn().removePictureCard("assets/images/default-card.jpg"))}),it(1,"i",42),Te(2," Quitar imagen"),ue()}}function tq(e,t){if(1&e&&(jr(0),it(1,"app-mapbox",54),Ur()),2&e){const r=Dn();we(1),Be("inputLat",null==r.form?null:r.form.lat)("inputLng",null==r.form?null:r.form.lng)("inputZoom",null==r.form?null:r.form.zoom)}}let _3=(()=>{var e;class t{constructor(n,s,u,m,b,T,R,z,W){this.events=n,this._msgErrors=s,this.spinner=u,this.router=m,this._snackBar=b,this.activatedRoute=T,this.eventService=R,this.categoryService=z,this.eventSwoogoService=W,this.useMap=!0,this.dataReady=!1,this.form={id:"",name:"",pictureBackground:"",pictureBackgroundBase64:"",pictureCard:"",pictureCardBase64:"",description:"",category:"",duration:"",isActive:0,inHome:1,order:0,inSwoogo:0,start_date:"",start_time:"",end_date:"",end_time:"",url:"",eventSwoogo:"",lat:"",lmg:"",zoom:""},this.tmp={pictureBackground:"",pictureCard:""},this.titlePage="Nuevo",this.breadcrumbs=[{url:"/admin/inicio",title:"Inicio"},{url:"/admin/events",title:"Eventos"},{url:"",title:"Nuevo"}];let le=this.activatedRoute.snapshot.paramMap.get("id");le?(this.loadForm(le),this.breadcrumbs[this.breadcrumbs.length-1].title="Editar",this.titlePage="Editar"):this.loadForm("")}loadForm(n){this.spinner.show(),n?Kx({category:this.categoryService.getAll(),event:this.eventService.getOne(n),swoogo:this.eventSwoogoService.getAll()}).subscribe({next:s=>{this.form=s.event.event,this.categories=s.category.data,this.eventsSwoogo=s.swoogo.data,this.form.category=s.event.event.category._id,this.form.isActive=s.event.event.isActive?1:0,this.form.inHome=s.event.event.inHome?1:0,this.form.inSwoogo=s.event.event.inSwoogo?1:0,this.form.eventSwoogo=s.event.event.inSwoogo?s.event.event.eventSwoogo:"",this.datePickerStart=s.event.event.start_date?new Date(s.event.event.start_date):"",this.datePickerEnd=s.event.event.end_date?new Date(s.event.event.end_date):"",this.tmp.pictureBackground=s.event.event.pictureBackground?s.event.event.pictureBackground:"assets/images/default-background.jpg",this.tmp.pictureCard=s.event.event.pictureCard?s.event.event.pictureCard:"assets/images/default-card.jpg",this.dataReady=!0},complete:()=>this.spinner.hide()}):Kx({category:this.categoryService.getAll(),swoogo:this.eventSwoogoService.getAll()}).subscribe({next:s=>{this.categories=s.category.data,this.eventsSwoogo=s.swoogo.data,this.dataReady=!0},complete:()=>this.spinner.hide()})}ngOnInit(){this.events.subscribe("app-input-file",n=>{this.form[n.inputName]=n.base64,this.tmp[n.inputNamePreview]=n.base64}),this.events.subscribe("mapbox",n=>{this.form.lat=n.lat,this.form.lng=n.lng,this.form.zoom=n.zoom})}ngOnDestroy(){this.events.destroy("app-input-file"),this.events.destroy("mapbox")}save(n){if(this.datePickerStart){const s=new Date(this.datePickerStart.getFullYear()+"-"+(parseInt(this.datePickerStart.getMonth())+1)+"-"+this.datePickerStart.getDate()),u=new Date(`1970-01-01T${this.form.start_time}`);this.form.start_date=new Date(s.getFullYear(),s.getMonth(),s.getDate(),u.getHours(),u.getMinutes(),u.getSeconds())}if(this.datePickerEnd){const s=new Date(this.datePickerEnd.getFullYear()+"-"+(parseInt(this.datePickerEnd.getMonth())+1)+"-"+this.datePickerEnd.getDate()),u=new Date(`1970-01-01T${this.form.end_time}`);this.form.end_date=new Date(s.getFullYear(),s.getMonth(),s.getDate(),u.getHours(),u.getMinutes(),u.getSeconds())}this.spinner.show(),this.eventService.save(this.form).subscribe(s=>{this._snackBar.open("Registro creado","Aceptar",{duration:3e3}),this.router.navigate(["/admin/events"])},s=>this._msgErrors.show(s))}removePictureBackground(n){this.form.pictureBackgroundBase64="##delete##",this.tmp.pictureBackground=n}removePictureCard(n){this.form.pictureCardBase64="##delete##",this.tmp.pictureCard=n}resetMap(){this.form.lat="",this.form.lng="",this.form.zoom=""}onSelectEvent(){let n=this.eventsSwoogo.find(s=>s.id==this.form.eventSwoogo);this.form.name=n.name,n.url&&(this.form.url=n.domain+"/"+n.url),n.start_date&&(this.datePickerStart=new Date(n.start_date)),n.start_time&&(this.form.start_time=n.start_time),n.end_date&&(this.datePickerEnd=new Date(n.end_date)),n.end_time&&(this.form.end_time=n.end_time)}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(Hs),xe(E_),xe(fl),xe(Jo),xe(Sc),xe(pu),xe(pA),xe(mA),xe(XL))},e.\u0275cmp=Ci({type:e,selectors:[["app-event-form"]],features:[$r([{provide:nF,useValue:"es-ES"},{provide:pm,useValue:{parse:{dateInput:"DD/MM/YYYY"},display:{dateInput:"DD/MM/YYYY",monthYearLabel:"MMMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}}}])],decls:137,vars:36,consts:[[1,"container-fluid","animated","fadeIn"],[3,"title","breadcrumbs"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"card-title","animated","fadeInDown"],[1,"form-material","m-t-40",3,"ngSubmit"],["demo","ngForm"],[1,"col-sm-4"],[1,"form-group"],["name","category",1,"form-control",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-2"],["name","inSwoogo",1,"form-control",3,"ngModel","ngModelChange"],["value","1"],["value","0"],[1,"col-sm-6"],["class","form-control","name","event",3,"ngModel","ngModelChange","change",4,"ngIf"],["class","form-control","name","event","disabled","",4,"ngIf"],["type","text","name","name","placeholder","",1,"form-control",3,"ngModel","ngModelChange"],["name","date_start","readonly","","matInput","","placeholder","Seleccione",1,"form-control",3,"matDatepicker","ngModel","click","ngModelChange"],["pickerStart",""],["type","text","name","start_time","placeholder","HH:MM","maxlength","8",1,"form-control",3,"ngModel","ngModelChange"],["name","date_end","readonly","","matInput","","placeholder","Seleccione",1,"form-control",3,"matDatepicker","ngModel","click","ngModelChange"],["pickerEnd",""],["type","text","name","end_time","placeholder","HH:MM","maxlength","8",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-sm-10"],["type","text","name","url","placeholder","",1,"form-control",3,"ngModel","ngModelChange"],["name","inHome",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-sm-12"],["name","description","rows","5",1,"form-control",3,"ngModel","ngModelChange"],[3,"path","default"],[3,"maxSize","inputName","inputNamePreview","accept"],["class","btn btn-danger btn-xs","type","button",3,"click",4,"ngIf"],[1,"col-sm-8"],[1,"col-sm-3"],["type","text","name","lat","readonly","readonly",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","lng","readonly","readonly",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","zoom","readonly","readonly",1,"form-control",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-secondary","btn-sm","waves-effect","waves-light","btn-block",3,"click"],[1,"fa","fa-trash"],[4,"ngIf"],[1,"pt-4"],[1,"animated","fadeInUp"],["type","submit",1,"btn","btn-success","waves-effect","waves-light","m-r-10"],[1,"fa","fa-save"],["role","button","routerLink","/admin/events","type","button",1,"btn","btn-inverse","waves-effect","waves-light"],[1,"fa","fa-remove"],[3,"value"],["name","event",1,"form-control",3,"ngModel","ngModelChange","change"],["name","event","disabled","",1,"form-control"],["type","button",1,"btn","btn-danger","btn-xs",3,"click"],[3,"inputLat","inputLng","inputZoom"]],template:function(n,s){if(1&n){const u=Sr();ce(0,"div",0),it(1,"app-breadcrumb",1),ce(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h4",6),Te(7),ue(),ce(8,"form",7,8),zt("ngSubmit",function(){Mn(u);const b=Pa(9);return Cn(s.save(b))}),ce(10,"div",2)(11,"div",9)(12,"div",10)(13,"label"),Te(14,"Categor\xeda *"),ue(),ce(15,"select",11),zt("ngModelChange",function(b){return s.form.category=b}),ce(16,"option",12),Te(17,"--Seleccione una opci\xf3n--"),ue(),Ln(18,Y9,2,2,"option",13),ue()()(),ce(19,"div",14)(20,"div",10)(21,"label"),Te(22,"Evento de Swoogo"),ue(),ce(23,"select",15),zt("ngModelChange",function(b){return s.form.inSwoogo=b}),ce(24,"option",16),Te(25,"SI"),ue(),ce(26,"option",17),Te(27,"NO"),ue()()()(),ce(28,"div",18)(29,"div",10)(30,"label"),Te(31,"Evento Swoogo*"),ue(),Ln(32,K9,4,2,"select",19),Ln(33,Q9,2,0,"select",20),ue()(),ce(34,"div",9)(35,"div",10)(36,"label"),Te(37,"Nombre"),ue(),ce(38,"input",21),zt("ngModelChange",function(b){return s.form.name=b}),ue()()(),ce(39,"div",14)(40,"div",10)(41,"label"),Te(42,"Fecha inicio"),ue(),ce(43,"mat-form-field")(44,"input",22),zt("click",function(){return Mn(u),Cn(Pa(46).open())})("ngModelChange",function(b){return s.datePickerStart=b}),ue(),it(45,"mat-datepicker",null,23),ue()()(),ce(47,"div",14)(48,"div",10)(49,"label"),Te(50,"Hora inicio"),ue(),ce(51,"input",24),zt("ngModelChange",function(b){return s.form.start_time=b}),ue()()(),ce(52,"div",14)(53,"div",10)(54,"label"),Te(55,"Fecha fin"),ue(),ce(56,"mat-form-field")(57,"input",25),zt("click",function(){return Mn(u),Cn(Pa(59).open())})("ngModelChange",function(b){return s.datePickerEnd=b}),ue(),it(58,"mat-datepicker",null,26),ue()()(),ce(60,"div",14)(61,"div",10)(62,"label"),Te(63,"Hora fin"),ue(),ce(64,"input",27),zt("ngModelChange",function(b){return s.form.end_time=b}),ue()()(),ce(65,"div",28)(66,"div",10)(67,"label"),Te(68,"Link externo"),ue(),ce(69,"input",29),zt("ngModelChange",function(b){return s.form.url=b}),ue()()(),ce(70,"div",14)(71,"div",10)(72,"label"),Te(73,"Home"),ue(),ce(74,"select",30),zt("ngModelChange",function(b){return s.form.inHome=b}),ce(75,"option",16),Te(76,"SI"),ue(),ce(77,"option",17),Te(78,"NO"),ue()()()(),ce(79,"div",31)(80,"div",10)(81,"label"),Te(82,"Descripci\xf3n"),ue(),ce(83,"textarea",32),zt("ngModelChange",function(b){return s.form.description=b}),ue()()()(),ce(84,"h4",6),Te(85,"Imagen de portada"),ue(),it(86,"hr"),ce(87,"div",2)(88,"div",18),it(89,"app-card-picture",33),ue(),ce(90,"div",18),it(91,"app-input-file",34),Ln(92,J9,3,0,"button",35),ue()(),ce(93,"h4",6),Te(94,"Imagen de card"),ue(),it(95,"hr"),ce(96,"div",2)(97,"div",9),it(98,"app-card-picture",33),ue(),ce(99,"div",36),it(100,"app-input-file",34),Ln(101,eq,3,0,"button",35),ue()(),ce(102,"h4",6),Te(103,"Ubicaci\xf3n"),ue(),it(104,"hr"),ce(105,"div",2)(106,"div",37)(107,"div",10)(108,"label"),Te(109,"Latitud"),ue(),ce(110,"input",38),zt("ngModelChange",function(b){return s.form.lat=b}),ue()()(),ce(111,"div",37)(112,"div",10)(113,"label"),Te(114,"Longuitud"),ue(),ce(115,"input",39),zt("ngModelChange",function(b){return s.form.lng=b}),ue()()(),ce(116,"div",37)(117,"div",10)(118,"label"),Te(119,"Zoom"),ue(),ce(120,"input",40),zt("ngModelChange",function(b){return s.form.zoom=b}),ue()()(),ce(121,"div",37)(122,"div",10)(123,"label"),Te(124,"\xa0"),ue(),ce(125,"button",41),zt("click",function(){return s.resetMap()}),it(126,"i",42),Te(127," Limpiar"),ue()()()(),Ln(128,tq,2,3,"ng-container",43),ce(129,"div",44)(130,"div",45)(131,"button",46),it(132,"i",47),Te(133," Guardar"),ue(),ce(134,"a",48),it(135,"i",49),Te(136," Cancelar"),ue()()()()()()()()()}if(2&n){const u=Pa(46),m=Pa(59);we(1),Be("title","Eventos")("breadcrumbs",s.breadcrumbs),we(6),hn(s.breadcrumbs[s.breadcrumbs.length-1].title),we(8),Be("ngModel",s.form.category),we(3),Be("ngForOf",s.categories),we(5),Be("ngModel",s.form.inSwoogo),we(9),Be("ngIf",1==s.form.inSwoogo),we(1),Be("ngIf",0==s.form.inSwoogo),we(5),Be("ngModel",s.form.name),we(6),Be("matDatepicker",u)("ngModel",s.datePickerStart),we(7),Be("ngModel",s.form.start_time),we(6),Be("matDatepicker",m)("ngModel",s.datePickerEnd),we(7),Be("ngModel",s.form.end_time),we(5),Be("ngModel",s.form.url),we(5),Be("ngModel",s.form.inHome),we(9),Be("ngModel",s.form.description),we(6),Be("path",s.tmp.pictureBackground)("default","assets/images/default-background.jpg"),we(2),Be("maxSize",2e3)("inputName","pictureBackgroundBase64")("inputNamePreview","pictureBackground")("accept","image/png, image/jpeg, image/jpg"),we(1),Be("ngIf",s.form.pictureBackground||"assets/images/default-background.jpg"!=s.tmp.pictureBackground),we(6),Be("path",s.tmp.pictureCard)("default","assets/images/default-card.jpg"),we(2),Be("maxSize",2e3)("inputName","pictureCardBase64")("inputNamePreview","pictureCard")("accept","image/png, image/jpeg, image/jpg"),we(1),Be("ngIf",s.form.pictureCard||"assets/images/default-card.jpg"!=s.tmp.pictureCard),we(9),Be("ngModel",s.form.lat),we(5),Be("ngModel",s.form.lng),we(5),Be("ngModel",s.form.zoom),we(8),Be("ngIf",s.dataReady)}},dependencies:[Gl,Na,bm,n1,r1,pl,w_,Mc,vm,sA,Zl,fh,sa,F9,DA,gu,m3,g3,Z9],encapsulation:2}),t})();const nq=function(e){return["/admin/categories/editar",e]};function iq(e,t){if(1&e){const r=Sr();ce(0,"tr")(1,"td"),Te(2),ue(),it(3,"td",23),go(4,"badgeBinary"),ce(5,"td",24)(6,"a",25),it(7,"i",26),ue(),ce(8,"a",27),zt("click",function(){const u=Mn(r).index;return Cn(Dn().remove(u))}),it(9,"i",28),ue()()()}if(2&e){const r=t.$implicit;we(2),hn(r.name),we(1),Be("innerHTML",ms(4,3,r.inHome),Bl),we(3),Be("routerLink",Pf(5,nq,r.id))}}let rq=(()=>{var e;class t{constructor(n,s,u,m){this.spinner=n,this.categoryService=s,this.events=u,this._snackBar=m,this.data={},this.query="",this.breadcrumbs=[{url:"/admin/inicio",title:"Inicio"},{url:"",title:"Categor\xedas"}],this.events.subscribe("pagination",b=>{this.categoryService.calcOffset(b.currentPage),this.getResult()}),this.events.subscribe("order",()=>this.getResult())}ngOnInit(){this.getResult()}ngOnDestroy(){this.events.destroy("pagination"),this.events.destroy("order")}search(){this.events.publish("paginationOffset",{}),this.categoryService.offset=0,this.getResult()}getResult(){this.spinner.show(),this.categoryService.get(this.query).subscribe(n=>{this.data=n,console.log(n)},n=>this.spinner.hide(),()=>this.spinner.hide())}remove(n){jx().fire({text:"\xbfEst\xe1 seguro que desea eliminar este registro?",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"}).then(s=>{s.isConfirmed&&(this.categoryService.delete(this.data.data[n]).subscribe(()=>this.getResult()),this._snackBar.open("Registro eliminado","Aceptar",{duration:3e3}))})}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(fl),xe(mA),xe(Hs),xe(Sc))},e.\u0275cmp=Ci({type:e,selectors:[["app-category"]],decls:32,vars:18,consts:[[1,"container-fluid","animated","fadeIn"],[3,"title","breadcrumbs"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"row","form-material"],[1,"col-md-4"],[1,"text-left","animated","fadeInLeft"],["role","button","routerLink","nuevo",1,"btn","btn-success"],[1,"fa","fa-plus"],[1,"col-md-4","animated","fadeInDown"],["type","text","placeholder","Buscar...",1,"form-control",3,"ngModel","ngModelChange","keyUp.enter"],[1,"text-right","animated","fadeInRight"],[3,"total","limit","pages"],[1,"table-responsive","animated","fadeInUp"],[1,"table","table-hover","table-striped","table-bordered","mt-3"],[3,"click"],[3,"title","field","sort","direction"],[4,"ngFor","ngForOf"],[1,"float-left"],[3,"total"],[3,"limit","pages"],[3,"innerHTML"],[1,"text-right"],["matTooltip","Editar","matTooltipPosition","above","role","button",1,"btn-edit","btn","btn-outline-info","btn-xs","mr-1",3,"routerLink"],[1,"fa","fa-pencil","text-info"],["matTooltip","Eliminar","matTooltipPosition","above","role","button",1,"btn-remove","btn","btn-outline-danger","btn-xs",3,"click"],[1,"fa","fa-trash","text-danger"]],template:function(n,s){1&n&&(ce(0,"div",0),it(1,"app-breadcrumb",1),ce(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"a",9),it(10,"i",10),Te(11," Nuevo"),ue()()(),ce(12,"div",11)(13,"div")(14,"input",12),zt("ngModelChange",function(m){return s.query=m})("keyUp.enter",function(){return s.search()}),ue()()(),ce(15,"div",7)(16,"div",13),it(17,"app-pagination",14),ue()()(),ce(18,"div",15)(19,"table",16)(20,"thead")(21,"tr")(22,"th",17),zt("click",function(){return s.categoryService.setOrder("name")}),it(23,"app-table-th",18),ue(),ce(24,"th",17),zt("click",function(){return s.categoryService.setOrder("inHome")}),it(25,"app-table-th",18),ue(),it(26,"th"),ue()(),ce(27,"tbody"),Ln(28,iq,10,7,"tr",19),ue()(),ce(29,"div",20),it(30,"app-count-results",21),ue(),it(31,"app-pagination",22),ue()()()()()()),2&n&&(we(1),Be("title","Catgeor\xedas")("breadcrumbs",s.breadcrumbs),we(13),Be("ngModel",s.query),we(3),Be("total",s.data.recordsFiltered)("limit",s.categoryService.limit)("pages",s.data.pages),we(6),Be("title","Nombre")("field","name")("sort",s.categoryService.sort)("direction",s.categoryService.direction),we(2),Be("title","Home")("field","inHome")("sort",s.categoryService.sort)("direction",s.categoryService.direction),we(3),Be("ngForOf",s.data.data),we(2),Be("total",s.data.total),we(1),Be("limit",s.categoryService.limit)("pages",s.data.pages))},dependencies:[Gl,pl,Mc,Zl,sa,Pv,gu,l1,c1,u1,d1],encapsulation:2}),t})(),y3=(()=>{var e;class t{constructor(n,s,u,m,b,T){this._msgErrors=n,this.spinner=s,this.router=u,this._snackBar=m,this.activatedRoute=b,this.categoryService=T,this.form={id:"",name:"",inHome:0},this.titlePage="Nuevo",this.breadcrumbs=[{url:"/admin/inicio",title:"Inicio"},{url:"/admin/categories",title:"Categor\xedas"},{url:"",title:"Nuevo"}];let R=this.activatedRoute.snapshot.paramMap.get("id");R&&(this.getOne(R),this.breadcrumbs[this.breadcrumbs.length-1].title="Editar",this.titlePage="Editar")}getOne(n){this.spinner.show(),this.categoryService.getOne(n).subscribe(s=>{this.form=s.category,this.form.inHome=s.category.inHome?1:0,this.spinner.hide()},()=>this.spinner.hide())}ngOnInit(){}save(n){this.spinner.show(),this.categoryService.save(this.form).subscribe(s=>{this._snackBar.open("Registro creado","Aceptar",{duration:3e3}),this.router.navigate(["/admin/categories"])},s=>this._msgErrors.show(s))}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(E_),xe(fl),xe(Jo),xe(Sc),xe(pu),xe(mA))},e.\u0275cmp=Ci({type:e,selectors:[["app-category-form"]],decls:32,vars:5,consts:[[1,"container-fluid","animated","fadeIn"],[3,"title","breadcrumbs"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"card-title","animated","fadeInDown"],[1,"form-material","m-t-40",3,"ngSubmit"],["demo","ngForm"],[1,"col-sm-6"],[1,"form-group"],["type","text","name","name","placeholder","",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-sm-2"],["name","inHome",1,"form-control",3,"ngModel","ngModelChange"],["value","1"],["value","0"],[1,"animated","fadeInUp"],["type","submit",1,"btn","btn-success","waves-effect","waves-light","m-r-10"],[1,"fa","fa-save"],["role","button","routerLink","/admin/categories","type","button",1,"btn","btn-inverse","waves-effect","waves-light"],[1,"fa","fa-remove"]],template:function(n,s){if(1&n){const u=Sr();ce(0,"div",0),it(1,"app-breadcrumb",1),ce(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h4",6),Te(7),ue(),ce(8,"form",7,8),zt("ngSubmit",function(){Mn(u);const b=Pa(9);return Cn(s.save(b))}),ce(10,"div",2)(11,"div",9)(12,"div",10)(13,"label"),Te(14,"Nombre"),ue(),ce(15,"input",11),zt("ngModelChange",function(b){return s.form.name=b}),ue()()(),ce(16,"div",12)(17,"div",10)(18,"label"),Te(19,"Home"),ue(),ce(20,"select",13),zt("ngModelChange",function(b){return s.form.inHome=b}),ce(21,"option",14),Te(22,"SI"),ue(),ce(23,"option",15),Te(24,"NO"),ue()()()()(),ce(25,"div",16)(26,"button",17),it(27,"i",18),Te(28," Guardar"),ue(),ce(29,"a",19),it(30,"i",20),Te(31," Cancelar"),ue()()()()()()()()}2&n&&(we(1),Be("title","Demos")("breadcrumbs",s.breadcrumbs),we(6),hn(s.breadcrumbs[s.breadcrumbs.length-1].title),we(8),Be("ngModel",s.form.name),we(5),Be("ngModel",s.form.inHome))},dependencies:[bm,n1,r1,pl,w_,Mc,vm,Zl,fh,sa,gu],encapsulation:2}),t})(),oq=(()=>{var e;class t{constructor(n,s){this.http=n,this.login=s}get(){return this.http.get(`${bi_baseBEUrl}/api/settings`,this.login.createAuthorizationHeader())}save(n){return this.http.put(`${bi_baseBEUrl}/api/settings`,n,this.login.createAuthorizationHeader())}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(od),ze(Ec))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac,providedIn:"root"}),t})();function sq(e,t){if(1&e){const r=Sr();ce(0,"button",30),zt("click",function(){return Mn(r),Cn(Dn().removeBanner("assets/images/default-background.jpg"))}),it(1,"i",31),Te(2," Quitar imagen"),ue()}}function aq(e,t){if(1&e){const r=Sr();ce(0,"tr")(1,"td"),Te(2),ue(),ce(3,"td"),Te(4),ue(),ce(5,"td"),Te(6),go(7,"date"),ue(),ce(8,"td"),Te(9),go(10,"date"),ue(),ce(11,"td")(12,"input",32),zt("ngModelChange",function(s){const m=Mn(r).index;return Cn(Dn().inputValues[m]=s)}),ue()()()}if(2&e){const r=t.$implicit,n=t.index,s=Dn();we(2),hn(r.category.name),we(2),hn(r.name),we(2),hn(im(7,6,r.start_date,"dd/MM/yyyy HH:mm")),we(3),hn(im(10,9,r.end_date,"dd/MM/yyyy HH:mm")),we(3),em("name","orden_",n,""),Be("ngModel",s.inputValues[n])}}const lq=[{path:"admin/login",component:xG},{path:"admin/inicio",component:TO,canActivate:[As]},{path:"admin",component:TO,canActivate:[As]},{path:"admin/setting",component:(()=>{var e;class t{constructor(n,s,u,m,b,T){this._msgErrors=n,this.spinner=s,this.settings=u,this.events=m,this.eventService=b,this._snackBar=T,this.data={},this.query="",this.breadcrumbs=[{url:"/admin/inicio",title:"Inicio"},{url:"",title:"SETTING"}],this.inputValues=[],this.form={max_slider_categories:"",max_slider_home:"",max_slider_last:"",max_slider_similar:"",banner:"",bannerBase64:"",banner_link:"",slider_home:[]},this.tmp={banner:""}}ngOnInit(){this.getResult(),this.events.subscribe("app-input-file",n=>{this.form[n.inputName]=n.base64,this.tmp[n.inputNamePreview]=n.base64})}ngOnDestroy(){this.events.destroy("app-input-file")}getResult(){this.spinner.show(),this.settings.get().subscribe(n=>{this.form=n.setting,this.tmp.banner=n.setting.banner?n.setting.banner:"assets/images/default-background.jpg"}),this.eventService.getHome().subscribe(n=>{n.data.forEach(s=>{this.inputValues.push(s.order)}),this.data=n},n=>this.spinner.hide(),()=>this.spinner.hide())}save(n){let s=[];this.inputValues.forEach((u,m)=>{s.push({id:this.data.data[m].id,order:u})}),this.form.slider_home=s,this.spinner.show(),this.settings.save(this.form).subscribe(u=>{this._snackBar.open("Los datos se guardaron correctamente","Aceptar",{duration:3e3}),location.reload()},u=>this._msgErrors.show(u))}removeBanner(n){this.form.bannerBase64="##delete##",this.tmp.banner=n}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(E_),xe(fl),xe(oq),xe(Hs),xe(pA),xe(Sc))},e.\u0275cmp=Ci({type:e,selectors:[["app-setting"]],decls:69,vars:15,consts:[[1,"container-fluid","animated","fadeIn"],[3,"title","breadcrumbs"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"m-t-10",3,"ngSubmit"],["demo","ngForm"],[1,"row","form-material"],[1,"col-sm-6"],[1,"form-group"],["type","text","name","max_slider_home","placeholder","",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","max_slider_categories","placeholder","",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","max_slider_last","placeholder","",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","max_slider_similar","placeholder","",1,"form-control",3,"ngModel","ngModelChange"],[1,"card-title","animated","fadeInDown"],[3,"path","default"],[3,"maxSize","inputName","inputNamePreview","accept"],["class","btn btn-danger btn-xs","type","button",3,"click",4,"ngIf"],[1,"col-sm-12"],["type","text","name","banner_link","placeholder","",1,"form-control",3,"ngModel","ngModelChange"],[1,"card-title","animated","fadeInDown","mt-4"],[1,"table-responsive","animated","fadeInUp"],[1,"table","table-hover","table-striped","table-bordered","mt-3"],[4,"ngFor","ngForOf"],[1,"animated","fadeInUp","mt-5"],["type","submit",1,"btn","btn-success","waves-effect","waves-light","m-r-10"],[1,"fa","fa-save"],["role","button","routerLink","/admin/demos","type","button",1,"btn","btn-inverse","waves-effect","waves-light"],[1,"fa","fa-remove"],["type","button",1,"btn","btn-danger","btn-xs",3,"click"],[1,"fa","fa-trash"],["type","number",1,"form-control",3,"ngModel","name","ngModelChange"]],template:function(n,s){if(1&n){const u=Sr();ce(0,"div",0),it(1,"app-breadcrumb",1),ce(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"form",6,7),zt("ngSubmit",function(){Mn(u);const b=Pa(7);return Cn(s.save(b))}),ce(8,"div",8)(9,"div",9)(10,"div",10)(11,"label"),Te(12,"Slider 'Home'"),ue(),ce(13,"input",11),zt("ngModelChange",function(b){return s.form.max_slider_home=b}),ue()()(),ce(14,"div",9)(15,"div",10)(16,"label"),Te(17,"Slider de 'Categor\xedas'"),ue(),ce(18,"input",12),zt("ngModelChange",function(b){return s.form.max_slider_categories=b}),ue()()(),ce(19,"div",9)(20,"div",10)(21,"label"),Te(22,"Slider de 'Pr\xf3ximos eventos'"),ue(),ce(23,"input",13),zt("ngModelChange",function(b){return s.form.max_slider_last=b}),ue()()(),ce(24,"div",9)(25,"div",10)(26,"label"),Te(27,"Slider de 'Eventos similares'"),ue(),ce(28,"input",14),zt("ngModelChange",function(b){return s.form.max_slider_similar=b}),ue()()()(),ce(29,"h4",15),Te(30,"Banner en 'Home'"),ue(),it(31,"hr"),ce(32,"div",8)(33,"div",9),it(34,"app-card-picture",16),ue(),ce(35,"div",9),it(36,"app-input-file",17),Ln(37,sq,3,0,"button",18),ue(),ce(38,"div",19)(39,"div",10)(40,"label"),Te(41,"Link"),ue(),ce(42,"input",20),zt("ngModelChange",function(b){return s.form.banner_link=b}),ue()()()(),ce(43,"h4",21),Te(44,"Ordenar slider 'Home'"),ue(),it(45,"hr"),ce(46,"div",22)(47,"table",23)(48,"thead")(49,"tr")(50,"th"),Te(51,"Categor\xeda"),ue(),ce(52,"th"),Te(53,"Nombre"),ue(),ce(54,"th"),Te(55,"Inicio"),ue(),ce(56,"th"),Te(57,"Fin"),ue(),ce(58,"th"),Te(59,"Orden"),ue()()(),ce(60,"tbody"),Ln(61,aq,13,12,"tr",24),ue()()(),ce(62,"div",25)(63,"button",26),it(64,"i",27),Te(65," Guardar"),ue(),ce(66,"a",28),it(67,"i",29),Te(68," Cancelar"),ue()()()()()()()()}2&n&&(we(1),Be("title","SETTING")("breadcrumbs",s.breadcrumbs),we(12),Be("ngModel",s.form.max_slider_home),we(5),Be("ngModel",s.form.max_slider_categories),we(5),Be("ngModel",s.form.max_slider_last),we(5),Be("ngModel",s.form.max_slider_similar),we(6),Be("path",s.tmp.banner)("default","assets/images/default-background.jpg"),we(2),Be("maxSize",2e3)("inputName","bannerBase64")("inputNamePreview","banner")("accept","image/png, image/jpeg, image/jpg"),we(1),Be("ngIf",s.form.banner||"assets/images/default-background.jpg"!=s.tmp.banner),we(5),Be("ngModel",s.form.banner_link),we(19),Be("ngForOf",s.data.data))},dependencies:[Gl,Na,bm,pl,J2,Mc,vm,Zl,fh,sa,gu,m3,g3,mx],encapsulation:2}),t})(),canActivate:[As]},{path:"admin/demos",component:Q7,canActivate:[As]},{path:"admin/demos/nuevo",component:YL,canActivate:[As]},{path:"admin/demos/editar/:id",component:YL,canActivate:[As]},{path:"admin/events",component:JG,canActivate:[As]},{path:"admin/events/nuevo",component:_3,canActivate:[As]},{path:"admin/events/editar/:id",component:_3,canActivate:[As]},{path:"admin/categories",component:rq,canActivate:[As]},{path:"admin/categories/nuevo",component:y3,canActivate:[As]},{path:"admin/categories/editar/:id",component:y3,canActivate:[As]},{path:"admin/usuarios",component:XG,canActivate:[As]},{path:"admin/usuarios/nuevo",component:e3,canActivate:[As]},{path:"admin/usuarios/editar/:id",component:e3,canActivate:[As]},{path:"admin/integraciones",component:DG,canActivate:[As]},{path:"admin/integraciones/nuevo",component:KL,canActivate:[As]},{path:"admin/integraciones/:id",component:WG,canActivate:[As]},{path:"admin/integraciones/editar/:id",component:KL,canActivate:[As]},{path:"",pathMatch:"full",component:t3},{path:"**",pathMatch:"full",component:t3}];let cq=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({imports:[sO.forRoot(lq),sO]}),t})(),uq=(()=>{var e;class t{constructor(){}ngOnInit(){}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Ci({type:e,selectors:[["app-navbar"]],decls:34,vars:6,consts:[[1,"sidebar-nav","mt-3"],["id","sidebarnav "],["routerLink","/admin/inicio","routerLinkActive","active","aria-expanded","false"],[1,"mdi","mdi","mdi-gauge"],[1,"hide-menu"],["routerLink","/admin/integraciones","routerLinkActive","active","aria-expanded","false"],[1,"fa","fa-link"],["routerLink","/admin/categories","routerLinkActive","active","aria-expanded","false"],[1,"fa","fa-object-group"],["routerLink","/admin/events","routerLinkActive","active","aria-expanded","false"],[1,"fa","fa-calendar"],["routerLink","/admin/usuarios","routerLinkActive","active","aria-expanded","false"],[1,"fa","fa-users"],["routerLink","/admin/setting","routerLinkActive","active","aria-expanded","false"],[1,"fa","fa-cog"]],template:function(n,s){1&n&&(ce(0,"nav",0)(1,"ul",1)(2,"li")(3,"a",2),it(4,"i",3),ce(5,"span",4),Te(6,"Dashboard"),ue()()(),ce(7,"li")(8,"a",5),it(9,"i",6),ce(10,"span",4),Te(11,"Integraciones"),ue()()(),ce(12,"li")(13,"a",7),it(14,"i",8),ce(15,"span",4),Te(16,"Categor\xedas"),ue()()(),ce(17,"li")(18,"a",9),it(19,"i",10),ce(20,"span",4),Te(21,"Eventos"),ue()()(),ce(22,"li")(23,"a",11),it(24,"i",12),ce(25,"span",4),Te(26),go(27,"translate"),ue()()(),ce(28,"li")(29,"a",13),it(30,"i",14),ce(31,"span",4),Te(32),go(33,"translate"),ue()()()()()),2&n&&(we(26),hn(ms(27,2,"USERS")),we(6),hn(ms(33,4,"SETTING")))},dependencies:[sa,QP,dD]}),t})();function dq(e,t){if(1&e){const r=Sr();jr(0),ce(1,"div",3)(2,"header",4)(3,"nav",5)(4,"div",6)(5,"a",7)(6,"b"),it(7,"img",8)(8,"img",9),ue(),ce(9,"span"),it(10,"img",10)(11,"img",11),ue()()(),ce(12,"div",12)(13,"ul",13)(14,"li",14)(15,"a",15),it(16,"i",16),ue()(),ce(17,"li",14)(18,"a",17),it(19,"i",16),ue()(),it(20,"li",18),ue(),ce(21,"ul",19)(22,"li",20)(23,"a",21),zt("click",function(){return Mn(r),Cn(Dn().logout())}),it(24,"i",22),ue()()()()()(),ce(25,"aside",23)(26,"div",24),it(27,"app-navbar"),ue()(),ce(28,"div",25),it(29,"router-outlet"),ce(30,"footer",26),Te(31),ue()()(),Ur()}if(2&e){const r=Dn();we(31),Xn(" \xa9 2021 - ",r.title," ")}}function hq(e,t){1&e&&(jr(0),it(1,"router-outlet"),Ur())}let fq=(()=>{var e;class t{constructor(n,s,u){this.loginService=n,this.translate=s,this.router=u,this.title="Click Group | Agencia Tecnol\xf3gica de Eventos",s.setDefaultLang("es"),s.use("es"),setInterval(()=>{this.loginService.user&&this.loginService.unixtime()-this.loginService.user.lastActivity>60*this.loginService.durationSession&&(this.loginService.logout(),location.reload())},6e4)}logout(){this.loginService.logout(),location.reload()}}return(e=t).\u0275fac=function(n){return new(n||e)(xe(Ec),xe(a1),xe(Jo))},e.\u0275cmp=Ci({type:e,selectors:[["app-root"]],decls:5,vars:2,consts:[[4,"ngIf"],["type","ball-scale-multiple"],[2,"color","white"],["id","main-wrapper"],[1,"topbar"],[1,"navbar","top-navbar","navbar-expand-md","navbar-light"],[1,"navbar-header",2,"background-color","#242b33","border-bottom","#383838 solid 1px","padding","7px 15px"],["routerLink","/admin/inicio",1,"navbar-brand"],["src","assets/images/logo-light-icon.png","alt","homepage",1,"dark-logo",2,"width","45px"],["src","assets/images/logo-icon.png","alt","homepage",1,"light-logo"],["src","assets/images/logo-text.png","alt","homepage",1,"light-logo"],["src","assets/images/logo-light-text.png","alt","homepage",1,"dark-logo",2,"width","160px","margin-left","0.5rem"],[1,"navbar-collapse"],[1,"navbar-nav","mr-auto"],[1,"nav-item"],["href","javascript:void(0)",1,"nav-link","nav-toggler","hidden-md-up","waves-effect","waves-dark"],[1,"ti-menu"],["href","javascript:void(0)",1,"nav-link","sidebartoggler","hidden-sm-down","waves-effect","waves-dark"],[1,"nav-item","hidden-sm-down"],[1,"navbar-nav","my-lg-0"],[1,"nav-item","dropdown"],[1,"nav-link","waves-effect","waves-dark",3,"click"],[1,"fa","fa-sign-out"],[1,"left-sidebar"],[1,"scroll-sidebar"],[1,"page-wrapper"],[1,"footer"]],template:function(n,s){1&n&&(Ln(0,dq,32,1,"ng-container",0),Ln(1,hq,2,0,"ng-container",0),ce(2,"ngx-spinner",1)(3,"p",2),Te(4,"Cargando..."),ue()()),2&n&&(Be("ngIf",s.loginService.isAutenticate()),we(1),Be("ngIf",!s.loginService.isAutenticate()))},dependencies:[Na,WM,sa,l8,uq]}),t})();function v3(e){return new yt(3e3,!1)}function Em(e){switch(e.length){case 0:return new Ux;case 1:return e[0];default:return new IO(e)}}function b3(e,t,r=new Map,n=new Map){const s=[],u=[];let m=-1,b=null;if(t.forEach(T=>{const R=T.get("offset"),z=R==m,W=z&&b||new Map;T.forEach((le,he)=>{let Me=he,Ve=le;if("offset"!==he)switch(Me=e.normalizePropertyName(Me,s),Ve){case"!":Ve=r.get(he);break;case zf:Ve=n.get(he);break;default:Ve=e.normalizeStyleValue(he,Me,Ve,s)}W.set(Me,Ve)}),z||u.push(W),b=W,m=R}),s.length)throw function Lq(e){return new yt(3502,!1)}();return u}function SA(e,t,r,n){switch(t){case"start":e.onStart(()=>n(r&&MA(r,"start",e)));break;case"done":e.onDone(()=>n(r&&MA(r,"done",e)));break;case"destroy":e.onDestroy(()=>n(r&&MA(r,"destroy",e)))}}function MA(e,t,r){const u=AA(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,r.totalTime??e.totalTime,!!r.disabled),m=e._data;return null!=m&&(u._data=m),u}function AA(e,t,r,n,s="",u=0,m){return{element:e,triggerName:t,fromState:r,toState:n,phaseName:s,totalTime:u,disabled:!!m}}function Ic(e,t,r){let n=e.get(t);return n||e.set(t,n=r),n}function x3(e){const t=e.indexOf(":");return[e.substring(1,t),e.slice(t+1)]}const Zq=(()=>typeof document>"u"?null:document.documentElement)();function IA(e){const t=e.parentNode||e.host||null;return t===Zq?null:t}let D_=null,w3=!1;function C3(e,t){for(;t;){if(t===e)return!0;t=IA(t)}return!1}function E3(e,t,r){if(r)return Array.from(e.querySelectorAll(t));const n=e.querySelector(t);return n?[n]:[]}let D3=(()=>{var e;class t{validateStyleProperty(n){return function Xq(e){D_||(D_=function Kq(){return typeof document<"u"?document.body:null}()||{},w3=!!D_.style&&"WebkitAppearance"in D_.style);let t=!0;return D_.style&&!function Yq(e){return"ebkit"==e.substring(1,6)}(e)&&(t=e in D_.style,!t&&w3&&(t="Webkit"+e.charAt(0).toUpperCase()+e.slice(1)in D_.style)),t}(n)}matchesElement(n,s){return!1}containsElement(n,s){return C3(n,s)}getParentElement(n){return IA(n)}query(n,s,u){return E3(n,s,u)}computeStyle(n,s,u){return u||""}animate(n,s,u,m,b,T=[],R){return new Ux(u,m)}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})(),kA=(()=>{class t{}return t.NOOP=new D3,t})();const Qq=1e3,RA="ng-enter",_D="ng-leave",yD="ng-trigger",vD=".ng-trigger",S3="ng-animating",PA=".ng-animating";function Vf(e){if("number"==typeof e)return e;const t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:OA(parseFloat(t[1]),t[2])}function OA(e,t){return"s"===t?e*Qq:e}function bD(e,t,r){return e.hasOwnProperty("duration")?e:function eW(e,t,r){let s,u=0,m="";if("string"==typeof e){const b=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===b)return t.push(v3()),{duration:0,delay:0,easing:""};s=OA(parseFloat(b[1]),b[2]);const T=b[3];null!=T&&(u=OA(parseFloat(T),b[4]));const R=b[5];R&&(m=R)}else s=e;if(!r){let b=!1,T=t.length;s<0&&(t.push(function pq(){return new yt(3100,!1)}()),b=!0),u<0&&(t.push(function mq(){return new yt(3101,!1)}()),b=!0),b&&t.splice(T,0,v3())}return{duration:s,delay:u,easing:m}}(e,t,r)}function f1(e,t={}){return Object.keys(e).forEach(r=>{t[r]=e[r]}),t}function M3(e){const t=new Map;return Object.keys(e).forEach(r=>{t.set(r,e[r])}),t}function Dm(e,t=new Map,r){if(r)for(let[n,s]of r)t.set(n,s);for(let[n,s]of e)t.set(n,s);return t}function ph(e,t,r){t.forEach((n,s)=>{const u=LA(s);r&&!r.has(s)&&r.set(s,e.style[u]),e.style[u]=n})}function T_(e,t){t.forEach((r,n)=>{const s=LA(n);e.style[s]=""})}function p1(e){return Array.isArray(e)?1==e.length?e[0]:MO(e):e}const FA=new RegExp("{{\\s*(.+?)\\s*}}","g");function I3(e){let t=[];if("string"==typeof e){let r;for(;r=FA.exec(e);)t.push(r[1]);FA.lastIndex=0}return t}function m1(e,t,r){const n=e.toString(),s=n.replace(FA,(u,m)=>{let b=t[m];return null==b&&(r.push(function _q(e){return new yt(3003,!1)}()),b=""),b.toString()});return s==n?e:s}function xD(e){const t=[];let r=e.next();for(;!r.done;)t.push(r.value),r=e.next();return t}const iW=/-+([a-z0-9])/g;function LA(e){return e.replace(iW,(...t)=>t[1].toUpperCase())}function kc(e,t,r){switch(t.type){case 7:return e.visitTrigger(t,r);case 0:return e.visitState(t,r);case 1:return e.visitTransition(t,r);case 2:return e.visitSequence(t,r);case 3:return e.visitGroup(t,r);case 4:return e.visitAnimate(t,r);case 5:return e.visitKeyframes(t,r);case 6:return e.visitStyle(t,r);case 8:return e.visitReference(t,r);case 9:return e.visitAnimateChild(t,r);case 10:return e.visitAnimateRef(t,r);case 11:return e.visitQuery(t,r);case 12:return e.visitStagger(t,r);default:throw function yq(e){return new yt(3004,!1)}()}}function k3(e,t){return window.getComputedStyle(e)[t]}const wD="*";function sW(e,t){const r=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(n=>function aW(e,t,r){if(":"==e[0]){const T=function lW(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(r,n)=>parseFloat(n)>parseFloat(r);case":decrement":return(r,n)=>parseFloat(n)<parseFloat(r);default:return t.push(function Rq(e){return new yt(3016,!1)}()),"* => *"}}(e,r);if("function"==typeof T)return void t.push(T);e=T}const n=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return r.push(function kq(e){return new yt(3015,!1)}()),t;const s=n[1],u=n[2],m=n[3];t.push(R3(s,m));"<"==u[0]&&!(s==wD&&m==wD)&&t.push(R3(m,s))}(n,r,t)):r.push(e),r}const CD=new Set(["true","1"]),ED=new Set(["false","0"]);function R3(e,t){const r=CD.has(e)||ED.has(e),n=CD.has(t)||ED.has(t);return(s,u)=>{let m=e==wD||e==s,b=t==wD||t==u;return!m&&r&&"boolean"==typeof s&&(m=s?CD.has(e):ED.has(e)),!b&&n&&"boolean"==typeof u&&(b=u?CD.has(t):ED.has(t)),m&&b}}const cW=new RegExp("s*:selfs*,?","g");function NA(e,t,r,n){return new uW(e).build(t,r,n)}class uW{constructor(t){this._driver=t}build(t,r,n){const s=new fW(r);return this._resetContextStyleTimingState(s),kc(this,p1(t),s)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,r){let n=r.queryCount=0,s=r.depCount=0;const u=[],m=[];return"@"==t.name.charAt(0)&&r.errors.push(function bq(){return new yt(3006,!1)}()),t.definitions.forEach(b=>{if(this._resetContextStyleTimingState(r),0==b.type){const T=b,R=T.name;R.toString().split(/\s*,\s*/).forEach(z=>{T.name=z,u.push(this.visitState(T,r))}),T.name=R}else if(1==b.type){const T=this.visitTransition(b,r);n+=T.queryCount,s+=T.depCount,m.push(T)}else r.errors.push(function xq(){return new yt(3007,!1)}())}),{type:7,name:t.name,states:u,transitions:m,queryCount:n,depCount:s,options:null}}visitState(t,r){const n=this.visitStyle(t.styles,r),s=t.options&&t.options.params||null;if(n.containsDynamicStyles){const u=new Set,m=s||{};n.styles.forEach(b=>{b instanceof Map&&b.forEach(T=>{I3(T).forEach(R=>{m.hasOwnProperty(R)||u.add(R)})})}),u.size&&(xD(u.values()),r.errors.push(function wq(e,t){return new yt(3008,!1)}()))}return{type:0,name:t.name,style:n,options:s?{params:s}:null}}visitTransition(t,r){r.queryCount=0,r.depCount=0;const n=kc(this,p1(t.animation),r);return{type:1,matchers:sW(t.expr,r.errors),animation:n,queryCount:r.queryCount,depCount:r.depCount,options:S_(t.options)}}visitSequence(t,r){return{type:2,steps:t.steps.map(n=>kc(this,n,r)),options:S_(t.options)}}visitGroup(t,r){const n=r.currentTime;let s=0;const u=t.steps.map(m=>{r.currentTime=n;const b=kc(this,m,r);return s=Math.max(s,r.currentTime),b});return r.currentTime=s,{type:3,steps:u,options:S_(t.options)}}visitAnimate(t,r){const n=function mW(e,t){if(e.hasOwnProperty("duration"))return e;if("number"==typeof e)return BA(bD(e,t).duration,0,"");const r=e;if(r.split(/\s+/).some(u=>"{"==u.charAt(0)&&"{"==u.charAt(1))){const u=BA(0,0,"");return u.dynamic=!0,u.strValue=r,u}const s=bD(r,t);return BA(s.duration,s.delay,s.easing)}(t.timings,r.errors);r.currentAnimateTimings=n;let s,u=t.styles?t.styles:es({});if(5==u.type)s=this.visitKeyframes(u,r);else{let m=t.styles,b=!1;if(!m){b=!0;const R={};n.easing&&(R.easing=n.easing),m=es(R)}r.currentTime+=n.duration+n.delay;const T=this.visitStyle(m,r);T.isEmptyStep=b,s=T}return r.currentAnimateTimings=null,{type:4,timings:n,style:s,options:null}}visitStyle(t,r){const n=this._makeStyleAst(t,r);return this._validateStyleAst(n,r),n}_makeStyleAst(t,r){const n=[],s=Array.isArray(t.styles)?t.styles:[t.styles];for(let b of s)"string"==typeof b?b===zf?n.push(b):r.errors.push(new yt(3002,!1)):n.push(M3(b));let u=!1,m=null;return n.forEach(b=>{if(b instanceof Map&&(b.has("easing")&&(m=b.get("easing"),b.delete("easing")),!u))for(let T of b.values())if(T.toString().indexOf("{{")>=0){u=!0;break}}),{type:6,styles:n,easing:m,offset:t.offset,containsDynamicStyles:u,options:null}}_validateStyleAst(t,r){const n=r.currentAnimateTimings;let s=r.currentTime,u=r.currentTime;n&&u>0&&(u-=n.duration+n.delay),t.styles.forEach(m=>{"string"!=typeof m&&m.forEach((b,T)=>{const R=r.collectedStyles.get(r.currentQuerySelector),z=R.get(T);let W=!0;z&&(u!=s&&u>=z.startTime&&s<=z.endTime&&(r.errors.push(function Eq(e,t,r,n,s){return new yt(3010,!1)}()),W=!1),u=z.startTime),W&&R.set(T,{startTime:u,endTime:s}),r.options&&function nW(e,t,r){const n=t.params||{},s=I3(e);s.length&&s.forEach(u=>{n.hasOwnProperty(u)||r.push(function gq(e){return new yt(3001,!1)}())})}(b,r.options,r.errors)})})}visitKeyframes(t,r){const n={type:5,styles:[],options:null};if(!r.currentAnimateTimings)return r.errors.push(function Dq(){return new yt(3011,!1)}()),n;let u=0;const m=[];let b=!1,T=!1,R=0;const z=t.steps.map(wt=>{const ft=this._makeStyleAst(wt,r);let Nn=null!=ft.offset?ft.offset:function pW(e){if("string"==typeof e)return null;let t=null;if(Array.isArray(e))e.forEach(r=>{if(r instanceof Map&&r.has("offset")){const n=r;t=parseFloat(n.get("offset")),n.delete("offset")}});else if(e instanceof Map&&e.has("offset")){const r=e;t=parseFloat(r.get("offset")),r.delete("offset")}return t}(ft.styles),Sn=0;return null!=Nn&&(u++,Sn=ft.offset=Nn),T=T||Sn<0||Sn>1,b=b||Sn<R,R=Sn,m.push(Sn),ft});T&&r.errors.push(function Tq(){return new yt(3012,!1)}()),b&&r.errors.push(function Sq(){return new yt(3200,!1)}());const W=t.steps.length;let le=0;u>0&&u<W?r.errors.push(function Mq(){return new yt(3202,!1)}()):0==u&&(le=1/(W-1));const he=W-1,Me=r.currentTime,Ve=r.currentAnimateTimings,at=Ve.duration;return z.forEach((wt,ft)=>{const Nn=le>0?ft==he?1:le*ft:m[ft],Sn=Nn*at;r.currentTime=Me+Ve.delay+Sn,Ve.duration=Sn,this._validateStyleAst(wt,r),wt.offset=Nn,n.styles.push(wt)}),n}visitReference(t,r){return{type:8,animation:kc(this,p1(t.animation),r),options:S_(t.options)}}visitAnimateChild(t,r){return r.depCount++,{type:9,options:S_(t.options)}}visitAnimateRef(t,r){return{type:10,animation:this.visitReference(t.animation,r),options:S_(t.options)}}visitQuery(t,r){const n=r.currentQuerySelector,s=t.options||{};r.queryCount++,r.currentQuery=t;const[u,m]=function dW(e){const t=!!e.split(/\s*,\s*/).find(r=>":self"==r);return t&&(e=e.replace(cW,"")),e=e.replace(/@\*/g,vD).replace(/@\w+/g,r=>vD+"-"+r.slice(1)).replace(/:animating/g,PA),[e,t]}(t.selector);r.currentQuerySelector=n.length?n+" "+u:u,Ic(r.collectedStyles,r.currentQuerySelector,new Map);const b=kc(this,p1(t.animation),r);return r.currentQuery=null,r.currentQuerySelector=n,{type:11,selector:u,limit:s.limit||0,optional:!!s.optional,includeSelf:m,animation:b,originalSelector:t.selector,options:S_(t.options)}}visitStagger(t,r){r.currentQuery||r.errors.push(function Aq(){return new yt(3013,!1)}());const n="full"===t.timings?{duration:0,delay:0,easing:"full"}:bD(t.timings,r.errors,!0);return{type:12,animation:kc(this,p1(t.animation),r),timings:n,options:null}}}class fW{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function S_(e){return e?(e=f1(e)).params&&(e.params=function hW(e){return e?f1(e):null}(e.params)):e={},e}function BA(e,t,r){return{duration:e,delay:t,easing:r}}function zA(e,t,r,n,s,u,m=null,b=!1){return{type:1,element:e,keyframes:t,preStyleProps:r,postStyleProps:n,duration:s,delay:u,totalTime:s+u,easing:m,subTimeline:b}}class DD{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,r){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...r)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const yW=new RegExp(":enter","g"),bW=new RegExp(":leave","g");function VA(e,t,r,n,s,u=new Map,m=new Map,b,T,R=[]){return(new xW).buildKeyframes(e,t,r,n,s,u,m,b,T,R)}class xW{buildKeyframes(t,r,n,s,u,m,b,T,R,z=[]){R=R||new DD;const W=new jA(t,r,R,s,u,z,[]);W.options=T;const le=T.delay?Vf(T.delay):0;W.currentTimeline.delayNextStep(le),W.currentTimeline.setStyles([m],null,W.errors,T),kc(this,n,W);const he=W.timelines.filter(Me=>Me.containsAnimation());if(he.length&&b.size){let Me;for(let Ve=he.length-1;Ve>=0;Ve--){const at=he[Ve];if(at.element===r){Me=at;break}}Me&&!Me.allowOnlyTimelineStyles()&&Me.setStyles([b],null,W.errors,T)}return he.length?he.map(Me=>Me.buildKeyframes()):[zA(r,[],[],[],0,le,"",!1)]}visitTrigger(t,r){}visitState(t,r){}visitTransition(t,r){}visitAnimateChild(t,r){const n=r.subInstructions.get(r.element);if(n){const s=r.createSubContext(t.options),u=r.currentTimeline.currentTime,m=this._visitSubInstructions(n,s,s.options);u!=m&&r.transformIntoNewTimeline(m)}r.previousNode=t}visitAnimateRef(t,r){const n=r.createSubContext(t.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],r,n),this.visitReference(t.animation,n),r.transformIntoNewTimeline(n.currentTimeline.currentTime),r.previousNode=t}_applyAnimationRefDelays(t,r,n){for(const s of t){const u=s?.delay;if(u){const m="number"==typeof u?u:Vf(m1(u,s?.params??{},r.errors));n.delayNextStep(m)}}}_visitSubInstructions(t,r,n){let u=r.currentTimeline.currentTime;const m=null!=n.duration?Vf(n.duration):null,b=null!=n.delay?Vf(n.delay):null;return 0!==m&&t.forEach(T=>{const R=r.appendInstructionToTimeline(T,m,b);u=Math.max(u,R.duration+R.delay)}),u}visitReference(t,r){r.updateOptions(t.options,!0),kc(this,t.animation,r),r.previousNode=t}visitSequence(t,r){const n=r.subContextCount;let s=r;const u=t.options;if(u&&(u.params||u.delay)&&(s=r.createSubContext(u),s.transformIntoNewTimeline(),null!=u.delay)){6==s.previousNode.type&&(s.currentTimeline.snapshotCurrentStyles(),s.previousNode=TD);const m=Vf(u.delay);s.delayNextStep(m)}t.steps.length&&(t.steps.forEach(m=>kc(this,m,s)),s.currentTimeline.applyStylesToKeyframe(),s.subContextCount>n&&s.transformIntoNewTimeline()),r.previousNode=t}visitGroup(t,r){const n=[];let s=r.currentTimeline.currentTime;const u=t.options&&t.options.delay?Vf(t.options.delay):0;t.steps.forEach(m=>{const b=r.createSubContext(t.options);u&&b.delayNextStep(u),kc(this,m,b),s=Math.max(s,b.currentTimeline.currentTime),n.push(b.currentTimeline)}),n.forEach(m=>r.currentTimeline.mergeTimelineCollectedStyles(m)),r.transformIntoNewTimeline(s),r.previousNode=t}_visitTiming(t,r){if(t.dynamic){const n=t.strValue;return bD(r.params?m1(n,r.params,r.errors):n,r.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,r){const n=r.currentAnimateTimings=this._visitTiming(t.timings,r),s=r.currentTimeline;n.delay&&(r.incrementTime(n.delay),s.snapshotCurrentStyles());const u=t.style;5==u.type?this.visitKeyframes(u,r):(r.incrementTime(n.duration),this.visitStyle(u,r),s.applyStylesToKeyframe()),r.currentAnimateTimings=null,r.previousNode=t}visitStyle(t,r){const n=r.currentTimeline,s=r.currentAnimateTimings;!s&&n.hasCurrentStyleProperties()&&n.forwardFrame();const u=s&&s.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(u):n.setStyles(t.styles,u,r.errors,r.options),r.previousNode=t}visitKeyframes(t,r){const n=r.currentAnimateTimings,s=r.currentTimeline.duration,u=n.duration,b=r.createSubContext().currentTimeline;b.easing=n.easing,t.styles.forEach(T=>{b.forwardTime((T.offset||0)*u),b.setStyles(T.styles,T.easing,r.errors,r.options),b.applyStylesToKeyframe()}),r.currentTimeline.mergeTimelineCollectedStyles(b),r.transformIntoNewTimeline(s+u),r.previousNode=t}visitQuery(t,r){const n=r.currentTimeline.currentTime,s=t.options||{},u=s.delay?Vf(s.delay):0;u&&(6===r.previousNode.type||0==n&&r.currentTimeline.hasCurrentStyleProperties())&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=TD);let m=n;const b=r.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!s.optional,r.errors);r.currentQueryTotal=b.length;let T=null;b.forEach((R,z)=>{r.currentQueryIndex=z;const W=r.createSubContext(t.options,R);u&&W.delayNextStep(u),R===r.element&&(T=W.currentTimeline),kc(this,t.animation,W),W.currentTimeline.applyStylesToKeyframe(),m=Math.max(m,W.currentTimeline.currentTime)}),r.currentQueryIndex=0,r.currentQueryTotal=0,r.transformIntoNewTimeline(m),T&&(r.currentTimeline.mergeTimelineCollectedStyles(T),r.currentTimeline.snapshotCurrentStyles()),r.previousNode=t}visitStagger(t,r){const n=r.parentContext,s=r.currentTimeline,u=t.timings,m=Math.abs(u.duration),b=m*(r.currentQueryTotal-1);let T=m*r.currentQueryIndex;switch(u.duration<0?"reverse":u.easing){case"reverse":T=b-T;break;case"full":T=n.currentStaggerTime}const z=r.currentTimeline;T&&z.delayNextStep(T);const W=z.currentTime;kc(this,t.animation,r),r.previousNode=t,n.currentStaggerTime=s.currentTime-W+(s.startTime-n.currentTimeline.startTime)}}const TD={};class jA{constructor(t,r,n,s,u,m,b,T){this._driver=t,this.element=r,this.subInstructions=n,this._enterClassName=s,this._leaveClassName=u,this.errors=m,this.timelines=b,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=TD,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=T||new SD(this._driver,r,0),b.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,r){if(!t)return;const n=t;let s=this.options;null!=n.duration&&(s.duration=Vf(n.duration)),null!=n.delay&&(s.delay=Vf(n.delay));const u=n.params;if(u){let m=s.params;m||(m=this.options.params={}),Object.keys(u).forEach(b=>{(!r||!m.hasOwnProperty(b))&&(m[b]=m1(u[b],m,this.errors))})}}_copyOptions(){const t={};if(this.options){const r=this.options.params;if(r){const n=t.params={};Object.keys(r).forEach(s=>{n[s]=r[s]})}}return t}createSubContext(t=null,r,n){const s=r||this.element,u=new jA(this._driver,s,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(s,n||0));return u.previousNode=this.previousNode,u.currentAnimateTimings=this.currentAnimateTimings,u.options=this._copyOptions(),u.updateOptions(t),u.currentQueryIndex=this.currentQueryIndex,u.currentQueryTotal=this.currentQueryTotal,u.parentContext=this,this.subContextCount++,u}transformIntoNewTimeline(t){return this.previousNode=TD,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,r,n){const s={duration:r??t.duration,delay:this.currentTimeline.currentTime+(n??0)+t.delay,easing:""},u=new wW(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,s,t.stretchStartingKeyframe);return this.timelines.push(u),s}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,r,n,s,u,m){let b=[];if(s&&b.push(this.element),t.length>0){t=(t=t.replace(yW,"."+this._enterClassName)).replace(bW,"."+this._leaveClassName);let R=this._driver.query(this.element,t,1!=n);0!==n&&(R=n<0?R.slice(R.length+n,R.length):R.slice(0,n)),b.push(...R)}return!u&&0==b.length&&m.push(function Iq(e){return new yt(3014,!1)}()),b}}class SD{constructor(t,r,n,s){this._driver=t,this.element=r,this.startTime=n,this._elementTimelineStylesLookup=s,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(r),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(r,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const r=1===this._keyframes.size&&this._pendingStyles.size;this.duration||r?(this.forwardTime(this.currentTime+t),r&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,r){return this.applyStylesToKeyframe(),new SD(this._driver,t,r||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,r){this._localTimelineStyles.set(t,r),this._globalTimelineStyles.set(t,r),this._styleSummary.set(t,{time:this.currentTime,value:r})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[r,n]of this._globalTimelineStyles)this._backFill.set(r,n||zf),this._currentKeyframe.set(r,zf);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,r,n,s){r&&this._previousKeyframe.set("easing",r);const u=s&&s.params||{},m=function CW(e,t){const r=new Map;let n;return e.forEach(s=>{if("*"===s){n=n||t.keys();for(let u of n)r.set(u,zf)}else Dm(s,r)}),r}(t,this._globalTimelineStyles);for(let[b,T]of m){const R=m1(T,u,n);this._pendingStyles.set(b,R),this._localTimelineStyles.has(b)||this._backFill.set(b,this._globalTimelineStyles.get(b)??zf),this._updateStyle(b,R)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,r)=>{this._currentKeyframe.set(r,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,r)=>{this._currentKeyframe.has(r)||this._currentKeyframe.set(r,t)}))}snapshotCurrentStyles(){for(let[t,r]of this._localTimelineStyles)this._pendingStyles.set(t,r),this._updateStyle(t,r)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let r in this._currentKeyframe)t.push(r);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((r,n)=>{const s=this._styleSummary.get(n);(!s||r.time>s.time)&&this._updateStyle(n,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,r=new Set,n=1===this._keyframes.size&&0===this.duration;let s=[];this._keyframes.forEach((b,T)=>{const R=Dm(b,new Map,this._backFill);R.forEach((z,W)=>{"!"===z?t.add(W):z===zf&&r.add(W)}),n||R.set("offset",T/this.duration),s.push(R)});const u=t.size?xD(t.values()):[],m=r.size?xD(r.values()):[];if(n){const b=s[0],T=new Map(b);b.set("offset",0),T.set("offset",1),s=[b,T]}return zA(this.element,s,u,m,this.duration,this.startTime,this.easing,!1)}}class wW extends SD{constructor(t,r,n,s,u,m,b=!1){super(t,r,m.delay),this.keyframes=n,this.preStyleProps=s,this.postStyleProps=u,this._stretchStartingKeyframe=b,this.timings={duration:m.duration,delay:m.delay,easing:m.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:r,duration:n,easing:s}=this.timings;if(this._stretchStartingKeyframe&&r){const u=[],m=n+r,b=r/m,T=Dm(t[0]);T.set("offset",0),u.push(T);const R=Dm(t[0]);R.set("offset",F3(b)),u.push(R);const z=t.length-1;for(let W=1;W<=z;W++){let le=Dm(t[W]);const he=le.get("offset");le.set("offset",F3((r+he*n)/m)),u.push(le)}n=m,r=0,s="",t=u}return zA(this.element,t,this.preStyleProps,this.postStyleProps,n,r,s,!0)}}function F3(e,t=3){const r=Math.pow(10,t-1);return Math.round(e*r)/r}class UA{}const EW=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class DW extends UA{normalizePropertyName(t,r){return LA(t)}normalizeStyleValue(t,r,n,s){let u="";const m=n.toString().trim();if(EW.has(r)&&0!==n&&"0"!==n)if("number"==typeof n)u="px";else{const b=n.match(/^[+-]?[\d\.]+([a-z]*)$/);b&&0==b[1].length&&s.push(function vq(e,t){return new yt(3005,!1)}())}return m+u}}function L3(e,t,r,n,s,u,m,b,T,R,z,W,le){return{type:0,element:e,triggerName:t,isRemovalTransition:s,fromState:r,fromStyles:u,toState:n,toStyles:m,timelines:b,queriedElements:T,preStyleProps:R,postStyleProps:z,totalTime:W,errors:le}}const HA={};class N3{constructor(t,r,n){this._triggerName=t,this.ast=r,this._stateStyles=n}match(t,r,n,s){return function TW(e,t,r,n,s){return e.some(u=>u(t,r,n,s))}(this.ast.matchers,t,r,n,s)}buildStyles(t,r,n){let s=this._stateStyles.get("*");return void 0!==t&&(s=this._stateStyles.get(t?.toString())||s),s?s.buildStyles(r,n):new Map}build(t,r,n,s,u,m,b,T,R,z){const W=[],le=this.ast.options&&this.ast.options.params||HA,Me=this.buildStyles(n,b&&b.params||HA,W),Ve=T&&T.params||HA,at=this.buildStyles(s,Ve,W),wt=new Set,ft=new Map,Nn=new Map,Sn="void"===s,Ri={params:SW(Ve,le),delay:this.ast.options?.delay},lo=z?[]:VA(t,r,this.ast.animation,u,m,Me,at,Ri,R,W);let Jr=0;if(lo.forEach(Yl=>{Jr=Math.max(Yl.duration+Yl.delay,Jr)}),W.length)return L3(r,this._triggerName,n,s,Sn,Me,at,[],[],ft,Nn,Jr,W);lo.forEach(Yl=>{const cd=Yl.element,kD=Ic(ft,cd,new Set);Yl.preStyleProps.forEach(M_=>kD.add(M_));const _1=Ic(Nn,cd,new Set);Yl.postStyleProps.forEach(M_=>_1.add(M_)),cd!==r&&wt.add(cd)});const ca=xD(wt.values());return L3(r,this._triggerName,n,s,Sn,Me,at,lo,ca,ft,Nn,Jr)}}function SW(e,t){const r=f1(t);for(const n in e)e.hasOwnProperty(n)&&null!=e[n]&&(r[n]=e[n]);return r}class MW{constructor(t,r,n){this.styles=t,this.defaultParams=r,this.normalizer=n}buildStyles(t,r){const n=new Map,s=f1(this.defaultParams);return Object.keys(t).forEach(u=>{const m=t[u];null!==m&&(s[u]=m)}),this.styles.styles.forEach(u=>{"string"!=typeof u&&u.forEach((m,b)=>{m&&(m=m1(m,s,r));const T=this.normalizer.normalizePropertyName(b,r);m=this.normalizer.normalizeStyleValue(b,T,m,r),n.set(b,m)})}),n}}class IW{constructor(t,r,n){this.name=t,this.ast=r,this._normalizer=n,this.transitionFactories=[],this.states=new Map,r.states.forEach(s=>{this.states.set(s.name,new MW(s.style,s.options&&s.options.params||{},n))}),B3(this.states,"true","1"),B3(this.states,"false","0"),r.transitions.forEach(s=>{this.transitionFactories.push(new N3(t,s,this.states))}),this.fallbackTransition=function kW(e,t,r){return new N3(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[(m,b)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,r,n,s){return this.transitionFactories.find(m=>m.match(t,r,n,s))||null}matchStyles(t,r,n){return this.fallbackTransition.buildStyles(t,r,n)}}function B3(e,t,r){e.has(t)?e.has(r)||e.set(r,e.get(t)):e.has(r)&&e.set(t,e.get(r))}const RW=new DD;class PW{constructor(t,r,n){this.bodyNode=t,this._driver=r,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,r){const n=[],u=NA(this._driver,r,n,[]);if(n.length)throw function Nq(e){return new yt(3503,!1)}();this._animations.set(t,u)}_buildPlayer(t,r,n){const s=t.element,u=b3(this._normalizer,t.keyframes,r,n);return this._driver.animate(s,u,t.duration,t.delay,t.easing,[],!0)}create(t,r,n={}){const s=[],u=this._animations.get(t);let m;const b=new Map;if(u?(m=VA(this._driver,r,u,RA,_D,new Map,new Map,n,RW,s),m.forEach(z=>{const W=Ic(b,z.element,new Map);z.postStyleProps.forEach(le=>W.set(le,null))})):(s.push(function Bq(){return new yt(3300,!1)}()),m=[]),s.length)throw function zq(e){return new yt(3504,!1)}();b.forEach((z,W)=>{z.forEach((le,he)=>{z.set(he,this._driver.computeStyle(W,he,zf))})});const R=Em(m.map(z=>{const W=b.get(z.element);return this._buildPlayer(z,new Map,W)}));return this._playersById.set(t,R),R.onDestroy(()=>this.destroy(t)),this.players.push(R),R}destroy(t){const r=this._getPlayer(t);r.destroy(),this._playersById.delete(t);const n=this.players.indexOf(r);n>=0&&this.players.splice(n,1)}_getPlayer(t){const r=this._playersById.get(t);if(!r)throw function Vq(e){return new yt(3301,!1)}();return r}listen(t,r,n,s){const u=AA(r,"","","");return SA(this._getPlayer(t),n,u,s),()=>{}}command(t,r,n,s){if("register"==n)return void this.register(t,s[0]);if("create"==n)return void this.create(t,r,s[0]||{});const u=this._getPlayer(t);switch(n){case"play":u.play();break;case"pause":u.pause();break;case"reset":u.reset();break;case"restart":u.restart();break;case"finish":u.finish();break;case"init":u.init();break;case"setPosition":u.setPosition(parseFloat(s[0]));break;case"destroy":this.destroy(t)}}}const z3="ng-animate-queued",$A="ng-animate-disabled",BW=[],V3={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},zW={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},ld="__ng_removed";class GA{get params(){return this.options.params}constructor(t,r=""){this.namespaceId=r;const n=t&&t.hasOwnProperty("value");if(this.value=function HW(e){return e??null}(n?t.value:t),n){const u=f1(t);delete u.value,this.options=u}else this.options={};this.options.params||(this.options.params={})}absorbOptions(t){const r=t.params;if(r){const n=this.options.params;Object.keys(r).forEach(s=>{null==n[s]&&(n[s]=r[s])})}}}const g1="void",qA=new GA(g1);class VW{constructor(t,r,n){this.id=t,this.hostElement=r,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,_u(r,this._hostClassName)}listen(t,r,n,s){if(!this._triggers.has(r))throw function jq(e,t){return new yt(3302,!1)}();if(null==n||0==n.length)throw function Uq(e){return new yt(3303,!1)}();if(!function $W(e){return"start"==e||"done"==e}(n))throw function Hq(e,t){return new yt(3400,!1)}();const u=Ic(this._elementListeners,t,[]),m={name:r,phase:n,callback:s};u.push(m);const b=Ic(this._engine.statesByElement,t,new Map);return b.has(r)||(_u(t,yD),_u(t,yD+"-"+r),b.set(r,qA)),()=>{this._engine.afterFlush(()=>{const T=u.indexOf(m);T>=0&&u.splice(T,1),this._triggers.has(r)||b.delete(r)})}}register(t,r){return!this._triggers.has(t)&&(this._triggers.set(t,r),!0)}_getTrigger(t){const r=this._triggers.get(t);if(!r)throw function $q(e){return new yt(3401,!1)}();return r}trigger(t,r,n,s=!0){const u=this._getTrigger(r),m=new WA(this.id,r,t);let b=this._engine.statesByElement.get(t);b||(_u(t,yD),_u(t,yD+"-"+r),this._engine.statesByElement.set(t,b=new Map));let T=b.get(r);const R=new GA(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&T&&R.absorbOptions(T.options),b.set(r,R),T||(T=qA),R.value!==g1&&T.value===R.value){if(!function WW(e,t){const r=Object.keys(e),n=Object.keys(t);if(r.length!=n.length)return!1;for(let s=0;s<r.length;s++){const u=r[s];if(!t.hasOwnProperty(u)||e[u]!==t[u])return!1}return!0}(T.params,R.params)){const Ve=[],at=u.matchStyles(T.value,T.params,Ve),wt=u.matchStyles(R.value,R.params,Ve);Ve.length?this._engine.reportError(Ve):this._engine.afterFlush(()=>{T_(t,at),ph(t,wt)})}return}const le=Ic(this._engine.playersByElement,t,[]);le.forEach(Ve=>{Ve.namespaceId==this.id&&Ve.triggerName==r&&Ve.queued&&Ve.destroy()});let he=u.matchTransition(T.value,R.value,t,R.params),Me=!1;if(!he){if(!s)return;he=u.fallbackTransition,Me=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:r,transition:he,fromState:T,toState:R,player:m,isFallbackTransition:Me}),Me||(_u(t,z3),m.onStart(()=>{Lv(t,z3)})),m.onDone(()=>{let Ve=this.players.indexOf(m);Ve>=0&&this.players.splice(Ve,1);const at=this._engine.playersByElement.get(t);if(at){let wt=at.indexOf(m);wt>=0&&at.splice(wt,1)}}),this.players.push(m),le.push(m),m}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(r=>r.delete(t)),this._elementListeners.forEach((r,n)=>{this._elementListeners.set(n,r.filter(s=>s.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const r=this._engine.playersByElement.get(t);r&&(r.forEach(n=>n.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,r){const n=this._engine.driver.query(t,vD,!0);n.forEach(s=>{if(s[ld])return;const u=this._engine.fetchNamespacesByElement(s);u.size?u.forEach(m=>m.triggerLeaveAnimation(s,r,!1,!0)):this.clearElementCache(s)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(s=>this.clearElementCache(s)))}triggerLeaveAnimation(t,r,n,s){const u=this._engine.statesByElement.get(t),m=new Map;if(u){const b=[];if(u.forEach((T,R)=>{if(m.set(R,T.value),this._triggers.has(R)){const z=this.trigger(t,R,g1,s);z&&b.push(z)}}),b.length)return this._engine.markElementAsRemoved(this.id,t,!0,r,m),n&&Em(b).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const r=this._elementListeners.get(t),n=this._engine.statesByElement.get(t);if(r&&n){const s=new Set;r.forEach(u=>{const m=u.name;if(s.has(m))return;s.add(m);const T=this._triggers.get(m).fallbackTransition,R=n.get(m)||qA,z=new GA(g1),W=new WA(this.id,m,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:m,transition:T,fromState:R,toState:z,player:W,isFallbackTransition:!0})})}}removeNode(t,r){const n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,r),this.triggerLeaveAnimation(t,r,!0))return;let s=!1;if(n.totalAnimations){const u=n.players.length?n.playersByQueriedElement.get(t):[];if(u&&u.length)s=!0;else{let m=t;for(;m=m.parentNode;)if(n.statesByElement.get(m)){s=!0;break}}}if(this.prepareLeaveAnimationListeners(t),s)n.markElementAsRemoved(this.id,t,!1,r);else{const u=t[ld];(!u||u===V3)&&(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,r))}}insertNode(t,r){_u(t,this._hostClassName)}drainQueuedTransitions(t){const r=[];return this._queue.forEach(n=>{const s=n.player;if(s.destroyed)return;const u=n.element,m=this._elementListeners.get(u);m&&m.forEach(b=>{if(b.name==n.triggerName){const T=AA(u,n.triggerName,n.fromState.value,n.toState.value);T._data=t,SA(n.player,b.phase,T,b.callback)}}),s.markedForDestroy?this._engine.afterFlush(()=>{s.destroy()}):r.push(n)}),this._queue=[],r.sort((n,s)=>{const u=n.transition.ast.depCount,m=s.transition.ast.depCount;return 0==u||0==m?u-m:this._engine.driver.containsElement(n.element,s.element)?1:-1})}destroy(t){this.players.forEach(r=>r.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}}class jW{_onRemovalComplete(t,r){this.onRemovalComplete(t,r)}constructor(t,r,n){this.bodyNode=t,this.driver=r,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,u)=>{}}get queuedPlayers(){const t=[];return this._namespaceList.forEach(r=>{r.players.forEach(n=>{n.queued&&t.push(n)})}),t}createNamespace(t,r){const n=new VW(t,r,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,r)?this._balanceNamespaceList(n,r):(this.newHostElements.set(r,n),this.collectEnterElement(r)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,r){const n=this._namespaceList,s=this.namespacesByHostElement;if(n.length-1>=0){let m=!1,b=this.driver.getParentElement(r);for(;b;){const T=s.get(b);if(T){const R=n.indexOf(T);n.splice(R+1,0,t),m=!0;break}b=this.driver.getParentElement(b)}m||n.unshift(t)}else n.push(t);return s.set(r,t),t}register(t,r){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,r)),n}registerTrigger(t,r,n){let s=this._namespaceLookup[t];s&&s.register(r,n)&&this.totalAnimations++}destroy(t,r){t&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const n=this._fetchNamespace(t);this.namespacesByHostElement.delete(n.hostElement);const s=this._namespaceList.indexOf(n);s>=0&&this._namespaceList.splice(s,1),n.destroy(r),delete this._namespaceLookup[t]}))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const r=new Set,n=this.statesByElement.get(t);if(n)for(let s of n.values())if(s.namespaceId){const u=this._fetchNamespace(s.namespaceId);u&&r.add(u)}return r}trigger(t,r,n,s){if(MD(r)){const u=this._fetchNamespace(t);if(u)return u.trigger(r,n,s),!0}return!1}insertNode(t,r,n,s){if(!MD(r))return;const u=r[ld];if(u&&u.setForRemoval){u.setForRemoval=!1,u.setForMove=!0;const m=this.collectedLeaveElements.indexOf(r);m>=0&&this.collectedLeaveElements.splice(m,1)}if(t){const m=this._fetchNamespace(t);m&&m.insertNode(r,n)}s&&this.collectEnterElement(r)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,r){r?this.disabledNodes.has(t)||(this.disabledNodes.add(t),_u(t,$A)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Lv(t,$A))}removeNode(t,r,n){if(MD(r)){const s=t?this._fetchNamespace(t):null;s?s.removeNode(r,n):this.markElementAsRemoved(t,r,!1,n);const u=this.namespacesByHostElement.get(r);u&&u.id!==t&&u.removeNode(r,n)}else this._onRemovalComplete(r,n)}markElementAsRemoved(t,r,n,s,u){this.collectedLeaveElements.push(r),r[ld]={namespaceId:t,setForRemoval:s,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:u}}listen(t,r,n,s,u){return MD(r)?this._fetchNamespace(t).listen(r,n,s,u):()=>{}}_buildInstruction(t,r,n,s,u){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,s,t.fromState.options,t.toState.options,r,u)}destroyInnerAnimations(t){let r=this.driver.query(t,vD,!0);r.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(r=this.driver.query(t,PA,!0),r.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(t){const r=this.playersByElement.get(t);r&&r.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(t){const r=this.playersByQueriedElement.get(t);r&&r.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return Em(this.players).onDone(()=>t());t()})}processLeaveNode(t){const r=t[ld];if(r&&r.setForRemoval){if(t[ld]=V3,r.namespaceId){this.destroyInnerAnimations(t);const n=this._fetchNamespace(r.namespaceId);n&&n.clearElementCache(t)}this._onRemovalComplete(t,r.setForRemoval)}t.classList?.contains($A)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(t=-1){let r=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,s)=>this._balanceNamespaceList(n,s)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)_u(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{r=this._flushAnimations(n,t)}finally{for(let s=0;s<n.length;s++)n[s]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],r.length?Em(r).onDone(()=>{n.forEach(s=>s())}):n.forEach(s=>s())}}reportError(t){throw function Gq(e){return new yt(3402,!1)}()}_flushAnimations(t,r){const n=new DD,s=[],u=new Map,m=[],b=new Map,T=new Map,R=new Map,z=new Set;this.disabledNodes.forEach(ei=>{z.add(ei);const _i=this.driver.query(ei,".ng-animate-queued",!0);for(let Ti=0;Ti<_i.length;Ti++)z.add(_i[Ti])});const W=this.bodyNode,le=Array.from(this.statesByElement.keys()),he=H3(le,this.collectedEnterElements),Me=new Map;let Ve=0;he.forEach((ei,_i)=>{const Ti=RA+Ve++;Me.set(_i,Ti),ei.forEach(Ar=>_u(Ar,Ti))});const at=[],wt=new Set,ft=new Set;for(let ei=0;ei<this.collectedLeaveElements.length;ei++){const _i=this.collectedLeaveElements[ei],Ti=_i[ld];Ti&&Ti.setForRemoval&&(at.push(_i),wt.add(_i),Ti.hasAnimation?this.driver.query(_i,".ng-star-inserted",!0).forEach(Ar=>wt.add(Ar)):ft.add(_i))}const Nn=new Map,Sn=H3(le,Array.from(wt));Sn.forEach((ei,_i)=>{const Ti=_D+Ve++;Nn.set(_i,Ti),ei.forEach(Ar=>_u(Ar,Ti))}),t.push(()=>{he.forEach((ei,_i)=>{const Ti=Me.get(_i);ei.forEach(Ar=>Lv(Ar,Ti))}),Sn.forEach((ei,_i)=>{const Ti=Nn.get(_i);ei.forEach(Ar=>Lv(Ar,Ti))}),at.forEach(ei=>{this.processLeaveNode(ei)})});const Ri=[],lo=[];for(let ei=this._namespaceList.length-1;ei>=0;ei--)this._namespaceList[ei].drainQueuedTransitions(r).forEach(Ti=>{const Ar=Ti.player,Gs=Ti.element;if(Ri.push(Ar),this.collectedEnterElements.length){const za=Gs[ld];if(za&&za.setForMove){if(za.previousTriggersValues&&za.previousTriggersValues.has(Ti.triggerName)){const A_=za.previousTriggersValues.get(Ti.triggerName),yu=this.statesByElement.get(Ti.element);if(yu&&yu.has(Ti.triggerName)){const RD=yu.get(Ti.triggerName);RD.value=A_,yu.set(Ti.triggerName,RD)}}return void Ar.destroy()}}const mh=!W||!this.driver.containsElement(W,Gs),Rc=Nn.get(Gs),Tm=Me.get(Gs),jo=this._buildInstruction(Ti,n,Tm,Rc,mh);if(jo.errors&&jo.errors.length)return void lo.push(jo);if(mh)return Ar.onStart(()=>T_(Gs,jo.fromStyles)),Ar.onDestroy(()=>ph(Gs,jo.toStyles)),void s.push(Ar);if(Ti.isFallbackTransition)return Ar.onStart(()=>T_(Gs,jo.fromStyles)),Ar.onDestroy(()=>ph(Gs,jo.toStyles)),void s.push(Ar);const iN=[];jo.timelines.forEach(za=>{za.stretchStartingKeyframe=!0,this.disabledNodes.has(za.element)||iN.push(za)}),jo.timelines=iN,n.append(Gs,jo.timelines),m.push({instruction:jo,player:Ar,element:Gs}),jo.queriedElements.forEach(za=>Ic(b,za,[]).push(Ar)),jo.preStyleProps.forEach((za,A_)=>{if(za.size){let yu=T.get(A_);yu||T.set(A_,yu=new Set),za.forEach((RD,XA)=>yu.add(XA))}}),jo.postStyleProps.forEach((za,A_)=>{let yu=R.get(A_);yu||R.set(A_,yu=new Set),za.forEach((RD,XA)=>yu.add(XA))})});if(lo.length){const ei=[];lo.forEach(_i=>{ei.push(function qq(e,t){return new yt(3505,!1)}())}),Ri.forEach(_i=>_i.destroy()),this.reportError(ei)}const Jr=new Map,ca=new Map;m.forEach(ei=>{const _i=ei.element;n.has(_i)&&(ca.set(_i,_i),this._beforeAnimationBuild(ei.player.namespaceId,ei.instruction,Jr))}),s.forEach(ei=>{const _i=ei.element;this._getPreviousPlayers(_i,!1,ei.namespaceId,ei.triggerName,null).forEach(Ar=>{Ic(Jr,_i,[]).push(Ar),Ar.destroy()})});const Yl=at.filter(ei=>G3(ei,T,R)),cd=new Map;U3(cd,this.driver,ft,R,zf).forEach(ei=>{G3(ei,T,R)&&Yl.push(ei)});const _1=new Map;he.forEach((ei,_i)=>{U3(_1,this.driver,new Set(ei),T,"!")}),Yl.forEach(ei=>{const _i=cd.get(ei),Ti=_1.get(ei);cd.set(ei,new Map([..._i?.entries()??[],...Ti?.entries()??[]]))});const M_=[],tN=[],nN={};m.forEach(ei=>{const{element:_i,player:Ti,instruction:Ar}=ei;if(n.has(_i)){if(z.has(_i))return Ti.onDestroy(()=>ph(_i,Ar.toStyles)),Ti.disabled=!0,Ti.overrideTotalTime(Ar.totalTime),void s.push(Ti);let Gs=nN;if(ca.size>1){let Rc=_i;const Tm=[];for(;Rc=Rc.parentNode;){const jo=ca.get(Rc);if(jo){Gs=jo;break}Tm.push(Rc)}Tm.forEach(jo=>ca.set(jo,Gs))}const mh=this._buildAnimation(Ti.namespaceId,Ar,Jr,u,_1,cd);if(Ti.setRealPlayer(mh),Gs===nN)M_.push(Ti);else{const Rc=this.playersByElement.get(Gs);Rc&&Rc.length&&(Ti.parentPlayer=Em(Rc)),s.push(Ti)}}else T_(_i,Ar.fromStyles),Ti.onDestroy(()=>ph(_i,Ar.toStyles)),tN.push(Ti),z.has(_i)&&s.push(Ti)}),tN.forEach(ei=>{const _i=u.get(ei.element);if(_i&&_i.length){const Ti=Em(_i);ei.setRealPlayer(Ti)}}),s.forEach(ei=>{ei.parentPlayer?ei.syncPlayerEvents(ei.parentPlayer):ei.destroy()});for(let ei=0;ei<at.length;ei++){const _i=at[ei],Ti=_i[ld];if(Lv(_i,_D),Ti&&Ti.hasAnimation)continue;let Ar=[];if(b.size){let mh=b.get(_i);mh&&mh.length&&Ar.push(...mh);let Rc=this.driver.query(_i,PA,!0);for(let Tm=0;Tm<Rc.length;Tm++){let jo=b.get(Rc[Tm]);jo&&jo.length&&Ar.push(...jo)}}const Gs=Ar.filter(mh=>!mh.destroyed);Gs.length?GW(this,_i,Gs):this.processLeaveNode(_i)}return at.length=0,M_.forEach(ei=>{this.players.push(ei),ei.onDone(()=>{ei.destroy();const _i=this.players.indexOf(ei);this.players.splice(_i,1)}),ei.play()}),M_}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,r,n,s,u){let m=[];if(r){const b=this.playersByQueriedElement.get(t);b&&(m=b)}else{const b=this.playersByElement.get(t);if(b){const T=!u||u==g1;b.forEach(R=>{R.queued||!T&&R.triggerName!=s||m.push(R)})}}return(n||s)&&(m=m.filter(b=>!(n&&n!=b.namespaceId||s&&s!=b.triggerName))),m}_beforeAnimationBuild(t,r,n){const u=r.element,m=r.isRemovalTransition?void 0:t,b=r.isRemovalTransition?void 0:r.triggerName;for(const T of r.timelines){const R=T.element,z=R!==u,W=Ic(n,R,[]);this._getPreviousPlayers(R,z,m,b,r.toState).forEach(he=>{const Me=he.getRealPlayer();Me.beforeDestroy&&Me.beforeDestroy(),he.destroy(),W.push(he)})}T_(u,r.fromStyles)}_buildAnimation(t,r,n,s,u,m){const b=r.triggerName,T=r.element,R=[],z=new Set,W=new Set,le=r.timelines.map(Me=>{const Ve=Me.element;z.add(Ve);const at=Ve[ld];if(at&&at.removedBeforeQueried)return new Ux(Me.duration,Me.delay);const wt=Ve!==T,ft=function qW(e){const t=[];return $3(e,t),t}((n.get(Ve)||BW).map(Jr=>Jr.getRealPlayer())).filter(Jr=>!!Jr.element&&Jr.element===Ve),Nn=u.get(Ve),Sn=m.get(Ve),Ri=b3(this._normalizer,Me.keyframes,Nn,Sn),lo=this._buildPlayer(Me,Ri,ft);if(Me.subTimeline&&s&&W.add(Ve),wt){const Jr=new WA(t,b,Ve);Jr.setRealPlayer(lo),R.push(Jr)}return lo});R.forEach(Me=>{Ic(this.playersByQueriedElement,Me.element,[]).push(Me),Me.onDone(()=>function UW(e,t,r){let n=e.get(t);if(n){if(n.length){const s=n.indexOf(r);n.splice(s,1)}0==n.length&&e.delete(t)}return n}(this.playersByQueriedElement,Me.element,Me))}),z.forEach(Me=>_u(Me,S3));const he=Em(le);return he.onDestroy(()=>{z.forEach(Me=>Lv(Me,S3)),ph(T,r.toStyles)}),W.forEach(Me=>{Ic(s,Me,[]).push(he)}),he}_buildPlayer(t,r,n){return r.length>0?this.driver.animate(t.element,r,t.duration,t.delay,t.easing,n):new Ux(t.duration,t.delay)}}class WA{constructor(t,r,n){this.namespaceId=t,this.triggerName=r,this.element=n,this._player=new Ux,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((r,n)=>{r.forEach(s=>SA(t,n,void 0,s))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const r=this._player;r.triggerCallback&&t.onStart(()=>r.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,r){Ic(this._queuedCallbacks,t,[]).push(r)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const r=this._player;r.triggerCallback&&r.triggerCallback(t)}}function MD(e){return e&&1===e.nodeType}function j3(e,t){const r=e.style.display;return e.style.display=t??"none",r}function U3(e,t,r,n,s){const u=[];r.forEach(T=>u.push(j3(T)));const m=[];n.forEach((T,R)=>{const z=new Map;T.forEach(W=>{const le=t.computeStyle(R,W,s);z.set(W,le),(!le||0==le.length)&&(R[ld]=zW,m.push(R))}),e.set(R,z)});let b=0;return r.forEach(T=>j3(T,u[b++])),m}function H3(e,t){const r=new Map;if(e.forEach(b=>r.set(b,[])),0==t.length)return r;const s=new Set(t),u=new Map;function m(b){if(!b)return 1;let T=u.get(b);if(T)return T;const R=b.parentNode;return T=r.has(R)?R:s.has(R)?1:m(R),u.set(b,T),T}return t.forEach(b=>{const T=m(b);1!==T&&r.get(T).push(b)}),r}function _u(e,t){e.classList?.add(t)}function Lv(e,t){e.classList?.remove(t)}function GW(e,t,r){Em(r).onDone(()=>e.processLeaveNode(t))}function $3(e,t){for(let r=0;r<e.length;r++){const n=e[r];n instanceof IO?$3(n.players,t):t.push(n)}}function G3(e,t,r){const n=r.get(e);if(!n)return!1;let s=t.get(e);return s?n.forEach(u=>s.add(u)):t.set(e,n),r.delete(e),!0}class AD{constructor(t,r,n){this.bodyNode=t,this._driver=r,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(s,u)=>{},this._transitionEngine=new jW(t,r,n),this._timelineEngine=new PW(t,r,n),this._transitionEngine.onRemovalComplete=(s,u)=>this.onRemovalComplete(s,u)}registerTrigger(t,r,n,s,u){const m=t+"-"+s;let b=this._triggerCache[m];if(!b){const T=[],z=NA(this._driver,u,T,[]);if(T.length)throw function Fq(e,t){return new yt(3404,!1)}();b=function AW(e,t,r){return new IW(e,t,r)}(s,z,this._normalizer),this._triggerCache[m]=b}this._transitionEngine.registerTrigger(r,s,b)}register(t,r){this._transitionEngine.register(t,r)}destroy(t,r){this._transitionEngine.destroy(t,r)}onInsert(t,r,n,s){this._transitionEngine.insertNode(t,r,n,s)}onRemove(t,r,n){this._transitionEngine.removeNode(t,r,n)}disableAnimations(t,r){this._transitionEngine.markElementAsDisabled(t,r)}process(t,r,n,s){if("@"==n.charAt(0)){const[u,m]=x3(n);this._timelineEngine.command(u,r,m,s)}else this._transitionEngine.trigger(t,r,n,s)}listen(t,r,n,s,u){if("@"==n.charAt(0)){const[m,b]=x3(n);return this._timelineEngine.listen(m,r,b,u)}return this._transitionEngine.listen(t,r,n,s,u)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(t){this._transitionEngine.afterFlushAnimationsDone(t)}}let YW=(()=>{class t{constructor(n,s,u){this._element=n,this._startStyles=s,this._endStyles=u,this._state=0;let m=t.initialStylesByElement.get(n);m||t.initialStylesByElement.set(n,m=new Map),this._initialStyles=m}start(){this._state<1&&(this._startStyles&&ph(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(ph(this._element,this._initialStyles),this._endStyles&&(ph(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(T_(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(T_(this._element,this._endStyles),this._endStyles=null),ph(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function ZA(e){let t=null;return e.forEach((r,n)=>{(function XW(e){return"display"===e||"position"===e})(n)&&(t=t||new Map,t.set(n,r))}),t}class q3{constructor(t,r,n,s){this.element=t,this.keyframes=r,this.options=n,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const r=[];return t.forEach(n=>{r.push(Object.fromEntries(n))}),r}_triggerWebAnimation(t,r,n){return t.animate(this._convertKeyframesToObject(r),n)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,s)=>{"offset"!==s&&t.set(s,this._finished?n:k3(this.element,s))}),this.currentSnapshot=t}triggerCallback(t){const r="start"===t?this._onStartFns:this._onDoneFns;r.forEach(n=>n()),r.length=0}}class KW{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,r){return!1}containsElement(t,r){return C3(t,r)}getParentElement(t){return IA(t)}query(t,r,n){return E3(t,r,n)}computeStyle(t,r,n){return window.getComputedStyle(t)[r]}animate(t,r,n,s,u,m=[]){const T={duration:n,delay:s,fill:0==s?"both":"forwards"};u&&(T.easing=u);const R=new Map,z=m.filter(he=>he instanceof q3);(function rW(e,t){return 0===e||0===t})(n,s)&&z.forEach(he=>{he.currentSnapshot.forEach((Me,Ve)=>R.set(Ve,Me))});let W=function tW(e){return e.length?e[0]instanceof Map?e:e.map(t=>M3(t)):[]}(r).map(he=>Dm(he));W=function oW(e,t,r){if(r.size&&t.length){let n=t[0],s=[];if(r.forEach((u,m)=>{n.has(m)||s.push(m),n.set(m,u)}),s.length)for(let u=1;u<t.length;u++){let m=t[u];s.forEach(b=>m.set(b,k3(e,b)))}}return t}(t,W,R);const le=function ZW(e,t){let r=null,n=null;return Array.isArray(t)&&t.length?(r=ZA(t[0]),t.length>1&&(n=ZA(t[t.length-1]))):t instanceof Map&&(r=ZA(t)),r||n?new YW(e,r,n):null}(t,W);return new q3(t,W,T,le)}}let QW=(()=>{var e;class t extends SO{constructor(n,s){super(),this._nextAnimationId=0,this._renderer=n.createRenderer(s.body,{id:"0",encapsulation:ws.None,styles:[],data:{animation:[]}})}build(n){const s=this._nextAnimationId.toString();this._nextAnimationId++;const u=Array.isArray(n)?MO(n):n;return W3(this._renderer,null,s,"register",[u]),new JW(s,this._renderer)}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Rg),ze(Gi))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})();class JW extends JU{constructor(t,r){super(),this._id=t,this._renderer=r}create(t,r){return new eZ(this._id,t,r||{},this._renderer)}}class eZ{constructor(t,r,n,s){this.id=t,this.element=r,this._renderer=s,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(t,r){return this._renderer.listen(this.element,`@@${this.id}:${t}`,r)}_command(t,...r){return W3(this._renderer,this.element,this.id,t,r)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function W3(e,t,r,n,s){return e.setProperty(t,`@@${r}:${n}`,s)}const Z3="@.disabled";let tZ=(()=>{var e;class t{constructor(n,s,u){this.delegate=n,this.engine=s,this._zone=u,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,s.onRemovalComplete=(m,b)=>{const T=b?.parentNode(m);T&&b.removeChild(T,m)}}createRenderer(n,s){const m=this.delegate.createRenderer(n,s);if(!(n&&s&&s.data&&s.data.animation)){let W=this._rendererCache.get(m);return W||(W=new Y3("",m,this.engine,()=>this._rendererCache.delete(m)),this._rendererCache.set(m,W)),W}const b=s.id,T=s.id+"-"+this._currentId;this._currentId++,this.engine.register(T,n);const R=W=>{Array.isArray(W)?W.forEach(R):this.engine.registerTrigger(b,T,n,W.name,W)};return s.data.animation.forEach(R),new nZ(this,T,m,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(n,s,u){n>=0&&n<this._microtaskId?this._zone.run(()=>s(u)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(m=>{const[b,T]=m;b(T)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([s,u]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Rg),ze(AD),ze(si))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})();class Y3{constructor(t,r,n,s){this.namespaceId=t,this.delegate=r,this.engine=n,this._onDestroy=s}get data(){return this.delegate.data}destroyNode(t){this.delegate.destroyNode?.(t)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(t,r){return this.delegate.createElement(t,r)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,r){this.delegate.appendChild(t,r),this.engine.onInsert(this.namespaceId,r,t,!1)}insertBefore(t,r,n,s=!0){this.delegate.insertBefore(t,r,n),this.engine.onInsert(this.namespaceId,r,t,s)}removeChild(t,r,n){this.engine.onRemove(this.namespaceId,r,this.delegate)}selectRootElement(t,r){return this.delegate.selectRootElement(t,r)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,r,n,s){this.delegate.setAttribute(t,r,n,s)}removeAttribute(t,r,n){this.delegate.removeAttribute(t,r,n)}addClass(t,r){this.delegate.addClass(t,r)}removeClass(t,r){this.delegate.removeClass(t,r)}setStyle(t,r,n,s){this.delegate.setStyle(t,r,n,s)}removeStyle(t,r,n){this.delegate.removeStyle(t,r,n)}setProperty(t,r,n){"@"==r.charAt(0)&&r==Z3?this.disableAnimations(t,!!n):this.delegate.setProperty(t,r,n)}setValue(t,r){this.delegate.setValue(t,r)}listen(t,r,n){return this.delegate.listen(t,r,n)}disableAnimations(t,r){this.engine.disableAnimations(t,r)}}class nZ extends Y3{constructor(t,r,n,s,u){super(r,n,s,u),this.factory=t,this.namespaceId=r}setProperty(t,r,n){"@"==r.charAt(0)?"."==r.charAt(1)&&r==Z3?this.disableAnimations(t,n=void 0===n||!!n):this.engine.process(this.namespaceId,t,r.slice(1),n):this.delegate.setProperty(t,r,n)}listen(t,r,n){if("@"==r.charAt(0)){const s=function iZ(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(t);let u=r.slice(1),m="";return"@"!=u.charAt(0)&&([u,m]=function rZ(e){const t=e.indexOf(".");return[e.substring(0,t),e.slice(t+1)]}(u)),this.engine.listen(this.namespaceId,s,u,m,b=>{this.factory.scheduleListenerCallback(b._data||-1,n,b)})}return this.delegate.listen(t,r,n)}}const X3=[{provide:SO,useClass:QW},{provide:UA,useFactory:function sZ(){return new DW}},{provide:AD,useClass:(()=>{var e;class t extends AD{constructor(n,s,u,m){super(n.body,s,u)}ngOnDestroy(){this.flush()}}return(e=t).\u0275fac=function(n){return new(n||e)(ze(Gi),ze(kA),ze(UA),ze(ch))},e.\u0275prov=Ut({token:e,factory:e.\u0275fac}),t})()},{provide:Rg,useFactory:function aZ(e,t,r){return new tZ(e,t,r)},deps:[TM,AD,si]}],YA=[{provide:kA,useFactory:()=>new KW},{provide:oa,useValue:"BrowserAnimations"},...X3],K3=[{provide:kA,useClass:D3},{provide:oa,useValue:"NoopAnimations"},...X3];let lZ=(()=>{var e;class t{static withConfig(n){return{ngModule:t,providers:n.disableAnimations?K3:YA}}}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({providers:YA,imports:[AM]}),t})(),eN=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({}),t})(),xZ=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e}),e.\u0275inj=Oi({imports:[ad,cF,eN,ad,eN]}),t})();class wZ{constructor(t,r="/assets/i18n/",n=".json"){xt(this,"http",void 0),xt(this,"prefix",void 0),xt(this,"suffix",void 0),this.http=t,this.prefix=r,this.suffix=n}getTranslation(t){return this.http.get(`${this.prefix}${t}${this.suffix}`)}}let CZ=(()=>{var e;class t{}return(e=t).\u0275fac=function(n){return new(n||e)},e.\u0275mod=Ji({type:e,bootstrap:[fq]}),e.\u0275inj=Oi({imports:[AM,C7,hv,EO,cq,B7,xZ,PF,bG.forRoot({}),c8.forRoot(),U9,lZ,AM,pH,EO,U7.forRoot({loader:{provide:s1,useFactory:EZ,deps:[od]}})]}),t})();function EZ(e){return new wZ(e)}NV().bootstrapModule(CZ).catch(e=>console.error(e))},391:function(bn,fn,Je){var ht;bn=Je.nmd(bn),function(gt){"object"==typeof global&&global;var Xe=function(en){this.message=en};(Xe.prototype=new Error).name="InvalidCharacterError";var Oe=function(en){throw new Xe(en)},tt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ye=/[\t\n\f\r ]/g,pn={encode:function(en){en=String(en),/[^\0-\xFF]/.test(en)&&Oe("The string to be encoded contains characters outside of the Latin1 range.");for(var qt,nt,Ge,Le,Yt=en.length%3,De="",ct=-1,Qt=en.length-Yt;++ct<Qt;)qt=en.charCodeAt(ct)<<16,nt=en.charCodeAt(++ct)<<8,Ge=en.charCodeAt(++ct),De+=tt.charAt((Le=qt+nt+Ge)>>18&63)+tt.charAt(Le>>12&63)+tt.charAt(Le>>6&63)+tt.charAt(63&Le);return 2==Yt?(qt=en.charCodeAt(ct)<<8,nt=en.charCodeAt(++ct),De+=tt.charAt((Le=qt+nt)>>10)+tt.charAt(Le>>4&63)+tt.charAt(Le<<2&63)+"="):1==Yt&&(Le=en.charCodeAt(ct),De+=tt.charAt(Le>>2)+tt.charAt(Le<<4&63)+"=="),De},decode:function(en){var Yt=(en=String(en).replace(Ye,"")).length;Yt%4==0&&(Yt=(en=en.replace(/==?$/,"")).length),(Yt%4==1||/[^+a-zA-Z0-9/]/.test(en))&&Oe("Invalid character: the string to be decoded is not correctly encoded.");for(var ct,qt,De=0,nt="",Ge=-1;++Ge<Yt;)qt=tt.indexOf(en.charAt(Ge)),ct=De%4?64*ct+qt:qt,De++%4&&(nt+=String.fromCharCode(255&ct>>(-2*De&6)));return nt},version:"0.1.0"};void 0!==(ht=function(){return pn}.call(fn,Je,fn,bn))&&(bn.exports=ht)}()},16:bn=>{"use strict";var ht,fn="object"==typeof Reflect?Reflect:null,Je=fn&&"function"==typeof fn.apply?fn.apply:function(Ge,Ct,Le){return Function.prototype.apply.call(Ge,Ct,Le)};ht=fn&&"function"==typeof fn.ownKeys?fn.ownKeys:Object.getOwnPropertySymbols?function(Ge){return Object.getOwnPropertyNames(Ge).concat(Object.getOwnPropertySymbols(Ge))}:function(Ge){return Object.getOwnPropertyNames(Ge)};var We=Number.isNaN||function(Ge){return Ge!=Ge};function h(){h.init.call(this)}bn.exports=h,bn.exports.once=function De(nt,Ge){return new Promise(function(Ct,Le){function Qt(Et){nt.removeListener(Ge,xn),Le(Et)}function xn(){"function"==typeof nt.removeListener&&nt.removeListener("error",Qt),Ct([].slice.call(arguments))}qt(nt,Ge,xn,{once:!0}),"error"!==Ge&&function ct(nt,Ge,Ct){"function"==typeof nt.on&&qt(nt,"error",Ge,Ct)}(nt,Qt,{once:!0})})},h.EventEmitter=h,h.prototype._events=void 0,h.prototype._eventsCount=0,h.prototype._maxListeners=void 0;var me=10;function Xe(nt){if("function"!=typeof nt)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof nt)}function Oe(nt){return void 0===nt._maxListeners?h.defaultMaxListeners:nt._maxListeners}function tt(nt,Ge,Ct,Le){var Qt,xn,Et;if(Xe(Ct),void 0===(xn=nt._events)?(xn=nt._events=Object.create(null),nt._eventsCount=0):(void 0!==xn.newListener&&(nt.emit("newListener",Ge,Ct.listener?Ct.listener:Ct),xn=nt._events),Et=xn[Ge]),void 0===Et)Et=xn[Ge]=Ct,++nt._eventsCount;else if("function"==typeof Et?Et=xn[Ge]=Le?[Ct,Et]:[Et,Ct]:Le?Et.unshift(Ct):Et.push(Ct),(Qt=Oe(nt))>0&&Et.length>Qt&&!Et.warned){Et.warned=!0;var Si=new Error("Possible EventEmitter memory leak detected. "+Et.length+" "+String(Ge)+" listeners added. Use emitter.setMaxListeners() to increase limit");Si.name="MaxListenersExceededWarning",Si.emitter=nt,Si.type=Ge,Si.count=Et.length,function gt(nt){console&&console.warn&&console.warn(nt)}(Si)}return nt}function Ye(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Vt(nt,Ge,Ct){var Le={fired:!1,wrapFn:void 0,target:nt,type:Ge,listener:Ct},Qt=Ye.bind(Le);return Qt.listener=Ct,Le.wrapFn=Qt,Qt}function Fn(nt,Ge,Ct){var Le=nt._events;if(void 0===Le)return[];var Qt=Le[Ge];return void 0===Qt?[]:"function"==typeof Qt?Ct?[Qt.listener||Qt]:[Qt]:Ct?function Yt(nt){for(var Ge=new Array(nt.length),Ct=0;Ct<Ge.length;++Ct)Ge[Ct]=nt[Ct].listener||nt[Ct];return Ge}(Qt):vn(Qt,Qt.length)}function pn(nt){var Ge=this._events;if(void 0!==Ge){var Ct=Ge[nt];if("function"==typeof Ct)return 1;if(void 0!==Ct)return Ct.length}return 0}function vn(nt,Ge){for(var Ct=new Array(Ge),Le=0;Le<Ge;++Le)Ct[Le]=nt[Le];return Ct}function qt(nt,Ge,Ct,Le){if("function"==typeof nt.on)Le.once?nt.once(Ge,Ct):nt.on(Ge,Ct);else{if("function"!=typeof nt.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof nt);nt.addEventListener(Ge,function Qt(xn){Le.once&&nt.removeEventListener(Ge,Qt),Ct(xn)})}}Object.defineProperty(h,"defaultMaxListeners",{enumerable:!0,get:function(){return me},set:function(nt){if("number"!=typeof nt||nt<0||We(nt))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+nt+".");me=nt}}),h.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},h.prototype.setMaxListeners=function(Ge){if("number"!=typeof Ge||Ge<0||We(Ge))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+Ge+".");return this._maxListeners=Ge,this},h.prototype.getMaxListeners=function(){return Oe(this)},h.prototype.emit=function(Ge){for(var Ct=[],Le=1;Le<arguments.length;Le++)Ct.push(arguments[Le]);var Qt="error"===Ge,xn=this._events;if(void 0!==xn)Qt=Qt&&void 0===xn.error;else if(!Qt)return!1;if(Qt){var Et;if(Ct.length>0&&(Et=Ct[0]),Et instanceof Error)throw Et;var Si=new Error("Unhandled error."+(Et?" ("+Et.message+")":""));throw Si.context=Et,Si}var mr=xn[Ge];if(void 0===mr)return!1;if("function"==typeof mr)Je(mr,this,Ct);else{var To=mr.length,Uo=vn(mr,To);for(Le=0;Le<To;++Le)Je(Uo[Le],this,Ct)}return!0},h.prototype.on=h.prototype.addListener=function(Ge,Ct){return tt(this,Ge,Ct,!1)},h.prototype.prependListener=function(Ge,Ct){return tt(this,Ge,Ct,!0)},h.prototype.once=function(Ge,Ct){return Xe(Ct),this.on(Ge,Vt(this,Ge,Ct)),this},h.prototype.prependOnceListener=function(Ge,Ct){return Xe(Ct),this.prependListener(Ge,Vt(this,Ge,Ct)),this},h.prototype.off=h.prototype.removeListener=function(Ge,Ct){var Le,Qt,xn,Et,Si;if(Xe(Ct),void 0===(Qt=this._events))return this;if(void 0===(Le=Qt[Ge]))return this;if(Le===Ct||Le.listener===Ct)0==--this._eventsCount?this._events=Object.create(null):(delete Qt[Ge],Qt.removeListener&&this.emit("removeListener",Ge,Le.listener||Ct));else if("function"!=typeof Le){for(xn=-1,Et=Le.length-1;Et>=0;Et--)if(Le[Et]===Ct||Le[Et].listener===Ct){Si=Le[Et].listener,xn=Et;break}if(xn<0)return this;0===xn?Le.shift():function en(nt,Ge){for(;Ge+1<nt.length;Ge++)nt[Ge]=nt[Ge+1];nt.pop()}(Le,xn),1===Le.length&&(Qt[Ge]=Le[0]),void 0!==Qt.removeListener&&this.emit("removeListener",Ge,Si||Ct)}return this},h.prototype.removeAllListeners=function(Ge){var Ct,Le,Qt;if(void 0===(Le=this._events))return this;if(void 0===Le.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==Le[Ge]&&(0==--this._eventsCount?this._events=Object.create(null):delete Le[Ge]),this;if(0===arguments.length){var Et,xn=Object.keys(Le);for(Qt=0;Qt<xn.length;++Qt)"removeListener"!==(Et=xn[Qt])&&this.removeAllListeners(Et);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(Ct=Le[Ge]))this.removeListener(Ge,Ct);else if(void 0!==Ct)for(Qt=Ct.length-1;Qt>=0;Qt--)this.removeListener(Ge,Ct[Qt]);return this},h.prototype.listeners=function(Ge){return Fn(this,Ge,!0)},h.prototype.rawListeners=function(Ge){return Fn(this,Ge,!1)},h.listenerCount=function(nt,Ge){return"function"==typeof nt.listenerCount?nt.listenerCount(Ge):pn.call(nt,Ge)},h.prototype.listenerCount=pn,h.prototype.eventNames=function(){return this._eventsCount>0?ht(this._events):[]}},424:bn=>{var Je;bn.exports=Je={},Je.simpleFilter=function(ht,gt){return gt.filter(function(We){return Je.test(ht,We)})},Je.test=function(ht,gt){return null!==Je.match(ht,gt)},Je.match=function(ht,gt,We){var pn,h=0,me=[],Xe=gt.length,Oe=0,tt=0,Ye=(We=We||{}).pre||"",Vt=We.post||"",Fn=We.caseSensitive&&gt||gt.toLowerCase();ht=We.caseSensitive&&ht||ht.toLowerCase();for(var vn=0;vn<Xe;vn++)pn=gt[vn],Fn[vn]===ht[h]?(pn=Ye+pn+Vt,h+=1,tt+=1+tt):tt=0,Oe+=tt,me[me.length]=pn;return h===ht.length?(Oe=Fn===ht?1/0:Oe,{rendered:me.join(""),score:Oe}):null},Je.filter=function(ht,gt,We){return gt&&0!==gt.length?"string"!=typeof ht?gt:(We=We||{},gt.reduce(function(h,me,Xe,Oe){var tt=me;We.extract&&(tt=We.extract(me));var Ye=Je.match(ht,tt,We);return null!=Ye&&(h[h.length]={string:Ye.rendered,score:Ye.score,index:Xe,original:me}),h},[]).sort(function(h,me){return me.score-h.score||h.index-me.index})):[]}},220:bn=>{var gt=/^\s+|\s+$/g,We=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,me=/^0o[0-7]+$/i,Xe=parseInt,Oe="object"==typeof global&&global&&global.Object===Object&&global,tt="object"==typeof self&&self&&self.Object===Object&&self,Ye=Oe||tt||Function("return this")(),Fn=Object.prototype.toString,pn=Math.max,vn=Math.min,en=function(){return Ye.Date.now()};function De(Ge){var Ct=typeof Ge;return!!Ge&&("object"==Ct||"function"==Ct)}function nt(Ge){if("number"==typeof Ge)return Ge;if(function qt(Ge){return"symbol"==typeof Ge||function ct(Ge){return!!Ge&&"object"==typeof Ge}(Ge)&&"[object Symbol]"==Fn.call(Ge)}(Ge))return NaN;if(De(Ge)){var Ct="function"==typeof Ge.valueOf?Ge.valueOf():Ge;Ge=De(Ct)?Ct+"":Ct}if("string"!=typeof Ge)return 0===Ge?Ge:+Ge;Ge=Ge.replace(gt,"");var Le=h.test(Ge);return Le||me.test(Ge)?Xe(Ge.slice(2),Le?2:8):We.test(Ge)?NaN:+Ge}bn.exports=function Yt(Ge,Ct,Le){var Qt,xn,Et,Si,mr,To,Uo=0,ts=!1,Hn=!1,Is=!0;if("function"!=typeof Ge)throw new TypeError("Expected a function");function wn(ai){var gr=Qt,ii=xn;return Qt=xn=void 0,Uo=ai,Si=Ge.apply(ii,gr)}function Gr(ai){var gr=ai-To;return void 0===To||gr>=Ct||gr<0||Hn&&ai-Uo>=Et}function ja(){var ai=en();if(Gr(ai))return qe(ai);mr=setTimeout(ja,function Va(ai){var da=Ct-(ai-To);return Hn?vn(da,Et-(ai-Uo)):da}(ai))}function qe(ai){return mr=void 0,Is&&Qt?wn(ai):(Qt=xn=void 0,Si)}function ur(){var ai=en(),gr=Gr(ai);if(Qt=arguments,xn=this,To=ai,gr){if(void 0===mr)return function Ho(ai){return Uo=ai,mr=setTimeout(ja,Ct),ts?wn(ai):Si}(To);if(Hn)return mr=setTimeout(ja,Ct),wn(To)}return void 0===mr&&(mr=setTimeout(ja,Ct)),Si}return Ct=nt(Ct)||0,De(Le)&&(ts=!!Le.leading,Et=(Hn="maxWait"in Le)?pn(nt(Le.maxWait)||0,Ct):Et,Is="trailing"in Le?!!Le.trailing:Is),ur.cancel=function ua(){void 0!==mr&&clearTimeout(mr),Uo=0,Qt=To=xn=mr=void 0},ur.flush=function ys(){return void 0===mr?Si:qe(en())},ur}},574:function(bn){bn.exports=function(){"use strict";var fn,Je,ht;function gt(h,me){if(fn)if(Je){var Xe="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+fn+")(sharedChunk); ("+Je+")(sharedChunk); self.onerror = null;",Oe={};fn(Oe),ht=me(Oe),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(ht.workerUrl=window.URL.createObjectURL(new Blob([Xe],{type:"text/javascript"})))}else Je=me;else fn=me}return gt(0,function(h){var me="3.2.0";let Xe;const Oe={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==Xe){const o=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Xe=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):o}catch{Xe=o}}return Xe},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Oe.API_URL)return null;try{const o=new URL(Oe.API_URL);return"api.mapbox.cn"===o.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===o.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},tt={supported:!1,testSupport:function(o){!Fn&&Vt&&(pn?en(o):Ye=o)}};let Ye,Vt,Fn=!1,pn=!1;const vn=typeof self<"u"?self:{};function en(o){const i=o.createTexture();o.bindTexture(o.TEXTURE_2D,i);try{if(o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,Vt),o.isContextLost())return;tt.supported=!0}catch{}o.deleteTexture(i),Fn=!0}vn.document&&(Vt=vn.document.createElement("img"),Vt.onload=function(){Ye&&en(Ye),Ye=null,pn=!0},Vt.onerror=function(){Fn=!0,Ye=null},Vt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Yt="01";function De(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var ct=qt;function qt(o,i,a,l){this.cx=3*o,this.bx=3*(a-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(l-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=i,this.p2x=a,this.p2y=l}qt.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,i){if(void 0===i&&(i=1e-6),o<0)return 0;if(o>1)return 1;for(var a=o,l=0;l<8;l++){var d=this.sampleCurveX(a)-o;if(Math.abs(d)<i)return a;var p=this.sampleCurveDerivativeX(a);if(Math.abs(p)<1e-6)break;a-=d/p}var g=0,y=1;for(a=o,l=0;l<20&&(d=this.sampleCurveX(a),!(Math.abs(d-o)<i));l++)o>d?g=a:y=a,a=.5*(y-g)+g;return a},solve:function(o,i){return this.sampleCurveY(this.solveCurveX(o,i))}};var nt=De(ct),Ge=Ct;function Ct(o,i){this.x=o,this.y=i}Ct.prototype={clone:function(){return new Ct(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,i){return this.clone()._rotateAround(o,i)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var i=o.x-this.x,a=o.y-this.y;return i*i+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,i){return Math.atan2(this.x*i-this.y*o,this.x*o+this.y*i)},_matMult:function(o){var i=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=i,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var i=Math.cos(o),a=Math.sin(o),l=a*this.x+i*this.y;return this.x=i*this.x-a*this.y,this.y=l,this},_rotateAround:function(o,i){var a=Math.cos(o),l=Math.sin(o),d=i.y+l*(this.x-i.x)+a*(this.y-i.y);return this.x=i.x+a*(this.x-i.x)-l*(this.y-i.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ct.convert=function(o){return o instanceof Ct?o:Array.isArray(o)?new Ct(o[0],o[1]):o};var Le=De(Ge);const Qt=Math.PI/180,xn=180/Math.PI;function Et(o){return o*Qt}function Si(o){return o*xn}const mr=[[0,0],[1,0],[1,1],[0,1]];function To(o){if(o<=0)return 0;if(o>=1)return 1;const i=o*o,a=i*o;return 4*(o<.5?a:3*(o-i)+a-.75)}function Uo(o,i,a,l){const d=new nt(o,i,a,l);return function(p){return d.solve(p)}}const ts=Uo(.25,.1,.25,1);function Hn(o,i,a){return Math.min(a,Math.max(i,o))}function Is(o,i,a){return(a=Hn((a-o)/(i-o),0,1))*a*(3-2*a)}function wn(o,i,a){const l=a-i,d=((o-i)%l+l)%l+i;return d===i?a:d}function Ho(o,i,a){if(!o.length)return a(null,[]);let l=o.length;const d=new Array(o.length);let p=null;o.forEach((g,y)=>{i(g,(x,C)=>{x&&(p=x),d[y]=C,0==--l&&a(p,d)})})}function Va(o){const i=[];for(const a in o)i.push(o[a]);return i}function Gr(o,...i){for(const a of i)for(const l in a)o[l]=a[l];return o}let ja=1;function qe(){return ja++}function ua(){return function o(i){return i?(i^Math.random()*(16>>i/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,o)}()}function ys(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))}function ur(o){return!!o&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(o)}function ai(o,i){o.forEach(a=>{i[a]&&(i[a]=i[a].bind(i))})}function gr(o,i){return-1!==o.indexOf(i,o.length-i.length)}function ii(o,i,a){const l={};for(const d in o)l[d]=i.call(a||this,o[d],d,o);return l}function da(o,i,a){const l={};for(const d in o)i.call(a||this,o[d],d,o)&&(l[d]=o[d]);return l}function qs(o){return Array.isArray(o)?o.map(qs):"object"==typeof o&&o?ii(o,qs):o}const Pc={};function ar(o){Pc[o]||(typeof console<"u"&&console.warn(o),Pc[o]=!0)}function Ot(o,i,a){return(a.y-o.y)*(i.x-o.x)>(i.y-o.y)*(a.x-o.x)}function ge(o){let i=0;for(let a,l,d=0,p=o.length,g=p-1;d<p;g=d++)a=o[d],l=o[g],i+=(l.x-a.x)*(a.y+l.y);return i}function ve([o,i,a]){const l=Et(i+90),d=Et(a);return{x:o*Math.cos(l)*Math.sin(d),y:o*Math.sin(l)*Math.sin(d),z:o*Math.cos(d),azimuthal:i,polar:a}}function Re(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function St(o){const i={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,l,d,p)=>{const g=d||p;return i[l]=!g||g.toLowerCase(),""}),i["max-age"]){const a=parseInt(i["max-age"],10);isNaN(a)?delete i["max-age"]:i["max-age"]=a}return i}let bt=null;function Lt(o){try{const i=self[o];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch{return!1}}function cn(o,i){return[o[4*i],o[4*i+1],o[4*i+2],o[4*i+3]]}function kt(o,i,a,l){for(;i<a;){const d=i+a>>1;o[d]<l?i=d+1:a=d}return i}function En(o,i,a,l){for(;i<a;){const d=i+a>>1;o[d]<=l?i=d+1:a=d}return i}const zn="mapbox-tiles";let or,lr,Vn=500,$i=50;function Yi(){try{return caches}catch{}}function Mi(){const o=Yi();o&&!or&&(or=o.open(zn))}function Xi(o){const i=o.indexOf("?");if(i<0)return o;const l=function(d){const p=d.indexOf("?");return p>0?d.slice(p+1).split("&"):[]}(o).filter(d=>{const p=d.split("=");return"language"===p[0]||"worldview"===p[0]});return l.length?`${o.slice(0,i)}?${l.join("&")}`:o.slice(0,i)}let zr=1/0;const qr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};"function"==typeof Object.freeze&&Object.freeze(qr);class vs extends Error{constructor(i,a,l){401===a&&Mt(l)&&(i+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(i),this.status=a,this.url=l}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const So=Re()?()=>self.worker&&self.worker.referrer:()=>("blob:"===location.protocol?parent:self).location.href,Ws=function(o,i){if(!(/^file:/.test(a=o.url)||/^file:/.test(So())&&!/^\w+:/.test(a))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(l,d){const p=new AbortController,g=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:So(),referrerPolicy:l.referrerPolicy,signal:p.signal});let y=!1,x=!1;const C=(D=g.url).indexOf("sku=")>0&&Mt(D);var D;"json"===l.type&&g.headers.set("Accept","application/json");const M=(P,F,B)=>{if(x)return;if(P&&"SecurityError"!==P.message&&ar(P.toString()),F&&B)return k(F);const j=Date.now();fetch(g).then(q=>{if(q.ok){const te=C?q.clone():null;return k(q,te,j)}return d(new vs(q.statusText,q.status,l.url))}).catch(q=>{"AbortError"!==q.name&&d(new Error(`${q.message} ${l.url}`))})},k=(P,F,B)=>{("arrayBuffer"===l.type?P.arrayBuffer():"json"===l.type?P.json():P.text()).then(j=>{x||(F&&B&&function(q,te,ie){if(Mi(),!or)return;const se={status:te.status,statusText:te.statusText,headers:new Headers};te.headers.forEach((Ee,Ie)=>se.headers.set(Ie,Ee));const de=St(te.headers.get("Cache-Control")||"");if(de["no-store"])return;de["max-age"]&&se.headers.set("Expires",new Date(ie+1e3*de["max-age"]).toUTCString());const pe=se.headers.get("Expires");pe&&(new Date(pe).getTime()-ie<42e4||function(Ee,Ie){if(void 0===lr)try{new Response(new ReadableStream),lr=!0}catch{lr=!1}lr?Ie(Ee.body):Ee.blob().then(Ie)}(te,Ee=>{const Ie=new Response(Ee,se);Mi(),or&&or.then(Pe=>Pe.put(Xi(q.url),Ie)).catch(Pe=>ar(Pe.message))}))}(g,F,B),y=!0,d(null,j,P.headers.get("Cache-Control"),P.headers.get("Expires")))}).catch(j=>{x||d(new Error(j.message))})};return C?function(P,F){if(Mi(),!or)return F(null);const B=Xi(P.url);or.then(j=>{j.match(B).then(q=>{const te=function(ie){if(!ie)return!1;const se=new Date(ie.headers.get("Expires")||0),de=St(ie.headers.get("Cache-Control")||"");return se>Date.now()&&!de["no-cache"]}(q);j.delete(B),te&&j.put(B,q.clone()),F(null,q,te)}).catch(F)}).catch(F)}(g,M):M(null,null),{cancel:()=>{x=!0,y||p.abort()}}}(o,i);if(Re()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",o,i,void 0,!0)}var a;return function(l,d){const p=new XMLHttpRequest;p.open(l.method||"GET",l.url,!0),"arrayBuffer"===l.type&&(p.responseType="arraybuffer");for(const g in l.headers)p.setRequestHeader(g,l.headers[g]);return"json"===l.type&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials="include"===l.credentials,p.onerror=()=>{d(new Error(p.statusText))},p.onload=()=>{if((p.status>=200&&p.status<300||0===p.status)&&null!==p.response){let g=p.response;if("json"===l.type)try{g=JSON.parse(p.response)}catch(y){return d(y)}d(null,g,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else d(new vs(p.statusText,p.status,l.url))},p.send(l.body),{cancel:()=>p.abort()}}(o,i)},Mo=function(o,i){return Ws(Gr(o,{type:"arrayBuffer"}),i)};function Zs(o){const i=document.createElement("a");return i.href=o,i.protocol===location.protocol&&i.host===location.host}const ha="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let co,ut;co=[],ut=0;const rt=function(o,i){if(tt.supported&&(o.headers||(o.headers={}),o.headers.accept="image/webp,*/*"),ut>=Oe.MAX_PARALLEL_IMAGE_REQUESTS){const p={requestParameters:o,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return co.push(p),p}ut++;let a=!1;const l=()=>{if(!a)for(a=!0,ut--;co.length&&ut<Oe.MAX_PARALLEL_IMAGE_REQUESTS;){const p=co.shift(),{requestParameters:g,callback:y,cancelled:x}=p;x||(p.cancel=rt(g,y).cancel)}},d=Mo(o,(p,g,y,x)=>{l(),p?i(p):g&&(self.createImageBitmap?function(C,D){const M=new Blob([new Uint8Array(C)],{type:"image/png"});createImageBitmap(M).then(k=>{D(null,k)}).catch(k=>{D(new Error(`Could not load image because of ${k.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(g,(C,D)=>i(C,D,y,x)):function(C,D){const M=new Image;M.onload=()=>{D(null,M),URL.revokeObjectURL(M.src),M.onload=null,requestAnimationFrame(()=>{M.src=ha})},M.onerror=()=>D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const k=new Blob([new Uint8Array(C)],{type:"image/png"});M.src=C.byteLength?URL.createObjectURL(k):ha}(g,(C,D)=>i(C,D,y,x)))});return{cancel:()=>{d.cancel(),l()}}},Dt="NO_ACCESS_TOKEN";function Nt(o){return 0===o.indexOf("mapbox:")}function Mt(o){return Oe.API_URL_REGEX.test(o)}function Wt(o){return Oe.API_CDN_URL_REGEX.test(o)}function Zt(o){return Oe.API_STYLE_REGEX.test(o)&&!jt(o)}function jt(o){return Oe.API_SPRITE_REGEX.test(o)}const Ft=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Rt(o){const i=o.match(Ft);if(!i)throw new Error("Unable to parse URL object");return{protocol:i[1],authority:i[2],path:i[3]||"/",params:i[4]?i[4].split("&"):[]}}function Un(o){const i=o.params.length?`?${o.params.join("&")}`:"";return`${o.protocol}://${o.authority}${o.path}${i}`}const xi="mapbox.eventData";function tn(o){if(!o)return null;const i=o.split(".");if(!i||3!==i.length)return null;try{return JSON.parse(decodeURIComponent(atob(i[1]).split("").map(a=>"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class ni{constructor(i){this.type=i,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(i){const a=tn(Oe.ACCESS_TOKEN);let l="";return l=a&&a.u?btoa(encodeURIComponent(a.u).replace(/%([0-9A-F]{2})/g,(d,p)=>String.fromCharCode(+("0x"+p)))):Oe.ACCESS_TOKEN||"",i?`${xi}.${i}:${l}`:`${xi}:${l}`}fetchEventData(){const i=Lt("localStorage"),a=this.getStorageKey(),l=this.getStorageKey("uuid");if(i)try{const d=localStorage.getItem(a);d&&(this.eventData=JSON.parse(d));const p=localStorage.getItem(l);p&&(this.anonId=p)}catch{ar("Unable to read from LocalStorage")}}saveEventData(){const i=Lt("localStorage"),a=this.getStorageKey(),l=this.getStorageKey("uuid"),d=this.anonId;if(i&&d)try{localStorage.setItem(l,d),Object.keys(this.eventData).length>=1&&localStorage.setItem(a,JSON.stringify(this.eventData))}catch{ar("Unable to write to LocalStorage")}}processRequests(i){}postEvent(i,a,l,d){if(!Oe.EVENTS_URL)return;const p=Rt(Oe.EVENTS_URL);p.params.push(`access_token=${d||Oe.ACCESS_TOKEN||""}`);const g={event:this.type,created:new Date(i).toISOString()},y=a?Gr(g,a):g,x={url:Un(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([y])};var D;this.pendingRequest=(D=C=>{this.pendingRequest=null,l(C),this.saveEventData(),this.processRequests(d)},Ws(Gr(x,{method:"POST"}),D))}queueRequest(i,a){this.queue.push(i),this.processRequests(a)}}const Ai=new class extends ni{constructor(o){super("appUserTurnstile"),this._customAccessToken=o}postTurnstileEvent(o,i){Oe.EVENTS_URL&&Oe.ACCESS_TOKEN&&Array.isArray(o)&&o.some(a=>Nt(a)||Mt(a))&&this.queueRequest(Date.now(),i)}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const i=tn(Oe.ACCESS_TOKEN),a=i?i.u:Oe.ACCESS_TOKEN;let l=a!==this.eventData.tokenU;ur(this.anonId)||(this.anonId=ua(),l=!0);const d=this.queue.shift();if(this.eventData.lastSuccess){const p=new Date(this.eventData.lastSuccess),g=new Date(d),y=(d-this.eventData.lastSuccess)/864e5;l=l||y>=1||y<-1||p.getDate()!==g.getDate()}else l=!0;l?this.postEvent(d,{sdkIdentifier:"mapbox-gl-js",sdkVersion:me,skuId:Yt,"enabled.telemetry":!1,userId:this.anonId},p=>{p||(this.eventData.lastSuccess=d,this.eventData.tokenU=a)},o):this.processRequests()}},Ir=Ai.postTurnstileEvent.bind(Ai),xr=new class extends ni{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(o,i,a,l){this.skuToken=i,this.errorCb=l,Oe.EVENTS_URL&&(a||Oe.ACCESS_TOKEN?this.queueRequest({id:o,timestamp:Date.now()},a):this.errorCb(new Error(Dt)))}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;const{id:i,timestamp:a}=this.queue.shift();i&&this.success[i]||(this.anonId||this.fetchEventData(),ur(this.anonId)||(this.anonId=ua()),this.postEvent(a,{sdkIdentifier:"mapbox-gl-js",sdkVersion:me,skuId:Yt,skuToken:this.skuToken,userId:this.anonId},l=>{l?this.errorCb(l):i&&(this.success[i]=!0)},o))}},dr=xr.postMapLoadEvent.bind(xr),bs=new class extends ni{constructor(){super("gljs.performance")}postPerformanceEvent(o,i){Oe.EVENTS_URL&&(o||Oe.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:i},o)}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:i,performanceData:a}=this.queue.shift(),l=function(d){const p=performance.getEntriesByType("resource"),g=performance.getEntriesByType("mark"),y=function(P){const F={};if(P)for(const B in P)if("other"!==B)for(const j of P[B]){const q=`${B}ResolveRangeMin`,te=`${B}ResolveRangeMax`,ie=`${B}RequestCount`,se=`${B}RequestCachedCount`;F[q]=Math.min(F[q]||1/0,j.startTime),F[te]=Math.max(F[te]||-1/0,j.responseEnd);const de=pe=>{void 0===F[pe]&&(F[pe]=0),++F[pe]};void 0!==j.transferSize&&0===j.transferSize&&de(se),de(ie)}return F}(function(P,F){const B={};if(P)for(const j of P){const q=F(j);void 0===B[q]&&(B[q]=[]),B[q].push(j)}return B}(p,Wr)),x=window.devicePixelRatio,C=navigator.connection||navigator.mozConnection||navigator.webkitConnection,D=C?C.effectiveType:void 0,M={counters:[],metadata:[],attributes:[]},k=(P,F,B)=>{null!=B&&P.push({name:F,value:B.toString()})};for(const P in y)k(M.counters,P,y[P]);if(d.interactionRange[0]!==1/0&&d.interactionRange[1]!==-1/0&&(k(M.counters,"interactionRangeMin",d.interactionRange[0]),k(M.counters,"interactionRangeMax",d.interactionRange[1])),g)for(const P of Object.keys(fa)){const F=fa[P],B=g.find(j=>j.name===F);B&&k(M.counters,F,B.startTime)}return k(M.counters,"visibilityHidden",d.visibilityHidden),k(M.attributes,"style",function(P){if(P)for(const F of P){const B=F.name.split("?")[0];if(Zt(B)){const j=B.split("/").slice(-2);if(2===j.length)return`mapbox://styles/${j[0]}/${j[1]}`}}}(p)),k(M.attributes,"terrainEnabled",d.terrainEnabled?"true":"false"),k(M.attributes,"fogEnabled",d.fogEnabled?"true":"false"),k(M.attributes,"projection",d.projection),k(M.attributes,"zoom",d.zoom),k(M.metadata,"devicePixelRatio",x),k(M.metadata,"connectionEffectiveType",D),k(M.metadata,"navigatorUserAgent",navigator.userAgent),k(M.metadata,"screenWidth",window.screen.width),k(M.metadata,"screenHeight",window.screen.height),k(M.metadata,"windowWidth",window.innerWidth),k(M.metadata,"windowHeight",window.innerHeight),k(M.metadata,"mapWidth",d.width/x),k(M.metadata,"mapHeight",d.height/x),k(M.metadata,"webglRenderer",d.renderer),k(M.metadata,"webglVendor",d.vendor),k(M.metadata,"sdkVersion",me),k(M.metadata,"sdkIdentifier","mapbox-gl-js"),M}(a);for(const d of l.metadata);for(const d of l.counters);for(const d of l.attributes);this.postEvent(i,l,()=>{},o)}},ls=bs.postPerformanceEvent.bind(bs),cs=new class extends ni{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(o,i,a,l){if(!Oe.API_URL||!Oe.SESSION_PATH)return;const d=Rt(Oe.API_URL+Oe.SESSION_PATH);d.params.push(`sku=${i||""}`),d.params.push(`access_token=${l||Oe.ACCESS_TOKEN||""}`);const p={url:Un(d),headers:{"Content-Type":"text/plain"}};var y;this.pendingRequest=(y=g=>{this.pendingRequest=null,a(g),this.saveEventData(),this.processRequests(l)},Ws(Gr(p,{method:"GET"}),y))}getSessionAPI(o,i,a,l){this.skuToken=i,this.errorCb=l,Oe.SESSION_PATH&&Oe.API_URL&&(a||Oe.ACCESS_TOKEN?this.queueRequest({id:o,timestamp:Date.now()},a):this.errorCb(new Error(Dt)))}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;const{id:i,timestamp:a}=this.queue.shift();i&&this.success[i]||this.getSession(a,this.skuToken,l=>{l?this.errorCb(l):i&&(this.success[i]=!0)},o)}},Co=cs.getSessionAPI.bind(cs),eo=new Set,fa={create:"create",load:"load",fullLoad:"fullLoad"};function Wr(o){const i=o.name.split("?")[0];return Wt(i)&&i.includes("mapbox-gl.js")?"javascript":Wt(i)&&i.includes("mapbox-gl.css")?"css":Oe.API_FONTS_REGEX.test(i)?"fontRange":jt(i)?"sprite":Zt(i)?"style":Oe.API_TILEJSON_REGEX.test(i)?"tilejson":"other"}function _l(o){const i=o?o.url.toString():void 0;return i?performance.getEntriesByName(i):[]}let Eo,gh,_h,Oc,Ua;function yh(){return null==Eo&&(Eo=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),Eo}const uo={now:()=>void 0!==Oc?Oc:performance.now(),setNow(o){Oc=o},restoreNow(){Oc=void 0},frame(o){const i=requestAnimationFrame(o);return{cancel:()=>cancelAnimationFrame(i)}},getImageData(o,i=0){const{width:a,height:l}=o;Ua||(Ua=document.createElement("canvas"));const d=Ua.getContext("2d",{willReadFrequently:!0});if(!d)throw new Error("failed to create canvas 2d context");return(a>Ua.width||l>Ua.height)&&(Ua.width=a,Ua.height=l),d.clearRect(-i,-i,a+2*i,l+2*i),d.drawImage(o,0,0,a,l),d.getImageData(-i,-i,a+2*i,l+2*i)},resolveURL:o=>(gh||(gh=document.createElement("a")),gh.href=o,gh.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(null==_h&&(_h=window.matchMedia("(prefers-reduced-motion: reduce)")),_h.matches)},hasCanvasFingerprintNoise(){if(!yh())return!1;const o=new OffscreenCanvas(85,1),i=o.getContext("2d",{willReadFrequently:!0});let a=0;for(let d=0;d<o.width;++d)i.fillStyle=`rgba(${a++},${a++},${a++}, 255)`,i.fillRect(d,0,1,1);const l=i.getImageData(0,0,o.width,o.height);a=0;for(let d=0;d<l.data.length;++d)if(d%4!=3&&a++!==l.data[d])return!0;return!1}};function ud(o,i,a){a[o]&&-1!==a[o].indexOf(i)||(a[o]=a[o]||[],a[o].push(i))}function yl(o,i,a){if(a&&a[o]){const l=a[o].indexOf(i);-1!==l&&a[o].splice(l,1)}}class Ao{constructor(i,a={}){Gr(this,a),this.type=i}}class Xl extends Ao{constructor(i,a={}){super("error",Gr({error:i},a))}}class pa{on(i,a){return this._listeners=this._listeners||{},ud(i,a,this._listeners),this}off(i,a){return yl(i,a,this._listeners),yl(i,a,this._oneTimeListeners),this}once(i,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},ud(i,a,this._oneTimeListeners),this):new Promise(l=>this.once(i,l))}fire(i,a){"string"==typeof i&&(i=new Ao(i,a||{}));const l=i.type;if(this.listens(l)){i.target=this;const d=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const y of d)y.call(this,i);const p=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const y of p)yl(l,y,this._oneTimeListeners),y.call(this,i);const g=this._eventedParent;g&&(Gr(i,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),g.fire(i))}else i instanceof Xl&&console.error(i.error);return this}listens(i){return!!(this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i))}setEventedParent(i,a){return this._eventedParent=i,this._eventedParentData=a,this}}var He=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","default":[0,1],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class sn{constructor(i,a,l,d){this.message=(i?`${i}: `:"")+l,d&&(this.identifier=d),null!=a&&a.__line__&&(this.line=a.__line__)}}class Ys extends sn{}function Xs(o,...i){for(const a of i)for(const l in a)o[l]=a[l];return o}function Zr(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function wr(o){if(Array.isArray(o))return o.map(wr);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){const i={};for(const a in o)i[a]=wr(o[a]);return i}return Zr(o)}class vh extends Error{constructor(i,a){super(a),this.message=a,this.key=i}}var ui=vh;class Gn{constructor(i,a=[]){this.parent=i,this.bindings={};for(const[l,d]of a)this.bindings[l]=d}concat(i){return new Gn(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}var bh=Gn;const Ha={kind:"null"},pt={kind:"number"},hi={kind:"string"},Di={kind:"boolean"},Ii={kind:"color"},xs={kind:"object"},jn={kind:"value"},ks={kind:"collator"},_r={kind:"formatted"},Ki={kind:"resolvedImage"};function $n(o,i){return{kind:"array",itemType:o,N:i}}function Qi(o){if("array"===o.kind){const i=Qi(o.itemType);return"number"==typeof o.N?`array<${i}, ${o.N}>`:"value"===o.itemType.kind?"array":`array<${i}>`}return o.kind}const dd=[Ha,pt,hi,Di,Ii,_r,xs,$n(jn),Ki];function Fc(o,i){if("error"===i.kind)return null;if("array"===o.kind){if("array"===i.kind&&(0===i.N&&"value"===i.itemType.kind||!Fc(o.itemType,i.itemType))&&("number"!=typeof o.N||o.N===i.N))return null}else{if(o.kind===i.kind)return null;if("value"===o.kind)for(const a of dd)if(!Fc(a,i))return null}return`Expected ${Qi(o)} but found ${Qi(i)} instead.`}function hd(o,i){return i.some(a=>a.kind===o.kind)}function yt(o,i){return i.some(a=>"null"===a?null===o:"array"===a?Array.isArray(o):"object"===a?o&&!Array.isArray(o)&&"object"==typeof o:a===typeof o)}var vl,li={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function qi(o){return(o=Math.round(o))<0?0:o>255?255:o}function xh(o){return qi("%"===o[o.length-1]?parseFloat(o)/100*255:parseInt(o))}function wh(o){return(i="%"===o[o.length-1]?parseFloat(o)/100:parseFloat(o))<0?0:i>1?1:i;var i}function Ch(o,i,a){return a<0?a+=1:a>1&&(a-=1),6*a<1?o+(i-o)*a*6:2*a<1?i:3*a<2?o+(i-o)*(2/3-a)*6:o}try{vl={}.parseCSSColor=function(o){var i,a=o.replace(/ /g,"").toLowerCase();if(a in li)return li[a].slice();if("#"===a[0])return 4===a.length?(i=parseInt(a.substr(1),16))>=0&&i<=4095?[(3840&i)>>4|(3840&i)>>8,240&i|(240&i)>>4,15&i|(15&i)<<4,1]:null:7===a.length&&(i=parseInt(a.substr(1),16))>=0&&i<=16777215?[(16711680&i)>>16,(65280&i)>>8,255&i,1]:null;var l=a.indexOf("("),d=a.indexOf(")");if(-1!==l&&d+1===a.length){var p=a.substr(0,l),g=a.substr(l+1,d-(l+1)).split(","),y=1;switch(p){case"rgba":if(4!==g.length)return null;y=wh(g.pop());case"rgb":return 3!==g.length?null:[xh(g[0]),xh(g[1]),xh(g[2]),y];case"hsla":if(4!==g.length)return null;y=wh(g.pop());case"hsl":if(3!==g.length)return null;var x=(parseFloat(g[0])%360+360)%360/360,C=wh(g[1]),D=wh(g[2]),M=D<=.5?D*(C+1):D+C-D*C,k=2*D-M;return[qi(255*Ch(k,M,x+1/3)),qi(255*Ch(k,M,x)),qi(255*Ch(k,M,x-1/3)),y];default:return null}}return null}}catch{}class Oo{constructor(i,a,l,d=1){this.r=i,this.g=a,this.b=l,this.a=d}static parse(i){if(!i)return;if(i instanceof Oo)return i;if("string"!=typeof i)return;const a=vl(i);return a?new Oo(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3]):void 0}toString(){const[i,a,l,d]=this.toArray();return`rgba(${Math.round(i)},${Math.round(a)},${Math.round(l)},${d})`}toArray(){const{r:i,g:a,b:l,a:d}=this;return 0===d?[0,0,0,0]:[255*i/d,255*a/d,255*l/d,d]}toArray01(){const{r:i,g:a,b:l,a:d}=this;return 0===d?[0,0,0,0]:[i/d,a/d,l/d,d]}toArray01Scaled(i){const{r:a,g:l,b:d,a:p}=this;return 0===p?[0,0,0]:[a/p*i,l/p*i,d/p*i]}toArray01PremultipliedAlpha(){const{r:i,g:a,b:l,a:d}=this;return[i,a,l,d]}toArray01Linear(){const{r:i,g:a,b:l,a:d}=this;return 0===d?[0,0,0,0]:[Math.pow(i/d,2.2),Math.pow(a/d,2.2),Math.pow(l/d,2.2),d]}}Oo.black=new Oo(0,0,0,1),Oo.white=new Oo(1,1,1,1),Oo.transparent=new Oo(0,0,0,0),Oo.red=new Oo(1,0,0,1),Oo.blue=new Oo(0,0,1,1);var Pi=Oo;class jf{constructor(i,a,l){this.sensitivity=i?a?"variant":"case":a?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,a){return this.collator.compare(i,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Kl{constructor(i,a,l,d,p){this.text=i.normalize?i.normalize():i,this.image=a,this.scale=l,this.fontStack=d,this.textColor=p}}class ns{constructor(i){this.sections=i}static fromString(i){return new ns([new Kl(i,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(i=>0!==i.text.length||i.image&&0!==i.image.namePrimary.length)}static factory(i){return i instanceof ns?i:ns.fromString(i)}toString(){return 0===this.sections.length?"":this.sections.map(i=>i.text).join("")}serialize(){const i=["format"];for(const a of this.sections){if(a.image){i.push(["image",a.image.namePrimary]);continue}i.push(a.text);const l={};a.fontStack&&(l["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(l["font-scale"]=a.scale),a.textColor&&(l["text-color"]=["rgba"].concat(a.textColor.toArray())),i.push(l)}return i}}class Io{constructor(i){this.namePrimary=i.namePrimary,i.nameSecondary&&(this.nameSecondary=i.nameSecondary),this.available=i.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(i,a){return i?new Io({namePrimary:i,nameSecondary:a,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function Uf(o,i,a,l){return"number"==typeof o&&o>=0&&o<=255&&"number"==typeof i&&i>=0&&i<=255&&"number"==typeof a&&a>=0&&a<=255?void 0===l||"number"==typeof l&&l>=0&&l<=1?null:`Invalid rgba value [${[o,i,a,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof l?[o,i,a,l]:[o,i,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function vu(o){if(null===o||"string"==typeof o||"boolean"==typeof o||"number"==typeof o||o instanceof Pi||o instanceof jf||o instanceof ns||o instanceof Io)return!0;if(Array.isArray(o)){for(const i of o)if(!vu(i))return!1;return!0}if("object"==typeof o){for(const i in o)if(!vu(o[i]))return!1;return!0}return!1}function yo(o){if(null===o)return Ha;if("string"==typeof o)return hi;if("boolean"==typeof o)return Di;if("number"==typeof o)return pt;if(o instanceof Pi)return Ii;if(o instanceof jf)return ks;if(o instanceof ns)return _r;if(o instanceof Io)return Ki;if(Array.isArray(o)){const i=o.length;let a;for(const l of o){const d=yo(l);if(a){if(a===d)continue;a=jn;break}a=d}return $n(a||jn,i)}return xs}function $a(o){const i=typeof o;return null===o?"":"string"===i||"number"===i||"boolean"===i?String(o):o instanceof Pi||o instanceof ns||o instanceof Io?o.toString():JSON.stringify(o)}class fd{constructor(i,a){this.type=i,this.value=a}static parse(i,a){if(2!==i.length)return a.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!vu(i[1]))return a.error("invalid value");const l=i[1];let d=yo(l);const p=a.expectedType;return"array"!==d.kind||0!==d.N||!p||"array"!==p.kind||"number"==typeof p.N&&0!==p.N||(d=p),new fd(d,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Pi?["rgba"].concat(this.value.toArray()):this.value instanceof ns?this.value.serialize():this.value}}var bu=fd,Or=class{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}};const Eh={string:hi,number:pt,boolean:Di,object:xs};class us{constructor(i,a){this.type=i,this.args=a}static parse(i,a){if(i.length<2)return a.error("Expected at least one argument.");let l,d=1;const p=i[0];if("array"===p){let y,x;if(i.length>2){const C=i[1];if("string"!=typeof C||!(C in Eh)||"object"===C)return a.error('The item type argument of "array" must be one of string, number, boolean',1);y=Eh[C],d++}else y=jn;if(i.length>3){if(null!==i[2]&&("number"!=typeof i[2]||i[2]<0||i[2]!==Math.floor(i[2])))return a.error('The length argument to "array" must be a positive integer literal',2);x=i[2],d++}l=$n(y,x)}else l=Eh[p];const g=[];for(;d<i.length;d++){const y=a.parse(i[d],d,jn);if(!y)return null;g.push(y)}return new us(l,g)}evaluate(i){for(let a=0;a<this.args.length;a++){const l=this.args[a].evaluate(i);if(!Fc(this.type,yo(l)))return l;if(a===this.args.length-1)throw new Or(`Expected value to be of type ${Qi(this.type)}, but found ${Qi(yo(l))} instead.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=this.type,a=[i.kind];if("array"===i.kind){const l=i.itemType;if("string"===l.kind||"number"===l.kind||"boolean"===l.kind){a.push(l.kind);const d=i.N;("number"==typeof d||this.args.length>1)&&a.push(d)}}return a.concat(this.args.map(l=>l.serialize()))}}var Zn=us;class pd{constructor(i){this.type=_r,this.sections=i}static parse(i,a){if(i.length<2)return a.error("Expected at least one argument.");const l=i[1];if(!Array.isArray(l)&&"object"==typeof l)return a.error("First argument must be an image or text section.");const d=[];let p=!1;for(let g=1;g<=i.length-1;++g){const y=i[g];if(p&&"object"==typeof y&&!Array.isArray(y)){p=!1;let x=null;if(y["font-scale"]&&(x=a.parse(y["font-scale"],1,pt),!x))return null;let C=null;if(y["text-font"]&&(C=a.parse(y["text-font"],1,$n(hi)),!C))return null;let D=null;if(y["text-color"]&&(D=a.parse(y["text-color"],1,Ii),!D))return null;const M=d[d.length-1];M.scale=x,M.font=C,M.textColor=D}else{const x=a.parse(i[g],1,jn);if(!x)return null;const C=x.type.kind;if("string"!==C&&"value"!==C&&"null"!==C&&"resolvedImage"!==C)return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,d.push({content:x,scale:null,font:null,textColor:null})}}return new pd(d)}evaluate(i){return new ns(this.sections.map(a=>{const l=a.content.evaluate(i);return yo(l)===Ki?new Kl("",l,null,null,null):new Kl($a(l),null,a.scale?a.scale.evaluate(i):null,a.font?a.font.evaluate(i).join(","):null,a.textColor?a.textColor.evaluate(i):null)}))}eachChild(i){for(const a of this.sections)i(a.content),a.scale&&i(a.scale),a.font&&i(a.font),a.textColor&&i(a.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const a of this.sections){i.push(a.content.serialize());const l={};a.scale&&(l["font-scale"]=a.scale.serialize()),a.font&&(l["text-font"]=a.font.serialize()),a.textColor&&(l["text-color"]=a.textColor.serialize()),i.push(l)}return i}}class md{constructor(i,a){this.type=Ki,this.inputPrimary=i,this.inputSecondary=a}static parse(i,a){if(i.length<2)return a.error("Expected two or more arguments.");const l=a.parse(i[1],1,hi);if(!l)return a.error("No image name provided.");if(2===i.length)return new md(l);const d=a.parse(i[2],1,hi);return d?new md(l,d):a.error("Secondary image variant is not a string.")}evaluate(i){const a=Io.fromString(this.inputPrimary.evaluate(i),this.inputSecondary?this.inputSecondary.evaluate(i):void 0);return a&&i.availableImages&&(a.available=i.availableImages.indexOf(a.namePrimary)>-1,a.nameSecondary&&a.available&&i.availableImages&&(a.available=i.availableImages.indexOf(a.nameSecondary)>-1)),a}eachChild(i){i(this.inputPrimary),this.inputSecondary&&i(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function ji(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":null===o?"null":typeof o}const Ut={"to-boolean":Di,"to-color":Ii,"to-number":pt,"to-string":hi};class bl{constructor(i,a){this.type=i,this.args=a}static parse(i,a){if(i.length<2)return a.error("Expected at least one argument.");const l=i[0],d=[];let p=Ha;if("to-array"===l){if(!Array.isArray(i[1]))return null;const g=i[1].length;if(a.expectedType){if("array"!==a.expectedType.kind)return a.error(`Expected ${a.expectedType.kind} but found array.`);p=$n(a.expectedType.itemType,g)}else{if(!(g>0&&vu(i[1][0])))return null;p=$n(yo(i[1][0]),g)}for(let y=0;y<g;y++){const x=i[1][y];let C;if("array"===ji(x))C=a.parse(x,void 0,p.itemType);else{const D=ji(x);if(D!==p.itemType.kind)return a.error(`Expected ${p.itemType.kind} but found ${D}.`);C=a.registry.literal.parse(["literal",void 0===x?null:x],a)}if(!C)return null;d.push(C)}}else{if(("to-boolean"===l||"to-string"===l)&&2!==i.length)return a.error("Expected one argument.");p=Ut[l];for(let g=1;g<i.length;g++){const y=a.parse(i[g],g,jn);if(!y)return null;d.push(y)}}return new bl(p,d)}evaluate(i){if("boolean"===this.type.kind)return!!this.args[0].evaluate(i);if("color"===this.type.kind){let a,l;for(const d of this.args){if(a=d.evaluate(i),l=null,a instanceof Pi)return a;if("string"==typeof a){const p=i.parseColor(a);if(p)return p}else if(Array.isArray(a)&&(l=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:Uf(a[0],a[1],a[2],a[3]),!l))return new Pi(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new Or(l||`Could not parse color from value '${"string"==typeof a?a:String(JSON.stringify(a))}'`)}if("number"===this.type.kind){let a=null;for(const l of this.args){if(a=l.evaluate(i),null===a)return 0;const d=Number(a);if(!isNaN(d))return d}throw new Or(`Could not convert ${JSON.stringify(a)} to number.`)}return"formatted"===this.type.kind?ns.fromString($a(this.args[0].evaluate(i))):"resolvedImage"===this.type.kind?Io.fromString($a(this.args[0].evaluate(i))):"array"===this.type.kind?this.args.map(a=>a.evaluate(i)):$a(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){if("formatted"===this.type.kind)return new pd([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new md(this.args[0]).serialize();const i="array"===this.type.kind?[]:[`to-${this.type.kind}`];return this.eachChild(a=>{i.push(a.serialize())}),i}}var Oi=bl;const Lc=["Unknown","Point","LineString","Polygon"];var gd=class{constructor(o,i){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=o,this.options=i}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Lc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(o){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const o=this.featureDistanceData.center,i=this.featureDistanceData.scale,{x:a,y:l}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(a*i-o[0])+this.featureDistanceData.bearing[1]*(l*i-o[1])}return 0}parseColor(o){let i=this._parseColorCache[o];return i||(i=this._parseColorCache[o]=Pi.parse(o)),i}getConfig(o){return this.options?this.options.get(o):null}};class Ga{constructor(i,a,l,d,p){this.name=i,this.type=a,this._evaluate=l,this.args=d,this._overloadIndex=p}evaluate(i){if(!this._evaluate){const a=Ga.definitions[this.name];this._evaluate=Array.isArray(a)?a[2]:a.overloads[this._overloadIndex][1]}return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(i=>i.serialize()))}static parse(i,a){const l=i[0],d=Ga.definitions[l];if(!d)return a.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(d)?d[0]:d.type,g=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,y=[];let x=null,C=-1;for(const[D,M]of g){if(Array.isArray(D)&&D.length!==i.length-1)continue;y.push(D),C++,x=new Iu(a.registry,a.path,null,a.scope,void 0,a._scope,a.options);const k=[];let P=!1;for(let F=1;F<i.length;F++){const B=i[F],j=Array.isArray(D)?D[F-1]:D.type,q=x.parse(B,1+k.length,j);if(!q){P=!0;break}k.push(q)}if(!P)if(Array.isArray(D)&&D.length!==k.length)x.error(`Expected ${D.length} arguments, but found ${k.length} instead.`);else{for(let F=0;F<k.length;F++){const B=Array.isArray(D)?D[F]:D.type,j=k[F];x.concat(F+1).checkSubtype(B,j.type)}if(0===x.errors.length)return new Ga(l,p,M,k,C)}}if(1===y.length)a.errors.push(...x.errors);else{const D=(y.length?y:g.map(([k])=>k)).map(Hf).join(" | "),M=[];for(let k=1;k<i.length;k++){const P=a.parse(i[k],1+M.length);if(!P)return null;M.push(Qi(P.type))}a.error(`Expected arguments of type ${D}, but found (${M.join(", ")}) instead.`)}return null}static register(i,a){Ga.definitions=a;for(const l in a)i[l]=Ga}}function Hf(o){return Array.isArray(o)?`(${o.map(Qi).join(", ")})`:`(${Qi(o.type)}...)`}var ds=Ga;class xl{constructor(i,a,l){this.type=ks,this.locale=l,this.caseSensitive=i,this.diacriticSensitive=a}static parse(i,a){if(2!==i.length)return a.error("Expected one argument.");const l=i[1];if("object"!=typeof l||Array.isArray(l))return a.error("Collator options argument must be an object.");const d=a.parse(void 0!==l["case-sensitive"]&&l["case-sensitive"],1,Di);if(!d)return null;const p=a.parse(void 0!==l["diacritic-sensitive"]&&l["diacritic-sensitive"],1,Di);if(!p)return null;let g=null;return l.locale&&(g=a.parse(l.locale,1,hi),!g)?null:new xl(d,p,g)}evaluate(i){return new jf(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}var xu={exports:{}};xu.exports=function(){function o(l,d,p,g,y){for(;g>p;){if(g-p>600){var x=g-p+1,C=d-p+1,D=Math.log(x),M=.5*Math.exp(2*D/3),k=.5*Math.sqrt(D*M*(x-M)/x)*(C-x/2<0?-1:1);o(l,d,Math.max(p,Math.floor(d-C*M/x+k)),Math.min(g,Math.floor(d+(x-C)*M/x+k)),y)}var P=l[d],F=p,B=g;for(i(l,p,d),y(l[g],P)>0&&i(l,p,g);F<B;){for(i(l,F,B),F++,B--;y(l[F],P)<0;)F++;for(;y(l[B],P)>0;)B--}0===y(l[p],P)?i(l,p,B):i(l,++B,g),B<=d&&(p=B+1),d<=B&&(g=B-1)}}function i(l,d,p){var g=l[d];l[d]=l[p],l[p]=g}function a(l,d){return l<d?-1:l>d?1:0}return function(l,d,p,g,y){o(l,d,p||0,g||l.length-1,y||a)}}();var Dh=De(xu.exports);function _d(o){let i=0;for(let a,l,d=0,p=o.length,g=p-1;d<p;g=d++)a=o[d],l=o[g],i+=(l.x-a.x)*(a.y+l.y);return i}function ri(o,i){o[0]=Math.min(o[0],i[0]),o[1]=Math.min(o[1],i[1]),o[2]=Math.max(o[2],i[0]),o[3]=Math.max(o[3],i[1])}function ma(o,i){return!(o[0]<=i[0]||o[2]>=i[2]||o[1]<=i[1]||o[3]>=i[3])}function Th(o,i,a){const l=o[0]-i[0],d=o[1]-i[1],p=o[0]-a[0],g=o[1]-a[1];return l*g-p*d==0&&l*p<=0&&d*g<=0}function ho(o,i,a=!1){let l=!1;for(let y=0,x=i.length;y<x;y++){const C=i[y];for(let D=0,M=C.length,k=M-1;D<M;k=D++){const P=C[k],F=C[D];if(Th(o,P,F))return a;(p=P)[1]>(d=o)[1]!=(g=F)[1]>d[1]&&d[0]<(g[0]-p[0])*(d[1]-p[1])/(g[1]-p[1])+p[0]&&(l=!l)}}var d,p,g;return l}function yd(o,i,a,l){const d=l[0]-a[0],p=l[1]-a[1],g=(o[0]-a[0])*p-d*(o[1]-a[1]),y=(i[0]-a[0])*p-d*(i[1]-a[1]);return g>0&&y<0||g<0&&y>0}function is(o,i,a,l){return(d=[l[0]-a[0],l[1]-a[1]])[0]*(p=[i[0]-o[0],i[1]-o[1]])[1]-d[1]*p[0]!=0&&!(!yd(o,i,a,l)||!yd(a,l,o,i));var d,p}const In=8192;function Sm(o,i){const a=(180+o[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,d=Math.pow(2,i.z);return[Math.round(a*d*In),Math.round(l*d*In)]}function vd(o,i){for(let a=0;a<i.length;a++)if(ho(o,i[a]))return!0;return!1}function Sh(o,i,a){for(const l of a)for(let d=0,p=l.length,g=p-1;d<p;g=d++)if(is(o,i,l[g],l[d]))return!0;return!1}function wu(o,i){for(let a=0;a<o.length;++a)if(!ho(o[a],i))return!1;for(let a=0;a<o.length-1;++a)if(Sh(o[a],o[a+1],i))return!1;return!0}function $f(o,i){for(let a=0;a<i.length;a++)if(wu(o,i[a]))return!0;return!1}function Ql(o,i,a){const l=[];for(let d=0;d<o.length;d++){const p=[];for(let g=0;g<o[d].length;g++){const y=Sm(o[d][g],a);ri(i,y),p.push(y)}l.push(p)}return l}function wl(o,i,a){const l=[];for(let d=0;d<o.length;d++){const p=Ql(o[d],i,a);l.push(p)}return l}function Cu(o,i,a,l){if(o[0]<a[0]||o[0]>a[2]){const d=.5*l;let p=o[0]-a[0]>d?-l:a[0]-o[0]>d?l:0;0===p&&(p=o[0]-a[2]>d?-l:a[2]-o[0]>d?l:0),o[0]+=p}ri(i,o)}function Nc(o,i,a,l){const d=Math.pow(2,l.z)*In,p=[l.x*In,l.y*In],g=[];if(!o)return g;for(const y of o)for(const x of y){const C=[x.x+p[0],x.y+p[1]];Cu(C,i,a,d),g.push(C)}return g}function Gf(o,i,a,l){const d=Math.pow(2,l.z)*In,p=[l.x*In,l.y*In],g=[];if(!o)return g;for(const x of o){const C=[];for(const D of x){const M=[D.x+p[0],D.y+p[1]];ri(i,M),C.push(M)}g.push(C)}if(i[2]-i[0]<=d/2){(y=i)[0]=y[1]=1/0,y[2]=y[3]=-1/0;for(const x of g)for(const C of x)Cu(C,i,a,d)}var y;return g}class qa{constructor(i,a){this.type=Di,this.geojson=i,this.geometries=a}static parse(i,a){if(2!==i.length)return a.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(vu(i[1])){const l=i[1];if("FeatureCollection"===l.type)for(let d=0;d<l.features.length;++d){const p=l.features[d].geometry.type;if("Polygon"===p||"MultiPolygon"===p)return new qa(l,l.features[d].geometry)}else if("Feature"===l.type){const d=l.geometry.type;if("Polygon"===d||"MultiPolygon"===d)return new qa(l,l.geometry)}else if("Polygon"===l.type||"MultiPolygon"===l.type)return new qa(l,l)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(null!=i.geometry()&&null!=i.canonicalID()){if("Point"===i.geometryType())return function(a,l){const d=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],g=a.canonicalID();if(!g)return!1;if("Polygon"===l.type){const y=Ql(l.coordinates,p,g),x=Nc(a.geometry(),d,p,g);if(!ma(d,p))return!1;for(const C of x)if(!ho(C,y))return!1}if("MultiPolygon"===l.type){const y=wl(l.coordinates,p,g),x=Nc(a.geometry(),d,p,g);if(!ma(d,p))return!1;for(const C of x)if(!vd(C,y))return!1}return!0}(i,this.geometries);if("LineString"===i.geometryType())return function(a,l){const d=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],g=a.canonicalID();if(!g)return!1;if("Polygon"===l.type){const y=Ql(l.coordinates,p,g),x=Gf(a.geometry(),d,p,g);if(!ma(d,p))return!1;for(const C of x)if(!wu(C,y))return!1}if("MultiPolygon"===l.type){const y=wl(l.coordinates,p,g),x=Gf(a.geometry(),d,p,g);if(!ma(d,p))return!1;for(const C of x)if(!$f(C,y))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Mh=qa,qf={exports:{}};qf.exports=function(){var o={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},i=1/298.257223563,a=i*(2-i),l=Math.PI/180,d=function(C,D){if(void 0===C)throw new Error("No latitude given.");if(D&&!o[D])throw new Error("Unknown unit "+D+". Use one of: "+Object.keys(o).join(", "));var M=6378.137*l*(D?o[D]:1),k=Math.cos(C*l),P=1/(1-a*(1-k*k)),F=Math.sqrt(P);this.kx=M*F*k,this.ky=M*F*P*(1-a)},p={units:{configurable:!0}};function g(C,D){return C[0]===D[0]&&C[1]===D[1]}function y(C,D,M){var k=x(D[0]-C[0]);return[C[0]+k*M,C[1]+(D[1]-C[1])*M]}function x(C){for(;C<-180;)C+=360;for(;C>180;)C-=360;return C}return d.fromTile=function(C,D,M){var k=Math.PI*(1-2*(C+.5)/Math.pow(2,D)),P=Math.atan(.5*(Math.exp(k)-Math.exp(-k)))/l;return new d(P,M)},p.units.get=function(){return o},d.prototype.distance=function(C,D){var M=x(C[0]-D[0])*this.kx,k=(C[1]-D[1])*this.ky;return Math.sqrt(M*M+k*k)},d.prototype.bearing=function(C,D){var M=x(D[0]-C[0])*this.kx;return Math.atan2(M,(D[1]-C[1])*this.ky)/l},d.prototype.destination=function(C,D,M){var k=M*l;return this.offset(C,Math.sin(k)*D,Math.cos(k)*D)},d.prototype.offset=function(C,D,M){return[C[0]+D/this.kx,C[1]+M/this.ky]},d.prototype.lineDistance=function(C){for(var D=0,M=0;M<C.length-1;M++)D+=this.distance(C[M],C[M+1]);return D},d.prototype.area=function(C){for(var D=0,M=0;M<C.length;M++)for(var k=C[M],P=0,F=k.length,B=F-1;P<F;B=P++)D+=x(k[P][0]-k[B][0])*(k[P][1]+k[B][1])*(M?-1:1);return Math.abs(D)/2*this.kx*this.ky},d.prototype.along=function(C,D){var M=0;if(D<=0)return C[0];for(var k=0;k<C.length-1;k++){var P=C[k],F=C[k+1],B=this.distance(P,F);if((M+=B)>D)return y(P,F,(D-(M-B))/B)}return C[C.length-1]},d.prototype.pointToSegmentDistance=function(C,D,M){var k=D[0],P=D[1],F=x(M[0]-k)*this.kx,B=(M[1]-P)*this.ky,j=0;return 0===F&&0===B||((j=(x(C[0]-k)*this.kx*F+(C[1]-P)*this.ky*B)/(F*F+B*B))>1?(k=M[0],P=M[1]):j>0&&(k+=F/this.kx*j,P+=B/this.ky*j)),F=x(C[0]-k)*this.kx,B=(C[1]-P)*this.ky,Math.sqrt(F*F+B*B)},d.prototype.pointOnLine=function(C,D){for(var M,k,P,F,B=1/0,j=0;j<C.length-1;j++){var q=C[j][0],te=C[j][1],ie=x(C[j+1][0]-q)*this.kx,se=(C[j+1][1]-te)*this.ky,de=0;0===ie&&0===se||((de=(x(D[0]-q)*this.kx*ie+(D[1]-te)*this.ky*se)/(ie*ie+se*se))>1?(q=C[j+1][0],te=C[j+1][1]):de>0&&(q+=ie/this.kx*de,te+=se/this.ky*de));var pe=(ie=x(D[0]-q)*this.kx)*ie+(se=(D[1]-te)*this.ky)*se;pe<B&&(B=pe,M=q,k=te,P=j,F=de)}return{point:[M,k],index:P,t:Math.max(0,Math.min(1,F))}},d.prototype.lineSlice=function(C,D,M){var k=this.pointOnLine(M,C),P=this.pointOnLine(M,D);if(k.index>P.index||k.index===P.index&&k.t>P.t){var F=k;k=P,P=F}var B=[k.point],j=k.index+1,q=P.index;!g(M[j],B[0])&&j<=q&&B.push(M[j]);for(var te=j+1;te<=q;te++)B.push(M[te]);return g(M[q],P.point)||B.push(P.point),B},d.prototype.lineSliceAlong=function(C,D,M){for(var k=0,P=[],F=0;F<M.length-1;F++){var B=M[F],j=M[F+1],q=this.distance(B,j);if((k+=q)>C&&0===P.length&&P.push(y(B,j,(C-(k-q))/q)),k>=D)return P.push(y(B,j,(D-(k-q))/q)),P;k>C&&P.push(j)}return P},d.prototype.bufferPoint=function(C,D){var M=D/this.ky,k=D/this.kx;return[C[0]-k,C[1]-M,C[0]+k,C[1]+M]},d.prototype.bufferBBox=function(C,D){var M=D/this.ky,k=D/this.kx;return[C[0]-k,C[1]-M,C[2]+k,C[3]+M]},d.prototype.insideBBox=function(C,D){return x(C[0]-D[0])>=0&&x(C[0]-D[2])<=0&&C[1]>=D[1]&&C[1]<=D[3]},Object.defineProperties(d,p),d}();var Jl=De(qf.exports),Bc={exports:{}};Bc.exports=function(){var o=function(a,l){if(void 0===a&&(a=[]),void 0===l&&(l=i),this.data=a,this.length=this.data.length,this.compare=l,this.length>0)for(var d=(this.length>>1)-1;d>=0;d--)this._down(d)};function i(a,l){return a<l?-1:a>l?1:0}return o.prototype.push=function(a){this.data.push(a),this.length++,this._up(this.length-1)},o.prototype.pop=function(){if(0!==this.length){var a=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),a}},o.prototype.peek=function(){return this.data[0]},o.prototype._up=function(a){for(var l=this.data,d=this.compare,p=l[a];a>0;){var g=a-1>>1,y=l[g];if(d(p,y)>=0)break;l[a]=y,a=g}l[a]=p},o.prototype._down=function(a){for(var l=this.data,d=this.compare,p=this.length>>1,g=l[a];a<p;){var y=1+(a<<1),x=l[y],C=y+1;if(C<this.length&&d(l[C],x)<0&&(y=C,x=l[C]),d(x,g)>=0)break;l[a]=x,a=y}l[a]=g},o}();var ec=De(Bc.exports),Ht=8192;function Ah(o,i){return i.dist-o.dist}const Eu=100,tc=50;function nc(o){const i=[1/0,1/0,-1/0,-1/0];if(i.length!==o.length)return!1;for(let a=0;a<i.length;a++)if(i[a]!==o[a])return!1;return!0}function bd(o){return o[1]-o[0]+1}function $o(o,i){const a=o[1]>=o[0]&&o[1]<i;return a||console.warn("Distance Expression: Index is out of range"),a}function Du(o,i){if(o[0]>o[1])return[null,null];const a=bd(o);if(i){if(2===a)return[o,null];const l=Math.floor(a/2);return[[o[0],o[0]+l],[o[0]+l,o[1]]]}{if(1===a)return[o,null];const l=Math.floor(a/2)-1;return[[o[0],o[0]+l],[o[0]+l+1,o[1]]]}}function ze(o,i){const a=[1/0,1/0,-1/0,-1/0];if(!$o(i,o.length))return a;for(let l=i[0];l<=i[1];++l)ri(a,o[l]);return a}function ic(o){const i=[1/0,1/0,-1/0,-1/0];for(let a=0;a<o.length;++a)for(let l=0;l<o[a].length;++l)ri(i,o[a][l]);return i}function Jt(o,i,a){if(nc(o)||nc(i))return NaN;let l=0,d=0;return o[2]<i[0]&&(l=i[0]-o[2]),o[0]>i[2]&&(l=o[0]-i[2]),o[1]>i[3]&&(d=o[1]-i[3]),o[3]<i[1]&&(d=i[1]-o[3]),a.distance([0,0],[l,d])}function rc(o,i){const a=Math.pow(2,i.z);return[(d=(o.x/Ht+i.x)/a,360*d-180),(l=(o.y/Ht+i.y)/a,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,d}function Tu(o,i){const a=[];for(let l=0;l<o.length;++l)a.push(rc(o[l],i));return a}function ga(o,i,a){const l=a.pointOnLine(i,o).point;return a.distance(o,l)}function Ih(o,i,a,l,d){const p=a.slice(l[0],l[1]+1);let g=1/0;for(let y=i[0];y<=i[1];++y)if(0===(g=Math.min(g,ga(o[y],p,d))))return 0;return g}function xd(o,i,a,l,d){const p=Math.min(d.pointToSegmentDistance(o,a,l),d.pointToSegmentDistance(i,a,l)),g=Math.min(d.pointToSegmentDistance(a,o,i),d.pointToSegmentDistance(l,o,i));return Math.min(p,g)}function Wf(o,i,a,l,d){if(!$o(i,o.length)||!$o(l,a.length))return NaN;let p=1/0;for(let g=i[0];g<i[1];++g)for(let y=l[0];y<l[1];++y){if(is(o[g],o[g+1],a[y],a[y+1]))return 0;p=Math.min(p,xd(o[g],o[g+1],a[y],a[y+1],d))}return p}function _a(o,i,a,l,d){if(!$o(i,o.length)||!$o(l,a.length))return NaN;let p=1/0;for(let g=i[0];g<=i[1];++g)for(let y=l[0];y<=l[1];++y)if(0===(p=Math.min(p,d.distance(o[g],a[y]))))return p;return p}function zc(o,i,a){if(ho(o,i,!0))return 0;let l=1/0;for(const d of i){const p=d.length;if(p<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(d[0]!==d[p-1]&&0===(l=Math.min(l,a.pointToSegmentDistance(o,d[p-1],d[0])))||0===(l=Math.min(l,ga(o,d,a))))return l}return l}function ws(o,i,a,l){if(!$o(i,o.length))return NaN;for(let p=i[0];p<=i[1];++p)if(ho(o[p],a,!0))return 0;let d=1/0;for(let p=i[0];p<i[1];++p)for(const g of a)for(let y=0,x=g.length,C=x-1;y<x;C=y++){if(is(o[p],o[p+1],g[C],g[y]))return 0;d=Math.min(d,xd(o[p],o[p+1],g[C],g[y],l))}return d}function Rs(o,i){for(const a of o)for(let l=0;l<=a.length-1;++l)if(ho(a[l],i,!0))return!0;return!1}function ir(o,i,a,l=1/0){const d=ic(o),p=ic(i);if(l!==1/0&&Jt(d,p,a)>=l)return l;if(ma(d,p)){if(Rs(o,i))return 0}else if(Rs(i,o))return 0;let g=l;for(const y of o)for(let x=0,C=y.length,D=C-1;x<C;D=x++)for(const M of i)for(let k=0,P=M.length,F=P-1;k<P;F=k++){if(is(y[D],y[x],M[F],M[k]))return 0;g=Math.min(g,xd(y[D],y[x],M[F],M[k],a))}return g}function Cl(o,i,a,l,d,p,g){if(null===p||null===g)return;const y=Jt(ze(l,p),ze(d,g),a);y<i&&o.push({dist:y,range1:p,range2:g})}function wd(o,i,a,l,d=1/0){let p=Math.min(l.distance(o[0],a[0][0]),d);if(0===p)return p;const g=new ec([{dist:0,range1:[0,o.length-1],range2:[0,0]}],Ah),y=i?tc:Eu,x=ic(a);for(;g.length;){const C=g.pop();if(C.dist>=p)continue;const D=C.range1;if(bd(D)<=y){if(!$o(D,o.length))return NaN;if(i){const M=ws(o,D,a,l);if(0===(p=Math.min(p,M)))return p}else for(let M=D[0];M<=D[1];++M){const k=zc(o[M],a,l);if(0===(p=Math.min(p,k)))return p}}else{const M=Du(D,i);if(null!==M[0]){const k=Jt(ze(o,M[0]),x,l);k<p&&g.push({dist:k,range1:M[0],range2:[0,0]})}if(null!==M[1]){const k=Jt(ze(o,M[1]),x,l);k<p&&g.push({dist:k,range1:M[1],range2:[0,0]})}}}return p}function Wa(o,i,a,l,d,p=1/0){let g=Math.min(p,d.distance(o[0],a[0]));if(0===g)return g;const y=new ec([{dist:0,range1:[0,o.length-1],range2:[0,a.length-1]}],Ah),x=i?tc:Eu,C=l?tc:Eu;for(;y.length;){const D=y.pop();if(D.dist>=g)continue;const M=D.range1,k=D.range2;if(bd(M)<=x&&bd(k)<=C){if(!$o(M,o.length)||!$o(k,a.length))return NaN;if(i&&l?g=Math.min(g,Wf(o,M,a,k,d)):i||l?i&&!l?g=Math.min(g,Ih(a,k,o,M,d)):!i&&l&&(g=Math.min(g,Ih(o,M,a,k,d))):g=Math.min(g,_a(o,M,a,k,d)),0===g)return g}else{const P=Du(M,i),F=Du(k,l);Cl(y,g,d,o,a,P[0],F[0]),Cl(y,g,d,o,a,P[0],F[1]),Cl(y,g,d,o,a,P[1],F[0]),Cl(y,g,d,o,a,P[1],F[1])}}return g}function Su(o,i,a,l,d=1/0){let p=d;const g=ze(o,[0,o.length-1]);for(const y of a)if(!(p!==1/0&&Jt(g,ze(y,[0,y.length-1]),l)>=p)&&(p=Math.min(p,Wa(o,i,y,!0,l,p)),0===p))return p;return p}function Cs(o,i,a,l,d=1/0){let p=d;const g=ze(o,[0,o.length-1]);for(const y of a){if(p!==1/0&&Jt(g,ic(y),l)>=p)continue;const x=wd(o,i,y,l,p);if(isNaN(x))return x;if(0===(p=Math.min(p,x)))return p}return p}function El(o){return"Point"===o||"MultiPoint"===o||"LineString"===o||"MultiLineString"===o||"Polygon"===o||"MultiPolygon"===o}class oc{constructor(i,a){this.type=pt,this.geojson=i,this.geometries=a}static parse(i,a){if(2!==i.length)return a.error(`'distance' expression requires either one argument, but found ' ${i.length-1} instead.`);if(vu(i[1])){const l=i[1];if("FeatureCollection"===l.type){for(let d=0;d<l.features.length;++d)if(El(l.features[d].geometry.type))return new oc(l,l.features[d].geometry)}else if("Feature"===l.type){if(El(l.geometry.type))return new oc(l,l.geometry)}else if(El(l.type))return new oc(l,l)}return a.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(i){const a=i.geometry(),l=i.canonicalID();if(null!=a&&null!=l){if("Point"===i.geometryType())return function(d,p,g){const y=[];for(const C of d)for(const D of C)y.push(rc(D,p));const x=new Jl(y[0][1],"meters");return"Point"===g.type||"MultiPoint"===g.type||"LineString"===g.type?Wa(y,!1,"Point"===g.type?[g.coordinates]:g.coordinates,"LineString"===g.type,x):"MultiLineString"===g.type?Su(y,!1,g.coordinates,x):"Polygon"===g.type||"MultiPolygon"===g.type?Cs(y,!1,"Polygon"===g.type?[g.coordinates]:g.coordinates,x):null}(a,l,this.geometries);if("LineString"===i.geometryType())return function(d,p,g){const y=[];for(const C of d){const D=[];for(const M of C)D.push(rc(M,p));y.push(D)}const x=new Jl(y[0][0][1],"meters");if("Point"===g.type||"MultiPoint"===g.type||"LineString"===g.type)return Su("Point"===g.type?[g.coordinates]:g.coordinates,"LineString"===g.type,y,x);if("MultiLineString"===g.type){let C=1/0;for(let D=0;D<g.coordinates.length;D++){const M=Su(g.coordinates[D],!0,y,x,C);if(isNaN(M))return M;if(0===(C=Math.min(C,M)))return C}return C}if("Polygon"===g.type||"MultiPolygon"===g.type){let C=1/0;for(let D=0;D<y.length;D++){const M=Cs(y[D],!0,"Polygon"===g.type?[g.coordinates]:g.coordinates,x,C);if(isNaN(M))return M;if(0===(C=Math.min(C,M)))return C}return C}return null}(a,l,this.geometries);if("Polygon"===i.geometryType())return function(d,p,g){const y=[];for(const C of function(D,M){const k=D.length;if(k<=1)return[D];const P=[];let F,B;for(let j=0;j<k;j++){const q=_d(D[j]);0!==q&&(D[j].area=Math.abs(q),void 0===B&&(B=q<0),B===q<0?(F&&P.push(F),F=[D[j]]):F.push(D[j]))}return F&&P.push(F),P}(d)){const D=[];for(let M=0;M<C.length;++M)D.push(Tu(C[M],p));y.push(D)}const x=new Jl(y[0][0][0][1],"meters");if("Point"===g.type||"MultiPoint"===g.type||"LineString"===g.type)return Cs("Point"===g.type?[g.coordinates]:g.coordinates,"LineString"===g.type,y,x);if("MultiLineString"===g.type){let C=1/0;for(let D=0;D<g.coordinates.length;D++){const M=Cs(g.coordinates[D],!0,y,x,C);if(isNaN(M))return M;if(0===(C=Math.min(C,M)))return C}return C}return"Polygon"===g.type||"MultiPolygon"===g.type?function(C,D,M){let k=1/0;for(const P of C)for(const F of D){const B=ir(P,F,M,k);if(isNaN(B))return B;if(0===(k=Math.min(k,B)))return k}return k}("Polygon"===g.type?[g.coordinates]:g.coordinates,y,x):null}(a,l,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var Mu=oc;function Za(o){if(o instanceof ds&&("get"===o.name&&1===o.args.length||"feature-state"===o.name||"has"===o.name&&1===o.args.length||"properties"===o.name||"geometry-type"===o.name||"id"===o.name||/^filter-/.test(o.name))||o instanceof Mh||o instanceof Mu)return!1;let i=!0;return o.eachChild(a=>{i&&!Za(a)&&(i=!1)}),i}function Do(o){if(o instanceof ds&&"feature-state"===o.name)return!1;let i=!0;return o.eachChild(a=>{i&&!Do(a)&&(i=!1)}),i}function Vc(o){if(o instanceof ds&&"config"===o.name)return!1;let i=!0;return o.eachChild(a=>{i&&!Vc(a)&&(i=!1)}),i}function Ks(o,i){if(o instanceof ds&&i.indexOf(o.name)>=0)return!1;let a=!0;return o.eachChild(l=>{a&&!Ks(l,i)&&(a=!1)}),a}class Au{constructor(i,a){this.type=a.type,this.name=i,this.boundExpression=a}static parse(i,a){if(2!==i.length||"string"!=typeof i[1])return a.error("'var' expression requires exactly one string literal argument.");const l=i[1];return a.scope.has(l)?new Au(l,a.scope.get(l)):a.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Cd=Au;class jc{constructor(i,a=[],l,d=new bh,p=[],g,y){this.registry=i,this.path=a,this.key=a.map(x=>`[${x}]`).join(""),this.scope=d,this.errors=p,this.expectedType=l,this._scope=g,this.options=y}parse(i,a,l,d,p={}){return a||l?this.concat(a,l,d)._parse(i,p):this._parse(i,p)}_parse(i,a){function l(d,p,g){return"assert"===g?new Zn(p,[d]):"coerce"===g?new Oi(p,[d]):d}if(null!==i&&"string"!=typeof i&&"boolean"!=typeof i&&"number"!=typeof i||(i=["literal",i]),Array.isArray(i)){if(0===i.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d="string"==typeof i[0]?this.registry[i[0]]:void 0;if(d){let p=d.parse(i,this);if(!p)return null;if(this.expectedType){const g=this.expectedType,y=p.type;if("string"!==g.kind&&"number"!==g.kind&&"boolean"!==g.kind&&"object"!==g.kind&&"array"!==g.kind||"value"!==y.kind)if("color"!==g.kind&&"formatted"!==g.kind&&"resolvedImage"!==g.kind||"value"!==y.kind&&"string"!==y.kind){if(this.checkSubtype(g,y))return null}else p=l(p,g,a.typeAnnotation||"coerce");else p=l(p,g,a.typeAnnotation||"assert")}if(!(p instanceof bu)&&"resolvedImage"!==p.type.kind&&Ed(p)){const g=new gd(this._scope,this.options);try{p=new bu(p.type,p.evaluate(g))}catch(y){return this.error(y.message),null}}return p}return Oi.parse(["to-array",i],this)}return this.error(void 0===i?"'undefined' value invalid. Use null instead.":"object"==typeof i?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,a,l){const d="number"==typeof i?this.path.concat(i):this.path,p=l?this.scope.concat(l):this.scope;return new jc(this.registry,d,a||null,p,this.errors,this._scope,this.options)}error(i,...a){const l=`${this.key}${a.map(d=>`[${d}]`).join("")}`;this.errors.push(new ui(l,i))}checkSubtype(i,a){const l=Fc(i,a);return l&&this.error(l),l}}var Iu=jc;function Ed(o){if(o instanceof Cd)return Ed(o.boundExpression);if(o instanceof ds&&"error"===o.name||o instanceof ds&&"config"===o.name||o instanceof xl||o instanceof Mh||o instanceof Mu)return!1;const i=o instanceof Oi||o instanceof Zn;let a=!0;return o.eachChild(l=>{a=i?a&&Ed(l):a&&l instanceof bu}),!!a&&Za(o)&&Ks(o,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light"])}function ku(o,i){const a=o.length-1;let l,d,p=0,g=a,y=0;for(;p<=g;)if(y=Math.floor((p+g)/2),l=o[y],d=o[y+1],l<=i){if(y===a||i<d)return y;p=y+1}else{if(!(l>i))throw new Or("Input is not a number.");g=y-1}return 0}class rs{constructor(i,a,l){this.type=i,this.input=a,this.labels=[],this.outputs=[];for(const[d,p]of l)this.labels.push(d),this.outputs.push(p)}static parse(i,a){if(i.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return a.error("Expected an even number of arguments.");const l=a.parse(i[1],1,pt);if(!l)return null;const d=[];let p=null;a.expectedType&&"value"!==a.expectedType.kind&&(p=a.expectedType);for(let g=1;g<i.length;g+=2){const y=1===g?-1/0:i[g],x=i[g+1],C=g,D=g+1;if("number"!=typeof y)return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(d.length&&d[d.length-1][0]>=y)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const M=a.parse(x,D,p);if(!M)return null;p=p||M.type,d.push([y,M])}return new rs(p,l,d)}evaluate(i){const a=this.labels,l=this.outputs;if(1===a.length)return l[0].evaluate(i);const d=this.input.evaluate(i);if(d<=a[0])return l[0].evaluate(i);const p=a.length;return d>=a[p-1]?l[p-1].evaluate(i):l[ku(a,d)].evaluate(i)}eachChild(i){i(this.input);for(const a of this.outputs)i(a)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){const i=["step",this.input.serialize()];for(let a=0;a<this.labels.length;a++)a>0&&i.push(this.labels[a]),i.push(this.outputs[a].serialize());return i}}var kh=rs;function oi(o,i,a){return o*(1-a)+i*a}function Dd(o,i,a){return o.map((l,d)=>oi(l,i[d],a))}var Ru=Object.freeze({__proto__:null,array:Dd,color:function(o,i,a){return new Pi(oi(o.r,i.r,a),oi(o.g,i.g,a),oi(o.b,i.b,a),oi(o.a,i.a,a))},number:oi});const Rh=4/29,Uc=6/29,Zf=3*Uc*Uc,Yf=Uc*Uc*Uc,Ci=Math.PI/180,Mm=180/Math.PI;function Ph(o){return o>Yf?Math.pow(o,1/3):o/Zf+Rh}function Oh(o){return o>Uc?o*o*o:Zf*(o-Rh)}function Ji(o){return 255*(o<=.0031308?12.92*o:1.055*Math.pow(o,1/2.4)-.055)}function Td(o){return(o/=255)<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function Fh(o){const i=Td(o.r),a=Td(o.g),l=Td(o.b),d=Ph((.4124564*i+.3575761*a+.1804375*l)/.95047),p=Ph((.2126729*i+.7151522*a+.072175*l)/1);return{l:116*p-16,a:500*(d-p),b:200*(p-Ph((.0193339*i+.119192*a+.9503041*l)/1.08883)),alpha:o.a}}function Bn(o){let i=(o.l+16)/116,a=isNaN(o.a)?i:i+o.a/500,l=isNaN(o.b)?i:i-o.b/200;return i=1*Oh(i),a=.95047*Oh(a),l=1.08883*Oh(l),new Pi(Ji(3.2404542*a-1.5371385*i-.4985314*l),Ji(-.969266*a+1.8760108*i+.041556*l),Ji(.0556434*a-.2040259*i+1.0572252*l),o.alpha)}function vo(o,i,a){const l=i-o;return o+a*(l>180||l<-180?l-360*Math.round(l/360):l)}const Fi={forward:Fh,reverse:Bn,interpolate:function(o,i,a){return{l:oi(o.l,i.l,a),a:oi(o.a,i.a,a),b:oi(o.b,i.b,a),alpha:oi(o.alpha,i.alpha,a)}}},kr={forward:function(o){const{l:i,a,b:l}=Fh(o),d=Math.atan2(l,a)*Mm;return{h:d<0?d+360:d,c:Math.sqrt(a*a+l*l),l:i,alpha:o.a}},reverse:function(o){const i=o.h*Ci,a=o.c;return Bn({l:o.l,a:Math.cos(i)*a,b:Math.sin(i)*a,alpha:o.alpha})},interpolate:function(o,i,a){return{h:vo(o.h,i.h,a),c:oi(o.c,i.c,a),l:oi(o.l,i.l,a),alpha:oi(o.alpha,i.alpha,a)}}};var Go=Object.freeze({__proto__:null,hcl:kr,lab:Fi});class Ya{constructor(i,a,l,d,p){this.type=i,this.operator=a,this.interpolation=l,this.input=d,this.labels=[],this.outputs=[];for(const[g,y]of p)this.labels.push(g),this.outputs.push(y)}static interpolationFactor(i,a,l,d){let p=0;if("exponential"===i.name)p=to(a,i.base,l,d);else if("linear"===i.name)p=to(a,1,l,d);else if("cubic-bezier"===i.name){const g=i.controlPoints;p=new nt(g[0],g[1],g[2],g[3]).solve(to(a,1,l,d))}return p}static parse(i,a){let[l,d,p,...g]=i;if(!Array.isArray(d)||0===d.length)return a.error("Expected an interpolation type expression.",1);if("linear"===d[0])d={name:"linear"};else if("exponential"===d[0]){const C=d[1];if("number"!=typeof C)return a.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:C}}else{if("cubic-bezier"!==d[0])return a.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const C=d.slice(1);if(4!==C.length||C.some(D=>"number"!=typeof D||D<0||D>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:C}}}if(i.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(p=a.parse(p,2,pt),!p)return null;const y=[];let x=null;"interpolate-hcl"===l||"interpolate-lab"===l?x=Ii:a.expectedType&&"value"!==a.expectedType.kind&&(x=a.expectedType);for(let C=0;C<g.length;C+=2){const D=g[C],M=g[C+1],k=C+3,P=C+4;if("number"!=typeof D)return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(y.length&&y[y.length-1][0]>=D)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',k);const F=a.parse(M,P,x);if(!F)return null;x=x||F.type,y.push([D,F])}return"number"===x.kind||"color"===x.kind||"array"===x.kind&&"number"===x.itemType.kind&&"number"==typeof x.N?new Ya(x,l,d,p,y):a.error(`Type ${Qi(x)} is not interpolatable.`)}evaluate(i){const a=this.labels,l=this.outputs;if(1===a.length)return l[0].evaluate(i);const d=this.input.evaluate(i);if(d<=a[0])return l[0].evaluate(i);const p=a.length;if(d>=a[p-1])return l[p-1].evaluate(i);const g=ku(a,d),y=Ya.interpolationFactor(this.interpolation,d,a[g],a[g+1]),x=l[g].evaluate(i),C=l[g+1].evaluate(i);return"interpolate"===this.operator?Ru[this.type.kind.toLowerCase()](x,C,y):"interpolate-hcl"===this.operator?kr.reverse(kr.interpolate(kr.forward(x),kr.forward(C),y)):Fi.reverse(Fi.interpolate(Fi.forward(x),Fi.forward(C),y))}eachChild(i){i(this.input);for(const a of this.outputs)i(a)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){let i;i="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const a=[this.operator,i,this.input.serialize()];for(let l=0;l<this.labels.length;l++)a.push(this.labels[l],this.outputs[l].serialize());return a}}function to(o,i,a,l){const d=l-a,p=o-a;return 0===d?0:1===i?p/d:(Math.pow(i,p)-1)/(Math.pow(i,d)-1)}var Ps=Ya;class ya{constructor(i,a){this.type=i,this.args=a}static parse(i,a){if(i.length<2)return a.error("Expectected at least one argument.");let l=null;const d=a.expectedType;d&&"value"!==d.kind&&(l=d);const p=[];for(const y of i.slice(1)){const x=a.parse(y,1+p.length,l,void 0,{typeAnnotation:"omit"});if(!x)return null;l=l||x.type,p.push(x)}const g=d&&p.some(y=>Fc(d,y.type));return new ya(g?jn:l,p)}evaluate(i){let a,l=null,d=0;for(const p of this.args){if(d++,l=p.evaluate(i),l&&l instanceof Io&&!l.available&&(a||(a=l),l=null,d===this.args.length))return a;if(null!==l)break}return l}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=["coalesce"];return this.eachChild(a=>{i.push(a.serialize())}),i}}var Pu=ya;class Lh{constructor(i,a){this.type=a.type,this.bindings=[].concat(i),this.result=a}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const a of this.bindings)i(a[1]);i(this.result)}static parse(i,a){if(i.length<4)return a.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const l=[];for(let p=1;p<i.length-1;p+=2){const g=i[p];if("string"!=typeof g)return a.error(`Expected string, but found ${typeof g} instead.`,p);if(/[^a-zA-Z0-9_]/.test(g))return a.error("Variable names must contain only alphanumeric characters or '_'.",p);const y=a.parse(i[p+1],p+1);if(!y)return null;l.push([g,y])}const d=a.parse(i[i.length-1],i.length-1,a.expectedType,l);return d?new Lh(l,d):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[a,l]of this.bindings)i.push(a,l.serialize());return i.push(this.result.serialize()),i}}var Xf=Lh;class Vr{constructor(i,a,l){this.type=i,this.index=a,this.input=l}static parse(i,a){if(3!==i.length)return a.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const l=a.parse(i[1],1,pt),d=a.parse(i[2],2,$n(a.expectedType||jn));return l&&d?new Vr(d.type.itemType,l,d):null}evaluate(i){const a=this.index.evaluate(i),l=this.input.evaluate(i);if(a<0)throw new Or(`Array index out of bounds: ${a} < 0.`);if(a>=l.length)throw new Or(`Array index out of bounds: ${a} > ${l.length-1}.`);if(a!==Math.floor(a))throw new Or(`Array index must be an integer, but found ${a} instead.`);return l[a]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var kn=Vr;class yi{constructor(i,a){this.type=Di,this.needle=i,this.haystack=a}static parse(i,a){if(3!==i.length)return a.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const l=a.parse(i[1],1,jn),d=a.parse(i[2],2,jn);return l&&d?hd(l.type,[Di,hi,pt,Ha,jn])?new yi(l,d):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qi(l.type)} instead`):null}evaluate(i){const a=this.needle.evaluate(i),l=this.haystack.evaluate(i);if(null==l)return!1;if(!yt(a,["boolean","string","number","null"]))throw new Or(`Expected first argument to be of type boolean, string, number or null, but found ${Qi(yo(a))} instead.`);if(!yt(l,["string","array"]))throw new Or(`Expected second argument to be of type array or string, but found ${Qi(yo(l))} instead.`);return l.indexOf(a)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Rr=yi;class Fo{constructor(i,a,l){this.type=pt,this.needle=i,this.haystack=a,this.fromIndex=l}static parse(i,a){if(i.length<=2||i.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const l=a.parse(i[1],1,jn),d=a.parse(i[2],2,jn);if(!l||!d)return null;if(!hd(l.type,[Di,hi,pt,Ha,jn]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qi(l.type)} instead`);if(4===i.length){const p=a.parse(i[3],3,pt);return p?new Fo(l,d,p):null}return new Fo(l,d)}evaluate(i){const a=this.needle.evaluate(i),l=this.haystack.evaluate(i);if(!yt(a,["boolean","string","number","null"]))throw new Or(`Expected first argument to be of type boolean, string, number or null, but found ${Qi(yo(a))} instead.`);if(!yt(l,["string","array"]))throw new Or(`Expected second argument to be of type array or string, but found ${Qi(yo(l))} instead.`);if(this.fromIndex){const d=this.fromIndex.evaluate(i);return l.indexOf(a,d)}return l.indexOf(a)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Hc=Fo;class Pr{constructor(i,a,l,d,p,g){this.inputType=i,this.type=a,this.input=l,this.cases=d,this.outputs=p,this.otherwise=g}static parse(i,a){if(i.length<5)return a.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return a.error("Expected an even number of arguments.");let l,d;a.expectedType&&"value"!==a.expectedType.kind&&(d=a.expectedType);const p={},g=[];for(let C=2;C<i.length-1;C+=2){let D=i[C];const M=i[C+1];Array.isArray(D)||(D=[D]);const k=a.concat(C);if(0===D.length)return k.error("Expected at least one branch label.");for(const F of D){if("number"!=typeof F&&"string"!=typeof F)return k.error("Branch labels must be numbers or strings.");if("number"==typeof F&&Math.abs(F)>Number.MAX_SAFE_INTEGER)return k.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof F&&Math.floor(F)!==F)return k.error("Numeric branch labels must be integer values.");if(l){if(k.checkSubtype(l,yo(F)))return null}else l=yo(F);if(void 0!==p[String(F)])return k.error("Branch labels must be unique.");p[String(F)]=g.length}const P=a.parse(M,C,d);if(!P)return null;d=d||P.type,g.push(P)}const y=a.parse(i[1],1,jn);if(!y)return null;const x=a.parse(i[i.length-1],i.length-1,d);return x?"value"!==y.type.kind&&a.concat(1).checkSubtype(l,y.type)?null:new Pr(l,d,y,p,g,x):null}evaluate(i){const a=this.input.evaluate(i);return(yo(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],a=Object.keys(this.cases).sort(),l=[],d={};for(const g of a){const y=d[this.cases[g]];void 0===y?(d[this.cases[g]]=l.length,l.push([this.cases[g],[g]])):l[y][1].push(g)}const p=g=>"number"===this.inputType.kind?Number(g):g;for(const[g,y]of l)i.push(1===y.length?p(y[0]):y.map(p)),i.push(this.outputs[g].serialize());return i.push(this.otherwise.serialize()),i}}var ac=Pr;class sr{constructor(i,a,l){this.type=i,this.branches=a,this.otherwise=l}static parse(i,a){if(i.length<4)return a.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return a.error("Expected an odd number of arguments.");let l;a.expectedType&&"value"!==a.expectedType.kind&&(l=a.expectedType);const d=[];for(let g=1;g<i.length-1;g+=2){const y=a.parse(i[g],g,Di);if(!y)return null;const x=a.parse(i[g+1],g+1,l);if(!x)return null;d.push([y,x]),l=l||x.type}const p=a.parse(i[i.length-1],i.length-1,l);return p?new sr(l,d,p):null}evaluate(i){for(const[a,l]of this.branches)if(a.evaluate(i))return l.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[a,l]of this.branches)i(a),i(l);i(this.otherwise)}outputDefined(){return this.branches.every(([i,a])=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild(a=>{i.push(a.serialize())}),i}}var Tl=sr;class va{constructor(i,a,l,d){this.type=i,this.input=a,this.beginIndex=l,this.endIndex=d}static parse(i,a){if(i.length<=2||i.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const l=a.parse(i[1],1,jn),d=a.parse(i[2],2,pt);if(!l||!d)return null;if(!hd(l.type,[$n(jn),hi,jn]))return a.error(`Expected first argument to be of type array or string, but found ${Qi(l.type)} instead`);if(4===i.length){const p=a.parse(i[3],3,pt);return p?new va(l.type,l,d,p):null}return new va(l.type,l,d)}evaluate(i){const a=this.input.evaluate(i),l=this.beginIndex.evaluate(i);if(!yt(a,["string","array"]))throw new Or(`Expected first argument to be of type array or string, but found ${Qi(yo(a))} instead.`);if(this.endIndex){const d=this.endIndex.evaluate(i);return a.slice(l,d)}return a.slice(l)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var wi=va;function $c(o,i){return"=="===o||"!="===o?"boolean"===i.kind||"string"===i.kind||"number"===i.kind||"null"===i.kind||"value"===i.kind:"string"===i.kind||"number"===i.kind||"value"===i.kind}function Sd(o,i,a,l){return 0===l.compare(i,a)}function Qs(o,i,a){const l="=="!==o&&"!="!==o;return class rN{constructor(p,g,y){this.type=Di,this.lhs=p,this.rhs=g,this.collator=y,this.hasUntypedArgument="value"===p.type.kind||"value"===g.type.kind}static parse(p,g){if(3!==p.length&&4!==p.length)return g.error("Expected two or three arguments.");const y=p[0];let x=g.parse(p[1],1,jn);if(!x)return null;if(!$c(y,x.type))return g.concat(1).error(`"${y}" comparisons are not supported for type '${Qi(x.type)}'.`);let C=g.parse(p[2],2,jn);if(!C)return null;if(!$c(y,C.type))return g.concat(2).error(`"${y}" comparisons are not supported for type '${Qi(C.type)}'.`);if(x.type.kind!==C.type.kind&&"value"!==x.type.kind&&"value"!==C.type.kind)return g.error(`Cannot compare types '${Qi(x.type)}' and '${Qi(C.type)}'.`);l&&("value"===x.type.kind&&"value"!==C.type.kind?x=new Zn(C.type,[x]):"value"!==x.type.kind&&"value"===C.type.kind&&(C=new Zn(x.type,[C])));let D=null;if(4===p.length){if("string"!==x.type.kind&&"string"!==C.type.kind&&"value"!==x.type.kind&&"value"!==C.type.kind)return g.error("Cannot use collator to compare non-string types.");if(D=g.parse(p[3],3,ks),!D)return null}return new rN(x,C,D)}evaluate(p){const g=this.lhs.evaluate(p),y=this.rhs.evaluate(p);if(l&&this.hasUntypedArgument){const x=yo(g),C=yo(y);if(x.kind!==C.kind||"string"!==x.kind&&"number"!==x.kind)throw new Or(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${x.kind}, ${C.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const x=yo(g),C=yo(y);if("string"!==x.kind||"string"!==C.kind)return i(p,g,y)}return this.collator?a(p,g,y,this.collator.evaluate(p)):i(p,g,y)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}serialize(){const p=[o];return this.eachChild(g=>{p.push(g.serialize())}),p}}}const no=Qs("==",function(o,i,a){return i===a},Sd),lc=Qs("!=",function(o,i,a){return i!==a},function(o,i,a,l){return!Sd(0,i,a,l)}),qo=Qs("<",function(o,i,a){return i<a},function(o,i,a,l){return l.compare(i,a)<0}),Es=Qs(">",function(o,i,a){return i>a},function(o,i,a,l){return l.compare(i,a)>0}),Ui=Qs("<=",function(o,i,a){return i<=a},function(o,i,a,l){return l.compare(i,a)<=0}),Kf=Qs(">=",function(o,i,a){return i>=a},function(o,i,a,l){return l.compare(i,a)>=0});class ba{constructor(i,a,l,d,p,g){this.type=hi,this.number=i,this.locale=a,this.currency=l,this.unit=d,this.minFractionDigits=p,this.maxFractionDigits=g}static parse(i,a){if(3!==i.length)return a.error("Expected two arguments.");const l=a.parse(i[1],1,pt);if(!l)return null;const d=i[2];if("object"!=typeof d||Array.isArray(d))return a.error("NumberFormat options argument must be an object.");let p=null;if(d.locale&&(p=a.parse(d.locale,1,hi),!p))return null;let g=null;if(d.currency&&(g=a.parse(d.currency,1,hi),!g))return null;let y=null;if(d.unit&&(y=a.parse(d.unit,1,hi),!y))return null;let x=null;if(d["min-fraction-digits"]&&(x=a.parse(d["min-fraction-digits"],1,pt),!x))return null;let C=null;return d["max-fraction-digits"]&&(C=a.parse(d["max-fraction-digits"],1,pt),!C)?null:new ba(l,p,g,y,x,C)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(i):void 0,unit:this.unit?this.unit.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.unit&&i(this.unit),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.unit&&(i.unit=this.unit.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class Js{constructor(i){this.type=pt,this.input=i}static parse(i,a){if(2!==i.length)return a.error(`Expected 1 argument, but found ${i.length-1} instead.`);const l=a.parse(i[1],1);return l?"array"!==l.type.kind&&"string"!==l.type.kind&&"value"!==l.type.kind?a.error(`Expected argument of type string or array, but found ${Qi(l.type)} instead.`):new Js(l):null}evaluate(i){const a=this.input.evaluate(i);if("string"==typeof a||Array.isArray(a))return a.length;throw new Or(`Expected value to be of type string or array, but found ${Qi(yo(a))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild(a=>{i.push(a.serialize())}),i}}function Xa(o){return function(){o=1831565813+(o|=0)|0;let i=Math.imul(o^o>>>15,1|o);return i=i+Math.imul(i^i>>>7,61|i)^i,((i^i>>>14)>>>0)/4294967296}}const cc={"==":no,"!=":lc,">":Es,"<":qo,">=":Kf,"<=":Ui,array:Zn,at:kn,boolean:Zn,case:Tl,coalesce:Pu,collator:xl,format:pd,image:md,in:Rr,"index-of":Hc,interpolate:Ps,"interpolate-hcl":Ps,"interpolate-lab":Ps,length:Js,let:Xf,literal:bu,match:ac,number:Zn,"number-format":ba,object:Zn,slice:wi,step:kh,string:Zn,"to-boolean":Oi,"to-color":Oi,"to-number":Oi,"to-string":Oi,var:Cd,within:Mh,distance:Mu};function Li(o,[i,a,l,d]){i=i.evaluate(o),a=a.evaluate(o),l=l.evaluate(o);const p=d?d.evaluate(o):1,g=Uf(i,a,l,p);if(g)throw new Or(g);return new Pi(i/255*p,a/255*p,l/255*p,p)}function Am(o,[i,a,l,d]){i=i.evaluate(o),a=a.evaluate(o),l=l.evaluate(o);const p=d?d.evaluate(o):1,g=(D=a,M=l,k=p,"number"==typeof(C=i)&&C>=0&&C<=360?"number"==typeof D&&D>=0&&D<=100&&"number"==typeof M&&M>=0&&M<=100?void 0===k||"number"==typeof k&&k>=0&&k<=1?null:`Invalid hsla value [${[C,D,M,k].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${("number"==typeof k?[C,D,M,k]:[C,D,M]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${("number"==typeof k?[C,D,M,k]:[C,D,M]).join(", ")}]: 'h' must be between 0 and 360.`);var C,D,M,k;if(g)throw new Or(g);const y=`hsla(${i}, ${a}%, ${l}%, ${p})`,x=Pi.parse(y);if(!x)throw new Or(`Failed to parse HSLA color: ${y}`);return x}function Ou(o,i){return o in i}function Ka(o,i){const a=i[o];return void 0===a?null:a}function hs(o,i){switch(o){case"string":return String(i);case"number":return+i;case"boolean":return!!i;case"color":return Pi.parse(i)}return i}function Q(o,i,a,l){return void 0!==l&&(o=l*Math.round(o/l)),void 0!==i&&o<i&&(o=i),void 0!==a&&o>a&&(o=a),o}function L(o,i,a){i=[i,a,o.scope].filter(Boolean).join("\x1f");const l=o.getConfig(i);if(!l)return null;const{type:d,value:p,values:g,minValue:y,maxValue:x,stepValue:C}=l,D=l.default.evaluate(o);let M=D;if(p){const k=o.scope;o.scope=(k||"").split("\x1f").slice(1).join("\x1f"),M=p.evaluate(o),o.scope=k}return d&&(M=hs(d,M)),void 0!==p&&void 0!==M&&g&&!g.includes(M)&&(M=D,d&&(M=hs(d,M))),void 0===M||void 0===y&&void 0===x&&void 0===C||("number"==typeof M?M=Q(M,y,x,C):Array.isArray(M)&&(M=M.map(k=>"number"==typeof k?Q(k,y,x,C):k))),M}function U(o){return{type:o}}ds.register(cc,{error:[{kind:"error"},[hi],(o,[i])=>{throw new Or(i.evaluate(o))}],typeof:[hi,[jn],(o,[i])=>Qi(yo(i.evaluate(o)))],"to-rgba":[$n(pt,4),[Ii],(o,[i])=>i.evaluate(o).toArray()],rgb:[Ii,[pt,pt,pt],Li],rgba:[Ii,[pt,pt,pt,pt],Li],hsl:[Ii,[pt,pt,pt],Am],hsla:[Ii,[pt,pt,pt,pt],Am],has:{type:Di,overloads:[[[hi],(o,[i])=>Ou(i.evaluate(o),o.properties())],[[hi,xs],(o,[i,a])=>Ou(i.evaluate(o),a.evaluate(o))]]},get:{type:jn,overloads:[[[hi],(o,[i])=>Ka(i.evaluate(o),o.properties())],[[hi,xs],(o,[i,a])=>Ka(i.evaluate(o),a.evaluate(o))]]},config:{type:jn,overloads:[[[hi],(o,[i])=>L(o,i.evaluate(o))],[[hi,hi],(o,[i,a])=>L(o,i.evaluate(o),a.evaluate(o))]]},"feature-state":[jn,[hi],(o,[i])=>Ka(i.evaluate(o),o.featureState||{})],properties:[xs,[],o=>o.properties()],"geometry-type":[hi,[],o=>o.geometryType()],id:[jn,[],o=>o.id()],zoom:[pt,[],o=>o.globals.zoom],pitch:[pt,[],o=>o.globals.pitch||0],"distance-from-center":[pt,[],o=>o.distanceFromCenter()],"measure-light":[pt,[hi],(o,[i])=>o.measureLight(i.evaluate(o))],"heatmap-density":[pt,[],o=>o.globals.heatmapDensity||0],"line-progress":[pt,[],o=>o.globals.lineProgress||0],"raster-value":[pt,[],o=>o.globals.rasterValue||0],"sky-radial-progress":[pt,[],o=>o.globals.skyRadialProgress||0],accumulated:[jn,[],o=>void 0===o.globals.accumulated?null:o.globals.accumulated],"+":[pt,U(pt),(o,i)=>{let a=0;for(const l of i)a+=l.evaluate(o);return a}],"*":[pt,U(pt),(o,i)=>{let a=1;for(const l of i)a*=l.evaluate(o);return a}],"-":{type:pt,overloads:[[[pt,pt],(o,[i,a])=>i.evaluate(o)-a.evaluate(o)],[[pt],(o,[i])=>-i.evaluate(o)]]},"/":[pt,[pt,pt],(o,[i,a])=>i.evaluate(o)/a.evaluate(o)],"%":[pt,[pt,pt],(o,[i,a])=>i.evaluate(o)%a.evaluate(o)],ln2:[pt,[],()=>Math.LN2],pi:[pt,[],()=>Math.PI],e:[pt,[],()=>Math.E],"^":[pt,[pt,pt],(o,[i,a])=>Math.pow(i.evaluate(o),a.evaluate(o))],sqrt:[pt,[pt],(o,[i])=>Math.sqrt(i.evaluate(o))],log10:[pt,[pt],(o,[i])=>Math.log(i.evaluate(o))/Math.LN10],ln:[pt,[pt],(o,[i])=>Math.log(i.evaluate(o))],log2:[pt,[pt],(o,[i])=>Math.log(i.evaluate(o))/Math.LN2],sin:[pt,[pt],(o,[i])=>Math.sin(i.evaluate(o))],cos:[pt,[pt],(o,[i])=>Math.cos(i.evaluate(o))],tan:[pt,[pt],(o,[i])=>Math.tan(i.evaluate(o))],asin:[pt,[pt],(o,[i])=>Math.asin(i.evaluate(o))],acos:[pt,[pt],(o,[i])=>Math.acos(i.evaluate(o))],atan:[pt,[pt],(o,[i])=>Math.atan(i.evaluate(o))],min:[pt,U(pt),(o,i)=>Math.min(...i.map(a=>a.evaluate(o)))],max:[pt,U(pt),(o,i)=>Math.max(...i.map(a=>a.evaluate(o)))],abs:[pt,[pt],(o,[i])=>Math.abs(i.evaluate(o))],round:[pt,[pt],(o,[i])=>{const a=i.evaluate(o);return a<0?-Math.round(-a):Math.round(a)}],floor:[pt,[pt],(o,[i])=>Math.floor(i.evaluate(o))],ceil:[pt,[pt],(o,[i])=>Math.ceil(i.evaluate(o))],"filter-==":[Di,[hi,jn],(o,[i,a])=>o.properties()[i.value]===a.value],"filter-id-==":[Di,[jn],(o,[i])=>o.id()===i.value],"filter-type-==":[Di,[hi],(o,[i])=>o.geometryType()===i.value],"filter-<":[Di,[hi,jn],(o,[i,a])=>{const l=o.properties()[i.value],d=a.value;return typeof l==typeof d&&l<d}],"filter-id-<":[Di,[jn],(o,[i])=>{const a=o.id(),l=i.value;return typeof a==typeof l&&a<l}],"filter->":[Di,[hi,jn],(o,[i,a])=>{const l=o.properties()[i.value],d=a.value;return typeof l==typeof d&&l>d}],"filter-id->":[Di,[jn],(o,[i])=>{const a=o.id(),l=i.value;return typeof a==typeof l&&a>l}],"filter-<=":[Di,[hi,jn],(o,[i,a])=>{const l=o.properties()[i.value],d=a.value;return typeof l==typeof d&&l<=d}],"filter-id-<=":[Di,[jn],(o,[i])=>{const a=o.id(),l=i.value;return typeof a==typeof l&&a<=l}],"filter->=":[Di,[hi,jn],(o,[i,a])=>{const l=o.properties()[i.value],d=a.value;return typeof l==typeof d&&l>=d}],"filter-id->=":[Di,[jn],(o,[i])=>{const a=o.id(),l=i.value;return typeof a==typeof l&&a>=l}],"filter-has":[Di,[jn],(o,[i])=>i.value in o.properties()],"filter-has-id":[Di,[],o=>null!==o.id()&&void 0!==o.id()],"filter-type-in":[Di,[$n(hi)],(o,[i])=>i.value.indexOf(o.geometryType())>=0],"filter-id-in":[Di,[$n(jn)],(o,[i])=>i.value.indexOf(o.id())>=0],"filter-in-small":[Di,[hi,$n(jn)],(o,[i,a])=>a.value.indexOf(o.properties()[i.value])>=0],"filter-in-large":[Di,[hi,$n(jn)],(o,[i,a])=>function(l,d,p,g){for(;p<=g;){const y=p+g>>1;if(d[y]===l)return!0;d[y]>l?g=y-1:p=y+1}return!1}(o.properties()[i.value],a.value,0,a.value.length-1)],all:{type:Di,overloads:[[[Di,Di],(o,[i,a])=>i.evaluate(o)&&a.evaluate(o)],[U(Di),(o,i)=>{for(const a of i)if(!a.evaluate(o))return!1;return!0}]]},any:{type:Di,overloads:[[[Di,Di],(o,[i,a])=>i.evaluate(o)||a.evaluate(o)],[U(Di),(o,i)=>{for(const a of i)if(a.evaluate(o))return!0;return!1}]]},"!":[Di,[Di],(o,[i])=>!i.evaluate(o)],"is-supported-script":[Di,[hi],(o,[i])=>{const a=o.globals&&o.globals.isSupportedScript;return!a||a(i.evaluate(o))}],upcase:[hi,[hi],(o,[i])=>i.evaluate(o).toUpperCase()],downcase:[hi,[hi],(o,[i])=>i.evaluate(o).toLowerCase()],concat:[hi,U(jn),(o,i)=>i.map(a=>$a(a.evaluate(o))).join("")],"resolved-locale":[hi,[ks],(o,[i])=>i.evaluate(o).resolvedLocale()],random:[pt,[pt,pt,jn],(o,i)=>{const[a,l,d]=i.map(g=>g.evaluate(o));if(a>l||a===l)return a;let p;if("string"==typeof d)p=function(g){let y=0;if(0===g.length)return y;for(let x=0;x<g.length;x++)y=(y<<5)-y+g.charCodeAt(x),y&=y;return y}(d);else{if("number"!=typeof d)throw new Or(`Invalid seed input: ${d}`);p=d}return a+Xa(p)()*(l-a)}]});var X=cc;function Ae(o){return{result:"success",value:o}}function _t(o){return{result:"error",value:o}}function yn(o,i){return!!o&&!!o.parameters&&o.parameters.indexOf(i)>-1}function fi(o){return"data-driven"===o["property-type"]}function pi(o){return yn(o.expression,"measure-light")}function Cr(o){return yn(o.expression,"zoom")}function Lo(o){return!!o.expression&&o.expression.interpolated}function Md(o){return"object"==typeof o&&null!==o&&!Array.isArray(o)}function Nv(o){return o}function I_(o,i){const a="color"===i.type,l=o.stops&&"object"==typeof o.stops[0][0],d=l||!(l||void 0!==o.property),p=o.type||(Lo(i)?"exponential":"interval");if(a&&((o=Xs({},o)).stops&&(o.stops=o.stops.map(C=>[C[0],Pi.parse(C[1])])),o.default=Pi.parse(o.default?o.default:i.default)),o.colorSpace&&"rgb"!==o.colorSpace&&!Go[o.colorSpace])throw new Error(`Unknown color space: ${o.colorSpace}`);let g,y,x;if("exponential"===p)g=Jf;else if("interval"===p)g=ea;else if("categorical"===p){g=Qf,y=Object.create(null);for(const C of o.stops)y[C[0]]=C[1];x=typeof o.stops[0][0]}else{if("identity"!==p)throw new Error(`Unknown function type "${p}"`);g=y1}if(l){const C={},D=[];for(let P=0;P<o.stops.length;P++){const F=o.stops[P],B=F[0].zoom;void 0===C[B]&&(C[B]={zoom:B,type:o.type,property:o.property,default:o.default,stops:[]},D.push(B)),C[B].stops.push([F[0].value,F[1]])}const M=[];for(const P of D)M.push([C[P].zoom,I_(C[P],i)]);const k={name:"linear"};return{kind:"composite",interpolationType:k,interpolationFactor:Ps.interpolationFactor.bind(void 0,k),zoomStops:M.map(P=>P[0]),evaluate:({zoom:P},F)=>Jf({stops:M,base:o.base},i,P).evaluate(P,F)}}if(d){const C="exponential"===p?{name:"exponential",base:void 0!==o.base?o.base:1}:null;return{kind:"camera",interpolationType:C,interpolationFactor:Ps.interpolationFactor.bind(void 0,C),zoomStops:o.stops.map(D=>D[0]),evaluate:({zoom:D})=>g(o,i,D,y,x)}}return{kind:"source",evaluate(C,D){const M=D&&D.properties?D.properties[o.property]:void 0;return void 0===M?Fu(o.default,i.default):g(o,i,M,y,x)}}}function Fu(o,i,a){return void 0!==o?o:void 0!==i?i:void 0!==a?a:void 0}function Qf(o,i,a,l,d){return Fu(typeof a===d?l[a]:void 0,o.default,i.default)}function ea(o,i,a){if("number"!==ji(a))return Fu(o.default,i.default);const l=o.stops.length;if(1===l||a<=o.stops[0][0])return o.stops[0][1];if(a>=o.stops[l-1][0])return o.stops[l-1][1];const d=ku(o.stops.map(p=>p[0]),a);return o.stops[d][1]}function Jf(o,i,a){const l=void 0!==o.base?o.base:1;if("number"!==ji(a))return Fu(o.default,i.default);const d=o.stops.length;if(1===d||a<=o.stops[0][0])return o.stops[0][1];if(a>=o.stops[d-1][0])return o.stops[d-1][1];const p=ku(o.stops.map(D=>D[0]),a),g=function(D,M,k,P){const F=P-k,B=D-k;return 0===F?0:1===M?B/F:(Math.pow(M,B)-1)/(Math.pow(M,F)-1)}(a,l,o.stops[p][0],o.stops[p+1][0]),y=o.stops[p][1],x=o.stops[p+1][1];let C=Ru[i.type]||Nv;if(o.colorSpace&&"rgb"!==o.colorSpace){const D=Go[o.colorSpace];C=(M,k)=>D.reverse(D.interpolate(D.forward(M),D.forward(k),g))}return"function"==typeof y.evaluate?{evaluate(...D){const M=y.evaluate.apply(void 0,D),k=x.evaluate.apply(void 0,D);if(void 0!==M&&void 0!==k)return C(M,k,g)}}:C(y,x,g)}function y1(o,i,a){return"color"===i.type?a=Pi.parse(a):"formatted"===i.type?a=ns.fromString(a.toString()):"resolvedImage"===i.type?a=Io.fromString(a.toString()):ji(a)===i.type||"enum"===i.type&&i.values[a]||(a=void 0),Fu(a,o.default,i.default)}class k_{constructor(i,a,l,d){var p;this.expression=i,this._warningHistory={},this._evaluator=new gd(l,d),this._defaultValue=a?"color"===(p=a).type&&(Md(p.default)||Array.isArray(p.default))?new Pi(0,0,0,0):"color"===p.type?Pi.parse(p.default)||null:void 0===p.default?null:p.default:null,this._enumValues=a&&"enum"===a.type?a.values:null}evaluateWithoutErrorHandling(i,a,l,d,p,g,y,x){return this._evaluator.globals=i,this._evaluator.feature=a,this._evaluator.featureState=l,this._evaluator.canonical=d||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=g,this._evaluator.featureTileCoord=y||null,this._evaluator.featureDistanceData=x||null,this.expression.evaluate(this._evaluator)}evaluate(i,a,l,d,p,g,y,x){this._evaluator.globals=i,this._evaluator.feature=a||null,this._evaluator.featureState=l||null,this._evaluator.canonical=d||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=g||null,this._evaluator.featureTileCoord=y||null,this._evaluator.featureDistanceData=x||null;try{const C=this.expression.evaluate(this._evaluator);if(null==C||"number"==typeof C&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new Or(`Expected value to be one of ${Object.keys(this._enumValues).map(D=>JSON.stringify(D)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function Im(o){return Array.isArray(o)&&o.length>0&&"string"==typeof o[0]&&o[0]in X}function ep(o,i,a,l){const d=new Iu(X,[],i?function(g){const y={color:Ii,string:hi,number:pt,enum:hi,boolean:Di,formatted:_r,resolvedImage:Ki};return"array"===g.type?$n(y[g.value]||jn,g.length):y[g.type]}(i):void 0,void 0,void 0,a,l),p=d.parse(o,void 0,void 0,void 0,i&&"string"===i.type?{typeAnnotation:"coerce"}:void 0);return p?Ae(new k_(p,i,a,l)):_t(d.errors)}class tp{constructor(i,a,l){this.kind=i,this._styleExpression=a,this.isLightConstant=l,this.isStateDependent="constant"!==i&&!Do(a.expression),this.isConfigDependent=!Vc(a.expression)}evaluateWithoutErrorHandling(i,a,l,d,p,g){return this._styleExpression.evaluateWithoutErrorHandling(i,a,l,d,p,g)}evaluate(i,a,l,d,p,g){return this._styleExpression.evaluate(i,a,l,d,p,g)}}class np{constructor(i,a,l,d,p){this.kind=i,this.zoomStops=l,this._styleExpression=a,this.isStateDependent="camera"!==i&&!Do(a.expression),this.isLightConstant=p,this.isConfigDependent=!Vc(a.expression),this.interpolationType=d}evaluateWithoutErrorHandling(i,a,l,d,p,g){return this._styleExpression.evaluateWithoutErrorHandling(i,a,l,d,p,g)}evaluate(i,a,l,d,p,g){return this._styleExpression.evaluate(i,a,l,d,p,g)}interpolationFactor(i,a,l){return this.interpolationType?Ps.interpolationFactor(this.interpolationType,i,a,l):0}}function ip(o,i,a,l){if("error"===(o=ep(o,i,a,l)).result)return o;const d=o.value.expression,p=Za(d);if(!p&&!fi(i))return _t([new ui("","data expressions not supported")]);const g=Ks(d,["zoom","pitch","distance-from-center"]);if(!g&&!Cr(i))return _t([new ui("","zoom expressions not supported")]);const y=Ks(d,["measure-light"]);if(!y&&!pi(i))return _t([new ui("","measure-light expression not supported")]);const x=i.expression&&i.expression.relaxZoomRestriction,C=Rm(d);return C||g||x?C instanceof ui?_t([C]):C instanceof Ps&&!Lo(i)?_t([new ui("",'"interpolate" expressions cannot be used with this property')]):Ae(C?new np(p?"camera":"composite",o.value,C.labels,C instanceof Ps?C.interpolation:void 0,y):new tp(p?"constant":"source",o.value,y)):_t([new ui("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class km{constructor(i,a){this._parameters=i,this._specification=a,Xs(this,I_(this._parameters,this._specification))}static deserialize(i){return new km(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function Rm(o){let i=null;if(o instanceof Xf)i=Rm(o.result);else if(o instanceof Pu){for(const a of o.args)if(i=Rm(a),i)break}else(o instanceof kh||o instanceof Ps)&&o.input instanceof ds&&"zoom"===o.input.name&&(i=o);return i instanceof ui||o.eachChild(a=>{const l=Rm(a);l instanceof ui?i=l:i&&l&&i!==l&&(i=new ui("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}function ta(o){const i=o.key,a=o.value,l=o.valueSpec||{},d=o.objectElementValidators||{},p=o.style,g=o.styleSpec;let y=[];const x=ji(a);if("object"!==x)return[new sn(i,a,`object expected, ${x} found`)];for(const C in a){const D=C.split(".")[0];let M;d[D]?M=d[D]:l[D]?M=fo:d["*"]?M=d["*"]:l["*"]&&(M=fo),M?y=y.concat(M({key:(i&&`${i}.`)+C,value:a[C],valueSpec:l[D]||l["*"],style:p,styleSpec:g,object:a,objectKey:C},a)):y.push(new Ys(i,a[C],`unknown property "${C}"`))}for(const C in l)d[C]||l[C].required&&void 0===l[C].default&&void 0===a[C]&&y.push(new sn(i,a,`missing required property "${C}"`));return y}function Bv(o){const i=o.value,a=o.valueSpec,l=o.style,d=o.styleSpec,p=o.key,g=o.arrayElementValidator||fo;if("array"!==ji(i))return[new sn(p,i,`array expected, ${ji(i)} found`)];if(a.length&&i.length!==a.length)return[new sn(p,i,`array length ${a.length} expected, length ${i.length} found`)];if(a["min-length"]&&i.length<a["min-length"])return[new sn(p,i,`array length at least ${a["min-length"]} expected, length ${i.length} found`)];let y={type:a.value,values:a.values,minimum:a.minimum,maximum:a.maximum,function:void 0};d.$version<7&&(y.function=a.function),"object"===ji(a.value)&&(y=a.value);let x=[];for(let C=0;C<i.length;C++)x=x.concat(g({array:i,arrayIndex:C,value:i[C],valueSpec:y,style:l,styleSpec:d,key:`${p}[${C}]`},!0));return x}function rp(o){const i=o.key,a=o.value,l=o.valueSpec;let d=ji(a);if("number"===d&&a!=a&&(d="NaN"),"number"!==d)return[new sn(i,a,`number expected, ${d} found`)];if("minimum"in l){let p=l.minimum;if("array"===ji(l.minimum)&&(p=l.minimum[o.arrayIndex]),a<p)return[new sn(i,a,`${a} is less than the minimum value ${p}`)]}if("maximum"in l){let p=l.maximum;if("array"===ji(l.maximum)&&(p=l.maximum[o.arrayIndex]),a>p)return[new sn(i,a,`${a} is greater than the maximum value ${p}`)]}return[]}function op(o){const i=o.valueSpec,a=Zr(o.value.type);let l,d,p,g={};const y="categorical"!==a&&void 0===o.value.property,x=!y,C="array"===ji(o.value.stops)&&"array"===ji(o.value.stops[0])&&"object"===ji(o.value.stops[0][0]),D=ta({key:o.key,value:o.value,valueSpec:o.styleSpec.function,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(P){if("identity"===a)return[new sn(P.key,P.value,'identity function may not have a "stops" property')];let F=[];const B=P.value;return F=F.concat(Bv({key:P.key,value:B,valueSpec:P.valueSpec,style:P.style,styleSpec:P.styleSpec,arrayElementValidator:M})),"array"===ji(B)&&0===B.length&&F.push(new sn(P.key,B,"array must have at least one stop")),F},default:function(P){return fo({key:P.key,value:P.value,valueSpec:i,style:P.style,styleSpec:P.styleSpec})}}});return"identity"===a&&y&&D.push(new sn(o.key,o.value,'missing required property "property"')),"identity"===a||o.value.stops||D.push(new sn(o.key,o.value,'missing required property "stops"')),"exponential"===a&&o.valueSpec.expression&&!Lo(o.valueSpec)&&D.push(new sn(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(x&&!fi(o.valueSpec)?D.push(new sn(o.key,o.value,"property functions not supported")):y&&!Cr(o.valueSpec)&&D.push(new sn(o.key,o.value,"zoom functions not supported"))),"categorical"!==a&&!C||void 0!==o.value.property||D.push(new sn(o.key,o.value,'"property" property is required')),D;function M(P){let F=[];const B=P.value,j=P.key;if("array"!==ji(B))return[new sn(j,B,`array expected, ${ji(B)} found`)];if(2!==B.length)return[new sn(j,B,`array length 2 expected, length ${B.length} found`)];if(C){if("object"!==ji(B[0]))return[new sn(j,B,`object expected, ${ji(B[0])} found`)];if(void 0===B[0].zoom)return[new sn(j,B,"object stop key must have zoom")];if(void 0===B[0].value)return[new sn(j,B,"object stop key must have value")];const q=Zr(B[0].zoom);if("number"!=typeof q)return[new sn(j,B[0].zoom,"stop zoom values must be numbers")];if(p&&p>q)return[new sn(j,B[0].zoom,"stop zoom values must appear in ascending order")];q!==p&&(p=q,d=void 0,g={}),F=F.concat(ta({key:`${j}[0]`,value:B[0],valueSpec:{zoom:{}},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{zoom:rp,value:k}}))}else F=F.concat(k({key:`${j}[0]`,value:B[0],valueSpec:{},style:P.style,styleSpec:P.styleSpec},B));return Im(wr(B[1]))?F.concat([new sn(`${j}[1]`,B[1],"expressions are not allowed in function stops.")]):F.concat(fo({key:`${j}[1]`,value:B[1],valueSpec:i,style:P.style,styleSpec:P.styleSpec}))}function k(P,F){const B=ji(P.value),j=Zr(P.value),q=null!==P.value?P.value:F;if(l){if(B!==l)return[new sn(P.key,q,`${B} stop domain type must match previous stop domain type ${l}`)]}else l=B;if("number"!==B&&"string"!==B&&"boolean"!==B&&"number"!=typeof j&&"string"!=typeof j&&"boolean"!=typeof j)return[new sn(P.key,q,"stop domain value must be a number, string, or boolean")];if("number"!==B&&"categorical"!==a){let te=`number expected, ${B} found`;return fi(i)&&void 0===a&&(te+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new sn(P.key,q,te)]}return"categorical"!==a||"number"!==B||"number"==typeof j&&isFinite(j)&&Math.floor(j)===j?"categorical"!==a&&"number"===B&&"number"==typeof j&&"number"==typeof d&&void 0!==d&&j<d?[new sn(P.key,q,"stop domain values must appear in ascending order")]:(d=j,"categorical"===a&&j in g?[new sn(P.key,q,"stop domain values must be unique")]:(g[j]=!0,[])):[new sn(P.key,q,`integer expected, found ${String(j)}`)]}}function Ad(o){const i=("property"===o.expressionContext?ip:ep)(wr(o.value),o.valueSpec);if("error"===i.result)return i.value.map(l=>new sn(`${o.key}${l.key}`,o.value,l.message));const a=i.value.expression||i.value._styleExpression.expression;if("property"===o.expressionContext&&"text-font"===o.propertyKey&&!a.outputDefined())return[new sn(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===o.expressionContext&&"layout"===o.propertyType&&!Do(a))return[new sn(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===o.expressionContext)return Pm(a,o);if(o.expressionContext&&0===o.expressionContext.indexOf("cluster")){if(!Ks(a,["zoom","feature-state"]))return[new sn(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===o.expressionContext&&!Za(a))return[new sn(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Pm(o,i){const a=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(i.valueSpec&&i.valueSpec.expression)for(const d of i.valueSpec.expression.parameters)a.delete(d);if(0===a.size)return[];const l=[];return o instanceof ds&&a.has(o.name)?[new sn(i.key,i.value,`["${o.name}"] expression is not supported in a filter for a ${i.object.type} layer with id: ${i.object.id}`)]:(o.eachChild(d=>{l.push(...Pm(d,i))}),l)}function Id(o){const i=o.key,a=o.value,l=o.valueSpec,d=[];return Array.isArray(l.values)?-1===l.values.indexOf(Zr(a))&&d.push(new sn(i,a,`expected one of [${l.values.join(", ")}], ${JSON.stringify(a)} found`)):-1===Object.keys(l.values).indexOf(Zr(a))&&d.push(new sn(i,a,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(a)} found`)),d}function Sl(o){if(!0===o||!1===o)return!0;if(!Array.isArray(o)||0===o.length)return!1;switch(o[0]){case"has":return o.length>=2&&"$id"!==o[1]&&"$type"!==o[1];case"in":return o.length>=3&&("string"!=typeof o[1]||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==o.length||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(const i of o.slice(1))if(!Sl(i)&&"boolean"!=typeof i)return!1;return!0;default:return!0}}function Qa(o,i="fill"){if(null==o)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Sl(o)||(o=Bh(o));const a=o;let l=!0;try{l=function(C){if(!io(C))return C;let D=wr(C);return Om(D),D=R_(D),D}(a)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(a,null,2)}\n        `)}const d=He[`filter_${i}`],p=ep(l,d);let g=null;if("error"===p.result)throw new Error(p.value.map(C=>`${C.key}: ${C.message}`).join(", "));g=(C,D,M)=>p.value.evaluate(C,D,{},M);let y=null,x=null;if(l!==a){const C=ep(a,d);if("error"===C.result)throw new Error(C.value.map(D=>`${D.key}: ${D.message}`).join(", "));y=(D,M,k,P,F)=>C.value.evaluate(D,M,{},k,void 0,void 0,P,F),x=!Za(C.value.expression)}return{filter:g,dynamicFilter:y||void 0,needGeometry:Nh(l),needFeature:!!x}}function R_(o){if(!Array.isArray(o))return o;const i=function(a){if(sp.has(a[0]))for(let l=1;l<a.length;l++)if(io(a[l]))return!0;return a}(o);return!0===i?i:i.map(a=>R_(a))}function Om(o){let i=!1;const a=[];if("case"===o[0]){for(let l=1;l<o.length-1;l+=2)i=i||io(o[l]),a.push(o[l+1]);a.push(o[o.length-1])}else if("match"===o[0]){i=i||io(o[1]);for(let l=2;l<o.length-1;l+=2)a.push(o[l+1]);a.push(o[o.length-1])}else if("step"===o[0]){i=i||io(o[1]);for(let l=1;l<o.length-1;l+=2)a.push(o[l+1])}i&&(o.length=0,o.push("any",...a));for(let l=1;l<o.length;l++)Om(o[l])}function io(o){if(!Array.isArray(o))return!1;if("pitch"===(i=o[0])||"distance-from-center"===i)return!0;var i;for(let a=1;a<o.length;a++)if(io(o[a]))return!0;return!1}const sp=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function xa(o,i){return o<i?-1:o>i?1:0}function Nh(o){if(!Array.isArray(o))return!1;if("within"===o[0]||"distance"===o[0])return!0;for(let i=1;i<o.length;i++)if(Nh(o[i]))return!0;return!1}function Bh(o){if(!o)return!0;const i=o[0];return o.length<=1?"any"!==i:"=="===i?zh(o[1],o[2],"=="):"!="===i?Vh(zh(o[1],o[2],"==")):"<"===i||">"===i||"<="===i||">="===i?zh(o[1],o[2],i):"any"===i?(a=o.slice(1),["any"].concat(a.map(Bh))):"all"===i?["all"].concat(o.slice(1).map(Bh)):"none"===i?["all"].concat(o.slice(1).map(Bh).map(Vh)):"in"===i?Fm(o[1],o.slice(2)):"!in"===i?Vh(Fm(o[1],o.slice(2))):"has"===i?ap(o[1]):"!has"!==i||Vh(ap(o[1]));var a}function zh(o,i,a){switch(o){case"$type":return[`filter-type-${a}`,i];case"$id":return[`filter-id-${a}`,i];default:return[`filter-${a}`,o,i]}}function Fm(o,i){if(0===i.length)return!1;switch(o){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(a=>typeof a!=typeof i[0])?["filter-in-large",o,["literal",i.sort(xa)]]:["filter-in-small",o,["literal",i]]}}function ap(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function Vh(o){return["!",o]}function kd(o){return Sl(wr(o.value))?Ad(Xs({},o,{expressionContext:"filter",valueSpec:o.styleSpec[`filter_${o.layerType||"fill"}`]})):jh(o)}function jh(o){const i=o.value,a=o.key;if("array"!==ji(i))return[new sn(a,i,`array expected, ${ji(i)} found`)];const l=o.styleSpec;let d,p=[];if(i.length<1)return[new sn(a,i,"filter array must have at least 1 element")];switch(p=p.concat(Id({key:`${a}[0]`,value:i[0],valueSpec:l.filter_operator,style:o.style,styleSpec:o.styleSpec})),Zr(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&"$type"===Zr(i[1])&&p.push(new sn(a,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":3!==i.length&&p.push(new sn(a,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(d=ji(i[1]),"string"!==d&&p.push(new sn(`${a}[1]`,i[1],`string expected, ${d} found`)));for(let g=2;g<i.length;g++)d=ji(i[g]),"$type"===Zr(i[1])?p=p.concat(Id({key:`${a}[${g}]`,value:i[g],valueSpec:l.geometry_type,style:o.style,styleSpec:o.styleSpec})):"string"!==d&&"number"!==d&&"boolean"!==d&&p.push(new sn(`${a}[${g}]`,i[g],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let g=1;g<i.length;g++)p=p.concat(jh({key:`${a}[${g}]`,value:i[g],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":d=ji(i[1]),2!==i.length?p.push(new sn(a,i,`filter array for "${i[0]}" operator must have 2 elements`)):"string"!==d&&p.push(new sn(`${a}[1]`,i[1],`string expected, ${d} found`))}return p}function Lm(o,i){const a=o.key,l=o.style,d=o.layer,p=o.styleSpec,g=o.value,y=o.objectKey,x=p[`${i}_${o.layerType}`];if(!x)return[];const C=y.match(/^(.*)-transition$/);if("paint"===i&&C&&x[C[1]]&&x[C[1]].transition)return fo({key:a,value:g,valueSpec:p.transition,style:l,styleSpec:p});const D=o.valueSpec||x[y];if(!D)return[new Ys(a,g,`unknown property "${y}"`)];let M;if("string"===ji(g)&&fi(D)&&!D.tokens&&(M=/^{([^}]+)}$/.exec(g))){const P=`\`{ "type": "identity", "property": ${M?JSON.stringify(M[1]):'"_"'} }\``;return[new sn(a,g,`"${y}" does not support interpolation syntax\nUse an identity property function instead: ${P}.`)]}const k=[];if("symbol"===o.layerType)"text-field"!==y||!l||l.glyphs||l.imports||k.push(new sn(a,g,'use of "text-field" requires a style "glyphs" property')),"text-font"===y&&Md(wr(g))&&"identity"===Zr(g.type)&&k.push(new sn(a,g,'"text-font" does not support identity functions'));else if("model"===o.layerType&&"paint"===i&&d&&d.layout&&d.layout.hasOwnProperty("model-id")&&fi(D)&&(pi(D)||Cr(D))){const P=ip(wr(g),D),F=P.value.expression||P.value._styleExpression.expression;F&&!Ks(F,["measure-light"])&&("model-emissive-strength"===y&&Za(F)&&Do(F)||k.push(new sn(a,g,`${y} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return k.concat(fo({key:o.key,value:g,valueSpec:D,style:l,styleSpec:p,expressionContext:"property",propertyType:i,propertyKey:y}))}function Nm(o){return Lm(o,"paint")}function Rd(o){return Lm(o,"layout")}function Uh(o){let i=[];const a=o.value,l=o.key,d=o.style,p=o.styleSpec;a.type||a.ref||i.push(new sn(l,a,'either "type" or "ref" is required'));let g=Zr(a.type);const y=Zr(a.ref);if(a.id){const x=Zr(a.id);for(let C=0;C<o.arrayIndex;C++){const D=d.layers[C];Zr(D.id)===x&&i.push(new sn(l,a.id,`duplicate layer id "${a.id}", previously used at line ${D.id.__line__}`))}}if("ref"in a){let x;["type","source","source-layer","filter","layout"].forEach(C=>{C in a&&i.push(new sn(l,a[C],`"${C}" is prohibited for ref layers`))}),d.layers.forEach(C=>{Zr(C.id)===y&&(x=C)}),x?x.ref?i.push(new sn(l,a.ref,"ref cannot reference another ref layer")):g=Zr(x.type):"string"==typeof y&&i.push(new sn(l,a.ref,`ref layer "${y}" not found`))}else if("background"!==g&&"sky"!==g&&"slot"!==g)if(a.source){const x=d.sources&&d.sources[a.source],C=x&&Zr(x.type);x?"vector"===C&&"raster"===g?i.push(new sn(l,a.source,`layer "${a.id}" requires a raster source`)):"raster"===C&&"raster"!==g?i.push(new sn(l,a.source,`layer "${a.id}" requires a vector source`)):"vector"!==C||a["source-layer"]?"raster-dem"===C&&"hillshade"!==g?i.push(new sn(l,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==g||!a.paint||!a.paint["line-gradient"]&&!a.paint["line-trim-offset"]||"geojson"===C&&x.lineMetrics||i.push(new sn(l,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new sn(l,a,`layer "${a.id}" must specify a "source-layer"`)):i.push(new sn(l,a.source,`source "${a.source}" not found`))}else i.push(new sn(l,a,'missing required property "source"'));return i=i.concat(ta({key:l,value:a,valueSpec:p.layer,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{"*":()=>[],type:()=>fo({key:`${l}.type`,value:a.type,valueSpec:p.layer.type,style:o.style,styleSpec:o.styleSpec,object:a,objectKey:"type"}),filter:x=>kd(Xs({layerType:g},x)),layout:x=>ta({layer:a,key:x.key,value:x.value,valueSpec:{},style:x.style,styleSpec:x.styleSpec,objectElementValidators:{"*":C=>Rd(Xs({layerType:g},C))}}),paint:x=>ta({layer:a,key:x.key,value:x.value,valueSpec:{},style:x.style,styleSpec:x.styleSpec,objectElementValidators:{"*":C=>Nm(Xs({layerType:g,layer:a},C))}})}})),i}function Ml(o){const i=o.value,a=o.key,l=ji(i);return"string"!==l?[new sn(a,i,`string expected, ${l} found`)]:[]}const Al={promoteId:function({key:o,value:i}){if("string"===ji(i))return Ml({key:o,value:i});{const a=[];for(const l in i)a.push(...Ml({key:`${o}.${l}`,value:i[l]}));return a}}};function Bm(o){const i=o.value,a=o.key,l=o.styleSpec,d=o.style;if(!i.type)return[new sn(a,i,'"type" is required')];const p=Zr(i.type);let g=[];switch(["vector","raster","raster-dem"].includes(p)&&(i.url||i.tiles||g.push(new Ys(a,i,'Either "url" or "tiles" is required.'))),p){case"vector":case"raster":case"raster-dem":return g=g.concat(ta({key:a,value:i,valueSpec:l[`source_${p.replace("-","_")}`],style:o.style,styleSpec:l,objectElementValidators:Al})),g;case"geojson":if(g=ta({key:a,value:i,valueSpec:l.source_geojson,style:d,styleSpec:l,objectElementValidators:Al}),i.cluster)for(const y in i.clusterProperties){const[x,C]=i.clusterProperties[y],D="string"==typeof x?[x,["accumulated"],["get",y]]:x;g.push(...Ad({key:`${a}.${y}.map`,value:C,expressionContext:"cluster-map"})),g.push(...Ad({key:`${a}.${y}.reduce`,value:D,expressionContext:"cluster-reduce"}))}return g;case"video":return ta({key:a,value:i,valueSpec:l.source_video,style:d,styleSpec:l});case"image":return ta({key:a,value:i,valueSpec:l.source_image,style:d,styleSpec:l});case"canvas":return[new sn(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Id({key:`${a}.type`,value:i.type,valueSpec:{values:zv(l)},style:d,styleSpec:l})}}function zv(o){return o.source.reduce((i,a)=>{const l=o[a];return"enum"===l.type.type&&(i=i.concat(Object.keys(l.type.values))),i},[])}function lp(o){const i=o.value;let a=[];if(!i)return a;const l=ji(i);return"string"!==l?(a=a.concat([new sn(o.key,i,`string expected, "${l}" found`)]),a):(function(d){const p=-1===d.indexOf("://");try{return new URL(d,p?"http://example.com":void 0),!0}catch{return!1}}(i)||(a=a.concat([new sn(o.key,i,`invalid url "${i}"`)])),a)}function Hh(o){const i=o.value,a=o.styleSpec,l=a.light,d=o.style;let p=[];const g=ji(i);if(void 0===i)return p;if("object"!==g)return p=p.concat([new sn("light",i,`object expected, ${g} found`)]),p;for(const y in i){const x=y.match(/^(.*)-transition$/);p=p.concat(x&&l[x[1]]&&l[x[1]].transition?fo({key:y,value:i[y],valueSpec:a.transition,style:d,styleSpec:a}):l[y]?fo({key:y,value:i[y],valueSpec:l[y],style:d,styleSpec:a}):[new sn(y,i[y],`unknown property "${y}"`)])}return p}function Pd(o){const i=o.value;let a=[];if(!i)return a;const l=ji(i);if("object"!==l)return a=a.concat([new sn("light-3d",i,`object expected, ${l} found`)]),a;const d=o.styleSpec,p=d["light-3d"],g=o.key,y=o.style,x=o.style.lights;for(const M of["type","id"])if(!(M in i))return a=a.concat([new sn("light-3d",i,`missing property ${M} on light`)]),a;if(i.type&&x)for(let M=0;M<o.arrayIndex;M++){const k=Zr(i.type),P=x[M];Zr(P.type)===k&&a.push(new sn(g,i.id,`duplicate light type "${i.type}", previously defined at line ${P.id.__line__}`))}const C=`properties_light_${i.type}`;if(!(C in d))return a=a.concat([new sn("light-3d",i,`Invalid light type ${i.type}`)]),a;const D=d[C];for(const M in i)if("properties"===M){const k=i[M],P=ji(k);if("object"!==P)return a=a.concat([new sn("properties",k,`object expected, ${P} found`)]),a;for(const F in k)a=a.concat(D[F]?fo({key:F,value:k[F],valueSpec:D[F],style:y,styleSpec:d}):[new Ys(o.key,k[F],`unknown property "${F}"`)])}else{const k=M.match(/^(.*)-transition$/);a=a.concat(k&&p[k[1]]&&p[k[1]].transition?fo({key:M,value:i[M],valueSpec:d.transition,style:y,styleSpec:d}):p[M]?fo({key:M,value:i[M],valueSpec:p[M],style:y,styleSpec:d}):[new Ys(M,i[M],`unknown property "${M}"`)])}return a}function zm(o){const i=o.value,a=o.key,l=o.style,d=o.styleSpec,p=d.terrain;let g=[];const y=ji(i);if(void 0===i||"null"===y)return g;if("object"!==y)return g=g.concat([new sn("terrain",i,`object expected, ${y} found`)]),g;for(const x in i){const C=x.match(/^(.*)-transition$/);g=g.concat(C&&p[C[1]]&&p[C[1]].transition?fo({key:x,value:i[x],valueSpec:d.transition,style:l,styleSpec:d}):p[x]?fo({key:x,value:i[x],valueSpec:p[x],style:l,styleSpec:d}):[new Ys(x,i[x],`unknown property "${x}"`)])}if(i.source){const x=l.sources&&l.sources[i.source],C=x&&Zr(x.type);x?"raster-dem"!==C&&g.push(new sn(a,i.source,`terrain cannot be used with a source of type ${String(C)}, it only be used with a "raster-dem" source type`)):g.push(new sn(a,i.source,`source "${i.source}" not found`))}else g.push(new sn(a,i,'terrain is missing required property "source"'));return g}function P_(o){const i=o.value,a=o.style,l=o.styleSpec,d=l.fog;let p=[];const g=ji(i);if(void 0===i)return p;if("object"!==g)return p=p.concat([new sn("fog",i,`object expected, ${g} found`)]),p;for(const y in i){const x=y.match(/^(.*)-transition$/);p=p.concat(x&&d[x[1]]&&d[x[1]].transition?fo({key:y,value:i[y],valueSpec:l.transition,style:a,styleSpec:l}):d[y]?fo({key:y,value:i[y],valueSpec:d[y],style:a,styleSpec:l}):[new Ys(y,i[y],`unknown property "${y}"`)])}return p}const $h={"*":()=>[],array:Bv,boolean:function(o){const i=o.value,a=o.key,l=ji(i);return"boolean"!==l?[new sn(a,i,`boolean expected, ${l} found`)]:[]},number:rp,color:function(o){const i=o.key,a=o.value,l=ji(a);return"string"!==l?[new sn(i,a,`color expected, ${l} found`)]:null===vl(a)?[new sn(i,a,`color expected, "${a}" found`)]:[]},enum:Id,filter:kd,function:op,layer:Uh,object:ta,source:Bm,model:lp,light:Hh,"light-3d":Pd,terrain:zm,fog:P_,string:Ml,formatted:function(o){return 0===Ml(o).length?[]:Ad(o)},resolvedImage:function(o){return 0===Ml(o).length?[]:Ad(o)},projection:function(o){const i=o.value,a=o.styleSpec,l=a.projection,d=o.style;let p=[];const g=ji(i);if("object"===g)for(const y in i)p=p.concat(fo({key:y,value:i[y],valueSpec:l[y],style:d,styleSpec:a}));else"string"!==g&&(p=p.concat([new sn("projection",i,`object or string expected, ${g} found`)]));return p},import:function(o){const{value:i,styleSpec:a}=o,{data:l,...d}=i;Object.defineProperty(d,"__line__",{value:i.__line__,enumerable:!1});let p=ta(Xs({},o,{value:d,valueSpec:a.import}));return""===Zr(d.id)&&p.push(new sn(`${o.key}.id`,d,"import id can't be an empty string")),l&&(p=p.concat(cp(l,a,{key:`${o.key}.data`}))),p}};function fo(o,i=!1){const a=o.value,l=o.valueSpec,d=o.styleSpec;if(l.expression&&Md(Zr(a)))return op(o);if(l.expression&&Im(wr(a)))return Ad(o);if(l.type&&$h[l.type]){const p=$h[l.type](o);return!0===i&&p.length>0&&"array"===ji(o.value)?Ad(o):p}return ta(Xs({},o,{valueSpec:l.type?d[l.type]:l}))}function Vv(o){const i=o.value,a=o.key,l=Ml(o);return l.length||(-1===i.indexOf("{fontstack}")&&l.push(new sn(a,i,'"glyphs" url must include a "{fontstack}" token')),-1===i.indexOf("{range}")&&l.push(new sn(a,i,'"glyphs" url must include a "{range}" token'))),l}function cp(o,i=He,a={}){return fo({key:a.key||"",value:o,valueSpec:i.$root,styleSpec:i,style:o,objectElementValidators:{glyphs:Vv,"*":()=>[]}})}function O_(o,i=He){return wa(cp(o,i))}const v1=o=>wa(Nm(o)),jv=o=>wa(Rd(o));function wa(o){return o.slice().sort((i,a)=>i.line&&a.line?i.line-a.line:0)}function Vm(o,i){let a=!1;if(i&&i.length)for(const l of i)l instanceof Ys?ar(l.message):(o.fire(new Xl(new Error(l.message))),a=!0);return a}var Uv=Il,Gc=3;function Il(o,i,a){var l=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var d=new Int32Array(this.arrayBuffer);o=d[0],this.d=(i=d[1])+2*(a=d[2]);for(var p=0;p<this.d*this.d;p++){var g=d[Gc+p],y=d[Gc+p+1];l.push(g===y?null:d.subarray(g,y))}var x=d[Gc+l.length+1];this.keys=d.subarray(d[Gc+l.length],x),this.bboxes=d.subarray(x),this.insert=this._insertReadonly}else{this.d=i+2*a;for(var C=0;C<this.d*this.d;C++)l.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=o,this.padding=a,this.scale=i/o,this.uid=0;var D=a/i*o;this.min=-D,this.max=o+D}Il.prototype.insert=function(o,i,a,l,d){this._forEachCell(i,a,l,d,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(l),this.bboxes.push(d)},Il.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Il.prototype._insertCell=function(o,i,a,l,d,p){this.cells[d].push(p)},Il.prototype.query=function(o,i,a,l,d){var p=this.min,g=this.max;if(o<=p&&i<=p&&g<=a&&g<=l&&!d)return Array.prototype.slice.call(this.keys);var y=[];return this._forEachCell(o,i,a,l,this._queryCell,y,{},d),y},Il.prototype._queryCell=function(o,i,a,l,d,p,g,y){var x=this.cells[d];if(null!==x)for(var C=this.keys,D=this.bboxes,M=0;M<x.length;M++){var k=x[M];if(void 0===g[k]){var P=4*k;(y?y(D[P+0],D[P+1],D[P+2],D[P+3]):o<=D[P+2]&&i<=D[P+3]&&a>=D[P+0]&&l>=D[P+1])?(g[k]=!0,p.push(C[k])):g[k]=!1}}},Il.prototype._forEachCell=function(o,i,a,l,d,p,g,y){for(var x=this._convertToCellCoord(o),C=this._convertToCellCoord(i),D=this._convertToCellCoord(a),M=this._convertToCellCoord(l),k=x;k<=D;k++)for(var P=C;P<=M;P++){var F=this.d*P+k;if((!y||y(this._convertFromCellCoord(k),this._convertFromCellCoord(P),this._convertFromCellCoord(k+1),this._convertFromCellCoord(P+1)))&&d.call(this,o,i,a,l,F,p,g,y))return}},Il.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},Il.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},Il.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,i=Gc+this.cells.length+1+1,a=0,l=0;l<this.cells.length;l++)a+=this.cells[l].length;var d=new Int32Array(i+a+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;for(var p=i,g=0;g<o.length;g++){var y=o[g];d[Gc+g]=p,d.set(y,p),p+=y.length}return d[Gc+o.length]=p,d.set(this.keys,p),d[Gc+o.length+1]=p+=this.keys.length,d.set(this.bboxes,p),p+=this.bboxes.length,d.buffer};var Lu=De(Uv);const up={};function rn(o,i,a={}){Object.defineProperty(o,"_classRegistryKey",{value:i,writeable:!1}),up[i]={klass:o,omit:a.omit||[]}}rn(Object,"Object"),Lu.serialize=function(o,i){const a=o.toArrayBuffer();return i&&i.add(a),{buffer:a}},Lu.deserialize=function(o){return new Lu(o.buffer)},Object.defineProperty(Lu,"name",{value:"Grid"}),rn(Lu,"Grid"),rn(Pi,"Color"),rn(Error,"Error"),rn(ns,"Formatted"),rn(Kl,"FormattedSection"),rn(vs,"AJAXError"),rn(Io,"ResolvedImage"),rn(km,"StylePropertyFunction"),rn(k_,"StyleExpression",{omit:["_evaluator"]}),rn(np,"ZoomDependentExpression"),rn(tp,"ZoomConstantExpression"),rn(ds,"CompoundExpression",{omit:["_evaluate"]});for(const o in X)up[X[o]._classRegistryKey]||rn(X[o],`Expression${o}`);function _(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&"ArrayBuffer"===o.constructor.name)}function c(o){return self.ImageBitmap&&o instanceof ImageBitmap}function f(o,i){if(null==o||"boolean"==typeof o||"number"==typeof o||"string"==typeof o||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp)return o;if(_(o)||c(o))return i&&i.add(o),o;if(ArrayBuffer.isView(o)){const a=o;return i&&i.add(a.buffer),a}if(o instanceof ImageData)return i&&i.add(o.data.buffer),o;if(Array.isArray(o)){const a=[];for(const l of o)a.push(f(l,i));return a}if(o instanceof Map){const a={$name:"Map"};for(const[l,d]of o.entries())a[l]=f(d);return a}if("object"==typeof o){const a=o.constructor,l=a._classRegistryKey;if(!l)throw new Error(`can't serialize object of unregistered class ${l}`);const d=a.serialize?a.serialize(o,i):{};if(!a.serialize){for(const p in o)o.hasOwnProperty(p)&&(up[l].omit.indexOf(p)>=0||(d[p]=f(o[p],i)));o instanceof Error&&(d.message=o.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==l&&(d.$name=l),d}throw new Error("can't serialize object of type "+typeof o)}function v(o){if(null==o||"boolean"==typeof o||"number"==typeof o||"string"==typeof o||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||_(o)||c(o)||ArrayBuffer.isView(o)||o instanceof ImageData)return o;if(Array.isArray(o))return o.map(v);if("object"==typeof o){const i=o.$name||"Object";if("Map"===i){const d=new Map;for(const p of Object.keys(o))"$name"!==p&&d.set(p,v(o[p]));return d}const{klass:a}=up[i];if(!a)throw new Error(`can't deserialize unregistered class ${i}`);if(a.deserialize)return a.deserialize(o);const l=Object.create(a.prototype);for(const d of Object.keys(o))"$name"!==d&&(l[d]=v(o[d]));return l}throw new Error("can't deserialize object of type "+typeof o)}const w={"Latin-1 Supplement":o=>o>=128&&o<=255,Arabic:o=>o>=1536&&o<=1791,"Arabic Supplement":o=>o>=1872&&o<=1919,"Arabic Extended-A":o=>o>=2208&&o<=2303,"Hangul Jamo":o=>o>=4352&&o<=4607,"Unified Canadian Aboriginal Syllabics":o=>o>=5120&&o<=5759,Khmer:o=>o>=6016&&o<=6143,"Unified Canadian Aboriginal Syllabics Extended":o=>o>=6320&&o<=6399,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"CJK Radicals Supplement":o=>o>=11904&&o<=12031,"Kangxi Radicals":o=>o>=12032&&o<=12255,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Hiragana:o=>o>=12352&&o<=12447,Katakana:o=>o>=12448&&o<=12543,Bopomofo:o=>o>=12544&&o<=12591,"Hangul Compatibility Jamo":o=>o>=12592&&o<=12687,Kanbun:o=>o>=12688&&o<=12703,"Bopomofo Extended":o=>o>=12704&&o<=12735,"CJK Strokes":o=>o>=12736&&o<=12783,"Katakana Phonetic Extensions":o=>o>=12784&&o<=12799,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"CJK Unified Ideographs Extension A":o=>o>=13312&&o<=19903,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"CJK Unified Ideographs":o=>o>=19968&&o<=40959,"Yi Syllables":o=>o>=40960&&o<=42127,"Yi Radicals":o=>o>=42128&&o<=42191,"Hangul Jamo Extended-A":o=>o>=43360&&o<=43391,"Hangul Syllables":o=>o>=44032&&o<=55215,"Hangul Jamo Extended-B":o=>o>=55216&&o<=55295,"Private Use Area":o=>o>=57344&&o<=63743,"CJK Compatibility Ideographs":o=>o>=63744&&o<=64255,"Arabic Presentation Forms-A":o=>o>=64336&&o<=65023,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Arabic Presentation Forms-B":o=>o>=65136&&o<=65279,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519,"CJK Unified Ideographs Extension B":o=>o>=131072&&o<=173791};function E(o){for(const i of o)if(O(i.charCodeAt(0)))return!0;return!1}function S(o){for(const i of o)if(!I(i.charCodeAt(0)))return!1;return!0}function I(o){return!(w.Arabic(o)||w["Arabic Supplement"](o)||w["Arabic Extended-A"](o)||w["Arabic Presentation Forms-A"](o)||w["Arabic Presentation Forms-B"](o))}function O(o){return!(746!==o&&747!==o&&(o<4352||!(w["Bopomofo Extended"](o)||w.Bopomofo(o)||w["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||w["CJK Compatibility Ideographs"](o)||w["CJK Compatibility"](o)||w["CJK Radicals Supplement"](o)||w["CJK Strokes"](o)||!(!w["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||12336===o)||w["CJK Unified Ideographs Extension A"](o)||w["CJK Unified Ideographs"](o)||w["Enclosed CJK Letters and Months"](o)||w["Hangul Compatibility Jamo"](o)||w["Hangul Jamo Extended-A"](o)||w["Hangul Jamo Extended-B"](o)||w["Hangul Jamo"](o)||w["Hangul Syllables"](o)||w.Hiragana(o)||w["Ideographic Description Characters"](o)||w.Kanbun(o)||w["Kangxi Radicals"](o)||w["Katakana Phonetic Extensions"](o)||w.Katakana(o)&&12540!==o||!(!w["Halfwidth and Fullwidth Forms"](o)||65288===o||65289===o||65293===o||o>=65306&&o<=65310||65339===o||65341===o||65343===o||o>=65371&&o<=65503||65507===o||o>=65512&&o<=65519)||!(!w["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||w["Unified Canadian Aboriginal Syllabics"](o)||w["Unified Canadian Aboriginal Syllabics Extended"](o)||w["Vertical Forms"](o)||w["Yijing Hexagram Symbols"](o)||w["Yi Syllables"](o)||w["Yi Radicals"](o))))}function N(o){return!(O(o)||(i=o,w["Latin-1 Supplement"](i)&&(167===i||169===i||174===i||177===i||188===i||189===i||190===i||215===i||247===i)||w["General Punctuation"](i)&&(8214===i||8224===i||8225===i||8240===i||8241===i||8251===i||8252===i||8258===i||8263===i||8264===i||8265===i||8273===i)||w["Letterlike Symbols"](i)||w["Number Forms"](i)||w["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||9003===i||i>=9085&&i<=9114||i>=9150&&i<=9165||9167===i||i>=9169&&i<=9179||i>=9186&&i<=9215)||w["Control Pictures"](i)&&9251!==i||w["Optical Character Recognition"](i)||w["Enclosed Alphanumerics"](i)||w["Geometric Shapes"](i)||w["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||w["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||w["CJK Symbols and Punctuation"](i)||w.Katakana(i)||w["Private Use Area"](i)||w["CJK Compatibility Forms"](i)||w["Small Form Variants"](i)||w["Halfwidth and Fullwidth Forms"](i)||8734===i||8756===i||8757===i||i>=9984&&i<=10087||i>=10102&&i<=10131||65532===i||65533===i));var i}function V(o){return o>=1424&&o<=2303||w["Arabic Presentation Forms-A"](o)||w["Arabic Presentation Forms-B"](o)}function H(o,i){return!(!i&&V(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||w.Khmer(o))}function G(o){for(const i of o)if(V(i.charCodeAt(0)))return!0;return!1}const Y="deferred",ee="loading",K="loaded";let ne=null,J="unavailable",oe=null;const _e=function(o){o&&"string"==typeof o&&o.indexOf("NetworkError")>-1&&(J="error"),ne&&ne(o)};function ye(){re.fire(new Ao("pluginStateChange",{pluginStatus:J,pluginURL:oe}))}const re=new pa,ae=function(){return J},be=function(){if(J!==Y||!oe)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");J=ee,ye(),oe&&Mo({url:oe},o=>{o?_e(o):(J=K,ye())})},Se={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>J===K||null!=Se.applyArabicShaping,isLoading:()=>J===ee,setState(o){J=o.pluginStatus,oe=o.pluginURL},isParsed:()=>null!=Se.applyArabicShaping&&null!=Se.processBidirectionalText&&null!=Se.processStyledBidirectionalText,getPluginURL:()=>oe};class Ce{constructor(i,a){this.zoom=i,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.transition=a.transition,this.pitch=a.pitch,this.brightness=a.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(i){return function(a,l){for(const d of a)if(!H(d.charCodeAt(0),l))return!1;return!0}(i,Se.isLoaded())}}class ke{constructor(i,a,l,d){this.property=i,this.value=a,this.expression=function(p,g,y,x){if(Md(p))return new km(p,g);if(Im(p)||Array.isArray(p)&&p.length>0){const C=ip(p,g,y,x);if("error"===C.result)throw new Error(C.value.map(D=>`${D.key}: ${D.message}`).join(", "));return C.value}{let C=p;return"string"==typeof p&&"color"===g.type&&(C=Pi.parse(p)),{kind:"constant",isConfigDependent:!1,evaluate:()=>C}}}(void 0===a?i.specification.default:a,i.specification,l,d)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(i,a,l){return this.property.possiblyEvaluate(this,i,a,l)}}class lt{constructor(i,a,l){this.property=i,this.value=new ke(i,void 0,a,l)}transitioned(i,a){return new Qe(this.property,this.value,a,Gr({},i.transition,this.transition),i.now)}untransitioned(){return new Qe(this.property,this.value,null,{},0)}}class $e{constructor(i,a,l){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues),this._scope=a,this._options=l,this.isConfigDependent=!1}getValue(i){return qs(this._values[i].value.value)}setValue(i,a){this._values.hasOwnProperty(i)||(this._values[i]=new lt(this._values[i].property,this._scope,this._options)),this._values[i].value=new ke(this._values[i].property,null===a?void 0:qs(a),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[i].value.expression.isConfigDependent}setTransitionOrValue(i,a){a&&(this._options=a);const l=this._properties.properties;if(i)for(const d in i){const p=i[d];if(gr(d,"-transition")){const g=d.slice(0,-11);l[g]&&this.setTransition(g,p)}else l[d]&&this.setValue(d,p)}}getTransition(i){return qs(this._values[i].transition)}setTransition(i,a){this._values.hasOwnProperty(i)||(this._values[i]=new lt(this._values[i].property)),this._values[i].transition=qs(a)||void 0}serialize(){const i={};for(const a of Object.keys(this._values)){const l=this.getValue(a);void 0!==l&&(i[a]=l);const d=this.getTransition(a);void 0!==d&&(i[`${a}-transition`]=d)}return i}transitioned(i,a){const l=new Fe(this._properties);for(const d of Object.keys(this._values))l._values[d]=this._values[d].transitioned(i,a._values[d]);return l}untransitioned(){const i=new Fe(this._properties);for(const a of Object.keys(this._values))i._values[a]=this._values[a].untransitioned();return i}}class Qe{constructor(i,a,l,d,p){const g=d.delay||0,y=d.duration||0;p=p||0,this.property=i,this.value=a,this.begin=p+g,this.end=this.begin+y,i.specification.transition&&(d.delay||d.duration)&&(this.prior=l)}possiblyEvaluate(i,a,l){const d=i.now||0,p=this.value.possiblyEvaluate(i,a,l),g=this.prior;if(g){if(d>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(d<this.begin)return g.possiblyEvaluate(i,a,l);{const y=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(i,a,l),p,To(y))}}return p}}class Fe{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,a,l){const d=new Ue(this._properties);for(const p of Object.keys(this._values))d._values[p]=this._values[p].possiblyEvaluate(i,a,l);return d}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class ot{constructor(i,a,l){this._properties=i,this._values=Object.create(i.defaultPropertyValues),this._scope=a,this._options=l,this.isConfigDependent=!1}getValue(i){return qs(this._values[i].value)}setValue(i,a){this._values[i]=new ke(this._values[i].property,null===a?void 0:qs(a),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[i].expression.isConfigDependent}serialize(){const i={};for(const a of Object.keys(this._values)){const l=this.getValue(a);void 0!==l&&(i[a]=l)}return i}possiblyEvaluate(i,a,l){const d=new Ue(this._properties);for(const p of Object.keys(this._values))d._values[p]=this._values[p].possiblyEvaluate(i,a,l);return d}}class Ke{constructor(i,a,l){this.property=i,this.value=a,this.parameters=l}isConstant(){return"constant"===this.value.kind}constantOr(i){return"constant"===this.value.kind?this.value.value:i}evaluate(i,a,l,d){return this.property.evaluate(this.value,this.parameters,i,a,l,d)}}class Ue{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class fe{constructor(i){this.specification=i}possiblyEvaluate(i,a){return i.expression.evaluate(a)}interpolate(i,a,l){const d=Ru[this.specification.type];return d?d(i,a,l):i}}class Ne{constructor(i,a){this.specification=i,this.overrides=a}possiblyEvaluate(i,a,l,d){return new Ke(this,"constant"===i.expression.kind||"camera"===i.expression.kind?{kind:"constant",value:i.expression.evaluate(a,null,{},l,d)}:i.expression,a)}interpolate(i,a,l){if("constant"!==i.value.kind||"constant"!==a.value.kind)return i;if(void 0===i.value.value||void 0===a.value.value)return new Ke(this,{kind:"constant",value:void 0},i.parameters);const d=Ru[this.specification.type];return d?new Ke(this,{kind:"constant",value:d(i.value.value,a.value.value,l)},i.parameters):i}evaluate(i,a,l,d,p,g){return"constant"===i.kind?i.value:i.evaluate(a,l,d,p,g)}}class At{constructor(i){this.specification=i}possiblyEvaluate(i,a,l,d){return!!i.expression.evaluate(a,null,{},l,d)}interpolate(){return!1}}class vt{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const a=new Ce(0,{});for(const l in i){const d=i[l];d.specification.overridable&&this.overridableProperties.push(l);const p=this.defaultPropertyValues[l]=new ke(d,void 0),g=this.defaultTransitionablePropertyValues[l]=new lt(d);this.defaultTransitioningPropertyValues[l]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=p.possiblyEvaluate(a)}}}rn(Ne,"DataDrivenProperty"),rn(fe,"DataConstantProperty"),rn(At,"ColorRampProperty");function Xt(o,i){return i?`${o}\x1f${i}`:o}const mn="-transition";class nn extends pa{constructor(i,a,l,d){if(super(),this.id=i.id,this.fqid=Xt(this.id,l),this.type=i.type,this.scope=l,this.options=d,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,"custom"!==i.type&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,"background"!==i.type&&"sky"!==i.type&&"slot"!==i.type&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),i.slot&&(this.slot=i.slot),a.layout&&(this._unevaluatedLayout=new ot(a.layout,this.scope,d),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),a.paint)){this._transitionablePaint=new $e(a.paint,this.scope,d);for(const p in i.paint)this.setPaintProperty(p,i.paint[p],{validate:!1});for(const p in i.layout)this.setLayoutProperty(p,i.layout[p],{validate:!1});this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ue(a.paint)}}getLayoutProperty(i){return"visibility"===i?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,a,l={}){if(null!=a&&this._validate(jv,`layers.${this.id}.layout.${i}`,i,a,l))return;if("custom"===this.type&&"visibility"===i)return void(this.visibility=a);const d=this._unevaluatedLayout;d._properties.properties[i]&&(d.setValue(i,a),this.isConfigDependent=this.isConfigDependent||d.isConfigDependent,"visibility"===i&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(i){return gr(i,mn)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,a,l={}){if(null!=a&&this._validate(v1,`layers.${this.id}.paint.${i}`,i,a,l))return!1;const d=this._transitionablePaint,p=d._properties.properties;if(gr(i,mn)){const k=i.slice(0,-11);return p[k]&&d.setTransition(k,a||void 0),!1}if(!p[i])return!1;const g=d._values[i],y=g.value.isDataDriven(),x=g.value;d.setValue(i,a),this.isConfigDependent=this.isConfigDependent||d.isConfigDependent,this._handleSpecialPaintPropertyUpdate(i);const C=d._values[i].value,D=C.isDataDriven(),M=gr(i,"pattern")||"line-dasharray"===i;return D||y||M||this._handleOverridablePaintPropertyUpdate(i,x,C)}_handleSpecialPaintPropertyUpdate(i){}getProgramIds(){return null}getDefaultProgramParams(i,a){return null}_handleOverridablePaintPropertyUpdate(i,a,l){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||"none"===this.visibility}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,a){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,a)}serialize(){return da({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(i,a)=>!(void 0===i||"layout"===a&&!Object.keys(i).length||"paint"===a&&!Object.keys(i).length))}_validate(i,a,l,d,p={}){return(!p||!1!==p.validate)&&Vm(this,i.call(O_,{key:a,layerType:this.type,objectKey:l,value:d,styleSpec:He,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}resize(){}isStateDependent(){for(const i in this.paint._values){const a=this.paint.get(i);if(a instanceof Ke&&fi(a.property.specification)&&("source"===a.value.kind||"composite"===a.value.kind)&&a.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Qa(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(){this._stats&&(this._stats.numRenderedVerticesInShadowPass=0,this._stats.numRenderedVerticesInTransparentPass=0)}}const Rn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Pn{constructor(i,a){this._structArray=i,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class gn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,a){return i._trim(),a&&(i.isTransferred=!0,a.add(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const a=Object.create(this.prototype);return a.arrayBuffer=i.arrayBuffer,a.length=i.length,a.capacity=i.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function _n(o,i=1){let a=0,l=0;return{members:o.map(d=>{const p=Rn[d.type].BYTES_PER_ELEMENT,g=a=mt(a,Math.max(i,p)),y=d.components||1;return l=Math.max(l,p),a+=p*y,{name:d.name,type:d.type,components:y,offset:g}}),size:mt(a,Math.max(l,i)),alignment:i}}function mt(o,i){return Math.ceil(o/i)*i}class un extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a){const l=this.length;return this.resize(l+1),this.emplace(l,i,a)}emplace(i,a,l){const d=2*i;return this.int16[d+0]=a,this.int16[d+1]=l,i}}un.prototype.bytesPerElement=4,rn(un,"StructArrayLayout2i4");class Mn extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,l){const d=this.length;return this.resize(d+1),this.emplace(d,i,a,l)}emplace(i,a,l,d){const p=3*i;return this.int16[p+0]=a,this.int16[p+1]=l,this.int16[p+2]=d,i}}Mn.prototype.bytesPerElement=6,rn(Mn,"StructArrayLayout3i6");class Cn extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,i,a,l,d)}emplace(i,a,l,d,p){const g=4*i;return this.int16[g+0]=a,this.int16[g+1]=l,this.int16[g+2]=d,this.int16[g+3]=p,i}}Cn.prototype.bytesPerElement=8,rn(Cn,"StructArrayLayout4i8");class hr extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,l,d,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,a,l,d,p)}emplace(i,a,l,d,p,g){const y=5*i;return this.int16[y+0]=a,this.int16[y+1]=l,this.int16[y+2]=d,this.int16[y+3]=p,this.int16[y+4]=g,i}}hr.prototype.bytesPerElement=10,rn(hr,"StructArrayLayout5i10");class na extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,l,d,p,g,y){const x=this.length;return this.resize(x+1),this.emplace(x,i,a,l,d,p,g,y)}emplace(i,a,l,d,p,g,y,x){const C=6*i,D=12*i,M=3*i;return this.int16[C+0]=a,this.int16[C+1]=l,this.uint8[D+4]=d,this.uint8[D+5]=p,this.uint8[D+6]=g,this.uint8[D+7]=y,this.float32[M+2]=x,i}}na.prototype.bytesPerElement=12,rn(na,"StructArrayLayout2i4ub1f12");class zi extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,i,a,l,d)}emplace(i,a,l,d,p){const g=4*i;return this.float32[g+0]=a,this.float32[g+1]=l,this.float32[g+2]=d,this.float32[g+3]=p,i}}zi.prototype.bytesPerElement=16,rn(zi,"StructArrayLayout4f16");class ci extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,l,d,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,a,l,d,p)}emplace(i,a,l,d,p,g){const y=6*i,x=3*i;return this.uint16[y+0]=a,this.uint16[y+1]=l,this.uint16[y+2]=d,this.uint16[y+3]=p,this.float32[x+2]=g,i}}ci.prototype.bytesPerElement=12,rn(ci,"StructArrayLayout4ui1f12");class Ni extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,i,a,l,d)}emplace(i,a,l,d,p){const g=4*i;return this.uint16[g+0]=a,this.uint16[g+1]=l,this.uint16[g+2]=d,this.uint16[g+3]=p,i}}Ni.prototype.bytesPerElement=8,rn(Ni,"StructArrayLayout4ui8");class fr extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,l,d,p,g){const y=this.length;return this.resize(y+1),this.emplace(y,i,a,l,d,p,g)}emplace(i,a,l,d,p,g,y){const x=6*i;return this.int16[x+0]=a,this.int16[x+1]=l,this.int16[x+2]=d,this.int16[x+3]=p,this.int16[x+4]=g,this.int16[x+5]=y,i}}fr.prototype.bytesPerElement=12,rn(fr,"StructArrayLayout6i12");class No extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,l,d,p,g,y,x,C,D,M,k){const P=this.length;return this.resize(P+1),this.emplace(P,i,a,l,d,p,g,y,x,C,D,M,k)}emplace(i,a,l,d,p,g,y,x,C,D,M,k,P){const F=12*i;return this.int16[F+0]=a,this.int16[F+1]=l,this.int16[F+2]=d,this.int16[F+3]=p,this.uint16[F+4]=g,this.uint16[F+5]=y,this.uint16[F+6]=x,this.uint16[F+7]=C,this.int16[F+8]=D,this.int16[F+9]=M,this.int16[F+10]=k,this.int16[F+11]=P,i}}No.prototype.bytesPerElement=24,rn(No,"StructArrayLayout4i4ui4i24");class yr extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,l,d,p,g){const y=this.length;return this.resize(y+1),this.emplace(y,i,a,l,d,p,g)}emplace(i,a,l,d,p,g,y){const x=10*i,C=5*i;return this.int16[x+0]=a,this.int16[x+1]=l,this.int16[x+2]=d,this.float32[C+2]=p,this.float32[C+3]=g,this.float32[C+4]=y,i}}yr.prototype.bytesPerElement=20,rn(yr,"StructArrayLayout3i3f20");class Wo extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const a=this.length;return this.resize(a+1),this.emplace(a,i)}emplace(i,a){return this.uint32[1*i+0]=a,i}}Wo.prototype.bytesPerElement=4,rn(Wo,"StructArrayLayout1ul4");class Er extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a){const l=this.length;return this.resize(l+1),this.emplace(l,i,a)}emplace(i,a,l){const d=2*i;return this.uint16[d+0]=a,this.uint16[d+1]=l,i}}Er.prototype.bytesPerElement=4,rn(Er,"StructArrayLayout2ui4");class Yr extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,l,d,p,g,y,x,C,D,M,k,P){const F=this.length;return this.resize(F+1),this.emplace(F,i,a,l,d,p,g,y,x,C,D,M,k,P)}emplace(i,a,l,d,p,g,y,x,C,D,M,k,P,F){const B=20*i,j=10*i;return this.int16[B+0]=a,this.int16[B+1]=l,this.int16[B+2]=d,this.int16[B+3]=p,this.int16[B+4]=g,this.float32[j+3]=y,this.float32[j+4]=x,this.float32[j+5]=C,this.float32[j+6]=D,this.int16[B+14]=M,this.uint32[j+8]=k,this.uint16[B+18]=P,this.uint16[B+19]=F,i}}Yr.prototype.bytesPerElement=40,rn(Yr,"StructArrayLayout5i4f1i1ul2ui40");class ia extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,l,d,p,g,y){const x=this.length;return this.resize(x+1),this.emplace(x,i,a,l,d,p,g,y)}emplace(i,a,l,d,p,g,y,x){const C=8*i;return this.int16[C+0]=a,this.int16[C+1]=l,this.int16[C+2]=d,this.int16[C+4]=p,this.int16[C+5]=g,this.int16[C+6]=y,this.int16[C+7]=x,i}}ia.prototype.bytesPerElement=16,rn(ia,"StructArrayLayout3i2i2i16");class Os extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,l,d,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,a,l,d,p)}emplace(i,a,l,d,p,g){const y=4*i,x=8*i;return this.float32[y+0]=a,this.float32[y+1]=l,this.float32[y+2]=d,this.int16[x+6]=p,this.int16[x+7]=g,i}}Os.prototype.bytesPerElement=16,rn(Os,"StructArrayLayout2f1f2i16");class Bo extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,i,a,l,d)}emplace(i,a,l,d,p){const g=12*i,y=3*i;return this.uint8[g+0]=a,this.uint8[g+1]=l,this.float32[y+1]=d,this.float32[y+2]=p,i}}Bo.prototype.bytesPerElement=12,rn(Bo,"StructArrayLayout2ub2f12");class rr extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,l){const d=this.length;return this.resize(d+1),this.emplace(d,i,a,l)}emplace(i,a,l,d){const p=3*i;return this.uint16[p+0]=a,this.uint16[p+1]=l,this.uint16[p+2]=d,i}}rr.prototype.bytesPerElement=6,rn(rr,"StructArrayLayout3ui6");class Ca extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,a,l,d,p,g,y,x,C,D,M,k,P,F,B,j,q,te,ie,se,de){const pe=this.length;return this.resize(pe+1),this.emplace(pe,i,a,l,d,p,g,y,x,C,D,M,k,P,F,B,j,q,te,ie,se,de)}emplace(i,a,l,d,p,g,y,x,C,D,M,k,P,F,B,j,q,te,ie,se,de,pe){const Ee=30*i,Ie=15*i,Pe=60*i;return this.int16[Ee+0]=a,this.int16[Ee+1]=l,this.int16[Ee+2]=d,this.float32[Ie+2]=p,this.float32[Ie+3]=g,this.uint16[Ee+8]=y,this.uint16[Ee+9]=x,this.uint32[Ie+5]=C,this.uint32[Ie+6]=D,this.uint32[Ie+7]=M,this.uint16[Ee+16]=k,this.uint16[Ee+17]=P,this.uint16[Ee+18]=F,this.float32[Ie+10]=B,this.float32[Ie+11]=j,this.uint8[Pe+48]=q,this.uint8[Pe+49]=te,this.uint8[Pe+50]=ie,this.uint32[Ie+13]=se,this.int16[Ee+28]=de,this.uint8[Pe+58]=pe,i}}Ca.prototype.bytesPerElement=60,rn(Ca,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class kl extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,a,l,d,p,g,y,x,C,D,M,k,P,F,B,j,q,te,ie,se,de,pe,Ee,Ie,Pe,Ze,je,dt,Pt,st,Tt,et){const $t=this.length;return this.resize($t+1),this.emplace($t,i,a,l,d,p,g,y,x,C,D,M,k,P,F,B,j,q,te,ie,se,de,pe,Ee,Ie,Pe,Ze,je,dt,Pt,st,Tt,et)}emplace(i,a,l,d,p,g,y,x,C,D,M,k,P,F,B,j,q,te,ie,se,de,pe,Ee,Ie,Pe,Ze,je,dt,Pt,st,Tt,et,$t){const on=20*i,It=40*i,On=80*i;return this.float32[on+0]=a,this.float32[on+1]=l,this.int16[It+4]=d,this.int16[It+5]=p,this.int16[It+6]=g,this.int16[It+7]=y,this.int16[It+8]=x,this.int16[It+9]=C,this.int16[It+10]=D,this.int16[It+11]=M,this.int16[It+12]=k,this.uint16[It+13]=P,this.uint16[It+14]=F,this.uint16[It+15]=B,this.uint16[It+16]=j,this.uint16[It+17]=q,this.uint16[It+18]=te,this.uint16[It+19]=ie,this.uint16[It+20]=se,this.uint16[It+21]=de,this.uint16[It+22]=pe,this.uint16[It+23]=Ee,this.uint16[It+24]=Ie,this.uint16[It+25]=Pe,this.uint16[It+26]=Ze,this.uint16[It+27]=je,this.uint32[on+14]=dt,this.float32[on+15]=Pt,this.float32[on+16]=st,this.float32[on+17]=Tt,this.float32[on+18]=et,this.uint8[On+76]=$t,i}}kl.prototype.bytesPerElement=80,rn(kl,"StructArrayLayout2f9i15ui1ul4f1ub80");class uc extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const a=this.length;return this.resize(a+1),this.emplace(a,i)}emplace(i,a){return this.float32[1*i+0]=a,i}}uc.prototype.bytesPerElement=4,rn(uc,"StructArrayLayout1f4");class Nu extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,l,d,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,a,l,d,p)}emplace(i,a,l,d,p,g){const y=5*i;return this.float32[y+0]=a,this.float32[y+1]=l,this.float32[y+2]=d,this.float32[y+3]=p,this.float32[y+4]=g,i}}Nu.prototype.bytesPerElement=20,rn(Nu,"StructArrayLayout5f20");class jm extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,l,d,p,g,y){const x=this.length;return this.resize(x+1),this.emplace(x,i,a,l,d,p,g,y)}emplace(i,a,l,d,p,g,y,x){const C=7*i;return this.float32[C+0]=a,this.float32[C+1]=l,this.float32[C+2]=d,this.float32[C+3]=p,this.float32[C+4]=g,this.float32[C+5]=y,this.float32[C+6]=x,i}}jm.prototype.bytesPerElement=28,rn(jm,"StructArrayLayout7f28");class F_ extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,i,a,l,d)}emplace(i,a,l,d,p){const g=6*i;return this.uint32[3*i+0]=a,this.uint16[g+2]=l,this.uint16[g+3]=d,this.uint16[g+4]=p,i}}F_.prototype.bytesPerElement=12,rn(F_,"StructArrayLayout1ul3ui12");class Gh extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const a=this.length;return this.resize(a+1),this.emplace(a,i)}emplace(i,a){return this.uint16[1*i+0]=a,i}}Gh.prototype.bytesPerElement=2,rn(Gh,"StructArrayLayout1ui2");class qh extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,l){const d=this.length;return this.resize(d+1),this.emplace(d,i,a,l)}emplace(i,a,l,d){const p=3*i;return this.float32[p+0]=a,this.float32[p+1]=l,this.float32[p+2]=d,i}}qh.prototype.bytesPerElement=12,rn(qh,"StructArrayLayout3f12");class dp extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a){const l=this.length;return this.resize(l+1),this.emplace(l,i,a)}emplace(i,a,l){const d=2*i;return this.float32[d+0]=a,this.float32[d+1]=l,i}}dp.prototype.bytesPerElement=8,rn(dp,"StructArrayLayout2f8");class Um extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,l,d,p,g,y,x,C,D,M,k,P,F,B,j){const q=this.length;return this.resize(q+1),this.emplace(q,i,a,l,d,p,g,y,x,C,D,M,k,P,F,B,j)}emplace(i,a,l,d,p,g,y,x,C,D,M,k,P,F,B,j,q){const te=16*i;return this.float32[te+0]=a,this.float32[te+1]=l,this.float32[te+2]=d,this.float32[te+3]=p,this.float32[te+4]=g,this.float32[te+5]=y,this.float32[te+6]=x,this.float32[te+7]=C,this.float32[te+8]=D,this.float32[te+9]=M,this.float32[te+10]=k,this.float32[te+11]=P,this.float32[te+12]=F,this.float32[te+13]=B,this.float32[te+14]=j,this.float32[te+15]=q,i}}Um.prototype.bytesPerElement=64,rn(Um,"StructArrayLayout16f64");class Hm extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,l,d,p,g,y){const x=this.length;return this.resize(x+1),this.emplace(x,i,a,l,d,p,g,y)}emplace(i,a,l,d,p,g,y,x){const C=10*i,D=5*i;return this.uint16[C+0]=a,this.uint16[C+1]=l,this.uint16[C+2]=d,this.uint16[C+3]=p,this.float32[D+2]=g,this.float32[D+3]=y,this.float32[D+4]=x,i}}Hm.prototype.bytesPerElement=20,rn(Hm,"StructArrayLayout4ui3f20");class L_ extends gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(i){const a=this.length;return this.resize(a+1),this.emplace(a,i)}emplace(i,a){return this.uint8[1*i+0]=a,i}}L_.prototype.bytesPerElement=1,rn(L_,"StructArrayLayout1ub1");class Hv extends Pn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Hv.prototype.size=40;class N_ extends Yr{get(i){return new Hv(this,i)}}rn(N_,"CollisionBoxArray");class B_ extends Pn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(i){this._structArray.uint8[this._pos1+49]=i}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(i){this._structArray.uint8[this._pos1+50]=i}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(i){this._structArray.uint32[this._pos4+13]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(i){this._structArray.uint8[this._pos1+58]=i}}B_.prototype.size=60;class b1 extends Ca{get(i){return new B_(this,i)}}rn(b1,"PlacedSymbolArray");class x1 extends Pn{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(i){this._structArray.uint32[this._pos4+14]=i}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(i){this._structArray.float32[this._pos4+18]=i}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}x1.prototype.size=80;class Fs extends kl{get(i){return new x1(this,i)}}rn(Fs,"SymbolInstanceArray");class Od extends uc{getoffsetX(i){return this.float32[1*i+0]}}rn(Od,"GlyphOffsetArray");class bo extends un{getx(i){return this.int16[2*i+0]}gety(i){return this.int16[2*i+1]}}rn(bo,"SymbolLineVertexArray");class z_ extends Pn{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}z_.prototype.size=12;class w1 extends F_{get(i){return new z_(this,i)}}rn(w1,"FeatureIndexArray");class V_ extends Er{geta_centroid_pos0(i){return this.uint16[2*i+0]}geta_centroid_pos1(i){return this.uint16[2*i+1]}}rn(V_,"FillExtrusionCentroidArray");const PD=_n([{name:"a_pos",components:2,type:"Int16"}],4),C1=_n([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Dr{constructor(i=[]){this.segments=i}_prepareSegment(i,a,l,d){let p=this.segments[this.segments.length-1];return i>Dr.MAX_VERTEX_ARRAY_LENGTH&&ar(`Max vertices per segment is ${Dr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!p||p.vertexLength+i>Dr.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==d)&&(p={vertexOffset:a,primitiveOffset:l,vertexLength:0,primitiveLength:0},void 0!==d&&(p.sortKey=d),this.segments.push(p)),p}prepareSegment(i,a,l,d){return this._prepareSegment(i,a.length,l.length,d)}get(){return this.segments}destroy(){for(const i of this.segments)for(const a in i.vaos)i.vaos[a].destroy()}static simpleSegment(i,a,l,d){return new Dr([{vertexOffset:i,primitiveOffset:a,vertexLength:l,primitiveLength:d,vaos:{},sortKey:0}])}}function $m(o,i){return 256*(o=Hn(Math.floor(o),0,255))+Hn(Math.floor(i),0,255)}Dr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,rn(Dr,"SegmentVector");const Fd=_n([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),OD=_n([{name:"a_dash",components:4,type:"Uint16"}]);var Wh={exports:{}},j_={exports:function(i,a){var l,d,p,g,y,x,C,D;for(d=i.length-(l=3&i.length),p=a,y=3432918353,x=461845907,D=0;D<d;)C=255&i.charCodeAt(D)|(255&i.charCodeAt(++D))<<8|(255&i.charCodeAt(++D))<<16|(255&i.charCodeAt(++D))<<24,++D,p=27492+(65535&(g=5*(65535&(p=(p^=C=(65535&(C=(C=(65535&C)*y+(((C>>>16)*y&65535)<<16)&4294967295)<<15|C>>>17))*x+(((C>>>16)*x&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(g>>>16)&65535)<<16);switch(C=0,l){case 3:C^=(255&i.charCodeAt(D+2))<<16;case 2:C^=(255&i.charCodeAt(D+1))<<8;case 1:p^=C=(65535&(C=(C=(65535&(C^=255&i.charCodeAt(D)))*y+(((C>>>16)*y&65535)<<16)&4294967295)<<15|C>>>17))*x+(((C>>>16)*x&65535)<<16)&4294967295}return p^=i.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0}}.exports,U_={exports:{}};U_.exports=function(i,a){for(var l,d=i.length,p=a^d,g=0;d>=4;)l=1540483477*(65535&(l=255&i.charCodeAt(g)|(255&i.charCodeAt(++g))<<8|(255&i.charCodeAt(++g))<<16|(255&i.charCodeAt(++g))<<24))+((1540483477*(l>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),d-=4,++g;switch(d){case 3:p^=(255&i.charCodeAt(g+2))<<16;case 2:p^=(255&i.charCodeAt(g+1))<<8;case 1:p=1540483477*(65535&(p^=255&i.charCodeAt(g)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0};var $v=j_,E1=U_.exports;Wh.exports=$v,Wh.exports.murmur3=$v,Wh.exports.murmur2=E1;var Gv=De(Wh.exports);class qc{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(i,a,l,d){this.ids.push(hp(i)),this.positions.push(a,l,d)}eachPosition(i,a){const l=hp(i);let d=0,p=this.ids.length-1;for(;d<p;){const g=d+p>>1;this.ids[g]>=l?p=g:d=g+1}for(;this.ids[d]===l;)a(this.positions[3*d],this.positions[3*d+1],this.positions[3*d+2]),d++}static serialize(i,a){const l=new Float64Array(i.ids),d=new Uint32Array(i.positions);return qv(l,d,0,l.length-1),a&&(a.add(l.buffer),a.add(d.buffer)),{ids:l,positions:d}}static deserialize(i){const a=new qc;let l;a.ids=i.ids,a.positions=i.positions;for(const d of a.ids)d!==l&&a.uniqueIds.push(d),l=d;return a.indexed=!0,a}}function hp(o){const i=+o;return!isNaN(i)&&Number.MIN_SAFE_INTEGER<=i&&i<=Number.MAX_SAFE_INTEGER?i:Gv(String(o))}function qv(o,i,a,l){for(;a<l;){const d=o[a+l>>1];let p=a-1,g=l+1;for(;;){do{p++}while(o[p]<d);do{g--}while(o[g]>d);if(p>=g)break;Wv(o,p,g),Wv(i,3*p,3*g),Wv(i,3*p+1,3*g+1),Wv(i,3*p+2,3*g+2)}g-a<l-g?(qv(o,i,a,g),a=g+1):(qv(o,i,g+1,l),l=g)}}function Wv(o,i,a){const l=o[i];o[i]=o[a],o[a]=l}rn(qc,"FeaturePositionMap");class dc{constructor(i){this.gl=i.gl,this.initialized=!1}fetchUniformLocation(i,a){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(i,a),this.initialized=!0),!!this.location}}class Zv extends dc{constructor(i){super(i),this.current=0}set(i,a,l){this.fetchUniformLocation(i,a)&&this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}}class Ls extends dc{constructor(i){super(i),this.current=0}set(i,a,l){this.fetchUniformLocation(i,a)&&this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class Zh extends dc{constructor(i){super(i),this.current=[0,0]}set(i,a,l){this.fetchUniformLocation(i,a)&&(l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1])))}}class D1 extends dc{constructor(i){super(i),this.current=[0,0,0]}set(i,a,l){this.fetchUniformLocation(i,a)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2])))}}class FD extends dc{constructor(i){super(i),this.current=[0,0,0,0]}set(i,a,l){this.fetchUniformLocation(i,a)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3])))}}class H_ extends dc{constructor(i){super(i),this.current=Pi.transparent}set(i,a,l){this.fetchUniformLocation(i,a)&&(l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a)))}}const qm=new Float32Array(16);class Wm extends dc{constructor(i){super(i),this.current=qm}set(i,a,l){if(this.fetchUniformLocation(i,a)){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let d=1;d<16;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}}}const Zm=new Float32Array(9),Yv=new Float32Array(4);class fp extends dc{constructor(i){super(i),this.current=Yv}set(i,a,l){if(this.fetchUniformLocation(i,a))for(let d=0;d<4;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix2fv(this.location,!1,l);break}}}function T1(o){return[$m(255*o.r,255*o.g),$m(255*o.b,255*o.a)]}class pp{constructor(i,a,l){this.value=i,this.uniformNames=a.map(d=>`u_${d}`),this.type=l}setUniform(i,a,l,d,p){a.set(i,p,d.constantOr(this.value))}getBinding(i,a){return"color"===this.type?new H_(i):new Ls(i)}}class Yh{constructor(i,a){this.uniformNames=a.map(l=>`u_${l}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(i){this.pixelRatio=i.pixelRatio||1,this.pattern=i.tl.concat(i.br)}setUniform(i,a,l,d,p){const g="u_pattern"===p||"u_dash"===p?this.pattern:"u_pixel_ratio"===p?this.pixelRatio:null;g&&a.set(i,p,g)}getBinding(i,a){return"u_pattern"===a||"u_dash"===a?new FD(i):new Ls(i)}}class Bu{constructor(i,a,l,d){this.expression=i,this.type=l,this.maxValue=0,this.paintVertexAttributes=a.map(p=>({name:`a_${p}`,type:"Float32",components:"color"===l?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(i,a,l,d,p,g,y){const x=this.paintVertexArray.length,C=this.expression.evaluate(new Ce(0,{brightness:g}),a,{},p,d,y);this.paintVertexArray.resize(i),this._setPaintValue(x,i,C)}updatePaintArray(i,a,l,d,p,g,y){const x=this.expression.evaluate({zoom:0,brightness:y},l,d,void 0,p);this._setPaintValue(i,a,x)}_setPaintValue(i,a,l){if("color"===this.type){const d=T1(l);for(let p=i;p<a;p++)this.paintVertexArray.emplace(p,d[0],d[1])}else{for(let d=i;d<a;d++)this.paintVertexArray.emplace(d,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Zo{constructor(i,a,l,d,p,g){this.expression=i,this.uniformNames=a.map(y=>`u_${y}_t`),this.type=l,this.useIntegerZoom=d,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=a.map(y=>({name:`a_${y}`,type:"Float32",components:"color"===l?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(i,a,l,d,p,g,y){const x=this.expression.evaluate(new Ce(this.zoom,{brightness:g}),a,{},p,d,y),C=this.expression.evaluate(new Ce(this.zoom+1,{brightness:g}),a,{},p,d,y),D=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(D,i,x,C)}updatePaintArray(i,a,l,d,p,g,y){const x=this.expression.evaluate({zoom:this.zoom,brightness:y},l,d,void 0,p),C=this.expression.evaluate({zoom:this.zoom+1,brightness:y},l,d,void 0,p);this._setPaintValue(i,a,x,C)}_setPaintValue(i,a,l,d){if("color"===this.type){const p=T1(l),g=T1(d);for(let y=i;y<a;y++)this.paintVertexArray.emplace(y,p[0],p[1],g[0],g[1])}else{for(let p=i;p<a;p++)this.paintVertexArray.emplace(p,l,d);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(d))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,a,l,d,p){const g=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,y=Hn(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);a.set(i,p,y)}getBinding(i,a){return new Ls(i)}}class Ld{constructor(i,a,l,d,p){this.expression=i,this.layerId=p,this.paintVertexAttributes=("array"===l?OD:Fd).members;for(let g=0;g<a.length;++g);this.paintVertexArray=new d}populatePaintArray(i,a,l){const d=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValues(d,i,a.patterns&&a.patterns[this.layerId],l)}updatePaintArray(i,a,l,d,p,g,y){this._setPaintValues(i,a,l.patterns&&l.patterns[this.layerId],g)}_setPaintValues(i,a,l,d){if(!d||!l)return;const p=d[l];if(!p)return;const{tl:g,br:y,pixelRatio:x}=p;for(let C=i;C<a;C++)this.paintVertexArray.emplace(C,g[0],g[1],y[0],y[1],x)}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Wc{constructor(i,a,l=(()=>!0)){this.binders={},this._buffers=[];const d=[];for(const p in i.paint._values){const g=i.paint.get(p);if(!l(p)||!(g instanceof Ke&&fi(g.property.specification)))continue;const y=$_(p,i.type),x=g.value,C=g.property.specification.type,D=!!g.property.useIntegerZoom,M="line-dasharray"===p||p.endsWith("pattern"),k="line-dasharray"===p&&"constant"!==i.layout.get("line-cap").value.kind;if("constant"!==x.kind||k)if("source"===x.kind||k||M){const P=Kv(p,C,"source");this.binders[p]=M?new Ld(x,y,C,P,i.id):new Bu(x,y,C,P),d.push(`/a_${p}`)}else{const P=Kv(p,C,"composite");this.binders[p]=new Zo(x,y,C,D,a,P),d.push(`/z_${p}`)}else this.binders[p]=M?new Yh(x.value,y):new pp(x.value,y,C),d.push(`/u_${p}`)}this.cacheKey=d.sort().join("")}getMaxValue(i){const a=this.binders[i];return a instanceof Bu||a instanceof Zo?a.maxValue:0}populatePaintArrays(i,a,l,d,p,g,y){for(const x in this.binders){const C=this.binders[x];(C instanceof Bu||C instanceof Zo||C instanceof Ld)&&C.populatePaintArray(i,a,l,d,p,g,y)}}setConstantPatternPositions(i){for(const a in this.binders){const l=this.binders[a];l instanceof Yh&&l.setConstantPatternPositions(i)}}updatePaintArrays(i,a,l,d,p,g,y,x){let C=!1;const D=Object.keys(i),M=0!==D.length,k=M?D:a.uniqueIds;for(const P in this.binders){const F=this.binders[P];if((F instanceof Bu||F instanceof Zo||F instanceof Ld)&&(!0===F.expression.isStateDependent||!1===F.expression.isLightConstant)){const B=p.paint.get(P);F.expression=B.value;for(const j of k){const q=i[j.toString()];a.eachPosition(j,(te,ie,se)=>{const de=d.feature(te);F.updatePaintArray(ie,se,de,q,g,y,x)})}if(!M)for(const j of l.uniqueIds){const q=i[j.toString()];l.eachPosition(j,(te,ie,se)=>{const de=d.feature(te);F.updatePaintArray(ie,se,de,q,g,y,x)})}C=!0}}return C}defines(){const i=[];for(const a in this.binders){const l=this.binders[a];(l instanceof pp||l instanceof Yh)&&i.push(...l.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return i}getBinderAttributes(){const i=[];for(const a in this.binders){const l=this.binders[a];if(l instanceof Bu||l instanceof Zo||l instanceof Ld)for(let d=0;d<l.paintVertexAttributes.length;d++)i.push(l.paintVertexAttributes[d].name)}return i}getBinderUniforms(){const i=[];for(const a in this.binders){const l=this.binders[a];if(l instanceof pp||l instanceof Yh||l instanceof Zo)for(const d of l.uniformNames)i.push(d)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i){const a=[];for(const l in this.binders){const d=this.binders[l];if(d instanceof pp||d instanceof Yh||d instanceof Zo)for(const p of d.uniformNames)a.push({name:p,property:l,binding:d.getBinding(i,p)})}return a}setUniforms(i,a,l,d,p){for(const{name:g,property:y,binding:x}of l)this.binders[y].setUniform(i,x,p,d.get(y),g)}updatePaintBuffers(){this._buffers=[];for(const i in this.binders){const a=this.binders[i];(a instanceof Bu||a instanceof Zo||a instanceof Ld)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(i){for(const a in this.binders){const l=this.binders[a];(l instanceof Bu||l instanceof Zo||l instanceof Ld)&&l.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const a=this.binders[i];(a instanceof Bu||a instanceof Zo||a instanceof Ld)&&a.destroy()}}}class Zc{constructor(i,a,l=(()=>!0)){this.programConfigurations={};for(const d of i)this.programConfigurations[d.id]=new Wc(d,a,l);this.needsUpload=!1,this._featureMap=new qc,this._featureMapWithoutIds=new qc,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(i,a,l,d,p,g,y,x){for(const C in this.programConfigurations)this.programConfigurations[C].populatePaintArrays(i,a,d,p,g,y,x);void 0!==a.id?this._featureMap.add(a.id,l,this._bufferOffset,i):(this._featureMapWithoutIds.add(this._idlessCounter,l,this._bufferOffset,i),this._idlessCounter+=1),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,a,l,d,p,g){for(const y of l)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(i,this._featureMap,this._featureMapWithoutIds,a,y,d,p,g||0)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}const S1={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function $_(o,i){return S1[o]||[o.replace(`${i}-`,"").replace(/-/g,"_")]}const Xv={"line-pattern":{source:ci,composite:ci},"fill-pattern":{source:ci,composite:ci},"fill-extrusion-pattern":{source:ci,composite:ci},"line-dasharray":{source:Ni,composite:Ni}},LD={color:{source:dp,composite:zi},number:{source:uc,composite:dp}};function Kv(o,i,a){const l=Xv[o];return l&&l[a]||LD[i][a]}rn(pp,"ConstantBinder"),rn(Yh,"PatternConstantBinder"),rn(Bu,"SourceExpressionBinder"),rn(Ld,"PatternCompositeBinder"),rn(Zo,"CompositeExpressionBinder"),rn(Wc,"ProgramConfiguration",{omit:["_buffers"]}),rn(Zc,"ProgramConfigurationSet");class zu{constructor(i,a){i&&(a?this.setSouthWest(i).setNorthEast(a):4===i.length?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1]))}setNorthEast(i){return this._ne=i instanceof er?new er(i.lng,i.lat):er.convert(i),this}setSouthWest(i){return this._sw=i instanceof er?new er(i.lng,i.lat):er.convert(i),this}extend(i){const a=this._sw,l=this._ne;let d,p;if(i instanceof er)d=i,p=i;else{if(!(i instanceof zu))return Array.isArray(i)?4===i.length||i.every(Array.isArray)?this.extend(zu.convert(i)):this.extend(er.convert(i)):"object"==typeof i&&null!==i&&i.hasOwnProperty("lat")&&(i.hasOwnProperty("lon")||i.hasOwnProperty("lng"))?this.extend(er.convert(i)):this;if(d=i._sw,p=i._ne,!d||!p)return this}return a||l?(a.lng=Math.min(d.lng,a.lng),a.lat=Math.min(d.lat,a.lat),l.lng=Math.max(p.lng,l.lng),l.lat=Math.max(p.lat,l.lat)):(this._sw=new er(d.lng,d.lat),this._ne=new er(p.lng,p.lat)),this}getCenter(){return new er((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new er(this.getWest(),this.getNorth())}getSouthEast(){return new er(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:a,lat:l}=er.convert(i);let d=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&d}static convert(i){return!i||i instanceof zu?i:new zu(i)}}var ko={},Ro={};Object.defineProperty(Ro,"__esModule",{value:!0}),Ro.setMatrixArrayType=function(o){Ro.ARRAY_TYPE=Ym=o},Ro.toRadian=function(o){return o*ND},Ro.equals=function(o,i){return Math.abs(o-i)<=M1*Math.max(1,Math.abs(o),Math.abs(i))},Ro.RANDOM=Ro.ARRAY_TYPE=Ro.EPSILON=void 0;var M1=1e-6;Ro.EPSILON=M1;var Ym=typeof Float32Array<"u"?Float32Array:Array;Ro.ARRAY_TYPE=Ym;var Xh=Math.random;Ro.RANDOM=Xh;var ND=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var o=0,i=arguments.length;i--;)o+=arguments[i]*arguments[i];return Math.sqrt(o)});var Tr={};function G_(o){return(G_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.create=function(){var o=new Rl.ARRAY_TYPE(4);return Rl.ARRAY_TYPE!=Float32Array&&(o[1]=0,o[2]=0),o[0]=1,o[3]=1,o},Tr.clone=function(o){var i=new Rl.ARRAY_TYPE(4);return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i},Tr.copy=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o},Tr.identity=function(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=1,o},Tr.fromValues=function(o,i,a,l){var d=new Rl.ARRAY_TYPE(4);return d[0]=o,d[1]=i,d[2]=a,d[3]=l,d},Tr.set=function(o,i,a,l,d){return o[0]=i,o[1]=a,o[2]=l,o[3]=d,o},Tr.transpose=function(o,i){if(o===i){var a=i[1];o[1]=i[2],o[2]=a}else o[0]=i[0],o[1]=i[2],o[2]=i[1],o[3]=i[3];return o},Tr.invert=function(o,i){var a=i[0],l=i[1],d=i[2],p=i[3],g=a*p-d*l;return g?(o[0]=p*(g=1/g),o[1]=-l*g,o[2]=-d*g,o[3]=a*g,o):null},Tr.adjoint=function(o,i){var a=i[0];return o[0]=i[3],o[1]=-i[1],o[2]=-i[2],o[3]=a,o},Tr.determinant=function(o){return o[0]*o[3]-o[2]*o[1]},Tr.multiply=Ns,Tr.rotate=function(o,i,a){var l=i[0],d=i[1],p=i[2],g=i[3],y=Math.sin(a),x=Math.cos(a);return o[0]=l*x+p*y,o[1]=d*x+g*y,o[2]=l*-y+p*x,o[3]=d*-y+g*x,o},Tr.scale=function(o,i,a){var l=i[1],d=i[2],p=i[3],g=a[0],y=a[1];return o[0]=i[0]*g,o[1]=l*g,o[2]=d*y,o[3]=p*y,o},Tr.fromRotation=function(o,i){var a=Math.sin(i),l=Math.cos(i);return o[0]=l,o[1]=a,o[2]=-a,o[3]=l,o},Tr.fromScaling=function(o,i){return o[0]=i[0],o[1]=0,o[2]=0,o[3]=i[1],o},Tr.str=function(o){return"mat2("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+")"},Tr.frob=function(o){return Math.hypot(o[0],o[1],o[2],o[3])},Tr.LDU=function(o,i,a,l){return o[2]=l[2]/l[0],a[0]=l[0],a[1]=l[1],a[3]=l[3]-o[2]*a[1],[o,i,a]},Tr.add=function(o,i,a){return o[0]=i[0]+a[0],o[1]=i[1]+a[1],o[2]=i[2]+a[2],o[3]=i[3]+a[3],o},Tr.subtract=I1,Tr.exactEquals=function(o,i){return o[0]===i[0]&&o[1]===i[1]&&o[2]===i[2]&&o[3]===i[3]},Tr.equals=function(o,i){var a=o[0],l=o[1],d=o[2],p=o[3],g=i[0],y=i[1],x=i[2],C=i[3];return Math.abs(a-g)<=Rl.EPSILON*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(l-y)<=Rl.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(d-x)<=Rl.EPSILON*Math.max(1,Math.abs(d),Math.abs(x))&&Math.abs(p-C)<=Rl.EPSILON*Math.max(1,Math.abs(p),Math.abs(C))},Tr.multiplyScalar=function(o,i,a){return o[0]=i[0]*a,o[1]=i[1]*a,o[2]=i[2]*a,o[3]=i[3]*a,o},Tr.multiplyScalarAndAdd=function(o,i,a,l){return o[0]=i[0]+a[0]*l,o[1]=i[1]+a[1]*l,o[2]=i[2]+a[2]*l,o[3]=i[3]+a[3]*l,o},Tr.sub=Tr.mul=void 0;var Rl=function(o,i){if(o&&o.__esModule)return o;if(null===o||"object"!==G_(o)&&"function"!=typeof o)return{default:o};var a=A1(void 0);if(a&&a.has(o))return a.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in o)if("default"!==p&&Object.prototype.hasOwnProperty.call(o,p)){var g=d?Object.getOwnPropertyDescriptor(o,p):null;g&&(g.get||g.set)?Object.defineProperty(l,p,g):l[p]=o[p]}return l.default=o,a&&a.set(o,l),l}(Ro);function A1(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,a=new WeakMap;return(A1=function(l){return l?a:i})(o)}function Ns(o,i,a){var l=i[0],d=i[1],p=i[2],g=i[3],y=a[0],x=a[1],C=a[2],D=a[3];return o[0]=l*y+p*x,o[1]=d*y+g*x,o[2]=l*C+p*D,o[3]=d*C+g*D,o}function I1(o,i,a){return o[0]=i[0]-a[0],o[1]=i[1]-a[1],o[2]=i[2]-a[2],o[3]=i[3]-a[3],o}Tr.mul=Ns,Tr.sub=I1;var mi={};function Xm(o){return(Xm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}Object.defineProperty(mi,"__esModule",{value:!0}),mi.create=function(){var o=new Yc.ARRAY_TYPE(6);return Yc.ARRAY_TYPE!=Float32Array&&(o[1]=0,o[2]=0,o[4]=0,o[5]=0),o[0]=1,o[3]=1,o},mi.clone=function(o){var i=new Yc.ARRAY_TYPE(6);return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i[4]=o[4],i[5]=o[5],i},mi.copy=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o[4]=i[4],o[5]=i[5],o},mi.identity=function(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=1,o[4]=0,o[5]=0,o},mi.fromValues=function(o,i,a,l,d,p){var g=new Yc.ARRAY_TYPE(6);return g[0]=o,g[1]=i,g[2]=a,g[3]=l,g[4]=d,g[5]=p,g},mi.set=function(o,i,a,l,d,p,g){return o[0]=i,o[1]=a,o[2]=l,o[3]=d,o[4]=p,o[5]=g,o},mi.invert=function(o,i){var a=i[0],l=i[1],d=i[2],p=i[3],g=i[4],y=i[5],x=a*p-l*d;return x?(o[0]=p*(x=1/x),o[1]=-l*x,o[2]=-d*x,o[3]=a*x,o[4]=(d*y-p*g)*x,o[5]=(l*g-a*y)*x,o):null},mi.determinant=function(o){return o[0]*o[3]-o[1]*o[2]},mi.multiply=mp,mi.rotate=function(o,i,a){var l=i[0],d=i[1],p=i[2],g=i[3],y=i[4],x=i[5],C=Math.sin(a),D=Math.cos(a);return o[0]=l*D+p*C,o[1]=d*D+g*C,o[2]=l*-C+p*D,o[3]=d*-C+g*D,o[4]=y,o[5]=x,o},mi.scale=function(o,i,a){var l=i[1],d=i[2],p=i[3],g=i[4],y=i[5],x=a[0],C=a[1];return o[0]=i[0]*x,o[1]=l*x,o[2]=d*C,o[3]=p*C,o[4]=g,o[5]=y,o},mi.translate=function(o,i,a){var l=i[0],d=i[1],p=i[2],g=i[3],y=i[4],x=i[5],C=a[0],D=a[1];return o[0]=l,o[1]=d,o[2]=p,o[3]=g,o[4]=l*C+p*D+y,o[5]=d*C+g*D+x,o},mi.fromRotation=function(o,i){var a=Math.sin(i),l=Math.cos(i);return o[0]=l,o[1]=a,o[2]=-a,o[3]=l,o[4]=0,o[5]=0,o},mi.fromScaling=function(o,i){return o[0]=i[0],o[1]=0,o[2]=0,o[3]=i[1],o[4]=0,o[5]=0,o},mi.fromTranslation=function(o,i){return o[0]=1,o[1]=0,o[2]=0,o[3]=1,o[4]=i[0],o[5]=i[1],o},mi.str=function(o){return"mat2d("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+", "+o[4]+", "+o[5]+")"},mi.frob=function(o){return Math.hypot(o[0],o[1],o[2],o[3],o[4],o[5],1)},mi.add=function(o,i,a){return o[0]=i[0]+a[0],o[1]=i[1]+a[1],o[2]=i[2]+a[2],o[3]=i[3]+a[3],o[4]=i[4]+a[4],o[5]=i[5]+a[5],o},mi.subtract=Kh,mi.multiplyScalar=function(o,i,a){return o[0]=i[0]*a,o[1]=i[1]*a,o[2]=i[2]*a,o[3]=i[3]*a,o[4]=i[4]*a,o[5]=i[5]*a,o},mi.multiplyScalarAndAdd=function(o,i,a,l){return o[0]=i[0]+a[0]*l,o[1]=i[1]+a[1]*l,o[2]=i[2]+a[2]*l,o[3]=i[3]+a[3]*l,o[4]=i[4]+a[4]*l,o[5]=i[5]+a[5]*l,o},mi.exactEquals=function(o,i){return o[0]===i[0]&&o[1]===i[1]&&o[2]===i[2]&&o[3]===i[3]&&o[4]===i[4]&&o[5]===i[5]},mi.equals=function(o,i){var a=o[0],l=o[1],d=o[2],p=o[3],g=o[4],y=o[5],x=i[0],C=i[1],D=i[2],M=i[3],k=i[4],P=i[5];return Math.abs(a-x)<=Yc.EPSILON*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(l-C)<=Yc.EPSILON*Math.max(1,Math.abs(l),Math.abs(C))&&Math.abs(d-D)<=Yc.EPSILON*Math.max(1,Math.abs(d),Math.abs(D))&&Math.abs(p-M)<=Yc.EPSILON*Math.max(1,Math.abs(p),Math.abs(M))&&Math.abs(g-k)<=Yc.EPSILON*Math.max(1,Math.abs(g),Math.abs(k))&&Math.abs(y-P)<=Yc.EPSILON*Math.max(1,Math.abs(y),Math.abs(P))},mi.sub=mi.mul=void 0;var Yc=function(o,i){if(o&&o.__esModule)return o;if(null===o||"object"!==Xm(o)&&"function"!=typeof o)return{default:o};var a=Qv(void 0);if(a&&a.has(o))return a.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in o)if("default"!==p&&Object.prototype.hasOwnProperty.call(o,p)){var g=d?Object.getOwnPropertyDescriptor(o,p):null;g&&(g.get||g.set)?Object.defineProperty(l,p,g):l[p]=o[p]}return l.default=o,a&&a.set(o,l),l}(Ro);function Qv(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,a=new WeakMap;return(Qv=function(l){return l?a:i})(o)}function mp(o,i,a){var l=i[0],d=i[1],p=i[2],g=i[3],y=i[4],x=i[5],C=a[0],D=a[1],M=a[2],k=a[3],P=a[4],F=a[5];return o[0]=l*C+p*D,o[1]=d*C+g*D,o[2]=l*M+p*k,o[3]=d*M+g*k,o[4]=l*P+p*F+y,o[5]=d*P+g*F+x,o}function Kh(o,i,a){return o[0]=i[0]-a[0],o[1]=i[1]-a[1],o[2]=i[2]-a[2],o[3]=i[3]-a[3],o[4]=i[4]-a[4],o[5]=i[5]-a[5],o}mi.mul=mp,mi.sub=Kh;var Hi={};function Nd(o){return(Nd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.create=function(){var o=new Ea.ARRAY_TYPE(9);return Ea.ARRAY_TYPE!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o},Hi.fromMat4=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[4],o[4]=i[5],o[5]=i[6],o[6]=i[8],o[7]=i[9],o[8]=i[10],o},Hi.clone=function(o){var i=new Ea.ARRAY_TYPE(9);return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i[4]=o[4],i[5]=o[5],i[6]=o[6],i[7]=o[7],i[8]=o[8],i},Hi.copy=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o[4]=i[4],o[5]=i[5],o[6]=i[6],o[7]=i[7],o[8]=i[8],o},Hi.fromValues=function(o,i,a,l,d,p,g,y,x){var C=new Ea.ARRAY_TYPE(9);return C[0]=o,C[1]=i,C[2]=a,C[3]=l,C[4]=d,C[5]=p,C[6]=g,C[7]=y,C[8]=x,C},Hi.set=function(o,i,a,l,d,p,g,y,x,C){return o[0]=i,o[1]=a,o[2]=l,o[3]=d,o[4]=p,o[5]=g,o[6]=y,o[7]=x,o[8]=C,o},Hi.identity=function(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=1,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},Hi.transpose=function(o,i){if(o===i){var a=i[1],l=i[2],d=i[5];o[1]=i[3],o[2]=i[6],o[3]=a,o[5]=i[7],o[6]=l,o[7]=d}else o[0]=i[0],o[1]=i[3],o[2]=i[6],o[3]=i[1],o[4]=i[4],o[5]=i[7],o[6]=i[2],o[7]=i[5],o[8]=i[8];return o},Hi.invert=function(o,i){var a=i[0],l=i[1],d=i[2],p=i[3],g=i[4],y=i[5],x=i[6],C=i[7],D=i[8],M=D*g-y*C,k=-D*p+y*x,P=C*p-g*x,F=a*M+l*k+d*P;return F?(o[0]=M*(F=1/F),o[1]=(-D*l+d*C)*F,o[2]=(y*l-d*g)*F,o[3]=k*F,o[4]=(D*a-d*x)*F,o[5]=(-y*a+d*p)*F,o[6]=P*F,o[7]=(-C*a+l*x)*F,o[8]=(g*a-l*p)*F,o):null},Hi.adjoint=function(o,i){var a=i[0],l=i[1],d=i[2],p=i[3],g=i[4],y=i[5],x=i[6],C=i[7],D=i[8];return o[0]=g*D-y*C,o[1]=d*C-l*D,o[2]=l*y-d*g,o[3]=y*x-p*D,o[4]=a*D-d*x,o[5]=d*p-a*y,o[6]=p*C-g*x,o[7]=l*x-a*C,o[8]=a*g-l*p,o},Hi.determinant=function(o){var i=o[3],a=o[4],l=o[5],d=o[6],p=o[7],g=o[8];return o[0]*(g*a-l*p)+o[1]*(-g*i+l*d)+o[2]*(p*i-a*d)},Hi.multiply=Qh,Hi.translate=function(o,i,a){var l=i[0],d=i[1],p=i[2],g=i[3],y=i[4],x=i[5],C=i[6],D=i[7],M=i[8],k=a[0],P=a[1];return o[0]=l,o[1]=d,o[2]=p,o[3]=g,o[4]=y,o[5]=x,o[6]=k*l+P*g+C,o[7]=k*d+P*y+D,o[8]=k*p+P*x+M,o},Hi.rotate=function(o,i,a){var l=i[0],d=i[1],p=i[2],g=i[3],y=i[4],x=i[5],C=i[6],D=i[7],M=i[8],k=Math.sin(a),P=Math.cos(a);return o[0]=P*l+k*g,o[1]=P*d+k*y,o[2]=P*p+k*x,o[3]=P*g-k*l,o[4]=P*y-k*d,o[5]=P*x-k*p,o[6]=C,o[7]=D,o[8]=M,o},Hi.scale=function(o,i,a){var l=a[0],d=a[1];return o[0]=l*i[0],o[1]=l*i[1],o[2]=l*i[2],o[3]=d*i[3],o[4]=d*i[4],o[5]=d*i[5],o[6]=i[6],o[7]=i[7],o[8]=i[8],o},Hi.fromTranslation=function(o,i){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=1,o[5]=0,o[6]=i[0],o[7]=i[1],o[8]=1,o},Hi.fromRotation=function(o,i){var a=Math.sin(i),l=Math.cos(i);return o[0]=l,o[1]=a,o[2]=0,o[3]=-a,o[4]=l,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},Hi.fromScaling=function(o,i){return o[0]=i[0],o[1]=0,o[2]=0,o[3]=0,o[4]=i[1],o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},Hi.fromMat2d=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=0,o[3]=i[2],o[4]=i[3],o[5]=0,o[6]=i[4],o[7]=i[5],o[8]=1,o},Hi.fromQuat=function(o,i){var a=i[0],l=i[1],d=i[2],p=i[3],g=a+a,y=l+l,x=d+d,C=a*g,D=l*g,M=l*y,k=d*g,P=d*y,F=d*x,B=p*g,j=p*y,q=p*x;return o[0]=1-M-F,o[3]=D-q,o[6]=k+j,o[1]=D+q,o[4]=1-C-F,o[7]=P-B,o[2]=k-j,o[5]=P+B,o[8]=1-C-M,o},Hi.normalFromMat4=function(o,i){var a=i[0],l=i[1],d=i[2],p=i[3],g=i[4],y=i[5],x=i[6],C=i[7],D=i[8],M=i[9],k=i[10],P=i[11],F=i[12],B=i[13],j=i[14],q=i[15],te=a*y-l*g,ie=a*x-d*g,se=a*C-p*g,de=l*x-d*y,pe=l*C-p*y,Ee=d*C-p*x,Ie=D*B-M*F,Pe=D*j-k*F,Ze=D*q-P*F,je=M*j-k*B,dt=M*q-P*B,Pt=k*q-P*j,st=te*Pt-ie*dt+se*je+de*Ze-pe*Pe+Ee*Ie;return st?(o[0]=(y*Pt-x*dt+C*je)*(st=1/st),o[1]=(x*Ze-g*Pt-C*Pe)*st,o[2]=(g*dt-y*Ze+C*Ie)*st,o[3]=(d*dt-l*Pt-p*je)*st,o[4]=(a*Pt-d*Ze+p*Pe)*st,o[5]=(l*Ze-a*dt-p*Ie)*st,o[6]=(B*Ee-j*pe+q*de)*st,o[7]=(j*se-F*Ee-q*ie)*st,o[8]=(F*pe-B*se+q*te)*st,o):null},Hi.projection=function(o,i,a){return o[0]=2/i,o[1]=0,o[2]=0,o[3]=0,o[4]=-2/a,o[5]=0,o[6]=-1,o[7]=1,o[8]=1,o},Hi.str=function(o){return"mat3("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+", "+o[4]+", "+o[5]+", "+o[6]+", "+o[7]+", "+o[8]+")"},Hi.frob=function(o){return Math.hypot(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8])},Hi.add=function(o,i,a){return o[0]=i[0]+a[0],o[1]=i[1]+a[1],o[2]=i[2]+a[2],o[3]=i[3]+a[3],o[4]=i[4]+a[4],o[5]=i[5]+a[5],o[6]=i[6]+a[6],o[7]=i[7]+a[7],o[8]=i[8]+a[8],o},Hi.subtract=BD,Hi.multiplyScalar=function(o,i,a){return o[0]=i[0]*a,o[1]=i[1]*a,o[2]=i[2]*a,o[3]=i[3]*a,o[4]=i[4]*a,o[5]=i[5]*a,o[6]=i[6]*a,o[7]=i[7]*a,o[8]=i[8]*a,o},Hi.multiplyScalarAndAdd=function(o,i,a,l){return o[0]=i[0]+a[0]*l,o[1]=i[1]+a[1]*l,o[2]=i[2]+a[2]*l,o[3]=i[3]+a[3]*l,o[4]=i[4]+a[4]*l,o[5]=i[5]+a[5]*l,o[6]=i[6]+a[6]*l,o[7]=i[7]+a[7]*l,o[8]=i[8]+a[8]*l,o},Hi.exactEquals=function(o,i){return o[0]===i[0]&&o[1]===i[1]&&o[2]===i[2]&&o[3]===i[3]&&o[4]===i[4]&&o[5]===i[5]&&o[6]===i[6]&&o[7]===i[7]&&o[8]===i[8]},Hi.equals=function(o,i){var a=o[0],l=o[1],d=o[2],p=o[3],g=o[4],y=o[5],x=o[6],C=o[7],D=o[8],M=i[0],k=i[1],P=i[2],F=i[3],B=i[4],j=i[5],q=i[6],te=i[7],ie=i[8];return Math.abs(a-M)<=Ea.EPSILON*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(l-k)<=Ea.EPSILON*Math.max(1,Math.abs(l),Math.abs(k))&&Math.abs(d-P)<=Ea.EPSILON*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(p-F)<=Ea.EPSILON*Math.max(1,Math.abs(p),Math.abs(F))&&Math.abs(g-B)<=Ea.EPSILON*Math.max(1,Math.abs(g),Math.abs(B))&&Math.abs(y-j)<=Ea.EPSILON*Math.max(1,Math.abs(y),Math.abs(j))&&Math.abs(x-q)<=Ea.EPSILON*Math.max(1,Math.abs(x),Math.abs(q))&&Math.abs(C-te)<=Ea.EPSILON*Math.max(1,Math.abs(C),Math.abs(te))&&Math.abs(D-ie)<=Ea.EPSILON*Math.max(1,Math.abs(D),Math.abs(ie))},Hi.sub=Hi.mul=void 0;var Ea=function(o,i){if(o&&o.__esModule)return o;if(null===o||"object"!==Nd(o)&&"function"!=typeof o)return{default:o};var a=q_(void 0);if(a&&a.has(o))return a.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in o)if("default"!==p&&Object.prototype.hasOwnProperty.call(o,p)){var g=d?Object.getOwnPropertyDescriptor(o,p):null;g&&(g.get||g.set)?Object.defineProperty(l,p,g):l[p]=o[p]}return l.default=o,a&&a.set(o,l),l}(Ro);function q_(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,a=new WeakMap;return(q_=function(l){return l?a:i})(o)}function Qh(o,i,a){var l=i[0],d=i[1],p=i[2],g=i[3],y=i[4],x=i[5],C=i[6],D=i[7],M=i[8],k=a[0],P=a[1],F=a[2],B=a[3],j=a[4],q=a[5],te=a[6],ie=a[7],se=a[8];return o[0]=k*l+P*g+F*C,o[1]=k*d+P*y+F*D,o[2]=k*p+P*x+F*M,o[3]=B*l+j*g+q*C,o[4]=B*d+j*y+q*D,o[5]=B*p+j*x+q*M,o[6]=te*l+ie*g+se*C,o[7]=te*d+ie*y+se*D,o[8]=te*p+ie*x+se*M,o}function BD(o,i,a){return o[0]=i[0]-a[0],o[1]=i[1]-a[1],o[2]=i[2]-a[2],o[3]=i[3]-a[3],o[4]=i[4]-a[4],o[5]=i[5]-a[5],o[6]=i[6]-a[6],o[7]=i[7]-a[7],o[8]=i[8]-a[8],o}Hi.mul=Qh,Hi.sub=BD;var ti={};function k1(o){return(k1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}Object.defineProperty(ti,"__esModule",{value:!0}),ti.create=function(){var o=new ro.ARRAY_TYPE(16);return ro.ARRAY_TYPE!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},ti.clone=function(o){var i=new ro.ARRAY_TYPE(16);return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i[4]=o[4],i[5]=o[5],i[6]=o[6],i[7]=o[7],i[8]=o[8],i[9]=o[9],i[10]=o[10],i[11]=o[11],i[12]=o[12],i[13]=o[13],i[14]=o[14],i[15]=o[15],i},ti.copy=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o[4]=i[4],o[5]=i[5],o[6]=i[6],o[7]=i[7],o[8]=i[8],o[9]=i[9],o[10]=i[10],o[11]=i[11],o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15],o},ti.fromValues=function(o,i,a,l,d,p,g,y,x,C,D,M,k,P,F,B){var j=new ro.ARRAY_TYPE(16);return j[0]=o,j[1]=i,j[2]=a,j[3]=l,j[4]=d,j[5]=p,j[6]=g,j[7]=y,j[8]=x,j[9]=C,j[10]=D,j[11]=M,j[12]=k,j[13]=P,j[14]=F,j[15]=B,j},ti.set=function(o,i,a,l,d,p,g,y,x,C,D,M,k,P,F,B,j){return o[0]=i,o[1]=a,o[2]=l,o[3]=d,o[4]=p,o[5]=g,o[6]=y,o[7]=x,o[8]=C,o[9]=D,o[10]=M,o[11]=k,o[12]=P,o[13]=F,o[14]=B,o[15]=j,o},ti.identity=VD,ti.transpose=function(o,i){if(o===i){var a=i[1],l=i[2],d=i[3],p=i[6],g=i[7],y=i[11];o[1]=i[4],o[2]=i[8],o[3]=i[12],o[4]=a,o[6]=i[9],o[7]=i[13],o[8]=l,o[9]=p,o[11]=i[14],o[12]=d,o[13]=g,o[14]=y}else o[0]=i[0],o[1]=i[4],o[2]=i[8],o[3]=i[12],o[4]=i[1],o[5]=i[5],o[6]=i[9],o[7]=i[13],o[8]=i[2],o[9]=i[6],o[10]=i[10],o[11]=i[14],o[12]=i[3],o[13]=i[7],o[14]=i[11],o[15]=i[15];return o},ti.invert=function(o,i){var a=i[0],l=i[1],d=i[2],p=i[3],g=i[4],y=i[5],x=i[6],C=i[7],D=i[8],M=i[9],k=i[10],P=i[11],F=i[12],B=i[13],j=i[14],q=i[15],te=a*y-l*g,ie=a*x-d*g,se=a*C-p*g,de=l*x-d*y,pe=l*C-p*y,Ee=d*C-p*x,Ie=D*B-M*F,Pe=D*j-k*F,Ze=D*q-P*F,je=M*j-k*B,dt=M*q-P*B,Pt=k*q-P*j,st=te*Pt-ie*dt+se*je+de*Ze-pe*Pe+Ee*Ie;return st?(o[0]=(y*Pt-x*dt+C*je)*(st=1/st),o[1]=(d*dt-l*Pt-p*je)*st,o[2]=(B*Ee-j*pe+q*de)*st,o[3]=(k*pe-M*Ee-P*de)*st,o[4]=(x*Ze-g*Pt-C*Pe)*st,o[5]=(a*Pt-d*Ze+p*Pe)*st,o[6]=(j*se-F*Ee-q*ie)*st,o[7]=(D*Ee-k*se+P*ie)*st,o[8]=(g*dt-y*Ze+C*Ie)*st,o[9]=(l*Ze-a*dt-p*Ie)*st,o[10]=(F*pe-B*se+q*te)*st,o[11]=(M*se-D*pe-P*te)*st,o[12]=(y*Pe-g*je-x*Ie)*st,o[13]=(a*je-l*Pe+d*Ie)*st,o[14]=(B*ie-F*de-j*te)*st,o[15]=(D*de-M*ie+k*te)*st,o):null},ti.adjoint=function(o,i){var a=i[0],l=i[1],d=i[2],p=i[3],g=i[4],y=i[5],x=i[6],C=i[7],D=i[8],M=i[9],k=i[10],P=i[11],F=i[12],B=i[13],j=i[14],q=i[15];return o[0]=y*(k*q-P*j)-M*(x*q-C*j)+B*(x*P-C*k),o[1]=-(l*(k*q-P*j)-M*(d*q-p*j)+B*(d*P-p*k)),o[2]=l*(x*q-C*j)-y*(d*q-p*j)+B*(d*C-p*x),o[3]=-(l*(x*P-C*k)-y*(d*P-p*k)+M*(d*C-p*x)),o[4]=-(g*(k*q-P*j)-D*(x*q-C*j)+F*(x*P-C*k)),o[5]=a*(k*q-P*j)-D*(d*q-p*j)+F*(d*P-p*k),o[6]=-(a*(x*q-C*j)-g*(d*q-p*j)+F*(d*C-p*x)),o[7]=a*(x*P-C*k)-g*(d*P-p*k)+D*(d*C-p*x),o[8]=g*(M*q-P*B)-D*(y*q-C*B)+F*(y*P-C*M),o[9]=-(a*(M*q-P*B)-D*(l*q-p*B)+F*(l*P-p*M)),o[10]=a*(y*q-C*B)-g*(l*q-p*B)+F*(l*C-p*y),o[11]=-(a*(y*P-C*M)-g*(l*P-p*M)+D*(l*C-p*y)),o[12]=-(g*(M*j-k*B)-D*(y*j-x*B)+F*(y*k-x*M)),o[13]=a*(M*j-k*B)-D*(l*j-d*B)+F*(l*k-d*M),o[14]=-(a*(y*j-x*B)-g*(l*j-d*B)+F*(l*x-d*y)),o[15]=a*(y*k-x*M)-g*(l*k-d*M)+D*(l*x-d*y),o},ti.determinant=function(o){var i=o[0],a=o[1],l=o[2],d=o[3],p=o[4],g=o[5],y=o[6],x=o[7],C=o[8],D=o[9],M=o[10],k=o[11],P=o[12],F=o[13],B=o[14],j=o[15];return(i*g-a*p)*(M*j-k*B)-(i*y-l*p)*(D*j-k*F)+(i*x-d*p)*(D*B-M*F)+(a*y-l*g)*(C*j-k*P)-(a*x-d*g)*(C*B-M*P)+(l*x-d*y)*(C*F-D*P)},ti.multiply=jD,ti.translate=function(o,i,a){var l,d,p,g,y,x,C,D,M,k,P,F,B=a[0],j=a[1],q=a[2];return i===o?(o[12]=i[0]*B+i[4]*j+i[8]*q+i[12],o[13]=i[1]*B+i[5]*j+i[9]*q+i[13],o[14]=i[2]*B+i[6]*j+i[10]*q+i[14],o[15]=i[3]*B+i[7]*j+i[11]*q+i[15]):(d=i[1],p=i[2],g=i[3],y=i[4],x=i[5],C=i[6],D=i[7],M=i[8],k=i[9],P=i[10],F=i[11],o[0]=l=i[0],o[1]=d,o[2]=p,o[3]=g,o[4]=y,o[5]=x,o[6]=C,o[7]=D,o[8]=M,o[9]=k,o[10]=P,o[11]=F,o[12]=l*B+y*j+M*q+i[12],o[13]=d*B+x*j+k*q+i[13],o[14]=p*B+C*j+P*q+i[14],o[15]=g*B+D*j+F*q+i[15]),o},ti.scale=function(o,i,a){var l=a[0],d=a[1],p=a[2];return o[0]=i[0]*l,o[1]=i[1]*l,o[2]=i[2]*l,o[3]=i[3]*l,o[4]=i[4]*d,o[5]=i[5]*d,o[6]=i[6]*d,o[7]=i[7]*d,o[8]=i[8]*p,o[9]=i[9]*p,o[10]=i[10]*p,o[11]=i[11]*p,o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15],o},ti.rotate=function(o,i,a,l){var d,p,g,y,x,C,D,M,k,P,F,B,j,q,te,ie,se,de,pe,Ee,Ie,Pe,Ze,je,dt=l[0],Pt=l[1],st=l[2],Tt=Math.hypot(dt,Pt,st);return Tt<ro.EPSILON?null:(dt*=Tt=1/Tt,Pt*=Tt,st*=Tt,d=Math.sin(a),p=Math.cos(a),x=i[1],C=i[2],D=i[3],k=i[5],P=i[6],F=i[7],j=i[9],q=i[10],te=i[11],pe=dt*Pt*(g=1-p)-st*d,Ee=Pt*Pt*g+p,Ie=st*Pt*g+dt*d,Pe=dt*st*g+Pt*d,Ze=Pt*st*g-dt*d,je=st*st*g+p,o[0]=(y=i[0])*(ie=dt*dt*g+p)+(M=i[4])*(se=Pt*dt*g+st*d)+(B=i[8])*(de=st*dt*g-Pt*d),o[1]=x*ie+k*se+j*de,o[2]=C*ie+P*se+q*de,o[3]=D*ie+F*se+te*de,o[4]=y*pe+M*Ee+B*Ie,o[5]=x*pe+k*Ee+j*Ie,o[6]=C*pe+P*Ee+q*Ie,o[7]=D*pe+F*Ee+te*Ie,o[8]=y*Pe+M*Ze+B*je,o[9]=x*Pe+k*Ze+j*je,o[10]=C*Pe+P*Ze+q*je,o[11]=D*Pe+F*Ze+te*je,i!==o&&(o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15]),o)},ti.rotateX=function(o,i,a){var l=Math.sin(a),d=Math.cos(a),p=i[4],g=i[5],y=i[6],x=i[7],C=i[8],D=i[9],M=i[10],k=i[11];return i!==o&&(o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15]),o[4]=p*d+C*l,o[5]=g*d+D*l,o[6]=y*d+M*l,o[7]=x*d+k*l,o[8]=C*d-p*l,o[9]=D*d-g*l,o[10]=M*d-y*l,o[11]=k*d-x*l,o},ti.rotateY=function(o,i,a){var l=Math.sin(a),d=Math.cos(a),p=i[0],g=i[1],y=i[2],x=i[3],C=i[8],D=i[9],M=i[10],k=i[11];return i!==o&&(o[4]=i[4],o[5]=i[5],o[6]=i[6],o[7]=i[7],o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15]),o[0]=p*d-C*l,o[1]=g*d-D*l,o[2]=y*d-M*l,o[3]=x*d-k*l,o[8]=p*l+C*d,o[9]=g*l+D*d,o[10]=y*l+M*d,o[11]=x*l+k*d,o},ti.rotateZ=function(o,i,a){var l=Math.sin(a),d=Math.cos(a),p=i[0],g=i[1],y=i[2],x=i[3],C=i[4],D=i[5],M=i[6],k=i[7];return i!==o&&(o[8]=i[8],o[9]=i[9],o[10]=i[10],o[11]=i[11],o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15]),o[0]=p*d+C*l,o[1]=g*d+D*l,o[2]=y*d+M*l,o[3]=x*d+k*l,o[4]=C*d-p*l,o[5]=D*d-g*l,o[6]=M*d-y*l,o[7]=k*d-x*l,o},ti.fromTranslation=function(o,i){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=i[0],o[13]=i[1],o[14]=i[2],o[15]=1,o},ti.fromScaling=function(o,i){return o[0]=i[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=i[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=i[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},ti.fromRotation=function(o,i,a){var l,d,p,g=a[0],y=a[1],x=a[2],C=Math.hypot(g,y,x);return C<ro.EPSILON?null:(g*=C=1/C,y*=C,x*=C,l=Math.sin(i),d=Math.cos(i),o[0]=g*g*(p=1-d)+d,o[1]=y*g*p+x*l,o[2]=x*g*p-y*l,o[3]=0,o[4]=g*y*p-x*l,o[5]=y*y*p+d,o[6]=x*y*p+g*l,o[7]=0,o[8]=g*x*p+y*l,o[9]=y*x*p-g*l,o[10]=x*x*p+d,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o)},ti.fromXRotation=function(o,i){var a=Math.sin(i),l=Math.cos(i);return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=l,o[6]=a,o[7]=0,o[8]=0,o[9]=-a,o[10]=l,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},ti.fromYRotation=function(o,i){var a=Math.sin(i),l=Math.cos(i);return o[0]=l,o[1]=0,o[2]=-a,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=a,o[9]=0,o[10]=l,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},ti.fromZRotation=function(o,i){var a=Math.sin(i),l=Math.cos(i);return o[0]=l,o[1]=a,o[2]=0,o[3]=0,o[4]=-a,o[5]=l,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},ti.fromRotationTranslation=UD,ti.fromQuat2=function(o,i){var a=new ro.ARRAY_TYPE(3),l=-i[0],d=-i[1],p=-i[2],g=i[3],y=i[4],x=i[5],C=i[6],D=i[7],M=l*l+d*d+p*p+g*g;return M>0?(a[0]=2*(y*g+D*l+x*p-C*d)/M,a[1]=2*(x*g+D*d+C*l-y*p)/M,a[2]=2*(C*g+D*p+y*d-x*l)/M):(a[0]=2*(y*g+D*l+x*p-C*d),a[1]=2*(x*g+D*d+C*l-y*p),a[2]=2*(C*g+D*p+y*d-x*l)),UD(o,i,a),o},ti.getTranslation=function(o,i){return o[0]=i[12],o[1]=i[13],o[2]=i[14],o},ti.getScaling=Jh,ti.getRotation=function(o,i){var a=new ro.ARRAY_TYPE(3);Jh(a,i);var l=1/a[0],d=1/a[1],p=1/a[2],g=i[0]*l,y=i[1]*d,x=i[2]*p,C=i[4]*l,D=i[5]*d,M=i[6]*p,k=i[8]*l,P=i[9]*d,F=i[10]*p,B=g+D+F,j=0;return B>0?(j=2*Math.sqrt(B+1),o[3]=.25*j,o[0]=(M-P)/j,o[1]=(k-x)/j,o[2]=(y-C)/j):g>D&&g>F?(j=2*Math.sqrt(1+g-D-F),o[3]=(M-P)/j,o[0]=.25*j,o[1]=(y+C)/j,o[2]=(k+x)/j):D>F?(j=2*Math.sqrt(1+D-g-F),o[3]=(k-x)/j,o[0]=(y+C)/j,o[1]=.25*j,o[2]=(M+P)/j):(j=2*Math.sqrt(1+F-g-D),o[3]=(y-C)/j,o[0]=(k+x)/j,o[1]=(M+P)/j,o[2]=.25*j),o},ti.fromRotationTranslationScale=function(o,i,a,l){var d=i[0],p=i[1],g=i[2],y=i[3],x=d+d,C=p+p,D=g+g,M=d*x,k=d*C,P=d*D,F=p*C,B=p*D,j=g*D,q=y*x,te=y*C,ie=y*D,se=l[0],de=l[1],pe=l[2];return o[0]=(1-(F+j))*se,o[1]=(k+ie)*se,o[2]=(P-te)*se,o[3]=0,o[4]=(k-ie)*de,o[5]=(1-(M+j))*de,o[6]=(B+q)*de,o[7]=0,o[8]=(P+te)*pe,o[9]=(B-q)*pe,o[10]=(1-(M+F))*pe,o[11]=0,o[12]=a[0],o[13]=a[1],o[14]=a[2],o[15]=1,o},ti.fromRotationTranslationScaleOrigin=function(o,i,a,l,d){var p=i[0],g=i[1],y=i[2],x=i[3],C=p+p,D=g+g,M=y+y,k=p*C,P=p*D,F=p*M,B=g*D,j=g*M,q=y*M,te=x*C,ie=x*D,se=x*M,de=l[0],pe=l[1],Ee=l[2],Ie=d[0],Pe=d[1],Ze=d[2],je=(1-(B+q))*de,dt=(P+se)*de,Pt=(F-ie)*de,st=(P-se)*pe,Tt=(1-(k+q))*pe,et=(j+te)*pe,$t=(F+ie)*Ee,on=(j-te)*Ee,It=(1-(k+B))*Ee;return o[0]=je,o[1]=dt,o[2]=Pt,o[3]=0,o[4]=st,o[5]=Tt,o[6]=et,o[7]=0,o[8]=$t,o[9]=on,o[10]=It,o[11]=0,o[12]=a[0]+Ie-(je*Ie+st*Pe+$t*Ze),o[13]=a[1]+Pe-(dt*Ie+Tt*Pe+on*Ze),o[14]=a[2]+Ze-(Pt*Ie+et*Pe+It*Ze),o[15]=1,o},ti.fromQuat=function(o,i){var a=i[0],l=i[1],d=i[2],p=i[3],g=a+a,y=l+l,x=d+d,C=a*g,D=l*g,M=l*y,k=d*g,P=d*y,F=d*x,B=p*g,j=p*y,q=p*x;return o[0]=1-M-F,o[1]=D+q,o[2]=k-j,o[3]=0,o[4]=D-q,o[5]=1-C-F,o[6]=P+B,o[7]=0,o[8]=k+j,o[9]=P-B,o[10]=1-C-M,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},ti.frustum=function(o,i,a,l,d,p,g){var y=1/(a-i),x=1/(d-l),C=1/(p-g);return o[0]=2*p*y,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*p*x,o[6]=0,o[7]=0,o[8]=(a+i)*y,o[9]=(d+l)*x,o[10]=(g+p)*C,o[11]=-1,o[12]=0,o[13]=0,o[14]=g*p*2*C,o[15]=0,o},ti.perspectiveNO=R1,ti.perspectiveZO=function(o,i,a,l,d){var p,g=1/Math.tan(i/2);return o[0]=g/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=g,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,null!=d&&d!==1/0?(o[10]=d*(p=1/(l-d)),o[14]=d*l*p):(o[10]=-1,o[14]=-l),o},ti.perspectiveFromFieldOfView=function(o,i,a,l){var d=Math.tan(i.upDegrees*Math.PI/180),p=Math.tan(i.downDegrees*Math.PI/180),g=Math.tan(i.leftDegrees*Math.PI/180),y=Math.tan(i.rightDegrees*Math.PI/180),x=2/(g+y),C=2/(d+p);return o[0]=x,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=C,o[6]=0,o[7]=0,o[8]=-(g-y)*x*.5,o[9]=(d-p)*C*.5,o[10]=l/(a-l),o[11]=-1,o[12]=0,o[13]=0,o[14]=l*a/(a-l),o[15]=0,o},ti.orthoNO=P1,ti.orthoZO=function(o,i,a,l,d,p,g){var y=1/(i-a),x=1/(l-d),C=1/(p-g);return o[0]=-2*y,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*x,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=C,o[11]=0,o[12]=(i+a)*y,o[13]=(d+l)*x,o[14]=p*C,o[15]=1,o},ti.lookAt=function(o,i,a,l){var d,p,g,y,x,C,D,M,k,P,F=i[0],B=i[1],j=i[2],q=l[0],te=l[1],ie=l[2],se=a[0],de=a[1],pe=a[2];return Math.abs(F-se)<ro.EPSILON&&Math.abs(B-de)<ro.EPSILON&&Math.abs(j-pe)<ro.EPSILON?VD(o):(D=F-se,M=B-de,k=j-pe,d=te*(k*=P=1/Math.hypot(D,M,k))-ie*(M*=P),p=ie*(D*=P)-q*k,g=q*M-te*D,(P=Math.hypot(d,p,g))?(d*=P=1/P,p*=P,g*=P):(d=0,p=0,g=0),y=M*g-k*p,x=k*d-D*g,C=D*p-M*d,(P=Math.hypot(y,x,C))?(y*=P=1/P,x*=P,C*=P):(y=0,x=0,C=0),o[0]=d,o[1]=y,o[2]=D,o[3]=0,o[4]=p,o[5]=x,o[6]=M,o[7]=0,o[8]=g,o[9]=C,o[10]=k,o[11]=0,o[12]=-(d*F+p*B+g*j),o[13]=-(y*F+x*B+C*j),o[14]=-(D*F+M*B+k*j),o[15]=1,o)},ti.targetTo=function(o,i,a,l){var d=i[0],p=i[1],g=i[2],y=l[0],x=l[1],C=l[2],D=d-a[0],M=p-a[1],k=g-a[2],P=D*D+M*M+k*k;P>0&&(D*=P=1/Math.sqrt(P),M*=P,k*=P);var F=x*k-C*M,B=C*D-y*k,j=y*M-x*D;return(P=F*F+B*B+j*j)>0&&(F*=P=1/Math.sqrt(P),B*=P,j*=P),o[0]=F,o[1]=B,o[2]=j,o[3]=0,o[4]=M*j-k*B,o[5]=k*F-D*j,o[6]=D*B-M*F,o[7]=0,o[8]=D,o[9]=M,o[10]=k,o[11]=0,o[12]=d,o[13]=p,o[14]=g,o[15]=1,o},ti.str=function(o){return"mat4("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+", "+o[4]+", "+o[5]+", "+o[6]+", "+o[7]+", "+o[8]+", "+o[9]+", "+o[10]+", "+o[11]+", "+o[12]+", "+o[13]+", "+o[14]+", "+o[15]+")"},ti.frob=function(o){return Math.hypot(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9],o[10],o[11],o[12],o[13],o[14],o[15])},ti.add=function(o,i,a){return o[0]=i[0]+a[0],o[1]=i[1]+a[1],o[2]=i[2]+a[2],o[3]=i[3]+a[3],o[4]=i[4]+a[4],o[5]=i[5]+a[5],o[6]=i[6]+a[6],o[7]=i[7]+a[7],o[8]=i[8]+a[8],o[9]=i[9]+a[9],o[10]=i[10]+a[10],o[11]=i[11]+a[11],o[12]=i[12]+a[12],o[13]=i[13]+a[13],o[14]=i[14]+a[14],o[15]=i[15]+a[15],o},ti.subtract=Yo,ti.multiplyScalar=function(o,i,a){return o[0]=i[0]*a,o[1]=i[1]*a,o[2]=i[2]*a,o[3]=i[3]*a,o[4]=i[4]*a,o[5]=i[5]*a,o[6]=i[6]*a,o[7]=i[7]*a,o[8]=i[8]*a,o[9]=i[9]*a,o[10]=i[10]*a,o[11]=i[11]*a,o[12]=i[12]*a,o[13]=i[13]*a,o[14]=i[14]*a,o[15]=i[15]*a,o},ti.multiplyScalarAndAdd=function(o,i,a,l){return o[0]=i[0]+a[0]*l,o[1]=i[1]+a[1]*l,o[2]=i[2]+a[2]*l,o[3]=i[3]+a[3]*l,o[4]=i[4]+a[4]*l,o[5]=i[5]+a[5]*l,o[6]=i[6]+a[6]*l,o[7]=i[7]+a[7]*l,o[8]=i[8]+a[8]*l,o[9]=i[9]+a[9]*l,o[10]=i[10]+a[10]*l,o[11]=i[11]+a[11]*l,o[12]=i[12]+a[12]*l,o[13]=i[13]+a[13]*l,o[14]=i[14]+a[14]*l,o[15]=i[15]+a[15]*l,o},ti.exactEquals=function(o,i){return o[0]===i[0]&&o[1]===i[1]&&o[2]===i[2]&&o[3]===i[3]&&o[4]===i[4]&&o[5]===i[5]&&o[6]===i[6]&&o[7]===i[7]&&o[8]===i[8]&&o[9]===i[9]&&o[10]===i[10]&&o[11]===i[11]&&o[12]===i[12]&&o[13]===i[13]&&o[14]===i[14]&&o[15]===i[15]},ti.equals=function(o,i){var a=o[0],l=o[1],d=o[2],p=o[3],g=o[4],y=o[5],x=o[6],C=o[7],D=o[8],M=o[9],k=o[10],P=o[11],F=o[12],B=o[13],j=o[14],q=o[15],te=i[0],ie=i[1],se=i[2],de=i[3],pe=i[4],Ee=i[5],Ie=i[6],Pe=i[7],Ze=i[8],je=i[9],dt=i[10],Pt=i[11],st=i[12],Tt=i[13],et=i[14],$t=i[15];return Math.abs(a-te)<=ro.EPSILON*Math.max(1,Math.abs(a),Math.abs(te))&&Math.abs(l-ie)<=ro.EPSILON*Math.max(1,Math.abs(l),Math.abs(ie))&&Math.abs(d-se)<=ro.EPSILON*Math.max(1,Math.abs(d),Math.abs(se))&&Math.abs(p-de)<=ro.EPSILON*Math.max(1,Math.abs(p),Math.abs(de))&&Math.abs(g-pe)<=ro.EPSILON*Math.max(1,Math.abs(g),Math.abs(pe))&&Math.abs(y-Ee)<=ro.EPSILON*Math.max(1,Math.abs(y),Math.abs(Ee))&&Math.abs(x-Ie)<=ro.EPSILON*Math.max(1,Math.abs(x),Math.abs(Ie))&&Math.abs(C-Pe)<=ro.EPSILON*Math.max(1,Math.abs(C),Math.abs(Pe))&&Math.abs(D-Ze)<=ro.EPSILON*Math.max(1,Math.abs(D),Math.abs(Ze))&&Math.abs(M-je)<=ro.EPSILON*Math.max(1,Math.abs(M),Math.abs(je))&&Math.abs(k-dt)<=ro.EPSILON*Math.max(1,Math.abs(k),Math.abs(dt))&&Math.abs(P-Pt)<=ro.EPSILON*Math.max(1,Math.abs(P),Math.abs(Pt))&&Math.abs(F-st)<=ro.EPSILON*Math.max(1,Math.abs(F),Math.abs(st))&&Math.abs(B-Tt)<=ro.EPSILON*Math.max(1,Math.abs(B),Math.abs(Tt))&&Math.abs(j-et)<=ro.EPSILON*Math.max(1,Math.abs(j),Math.abs(et))&&Math.abs(q-$t)<=ro.EPSILON*Math.max(1,Math.abs(q),Math.abs($t))},ti.sub=ti.mul=ti.ortho=ti.perspective=void 0;var ro=function(o,i){if(o&&o.__esModule)return o;if(null===o||"object"!==k1(o)&&"function"!=typeof o)return{default:o};var a=zD(void 0);if(a&&a.has(o))return a.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in o)if("default"!==p&&Object.prototype.hasOwnProperty.call(o,p)){var g=d?Object.getOwnPropertyDescriptor(o,p):null;g&&(g.get||g.set)?Object.defineProperty(l,p,g):l[p]=o[p]}return l.default=o,a&&a.set(o,l),l}(Ro);function zD(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,a=new WeakMap;return(zD=function(l){return l?a:i})(o)}function VD(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function jD(o,i,a){var l=i[0],d=i[1],p=i[2],g=i[3],y=i[4],x=i[5],C=i[6],D=i[7],M=i[8],k=i[9],P=i[10],F=i[11],B=i[12],j=i[13],q=i[14],te=i[15],ie=a[0],se=a[1],de=a[2],pe=a[3];return o[0]=ie*l+se*y+de*M+pe*B,o[1]=ie*d+se*x+de*k+pe*j,o[2]=ie*p+se*C+de*P+pe*q,o[3]=ie*g+se*D+de*F+pe*te,o[4]=(ie=a[4])*l+(se=a[5])*y+(de=a[6])*M+(pe=a[7])*B,o[5]=ie*d+se*x+de*k+pe*j,o[6]=ie*p+se*C+de*P+pe*q,o[7]=ie*g+se*D+de*F+pe*te,o[8]=(ie=a[8])*l+(se=a[9])*y+(de=a[10])*M+(pe=a[11])*B,o[9]=ie*d+se*x+de*k+pe*j,o[10]=ie*p+se*C+de*P+pe*q,o[11]=ie*g+se*D+de*F+pe*te,o[12]=(ie=a[12])*l+(se=a[13])*y+(de=a[14])*M+(pe=a[15])*B,o[13]=ie*d+se*x+de*k+pe*j,o[14]=ie*p+se*C+de*P+pe*q,o[15]=ie*g+se*D+de*F+pe*te,o}function UD(o,i,a){var l=i[0],d=i[1],p=i[2],g=i[3],y=l+l,x=d+d,C=p+p,D=l*y,M=l*x,k=l*C,P=d*x,F=d*C,B=p*C,j=g*y,q=g*x,te=g*C;return o[0]=1-(P+B),o[1]=M+te,o[2]=k-q,o[3]=0,o[4]=M-te,o[5]=1-(D+B),o[6]=F+j,o[7]=0,o[8]=k+q,o[9]=F-j,o[10]=1-(D+P),o[11]=0,o[12]=a[0],o[13]=a[1],o[14]=a[2],o[15]=1,o}function Jh(o,i){var a=i[4],l=i[5],d=i[6],p=i[8],g=i[9],y=i[10];return o[0]=Math.hypot(i[0],i[1],i[2]),o[1]=Math.hypot(a,l,d),o[2]=Math.hypot(p,g,y),o}function R1(o,i,a,l,d){var p,g=1/Math.tan(i/2);return o[0]=g/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=g,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,null!=d&&d!==1/0?(o[10]=(d+l)*(p=1/(l-d)),o[14]=2*d*l*p):(o[10]=-1,o[14]=-2*l),o}function P1(o,i,a,l,d,p,g){var y=1/(i-a),x=1/(l-d),C=1/(p-g);return o[0]=-2*y,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*x,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*C,o[11]=0,o[12]=(i+a)*y,o[13]=(d+l)*x,o[14]=(g+p)*C,o[15]=1,o}function Yo(o,i,a){return o[0]=i[0]-a[0],o[1]=i[1]-a[1],o[2]=i[2]-a[2],o[3]=i[3]-a[3],o[4]=i[4]-a[4],o[5]=i[5]-a[5],o[6]=i[6]-a[6],o[7]=i[7]-a[7],o[8]=i[8]-a[8],o[9]=i[9]-a[9],o[10]=i[10]-a[10],o[11]=i[11]-a[11],o[12]=i[12]-a[12],o[13]=i[13]-a[13],o[14]=i[14]-a[14],o[15]=i[15]-a[15],o}ti.perspective=R1,ti.ortho=P1,ti.mul=jD,ti.sub=Yo;var Yn={},qn={};function Jv(o){return(Jv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}Object.defineProperty(qn,"__esModule",{value:!0}),qn.create=eb,qn.clone=function(o){var i=new Xo.ARRAY_TYPE(3);return i[0]=o[0],i[1]=o[1],i[2]=o[2],i},qn.length=Km,qn.fromValues=function(o,i,a){var l=new Xo.ARRAY_TYPE(3);return l[0]=o,l[1]=i,l[2]=a,l},qn.copy=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o},qn.set=function(o,i,a,l){return o[0]=i,o[1]=a,o[2]=l,o},qn.add=function(o,i,a){return o[0]=i[0]+a[0],o[1]=i[1]+a[1],o[2]=i[2]+a[2],o},qn.subtract=gp,qn.multiply=O1,qn.divide=HD,qn.ceil=function(o,i){return o[0]=Math.ceil(i[0]),o[1]=Math.ceil(i[1]),o[2]=Math.ceil(i[2]),o},qn.floor=function(o,i){return o[0]=Math.floor(i[0]),o[1]=Math.floor(i[1]),o[2]=Math.floor(i[2]),o},qn.min=function(o,i,a){return o[0]=Math.min(i[0],a[0]),o[1]=Math.min(i[1],a[1]),o[2]=Math.min(i[2],a[2]),o},qn.max=function(o,i,a){return o[0]=Math.max(i[0],a[0]),o[1]=Math.max(i[1],a[1]),o[2]=Math.max(i[2],a[2]),o},qn.round=function(o,i){return o[0]=Math.round(i[0]),o[1]=Math.round(i[1]),o[2]=Math.round(i[2]),o},qn.scale=function(o,i,a){return o[0]=i[0]*a,o[1]=i[1]*a,o[2]=i[2]*a,o},qn.scaleAndAdd=function(o,i,a,l){return o[0]=i[0]+a[0]*l,o[1]=i[1]+a[1]*l,o[2]=i[2]+a[2]*l,o},qn.distance=F1,qn.squaredDistance=$D,qn.squaredLength=Da,qn.negate=function(o,i){return o[0]=-i[0],o[1]=-i[1],o[2]=-i[2],o},qn.inverse=function(o,i){return o[0]=1/i[0],o[1]=1/i[1],o[2]=1/i[2],o},qn.normalize=function(o,i){var a=i[0],l=i[1],d=i[2],p=a*a+l*l+d*d;return p>0&&(p=1/Math.sqrt(p)),o[0]=i[0]*p,o[1]=i[1]*p,o[2]=i[2]*p,o},qn.dot=W_,qn.cross=function(o,i,a){var l=i[0],d=i[1],p=i[2],g=a[0],y=a[1],x=a[2];return o[0]=d*x-p*y,o[1]=p*g-l*x,o[2]=l*y-d*g,o},qn.lerp=function(o,i,a,l){var d=i[0],p=i[1],g=i[2];return o[0]=d+l*(a[0]-d),o[1]=p+l*(a[1]-p),o[2]=g+l*(a[2]-g),o},qn.hermite=function(o,i,a,l,d,p){var g=p*p,y=g*(2*p-3)+1,x=g*(p-2)+p,C=g*(p-1),D=g*(3-2*p);return o[0]=i[0]*y+a[0]*x+l[0]*C+d[0]*D,o[1]=i[1]*y+a[1]*x+l[1]*C+d[1]*D,o[2]=i[2]*y+a[2]*x+l[2]*C+d[2]*D,o},qn.bezier=function(o,i,a,l,d,p){var g=1-p,y=g*g,x=p*p,C=y*g,D=3*p*y,M=3*x*g,k=x*p;return o[0]=i[0]*C+a[0]*D+l[0]*M+d[0]*k,o[1]=i[1]*C+a[1]*D+l[1]*M+d[1]*k,o[2]=i[2]*C+a[2]*D+l[2]*M+d[2]*k,o},qn.random=function(o,i){i=i||1;var a=2*Xo.RANDOM()*Math.PI,l=2*Xo.RANDOM()-1,d=Math.sqrt(1-l*l)*i;return o[0]=Math.cos(a)*d,o[1]=Math.sin(a)*d,o[2]=l*i,o},qn.transformMat4=function(o,i,a){var l=i[0],d=i[1],p=i[2],g=a[3]*l+a[7]*d+a[11]*p+a[15];return o[0]=(a[0]*l+a[4]*d+a[8]*p+a[12])/(g=g||1),o[1]=(a[1]*l+a[5]*d+a[9]*p+a[13])/g,o[2]=(a[2]*l+a[6]*d+a[10]*p+a[14])/g,o},qn.transformMat3=function(o,i,a){var l=i[0],d=i[1],p=i[2];return o[0]=l*a[0]+d*a[3]+p*a[6],o[1]=l*a[1]+d*a[4]+p*a[7],o[2]=l*a[2]+d*a[5]+p*a[8],o},qn.transformQuat=function(o,i,a){var l=a[0],d=a[1],p=a[2],g=i[0],y=i[1],x=i[2],C=d*x-p*y,D=p*g-l*x,M=l*y-d*g,k=d*M-p*D,P=p*C-l*M,F=l*D-d*C,B=2*a[3];return D*=B,M*=B,P*=2,F*=2,o[0]=g+(C*=B)+(k*=2),o[1]=y+D+P,o[2]=x+M+F,o},qn.rotateX=function(o,i,a,l){var d=[],p=[];return d[0]=i[0]-a[0],d[1]=i[1]-a[1],d[2]=i[2]-a[2],p[0]=d[0],p[1]=d[1]*Math.cos(l)-d[2]*Math.sin(l),p[2]=d[1]*Math.sin(l)+d[2]*Math.cos(l),o[0]=p[0]+a[0],o[1]=p[1]+a[1],o[2]=p[2]+a[2],o},qn.rotateY=function(o,i,a,l){var d=[],p=[];return d[0]=i[0]-a[0],d[1]=i[1]-a[1],d[2]=i[2]-a[2],p[0]=d[2]*Math.sin(l)+d[0]*Math.cos(l),p[1]=d[1],p[2]=d[2]*Math.cos(l)-d[0]*Math.sin(l),o[0]=p[0]+a[0],o[1]=p[1]+a[1],o[2]=p[2]+a[2],o},qn.rotateZ=function(o,i,a,l){var d=[],p=[];return d[0]=i[0]-a[0],d[1]=i[1]-a[1],d[2]=i[2]-a[2],p[0]=d[0]*Math.cos(l)-d[1]*Math.sin(l),p[1]=d[0]*Math.sin(l)+d[1]*Math.cos(l),p[2]=d[2],o[0]=p[0]+a[0],o[1]=p[1]+a[1],o[2]=p[2]+a[2],o},qn.angle=function(o,i){var a=o[0],l=o[1],d=o[2],p=i[0],g=i[1],y=i[2],x=Math.sqrt(a*a+l*l+d*d)*Math.sqrt(p*p+g*g+y*y),C=x&&W_(o,i)/x;return Math.acos(Math.min(Math.max(C,-1),1))},qn.zero=function(o){return o[0]=0,o[1]=0,o[2]=0,o},qn.str=function(o){return"vec3("+o[0]+", "+o[1]+", "+o[2]+")"},qn.exactEquals=function(o,i){return o[0]===i[0]&&o[1]===i[1]&&o[2]===i[2]},qn.equals=function(o,i){var a=o[0],l=o[1],d=o[2],p=i[0],g=i[1],y=i[2];return Math.abs(a-p)<=Xo.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(l-g)<=Xo.EPSILON*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(d-y)<=Xo.EPSILON*Math.max(1,Math.abs(d),Math.abs(y))},qn.forEach=qn.sqrLen=qn.len=qn.sqrDist=qn.dist=qn.div=qn.mul=qn.sub=void 0;var Xo=function(o,i){if(o&&o.__esModule)return o;if(null===o||"object"!==Jv(o)&&"function"!=typeof o)return{default:o};var a=ef(void 0);if(a&&a.has(o))return a.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in o)if("default"!==p&&Object.prototype.hasOwnProperty.call(o,p)){var g=d?Object.getOwnPropertyDescriptor(o,p):null;g&&(g.get||g.set)?Object.defineProperty(l,p,g):l[p]=o[p]}return l.default=o,a&&a.set(o,l),l}(Ro);function ef(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,a=new WeakMap;return(ef=function(l){return l?a:i})(o)}function eb(){var o=new Xo.ARRAY_TYPE(3);return Xo.ARRAY_TYPE!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function Km(o){return Math.hypot(o[0],o[1],o[2])}function gp(o,i,a){return o[0]=i[0]-a[0],o[1]=i[1]-a[1],o[2]=i[2]-a[2],o}function O1(o,i,a){return o[0]=i[0]*a[0],o[1]=i[1]*a[1],o[2]=i[2]*a[2],o}function HD(o,i,a){return o[0]=i[0]/a[0],o[1]=i[1]/a[1],o[2]=i[2]/a[2],o}function F1(o,i){return Math.hypot(i[0]-o[0],i[1]-o[1],i[2]-o[2])}function $D(o,i){var a=i[0]-o[0],l=i[1]-o[1],d=i[2]-o[2];return a*a+l*l+d*d}function Da(o){var i=o[0],a=o[1],l=o[2];return i*i+a*a+l*l}function W_(o,i){return o[0]*i[0]+o[1]*i[1]+o[2]*i[2]}qn.sub=gp,qn.mul=O1,qn.div=HD,qn.dist=F1,qn.sqrDist=$D,qn.len=Km,qn.sqrLen=Da;var Ta,KA=(Ta=eb(),function(o,i,a,l,d,p){var g,y;for(i||(i=3),a||(a=0),y=l?Math.min(l*i+a,o.length):o.length,g=a;g<y;g+=i)Ta[0]=o[g],Ta[1]=o[g+1],Ta[2]=o[g+2],d(Ta,Ta,p),o[g]=Ta[0],o[g+1]=Ta[1],o[g+2]=Ta[2];return o});qn.forEach=KA;var di={};function tb(o){return(tb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}Object.defineProperty(di,"__esModule",{value:!0}),di.create=N1,di.clone=function(o){var i=new Pl.ARRAY_TYPE(4);return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i},di.fromValues=function(o,i,a,l){var d=new Pl.ARRAY_TYPE(4);return d[0]=o,d[1]=i,d[2]=a,d[3]=l,d},di.copy=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o},di.set=function(o,i,a,l,d){return o[0]=i,o[1]=a,o[2]=l,o[3]=d,o},di.add=function(o,i,a){return o[0]=i[0]+a[0],o[1]=i[1]+a[1],o[2]=i[2]+a[2],o[3]=i[3]+a[3],o},di.subtract=B1,di.multiply=z1,di.divide=Z_,di.ceil=function(o,i){return o[0]=Math.ceil(i[0]),o[1]=Math.ceil(i[1]),o[2]=Math.ceil(i[2]),o[3]=Math.ceil(i[3]),o},di.floor=function(o,i){return o[0]=Math.floor(i[0]),o[1]=Math.floor(i[1]),o[2]=Math.floor(i[2]),o[3]=Math.floor(i[3]),o},di.min=function(o,i,a){return o[0]=Math.min(i[0],a[0]),o[1]=Math.min(i[1],a[1]),o[2]=Math.min(i[2],a[2]),o[3]=Math.min(i[3],a[3]),o},di.max=function(o,i,a){return o[0]=Math.max(i[0],a[0]),o[1]=Math.max(i[1],a[1]),o[2]=Math.max(i[2],a[2]),o[3]=Math.max(i[3],a[3]),o},di.round=function(o,i){return o[0]=Math.round(i[0]),o[1]=Math.round(i[1]),o[2]=Math.round(i[2]),o[3]=Math.round(i[3]),o},di.scale=function(o,i,a){return o[0]=i[0]*a,o[1]=i[1]*a,o[2]=i[2]*a,o[3]=i[3]*a,o},di.scaleAndAdd=function(o,i,a,l){return o[0]=i[0]+a[0]*l,o[1]=i[1]+a[1]*l,o[2]=i[2]+a[2]*l,o[3]=i[3]+a[3]*l,o},di.distance=Qm,di.squaredDistance=V1,di.length=Bd,di.squaredLength=j1,di.negate=function(o,i){return o[0]=-i[0],o[1]=-i[1],o[2]=-i[2],o[3]=-i[3],o},di.inverse=function(o,i){return o[0]=1/i[0],o[1]=1/i[1],o[2]=1/i[2],o[3]=1/i[3],o},di.normalize=function(o,i){var a=i[0],l=i[1],d=i[2],p=i[3],g=a*a+l*l+d*d+p*p;return g>0&&(g=1/Math.sqrt(g)),o[0]=a*g,o[1]=l*g,o[2]=d*g,o[3]=p*g,o},di.dot=function(o,i){return o[0]*i[0]+o[1]*i[1]+o[2]*i[2]+o[3]*i[3]},di.cross=function(o,i,a,l){var d=a[0]*l[1]-a[1]*l[0],p=a[0]*l[2]-a[2]*l[0],g=a[0]*l[3]-a[3]*l[0],y=a[1]*l[2]-a[2]*l[1],x=a[1]*l[3]-a[3]*l[1],C=a[2]*l[3]-a[3]*l[2],D=i[0],M=i[1],k=i[2],P=i[3];return o[0]=M*C-k*x+P*y,o[1]=-D*C+k*g-P*p,o[2]=D*x-M*g+P*d,o[3]=-D*y+M*p-k*d,o},di.lerp=function(o,i,a,l){var d=i[0],p=i[1],g=i[2],y=i[3];return o[0]=d+l*(a[0]-d),o[1]=p+l*(a[1]-p),o[2]=g+l*(a[2]-g),o[3]=y+l*(a[3]-y),o},di.random=function(o,i){var a,l,d,p,g,y;i=i||1;do{g=(a=2*Pl.RANDOM()-1)*a+(l=2*Pl.RANDOM()-1)*l}while(g>=1);do{y=(d=2*Pl.RANDOM()-1)*d+(p=2*Pl.RANDOM()-1)*p}while(y>=1);var x=Math.sqrt((1-g)/y);return o[0]=i*a,o[1]=i*l,o[2]=i*d*x,o[3]=i*p*x,o},di.transformMat4=function(o,i,a){var l=i[0],d=i[1],p=i[2],g=i[3];return o[0]=a[0]*l+a[4]*d+a[8]*p+a[12]*g,o[1]=a[1]*l+a[5]*d+a[9]*p+a[13]*g,o[2]=a[2]*l+a[6]*d+a[10]*p+a[14]*g,o[3]=a[3]*l+a[7]*d+a[11]*p+a[15]*g,o},di.transformQuat=function(o,i,a){var l=i[0],d=i[1],p=i[2],g=a[0],y=a[1],x=a[2],C=a[3],D=C*l+y*p-x*d,M=C*d+x*l-g*p,k=C*p+g*d-y*l,P=-g*l-y*d-x*p;return o[0]=D*C+P*-g+M*-x-k*-y,o[1]=M*C+P*-y+k*-g-D*-x,o[2]=k*C+P*-x+D*-y-M*-g,o[3]=i[3],o},di.zero=function(o){return o[0]=0,o[1]=0,o[2]=0,o[3]=0,o},di.str=function(o){return"vec4("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+")"},di.exactEquals=function(o,i){return o[0]===i[0]&&o[1]===i[1]&&o[2]===i[2]&&o[3]===i[3]},di.equals=function(o,i){var a=o[0],l=o[1],d=o[2],p=o[3],g=i[0],y=i[1],x=i[2],C=i[3];return Math.abs(a-g)<=Pl.EPSILON*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(l-y)<=Pl.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(d-x)<=Pl.EPSILON*Math.max(1,Math.abs(d),Math.abs(x))&&Math.abs(p-C)<=Pl.EPSILON*Math.max(1,Math.abs(p),Math.abs(C))},di.forEach=di.sqrLen=di.len=di.sqrDist=di.dist=di.div=di.mul=di.sub=void 0;var Pl=function(o,i){if(o&&o.__esModule)return o;if(null===o||"object"!==tb(o)&&"function"!=typeof o)return{default:o};var a=L1(void 0);if(a&&a.has(o))return a.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in o)if("default"!==p&&Object.prototype.hasOwnProperty.call(o,p)){var g=d?Object.getOwnPropertyDescriptor(o,p):null;g&&(g.get||g.set)?Object.defineProperty(l,p,g):l[p]=o[p]}return l.default=o,a&&a.set(o,l),l}(Ro);function L1(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,a=new WeakMap;return(L1=function(l){return l?a:i})(o)}function N1(){var o=new Pl.ARRAY_TYPE(4);return Pl.ARRAY_TYPE!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0,o[3]=0),o}function B1(o,i,a){return o[0]=i[0]-a[0],o[1]=i[1]-a[1],o[2]=i[2]-a[2],o[3]=i[3]-a[3],o}function z1(o,i,a){return o[0]=i[0]*a[0],o[1]=i[1]*a[1],o[2]=i[2]*a[2],o[3]=i[3]*a[3],o}function Z_(o,i,a){return o[0]=i[0]/a[0],o[1]=i[1]/a[1],o[2]=i[2]/a[2],o[3]=i[3]/a[3],o}function Qm(o,i){return Math.hypot(i[0]-o[0],i[1]-o[1],i[2]-o[2],i[3]-o[3])}function V1(o,i){var a=i[0]-o[0],l=i[1]-o[1],d=i[2]-o[2],p=i[3]-o[3];return a*a+l*l+d*d+p*p}function Bd(o){return Math.hypot(o[0],o[1],o[2],o[3])}function j1(o){var i=o[0],a=o[1],l=o[2],d=o[3];return i*i+a*a+l*l+d*d}di.sub=B1,di.mul=z1,di.div=Z_,di.dist=Qm,di.sqrDist=V1,di.len=Bd,di.sqrLen=j1;var tf=function(){var o=N1();return function(i,a,l,d,p,g){var y,x;for(a||(a=4),l||(l=0),x=d?Math.min(d*a+l,i.length):i.length,y=l;y<x;y+=a)o[0]=i[y],o[1]=i[y+1],o[2]=i[y+2],o[3]=i[y+3],p(o,o,g),i[y]=o[0],i[y+1]=o[1],i[y+2]=o[2],i[y+3]=o[3];return i}}();function nb(o){return(nb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}di.forEach=tf,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.create=Vd,Yn.identity=function(o){return o[0]=0,o[1]=0,o[2]=0,o[3]=1,o},Yn.setAxisAngle=_p,Yn.getAxisAngle=function(o,i){var a=2*Math.acos(i[3]),l=Math.sin(a/2);return l>zd.EPSILON?(o[0]=i[0]/l,o[1]=i[1]/l,o[2]=i[2]/l):(o[0]=1,o[1]=0,o[2]=0),a},Yn.getAngle=function(o,i){var a=G1(o,i);return Math.acos(2*a*a-1)},Yn.multiply=H1,Yn.rotateX=function(o,i,a){a*=.5;var l=i[0],d=i[1],p=i[2],g=i[3],y=Math.sin(a),x=Math.cos(a);return o[0]=l*x+g*y,o[1]=d*x+p*y,o[2]=p*x-d*y,o[3]=g*x-l*y,o},Yn.rotateY=function(o,i,a){a*=.5;var l=i[0],d=i[1],p=i[2],g=i[3],y=Math.sin(a),x=Math.cos(a);return o[0]=l*x-p*y,o[1]=d*x+g*y,o[2]=p*x+l*y,o[3]=g*x-d*y,o},Yn.rotateZ=function(o,i,a){a*=.5;var l=i[0],d=i[1],p=i[2],g=i[3],y=Math.sin(a),x=Math.cos(a);return o[0]=l*x+d*y,o[1]=d*x-l*y,o[2]=p*x+g*y,o[3]=g*x-p*y,o},Yn.calculateW=function(o,i){var a=i[0],l=i[1],d=i[2];return o[0]=a,o[1]=l,o[2]=d,o[3]=Math.sqrt(Math.abs(1-a*a-l*l-d*d)),o},Yn.exp=GD,Yn.ln=rb,Yn.pow=function(o,i,a){return rb(o,i),$1(o,o,a),GD(o,o),o},Yn.slerp=X_,Yn.random=function(o){var i=zd.RANDOM(),a=zd.RANDOM(),l=zd.RANDOM(),d=Math.sqrt(1-i),p=Math.sqrt(i);return o[0]=d*Math.sin(2*Math.PI*a),o[1]=d*Math.cos(2*Math.PI*a),o[2]=p*Math.sin(2*Math.PI*l),o[3]=p*Math.cos(2*Math.PI*l),o},Yn.invert=function(o,i){var a=i[0],l=i[1],d=i[2],p=i[3],g=a*a+l*l+d*d+p*p,y=g?1/g:0;return o[0]=-a*y,o[1]=-l*y,o[2]=-d*y,o[3]=p*y,o},Yn.conjugate=function(o,i){return o[0]=-i[0],o[1]=-i[1],o[2]=-i[2],o[3]=i[3],o},Yn.fromMat3=qD,Yn.fromEuler=function(o,i,a,l){var d=.5*Math.PI/180;i*=d,a*=d,l*=d;var p=Math.sin(i),g=Math.cos(i),y=Math.sin(a),x=Math.cos(a),C=Math.sin(l),D=Math.cos(l);return o[0]=p*x*D-g*y*C,o[1]=g*y*D+p*x*C,o[2]=g*x*C-p*y*D,o[3]=g*x*D+p*y*C,o},Yn.str=function(o){return"quat("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+")"},Yn.setAxes=Yn.sqlerp=Yn.rotationTo=Yn.equals=Yn.exactEquals=Yn.normalize=Yn.sqrLen=Yn.squaredLength=Yn.len=Yn.length=Yn.lerp=Yn.dot=Yn.scale=Yn.mul=Yn.add=Yn.set=Yn.copy=Yn.fromValues=Yn.clone=void 0;var zd=Y_(Ro),ib=Y_(Hi),Ol=Y_(qn),Sa=Y_(di);function U1(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,a=new WeakMap;return(U1=function(l){return l?a:i})(o)}function Y_(o,i){if(!i&&o&&o.__esModule)return o;if(null===o||"object"!==nb(o)&&"function"!=typeof o)return{default:o};var a=U1(i);if(a&&a.has(o))return a.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in o)if("default"!==p&&Object.prototype.hasOwnProperty.call(o,p)){var g=d?Object.getOwnPropertyDescriptor(o,p):null;g&&(g.get||g.set)?Object.defineProperty(l,p,g):l[p]=o[p]}return l.default=o,a&&a.set(o,l),l}function Vd(){var o=new zd.ARRAY_TYPE(4);return zd.ARRAY_TYPE!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function _p(o,i,a){a*=.5;var l=Math.sin(a);return o[0]=l*i[0],o[1]=l*i[1],o[2]=l*i[2],o[3]=Math.cos(a),o}function H1(o,i,a){var l=i[0],d=i[1],p=i[2],g=i[3],y=a[0],x=a[1],C=a[2],D=a[3];return o[0]=l*D+g*y+d*C-p*x,o[1]=d*D+g*x+p*y-l*C,o[2]=p*D+g*C+l*x-d*y,o[3]=g*D-l*y-d*x-p*C,o}function GD(o,i){var a=i[0],l=i[1],d=i[2],p=i[3],g=Math.sqrt(a*a+l*l+d*d),y=Math.exp(p),x=g>0?y*Math.sin(g)/g:0;return o[0]=a*x,o[1]=l*x,o[2]=d*x,o[3]=y*Math.cos(g),o}function rb(o,i){var a=i[0],l=i[1],d=i[2],p=i[3],g=Math.sqrt(a*a+l*l+d*d),y=g>0?Math.atan2(g,p)/g:0;return o[0]=a*y,o[1]=l*y,o[2]=d*y,o[3]=.5*Math.log(a*a+l*l+d*d+p*p),o}function X_(o,i,a,l){var d,p,g,y,x,C=i[0],D=i[1],M=i[2],k=i[3],P=a[0],F=a[1],B=a[2],j=a[3];return(p=C*P+D*F+M*B+k*j)<0&&(p=-p,P=-P,F=-F,B=-B,j=-j),1-p>zd.EPSILON?(d=Math.acos(p),g=Math.sin(d),y=Math.sin((1-l)*d)/g,x=Math.sin(l*d)/g):(y=1-l,x=l),o[0]=y*C+x*P,o[1]=y*D+x*F,o[2]=y*M+x*B,o[3]=y*k+x*j,o}function qD(o,i){var a,l=i[0]+i[4]+i[8];if(l>0)a=Math.sqrt(l+1),o[3]=.5*a,o[0]=(i[5]-i[7])*(a=.5/a),o[1]=(i[6]-i[2])*a,o[2]=(i[1]-i[3])*a;else{var d=0;i[4]>i[0]&&(d=1),i[8]>i[3*d+d]&&(d=2);var p=(d+1)%3,g=(d+2)%3;a=Math.sqrt(i[3*d+d]-i[3*p+p]-i[3*g+g]+1),o[d]=.5*a,o[3]=(i[3*p+g]-i[3*g+p])*(a=.5/a),o[p]=(i[3*p+d]+i[3*d+p])*a,o[g]=(i[3*g+d]+i[3*d+g])*a}return o}Yn.clone=Sa.clone,Yn.fromValues=Sa.fromValues,Yn.copy=Sa.copy,Yn.set=Sa.set,Yn.add=Sa.add,Yn.mul=H1;var $1=Sa.scale;Yn.scale=$1;var G1=Sa.dot;Yn.dot=G1,Yn.lerp=Sa.lerp;var q1=Sa.length;Yn.length=q1,Yn.len=q1;var Jm=Sa.squaredLength;Yn.squaredLength=Jm,Yn.sqrLen=Jm;var K_=Sa.normalize;Yn.normalize=K_,Yn.exactEquals=Sa.exactEquals,Yn.equals=Sa.equals;var hc,ob,WD,W1=(hc=Ol.create(),ob=Ol.fromValues(1,0,0),WD=Ol.fromValues(0,1,0),function(o,i,a){var l=Ol.dot(i,a);return l<-.999999?(Ol.cross(hc,ob,i),Ol.len(hc)<1e-6&&Ol.cross(hc,WD,i),Ol.normalize(hc,hc),_p(o,hc,Math.PI),o):l>.999999?(o[0]=0,o[1]=0,o[2]=0,o[3]=1,o):(Ol.cross(hc,i,a),o[0]=hc[0],o[1]=hc[1],o[2]=hc[2],o[3]=1+l,K_(o,o))});Yn.rotationTo=W1;var Z1,sb,ZD=(Z1=Vd(),sb=Vd(),function(o,i,a,l,d,p){return X_(Z1,i,d,p),X_(sb,a,l,p),X_(o,Z1,sb,2*p*(1-p)),o});Yn.sqlerp=ZD;var Ja,QA=(Ja=ib.create(),function(o,i,a,l){return Ja[0]=a[0],Ja[3]=a[1],Ja[6]=a[2],Ja[1]=l[0],Ja[4]=l[1],Ja[7]=l[2],Ja[2]=-i[0],Ja[5]=-i[1],Ja[8]=-i[2],K_(o,qD(o,Ja))});Yn.setAxes=QA;var Ei={};function eg(o){return(eg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.create=function(){var o=new Ma.ARRAY_TYPE(8);return Ma.ARRAY_TYPE!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0,o[4]=0,o[5]=0,o[6]=0,o[7]=0),o[3]=1,o},Ei.clone=function(o){var i=new Ma.ARRAY_TYPE(8);return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i[4]=o[4],i[5]=o[5],i[6]=o[6],i[7]=o[7],i},Ei.fromValues=function(o,i,a,l,d,p,g,y){var x=new Ma.ARRAY_TYPE(8);return x[0]=o,x[1]=i,x[2]=a,x[3]=l,x[4]=d,x[5]=p,x[6]=g,x[7]=y,x},Ei.fromRotationTranslationValues=function(o,i,a,l,d,p,g){var y=new Ma.ARRAY_TYPE(8);y[0]=o,y[1]=i,y[2]=a,y[3]=l;var x=.5*d,C=.5*p,D=.5*g;return y[4]=x*l+C*a-D*i,y[5]=C*l+D*o-x*a,y[6]=D*l+x*i-C*o,y[7]=-x*o-C*i-D*a,y},Ei.fromRotationTranslation=X1,Ei.fromTranslation=function(o,i){return o[0]=0,o[1]=0,o[2]=0,o[3]=1,o[4]=.5*i[0],o[5]=.5*i[1],o[6]=.5*i[2],o[7]=0,o},Ei.fromRotation=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o[4]=0,o[5]=0,o[6]=0,o[7]=0,o},Ei.fromMat4=function(o,i){var a=jd.create();YD.getRotation(a,i);var l=new Ma.ARRAY_TYPE(3);return YD.getTranslation(l,i),X1(o,a,l),o},Ei.copy=tg,Ei.identity=function(o){return o[0]=0,o[1]=0,o[2]=0,o[3]=1,o[4]=0,o[5]=0,o[6]=0,o[7]=0,o},Ei.set=function(o,i,a,l,d,p,g,y,x){return o[0]=i,o[1]=a,o[2]=l,o[3]=d,o[4]=p,o[5]=g,o[6]=y,o[7]=x,o},Ei.getDual=function(o,i){return o[0]=i[4],o[1]=i[5],o[2]=i[6],o[3]=i[7],o},Ei.setDual=function(o,i){return o[4]=i[0],o[5]=i[1],o[6]=i[2],o[7]=i[3],o},Ei.getTranslation=function(o,i){var a=i[4],l=i[5],d=i[6],p=i[7],g=-i[0],y=-i[1],x=-i[2],C=i[3];return o[0]=2*(a*C+p*g+l*x-d*y),o[1]=2*(l*C+p*y+d*g-a*x),o[2]=2*(d*C+p*x+a*y-l*g),o},Ei.translate=function(o,i,a){var l=i[0],d=i[1],p=i[2],g=i[3],y=.5*a[0],x=.5*a[1],C=.5*a[2],D=i[4],M=i[5],k=i[6],P=i[7];return o[0]=l,o[1]=d,o[2]=p,o[3]=g,o[4]=g*y+d*C-p*x+D,o[5]=g*x+p*y-l*C+M,o[6]=g*C+l*x-d*y+k,o[7]=-l*y-d*x-p*C+P,o},Ei.rotateX=function(o,i,a){var l=-i[0],d=-i[1],p=-i[2],g=i[3],y=i[4],x=i[5],C=i[6],D=i[7],M=y*g+D*l+x*p-C*d,k=x*g+D*d+C*l-y*p,P=C*g+D*p+y*d-x*l,F=D*g-y*l-x*d-C*p;return jd.rotateX(o,i,a),o[4]=M*(g=o[3])+F*(l=o[0])+k*(p=o[2])-P*(d=o[1]),o[5]=k*g+F*d+P*l-M*p,o[6]=P*g+F*p+M*d-k*l,o[7]=F*g-M*l-k*d-P*p,o},Ei.rotateY=function(o,i,a){var l=-i[0],d=-i[1],p=-i[2],g=i[3],y=i[4],x=i[5],C=i[6],D=i[7],M=y*g+D*l+x*p-C*d,k=x*g+D*d+C*l-y*p,P=C*g+D*p+y*d-x*l,F=D*g-y*l-x*d-C*p;return jd.rotateY(o,i,a),o[4]=M*(g=o[3])+F*(l=o[0])+k*(p=o[2])-P*(d=o[1]),o[5]=k*g+F*d+P*l-M*p,o[6]=P*g+F*p+M*d-k*l,o[7]=F*g-M*l-k*d-P*p,o},Ei.rotateZ=function(o,i,a){var l=-i[0],d=-i[1],p=-i[2],g=i[3],y=i[4],x=i[5],C=i[6],D=i[7],M=y*g+D*l+x*p-C*d,k=x*g+D*d+C*l-y*p,P=C*g+D*p+y*d-x*l,F=D*g-y*l-x*d-C*p;return jd.rotateZ(o,i,a),o[4]=M*(g=o[3])+F*(l=o[0])+k*(p=o[2])-P*(d=o[1]),o[5]=k*g+F*d+P*l-M*p,o[6]=P*g+F*p+M*d-k*l,o[7]=F*g-M*l-k*d-P*p,o},Ei.rotateByQuatAppend=function(o,i,a){var l=a[0],d=a[1],p=a[2],g=a[3],y=i[0],x=i[1],C=i[2],D=i[3];return o[0]=y*g+D*l+x*p-C*d,o[1]=x*g+D*d+C*l-y*p,o[2]=C*g+D*p+y*d-x*l,o[3]=D*g-y*l-x*d-C*p,o[4]=(y=i[4])*g+(D=i[7])*l+(x=i[5])*p-(C=i[6])*d,o[5]=x*g+D*d+C*l-y*p,o[6]=C*g+D*p+y*d-x*l,o[7]=D*g-y*l-x*d-C*p,o},Ei.rotateByQuatPrepend=function(o,i,a){var l=i[0],d=i[1],p=i[2],g=i[3],y=a[0],x=a[1],C=a[2],D=a[3];return o[0]=l*D+g*y+d*C-p*x,o[1]=d*D+g*x+p*y-l*C,o[2]=p*D+g*C+l*x-d*y,o[3]=g*D-l*y-d*x-p*C,o[4]=l*(D=a[7])+g*(y=a[4])+d*(C=a[6])-p*(x=a[5]),o[5]=d*D+g*x+p*y-l*C,o[6]=p*D+g*C+l*x-d*y,o[7]=g*D-l*y-d*x-p*C,o},Ei.rotateAroundAxis=function(o,i,a,l){if(Math.abs(l)<Ma.EPSILON)return tg(o,i);var d=Math.hypot(a[0],a[1],a[2]);l*=.5;var p=Math.sin(l),g=p*a[0]/d,y=p*a[1]/d,x=p*a[2]/d,C=Math.cos(l),D=i[0],M=i[1],k=i[2],P=i[3];o[0]=D*C+P*g+M*x-k*y,o[1]=M*C+P*y+k*g-D*x,o[2]=k*C+P*x+D*y-M*g,o[3]=P*C-D*g-M*y-k*x;var F=i[4],B=i[5],j=i[6],q=i[7];return o[4]=F*C+q*g+B*x-j*y,o[5]=B*C+q*y+j*g-F*x,o[6]=j*C+q*x+F*y-B*g,o[7]=q*C-F*g-B*y-j*x,o},Ei.add=function(o,i,a){return o[0]=i[0]+a[0],o[1]=i[1]+a[1],o[2]=i[2]+a[2],o[3]=i[3]+a[3],o[4]=i[4]+a[4],o[5]=i[5]+a[5],o[6]=i[6]+a[6],o[7]=i[7]+a[7],o},Ei.multiply=ng,Ei.scale=function(o,i,a){return o[0]=i[0]*a,o[1]=i[1]*a,o[2]=i[2]*a,o[3]=i[3]*a,o[4]=i[4]*a,o[5]=i[5]*a,o[6]=i[6]*a,o[7]=i[7]*a,o},Ei.lerp=function(o,i,a,l){var d=1-l;return ab(i,a)<0&&(l=-l),o[0]=i[0]*d+a[0]*l,o[1]=i[1]*d+a[1]*l,o[2]=i[2]*d+a[2]*l,o[3]=i[3]*d+a[3]*l,o[4]=i[4]*d+a[4]*l,o[5]=i[5]*d+a[5]*l,o[6]=i[6]*d+a[6]*l,o[7]=i[7]*d+a[7]*l,o},Ei.invert=function(o,i){var a=ig(i);return o[0]=-i[0]/a,o[1]=-i[1]/a,o[2]=-i[2]/a,o[3]=i[3]/a,o[4]=-i[4]/a,o[5]=-i[5]/a,o[6]=-i[6]/a,o[7]=i[7]/a,o},Ei.conjugate=function(o,i){return o[0]=-i[0],o[1]=-i[1],o[2]=-i[2],o[3]=i[3],o[4]=-i[4],o[5]=-i[5],o[6]=-i[6],o[7]=i[7],o},Ei.normalize=function(o,i){var a=ig(i);if(a>0){a=Math.sqrt(a);var l=i[0]/a,d=i[1]/a,p=i[2]/a,g=i[3]/a,y=i[4],x=i[5],C=i[6],D=i[7],M=l*y+d*x+p*C+g*D;o[0]=l,o[1]=d,o[2]=p,o[3]=g,o[4]=(y-l*M)/a,o[5]=(x-d*M)/a,o[6]=(C-p*M)/a,o[7]=(D-g*M)/a}return o},Ei.str=function(o){return"quat2("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+", "+o[4]+", "+o[5]+", "+o[6]+", "+o[7]+")"},Ei.exactEquals=function(o,i){return o[0]===i[0]&&o[1]===i[1]&&o[2]===i[2]&&o[3]===i[3]&&o[4]===i[4]&&o[5]===i[5]&&o[6]===i[6]&&o[7]===i[7]},Ei.equals=function(o,i){var a=o[0],l=o[1],d=o[2],p=o[3],g=o[4],y=o[5],x=o[6],C=o[7],D=i[0],M=i[1],k=i[2],P=i[3],F=i[4],B=i[5],j=i[6],q=i[7];return Math.abs(a-D)<=Ma.EPSILON*Math.max(1,Math.abs(a),Math.abs(D))&&Math.abs(l-M)<=Ma.EPSILON*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(d-k)<=Ma.EPSILON*Math.max(1,Math.abs(d),Math.abs(k))&&Math.abs(p-P)<=Ma.EPSILON*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(g-F)<=Ma.EPSILON*Math.max(1,Math.abs(g),Math.abs(F))&&Math.abs(y-B)<=Ma.EPSILON*Math.max(1,Math.abs(y),Math.abs(B))&&Math.abs(x-j)<=Ma.EPSILON*Math.max(1,Math.abs(x),Math.abs(j))&&Math.abs(C-q)<=Ma.EPSILON*Math.max(1,Math.abs(C),Math.abs(q))},Ei.sqrLen=Ei.squaredLength=Ei.len=Ei.length=Ei.dot=Ei.mul=Ei.setReal=Ei.getReal=void 0;var Ma=Y1(Ro),jd=Y1(Yn),YD=Y1(ti);function XD(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,a=new WeakMap;return(XD=function(l){return l?a:i})(o)}function Y1(o,i){if(!i&&o&&o.__esModule)return o;if(null===o||"object"!==eg(o)&&"function"!=typeof o)return{default:o};var a=XD(i);if(a&&a.has(o))return a.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in o)if("default"!==p&&Object.prototype.hasOwnProperty.call(o,p)){var g=d?Object.getOwnPropertyDescriptor(o,p):null;g&&(g.get||g.set)?Object.defineProperty(l,p,g):l[p]=o[p]}return l.default=o,a&&a.set(o,l),l}function X1(o,i,a){var l=.5*a[0],d=.5*a[1],p=.5*a[2],g=i[0],y=i[1],x=i[2],C=i[3];return o[0]=g,o[1]=y,o[2]=x,o[3]=C,o[4]=l*C+d*x-p*y,o[5]=d*C+p*g-l*x,o[6]=p*C+l*y-d*g,o[7]=-l*g-d*y-p*x,o}function tg(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o[4]=i[4],o[5]=i[5],o[6]=i[6],o[7]=i[7],o}function ng(o,i,a){var l=i[0],d=i[1],p=i[2],g=i[3],y=a[4],x=a[5],C=a[6],D=a[7],M=i[4],k=i[5],P=i[6],F=i[7],B=a[0],j=a[1],q=a[2],te=a[3];return o[0]=l*te+g*B+d*q-p*j,o[1]=d*te+g*j+p*B-l*q,o[2]=p*te+g*q+l*j-d*B,o[3]=g*te-l*B-d*j-p*q,o[4]=l*D+g*y+d*C-p*x+M*te+F*B+k*q-P*j,o[5]=d*D+g*x+p*y-l*C+k*te+F*j+P*B-M*q,o[6]=p*D+g*C+l*x-d*y+P*te+F*q+M*j-k*B,o[7]=g*D-l*y-d*x-p*C+F*te-M*B-k*j-P*q,o}Ei.getReal=jd.copy,Ei.setReal=jd.copy,Ei.mul=ng;var ab=jd.dot;Ei.dot=ab;var lb=jd.length;Ei.length=lb,Ei.len=lb;var ig=jd.squaredLength;Ei.squaredLength=ig,Ei.sqrLen=ig;var Qn={};function Q_(o){return(Q_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.create=og,Qn.clone=function(o){var i=new Ud.ARRAY_TYPE(2);return i[0]=o[0],i[1]=o[1],i},Qn.fromValues=function(o,i){var a=new Ud.ARRAY_TYPE(2);return a[0]=o,a[1]=i,a},Qn.copy=function(o,i){return o[0]=i[0],o[1]=i[1],o},Qn.set=function(o,i,a){return o[0]=i,o[1]=a,o},Qn.add=function(o,i,a){return o[0]=i[0]+a[0],o[1]=i[1]+a[1],o},Qn.subtract=Vu,Qn.multiply=K1,Qn.divide=Q1,Qn.ceil=function(o,i){return o[0]=Math.ceil(i[0]),o[1]=Math.ceil(i[1]),o},Qn.floor=function(o,i){return o[0]=Math.floor(i[0]),o[1]=Math.floor(i[1]),o},Qn.min=function(o,i,a){return o[0]=Math.min(i[0],a[0]),o[1]=Math.min(i[1],a[1]),o},Qn.max=function(o,i,a){return o[0]=Math.max(i[0],a[0]),o[1]=Math.max(i[1],a[1]),o},Qn.round=function(o,i){return o[0]=Math.round(i[0]),o[1]=Math.round(i[1]),o},Qn.scale=function(o,i,a){return o[0]=i[0]*a,o[1]=i[1]*a,o},Qn.scaleAndAdd=function(o,i,a,l){return o[0]=i[0]+a[0]*l,o[1]=i[1]+a[1]*l,o},Qn.distance=J1,Qn.squaredDistance=cb,Qn.length=J_,Qn.squaredLength=ew,Qn.negate=function(o,i){return o[0]=-i[0],o[1]=-i[1],o},Qn.inverse=function(o,i){return o[0]=1/i[0],o[1]=1/i[1],o},Qn.normalize=function(o,i){var a=i[0],l=i[1],d=a*a+l*l;return d>0&&(d=1/Math.sqrt(d)),o[0]=i[0]*d,o[1]=i[1]*d,o},Qn.dot=function(o,i){return o[0]*i[0]+o[1]*i[1]},Qn.cross=function(o,i,a){var l=i[0]*a[1]-i[1]*a[0];return o[0]=o[1]=0,o[2]=l,o},Qn.lerp=function(o,i,a,l){var d=i[0],p=i[1];return o[0]=d+l*(a[0]-d),o[1]=p+l*(a[1]-p),o},Qn.random=function(o,i){i=i||1;var a=2*Ud.RANDOM()*Math.PI;return o[0]=Math.cos(a)*i,o[1]=Math.sin(a)*i,o},Qn.transformMat2=function(o,i,a){var l=i[0],d=i[1];return o[0]=a[0]*l+a[2]*d,o[1]=a[1]*l+a[3]*d,o},Qn.transformMat2d=function(o,i,a){var l=i[0],d=i[1];return o[0]=a[0]*l+a[2]*d+a[4],o[1]=a[1]*l+a[3]*d+a[5],o},Qn.transformMat3=function(o,i,a){var l=i[0],d=i[1];return o[0]=a[0]*l+a[3]*d+a[6],o[1]=a[1]*l+a[4]*d+a[7],o},Qn.transformMat4=function(o,i,a){var l=i[0],d=i[1];return o[0]=a[0]*l+a[4]*d+a[12],o[1]=a[1]*l+a[5]*d+a[13],o},Qn.rotate=function(o,i,a,l){var d=i[0]-a[0],p=i[1]-a[1],g=Math.sin(l),y=Math.cos(l);return o[0]=d*y-p*g+a[0],o[1]=d*g+p*y+a[1],o},Qn.angle=function(o,i){var a=o[0],l=o[1],d=i[0],p=i[1],g=Math.sqrt(a*a+l*l)*Math.sqrt(d*d+p*p);return Math.acos(Math.min(Math.max(g&&(a*d+l*p)/g,-1),1))},Qn.zero=function(o){return o[0]=0,o[1]=0,o},Qn.str=function(o){return"vec2("+o[0]+", "+o[1]+")"},Qn.exactEquals=function(o,i){return o[0]===i[0]&&o[1]===i[1]},Qn.equals=function(o,i){var a=o[0],l=o[1],d=i[0],p=i[1];return Math.abs(a-d)<=Ud.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(l-p)<=Ud.EPSILON*Math.max(1,Math.abs(l),Math.abs(p))},Qn.forEach=Qn.sqrLen=Qn.sqrDist=Qn.dist=Qn.div=Qn.mul=Qn.sub=Qn.len=void 0;var Ud=function(o,i){if(o&&o.__esModule)return o;if(null===o||"object"!==Q_(o)&&"function"!=typeof o)return{default:o};var a=rg(void 0);if(a&&a.has(o))return a.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in o)if("default"!==p&&Object.prototype.hasOwnProperty.call(o,p)){var g=d?Object.getOwnPropertyDescriptor(o,p):null;g&&(g.get||g.set)?Object.defineProperty(l,p,g):l[p]=o[p]}return l.default=o,a&&a.set(o,l),l}(Ro);function rg(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,a=new WeakMap;return(rg=function(l){return l?a:i})(o)}function og(){var o=new Ud.ARRAY_TYPE(2);return Ud.ARRAY_TYPE!=Float32Array&&(o[0]=0,o[1]=0),o}function Vu(o,i,a){return o[0]=i[0]-a[0],o[1]=i[1]-a[1],o}function K1(o,i,a){return o[0]=i[0]*a[0],o[1]=i[1]*a[1],o}function Q1(o,i,a){return o[0]=i[0]/a[0],o[1]=i[1]/a[1],o}function J1(o,i){return Math.hypot(i[0]-o[0],i[1]-o[1])}function cb(o,i){var a=i[0]-o[0],l=i[1]-o[1];return a*a+l*l}function J_(o){return Math.hypot(o[0],o[1])}function ew(o){var i=o[0],a=o[1];return i*i+a*a}Qn.len=J_,Qn.sub=Vu,Qn.mul=K1,Qn.div=Q1,Qn.dist=J1,Qn.sqrDist=cb,Qn.sqrLen=ew;var KD=function(){var o=og();return function(i,a,l,d,p,g){var y,x;for(a||(a=2),l||(l=0),x=d?Math.min(d*a+l,i.length):i.length,y=l;y<x;y+=a)o[0]=i[y],o[1]=i[y+1],p(o,o,g),i[y]=o[0],i[y+1]=o[1];return i}}();function ub(o){return(ub="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}Qn.forEach=KD,Object.defineProperty(ko,"__esModule",{value:!0}),h.e=ko.vec4=h.v=ko.vec3=ko.vec2=ko.quat2=h.q=ko.quat=h.m=ko.mat4=h.bx=ko.mat3=ko.mat2d=h.h=ko.mat2=ko.glMatrix=void 0;var tw=Xc(Ro);ko.glMatrix=tw;var QD=Xc(Tr);h.h=ko.mat2=QD;var JD=Xc(mi);ko.mat2d=JD;var Aa=Xc(Hi);h.bx=ko.mat3=Aa;var db=Xc(ti);h.m=ko.mat4=db;var nw=Xc(Yn);h.q=ko.quat=nw;var hb=Xc(Ei);ko.quat2=hb;var Bs=Xc(Qn);ko.vec2=Bs;var sg=Xc(qn);h.v=ko.vec3=sg;var iw=Xc(di);function fb(o){if("function"!=typeof WeakMap)return null;var i=new WeakMap,a=new WeakMap;return(fb=function(l){return l?a:i})(o)}function Xc(o,i){if(!i&&o&&o.__esModule)return o;if(null===o||"object"!==ub(o)&&"function"!=typeof o)return{default:o};var a=fb(i);if(a&&a.has(o))return a.get(o);var l={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in o)if("default"!==p&&Object.prototype.hasOwnProperty.call(o,p)){var g=d?Object.getOwnPropertyDescriptor(o,p):null;g&&(g.get||g.set)?Object.defineProperty(l,p,g):l[p]=o[p]}return l.default=o,a&&a.set(o,l),l}h.e=ko.vec4=iw;const rw=_n([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:ey}=rw,pb=_n([{name:"a_pos_3",components:3,type:"Int16"}]);var ag=_n([{name:"a_pos",type:"Int16",components:2}]),mb={};!function(a){function l(p,g,y){var x=d(256*p,256*(g=Math.pow(2,y)-g-1),y),C=d(256*(p+1),256*(g+1),y);return x[0]+","+x[1]+","+C[0]+","+C[1]}function d(p,g,y){var x=2*Math.PI*6378137/256/Math.pow(2,y);return[p*x-2*Math.PI*6378137/2,g*x-2*Math.PI*6378137/2]}a.getURL=function(p,g,y,x,C,D){return D=D||{},p+"?"+["bbox="+l(y,x,C),"format="+(D.format||"image/png"),"service="+(D.service||"WMS"),"version="+(D.version||"1.1.1"),"request="+(D.request||"GetMap"),"srs="+(D.srs||"EPSG:3857"),"width="+(D.width||256),"height="+(D.height||256),"layers="+g].join("&")},a.getTileBBox=l,a.getMercCoords=d,Object.defineProperty(a,"__esModule",{value:!0})}(mb);var eT=mb;class nf{constructor(i,a,l){this.z=i,this.x=a,this.y=l,this.key=lg(0,i,i,a,l)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,a){const l=eT.getTileBBox(this.x,this.y,this.z),d=function(p,g,y){let x,C="";for(let D=p;D>0;D--)x=1<<D-1,C+=(g&x?1:0)+(y&x?2:0);return C}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===a?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",d).replace("{bbox-epsg-3857}",l)}toString(){return`${this.z}/${this.x}/${this.y}`}}class ty{constructor(i,a){this.wrap=i,this.canonical=a,this.key=lg(i,a.z,a.z,a.x,a.y)}}class Po{constructor(i,a,l,d,p){this.overscaledZ=i,this.wrap=a,this.canonical=new nf(l,+d,+p),this.key=0===a&&i===l?this.canonical.key:lg(a,i,l,d,p)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const a=this.canonical.z-i;return i>this.canonical.z?new Po(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Po(i,this.wrap,i,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(i,a=!0){if(this.overscaledZ===i&&a)return this.key;if(i>this.canonical.z)return lg(this.wrap*+a,i,this.canonical.z,this.canonical.x,this.canonical.y);{const l=this.canonical.z-i;return lg(this.wrap*+a,i,i,this.canonical.x>>l,this.canonical.y>>l)}}isChildOf(i){if(i.wrap!==this.wrap)return!1;const a=this.canonical.z-i.canonical.z;return 0===i.overscaledZ||i.overscaledZ<this.overscaledZ&&i.canonical.z<this.canonical.z&&i.canonical.x===this.canonical.x>>a&&i.canonical.y===this.canonical.y>>a}children(i){if(this.overscaledZ>=i)return[new Po(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,l=2*this.canonical.x,d=2*this.canonical.y;return[new Po(a,this.wrap,a,l,d),new Po(a,this.wrap,a,l+1,d),new Po(a,this.wrap,a,l,d+1),new Po(a,this.wrap,a,l+1,d+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new Po(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new Po(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ty(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function lg(o,i,a,l,d){const p=1<<Math.min(a,22);let g=p*(d%p)+l%p;return o&&a<22&&(g+=p*p*((o<0?-2*o-1:2*o)%(1<<2*(22-a)))),16*(32*g+a)+(i-a)}const cg=[o=>{let i=o.canonical.x-1,a=o.wrap;return i<0&&(i=(1<<o.canonical.z)-1,a--),new Po(o.overscaledZ,a,o.canonical.z,i,o.canonical.y)},o=>{let i=o.canonical.x+1,a=o.wrap;return i===1<<o.canonical.z&&(i=0,a++),new Po(o.overscaledZ,a,o.canonical.z,i,o.canonical.y)},o=>new Po(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,(0===o.canonical.y?1<<o.canonical.z:o.canonical.y)-1),o=>new Po(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y===(1<<o.canonical.z)-1?0:o.canonical.y+1)];rn(nf,"CanonicalTileID"),rn(Po,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});class gb{constructor(i,a){this.pos=i,this.dir=a}intersectsPlane(i,a,l){const d=h.v.dot(a,this.dir);if(Math.abs(d)<1e-6)return!1;const p=((i[0]-this.pos[0])*a[0]+(i[1]-this.pos[1])*a[1]+(i[2]-this.pos[2])*a[2])/d;return l[0]=this.pos[0]+this.dir[0]*p,l[1]=this.pos[1]+this.dir[1]*p,l[2]=this.pos[2]+this.dir[2]*p,!0}closestPointOnSphere(i,a,l){if(h.v.equals(this.pos,i)||0===a)return l[0]=l[1]=l[2]=0,!1;const[d,p,g]=this.dir,y=this.pos[0]-i[0],x=this.pos[1]-i[1],C=this.pos[2]-i[2],D=d*d+p*p+g*g,M=2*(y*d+x*p+C*g),k=M*M-4*D*(y*y+x*x+C*C-a*a);if(k<0){const P=Math.max(-M/2,0),F=y+d*P,B=x+p*P,j=C+g*P,q=Math.hypot(F,B,j);return l[0]=F*a/q,l[1]=B*a/q,l[2]=j*a/q,!1}{const P=(-M-Math.sqrt(k))/(2*D);if(P<0){const F=Math.hypot(y,x,C);return l[0]=y*a/F,l[1]=x*a/F,l[2]=C*a/F,!1}return l[0]=y+d*P,l[1]=x+p*P,l[2]=C+g*P,!0}}}class _b{constructor(i,a,l,d,p){this.TL=i,this.TR=a,this.BR=l,this.BL=d,this.horizon=p}static fromInvProjectionMatrix(i,a,l){const d=[-1,1,1],p=[1,1,1],g=[1,-1,1],y=[-1,-1,1],x=h.v.transformMat4(d,d,i),C=h.v.transformMat4(p,p,i),D=h.v.transformMat4(g,g,i),M=h.v.transformMat4(y,y,i);return new _b(x,C,D,M,a/l)}}function yp(o,i,a){let l=1/0,d=-1/0;const p=[];for(const g of o){h.v.sub(p,g,i);const y=h.v.dot(p,a);l=Math.min(l,y),d=Math.max(d,y)}return[l,d]}function yb(o,i){let a=!0;for(let l=0;l<o.planes.length;l++){const d=o.planes[l];let p=0;for(let g=0;g<i.length;g++)p+=h.v.dot(d,i[g])+d[3]>=0;if(0===p)return 0;p!==i.length&&(a=!1)}return a?2:1}function vb(o,i){for(const a of o.projections){const l=yp(i,o.points[0],a.axis);if(a.projection[1]<l[0]||a.projection[0]>l[1])return 0}return 1}function rf(o,i){let a=0;const l=[0,0,0,0];for(let d=0;d<o.length;d++)l[0]=o[d][0],l[1]=o[d][1],l[2]=o[d][2],l[3]=1,h.e.dot(l,i)>=0&&a++;return a}class vp{constructor(i,a){this.points=i||new Array(8).fill([0,0,0]),this.planes=a||new Array(6).fill([0,0,0,0]),this.bounds=oo.fromPoints(this.points),this.projections=[],this.frustumEdges=[h.v.sub([],this.points[2],this.points[3]),h.v.sub([],this.points[0],this.points[3]),h.v.sub([],this.points[4],this.points[0]),h.v.sub([],this.points[5],this.points[1]),h.v.sub([],this.points[6],this.points[2]),h.v.sub([],this.points[7],this.points[3])];for(const l of this.frustumEdges){const d=[0,-l[2],l[1]],p=[l[2],0,-l[0]];this.projections.push({axis:d,projection:yp(this.points,this.points[0],d)}),this.projections.push({axis:p,projection:yp(this.points,this.points[0],p)})}}static fromInvProjectionMatrix(i,a,l,d){const p=Math.pow(2,l),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(C=>{const D=h.e.transformMat4([],C,i),M=1/D[3]/a*p;return h.e.mul(D,D,[M,M,d?1/D[3]:M,M])}),y=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(C=>{const D=h.v.sub([],g[C[0]],g[C[1]]),M=h.v.sub([],g[C[2]],g[C[1]]),k=h.v.normalize([],h.v.cross([],D,M)),P=-h.v.dot(k,g[C[1]]);return k.concat(P)}),x=[];for(let C=0;C<g.length;C++)x.push([g[C][0],g[C][1],g[C][2]]);return new vp(x,y)}intersectsPrecise(i,a,l){for(let d=0;d<a.length;d++)if(!rf(i,a[d]))return 0;for(let d=0;d<this.planes.length;d++)if(!rf(i,this.planes[d]))return 0;for(const d of l)for(const p of this.frustumEdges){const g=h.v.cross([],d,p),y=h.v.length(g);if(0===y)continue;h.v.scale(g,g,1/y);const x=yp(this.points,this.points[0],g),C=yp(i,this.points[0],g);if(x[0]>C[1]||C[0]>x[1])return 0}return 1}}class oo{static fromPoints(i){const a=[1/0,1/0,1/0],l=[-1/0,-1/0,-1/0];for(const d of i)h.v.min(a,a,d),h.v.max(l,l,d);return new oo(a,l)}static fromTileIdAndHeight(i,a,l){const d=1<<i.canonical.z,p=i.canonical.x,g=i.canonical.y;return new oo([p/d,g/d,a],[(p+1)/d,(g+1)/d,l])}static applyTransform(i,a){const l=i.getCorners();for(let d=0;d<l.length;++d)h.v.transformMat4(l[d],l[d],a);return oo.fromPoints(l)}static projectAabbCorners(i,a){const l=i.getCorners();for(let d=0;d<l.length;++d)h.v.transformMat4(l[d],l[d],a);return l}constructor(i,a){this.min=i,this.max=a,this.center=h.v.scale([],h.v.add([],this.min,this.max),.5)}quadrant(i){const a=[i%2==0,i<2],l=h.v.clone(this.min),d=h.v.clone(this.max);for(let p=0;p<a.length;p++)l[p]=a[p]?this.min[p]:this.center[p],d[p]=a[p]?this.center[p]:this.max[p];return d[2]=this.max[2],new oo(l,d)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}distanceZ(i){return Math.max(Math.min(this.max[2],i[2]),this.min[2])-i[2]}getCorners(){const i=this.min,a=this.max;return[[i[0],i[1],i[2]],[a[0],i[1],i[2]],[a[0],a[1],i[2]],[i[0],a[1],i[2]],[i[0],i[1],a[2]],[a[0],i[1],a[2]],[a[0],a[1],a[2]],[i[0],a[1],a[2]]]}intersects(i){return this.intersectsAabb(i.bounds)?yb(i,this.getCorners()):0}intersectsFlat(i){return this.intersectsAabb(i.bounds)?yb(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(i,a){return a||this.intersects(i)?vb(i,this.getCorners()):0}intersectsPreciseFlat(i,a){return a||this.intersectsFlat(i)?vb(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(i){for(let a=0;a<3;++a)if(this.min[a]>i.max[a]||i.min[a]>this.max[a])return!1;return!0}intersectsAabbXY(i){return!(this.min[0]>i.max[0]||i.min[0]>this.max[0]||this.min[1]>i.max[1]||i.min[1]>this.max[1])}encapsulate(i){for(let a=0;a<3;a++)this.min[a]=Math.min(this.min[a],i.min[a]),this.max[a]=Math.max(this.max[a],i.max[a])}encapsulatePoint(i){for(let a=0;a<3;a++)this.min[a]=Math.min(this.min[a],i[a]),this.max[a]=Math.max(this.max[a],i[a])}closestPoint(i){return[Math.max(Math.min(this.max[0],i[0]),this.min[0]),Math.max(Math.min(this.max[1],i[1]),this.min[1]),Math.max(Math.min(this.max[2],i[2]),this.min[2])]}}rn(oo,"Aabb");const ug=5,dg=6,el=Ht/Math.PI/2,tT=16383,bb=[64,32,16],Fl=-el,Ll=el,ow=[new oo([Fl,Fl,Fl],[Ll,Ll,Ll]),new oo([Fl,Fl,Fl],[0,0,Ll]),new oo([0,Fl,Fl],[Ll,0,Ll]),new oo([Fl,0,Fl],[0,Ll,Ll]),new oo([0,0,Fl],[Ll,Ll,Ll])];function sf(o){return o*el/vg}function ny(o,i,a,l=!0){const d=h.v.scale([],o._camera.position,o.worldSize),p=[i,a,1,1];h.e.transformMat4(p,p,o.pixelMatrixInverse),h.e.scale(p,p,1/p[3]);const g=h.v.sub([],p,d),y=h.v.normalize([],g),x=o.globeMatrix,C=[x[12],x[13],x[14]],D=h.v.sub([],C,d),M=h.v.length(D),k=h.v.normalize([],D),P=o.worldSize/(2*Math.PI),F=h.v.dot(k,y),B=Math.asin(P/M);if(B<Math.acos(F)){if(!l)return null;const je=[],dt=[];h.v.scale(je,y,M/F),h.v.normalize(dt,h.v.sub(dt,je,D)),h.v.normalize(y,h.v.add(y,D,h.v.scale(y,dt,Math.tan(B)*M)))}const j=[];new gb(d,y).closestPointOnSphere(C,P,j);const q=h.v.normalize([],cn(x,0)),te=h.v.normalize([],cn(x,1)),ie=h.v.normalize([],cn(x,2)),se=h.v.dot(q,j),de=h.v.dot(te,j),pe=h.v.dot(ie,j),Ee=Si(Math.asin(-de/P));let Ie=Si(Math.atan2(se,pe));Ie=o.center.lng+function(je,dt){const Pt=(dt-je+180)%360-180;return Pt<-180?Pt+360:Pt}(o.center.lng,Ie);const Pe=tl(Ie),Ze=Hn(Nl(Ee),0,1);return new Ko(Pe,Ze)}class xb{constructor(i,a,l){this.a=h.v.sub([],i,l),this.b=h.v.sub([],a,l),this.center=l;const d=h.v.normalize([],this.a),p=h.v.normalize([],this.b);this.angle=Math.acos(h.v.dot(d,p))}}function wb(o,i){if(0===o.angle)return null;let a;return a=0===o.a[i]?1/o.angle*.5*Math.PI:1/o.angle*Math.atan(o.b[i]/o.a[i]/Math.sin(o.angle)-1/Math.tan(o.angle)),a<0||a>1?null:function(l,d,p,g){const y=Math.sin(p);return l*(Math.sin((1-g)*p)/y)+d*(Math.sin(g*p)/y)}(o.a[i],o.b[i],o.angle,Hn(a,0,1))+o.center[i]}function Kc(o){if(o.z<=1)return ow[o.z+2*o.y+o.x];const i=Db(hg(o));return oo.fromPoints(i)}function fc(o,i,a){return h.v.scale(o,o,1-a),h.v.scaleAndAdd(o,o,i,a)}function Cb(o,i){const a=Jc(i.zoom);if(0===a)return Kc(o);const l=hg(o),d=Db(l),p=tl(l.getWest())*i.worldSize,g=tl(l.getEast())*i.worldSize,y=Nl(l.getNorth())*i.worldSize,x=Nl(l.getSouth())*i.worldSize,C=[p,y,0],D=[g,y,0],M=[p,x,0],k=[g,x,0],P=h.m.invert([],i.globeMatrix);return h.v.transformMat4(C,C,P),h.v.transformMat4(D,D,P),h.v.transformMat4(M,M,P),h.v.transformMat4(k,k,P),d[0]=fc(d[0],M,a),d[1]=fc(d[1],k,a),d[2]=fc(d[2],D,a),d[3]=fc(d[3],C,a),oo.fromPoints(d)}function Hd(o,i,a){for(const l of o)h.v.transformMat4(l,l,i),h.v.scale(l,l,a)}function Eb(o,i,a,l){const d=i/o.worldSize,p=o.globeMatrix;if(a.z<=1){const Pe=Kc(a).getCorners();return Hd(Pe,p,d),oo.fromPoints(Pe)}const g=hg(a,l),y=Db(g);Hd(y,p,d);const x=Number.MAX_VALUE,C=[-x,-x,-x],D=[x,x,x];if(g.contains(o.center)){for(const je of y)h.v.min(D,D,je),h.v.max(C,C,je);C[2]=0;const Pe=o.point,Ze=[Pe.x*d,Pe.y*d,0];return h.v.min(D,D,Ze),h.v.max(C,C,Ze),new oo(D,C)}const M=[p[12]*d,p[13]*d,p[14]*d],k=g.getCenter(),P=Hn(o.center.lat,-so,so),F=Hn(k.lat,-so,so),B=tl(o.center.lng),j=Nl(P);let q=B-tl(k.lng);const te=j-Nl(F);q>.5?q-=1:q<-.5&&(q+=1);let ie=0;if(Math.abs(q)>Math.abs(te))ie=q>=0?1:3;else{ie=te>=0?0:2;const Pe=[p[4]*d,p[5]*d,p[6]*d],Ze=-Math.sin(Et(te>=0?g.getSouth():g.getNorth()))*el;h.v.scaleAndAdd(M,M,Pe,Ze)}const se=y[ie],de=y[(ie+1)%4],pe=new xb(se,de,M),Ee=[wb(pe,0)||se[0],wb(pe,1)||se[1],wb(pe,2)||se[2]],Ie=Jc(o.zoom);if(Ie>0){const Pe=function({x:je,y:dt,z:Pt},st,Tt,et,$t){const on=1/(1<<Pt);let It=je*on,On=It+on,ln=dt*on,Gt=ln+on,An=0;const dn=(It+On)/2-et;return dn>.5?An=-1:dn<-.5&&(An=1),It=((It+An)*st-(et*=st))*Tt+et,On=((On+An)*st-et)*Tt+et,ln=(ln*st-($t*=st))*Tt+$t,Gt=(Gt*st-$t)*Tt+$t,[[It,Gt,0],[On,Gt,0],[On,ln,0],[It,ln,0]]}(a,i,o._pixelsPerMercatorPixel,B,j);for(let je=0;je<y.length;je++)fc(y[je],Pe[je],Ie);const Ze=h.v.add([],Pe[ie],Pe[(ie+1)%4]);h.v.scale(Ze,Ze,.5),fc(Ee,Ze,Ie)}for(const Pe of y)h.v.min(D,D,Pe),h.v.max(C,C,Pe);return D[2]=Math.min(se[2],de[2]),h.v.min(D,D,Ee),h.v.max(C,C,Ee),new oo(D,C)}function hg({x:o,y:i,z:a},l=!1){const d=1/(1<<a),p=new er(Ia(o*d),i===(1<<a)-1&&l?-90:os((i+1)*d)),g=new er(Ia((o+1)*d),0===i&&l?90:os(i*d));return new zu(p,g)}function Db(o){const i=Et(o.getNorth()),a=Et(o.getSouth()),l=Math.cos(i),d=Math.cos(a),p=Math.sin(i),g=Math.sin(a),y=o.getWest(),x=o.getEast();return[fg(d,g,y),fg(d,g,x),fg(l,p,x),fg(l,p,y)]}function fg(o,i,a,l=el){return a=Et(a),[o*Math.sin(a)*l,-i*l,o*Math.cos(a)*l]}function Qc(o,i,a){return fg(Math.cos(Et(o)),Math.sin(Et(o)),i,a)}function pg(o,i,a,l){const d=1<<a.z,p=(o/Ht+a.x)/d;return Qc(os((i/Ht+a.y)/d),Ia(p),l)}function mg({min:o,max:i}){return tT/Math.max(i[0]-o[0],i[1]-o[1],i[2]-o[2])}const Tb=new Float64Array(16);function xp(o){const i=mg(o),a=h.m.fromScaling(Tb,[i,i,i]);return h.m.translate(a,a,h.v.negate([],o.min))}function gg(o){const i=h.m.fromTranslation(Tb,o.min),a=1/mg(o);return h.m.scale(i,i,[a,a,a])}function iy(o){const i=Ht/(2*Math.PI);return o/(2*Math.PI)/i}function _g(o,i){return Ht/(512*Math.pow(2,o))*mg(Kc(i))}function wp(o,i,a,l,d){const p=iy(a),g=[o,i,-a/(2*Math.PI)],y=h.m.identity(new Float64Array(16));return h.m.translate(y,y,g),h.m.scale(y,y,[p,p,p]),h.m.rotateX(y,y,Et(-d)),h.m.rotateY(y,y,Et(-l)),y}function Jc(o){return Is(ug,dg,o)}function ry(o,i){const a=Qc(i.lat,i.lng),l=function(p){const g=Qc(p._center.lat,p._center.lng),y=h.v.fromValues(0,1,0);let x=h.v.cross([],y,g);const C=h.m.fromRotation([],-p.angle,g);x=h.v.transformMat4(x,x,C),h.m.fromRotation(C,-p._pitch,x);const D=h.v.normalize([],g);return h.v.scale(D,D,sf(p.cameraToCenterDistance/p.pixelsPerMeter)),h.v.transformMat4(D,D,C),h.v.add([],g,D)}(o),d=h.v.subtract([],l,a);return h.v.angle(d,a)}function Cp(o,i){return ry(o,i)>Math.PI/2*1.01}const Sb=Et(85),Mb=Math.cos(Sb),yg=Math.sin(Sb),vg=6371008.8,oy=2*Math.PI*vg;class $d{constructor(i,a){if(isNaN(i)||isNaN(a))throw new Error(`Invalid LngLat object: (${i}, ${a})`);if(this.lng=+i,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new $d(wn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const a=Math.PI/180,l=this.lat*a,d=i.lat*a,p=Math.sin(l)*Math.sin(d)+Math.cos(l)*Math.cos(d)*Math.cos((i.lng-this.lng)*a);return vg*Math.acos(Math.min(p,1))}toBounds(i=0){const a=360*i/40075017,l=a/Math.cos(Math.PI/180*this.lat);return new zu(new $d(this.lng-l,this.lat-a),new $d(this.lng+l,this.lat+a))}toEcef(i){const a=sf(i);return Qc(this.lat,this.lng,el+a)}static convert(i){if(i instanceof $d)return i;if(Array.isArray(i)&&(2===i.length||3===i.length))return new $d(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&"object"==typeof i&&null!==i)return new $d(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var er=$d;const nT=0,sw=25.5;function sy(o){return oy*Math.cos(o*Math.PI/180)}function tl(o){return(180+o)/360}function Nl(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function zo(o,i){return o/sy(i)}function Ia(o){return 360*o-180}function os(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}function iT(o,i){return o*sy(os(i))}const so=85.051129;function ay(o){return Math.cos(Et(Hn(o,-so,so)))}function af(o,i){const a=Hn(i,nT,sw),l=Math.pow(2,a);return ay(o)*oy/(512*l)}function lf(o){return 1/Math.cos(o*Math.PI/180)}function cf(o,i=0){const a=Math.exp(Math.PI*(1-(o.y+i/Ht)/(1<<o.z)*2));return 80150034*a/(a*a+1)/Ht/(1<<o.z)}class Ko{constructor(i,a,l=0){this.x=+i,this.y=+a,this.z=+l}static fromLngLat(i,a=0){const l=er.convert(i);return new Ko(tl(l.lng),Nl(l.lat),zo(a,l.lat))}toLngLat(){return new er(Ia(this.x),os(this.y))}toAltitude(){return iT(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/oy*lf(os(this.y))}}function ly(o,i,a,l,d,p,g,y,x){const C=(i+l)/2,D=(a+d)/2,M=new Le(C,D);y(M),function(k,P,F,B,j,q){const te=F-j,ie=B-q;return Math.abs((B-P)*te-(F-k)*ie)/Math.hypot(te,ie)}(M.x,M.y,p.x,p.y,g.x,g.y)>=x?(ly(o,i,a,C,D,p,M,y,x),ly(o,C,D,l,d,M,g,y,x)):o.push(g)}function Ab(o,i,a){let l=o[0],d=l.x,p=l.y;i(l);const g=[l];for(let y=1;y<o.length;y++){const x=o[y],{x:C,y:D}=x;i(x),ly(g,d,p,C,D,l,x,i,a),d=C,p=D,l=x}return g}function cy(o,i,a,l){if(l(i,a)){const d=i.add(a)._mult(.5);cy(o,i,d,l),cy(o,d,a,l)}else o.push(a)}function uf(o,i){let a=o[0];const l=[a];for(let d=1;d<o.length;d++){const p=o[d];cy(l,a,p,i),a=p}return l}const Ib=Math.pow(2,14)-1,aw=-Ib-1;function rT(o,i){const a=Math.round(o.x*i),l=Math.round(o.y*i);return o.x=Hn(a,aw,Ib),o.y=Hn(l,aw,Ib),(a<o.x||a>o.x+1||l<o.y||l>o.y+1)&&ar("Geometry exceeds allowed extent, reduce your vector tile buffer size"),o}function eu(o,i,a){const l=o.loadGeometry(),d=o.extent,p=Ht/d;if(i&&a&&a.projection.isReprojectedInTileSpace){const g=1<<i.z,{scale:y,x,y:C,projection:D}=a,M=k=>{const P=Ia((i.x+k.x/d)/g),F=os((i.y+k.y/d)/g),B=D.project(P,F);k.x=(B.x*y-x)*d,k.y=(B.y*y-C)*d};for(let k=0;k<l.length;k++)if(1!==o.type)l[k]=Ab(l[k],M,1);else{const P=[];for(const F of l[k])F.x<0||F.x>=d||F.y<0||F.y>=d||(M(F),P.push(F));l[k]=P}}for(const g of l)for(const y of g)rT(y,p);return l}function Gd(o,i){return{type:o.type,id:o.id,properties:o.properties,geometry:i?eu(o):[]}}function zs(o,i,a,l,d){o.emplaceBack(2*i+(l+1)/2,2*a+(d+1)/2)}function nl(o,i,a){o.emplaceBack(i.x,i.y,i.z,16384*a[0],16384*a[1],16384*a[2])}class kb{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=i.index,this.hasPattern=!1,this.projection=i.projection,this.layoutVertexArray=new un,this.indexArray=new rr,this.segments=new Dr,this.programConfigurations=new Zc(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(i,a,l,d){const p=this.layers[0],g=[];let y=null;"circle"===p.type&&(y=p.layout.get("circle-sort-key"));for(const{feature:C,id:D,index:M,sourceLayerIndex:k}of i){const P=this.layers[0]._featureFilter.needGeometry,F=Gd(C,P);if(!this.layers[0]._featureFilter.filter(new Ce(this.zoom),F,l))continue;const B=y?y.evaluate(F,{},l):void 0,j={id:D,properties:C.properties,type:C.type,sourceLayerIndex:k,index:M,geometry:P?F.geometry:eu(C,l,d),patterns:{},sortKey:B};g.push(j)}y&&g.sort((C,D)=>C.sortKey-D.sortKey);let x=null;"globe"===d.projection.name&&(this.globeExtVertexArray=new fr,x=d.projection);for(const C of g){const{geometry:D,index:M,sourceLayerIndex:k}=C,P=i[M].feature;this.addFeature(C,D,M,a.availableImages,l,x,a.brightness),a.featureIndex.insert(P,D,M,k,this.index)}}update(i,a,l,d,p){const g=0!==Object.keys(i).length;g&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(i,a,g?this.stateDependentLayers:this.layers,l,d,p)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,PD.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,C1.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(i,a,l,d,p,g,y){for(const x of a)for(const C of x){const D=C.x,M=C.y;if(D<0||D>=Ht||M<0||M>=Ht)continue;if(g){const F=g.projectTilePoint(D,M,p),B=g.upVector(p,D,M),j=this.globeExtVertexArray;nl(j,F,B),nl(j,F,B),nl(j,F,B),nl(j,F,B)}const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),P=k.vertexLength;zs(this.layoutVertexArray,D,M,-1,-1),zs(this.layoutVertexArray,D,M,1,-1),zs(this.layoutVertexArray,D,M,1,1),zs(this.layoutVertexArray,D,M,-1,1),this.indexArray.emplaceBack(P,P+1,P+2),this.indexArray.emplaceBack(P,P+2,P+3),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,l,{},d,p,y)}}function lw(o,i){for(let a=0;a<o.length;a++)if(df(i,o[a]))return!0;for(let a=0;a<i.length;a++)if(df(o,i[a]))return!0;return!!Rb(o,i)}function oT(o,i,a){return!!df(o,i)||!!Pb(i,o,a)}function cw(o,i){if(1===o.length)return hw(i,o[0]);for(let a=0;a<i.length;a++){const l=i[a];for(let d=0;d<l.length;d++)if(df(o,l[d]))return!0}for(let a=0;a<o.length;a++)if(hw(i,o[a]))return!0;for(let a=0;a<i.length;a++)if(Rb(o,i[a]))return!0;return!1}function sT(o,i,a){if(o.length>1){if(Rb(o,i))return!0;for(let l=0;l<i.length;l++)if(Pb(i[l],o,a))return!0}for(let l=0;l<o.length;l++)if(Pb(o[l],i,a))return!0;return!1}function Rb(o,i){if(0===o.length||0===i.length)return!1;for(let a=0;a<o.length-1;a++){const l=o[a],d=o[a+1];for(let p=0;p<i.length-1;p++)if(uw(l,d,i[p],i[p+1]))return!0}return!1}function uw(o,i,a,l){return Ot(o,a,l)!==Ot(i,a,l)&&Ot(o,i,a)!==Ot(o,i,l)}function Pb(o,i,a){const l=a*a;if(1===i.length)return o.distSqr(i[0])<l;for(let d=1;d<i.length;d++)if(dw(o,i[d-1],i[d])<l)return!0;return!1}function dw(o,i,a){const l=i.distSqr(a);if(0===l)return o.distSqr(i);const d=((o.x-i.x)*(a.x-i.x)+(o.y-i.y)*(a.y-i.y))/l;return o.distSqr(d<0?i:d>1?a:a.sub(i)._mult(d)._add(i))}function hw(o,i){let a,l,d,p=!1;for(let g=0;g<o.length;g++){a=o[g];for(let y=0,x=a.length-1;y<a.length;x=y++)l=a[y],d=a[x],l.y>i.y!=d.y>i.y&&i.x<(d.x-l.x)*(i.y-l.y)/(d.y-l.y)+l.x&&(p=!p)}return p}function df(o,i){let a=!1;for(let l=0,d=o.length-1;l<o.length;d=l++){const p=o[l],g=o[d];p.y>i.y!=g.y>i.y&&i.x<(g.x-p.x)*(i.y-p.y)/(g.y-p.y)+p.x&&(a=!a)}return a}function bg(o,i,a,l,d){for(const g of o)if(i<=g.x&&a<=g.y&&l>=g.x&&d>=g.y)return!0;const p=[new Le(i,a),new Le(i,d),new Le(l,d),new Le(l,a)];if(o.length>2)for(const g of p)if(df(o,g))return!0;for(let g=0;g<o.length-1;g++)if(ju(o[g],o[g+1],p))return!0;return!1}function ju(o,i,a){const l=a[0],d=a[2];if(o.x<l.x&&i.x<l.x||o.x>d.x&&i.x>d.x||o.y<l.y&&i.y<l.y||o.y>d.y&&i.y>d.y)return!1;const p=Ot(o,i,a[0]);return p!==Ot(o,i,a[1])||p!==Ot(o,i,a[2])||p!==Ot(o,i,a[3])}function tu(o,i,a,l,d,p){let g=i.y-o.y,y=o.x-i.x;if(p=p||0){const x=g*g+y*y;if(0===x)return!0;const C=Math.sqrt(x);g/=C,y/=C}return!((a.x-o.x)*g+(a.y-o.y)*y-p<0||(l.x-o.x)*g+(l.y-o.y)*y-p<0||(d.x-o.x)*g+(d.y-o.y)*y-p<0)}function uy(o,i,a,l,d,p,g){return!(tu(o,i,l,d,p,g)||tu(i,a,l,d,p,g)||tu(a,o,l,d,p,g)||tu(l,d,o,i,a,g)||tu(d,p,o,i,a,g)||tu(p,l,o,i,a,g))}function hf(o,i,a){const l=i.paint.get(o).value;return"constant"===l.kind?l.value:a.programConfigurations.get(i.id).getMaxValue(o)}function xg(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function aT(o,i,a,l,d){if(!i[0]&&!i[1])return o;const p=Le.convert(i)._mult(d);"viewport"===a&&p._rotate(-l);const g=[];for(let y=0;y<o.length;y++)g.push(o[y].sub(p));return g}function lT(o,i,a,l){const d=Le.convert(o)._mult(l);return"viewport"===i&&d._rotate(-a),d}rn(kb,"CircleBucket",{omit:["layers"]});const JA=new vt({"circle-sort-key":new Ne(He.layout_circle["circle-sort-key"]),visibility:new fe(He.layout_circle.visibility)});var Ob={paint:new vt({"circle-radius":new Ne(He.paint_circle["circle-radius"]),"circle-color":new Ne(He.paint_circle["circle-color"]),"circle-blur":new Ne(He.paint_circle["circle-blur"]),"circle-opacity":new Ne(He.paint_circle["circle-opacity"]),"circle-translate":new fe(He.paint_circle["circle-translate"]),"circle-translate-anchor":new fe(He.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new fe(He.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new fe(He.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ne(He.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ne(He.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ne(He.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new fe(He.paint_circle["circle-emissive-strength"])}),layout:JA};const Fb=h.m.create(),cT=o=>{const i=[];return"map"===o.paint.get("circle-pitch-alignment")&&i.push("PITCH_WITH_MAP"),"map"===o.paint.get("circle-pitch-scale")&&i.push("SCALE_WITH_MAP"),i};function uT(o,i,a,l,d,p,g,y,x){if(p&&o.queryGeometry.isAboveHorizon)return!1;p&&(x*=o.pixelToTileUnitsFactor);const C=o.tileID.canonical,D=a.projection.upVectorScale(C,a.center.lat,a.worldSize).metersToTile;for(const M of i)for(const k of M){const P=k.add(y),F=d&&a.elevation?a.elevation.exaggeration()*d.getElevationAt(P.x,P.y,!0):0,B=a.projection.projectTilePoint(P.x,P.y,C);if(F>0){const ie=a.projection.upVector(C,P.x,P.y);B.x+=ie[0]*D*F,B.y+=ie[1]*D*F,B.z+=ie[2]*D*F}const j=p?P:fw(B.x,B.y,B.z,l),q=p?o.tilespaceRays.map(ie=>hT(ie,F)):o.queryGeometry.screenGeometry,te=h.e.transformMat4([],[B.x,B.y,B.z,1],l);if(!g&&p?x*=te[3]/a.cameraToCenterDistance:g&&!p&&(x*=a.cameraToCenterDistance/te[3]),p){const ie=os((k.y/Ht+C.y)/(1<<C.z));x/=a.projection.pixelsPerMeter(ie,1)/zo(1,ie)}if(oT(q,j,x))return!0}return!1}function fw(o,i,a,l){const d=h.e.transformMat4([],[o,i,a,1],l);return new Le(d[0]/d[3],d[1]/d[3])}const pw=h.v.fromValues(0,0,0),dT=h.v.fromValues(0,0,1);function hT(o,i){const a=h.v.create();return pw[2]=i,o.intersectsPlane(pw,dT,a),new Le(a[0],a[1])}class mw extends kb{}function Lb(o,{width:i,height:a},l,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==i*a*l)throw new RangeError("mismatched image size")}else d=new Uint8Array(i*a*l);return o.width=i,o.height=a,o.data=d,o}function wg(o,i,a){const{width:l,height:d}=i;l===o.width&&d===o.height||(dy(o,i,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,l),height:Math.min(o.height,d)},a),o.width=l,o.height=d,o.data=i.data)}function dy(o,i,a,l,d,p,g){if(0===d.width||0===d.height)return i;if(d.width>o.width||d.height>o.height||a.x>o.width-d.width||a.y>o.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>i.width||d.height>i.height||l.x>i.width-d.width||l.y>i.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const y=o.data,x=i.data,C=4===p&&g;for(let D=0;D<d.height;D++){const M=((a.y+D)*o.width+a.x)*p,k=((l.y+D)*i.width+l.x)*p;if(C)for(let P=0;P<d.width;P++){const F=M+P*p+3,B=k+P*p;x[B+0]=255,x[B+1]=255,x[B+2]=255,x[B+3]=y[F]}else for(let P=0;P<d.width*p;P++)x[k+P]=y[M+P]}return i}rn(mw,"HeatmapBucket",{omit:["layers"]});class pc{constructor(i,a){Lb(this,i,1,a)}resize(i){wg(this,new pc(i),1)}clone(){return new pc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,a,l,d,p){dy(i,a,l,d,p,1)}}class il{constructor(i,a){Lb(this,i,4,a)}resize(i){wg(this,new il(i),4)}replace(i,a){a?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new il({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,a,l,d,p,g){dy(i,a,l,d,p,4,g)}}class ka{constructor(i,a){this.width=i.width,this.height=i.height,this.data=a instanceof Uint8Array?new Float32Array(a.buffer):a}}rn(pc,"AlphaImage"),rn(il,"RGBAImage");const Bl=new vt({visibility:new fe(He.layout_heatmap.visibility)});var fT={paint:new vt({"heatmap-radius":new Ne(He.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ne(He.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new fe(He.paint_heatmap["heatmap-intensity"]),"heatmap-color":new At(He.paint_heatmap["heatmap-color"]),"heatmap-opacity":new fe(He.paint_heatmap["heatmap-opacity"])}),layout:Bl};function qd(o){const i={},a=o.resolution||256,l=o.clips?o.clips.length:1,d=o.image||new il({width:a,height:l}),p=(g,y,x)=>{i[o.evaluationKey]=x;const C=o.expression.evaluate(i);C&&(d.data[g+y+0]=Math.floor(255*C.r/C.a),d.data[g+y+1]=Math.floor(255*C.g/C.a),d.data[g+y+2]=Math.floor(255*C.b/C.a),d.data[g+y+3]=Math.floor(255*C.a))};if(o.clips)for(let g=0,y=0;g<l;++g,y+=4*a)for(let x=0,C=0;x<a;x++,C+=4){const D=x/(a-1),{start:M,end:k}=o.clips[g];p(y,C,M*(1-D)+k*D)}else for(let g=0,y=0;g<a;g++,y+=4)p(0,y,g/(a-1));return d}const gw=new vt({visibility:new fe(He.layout_hillshade.visibility)});var pT={paint:new vt({"hillshade-illumination-direction":new fe(He.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new fe(He.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new fe(He.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new fe(He.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new fe(He.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new fe(He.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new fe(He.paint_hillshade["hillshade-emissive-strength"])}),layout:gw};const mT=_n([{name:"a_pos",components:2,type:"Int16"}],4),{members:gT}=mT;var Nb={exports:{}};function Cg(o,i,a){a=a||2;var l,d,p,g,y,x,C,D=i&&i.length,M=D?i[0]*a:o.length,k=_T(o,0,M,a,!0),P=[];if(!k||k.next===k.prev)return P;if(D&&(k=function(B,j,q,te){var ie,se,de,pe=[];for(ie=0,se=j.length;ie<se;ie++)(de=_T(B,j[ie]*te,ie<se-1?j[ie+1]*te:B.length,te,!1))===de.next&&(de.steiner=!0),pe.push(vw(de));for(pe.sort(Bb),ie=0;ie<pe.length;ie++)q=hy(pe[ie],q);return q}(o,i,k,a)),o.length>80*a){l=p=o[0],d=g=o[1];for(var F=a;F<M;F+=a)(y=o[F])<l&&(l=y),(x=o[F+1])<d&&(d=x),y>p&&(p=y),x>g&&(g=x);C=0!==(C=Math.max(p-l,g-d))?32767/C:0}return Uu(k,P,a,l,d,C,0),P}function _T(o,i,a,l,d){var p,g;if(d===Sg(o,i,a,l)>0)for(p=i;p<a;p+=l)g=gy(p,o[p],o[p+1],g);else for(p=a-l;p>=i;p-=l)g=gy(p,o[p],o[p+1],g);return g&&py(g,g.next)&&(Wd(g),g=g.next),g}function Ep(o,i){if(!o)return o;i||(i=o);var a,l=o;do{if(a=!1,l.steiner||!py(l,l.next)&&0!==po(l.prev,l,l.next))l=l.next;else{if(Wd(l),(l=i=l.prev)===l.next)break;a=!0}}while(a||l!==i);return i}function Uu(o,i,a,l,d,p,g){if(o){!g&&p&&function(D,M,k,P){var F=D;do{0===F.z&&(F.z=fy(F.x,F.y,M,k,P)),F.prevZ=F.prev,F.nextZ=F.next,F=F.next}while(F!==D);F.prevZ.nextZ=null,F.prevZ=null,function(B){var j,q,te,ie,se,de,pe,Ee,Ie=1;do{for(q=B,B=null,se=null,de=0;q;){for(de++,te=q,pe=0,j=0;j<Ie&&(pe++,te=te.nextZ);j++);for(Ee=Ie;pe>0||Ee>0&&te;)0!==pe&&(0===Ee||!te||q.z<=te.z)?(ie=q,q=q.nextZ,pe--):(ie=te,te=te.nextZ,Ee--),se?se.nextZ=ie:B=ie,ie.prevZ=se,se=ie;q=te}se.nextZ=null,Ie*=2}while(de>1)}(F)}(o,l,d,p);for(var y,x,C=o;o.prev!==o.next;)if(y=o.prev,x=o.next,p?Eg(o,l,d,p):Kt(o))i.push(y.i/a|0),i.push(o.i/a|0),i.push(x.i/a|0),Wd(o),o=x.next,C=x.next;else if((o=x)===C){g?1===g?Uu(o=_w(Ep(o),i,a),i,a,l,d,p,2):2===g&&yw(o,i,a,l,d,p):Uu(Ep(o),i,a,l,d,p,1);break}}}function Kt(o){var i=o.prev,a=o,l=o.next;if(po(i,a,l)>=0)return!1;for(var d=i.x,p=a.x,g=l.x,y=i.y,x=a.y,C=l.y,D=d<p?d<g?d:g:p<g?p:g,M=y<x?y<C?y:C:x<C?x:C,k=d>p?d>g?d:g:p>g?p:g,P=y>x?y>C?y:C:x>C?x:C,F=l.next;F!==i;){if(F.x>=D&&F.x<=k&&F.y>=M&&F.y<=P&&Hu(d,y,p,x,g,C,F.x,F.y)&&po(F.prev,F,F.next)>=0)return!1;F=F.next}return!0}function Eg(o,i,a,l){var d=o.prev,p=o,g=o.next;if(po(d,p,g)>=0)return!1;for(var y=d.x,x=p.x,C=g.x,D=d.y,M=p.y,k=g.y,P=y<x?y<C?y:C:x<C?x:C,F=D<M?D<k?D:k:M<k?M:k,B=y>x?y>C?y:C:x>C?x:C,j=D>M?D>k?D:k:M>k?M:k,q=fy(P,F,i,a,l),te=fy(B,j,i,a,l),ie=o.prevZ,se=o.nextZ;ie&&ie.z>=q&&se&&se.z<=te;){if(ie.x>=P&&ie.x<=B&&ie.y>=F&&ie.y<=j&&ie!==d&&ie!==g&&Hu(y,D,x,M,C,k,ie.x,ie.y)&&po(ie.prev,ie,ie.next)>=0||(ie=ie.prevZ,se.x>=P&&se.x<=B&&se.y>=F&&se.y<=j&&se!==d&&se!==g&&Hu(y,D,x,M,C,k,se.x,se.y)&&po(se.prev,se,se.next)>=0))return!1;se=se.nextZ}for(;ie&&ie.z>=q;){if(ie.x>=P&&ie.x<=B&&ie.y>=F&&ie.y<=j&&ie!==d&&ie!==g&&Hu(y,D,x,M,C,k,ie.x,ie.y)&&po(ie.prev,ie,ie.next)>=0)return!1;ie=ie.prevZ}for(;se&&se.z<=te;){if(se.x>=P&&se.x<=B&&se.y>=F&&se.y<=j&&se!==d&&se!==g&&Hu(y,D,x,M,C,k,se.x,se.y)&&po(se.prev,se,se.next)>=0)return!1;se=se.nextZ}return!0}function _w(o,i,a){var l=o;do{var d=l.prev,p=l.next.next;!py(d,p)&&my(d,l,l.next,p)&&mc(d,p)&&mc(p,d)&&(i.push(d.i/a|0),i.push(l.i/a|0),i.push(p.i/a|0),Wd(l),Wd(l.next),l=o=p),l=l.next}while(l!==o);return Ep(l)}function yw(o,i,a,l,d,p){var g=o;do{for(var y=g.next.next;y!==g.prev;){if(g.i!==y.i&&eI(g,y)){var x=bw(g,y);return g=Ep(g,g.next),x=Ep(x,x.next),Uu(g,i,a,l,d,p,0),void Uu(x,i,a,l,d,p,0)}y=y.next}g=g.next}while(g!==o)}function Bb(o,i){return o.x-i.x}function hy(o,i){var a=function(d,p){var g,y=p,x=d.x,C=d.y,D=-1/0;do{if(C<=y.y&&C>=y.next.y&&y.next.y!==y.y){var M=y.x+(C-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(M<=x&&M>D&&(D=M,g=y.x<y.next.x?y:y.next,M===x))return g}y=y.next}while(y!==p);if(!g)return null;var k,P=g,F=g.x,B=g.y,j=1/0;y=g;do{x>=y.x&&y.x>=F&&x!==y.x&&Hu(C<B?x:D,C,F,B,C<B?D:x,C,y.x,y.y)&&(k=Math.abs(C-y.y)/(x-y.x),mc(y,d)&&(k<j||k===j&&(y.x>g.x||y.x===g.x&&yT(g,y)))&&(g=y,j=k)),y=y.next}while(y!==P);return g}(o,i);if(!a)return i;var l=bw(a,o);return Ep(l,l.next),Ep(a,a.next)}function yT(o,i){return po(o.prev,o,i.prev)<0&&po(i.next,o,o.next)<0}function fy(o,i,a,l,d){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-a)*d|0)|o<<8))|o<<4))|o<<2))|o<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-l)*d|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function vw(o){var i=o,a=o;do{(i.x<a.x||i.x===a.x&&i.y<a.y)&&(a=i),i=i.next}while(i!==o);return a}function Hu(o,i,a,l,d,p,g,y){return(d-g)*(i-y)>=(o-g)*(p-y)&&(o-g)*(l-y)>=(a-g)*(i-y)&&(a-g)*(p-y)>=(d-g)*(l-y)}function eI(o,i){return o.next.i!==i.i&&o.prev.i!==i.i&&!function(a,l){var d=a;do{if(d.i!==a.i&&d.next.i!==a.i&&d.i!==l.i&&d.next.i!==l.i&&my(d,d.next,a,l))return!0;d=d.next}while(d!==a);return!1}(o,i)&&(mc(o,i)&&mc(i,o)&&function(a,l){var d=a,p=!1,g=(a.x+l.x)/2,y=(a.y+l.y)/2;do{d.y>y!=d.next.y>y&&d.next.y!==d.y&&g<(d.next.x-d.x)*(y-d.y)/(d.next.y-d.y)+d.x&&(p=!p),d=d.next}while(d!==a);return p}(o,i)&&(po(o.prev,o,i.prev)||po(o,i.prev,i))||py(o,i)&&po(o.prev,o,o.next)>0&&po(i.prev,i,i.next)>0)}function po(o,i,a){return(i.y-o.y)*(a.x-i.x)-(i.x-o.x)*(a.y-i.y)}function py(o,i){return o.x===i.x&&o.y===i.y}function my(o,i,a,l){var d=Tg(po(o,i,a)),p=Tg(po(o,i,l)),g=Tg(po(a,l,o)),y=Tg(po(a,l,i));return d!==p&&g!==y||!(0!==d||!Dg(o,a,i))||!(0!==p||!Dg(o,l,i))||!(0!==g||!Dg(a,o,l))||!(0!==y||!Dg(a,i,l))}function Dg(o,i,a){return i.x<=Math.max(o.x,a.x)&&i.x>=Math.min(o.x,a.x)&&i.y<=Math.max(o.y,a.y)&&i.y>=Math.min(o.y,a.y)}function Tg(o){return o>0?1:o<0?-1:0}function mc(o,i){return po(o.prev,o,o.next)<0?po(o,i,o.next)>=0&&po(o,o.prev,i)>=0:po(o,i,o.prev)<0||po(o,o.next,i)<0}function bw(o,i){var a=new zb(o.i,o.x,o.y),l=new zb(i.i,i.x,i.y),d=o.next,p=i.prev;return o.next=i,i.prev=o,a.next=d,d.prev=a,l.next=a,a.prev=l,p.next=l,l.prev=p,l}function gy(o,i,a,l){var d=new zb(o,i,a);return l?(d.next=l.next,d.prev=l,l.next.prev=d,l.next=d):(d.prev=d,d.next=d),d}function Wd(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function zb(o,i,a){this.i=o,this.x=i,this.y=a,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Sg(o,i,a,l){for(var d=0,p=i,g=a-l;p<a;p+=l)d+=(o[g]-o[p])*(o[p+1]+o[g+1]),g=p;return d}Nb.exports=Cg,Nb.exports.default=Cg,Cg.deviation=function(o,i,a,l){var d=i&&i.length,p=Math.abs(Sg(o,0,d?i[0]*a:o.length,a));if(d)for(var g=0,y=i.length;g<y;g++)p-=Math.abs(Sg(o,i[g]*a,g<y-1?i[g+1]*a:o.length,a));var x=0;for(g=0;g<l.length;g+=3){var C=l[g]*a,D=l[g+1]*a,M=l[g+2]*a;x+=Math.abs((o[C]-o[M])*(o[D+1]-o[C+1])-(o[C]-o[D])*(o[M+1]-o[C+1]))}return 0===p&&0===x?0:Math.abs((x-p)/p)},Cg.flatten=function(o){for(var i=o[0][0].length,a={vertices:[],holes:[],dimensions:i},l=0,d=0;d<o.length;d++){for(var p=0;p<o[d].length;p++)for(var g=0;g<i;g++)a.vertices.push(o[d][p][g]);d>0&&a.holes.push(l+=o[d-1].length)}return a};var ff=De(Nb.exports);function ra(o,i){const a=o.length;if(a<=1)return[o];const l=[];let d,p;for(let g=0;g<a;g++){const y=ge(o[g]);0!==y&&(o[g].area=Math.abs(y),void 0===p&&(p=y<0),p===y<0?(d&&l.push(d),d=[o[g]]):d.push(o[g]))}if(d&&l.push(d),i>1)for(let g=0;g<l.length;g++)l[g].length<=i||(Dh(l[g],i,1,l[g].length-1,_y),l[g]=l[g].slice(0,i));return l}function _y(o,i){return i.area-o.area}function Mg(o,i,a){const l=a.patternDependencies;let d=!1;for(const p of i){const g=p.paint.get(`${o}-pattern`);g.isConstant()||(d=!0);const y=g.constantOr(null);y&&(d=!0,l[y]=!0)}return d}function Vb(o,i,a,l,d){const p=d.patternDependencies;for(const g of i){const y=g.paint.get(`${o}-pattern`).value;if("constant"!==y.kind){let x=y.evaluate({zoom:l},a,{},d.availableImages);x=x&&x.name?x.name:x,p[x]=!0,a.patterns[g.id]=x}}return a}class yy{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new un,this.indexArray=new rr,this.indexArray2=new Er,this.programConfigurations=new Zc(i.layers,i.zoom),this.segments=new Dr,this.segments2=new Dr,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.projection=i.projection}populate(i,a,l,d){this.hasPattern=Mg("fill",this.layers,a);const p=this.layers[0].layout.get("fill-sort-key"),g=[];for(const{feature:y,id:x,index:C,sourceLayerIndex:D}of i){const M=this.layers[0]._featureFilter.needGeometry,k=Gd(y,M);if(!this.layers[0]._featureFilter.filter(new Ce(this.zoom),k,l))continue;const P=p?p.evaluate(k,{},l,a.availableImages):void 0,F={id:x,properties:y.properties,type:y.type,sourceLayerIndex:D,index:C,geometry:M?k.geometry:eu(y,l,d),patterns:{},sortKey:P};g.push(F)}p&&g.sort((y,x)=>y.sortKey-x.sortKey);for(const y of g){const{geometry:x,index:C,sourceLayerIndex:D}=y;if(this.hasPattern){const M=Vb("fill",this.layers,y,this.zoom,a);this.patternFeatures.push(M)}else this.addFeature(y,x,C,l,{},a.availableImages,a.brightness);a.featureIndex.insert(i[C].feature,x,C,D,this.index)}}update(i,a,l,d,p){const g=0!==Object.keys(i).length;g&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(i,a,g?this.stateDependentLayers:this.layers,l,d,p)}addFeatures(i,a,l,d,p,g){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,a,l,d,g)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,gT),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,a,l,d,p,g=[],y){for(const x of ra(a,500)){let C=0;for(const B of x)C+=B.length;const D=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray),M=D.vertexLength,k=[],P=[];for(const B of x){if(0===B.length)continue;B!==x[0]&&P.push(k.length/2);const j=this.segments2.prepareSegment(B.length,this.layoutVertexArray,this.indexArray2),q=j.vertexLength;this.layoutVertexArray.emplaceBack(B[0].x,B[0].y),this.indexArray2.emplaceBack(q+B.length-1,q),k.push(B[0].x),k.push(B[0].y);for(let te=1;te<B.length;te++)this.layoutVertexArray.emplaceBack(B[te].x,B[te].y),this.indexArray2.emplaceBack(q+te-1,q+te),k.push(B[te].x),k.push(B[te].y);j.vertexLength+=B.length,j.primitiveLength+=B.length}const F=ff(k,P);for(let B=0;B<F.length;B+=3)this.indexArray.emplaceBack(M+F[B],M+F[B+1],M+F[B+2]);D.vertexLength+=C,D.primitiveLength+=F.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,l,p,g,d,y)}}rn(yy,"FillBucket",{omit:["layers","patternFeatures"]});const xw=new vt({"fill-sort-key":new Ne(He.layout_fill["fill-sort-key"]),visibility:new fe(He.layout_fill.visibility)});var Dp={paint:new vt({"fill-antialias":new fe(He.paint_fill["fill-antialias"]),"fill-opacity":new Ne(He.paint_fill["fill-opacity"]),"fill-color":new Ne(He.paint_fill["fill-color"]),"fill-outline-color":new Ne(He.paint_fill["fill-outline-color"]),"fill-translate":new fe(He.paint_fill["fill-translate"]),"fill-translate-anchor":new fe(He.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ne(He.paint_fill["fill-pattern"]),"fill-emissive-strength":new fe(He.paint_fill["fill-emissive-strength"])}),layout:xw};const vT=_n([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),bT=_n([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),xT=_n([{name:"a_centroid_pos",components:2,type:"Uint16"}]),jb=_n([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Ag=_n([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:wT}=vT;var Ig={},Zd=Ge,CT=oa;function oa(o,i,a,l,d){this.properties={},this.extent=a,this.type=0,this._pbf=o,this._geometry=-1,this._keys=l,this._values=d,o.readFields(Ub,this,i)}function Ub(o,i,a){1==o?i.id=a.readVarint():2==o?function(l,d){for(var p=l.readVarint()+l.pos;l.pos<p;){var g=d._keys[l.readVarint()],y=d._values[l.readVarint()];d.properties[g]=y}}(a,i):3==o?i.type=a.readVarint():4==o&&(i._geometry=a.pos)}function ET(o){for(var i,a,l=0,d=0,p=o.length,g=p-1;d<p;g=d++)l+=((a=o[g]).x-(i=o[d]).x)*(i.y+a.y);return l}oa.types=["Unknown","Point","LineString","Polygon"],oa.prototype.loadGeometry=function(){var o=this._pbf;o.pos=this._geometry;for(var i,a=o.readVarint()+o.pos,l=1,d=0,p=0,g=0,y=[];o.pos<a;){if(d<=0){var x=o.readVarint();l=7&x,d=x>>3}if(d--,1===l||2===l)p+=o.readSVarint(),g+=o.readSVarint(),1===l&&(i&&y.push(i),i=[]),i.push(new Zd(p,g));else{if(7!==l)throw new Error("unknown command "+l);i&&i.push(i[0].clone())}}return i&&y.push(i),y},oa.prototype.bbox=function(){var o=this._pbf;o.pos=this._geometry;for(var i=o.readVarint()+o.pos,a=1,l=0,d=0,p=0,g=1/0,y=-1/0,x=1/0,C=-1/0;o.pos<i;){if(l<=0){var D=o.readVarint();a=7&D,l=D>>3}if(l--,1===a||2===a)(d+=o.readSVarint())<g&&(g=d),d>y&&(y=d),(p+=o.readSVarint())<x&&(x=p),p>C&&(C=p);else if(7!==a)throw new Error("unknown command "+a)}return[g,x,y,C]},oa.prototype.toGeoJSON=function(o,i,a){var l,d,p=this.extent*Math.pow(2,a),g=this.extent*o,y=this.extent*i,x=this.loadGeometry(),C=oa.types[this.type];function D(P){for(var F=0;F<P.length;F++){var B=P[F];P[F]=[360*(B.x+g)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*(B.y+y)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var M=[];for(l=0;l<x.length;l++)M[l]=x[l][0];D(x=M);break;case 2:for(l=0;l<x.length;l++)D(x[l]);break;case 3:for(x=function(P){var F=P.length;if(F<=1)return[P];for(var B,j,q=[],te=0;te<F;te++){var ie=ET(P[te]);0!==ie&&(void 0===j&&(j=ie<0),j===ie<0?(B&&q.push(B),B=[P[te]]):B.push(P[te]))}return B&&q.push(B),q}(x),l=0;l<x.length;l++)for(d=0;d<x[l].length;d++)D(x[l][d])}1===x.length?x=x[0]:C="Multi"+C;var k={type:"Feature",geometry:{type:C,coordinates:x},properties:this.properties};return"id"in this&&(k.id=this.id),k};var tI=CT,DT=kg;function kg(o,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(TT,this,i),this.length=this._features.length}function TT(o,i,a){15===o?i.version=a.readVarint():1===o?i.name=a.readString():5===o?i.extent=a.readVarint():2===o?i._features.push(a.pos):3===o?i._keys.push(a.readString()):4===o&&i._values.push(function(l){for(var d=null,p=l.readVarint()+l.pos;l.pos<p;){var g=l.readVarint()>>3;d=1===g?l.readString():2===g?l.readFloat():3===g?l.readDouble():4===g?l.readVarint64():5===g?l.readVarint():6===g?l.readSVarint():7===g?l.readBoolean():null}return d}(a))}kg.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var i=this._pbf.readVarint()+this._pbf.pos;return new tI(this._pbf,i,this.extent,this._keys,this._values)};var Hb=DT;function $b(o,i,a){if(3===o){var l=new Hb(a,a.readVarint()+a.pos);l.length&&(i[l.name]=l)}}var Yd=Ig.VectorTile=function(o,i){this.layers=o.readFields($b,{},i)},Tp=Ig.VectorTileFeature=CT;function Sp(o,i,a,l){const d=[],p=0===l?(g,y,x,C,D,M)=>{g.push(new Le(M,x+(M-y)/(C-y)*(D-x)))}:(g,y,x,C,D,M)=>{g.push(new Le(y+(M-x)/(D-x)*(C-y),M))};for(const g of o){const y=[];for(const x of g){if(x.length<=2)continue;const C=[];for(let k=0;k<x.length-1;k++){const P=x[k].x,F=x[k].y,B=x[k+1].x,j=x[k+1].y,q=0===l?P:F,te=0===l?B:j;q<i?te>i&&p(C,P,F,B,j,i):q>a?te<a&&p(C,P,F,B,j,a):C.push(x[k]),te<i&&q>=i&&p(C,P,F,B,j,i),te>a&&q<=a&&p(C,P,F,B,j,a)}let D=x[x.length-1];const M=0===l?D.x:D.y;M>=i&&M<=a&&C.push(D),C.length&&(D=C[C.length-1],C[0].x===D.x&&C[0].y===D.y||C.push(C[0]),y.push(C))}y.length&&d.push(y)}return d}Ig.VectorTileLayer=DT;class Mp{constructor(i){this._stringToNumber={},this._numberToString=[];for(let a=0;a<i.length;a++){const l=i[a];this._stringToNumber[l]=a,this._numberToString[a]=l}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}var vy={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(o,i,a,l,d){var p,g,y=8*d-l-1,x=(1<<y)-1,C=x>>1,D=-7,M=a?d-1:0,k=a?-1:1,P=o[i+M];for(M+=k,p=P&(1<<-D)-1,P>>=-D,D+=y;D>0;p=256*p+o[i+M],M+=k,D-=8);for(g=p&(1<<-D)-1,p>>=-D,D+=l;D>0;g=256*g+o[i+M],M+=k,D-=8);if(0===p)p=1-C;else{if(p===x)return g?NaN:1/0*(P?-1:1);g+=Math.pow(2,l),p-=C}return(P?-1:1)*g*Math.pow(2,p-l)},write:function(o,i,a,l,d,p){var g,y,x,C=8*p-d-1,D=(1<<C)-1,M=D>>1,k=23===d?Math.pow(2,-24)-Math.pow(2,-77):0,P=l?0:p-1,F=l?1:-1,B=i<0||0===i&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(y=isNaN(i)?1:0,g=D):(g=Math.floor(Math.log(i)/Math.LN2),i*(x=Math.pow(2,-g))<1&&(g--,x*=2),(i+=g+M>=1?k/x:k*Math.pow(2,1-M))*x>=2&&(g++,x/=2),g+M>=D?(y=0,g=D):g+M>=1?(y=(i*x-1)*Math.pow(2,d),g+=M):(y=i*Math.pow(2,M-1)*Math.pow(2,d),g=0));d>=8;o[a+P]=255&y,P+=F,y/=256,d-=8);for(g=g<<d|y,C+=d;C>0;o[a+P]=255&g,P+=F,g/=256,C-=8);o[a+P-F]|=128*B}},pf=pr,Ap=vy;function pr(o){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(o)?o:new Uint8Array(o||0),this.pos=0,this.type=0,this.length=this.buf.length}pr.Varint=0,pr.Fixed64=1,pr.Bytes=2,pr.Fixed32=5;var Ip=4294967296,ST=1/Ip,by=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function rl(o){return o.type===pr.Bytes?o.readVarint()+o.pos:o.pos+1}function Gb(o,i,a){var l=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));a.realloc(l);for(var d=a.pos-1;d>=o;d--)a.buf[d+l]=a.buf[d]}function MT(o,i){for(var a=0;a<o.length;a++)i.writeVarint(o[a])}function AT(o,i){for(var a=0;a<o.length;a++)i.writeSVarint(o[a])}function qb(o,i){for(var a=0;a<o.length;a++)i.writeFloat(o[a])}function ww(o,i){for(var a=0;a<o.length;a++)i.writeDouble(o[a])}function IT(o,i){for(var a=0;a<o.length;a++)i.writeBoolean(o[a])}function kT(o,i){for(var a=0;a<o.length;a++)i.writeFixed32(o[a])}function nI(o,i){for(var a=0;a<o.length;a++)i.writeSFixed32(o[a])}function RT(o,i){for(var a=0;a<o.length;a++)i.writeFixed64(o[a])}function xy(o,i){for(var a=0;a<o.length;a++)i.writeSFixed64(o[a])}function Rp(o,i){return(o[i]|o[i+1]<<8|o[i+2]<<16)+16777216*o[i+3]}function Pp(o,i,a){o[a]=i,o[a+1]=i>>>8,o[a+2]=i>>>16,o[a+3]=i>>>24}function Wb(o,i){return(o[i]|o[i+1]<<8|o[i+2]<<16)+(o[i+3]<<24)}pr.prototype={destroy:function(){this.buf=null},readFields:function(o,i,a){for(a=a||this.length;this.pos<a;){var l=this.readVarint(),d=l>>3,p=this.pos;this.type=7&l,o(d,i,this),this.pos===p&&this.skip(l)}return i},readMessage:function(o,i){return this.readFields(o,i,this.readVarint()+this.pos)},readFixed32:function(){var o=Rp(this.buf,this.pos);return this.pos+=4,o},readSFixed32:function(){var o=Wb(this.buf,this.pos);return this.pos+=4,o},readFixed64:function(){var o=Rp(this.buf,this.pos)+Rp(this.buf,this.pos+4)*Ip;return this.pos+=8,o},readSFixed64:function(){var o=Rp(this.buf,this.pos)+Wb(this.buf,this.pos+4)*Ip;return this.pos+=8,o},readFloat:function(){var o=Ap.read(this.buf,this.pos,!0,23,4);return this.pos+=4,o},readDouble:function(){var o=Ap.read(this.buf,this.pos,!0,52,8);return this.pos+=8,o},readVarint:function(o){var i,a,l=this.buf;return i=127&(a=l[this.pos++]),a<128?i:(i|=(127&(a=l[this.pos++]))<<7,a<128?i:(i|=(127&(a=l[this.pos++]))<<14,a<128?i:(i|=(127&(a=l[this.pos++]))<<21,a<128?i:function(d,p,g){var y,x,C=g.buf;if(y=(112&(x=C[g.pos++]))>>4,x<128||(y|=(127&(x=C[g.pos++]))<<3,x<128)||(y|=(127&(x=C[g.pos++]))<<10,x<128)||(y|=(127&(x=C[g.pos++]))<<17,x<128)||(y|=(127&(x=C[g.pos++]))<<24,x<128)||(y|=(1&(x=C[g.pos++]))<<31,x<128))return function kp(o,i,a){return a?4294967296*i+(o>>>0):4294967296*(i>>>0)+(o>>>0)}(d,y,p);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(a=l[this.pos]))<<28,o,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var o=this.readVarint();return o%2==1?(o+1)/-2:o/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var o=this.readVarint()+this.pos,i=this.pos;return this.pos=o,o-i>=12&&by?by.decode(this.buf.subarray(i,o)):function(a,l,d){for(var p="",g=l;g<d;){var y,x,C,D=a[g],M=null,k=D>239?4:D>223?3:D>191?2:1;if(g+k>d)break;1===k?D<128&&(M=D):2===k?128==(192&(y=a[g+1]))&&(M=(31&D)<<6|63&y)<=127&&(M=null):3===k?(x=a[g+2],128==(192&(y=a[g+1]))&&128==(192&x)&&((M=(15&D)<<12|(63&y)<<6|63&x)<=2047||M>=55296&&M<=57343)&&(M=null)):4===k&&(x=a[g+2],C=a[g+3],128==(192&(y=a[g+1]))&&128==(192&x)&&128==(192&C)&&((M=(15&D)<<18|(63&y)<<12|(63&x)<<6|63&C)<=65535||M>=1114112)&&(M=null)),null===M?(M=65533,k=1):M>65535&&(M-=65536,p+=String.fromCharCode(M>>>10&1023|55296),M=56320|1023&M),p+=String.fromCharCode(M),g+=k}return p}(this.buf,i,o)},readBytes:function(){var o=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,o);return this.pos=o,i},readPackedVarint:function(o,i){if(this.type!==pr.Bytes)return o.push(this.readVarint(i));var a=rl(this);for(o=o||[];this.pos<a;)o.push(this.readVarint(i));return o},readPackedSVarint:function(o){if(this.type!==pr.Bytes)return o.push(this.readSVarint());var i=rl(this);for(o=o||[];this.pos<i;)o.push(this.readSVarint());return o},readPackedBoolean:function(o){if(this.type!==pr.Bytes)return o.push(this.readBoolean());var i=rl(this);for(o=o||[];this.pos<i;)o.push(this.readBoolean());return o},readPackedFloat:function(o){if(this.type!==pr.Bytes)return o.push(this.readFloat());var i=rl(this);for(o=o||[];this.pos<i;)o.push(this.readFloat());return o},readPackedDouble:function(o){if(this.type!==pr.Bytes)return o.push(this.readDouble());var i=rl(this);for(o=o||[];this.pos<i;)o.push(this.readDouble());return o},readPackedFixed32:function(o){if(this.type!==pr.Bytes)return o.push(this.readFixed32());var i=rl(this);for(o=o||[];this.pos<i;)o.push(this.readFixed32());return o},readPackedSFixed32:function(o){if(this.type!==pr.Bytes)return o.push(this.readSFixed32());var i=rl(this);for(o=o||[];this.pos<i;)o.push(this.readSFixed32());return o},readPackedFixed64:function(o){if(this.type!==pr.Bytes)return o.push(this.readFixed64());var i=rl(this);for(o=o||[];this.pos<i;)o.push(this.readFixed64());return o},readPackedSFixed64:function(o){if(this.type!==pr.Bytes)return o.push(this.readSFixed64());var i=rl(this);for(o=o||[];this.pos<i;)o.push(this.readSFixed64());return o},skip:function(o){var i=7&o;if(i===pr.Varint)for(;this.buf[this.pos++]>127;);else if(i===pr.Bytes)this.pos=this.readVarint()+this.pos;else if(i===pr.Fixed32)this.pos+=4;else{if(i!==pr.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(o,i){this.writeVarint(o<<3|i)},realloc:function(o){for(var i=this.length||16;i<this.pos+o;)i*=2;if(i!==this.length){var a=new Uint8Array(i);a.set(this.buf),this.buf=a,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(o){this.realloc(4),Pp(this.buf,o,this.pos),this.pos+=4},writeSFixed32:function(o){this.realloc(4),Pp(this.buf,o,this.pos),this.pos+=4},writeFixed64:function(o){this.realloc(8),Pp(this.buf,-1&o,this.pos),Pp(this.buf,Math.floor(o*ST),this.pos+4),this.pos+=8},writeSFixed64:function(o){this.realloc(8),Pp(this.buf,-1&o,this.pos),Pp(this.buf,Math.floor(o*ST),this.pos+4),this.pos+=8},writeVarint:function(o){(o=+o||0)>268435455||o<0?function(i,a){var l,d,p,y;if(i>=0?(l=i%4294967296|0,d=i/4294967296|0):(d=~(-i/4294967296),4294967295^(l=~(-i%4294967296))?l=l+1|0:(l=0,d=d+1|0)),i>=0x10000000000000000||i<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),p=l,(y=a).buf[y.pos++]=127&p|128,p>>>=7,y.buf[y.pos++]=127&p|128,p>>>=7,y.buf[y.pos++]=127&p|128,p>>>=7,y.buf[y.pos++]=127&p|128,y.buf[y.pos]=127&(p>>>=7),function(p,g){var y=(7&p)<<4;g.buf[g.pos++]|=y|((p>>>=3)?128:0),p&&(g.buf[g.pos++]=127&p|((p>>>=7)?128:0),p&&(g.buf[g.pos++]=127&p|((p>>>=7)?128:0),p&&(g.buf[g.pos++]=127&p|((p>>>=7)?128:0),p&&(g.buf[g.pos++]=127&p|((p>>>=7)?128:0),p&&(g.buf[g.pos++]=127&p)))))}(d,a)}(o,this):(this.realloc(4),this.buf[this.pos++]=127&o|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=o>>>7&127))))},writeSVarint:function(o){this.writeVarint(o<0?2*-o-1:2*o)},writeBoolean:function(o){this.writeVarint(!!o)},writeString:function(o){o=String(o),this.realloc(4*o.length),this.pos++;var i=this.pos;this.pos=function(l,d,p){for(var g,y,x=0;x<d.length;x++){if((g=d.charCodeAt(x))>55295&&g<57344){if(!y){g>56319||x+1===d.length?(l[p++]=239,l[p++]=191,l[p++]=189):y=g;continue}if(g<56320){l[p++]=239,l[p++]=191,l[p++]=189,y=g;continue}g=y-55296<<10|g-56320|65536,y=null}else y&&(l[p++]=239,l[p++]=191,l[p++]=189,y=null);g<128?l[p++]=g:(g<2048?l[p++]=g>>6|192:(g<65536?l[p++]=g>>12|224:(l[p++]=g>>18|240,l[p++]=g>>12&63|128),l[p++]=g>>6&63|128),l[p++]=63&g|128)}return p}(this.buf,o,this.pos);var a=this.pos-i;a>=128&&Gb(i,a,this),this.pos=i-1,this.writeVarint(a),this.pos+=a},writeFloat:function(o){this.realloc(4),Ap.write(this.buf,o,this.pos,!0,23,4),this.pos+=4},writeDouble:function(o){this.realloc(8),Ap.write(this.buf,o,this.pos,!0,52,8),this.pos+=8},writeBytes:function(o){var i=o.length;this.writeVarint(i),this.realloc(i);for(var a=0;a<i;a++)this.buf[this.pos++]=o[a]},writeRawMessage:function(o,i){this.pos++;var a=this.pos;o(i,this);var l=this.pos-a;l>=128&&Gb(a,l,this),this.pos=a-1,this.writeVarint(l),this.pos+=l},writeMessage:function(o,i,a){this.writeTag(o,pr.Bytes),this.writeRawMessage(i,a)},writePackedVarint:function(o,i){i.length&&this.writeMessage(o,MT,i)},writePackedSVarint:function(o,i){i.length&&this.writeMessage(o,AT,i)},writePackedBoolean:function(o,i){i.length&&this.writeMessage(o,IT,i)},writePackedFloat:function(o,i){i.length&&this.writeMessage(o,qb,i)},writePackedDouble:function(o,i){i.length&&this.writeMessage(o,ww,i)},writePackedFixed32:function(o,i){i.length&&this.writeMessage(o,kT,i)},writePackedSFixed32:function(o,i){i.length&&this.writeMessage(o,nI,i)},writePackedFixed64:function(o,i){i.length&&this.writeMessage(o,RT,i)},writePackedSFixed64:function(o,i){i.length&&this.writeMessage(o,xy,i)},writeBytesField:function(o,i){this.writeTag(o,pr.Bytes),this.writeBytes(i)},writeFixed32Field:function(o,i){this.writeTag(o,pr.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(o,i){this.writeTag(o,pr.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(o,i){this.writeTag(o,pr.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(o,i){this.writeTag(o,pr.Fixed64),this.writeSFixed64(i)},writeVarintField:function(o,i){this.writeTag(o,pr.Varint),this.writeVarint(i)},writeSVarintField:function(o,i){this.writeTag(o,pr.Varint),this.writeSVarint(i)},writeStringField:function(o,i){this.writeTag(o,pr.Bytes),this.writeString(i)},writeFloatField:function(o,i){this.writeTag(o,pr.Fixed32),this.writeFloat(i)},writeDoubleField:function(o,i){this.writeTag(o,pr.Fixed64),this.writeDouble(i)},writeBooleanField:function(o,i){this.writeVarintField(o,!!i)}};var Op=De(pf);const wy=["tile","layer","source","sourceLayer","state"];class Cw{constructor(i,a,l,d,p){this.type="Feature",this._vectorTileFeature=i,this._z=a,this._x=l,this._y=d,this.properties=i.properties,this.id=p}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(i.id=this.id);for(const a of wy)void 0!==this[a]&&(i[a]=this[a]);return i}}class Ew{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,a,l){const d=String(a);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][d]=this.stateChanges[i][d]||{},Gr(this.stateChanges[i][d],l),null===this.deletedStates[i]){this.deletedStates[i]={};for(const p in this.state[i])p!==d&&(this.deletedStates[i][p]=null)}else if(this.deletedStates[i]&&null===this.deletedStates[i][d]){this.deletedStates[i][d]={};for(const p in this.state[i][d])l[p]||(this.deletedStates[i][d][p]=null)}else for(const p in l)this.deletedStates[i]&&this.deletedStates[i][d]&&null===this.deletedStates[i][d][p]&&delete this.deletedStates[i][d][p]}removeFeatureState(i,a,l){if(null===this.deletedStates[i])return;const d=String(a);if(this.deletedStates[i]=this.deletedStates[i]||{},l&&void 0!==a)null!==this.deletedStates[i][d]&&(this.deletedStates[i][d]=this.deletedStates[i][d]||{},this.deletedStates[i][d][l]=null);else if(void 0!==a)if(this.stateChanges[i]&&this.stateChanges[i][d])for(l in this.deletedStates[i][d]={},this.stateChanges[i][d])this.deletedStates[i][d][l]=null;else this.deletedStates[i][d]=null;else this.deletedStates[i]=null}getState(i,a){const l=String(a),d=Gr({},(this.state[i]||{})[l],(this.stateChanges[i]||{})[l]);if(null===this.deletedStates[i])return{};if(this.deletedStates[i]){const p=this.deletedStates[i][a];if(null===p)return{};for(const g in p)delete d[g]}return d}initializeTileState(i,a){i.setFeatureState(this.state,a)}coalesceChanges(i,a){const l={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const p={};for(const g in this.stateChanges[d])this.state[d][g]||(this.state[d][g]={}),Gr(this.state[d][g],this.stateChanges[d][g]),p[g]=this.state[d][g];l[d]=p}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const p={};if(null===this.deletedStates[d])for(const g in this.state[d])p[g]={},this.state[d][g]={};else for(const g in this.deletedStates[d]){if(null===this.deletedStates[d][g])this.state[d][g]={};else if(this.state[d][g])for(const y of Object.keys(this.deletedStates[d][g]))delete this.state[d][g][y];p[g]=this.state[d][g]}l[d]=l[d]||{},Gr(l[d],p)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(l).length)for(const d in i)i[d].setFeatureState(l,a)}}class Dw{constructor(i){this.size=i,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(i,a){const l=this.toIdx(i,a);return{min:this.minimums[l],max:this.maximums[l]}}isLeaf(i,a){return this.leaves[this.toIdx(i,a)]}toIdx(i,a){return a*this.size+i}}function Zb(o,i,a,l){let d=0,p=Number.MAX_VALUE;for(let g=0;g<3;g++)if(Math.abs(l[g])<1e-15){if(a[g]<o[g]||a[g]>i[g])return null}else{const y=1/l[g];let x=(o[g]-a[g])*y,C=(i[g]-a[g])*y;if(x>C){const D=x;x=C,C=D}if(x>d&&(d=x),C<p&&(p=C),d>p)return null}return d}function PT(o,i,a,l,d,p,g,y,x,C,D){const M=l-o,k=d-i,P=p-a,F=g-o,B=y-i,j=x-a,q=D[1]*j-D[2]*B,te=D[2]*F-D[0]*j,ie=D[0]*B-D[1]*F,se=M*q+k*te+P*ie;if(Math.abs(se)<1e-15)return null;const de=1/se,pe=C[0]-o,Ee=C[1]-i,Ie=C[2]-a,Pe=(pe*q+Ee*te+Ie*ie)*de;if(Pe<0||Pe>1)return null;const Ze=Ee*P-Ie*k,je=Ie*M-pe*P,dt=pe*k-Ee*M,Pt=(D[0]*Ze+D[1]*je+D[2]*dt)*de;return Pt<0||Pe+Pt>1?null:(F*Ze+B*je+j*dt)*de}function Tw(o,i,a){return(o-i)/(a-i)}function Xd(o,i,a,l,d,p,g,y,x){const C=1<<a,D=p-l,M=g-d,k=(o+1)/C*D+l,P=(i+0)/C*M+d,F=(i+1)/C*M+d;y[0]=(o+0)/C*D+l,y[1]=P,x[0]=k,x[1]=F}class Sw{constructor(i){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=i,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const a=function(p){const g=Math.ceil(Math.log2(p.dim/8)),y=[];let x=Math.ceil(Math.pow(2,g));const C=1/x,D=(P,F,B,j,q)=>{const te=j?1:0,ie=(P+1)*B-te,se=F*B,de=(F+1)*B-te;q[0]=P*B,q[1]=se,q[2]=ie,q[3]=de};let M=new Dw(x);const k=[];for(let P=0;P<x*x;P++){D(P%x,Math.floor(P/x),C,!1,k);const F=tr(k[0],k[1],p),B=tr(k[2],k[1],p),j=tr(k[2],k[3],p),q=tr(k[0],k[3],p);M.minimums.push(Math.min(F,B,j,q)),M.maximums.push(Math.max(F,B,j,q)),M.leaves.push(1)}for(y.push(M),x/=2;x>=1;x/=2){const P=y[y.length-1];M=new Dw(x);for(let F=0;F<x*x;F++){D(F%x,Math.floor(F/x),2,!0,k);const B=P.getElevation(k[0],k[1]),j=P.getElevation(k[2],k[1]),q=P.getElevation(k[2],k[3]),te=P.getElevation(k[0],k[3]),ie=P.isLeaf(k[0],k[1]),se=P.isLeaf(k[2],k[1]),de=P.isLeaf(k[2],k[3]),pe=P.isLeaf(k[0],k[3]),Ee=Math.min(B.min,j.min,q.min,te.min),Ie=Math.max(B.max,j.max,q.max,te.max),Pe=ie&&se&&de&&pe;M.maximums.push(Ie),M.minimums.push(Ee),M.leaves.push(Ie-Ee<=5&&Pe?1:0)}y.push(M)}return y}(this.dem),l=a.length-1,d=a[l];this._addNode(d.minimums[0],d.maximums[0],d.leaves[0]),this._construct(a,0,0,l,0)}raycastRoot(i,a,l,d,p,g,y=1){return Zb([i,a,-100],[l,d,this.maximums[0]*y],p,g)}raycast(i,a,l,d,p,g,y=1){if(!this.nodeCount)return null;const x=this.raycastRoot(i,a,l,d,p,g,y);if(null==x)return null;const C=[],D=[],M=[],k=[],P=[{idx:0,t:x,nodex:0,nodey:0,depth:0}];for(;P.length>0;){const{idx:F,t:B,nodex:j,nodey:q,depth:te}=P.pop();if(this.leaves[F]){Xd(j,q,te,i,a,l,d,M,k);const se=1<<te,de=(j+0)/se,pe=(j+1)/se,Ee=(q+0)/se,Ie=(q+1)/se,Pe=tr(de,Ee,this.dem)*y,Ze=tr(pe,Ee,this.dem)*y,je=tr(pe,Ie,this.dem)*y,dt=tr(de,Ie,this.dem)*y,Pt=PT(M[0],M[1],Pe,k[0],M[1],Ze,k[0],k[1],je,p,g),st=PT(k[0],k[1],je,M[0],k[1],dt,M[0],M[1],Pe,p,g),Tt=Math.min(null!==Pt?Pt:Number.MAX_VALUE,null!==st?st:Number.MAX_VALUE);if(Tt!==Number.MAX_VALUE)return Tt;{const et=h.v.scaleAndAdd([],p,g,B);if(mf(Pe,Ze,dt,je,Tw(et[0],M[0],k[0]),Tw(et[1],M[1],k[1]))>=et[2])return B}continue}let ie=0;for(let se=0;se<this._siblingOffset.length;se++){Xd((j<<1)+this._siblingOffset[se][0],(q<<1)+this._siblingOffset[se][1],te+1,i,a,l,d,M,k),M[2]=-100,k[2]=this.maximums[this.childOffsets[F]+se]*y;const de=Zb(M,k,p,g);if(null!=de){const pe=de;C[se]=pe;let Ee=!1;for(let Ie=0;Ie<ie&&!Ee;Ie++)pe>=C[D[Ie]]&&(D.splice(Ie,0,se),Ee=!0);Ee||(D[ie]=se),ie++}}for(let se=0;se<ie;se++){const de=D[se];P.push({idx:this.childOffsets[F]+de,t:C[de],nodex:(j<<1)+this._siblingOffset[de][0],nodey:(q<<1)+this._siblingOffset[de][1],depth:te+1})}}return null}_addNode(i,a,l){return this.minimums.push(i),this.maximums.push(a),this.leaves.push(l),this.childOffsets.push(0),this.nodeCount++}_construct(i,a,l,d,p){if(1===i[d].isLeaf(a,l))return;this.childOffsets[p]||(this.childOffsets[p]=this.nodeCount);const g=d-1,y=i[g];let x=0,C=0;for(let D=0;D<this._siblingOffset.length;D++){const M=2*a+this._siblingOffset[D][0],k=2*l+this._siblingOffset[D][1],P=y.getElevation(M,k),F=y.isLeaf(M,k),B=this._addNode(P.min,P.max,F);F&&(x|=1<<D),C||(C=B)}for(let D=0;D<this._siblingOffset.length;D++)x&1<<D||this._construct(i,2*a+this._siblingOffset[D][0],2*l+this._siblingOffset[D][1],g,C+D)}}function mf(o,i,a,l,d,p){return oi(oi(o,a,p),oi(i,l,p),d)}function tr(o,i,a){const l=a.dim,d=Hn(o*l-.5,0,l-1),p=Hn(i*l-.5,0,l-1),g=Math.floor(d),y=Math.floor(p),x=Math.min(g+1,l-1),C=Math.min(y+1,l-1);return mf(a.get(g,y),a.get(x,y),a.get(g,C),a.get(x,C),d-g,p-y)}const OT={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Rg(o,i,a){return(256*o*256+256*i+a)/10-1e4}function $u(o,i,a){return 256*o+i+a/256-32768}class Cy{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(i,a,l,d=!1){if(this.uid=i,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(l&&"mapbox"!==l&&"terrarium"!==l)return ar(`"${l}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=a.height;const p=this.dim=a.height-2,g=new Uint32Array(a.data.buffer);if(this.pixels=new Uint8Array(a.data.buffer),this.floatView=new Float32Array(a.data.buffer),this.borderReady=d,this._modifiedForSources={},!d){for(let x=0;x<p;x++)g[this._idx(-1,x)]=g[this._idx(0,x)],g[this._idx(p,x)]=g[this._idx(p-1,x)],g[this._idx(x,-1)]=g[this._idx(x,0)],g[this._idx(x,p)]=g[this._idx(x,p-1)];g[this._idx(-1,-1)]=g[this._idx(0,0)],g[this._idx(p,-1)]=g[this._idx(p-1,0)],g[this._idx(-1,p)]=g[this._idx(0,p-1)],g[this._idx(p,p)]=g[this._idx(p-1,p-1)]}const y="terrarium"===l?$u:Rg;for(let x=0;x<g.length;++x){const C=4*x;this.floatView[x]=y(this.pixels[C],this.pixels[C+1],this.pixels[C+2])}this._timestamp=uo.now()}_buildQuadTree(){this._tree=new Sw(this)}get(i,a,l=!1){l&&(i=Hn(i,-1,this.dim),a=Hn(a,-1,this.dim));const d=this._idx(i,a);return this.floatView[d]}set(i,a,l){const d=this._idx(i,a),p=this.floatView[d];return this.floatView[d]=l,l-p}static getUnpackVector(i){return OT[i]}_idx(i,a){if(i<-1||i>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(i+1)}static pack(i,a){const l=[0,0,0,0],d=Cy.getUnpackVector(a);let p=Math.floor((i+d[3])/d[2]);return l[2]=p%256,p=Math.floor(p/256),l[1]=p%256,p=Math.floor(p/256),l[0]=p,l}getPixels(){return new ka({width:this.stride,height:this.stride},this.pixels)}backfillBorder(i,a,l){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let d=a*this.dim,p=a*this.dim+this.dim,g=l*this.dim,y=l*this.dim+this.dim;switch(a){case-1:d=p-1;break;case 1:p=d+1}switch(l){case-1:g=y-1;break;case 1:y=g+1}const x=-a*this.dim,C=-l*this.dim;for(let D=g;D<y;D++)for(let M=d;M<p;M++){const k=4*this._idx(M,D),P=4*this._idx(M+x,D+C);this.pixels[k+0]=i.pixels[P+0],this.pixels[k+1]=i.pixels[P+1],this.pixels[k+2]=i.pixels[P+2],this.pixels[k+3]=i.pixels[P+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}rn(Cy,"DEMData"),rn(Sw,"DemMinMaxQuadTree",{omit:["dem"]});class Fp{constructor(i,a,l){this._demTile=i,this._dem=this._demTile.dem,this._scale=a,this._offset=l}static create(i,a,l){const d=l||i.findDEMTileFor(a);if(!d||!d.dem)return;const p=d.dem,g=d.tileID,y=1<<a.canonical.z-g.canonical.z;return new Fp(d,p.dim/Ht/y,[(a.canonical.x/y-g.canonical.x)*p.dim,(a.canonical.y/y-g.canonical.y)*p.dim])}tileCoordToPixel(i,a){const l=a*this._scale+this._offset[1],d=Math.floor(i*this._scale+this._offset[0]),p=Math.floor(l);return new Le(d,p)}getElevationAt(i,a,l,d){const p=i*this._scale+this._offset[0],g=a*this._scale+this._offset[1],y=Math.floor(p),x=Math.floor(g),C=this._dem;return d=!!d,l?oi(oi(C.get(y,x,d),C.get(y,x+1,d),g-x),oi(C.get(y+1,x,d),C.get(y+1,x+1,d),g-x),p-y):C.get(y,x,d)}getElevationAtPixel(i,a,l){return this._dem.get(i,a,!!l)}getMeterToDEM(i){return(1<<this._demTile.tileID.canonical.z)*zo(1,i)*this._dem.stride}}class Gu{constructor(i,a){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new Lu(Ht,16,0),this.featureIndexArray=new w1,this.promoteId=a}insert(i,a,l,d,p,g=0){const y=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,d,p,g);const x=this.grid;for(let C=0;C<a.length;C++){const D=a[C],M=[1/0,1/0,-1/0,-1/0];for(let k=0;k<D.length;k++){const P=D[k];M[0]=Math.min(M[0],P.x),M[1]=Math.min(M[1],P.y),M[2]=Math.max(M[2],P.x),M[3]=Math.max(M[3],P.y)}M[0]<Ht&&M[1]<Ht&&M[2]>=0&&M[3]>=0&&x.insert(y,M[0],M[1],M[2],M[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Yd(new Op(this.rawTileData)).layers,this.sourceLayerCoder=new Mp(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const i in this.vtLayers)this.vtFeatures[i]=[]}return this.vtLayers}query(i,a,l,d){this.loadVTLayers();const p=i.params||{},g=Qa(p.filter),y=i.tileResult,x=i.transform,C=y.bufferedTilespaceBounds,D=this.grid.query(C.min.x,C.min.y,C.max.x,C.max.y,(F,B,j,q)=>bg(y.bufferedTilespaceGeometry,F,B,j,q));D.sort(Yb);let M=null;x.elevation&&D.length>0&&(M=Fp.create(x.elevation,this.tileID));const k={};let P;for(let F=0;F<D.length;F++){const B=D[F];if(B===P)continue;P=B;const j=this.featureIndexArray.get(B);let q=null;this.loadMatchingFeature(k,j,g,p.layers,p.availableImages,a,l,d,(te,ie,se,de=0)=>(q||(q=eu(te,this.tileID.canonical,i.tileTransform)),ie.queryIntersectsFeature(y,te,se,q,this.z,i.transform,i.pixelPosMatrix,M,de)))}return k}loadMatchingFeature(i,a,l,d,p,g,y,x,C){const{featureIndex:D,bucketIndex:M,sourceLayerIndex:k,layoutVertexArrayOffset:P}=a,F=this.bucketLayerIDs[M];if(d&&!function(te,ie){for(let se=0;se<te.length;se++)if(ie.indexOf(te[se])>=0)return!0;return!1}(d,F))return;const B=this.sourceLayerCoder.decode(k),j=this.vtLayers[B].feature(D);if(l.needGeometry){const te=Gd(j,!0);if(!l.filter(new Ce(this.tileID.overscaledZ),te,this.tileID.canonical))return}else if(!l.filter(new Ce(this.tileID.overscaledZ),j))return;const q=this.getId(j,B);for(let te=0;te<F.length;te++){const ie=F[te];if(d&&d.indexOf(ie)<0)continue;const se=g[ie];if(!se)continue;let de={};void 0!==q&&x&&(de=x.getState(se.sourceLayer||"_geojsonTileLayer",q));const pe=Gr({},y[ie]);pe.paint=Mw(pe.paint,se.paint,j,de,p),pe.layout=Mw(pe.layout,se.layout,j,de,p);const Ee=!C||C(j,se,de,P);if(!Ee)continue;const Ie=new Cw(j,this.z,this.x,this.y,q);Ie.layer=pe;let Pe=i[ie];void 0===Pe&&(Pe=i[ie]=[]),Pe.push({featureIndex:D,feature:Ie,intersectionZ:Ee})}}lookupSymbolFeatures(i,a,l,d,p,g,y,x){const C={};this.loadVTLayers();const D=Qa(p);for(const M of i)this.loadMatchingFeature(C,{bucketIndex:l,sourceLayerIndex:d,featureIndex:M,layoutVertexArrayOffset:0},D,g,y,x,a);return C}loadFeature(i){const{featureIndex:a,sourceLayerIndex:l}=i;this.loadVTLayers();const d=this.sourceLayerCoder.decode(l),p=this.vtFeatures[d];if(p[a])return p[a];const g=this.vtLayers[d].feature(a);return p[a]=g,g}hasLayer(i){for(const a of this.bucketLayerIDs)for(const l of a)if(i===l)return!0;return!1}getId(i,a){let l=i.id;if(this.promoteId){const d="string"==typeof this.promoteId?this.promoteId:this.promoteId[a];null!=d&&(l=i.properties[d]),"boolean"==typeof l&&(l=Number(l))}return l}}function Mw(o,i,a,l,d){return ii(o,(p,g)=>{const y=i instanceof Ue?i.get(g):null;return y&&y.evaluate?y.evaluate(a,l,d):y})}function Yb(o,i){return i-o}rn(Gu,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const iI=_n([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Xb=_n([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Aw=_n([{name:"a_projected_pos",components:4,type:"Float32"}],4);_n([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const FT=_n([{name:"a_z_offset",components:1,type:"Float32"}],4),LT=_n([{name:"a_texb",components:2,type:"Uint16"}]),Iw=_n([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),NT=_n([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);_n([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Kb=_n([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),BT=_n([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);_n([{name:"triangle",components:3,type:"Uint16"}]),_n([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),_n([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),_n([{type:"Float32",name:"offsetX"}]),_n([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var ss=24;const nu=128;function Ey(o,i){const{expression:a}=i;if("constant"===a.kind)return{kind:"constant",layoutSize:a.evaluate(new Ce(o+1))};if("source"===a.kind)return{kind:"source"};{const{zoomStops:l,interpolationType:d}=a;let p=0;for(;p<l.length&&l[p]<=o;)p++;p=Math.max(0,p-1);let g=p;for(;g<l.length&&l[g]<o+1;)g++;g=Math.min(l.length-1,g);const y=l[p],x=l[g];return"composite"===a.kind?{kind:"composite",minZoom:y,maxZoom:x,interpolationType:d}:{kind:"camera",minZoom:y,maxZoom:x,minSize:a.evaluate(new Ce(y)),maxSize:a.evaluate(new Ce(x)),interpolationType:d}}}function Pg(o,{uSize:i,uSizeT:a},{lowerSize:l,upperSize:d}){return"source"===o.kind?l/nu:"composite"===o.kind?oi(l/nu,d/nu,a):i}function Xr(o,i){let a=0,l=0;if("constant"===o.kind)l=o.layoutSize;else if("source"!==o.kind){const{interpolationType:d,minZoom:p,maxZoom:g}=o,y=d?Hn(Ps.interpolationFactor(d,i,p,g),0,1):0;"camera"===o.kind?l=oi(o.minSize,o.maxSize,y):a=y}return{uSizeT:a,uSize:l}}var kw=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:nu,evaluateSizeForFeature:Pg,evaluateSizeForZoom:Xr,getSizeData:Ey});function rI(o,i,a){return o.sections.forEach(l=>{l.text=function(d,p,g){const y=p.layout.get("text-transform").evaluate(g,{});return"uppercase"===y?d=d.toLocaleUpperCase():"lowercase"===y&&(d=d.toLocaleLowerCase()),Se.applyArabicShaping&&(d=Se.applyArabicShaping(d)),d}(l.text,i,a)}),o}const gf={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function qu(o){return"\ufe36"===o||"\ufe48"===o||"\ufe38"===o||"\ufe44"===o||"\ufe42"===o||"\ufe3e"===o||"\ufe3c"===o||"\ufe3a"===o||"\ufe18"===o||"\ufe40"===o||"\ufe10"===o||"\ufe13"===o||"\ufe14"===o||"\uff40"===o||"\uffe3"===o||"\ufe11"===o||"\ufe12"===o}function Qb(o){return"\ufe35"===o||"\ufe47"===o||"\ufe37"===o||"\ufe43"===o||"\ufe41"===o||"\ufe3d"===o||"\ufe3b"===o||"\ufe39"===o||"\ufe17"===o||"\ufe3f"===o}const Jb=3;function oI(o,i,a){i.glyphs=[],1===o&&a.readMessage(zT,i)}function zT(o,i,a){if(3===o){const{id:l,bitmap:d,width:p,height:g,left:y,top:x,advance:C}=a.readMessage(e0,{});i.glyphs.push({id:l,bitmap:new pc({width:p+2*Jb,height:g+2*Jb},d),metrics:{width:p,height:g,left:y,top:x,advance:C}})}else 4===o?i.ascender=a.readSVarint():5===o&&(i.descender=a.readSVarint())}function e0(o,i,a){1===o?i.id=a.readVarint():2===o?i.bitmap=a.readBytes():3===o?i.width=a.readVarint():4===o?i.height=a.readVarint():5===o?i.left=a.readSVarint():6===o?i.top=a.readSVarint():7===o&&(i.advance=a.readVarint())}const Wn=Jb,Ra={horizontal:1,vertical:2,horizontalOnly:3},Rw=-17;class Dy{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,a){const l=new Dy;return l.scale=i||1,l.fontStack=a,l}static forImage(i){const a=new Dy;return a.imageName=i,a}}class si{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,a){const l=new si;for(let d=0;d<i.sections.length;d++){const p=i.sections[d];p.image?l.addImageSection(p):l.addTextSection(p,a)}return l}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSections(){return this.sections}getSectionIndex(i){return this.sectionIndex[i]}getCodePoint(i){return this.text.codePointAt(i)}verticalizePunctuation(i){this.text=function(a,l){let d="";for(let p=0;p<a.length;p++){const g=a.charCodeAt(p+1)||null,y=a.charCodeAt(p-1)||null;d+=!l&&(g&&N(g)&&!gf[a[p+1]]||y&&N(y)&&!gf[a[p-1]])||!gf[a[p]]?a[p]:gf[a[p]]}return d}(this.text,i)}trim(){let i=0;for(let l=0;l<this.text.length&&Lp[this.text.charCodeAt(l)];l++)i++;let a=this.text.length;for(let l=this.text.length-1;l>=0&&l>=i&&Lp[this.text.charCodeAt(l)];l--)a--;this.text=this.text.substring(i,a),this.sectionIndex=this.sectionIndex.slice(i,a)}substring(i,a){const l=new si;return l.text=this.text.substring(i,a),l.sectionIndex=this.sectionIndex.slice(i,a),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,a)=>Math.max(i,this.sections[a].scale),0)}addTextSection(i,a){this.text+=i.text,this.sections.push(Dy.forText(i.scale,i.fontStack||a));const l=this.sections.length-1;for(let d=0;d<i.text.length;++d)this.sectionIndex.push(l)}addImageSection(i){const a=i.image?i.image.namePrimary:"";if(0===a.length)return void ar("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCodePoint(l),this.sections.push(Dy.forImage(a)),this.sectionIndex.push(this.sections.length-1)):ar("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function t0(o,i,a,l,d,p,g,y,x,C,D,M,k,P,F){const B=si.fromFeature(o,d);M===Ra.vertical&&B.verticalizePunctuation(k);let j=[];const q=function(pe,Ee,Ie,Pe,Ze,je){if(!pe)return[];const dt=[],Pt=function($t,on,It,On,ln,Gt){let An=0;for(let dn=0;dn<$t.length();dn++){const Tn=$t.getSection(dn);An+=Pw($t.getCodePoint(dn),Tn,On,ln,on,Gt)}return An/Math.max(1,Math.ceil(An/It))}(pe,Ee,Ie,Pe,Ze,je),st=pe.text.indexOf("\u200b")>=0;let Tt=0;for(let $t=0;$t<pe.length();$t++){const on=pe.getSection($t),It=pe.getCodePoint($t);if(Lp[It]||(Tt+=Pw(It,on,Pe,Ze,Ee,je)),$t<pe.length()-1){const On=!((et=It)<11904||!(w["Bopomofo Extended"](et)||w.Bopomofo(et)||w["CJK Compatibility Forms"](et)||w["CJK Compatibility Ideographs"](et)||w["CJK Compatibility"](et)||w["CJK Radicals Supplement"](et)||w["CJK Strokes"](et)||w["CJK Symbols and Punctuation"](et)||w["CJK Unified Ideographs Extension A"](et)||w["CJK Unified Ideographs"](et)||w["Enclosed CJK Letters and Months"](et)||w["Halfwidth and Fullwidth Forms"](et)||w.Hiragana(et)||w["Ideographic Description Characters"](et)||w["Kangxi Radicals"](et)||w["Katakana Phonetic Extensions"](et)||w.Katakana(et)||w["Vertical Forms"](et)||w["Yi Radicals"](et)||w["Yi Syllables"](et)));(VT[It]||On||on.imageName)&&dt.push(n0($t+1,Tt,Pt,dt,Ow(It,pe.getCodePoint($t+1),On&&st),!1))}}var et;return Fw(n0(pe.length(),Tt,Pt,dt,0,!0))}(B,C,p,i,l,P),{processBidirectionalText:te,processStyledBidirectionalText:ie}=Se;if(te&&1===B.sections.length){const pe=te(B.toString(),q);for(const Ee of pe){const Ie=new si;Ie.text=Ee,Ie.sections=B.sections;for(let Pe=0;Pe<Ee.length;Pe++)Ie.sectionIndex.push(0);j.push(Ie)}}else if(ie){const pe=ie(B.text,B.sectionIndex,q);for(const Ee of pe){const Ie=new si;Ie.text=Ee[0],Ie.sectionIndex=Ee[1],Ie.sections=B.sections,j.push(Ie)}}else j=function(pe,Ee){const Ie=[],Pe=pe.text;let Ze=0;for(const je of Ee)Ie.push(pe.substring(Ze,je)),Ze=je;return Ze<Pe.length&&Ie.push(pe.substring(Ze,Pe.length)),Ie}(B,q);const se=[],de={positionedLines:se,text:B.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:M,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(pe,Ee,Ie,Pe,Ze,je,dt,Pt,st,Tt,et,$t){let on=0,It=0,On=0;const ln="right"===Pt?1:"left"===Pt?0:.5;let Gt=!1;for(const vi of Ze){const Jn=vi.getSections();for(const gi of Jn){if(gi.imageName)continue;const hn=Ee[gi.fontStack];if(hn&&(Gt=void 0!==hn.ascender&&void 0!==hn.descender,!Gt))break}if(!Gt)break}let An=0;for(const vi of Ze){vi.trim();const Jn=vi.getMaxScale(),gi=(Jn-1)*ss,hn={positionedGlyphs:[],lineOffset:0};pe.positionedLines[An]=hn;const Xn=hn.positionedGlyphs;let Kn=0;if(!vi.length()){It+=je,++An;continue}let vr=0,cr=0;for(let nr=0;nr<vi.length();nr++){const Vi=vi.getSection(nr),Lr=vi.getSectionIndex(nr),br=vi.getCodePoint(nr);let ao=Vi.scale,Vo=null,Vs=null,mo=null,Kr=ss,Ts=0;const Ss=!(st===Ra.horizontal||!et&&!O(br)||et&&(Lp[br]||(dn=br,w.Arabic(dn)||w["Arabic Supplement"](dn)||w["Arabic Extended-A"](dn)||w["Arabic Presentation Forms-A"](dn)||w["Arabic Presentation Forms-B"](dn))));if(Vi.imageName){const js=Pe[Vi.imageName];if(!js)continue;mo=Vi.imageName,pe.iconsInText=pe.iconsInText||!0,Vs=js.paddedRect;const Mr=js.displaySize;ao=ao*ss/$t,Vo={width:Mr[0],height:Mr[1],left:0,top:-Wn,advance:Ss?Mr[1]:Mr[0],localGlyph:!1},Ts=Gt?-Vo.height*ao:Rw+Jn*ss-Mr[1]*ao,Kr=Vo.advance;const xc=(Ss?Mr[0]:Mr[1])*ao-ss*Jn;xc>0&&xc>Kn&&(Kn=xc)}else{const js=Ie[Vi.fontStack];if(!js)continue;js[br]&&(Vs=js[br]);const Mr=Ee[Vi.fontStack];if(!Mr)continue;const xc=Mr.glyphs[br];if(!xc)continue;if(Vo=xc.metrics,Kr=8203!==br?ss:0,Gt){const tm=void 0!==Mr.ascender?Math.abs(Mr.ascender):0,Ju=void 0!==Mr.descender?Math.abs(Mr.descender):0,ed=(tm+Ju)*ao;vr<ed&&(vr=ed,cr=(tm-Ju)/2*ao),Ts=-tm*ao}else Ts=Rw+(Jn-ao)*ss}Ss?(pe.verticalizable=!0,Xn.push({glyph:br,imageName:mo,x:on,y:It+Ts,vertical:Ss,scale:ao,localGlyph:Vo.localGlyph,fontStack:Vi.fontStack,sectionIndex:Lr,metrics:Vo,rect:Vs}),on+=Kr*ao+Tt):(Xn.push({glyph:br,imageName:mo,x:on,y:It+Ts,vertical:Ss,scale:ao,localGlyph:Vo.localGlyph,fontStack:Vi.fontStack,sectionIndex:Lr,metrics:Vo,rect:Vs}),on+=Vo.advance*ao+Tt)}0!==Xn.length&&(On=Math.max(on-Tt,On),Gt?r0(Xn,ln,Kn,cr,je*Jn/2):r0(Xn,ln,Kn,0,je/2)),on=0;const Wi=je*Jn+Kn;hn.lineOffset=Math.max(Kn,gi),It+=Wi,++An}var dn;const Tn=It,{horizontalAlign:Bt,verticalAlign:Te}=Sy(dt);(function(vi,Jn,gi,hn,Xn,Kn){const vr=(Jn-gi)*Xn,cr=-Kn*hn;for(const Wi of vi)for(const nr of Wi.positionedGlyphs)nr.x+=vr,nr.y+=cr})(pe.positionedLines,ln,Bt,Te,On,Tn),pe.top+=-Te*Tn,pe.bottom=pe.top+Tn,pe.left+=-Bt*On,pe.right=pe.left+On,pe.hasBaseline=Gt}(de,i,a,l,j,g,y,x,M,C,k,F),!function(pe){for(const Ee of pe)if(0!==Ee.positionedGlyphs.length)return!1;return!0}(se)&&de}const Lp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},VT={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Pw(o,i,a,l,d,p){if(i.imageName){const g=l[i.imageName];return g?g.displaySize[0]*i.scale*ss/p+d:0}{const g=a[i.fontStack],y=g&&g.glyphs[o];return y?y.metrics.advance*i.scale+d:0}}function Ty(o,i,a,l){const d=Math.pow(o-i,2);return l?o<i?d/2:2*d:d+Math.abs(a)*a}function Ow(o,i,a){let l=0;return 10===o&&(l-=1e4),a&&(l+=150),40!==o&&65288!==o||(l+=50),41!==i&&65289!==i||(l+=50),l}function n0(o,i,a,l,d,p){let g=null,y=Ty(i,a,d,p);for(const x of l){const C=Ty(i-x.x,a,d,p)+x.badness;C<=y&&(g=x,y=C)}return{index:o,x:i,priorBreak:g,badness:y}}function Fw(o){return o?Fw(o.priorBreak).concat(o.index):[]}function Sy(o){let i=.5,a=.5;switch(o){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:i,verticalAlign:a}}function r0(o,i,a,l,d){if(!(i||a||l||d))return;const p=o.length-1,g=o[p],y=(g.x+g.metrics.advance*g.scale)*i;for(let x=0;x<=p;x++)o[x].x-=y,o[x].y+=a+l+d}function jT(o,i,a,l){const{horizontalAlign:d,verticalAlign:p}=Sy(l),g=a[0]-o.displaySize[0]*d,y=a[1]-o.displaySize[1]*p;return{imagePrimary:o,imageSecondary:i,top:y,bottom:y+o.displaySize[1],left:g,right:g+o.displaySize[0]}}function Lw(o,i,a,l,d,p){const g=o.imagePrimary;let y;if(g.content){const j=g.content,q=g.pixelRatio||1;y=[j[0]/q,j[1]/q,g.displaySize[0]-j[2]/q,g.displaySize[1]-j[3]/q]}const x=i.left*p,C=i.right*p;let D,M,k,P;"width"===a||"both"===a?(P=d[0]+x-l[3],M=d[0]+C+l[1]):(P=d[0]+(x+C-g.displaySize[0])/2,M=P+g.displaySize[0]);const F=i.top*p,B=i.bottom*p;return"height"===a||"both"===a?(D=d[1]+F-l[0],k=d[1]+B+l[2]):(D=d[1]+(F+B-g.displaySize[1])/2,k=D+g.displaySize[1]),{imagePrimary:g,imageSecondary:void 0,top:D,right:M,bottom:k,left:P,collisionPadding:y}}class Wu extends Le{constructor(i,a,l,d,p){super(i,a),this.angle=d,this.z=l,void 0!==p&&(this.segment=p)}clone(){return new Wu(this.x,this.y,this.z,this.angle,this.segment)}}function o0(o,i,a,l,d){if(void 0===i.segment)return!0;let p=i,g=i.segment+1,y=0;for(;y>-a/2;){if(g--,g<0)return!1;y-=o[g].dist(p),p=o[g]}y+=o[g].dist(o[g+1]),g++;const x=[];let C=0;for(;y<a/2;){const D=o[g],M=o[g+1];if(!M)return!1;let k=o[g-1].angleTo(D)-D.angleTo(M);for(k=Math.abs((k+3*Math.PI)%(2*Math.PI)-Math.PI),x.push({distance:y,angleDelta:k}),C+=k;y-x[0].distance>l;)C-=x.shift().angleDelta;if(C>d)return!1;g++,y+=D.dist(M)}return!0}function _f(o){let i=0;for(let a=0;a<o.length-1;a++)i+=o[a].dist(o[a+1]);return i}function iu(o,i,a){return o?.6*i*a:0}function yf(o,i){return Math.max(o?o.right-o.left:0,i?i.right-i.left:0)}function UT(o,i,a,l,d,p){const g=iu(a,d,p),y=yf(a,l)*p;let x=0;const C=_f(o)/2;for(let D=0;D<o.length-1;D++){const M=o[D],k=o[D+1],P=M.dist(k);if(x+P>C){const F=(C-x)/P,B=oi(M.x,k.x,F),j=oi(M.y,k.y,F),q=new Wu(B,j,0,k.angleTo(M),D);return!g||o0(o,q,y,g,i)?q:void 0}x+=P}}function HT(o,i,a,l,d,p,g,y,x){const C=iu(l,p,g),D=yf(l,d),M=D*g,k=0===o[0].x||o[0].x===x||0===o[0].y||o[0].y===x;return i-M<i/4&&(i=M+i/4),s0(o,k?i/2*y%i:(D/2+2*p)*g*y%i,i,C,a,M,k,!1,x)}function s0(o,i,a,l,d,p,g,y,x){const C=p/2,D=_f(o);let M=0,k=i-a,P=[];for(let F=0;F<o.length-1;F++){const B=o[F],j=o[F+1],q=B.dist(j),te=j.angleTo(B);for(;k+a<M+q;){k+=a;const ie=(k-M)/q,se=oi(B.x,j.x,ie),de=oi(B.y,j.y,ie);if(se>=0&&se<x&&de>=0&&de<x&&k-C>=0&&k+C<=D){const pe=new Wu(se,de,0,te,F);l&&!o0(o,pe,p,l,d)||P.push(pe)}}M+=q}return y||P.length||g||(P=s0(o,M/2,a,l,d,p,g,!0,x)),P}function a0(o,i,a,l,d){const p=[];for(let g=0;g<o.length;g++){const y=o[g];let x;for(let C=0;C<y.length-1;C++){let D=y[C],M=y[C+1];D.x<i&&M.x<i||(D.x<i?D=new Le(i,D.y+(i-D.x)/(M.x-D.x)*(M.y-D.y))._round():M.x<i&&(M=new Le(i,D.y+(i-D.x)/(M.x-D.x)*(M.y-D.y))._round()),D.y<a&&M.y<a||(D.y<a?D=new Le(D.x+(a-D.y)/(M.y-D.y)*(M.x-D.x),a)._round():M.y<a&&(M=new Le(D.x+(a-D.y)/(M.y-D.y)*(M.x-D.x),a)._round()),D.x>=l&&M.x>=l||(D.x>=l?D=new Le(l,D.y+(l-D.x)/(M.x-D.x)*(M.y-D.y))._round():M.x>=l&&(M=new Le(l,D.y+(l-D.x)/(M.x-D.x)*(M.y-D.y))._round()),D.y>=d&&M.y>=d||(D.y>=d?D=new Le(D.x+(d-D.y)/(M.y-D.y)*(M.x-D.x),d)._round():M.y>=d&&(M=new Le(D.x+(d-D.y)/(M.y-D.y)*(M.x-D.x),d)._round()),x&&D.equals(x[x.length-1])||(x=[D],p.push(x)),x.push(M)))))}}return p}function Og(o){let i=0,a=0;for(const g of o)i+=g.w*g.h,a=Math.max(a,g.w);o.sort((g,y)=>y.h-g.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),a),h:1/0}];let d=0,p=0;for(const g of o)for(let y=l.length-1;y>=0;y--){const x=l[y];if(!(g.w>x.w||g.h>x.h)){if(g.x=x.x,g.y=x.y,p=Math.max(p,g.y+g.h),d=Math.max(d,g.x+g.w),g.w===x.w&&g.h===x.h){const C=l.pop();y<l.length&&(l[y]=C)}else g.h===x.h?(x.x+=g.w,x.w-=g.w):g.w===x.w?(x.y+=g.h,x.h-=g.h):(l.push({x:x.x+g.w,y:x.y,w:x.w-g.w,h:g.h}),x.y+=g.h,x.h-=g.h);break}}return{w:d,h:p,fill:i/(d*p)||0}}rn(Wu,"Anchor");const fs=1;class Np{constructor(i,{pixelRatio:a,version:l,stretchX:d,stretchY:p,content:g}){this.paddedRect=i,this.pixelRatio=a,this.stretchX=d,this.stretchY=p,this.content=g,this.version=l}get tl(){return[this.paddedRect.x+fs,this.paddedRect.y+fs]}get br(){return[this.paddedRect.x+this.paddedRect.w-fs,this.paddedRect.y+this.paddedRect.h-fs]}get displaySize(){return[(this.paddedRect.w-2*fs)/this.pixelRatio,(this.paddedRect.h-2*fs)/this.pixelRatio]}}class l0{constructor(i,a){const l={},d={};this.haveRenderCallbacks=[];const p=[];this.addImages(i,l,p),this.addImages(a,d,p);const{w:g,h:y}=Og(p),x=new il({width:g||1,height:y||1});for(const C in i){const D=i[C],M=l[C].paddedRect;il.copy(D.data,x,{x:0,y:0},{x:M.x+fs,y:M.y+fs},D.data,D.sdf)}for(const C in a){const D=a[C],M=d[C].paddedRect,k=M.x+fs,P=M.y+fs,F=D.data.width,B=D.data.height;il.copy(D.data,x,{x:0,y:0},{x:k,y:P},D.data),il.copy(D.data,x,{x:0,y:B-1},{x:k,y:P-1},{width:F,height:1}),il.copy(D.data,x,{x:0,y:0},{x:k,y:P+B},{width:F,height:1}),il.copy(D.data,x,{x:F-1,y:0},{x:k-1,y:P},{width:1,height:B}),il.copy(D.data,x,{x:0,y:0},{x:k+F,y:P},{width:1,height:B})}this.image=x,this.iconPositions=l,this.patternPositions=d}addImages(i,a,l){for(const d in i){const p=i[d],g={x:0,y:0,w:p.data.width+2*fs,h:p.data.height+2*fs};l.push(g),a[d]=new Np(g,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(i,a,l){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(d=>i.hasImage(d,l)),i.dispatchRenderCallbacks(this.haveRenderCallbacks,l);for(const d in i.getUpdatedImages(l))this.patchUpdatedImage(this.iconPositions[d],i.getImage(d,l),a),this.patchUpdatedImage(this.patternPositions[d],i.getImage(d,l),a)}patchUpdatedImage(i,a,l){if(!i||!a||i.version===a.version)return;i.version=a.version;const[d,p]=i.tl,g=!!Object.keys(this.patternPositions).length;l.update(a.data,{useMipmap:g},{x:d,y:p})}}rn(Np,"ImagePosition"),rn(l0,"ImageAtlas");const Bp=1e20;function Nw(o,i,a,l,d,p,g,y,x){for(let C=i;C<i+l;C++)Bw(o,a*p+C,p,d,g,y,x);for(let C=a;C<a+d;C++)Bw(o,C*p+i,1,l,g,y,x)}function Bw(o,i,a,l,d,p,g){p[0]=0,g[0]=-Bp,g[1]=Bp,d[0]=o[i];for(let y=1,x=0,C=0;y<l;y++){d[y]=o[i+y*a];const D=y*y;do{const M=p[x];C=(d[y]-d[M]+D-M*M)/(y-M)/2}while(C<=g[x]&&--x>-1);x++,p[x]=y,g[x]=C,g[x+1]=Bp}for(let y=0,x=0;y<l;y++){for(;g[x+1]<y;)x++;const C=p[x],D=y-C;o[i+y*a]=d[C]+D*D}}const gc=2,c0={none:0,ideographs:1,all:2};class vf{constructor(i,a,l){this.requestManager=i,this.localGlyphMode=a,this.localFontFamily=l,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(i,a){this.urls[a]=i}getGlyphs(i,a,l){const d=[],p=this.urls[a]||Oe.GLYPHS_URL;for(const g in i)for(const y of i[g])d.push({stack:g,id:y});Ho(d,({stack:g,id:y},x)=>{let C=this.entries[g];C||(C=this.entries[g]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let D=C.glyphs[y];if(void 0!==D)return void x(null,{stack:g,id:y,glyph:D});if(D=this._tinySDF(C,g,y),D)return C.glyphs[y]=D,void x(null,{stack:g,id:y,glyph:D});const M=Math.floor(y/256);if(256*M>65535)return void x(new Error("glyphs > 65535 not supported"));if(C.ranges[M])return void x(null,{stack:g,id:y,glyph:D});let k=C.requests[M];k||(k=C.requests[M]=[],vf.loadGlyphRange(g,M,p,this.requestManager,(P,F)=>{if(F){C.ascender=F.ascender,C.descender=F.descender;for(const B in F.glyphs)this._doesCharSupportLocalGlyph(+B)||(C.glyphs[+B]=F.glyphs[+B]);C.ranges[M]=!0}for(const B of k)B(P,F);delete C.requests[M]})),k.push((P,F)=>{P?x(P):F&&x(null,{stack:g,id:y,glyph:F.glyphs[y]||null})})},(g,y)=>{if(g)l(g);else if(y){const x={};for(const{stack:C,id:D,glyph:M}of y)void 0===x[C]&&(x[C]={}),void 0===x[C].glyphs&&(x[C].glyphs={}),x[C].glyphs[D]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics},x[C].ascender=this.entries[C].ascender,x[C].descender=this.entries[C].descender;l(null,x)}})}_doesCharSupportLocalGlyph(i){return this.localGlyphMode!==c0.none&&(this.localGlyphMode===c0.all?!!this.localFontFamily:!!this.localFontFamily&&(w["CJK Unified Ideographs"](i)||w["Hangul Syllables"](i)||w.Hiragana(i)||w.Katakana(i)||w["CJK Symbols and Punctuation"](i)||w["CJK Unified Ideographs Extension A"](i)||w["CJK Unified Ideographs Extension B"](i)))}_tinySDF(i,a,l){const d=this.localFontFamily;if(!d||!this._doesCharSupportLocalGlyph(l))return;let p=i.tinySDF;if(!p){let B="400";/bold/i.test(a)?B="900":/medium/i.test(a)?B="500":/light/i.test(a)&&(B="200"),p=i.tinySDF=new vf.TinySDF({fontFamily:d,fontWeight:B,fontSize:24*gc,buffer:3*gc,radius:8*gc}),p.fontWeight=B}if(this.localGlyphs[p.fontWeight][l])return this.localGlyphs[p.fontWeight][l];const g=String.fromCodePoint(l),{data:y,width:x,height:C,glyphWidth:D,glyphHeight:M,glyphLeft:k,glyphTop:P,glyphAdvance:F}=p.draw(g);return this.localGlyphs[p.fontWeight][l]={id:l,bitmap:new pc({width:x,height:C},y),metrics:{width:D/gc,height:M/gc,left:k/gc,top:P/gc-27,advance:F/gc,localGlyph:!0}}}}vf.loadGlyphRange=function(o,i,a,l,d){const p=256*i,g=p+255,y=l.transformRequest(l.normalizeGlyphsURL(a).replace("{fontstack}",o).replace("{range}",`${p}-${g}`),qr.Glyphs);Mo(y,(x,C)=>{if(x)d(x);else if(C){const D={},M=new Op(C).readFields(oI,{});for(const k of M.glyphs)D[k.id]=k;d(null,{glyphs:D,ascender:M.ascender,descender:M.descender})}})},vf.TinySDF=class{constructor({fontSize:o=24,buffer:i=3,radius:a=8,cutoff:l=.25,fontFamily:d="sans-serif",fontWeight:p="normal",fontStyle:g="normal"}={}){this.buffer=i,this.cutoff=l,this.radius=a;const y=this.size=o+4*i,x=this._createCanvas(y),C=this.ctx=x.getContext("2d",{willReadFrequently:!0});C.font=`${g} ${p} ${o}px ${d}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(y*y),this.gridInner=new Float64Array(y*y),this.f=new Float64Array(y),this.z=new Float64Array(y+1),this.v=new Uint16Array(y)}_createCanvas(o){const i=document.createElement("canvas");return i.width=i.height=o,i}draw(o){const{width:i,actualBoundingBoxAscent:a,actualBoundingBoxDescent:l,actualBoundingBoxLeft:d,actualBoundingBoxRight:p}=this.ctx.measureText(o),g=Math.ceil(a),y=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-d))),x=Math.min(this.size-this.buffer,g+Math.ceil(l)),C=y+2*this.buffer,D=x+2*this.buffer,M=Math.max(C*D,0),k=new Uint8ClampedArray(M),P={data:k,width:C,height:D,glyphWidth:y,glyphHeight:x,glyphTop:g,glyphLeft:0,glyphAdvance:i};if(0===y||0===x)return P;const{ctx:F,buffer:B,gridInner:j,gridOuter:q}=this;F.clearRect(B,B,y,x),F.fillText(o,B,B+g);const te=F.getImageData(B,B,y,x);q.fill(Bp,0,M),j.fill(0,0,M);for(let ie=0;ie<x;ie++)for(let se=0;se<y;se++){const de=te.data[4*(ie*y+se)+3]/255;if(0===de)continue;const pe=(ie+B)*C+se+B;if(1===de)q[pe]=0,j[pe]=Bp;else{const Ee=.5-de;q[pe]=Ee>0?Ee*Ee:0,j[pe]=Ee<0?Ee*Ee:0}}Nw(q,0,0,C,D,C,this.f,this.v,this.z),Nw(j,B,B,y,x,C,this.f,this.v,this.z);for(let ie=0;ie<M;ie++){const se=Math.sqrt(q[ie])-Math.sqrt(j[ie]);k[ie]=Math.round(255-255*(se/this.radius+this.cutoff))}return P}};const bf=fs;function zw(o,i,a,l){const d=[],p=o.imagePrimary,g=p.pixelRatio,y=p.paddedRect.w-2*bf,x=p.paddedRect.h-2*bf,C=o.right-o.left,D=o.bottom-o.top,M=p.stretchX||[[0,y]],k=p.stretchY||[[0,x]],P=(je,dt)=>je+dt[1]-dt[0],F=M.reduce(P,0),B=k.reduce(P,0),j=y-F,q=x-B;let te=0,ie=F,se=0,de=B,pe=0,Ee=j,Ie=0,Pe=q;if(p.content&&l){const je=p.content;te=u0(M,0,je[0]),se=u0(k,0,je[1]),ie=u0(M,je[0],je[2]),de=u0(k,je[1],je[3]),pe=je[0]-te,Ie=je[1]-se,Ee=je[2]-je[0]-ie,Pe=je[3]-je[1]-de}const Ze=(je,dt,Pt,st)=>{const Tt=Fg(je.stretch-te,ie,C,o.left),et=Lg(je.fixed-pe,Ee,je.stretch,F),$t=Fg(dt.stretch-se,de,D,o.top),on=Lg(dt.fixed-Ie,Pe,dt.stretch,B),It=Fg(Pt.stretch-te,ie,C,o.left),On=Lg(Pt.fixed-pe,Ee,Pt.stretch,F),ln=Fg(st.stretch-se,de,D,o.top),Gt=Lg(st.fixed-Ie,Pe,st.stretch,B),An=new Le(Tt,$t),dn=new Le(It,$t),Tn=new Le(It,ln),Bt=new Le(Tt,ln),Te=new Le(et/g,on/g),vi=new Le(On/g,Gt/g),Jn=i*Math.PI/180;if(Jn){const cr=Math.sin(Jn),Wi=Math.cos(Jn),nr=[Wi,-cr,cr,Wi];An._matMult(nr),dn._matMult(nr),Bt._matMult(nr),Tn._matMult(nr)}const gi=je.stretch+je.fixed,hn=Pt.stretch+Pt.fixed,Xn=dt.stretch+dt.fixed,Kn=st.stretch+st.fixed,vr=o.imageSecondary;return{tl:An,tr:dn,bl:Bt,br:Tn,texPrimary:{x:p.paddedRect.x+bf+gi,y:p.paddedRect.y+bf+Xn,w:hn-gi,h:Kn-Xn},texSecondary:vr?{x:vr.paddedRect.x+bf+gi,y:vr.paddedRect.y+bf+Xn,w:hn-gi,h:Kn-Xn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Te,pixelOffsetBR:vi,minFontScaleX:Ee/g/C,minFontScaleY:Pe/g/D,isSDF:a}};if(l&&(p.stretchX||p.stretchY)){const je=$T(M,j,F),dt=$T(k,q,B);for(let Pt=0;Pt<je.length-1;Pt++){const st=je[Pt],Tt=je[Pt+1];for(let et=0;et<dt.length-1;et++)d.push(Ze(st,dt[et],Tt,dt[et+1]))}}else d.push(Ze({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:y+1},{fixed:0,stretch:x+1}));return d}function u0(o,i,a){let l=0;for(const d of o)l+=Math.max(i,Math.min(a,d[1]))-Math.max(i,Math.min(a,d[0]));return l}function $T(o,i,a){const l=[{fixed:-bf,stretch:0}];for(const[d,p]of o){const g=l[l.length-1];l.push({fixed:d-g.stretch,stretch:g.stretch}),l.push({fixed:d-g.stretch,stretch:g.stretch+(p-d)})}return l.push({fixed:i+bf,stretch:a}),l}function Fg(o,i,a,l){return o/i*a+l}function Lg(o,i,a,l){return o-i*a/l}function sI(o,i,a,l){const d=i+o.positionedLines[l].lineOffset;return 0===l?a+d/2:a+(d+(i+o.positionedLines[l-1].lineOffset))/2}function My(o,i=1,a=!1){let l=1/0,d=1/0,p=-1/0,g=-1/0;const y=o[0];for(let P=0;P<y.length;P++){const F=y[P];(!P||F.x<l)&&(l=F.x),(!P||F.y<d)&&(d=F.y),(!P||F.x>p)&&(p=F.x),(!P||F.y>g)&&(g=F.y)}const x=Math.min(p-l,g-d);let C=x/2;const D=new ec([],aI);if(0===x)return new Le(l,d);for(let P=l;P<p;P+=x)for(let F=d;F<g;F+=x)D.push(new xf(P+C,F+C,C,o));let M=function(P){let F=0,B=0,j=0;const q=P[0];for(let te=0,ie=q.length,se=ie-1;te<ie;se=te++){const de=q[te],pe=q[se],Ee=de.x*pe.y-pe.x*de.y;B+=(de.x+pe.x)*Ee,j+=(de.y+pe.y)*Ee,F+=3*Ee}return new xf(B/F,j/F,0,P)}(o),k=D.length;for(;D.length;){const P=D.pop();(P.d>M.d||!M.d)&&(M=P,a&&console.log("found best %d after %d probes",Math.round(1e4*P.d)/1e4,k)),P.max-M.d<=i||(C=P.h/2,D.push(new xf(P.p.x-C,P.p.y-C,C,o)),D.push(new xf(P.p.x+C,P.p.y-C,C,o)),D.push(new xf(P.p.x-C,P.p.y+C,C,o)),D.push(new xf(P.p.x+C,P.p.y+C,C,o)),k+=4)}return a&&(console.log(`num probes: ${k}`),console.log(`best distance: ${M.d}`)),M.p}function aI(o,i){return i.max-o.max}class xf{constructor(i,a,l,d){this.p=new Le(i,a),this.h=l,this.d=function(p,g){let y=!1,x=1/0;for(let C=0;C<g.length;C++){const D=g[C];for(let M=0,k=D.length,P=k-1;M<k;P=M++){const F=D[M],B=D[P];F.y>p.y!=B.y>p.y&&p.x<(B.x-F.x)*(p.y-F.y)/(B.y-F.y)+F.x&&(y=!y),x=Math.min(x,dw(p,F,B))}}return(y?1:-1)*Math.sqrt(x)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}}const wf=7,d0=Number.POSITIVE_INFINITY,Vw=Math.sqrt(2);function h0(o,[i,a]){let l=0,d=0;if(a===d0){i<0&&(i=0);const p=i/Vw;switch(o){case"top-right":case"top-left":d=p-wf;break;case"bottom-right":case"bottom-left":d=-p+wf;break;case"bottom":d=-i+wf;break;case"top":d=i-wf}switch(o){case"top-right":case"bottom-right":l=-p;break;case"top-left":case"bottom-left":l=p;break;case"left":l=i;break;case"right":l=-i}}else{switch(i=Math.abs(i),a=Math.abs(a),o){case"top-right":case"top-left":case"top":d=a-wf;break;case"bottom-right":case"bottom-left":case"bottom":d=-a+wf}switch(o){case"top-right":case"bottom-right":case"right":l=-i;break;case"top-left":case"bottom-left":case"left":l=i}}return[l,d]}function Bi(o,i,a,l,d,p,g,y,x,C,D){o.createArrays(),o.tilePixelRatio=Ht/(512*o.overscaling),o.compareText={},o.iconsNeedLinear=!1;const M=o.layers[0].layout,k=o.layers[0]._unevaluatedLayout._values,P={};if("composite"===o.textSizeData.kind){const{minZoom:q,maxZoom:te}=o.textSizeData;P.compositeTextSizes=[k["text-size"].possiblyEvaluate(new Ce(q),y),k["text-size"].possiblyEvaluate(new Ce(te),y)]}if("composite"===o.iconSizeData.kind){const{minZoom:q,maxZoom:te}=o.iconSizeData;P.compositeIconSizes=[k["icon-size"].possiblyEvaluate(new Ce(q),y),k["icon-size"].possiblyEvaluate(new Ce(te),y)]}P.layoutTextSize=k["text-size"].possiblyEvaluate(new Ce(x+1),y),P.layoutIconSize=k["icon-size"].possiblyEvaluate(new Ce(x+1),y),P.textMaxSize=k["text-size"].possiblyEvaluate(new Ce(18),y);const F="map"===M.get("text-rotation-alignment")&&"point"!==M.get("symbol-placement"),B=M.get("text-size");let j=!1;for(const q of o.features)if(q.icon&&q.icon.nameSecondary){j=!0;break}for(const q of o.features){const te=M.get("text-font").evaluate(q,{},y).join(","),ie=B.evaluate(q,{},y),se=P.layoutTextSize.evaluate(q,{},y),de=(P.layoutIconSize.evaluate(q,{},y),{horizontal:{},vertical:void 0}),pe=q.text;let Ee,Ie=[0,0];if(pe){const je=pe.toString(),dt=M.get("text-letter-spacing").evaluate(q,{},y)*ss,Pt=M.get("text-line-height").evaluate(q,{},y)*ss,st=S(je)?dt:0,Tt=M.get("text-anchor").evaluate(q,{},y),et=M.get("text-variable-anchor");if(!et){const ln=M.get("text-radial-offset").evaluate(q,{},y);Ie=ln?h0(Tt,[ln*ss,d0]):M.get("text-offset").evaluate(q,{},y).map(Gt=>Gt*ss)}let $t=F?"center":M.get("text-justify").evaluate(q,{},y);const on="point"===M.get("symbol-placement"),It=on?M.get("text-max-width").evaluate(q,{},y)*ss:1/0,On=ln=>{o.allowVerticalPlacement&&E(je)&&(de.vertical=t0(pe,i,a,d,te,It,Pt,Tt,ln,st,Ie,Ra.vertical,!0,se,ie))};if(!F&&et){const ln="auto"===$t?et.map(An=>we(An)):[$t];let Gt=!1;for(let An=0;An<ln.length;An++){const dn=ln[An];if(!de.horizontal[dn])if(Gt)de.horizontal[dn]=de.horizontal[0];else{const Tn=t0(pe,i,a,d,te,It,Pt,"center",dn,st,Ie,Ra.horizontal,!1,se,ie);Tn&&(de.horizontal[dn]=Tn,Gt=1===Tn.positionedLines.length)}}On("left")}else{if("auto"===$t&&($t=we(Tt)),on||M.get("text-writing-mode").indexOf("horizontal")>=0||!E(je)){const ln=t0(pe,i,a,d,te,It,Pt,Tt,$t,st,Ie,Ra.horizontal,!1,se,ie);ln&&(de.horizontal[$t]=ln)}On(on?"left":$t)}}let Pe=!1;if(q.icon&&q.icon.namePrimary){const je=l[q.icon.namePrimary];je&&(Ee=jT(d[q.icon.namePrimary],q.icon.nameSecondary?d[q.icon.nameSecondary]:void 0,M.get("icon-offset").evaluate(q,{},y),M.get("icon-anchor").evaluate(q,{},y)),Pe=je.sdf,void 0===o.sdfIcons?o.sdfIcons=je.sdf:o.sdfIcons!==je.sdf&&ar("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(je.pixelRatio!==o.pixelRatio||0!==M.get("icon-rotate").constantOr(1))&&(o.iconsNeedLinear=!0))}const Ze=Ng(de.horizontal)||de.vertical;o.iconsInText||(o.iconsInText=!!Ze&&Ze.iconsInText),(Ze||Ee)&&jw(o,q,de,Ee,l,P,se,0,Ie,Pe,g,y,C,D,j)}p&&o.generateCollisionDebugBuffers(x,o.collisionBoxArray)}function we(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function jw(o,i,a,l,d,p,g,y,x,C,D,M,k,P,F){let B=p.textMaxSize.evaluate(i,{},M);void 0===B&&(B=g);const j=o.layers[0].layout,q=j.get("icon-offset").evaluate(i,{},M),te=Ng(a.horizontal)||a.vertical,ie="globe"===k.name,se=ss,de=g/se,pe=o.tilePixelRatio*B/se,Ee=(Tt=o.overscaling,o.zoom>18&&Tt>2&&(Tt>>=1),Math.max(Ht/(512*Tt),1)*j.get("symbol-spacing")),Ie=j.get("text-padding")*o.tilePixelRatio,Pe=j.get("icon-padding")*o.tilePixelRatio,Ze=Et(j.get("text-max-angle")),je="map"===j.get("text-rotation-alignment")&&"point"!==j.get("symbol-placement"),dt="map"===j.get("icon-rotation-alignment")&&"point"!==j.get("symbol-placement"),Pt=j.get("symbol-placement"),st=Ee/2;var Tt;const et=j.get("icon-text-fit").evaluate(i,{},M),$t=j.get("icon-text-fit-padding").evaluate(i,{},M),on="none"!==et;let It;!1===o.hasAnyIconTextFit&&on&&(o.hasAnyIconTextFit=!0),l&&on&&(o.allowVerticalPlacement&&a.vertical&&(It=Lw(l,a.vertical,et,$t,q,de)),te&&(l=Lw(l,te,et,$t,q,de)));const On=(ln,Gt,An)=>{if(Gt.x<0||Gt.x>=Ht||Gt.y<0||Gt.y>=Ht)return;let dn=null;if(ie){const{x:Tn,y:Bt,z:Te}=k.projectTilePoint(Gt.x,Gt.y,An);dn={anchor:new Wu(Tn,Bt,Te,0,void 0),up:k.upVector(An,Gt.x,Gt.y)}}!function(Tn,Bt,Te,vi,Jn,gi,hn,Xn,Kn,vr,cr,Wi,nr,Vi,Lr,br,ao,Vo,Vs,mo,Kr,Ts,Ss,js,Mr,xc,tm){const Ju=Tn.addToLineVertexArray(Bt,vi);let ed,r_,o_,rv,OC,FC,Z0,Y0=0,X0=0,K0=0,Q0=0,ov=-1,sv=-1;const wc={};let J0=Gv("");const du=Te?Te.anchor:Bt,kf="none"!==Kn.layout.get("icon-text-fit").evaluate(Kr,{},Mr);let td=0,ex=0;if(void 0===Kn._unevaluatedLayout.getValue("text-radial-offset")?[td,ex]=Kn.layout.get("text-offset").evaluate(Kr,{},Mr).map(Hr=>Hr*ss):(td=Kn.layout.get("text-radial-offset").evaluate(Kr,{},Mr)*ss,ex=d0),Tn.allowVerticalPlacement&&Jn.vertical){const Hr=Jn.vertical;if(Lr)FC=Bg(Hr),Xn&&(Z0=Bg(Xn));else{const cl=Kn.layout.get("text-rotate").evaluate(Kr,{},Mr)+90;o_=Zu(vr,du,Bt,cr,Wi,nr,Hr,Vi,cl,br),Xn&&(rv=Zu(vr,du,Bt,cr,Wi,nr,Xn,Vo,cl))}}if(gi){const Hr=Kn.layout.get("icon-rotate").evaluate(Kr,{},Mr),cl=zw(gi,Hr,Ss,kf),Rf=Xn?zw(Xn,Hr,Ss,kf):void 0;r_=Zu(vr,du,Bt,cr,Wi,nr,gi,Vo,Hr),Y0=4*cl.length;const tx=Tn.iconSizeData;let nm=null;"source"===tx.kind?(nm=[nu*Kn.layout.get("icon-size").evaluate(Kr,{},Mr)],nm[0]>ol&&ar(`${Tn.layerIds[0]}: Value for "icon-size" is >= ${xe}. Reduce your "icon-size".`)):"composite"===tx.kind&&(nm=[nu*Ts.compositeIconSizes[0].evaluate(Kr,{},Mr),nu*Ts.compositeIconSizes[1].evaluate(Kr,{},Mr)],(nm[0]>ol||nm[1]>ol)&&ar(`${Tn.layerIds[0]}: Value for "icon-size" is >= ${xe}. Reduce your "icon-size".`)),Tn.addSymbols(Tn.icon,cl,nm,mo,Vs,Kr,!1,Te,Bt,Ju.lineStartIndex,Ju.lineLength,-1,js,Mr,xc,tm),ov=Tn.icon.placedSymbolArray.length-1,Rf&&(X0=4*Rf.length,Tn.addSymbols(Tn.icon,Rf,nm,mo,Vs,Kr,Ra.vertical,Te,Bt,Ju.lineStartIndex,Ju.lineLength,-1,js,Mr,xc,tm),sv=Tn.icon.placedSymbolArray.length-1)}for(const Hr in Jn.horizontal){const cl=Jn.horizontal[Hr];ed||(J0=Gv(cl.text),Lr?OC=Bg(cl):ed=Zu(vr,du,Bt,cr,Wi,nr,cl,Vi,Kn.layout.get("text-rotate").evaluate(Kr,{},Mr),br));const Rf=1===cl.positionedLines.length;if(K0+=Uw(Tn,Te,Bt,cl,hn,Kn,Lr,Kr,br,Ju,Jn.vertical?Ra.horizontal:Ra.horizontalOnly,Rf?Object.keys(Jn.horizontal):[Hr],wc,ov,Ts,js,Mr,xc),Rf)break}Jn.vertical&&(Q0+=Uw(Tn,Te,Bt,Jn.vertical,hn,Kn,Lr,Kr,br,Ju,Ra.vertical,["vertical"],wc,sv,Ts,js,Mr,xc));let oh=-1;const sh=(Hr,cl)=>Hr?Math.max(Hr,cl):cl;oh=sh(OC,oh),oh=sh(FC,oh),oh=sh(Z0,oh);const dI=oh>-1?1:0;Tn.glyphOffsetArray.length>=Gg.MAX_GLYPHS&&ar("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Kr.sortKey&&Tn.addToSortKeyRanges(Tn.symbolInstances.length,Kr.sortKey),Tn.symbolInstances.emplaceBack(Bt.x,Bt.y,du.x,du.y,du.z,wc.right>=0?wc.right:-1,wc.center>=0?wc.center:-1,wc.left>=0?wc.left:-1,wc.vertical>=0?wc.vertical:-1,ov,sv,J0,void 0!==ed?ed:Tn.collisionBoxArray.length,void 0!==ed?ed+1:Tn.collisionBoxArray.length,void 0!==o_?o_:Tn.collisionBoxArray.length,void 0!==o_?o_+1:Tn.collisionBoxArray.length,void 0!==r_?r_:Tn.collisionBoxArray.length,void 0!==r_?r_+1:Tn.collisionBoxArray.length,rv||Tn.collisionBoxArray.length,rv?rv+1:Tn.collisionBoxArray.length,cr,K0,Q0,Y0,X0,dI,0,td,ex,oh,0,kf?1:0)}(o,Gt,dn,ln,a,l,d,It,o.layers[0],o.collisionBoxArray,i.index,i.sourceLayerIndex,o.index,Ie,je,x,0,Pe,dt,q,i,p,C,D,M,P,F)};if("line"===Pt)for(const ln of a0(i.geometry,0,0,Ht,Ht)){const Gt=HT(ln,Ee,Ze,a.vertical||te,l,se,pe,o.overscaling,Ht);for(const An of Gt)te&&zg(o,te.text,st,An)||On(ln,An,M)}else if("line-center"===Pt){for(const ln of i.geometry)if(ln.length>1){const Gt=UT(ln,Ze,a.vertical||te,l,se,pe);Gt&&On(ln,Gt,M)}}else if("Polygon"===i.type)for(const ln of ra(i.geometry,0)){const Gt=My(ln,16);On(ln[0],new Wu(Gt.x,Gt.y,0,0,void 0),M)}else if("LineString"===i.type)for(const ln of i.geometry)On(ln,new Wu(ln[0].x,ln[0].y,0,0,void 0),M);else if("Point"===i.type)for(const ln of i.geometry)for(const Gt of ln)On([Gt],new Wu(Gt.x,Gt.y,0,0,void 0),M)}const xe=255,ol=xe*nu;function Uw(o,i,a,l,d,p,g,y,x,C,D,M,k,P,F,B,j,q){const te=function(de,pe,Ee,Ie,Pe,Ze,je,dt){const Pt=[];if(0===pe.positionedLines.length)return Pt;const st=Ie.layout.get("text-rotate").evaluate(Ze,{})*Math.PI/180,Tt=function(On){const ln=On[0],Gt=On[1],An=ln*Gt;return An>0?[ln,-Gt]:An<0?[-ln,Gt]:0===ln?[Gt,ln]:[Gt,-ln]}(Ee);let et=Math.abs(pe.top-pe.bottom);for(const On of pe.positionedLines)et-=On.lineOffset;const $t=pe.positionedLines.length,on=et/$t;let It=pe.top-Ee[1];for(let On=0;On<$t;++On){const ln=pe.positionedLines[On];It=sI(pe,on,It,On);for(const Gt of ln.positionedGlyphs){if(!Gt.rect)continue;const An=Gt.rect||{};let dn=Wn+1,Tn=!0,Bt=1,Te=0;if(Gt.imageName){const mo=je[Gt.imageName];if(!mo)continue;if(mo.sdf){ar("SDF images are not supported in formatted text and will be ignored.");continue}Tn=!1,Bt=mo.pixelRatio,dn=fs/Bt}const vi=(Pe||dt)&&Gt.vertical,Jn=Gt.metrics.advance*Gt.scale/2,gi=Gt.metrics,hn=Gt.rect;if(null===hn)continue;dt&&pe.verticalizable&&(Te=Gt.imageName?Jn-Gt.metrics.width*Gt.scale/2:0);const Xn=Pe?[Gt.x+Jn,Gt.y]:[0,0];let Kn=[0,0],vr=[0,0],cr=!1;Pe||(vi?(vr=[Gt.x+Jn+Tt[0],Gt.y+Tt[1]-Te],cr=!0):Kn=[Gt.x+Jn+Ee[0],Gt.y+Ee[1]-Te]);const Wi=hn.w*Gt.scale/(Bt*(Gt.localGlyph?gc:1)),nr=hn.h*Gt.scale/(Bt*(Gt.localGlyph?gc:1));let Vi,Lr,br,ao;if(vi){const mo=Gt.y-It,Kr=new Le(-Jn,Jn-mo),Ts=-Math.PI/2,Ss=new Le(...vr);Vi=new Le(-Jn+Kn[0],Kn[1]),Vi._rotateAround(Ts,Kr)._add(Ss),Vi.x+=-mo+Jn,Vi.y-=(gi.left-dn)*Gt.scale;const js=Gt.imageName?gi.advance*Gt.scale:ss*Gt.scale,Mr=String.fromCodePoint(Gt.glyph);qu(Mr)?Vi.x+=(1-dn)*Gt.scale:Qb(Mr)?Vi.x+=js-gi.height*Gt.scale+(-dn-1)*Gt.scale:Vi.x+=Gt.imageName||gi.width+2*dn===hn.w&&gi.height+2*dn===hn.h?(js-nr)/2:(js-(gi.height+2*dn)*Gt.scale)/2,Lr=new Le(Vi.x,Vi.y-Wi),br=new Le(Vi.x+nr,Vi.y),ao=new Le(Vi.x+nr,Vi.y-Wi)}else{const mo=(gi.left-dn)*Gt.scale-Jn+Kn[0],Kr=(-gi.top-dn)*Gt.scale+Kn[1],Ts=mo+Wi,Ss=Kr+nr;Vi=new Le(mo,Kr),Lr=new Le(Ts,Kr),br=new Le(mo,Ss),ao=new Le(Ts,Ss)}if(st){let mo;mo=Pe?new Le(0,0):cr?new Le(Tt[0],Tt[1]):new Le(Ee[0],Ee[1]),Vi._rotateAround(st,mo),Lr._rotateAround(st,mo),br._rotateAround(st,mo),ao._rotateAround(st,mo)}const Vo=new Le(0,0),Vs=new Le(0,0);Pt.push({tl:Vi,tr:Lr,bl:br,br:ao,texPrimary:An,texSecondary:void 0,writingMode:pe.writingMode,glyphOffset:Xn,sectionIndex:Gt.sectionIndex,isSDF:Tn,pixelOffsetTL:Vo,pixelOffsetBR:Vs,minFontScaleX:0,minFontScaleY:0})}}return Pt}(0,l,x,p,g,y,d,o.allowVerticalPlacement),ie=o.textSizeData;let se=null;"source"===ie.kind?(se=[nu*p.layout.get("text-size").evaluate(y,{},j)],se[0]>ol&&ar(`${o.layerIds[0]}: Value for "text-size" is >= ${xe}. Reduce your "text-size".`)):"composite"===ie.kind&&(se=[nu*F.compositeTextSizes[0].evaluate(y,{},j),nu*F.compositeTextSizes[1].evaluate(y,{},j)],(se[0]>ol||se[1]>ol)&&ar(`${o.layerIds[0]}: Value for "text-size" is >= ${xe}. Reduce your "text-size".`)),o.addSymbols(o.text,te,se,x,g,y,D,i,a,C.lineStartIndex,C.lineLength,P,B,j,q,!1);for(const de of M)k[de]=o.text.placedSymbolArray.length-1;return 4*te.length}function Ng(o){for(const i in o)return o[i];return null}function Zu(o,i,a,l,d,p,g,y,x,C){let D=g.top,M=g.bottom,k=g.left,P=g.right;const F=g.collisionPadding;if(F&&(k-=F[0],D-=F[1],P+=F[2],M+=F[3]),x){const B=new Le(k,D),j=new Le(P,D),q=new Le(k,M),te=new Le(P,M),ie=Et(x);let se=new Le(0,0);C&&(se=new Le(C[0],C[1])),B._rotateAround(ie,se),j._rotateAround(ie,se),q._rotateAround(ie,se),te._rotateAround(ie,se),k=Math.min(B.x,j.x,q.x,te.x),P=Math.max(B.x,j.x,q.x,te.x),D=Math.min(B.y,j.y,q.y,te.y),M=Math.max(B.y,j.y,q.y,te.y)}return o.emplaceBack(i.x,i.y,i.z,a.x,a.y,k,D,P,M,y,l,d,p),o.length-1}function Bg(o){o.collisionPadding&&(o.top-=o.collisionPadding[1],o.bottom+=o.collisionPadding[3]);const i=o.bottom-o.top;return i>0?Math.max(10,i):null}function zg(o,i,a,l){const d=o.compareText;if(i in d){const p=d[i];for(let g=p.length-1;g>=0;g--)if(l.dist(p[g])<a)return!0}else d[i]=[];return d[i].push(l),!1}function f0(o,i){const a=o.fovAboveCenter,l=o.elevation?o.elevation.getMinElevationBelowMSL()*i:0,d=(o._camera.position[2]*o.worldSize-l)/Math.cos(o._pitch),p=Math.sin(a)*d/Math.sin(Math.max(Math.PI/2-o._pitch-a,.01)),g=Math.sin(o._pitch)*p+d;return Math.min(1.01*g,d*(1/o._horizonShift))}function ru(o,i){if(!i.isReprojectedInTileSpace)return{scale:1<<o.z,x:o.x,y:o.y,x2:o.x+1,y2:o.y+1,projection:i};const a=Math.pow(2,-o.z),l=o.x*a,d=(o.x+1)*a,p=o.y*a,g=(o.y+1)*a,y=Ia(l),x=Ia(d),C=os(p),D=os(g),M=i.project(y,C),k=i.project(x,C),P=i.project(x,D),F=i.project(y,D);let B=Math.min(M.x,k.x,P.x,F.x),j=Math.min(M.y,k.y,P.y,F.y),q=Math.max(M.x,k.x,P.x,F.x),te=Math.max(M.y,k.y,P.y,F.y);const ie=a/16;function se(pe,Ee,Ie,Pe,Ze,je){const dt=(Ie+Ze)/2,Pt=(Pe+je)/2,st=i.project(Ia(dt),os(Pt)),Tt=Math.max(0,B-st.x,j-st.y,st.x-q,st.y-te);B=Math.min(B,st.x),q=Math.max(q,st.x),j=Math.min(j,st.y),te=Math.max(te,st.y),Tt>ie&&(se(pe,st,Ie,Pe,dt,Pt),se(st,Ee,dt,Pt,Ze,je))}se(M,k,l,p,d,p),se(k,P,d,p,d,g),se(P,F,d,g,l,g),se(F,M,l,g,l,p),B-=ie,j-=ie,q+=ie,te+=ie;const de=1/Math.max(q-B,te-j);return{scale:de,x:B*de,y:j*de,x2:q*de,y2:te*de,projection:i}}function Ay(o,{x:i,y:a},l=0){return new Le(((i-l)*o.scale-o.x)*Ht,(a*o.scale-o.y)*Ht)}const p0=h.m.identity(new Float32Array(16));class Yu{constructor(i){this.spec=i,this.name=i.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(i,a){return{x:0,y:0,z:0}}unproject(i,a){return new er(0,0)}projectTilePoint(i,a,l){return{x:i,y:a,z:0}}locationPoint(i,a,l=!0){return i._coordinatePoint(i.locationCoordinate(a),l)}pixelsPerMeter(i,a){return zo(1,i)*a}pixelSpaceConversion(i,a,l){return 1}farthestPixelDistance(i){return f0(i,i.pixelsPerMeter)}pointCoordinate(i,a,l,d){const p=i.horizonLineFromTop(!1),g=new Le(a,Math.max(p,l));return i.rayIntersectionCoordinate(i.pointRayIntersection(g,d))}pointCoordinate3D(i,a,l){const d=new Le(a,l);if(i.elevation)return i.elevation.pointCoordinate(d);{const p=this.pointCoordinate(i,d.x,d.y,0);return[p.x,p.y,p.z]}}isPointAboveHorizon(i,a){if(i.elevation)return!this.pointCoordinate3D(i,a.x,a.y);const l=i.horizonLineFromTop();return a.y<l}createInversionMatrix(i,a){return p0}createTileMatrix(i,a,l){let d,p,g;const y=l.canonical,x=h.m.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const C=ru(y,this);d=1,p=C.x+l.wrap*C.scale,g=C.y,h.m.scale(x,x,[d/C.scale,d/C.scale,i.pixelsPerMeter/a])}else d=a/i.zoomScale(y.z),p=(y.x+Math.pow(2,y.z)*l.wrap)*d,g=y.y*d;return h.m.translate(x,x,[p,g,0]),h.m.scale(x,x,[d/Ht,d/Ht,1]),x}upVector(i,a,l){return[0,0,1]}upVectorScale(i,a,l){return{metersToTile:1}}}class m0 extends Yu{constructor(i){super(i),this.range=[4,7],this.center=i.center||[-96,37.5];const[a,l]=this.parallels=i.parallels||[29.5,45.5],d=Math.sin(Et(a));this.n=(d+Math.sin(Et(l)))/2,this.c=1+d*(2*this.n-d),this.r0=Math.sqrt(this.c)/this.n}project(i,a){const{n:l,c:d,r0:p}=this,g=Et(i-this.center[0]),y=Et(a),x=Math.sqrt(d-2*l*Math.sin(y))/l;return{x:x*Math.sin(g*l),y:x*Math.cos(g*l)-p,z:0}}unproject(i,a){const{n:l,c:d,r0:p}=this,g=p+a;let y=Math.atan2(i,Math.abs(g))*Math.sign(g);g*l<0&&(y-=Math.PI*Math.sign(i)*Math.sign(g));const x=Et(this.center[0])*l;y=wn(y,-Math.PI-x,Math.PI-x);const C=Hn(Si(y/l)+this.center[0],-180,180),D=Math.asin(Hn((d-(i*i+g*g)*l*l)/(2*l),-1,1)),M=Hn(Si(D),-so,so);return new er(C,M)}}const Vg=1.340264,jg=-.081106,Ug=893e-6,zp=.003796,Iy=Math.sqrt(3)/2;class GT extends Yu{project(i,a){a=a/180*Math.PI,i=i/180*Math.PI;const l=Math.asin(Iy*Math.sin(a)),d=l*l,p=d*d*d;return{x:.5*(i*Math.cos(l)/(Iy*(Vg+3*jg*d+p*(7*Ug+9*zp*d)))/Math.PI+.5),y:1-.5*(l*(Vg+jg*d+p*(Ug+zp*d))/Math.PI+1),z:0}}unproject(i,a){i=(2*i-.5)*Math.PI;let l=a=(2*(1-a)-1)*Math.PI,d=l*l,p=d*d*d;for(let D,M,k,P=0;P<12&&(M=l*(Vg+jg*d+p*(Ug+zp*d))-a,k=Vg+3*jg*d+p*(7*Ug+9*zp*d),D=M/k,l=Hn(l-D,-Math.PI/3,Math.PI/3),d=l*l,p=d*d*d,!(Math.abs(D)<1e-12));++P);const g=Iy*i*(Vg+3*jg*d+p*(7*Ug+9*zp*d))/Math.cos(l),y=Math.asin(Math.sin(l)/Iy),x=Hn(180*g/Math.PI,-180,180),C=Hn(180*y/Math.PI,-so,so);return new er(x,C)}}class qT extends Yu{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0}project(i,a){return{x:.5+i/360,y:.5-a/360,z:0}}unproject(i,a){const l=360*(i-.5),d=Hn(360*(.5-a),-so,so);return new er(l,d)}}const Vp=Math.PI/2;function Hg(o){return Math.tan((Vp+o)/2)}class Hw extends Yu{constructor(i){super(i),this.center=i.center||[0,30];const[a,l]=this.parallels=i.parallels||[30,30];let d=Et(a),p=Et(l);this.southernCenter=d+p<0,this.southernCenter&&(d=-d,p=-p);const g=Math.cos(d),y=Hg(d);this.n=d===p?Math.sin(d):Math.log(g/Math.cos(p))/Math.log(Hg(p)/y),this.f=g*Math.pow(Hg(d),this.n)/this.n}project(i,a){a=Et(a),this.southernCenter&&(a=-a),i=Et(i-this.center[0]);const l=1e-6,{n:d,f:p}=this;p>0?a<-Vp+l&&(a=-Vp+l):a>Vp-l&&(a=Vp-l);const g=p/Math.pow(Hg(a),d);let y=g*Math.sin(d*i),x=p-g*Math.cos(d*i);return y=.5*(y/Math.PI+.5),x=.5*(x/Math.PI+.5),{x:y,y:this.southernCenter?x:1-x,z:0}}unproject(i,a){i=(2*i-.5)*Math.PI,this.southernCenter&&(a=1-a),a=(2*(1-a)-.5)*Math.PI;const{n:l,f:d}=this,p=d-a,g=Math.sign(p),y=Math.sign(l)*Math.sqrt(i*i+p*p);let x=Math.atan2(i,Math.abs(p))*g;p*l<0&&(x-=Math.PI*Math.sign(i)*g);const C=Hn(Si(x/l)+this.center[0],-180,180),D=Hn(Si(2*Math.atan(Math.pow(d/y,1/l))-Vp),-so,so);return new er(C,this.southernCenter?-D:D)}}class $w extends Yu{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(i,a){return{x:tl(i),y:Nl(a),z:0}}unproject(i,a){const l=Ia(i),d=os(a);return new er(l,d)}}const Gw=Et(so);class sl extends Yu{project(i,a){const l=(a=Et(a))*a,d=l*l;return{x:.5*((i=Et(i))*(.8707-.131979*l+d*(d*(.003971*l-.001529*d)-.013791))/Math.PI+.5),y:1-.5*(a*(1.007226+l*(.015085+d*(.028874*l-.044475-.005916*d)))/Math.PI+1),z:0}}unproject(i,a){i=(2*i-.5)*Math.PI;let l=a=(2*(1-a)-1)*Math.PI,d=25,p=0,g=l*l;do{g=l*l;const C=g*g;p=(l*(1.007226+g*(.015085+C*(.028874*g-.044475-.005916*C)))-a)/(1.007226+g*(.045255+C*(.259866*g-.311325-.005916*11*C))),l=Hn(l-p,-Gw,Gw)}while(Math.abs(p)>1e-6&&--d>0);g=l*l;const y=Hn(Si(i/(.8707+g*(g*(g*g*g*(.003971-.001529*g)-.013791)-.131979))),-180,180),x=Si(l);return new er(y,x)}}const qw=Et(so);class WT extends Yu{project(i,a){a=Et(a),i=Et(i);const l=Math.cos(a),d=2/Math.PI,p=Math.acos(l*Math.cos(i/2)),g=Math.sin(p)/p,y=.5*(i*d+2*l*Math.sin(i/2)/g)||0,x=.5*(a+Math.sin(a)/g)||0;return{x:.5*(y/Math.PI+.5),y:1-.5*(x/Math.PI+1),z:0}}unproject(i,a){let l=i=(2*i-.5)*Math.PI,d=a=(2*(1-a)-1)*Math.PI,p=25;const g=1e-6;let y=0,x=0;do{const C=Math.cos(d),D=Math.sin(d),M=2*D*C,k=D*D,P=C*C,F=Math.cos(l/2),B=Math.sin(l/2),j=2*F*B,q=B*B,te=1-P*F*F,ie=te?1/te:0,se=te?Math.acos(C*F)*Math.sqrt(1/te):0,de=.5*(2*se*C*B+2*l/Math.PI)-i,pe=.5*(se*D+d)-a,Ee=.5*ie*(P*q+se*C*F*k)+1/Math.PI,Ie=ie*(j*M/4-se*D*B),Pe=.125*ie*(M*B-se*D*P*j),Ze=.5*ie*(k*F+se*q*C)+.5,je=Ie*Pe-Ze*Ee;y=(pe*Ie-de*Ze)/je,x=(de*Pe-pe*Ee)/je,l=Hn(l-y,-Math.PI,Math.PI),d=Hn(d-x,-qw,qw)}while((Math.abs(y)>g||Math.abs(x)>g)&&--p>0);return new er(Si(l),Si(d))}}class ZT extends Yu{constructor(i){super(i),this.center=i.center||[0,0],this.parallels=i.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Et(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(i,a){const{scale:l,cosPhi:d}=this;return{x:Et(i)*d*l+.5,y:-Math.sin(Et(a))/d*l+.5,z:0}}unproject(i,a){const{scale:l,cosPhi:d}=this,p=-(a-.5)/l,g=Hn(Si((i-.5)/l)/d,-180,180),y=Math.asin(Hn(p*d,-1,1)),x=Hn(Si(y),-so,so);return new er(g,x)}}class g0 extends $w{constructor(i){super(i),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(i,a,l){const d=pg(i,a,l),p=xp(Kc(l));return h.v.transformMat4(d,d,p),{x:d[0],y:d[1],z:d[2]}}locationPoint(i,a){const l=Qc(a.lat,a.lng),d=h.v.normalize([],l),p=i.elevation?i.elevation.getAtPointOrZero(i.locationCoordinate(a),i._centerAltitude):i._centerAltitude,g=zo(1,0)*Ht*p;h.v.scaleAndAdd(l,l,d,g);const y=h.m.identity(new Float64Array(16));return h.m.multiply(y,i.pixelMatrix,i.globeMatrix),h.v.transformMat4(l,l,y),new Le(l[0],l[1])}pixelsPerMeter(i,a){return zo(1,0)*a}pixelSpaceConversion(i,a,l){const d=zo(1,i)*a,p=oi(zo(1,45)*a,d,l);return this.pixelsPerMeter(i,a)/p}createTileMatrix(i,a,l){const d=gg(Kc(l.canonical));return h.m.multiply(new Float64Array(16),i.globeMatrix,d)}createInversionMatrix(i,a){const{center:l}=i,d=xp(Kc(a));return h.m.rotateY(d,d,Et(l.lng)),h.m.rotateX(d,d,Et(l.lat)),h.m.scale(d,d,[i._pixelsPerMercatorPixel,i._pixelsPerMercatorPixel,1]),Float32Array.from(d)}pointCoordinate(i,a,l,d){return ny(i,a,l,!0)||new Ko(0,0)}pointCoordinate3D(i,a,l){const d=this.pointCoordinate(i,a,l,0);return[d.x,d.y,d.z]}isPointAboveHorizon(i,a){return!ny(i,a.x,a.y,!1)}farthestPixelDistance(i){const a=function(d,p){const g=d.cameraToCenterDistance,y=d._centerAltitude*p,x=d._camera,C=d._camera.forward(),D=h.v.add([],h.v.scale([],C,-g),[0,0,y]),M=d.worldSize/(2*Math.PI),k=[0,0,-M],P=d.width/d.height,F=Math.tan(d.fovAboveCenter),B=h.v.scale([],x.up(),F),j=h.v.scale([],x.right(),F*P),q=h.v.normalize([],h.v.add([],h.v.add([],C,B),j)),te=[];let ie;if(new gb(D,q).closestPointOnSphere(k,M,te)){const se=h.v.add([],te,k),de=h.v.sub([],se,D);ie=Math.cos(d.fovAboveCenter)*h.v.length(de)}else{const se=h.v.sub([],D,k),de=h.v.sub([],k,D);h.v.normalize(de,de);const pe=h.v.length(se)-M;ie=Math.sqrt(pe*(pe+2*M));const Ee=Math.acos(ie/(M+pe))-Math.acos(h.v.dot(C,de));ie*=Math.cos(Ee)}return 1.01*ie}(i,this.pixelsPerMeter(i.center.lat,i.worldSize)),l=Jc(i.zoom);if(l>0){const d=f0(i,zo(1,i.center.lat)*i.worldSize),p=i.worldSize/(2*Math.PI),g=Math.max(i.width,i.height)/i.worldSize*Math.PI;return oi(a,d+p*(1-Math.cos(g)),Math.pow(l,10))}return a}upVector(i,a,l){return pg(a,l,i,1)}upVectorScale(i){return{metersToTile:sf(mg(Kc(i)))}}}function _0(o){const i=o.parallels,a=!!i&&Math.abs(i[0]+i[1])<.01;switch(o.name){case"mercator":return new $w(o);case"equirectangular":return new qT(o);case"naturalEarth":return new sl(o);case"equalEarth":return new GT(o);case"winkelTripel":return new WT(o);case"albers":return a?new ZT(o):new m0(o);case"lambertConformalConic":return a?new ZT(o):new Hw(o);case"globe":return new g0(o)}throw new Error(`Invalid projection name: ${o.name}`)}const YT=new vt({"symbol-placement":new fe(He.layout_symbol["symbol-placement"]),"symbol-spacing":new fe(He.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new fe(He.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ne(He.layout_symbol["symbol-sort-key"]),"symbol-z-order":new fe(He.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new fe(He.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new fe(He.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new fe(He.layout_symbol["icon-ignore-placement"]),"icon-optional":new fe(He.layout_symbol["icon-optional"]),"icon-rotation-alignment":new fe(He.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ne(He.layout_symbol["icon-size"]),"icon-text-fit":new Ne(He.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ne(He.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ne(He.layout_symbol["icon-image"]),"icon-rotate":new Ne(He.layout_symbol["icon-rotate"]),"icon-padding":new fe(He.layout_symbol["icon-padding"]),"icon-keep-upright":new fe(He.layout_symbol["icon-keep-upright"]),"icon-offset":new Ne(He.layout_symbol["icon-offset"]),"icon-anchor":new Ne(He.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new fe(He.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new fe(He.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new fe(He.layout_symbol["text-rotation-alignment"]),"text-field":new Ne(He.layout_symbol["text-field"]),"text-font":new Ne(He.layout_symbol["text-font"]),"text-size":new Ne(He.layout_symbol["text-size"]),"text-max-width":new Ne(He.layout_symbol["text-max-width"]),"text-line-height":new Ne(He.layout_symbol["text-line-height"]),"text-letter-spacing":new Ne(He.layout_symbol["text-letter-spacing"]),"text-justify":new Ne(He.layout_symbol["text-justify"]),"text-radial-offset":new Ne(He.layout_symbol["text-radial-offset"]),"text-variable-anchor":new fe(He.layout_symbol["text-variable-anchor"]),"text-anchor":new Ne(He.layout_symbol["text-anchor"]),"text-max-angle":new fe(He.layout_symbol["text-max-angle"]),"text-writing-mode":new fe(He.layout_symbol["text-writing-mode"]),"text-rotate":new Ne(He.layout_symbol["text-rotate"]),"text-padding":new fe(He.layout_symbol["text-padding"]),"text-keep-upright":new fe(He.layout_symbol["text-keep-upright"]),"text-transform":new Ne(He.layout_symbol["text-transform"]),"text-offset":new Ne(He.layout_symbol["text-offset"]),"text-allow-overlap":new fe(He.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new fe(He.layout_symbol["text-ignore-placement"]),"text-optional":new fe(He.layout_symbol["text-optional"]),visibility:new fe(He.layout_symbol.visibility)});var y0={paint:new vt({"icon-opacity":new Ne(He.paint_symbol["icon-opacity"]),"icon-emissive-strength":new Ne(He.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Ne(He.paint_symbol["text-emissive-strength"]),"icon-color":new Ne(He.paint_symbol["icon-color"]),"icon-halo-color":new Ne(He.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ne(He.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ne(He.paint_symbol["icon-halo-blur"]),"icon-translate":new fe(He.paint_symbol["icon-translate"]),"icon-translate-anchor":new fe(He.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Ne(He.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Ne(He.paint_symbol["text-opacity"]),"text-color":new Ne(He.paint_symbol["text-color"],{runtimeType:Ii,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new Ne(He.paint_symbol["text-halo-color"]),"text-halo-width":new Ne(He.paint_symbol["text-halo-width"]),"text-halo-blur":new Ne(He.paint_symbol["text-halo-blur"]),"text-translate":new fe(He.paint_symbol["text-translate"]),"text-translate-anchor":new fe(He.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new fe(He.paint_symbol["icon-color-saturation"])}),layout:YT};class Ww{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:Ha,this.defaultValue=i}evaluate(i){if(i.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(i.formattedSection))return a.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}rn(Ww,"FormatSectionOverride",{omit:["defaultValue"]});class $g extends nn{constructor(i,a,l){super(i,y0,a,l)}recalculate(i,a){super.recalculate(i,a),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const l=this.layout.get("text-writing-mode");if(l){const d=[];for(const p of l)d.indexOf(p)<0&&d.push(p);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(i,a,l,d){const p=this.layout.get(i).evaluate(a,{},l,d),g=this._unevaluatedLayout._values[i];return g.isDataDriven()||Im(g.value)||!p?p:(y=a.properties,p.replace(/{([^{}]+)}/g,(C,D)=>D in y?String(y[D]):""));var y}createBucket(i){return new Gg(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of y0.paint.overridableProperties){if(!$g.hasPaintOverride(this.layout,i))continue;const a=this.paint.get(i),l=new Ww(a),d=new k_(l,a.property.specification,this.scope,this.options);let p=null;p="constant"===a.value.kind||"source"===a.value.kind?new tp("source",d):new np("composite",d,a.value.zoomStops,a.value._interpolationType),this.paint._values[i]=new Ke(a.property,p,a.parameters)}}_handleOverridablePaintPropertyUpdate(i,a,l){return!(!this.layout||a.isDataDriven()||l.isDataDriven())&&$g.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,a){const l=i.get("text-field"),d=y0.paint.properties[a];let p=!1;const g=y=>{for(const x of y)if(d.overrides&&d.overrides.hasOverride(x))return void(p=!0)};if("constant"===l.value.kind&&l.value.value instanceof ns)g(l.value.value.sections);else if("source"===l.value.kind){const y=C=>{p||(C instanceof bu&&yo(C.value)===_r?g(C.value.sections):C instanceof pd?g(C.sections):C.eachChild(y))},x=l.value;x._styleExpression&&y(x._styleExpression.expression)}return p}getProgramIds(){const i=0!==this.paint.get("icon-opacity").constantOr(1),a=0!==this.paint.get("text-opacity").constantOr(1),l=[];return i&&l.push("symbolIcon"),a&&l.push("symbolSDF"),l}getDefaultProgramParams(i,a){return{config:new Wc(this,a),overrideFog:!1}}}const XT=Tp.types,KT=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function jp(o,i,a,l,d,p,g,y,x,C,D,M,k){const P=y?Math.min(ol,Math.round(y[0])):0,F=y?Math.min(ol,Math.round(y[1])):0;o.emplaceBack(i,a,Math.round(32*l),Math.round(32*d),p,g,(P<<1)+(x?1:0),F,16*C,16*D,256*M,256*k)}function ky(o,i,a){o.emplaceBack(i,a)}function Ry(o,i,a,l,d,p,g){o.emplaceBack(i,a,l,d,p,g)}function Py(o,i,a,l,d){o.emplaceBack(i,a,l,d),o.emplaceBack(i,a,l,d),o.emplaceBack(i,a,l,d),o.emplaceBack(i,a,l,d)}function QT(o){for(const i of o.sections)if(G(i.text))return!0;return!1}class v0{constructor(i){this.layoutVertexArray=new No,this.indexArray=new rr,this.programConfigurations=i,this.segments=new Dr,this.dynamicLayoutVertexArray=new zi,this.opacityVertexArray=new Wo,this.placedSymbolArray=new b1,this.iconTransitioningVertexArray=new Er,this.globeExtVertexArray=new yr,this.zOffsetVertexArray=new uc}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length&&0===this.iconTransitioningVertexArray.length}upload(i,a,l,d,p){this.isEmpty()||(l&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,iI.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,Aw.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,KT,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=i.createVertexBuffer(this.iconTransitioningVertexArray,LT.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,Xb.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||p)&&(this.zOffsetVertexBuffer=i.createVertexBuffer(this.zOffsetVertexArray,FT.members,!0)),this.opacityVertexBuffer.itemSize=1),(l||d)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}rn(v0,"SymbolBuffers");class zl{constructor(i,a,l){this.layoutVertexArray=new i,this.layoutAttributes=a,this.indexArray=new l,this.segments=new Dr,this.collisionVertexArray=new Bo,this.collisionVertexArrayExt=new zi}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,Iw.members,!0),this.collisionVertexBufferExt=i.createVertexBuffer(this.collisionVertexArrayExt,NT.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}rn(zl,"CollisionBuffers");class Up{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(g=>g.fqid),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=h.m.identity([]),this.placementViewportMatrix=h.m.identity([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ey(this.zoom,a["text-size"]),this.iconSizeData=Ey(this.zoom,a["icon-size"]);const l=this.layers[0].layout,d=l.get("symbol-sort-key"),p=l.get("symbol-z-order");this.canOverlap=l.get("text-allow-overlap")||l.get("icon-allow-overlap")||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==p&&void 0!==d.constantOr(1),this.sortFeaturesByY=("viewport-y"===p||"auto"===p&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=l.get("text-writing-mode").map(g=>Ra[g]),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=i.sourceID,this.projection=i.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=l.get("symbol-z-elevate")}createArrays(){this.text=new v0(new Zc(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new v0(new Zc(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new Od,this.lineVertexArray=new bo,this.symbolInstances=new Fs}calculateGlyphDependencies(i,a,l,d,p){for(let g=0;g<i.length;g++){const y=i.codePointAt(g);if(void 0===y)break;if(a[y]=!0,d&&p&&y<=65535){const x=gf[i.charAt(g)];x&&(a[x.charCodeAt(0)]=!0)}}}populate(i,a,l,d){const p=this.layers[0],g=p.layout,y="globe"===this.projection.name,x=g.get("text-font"),C=g.get("text-field"),D=g.get("icon-image"),M=("constant"!==C.value.kind||C.value.value instanceof ns&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&("constant"!==x.value.kind||x.value.value.length>0),k="constant"!==D.value.kind||!!D.value.value||Object.keys(D.parameters).length>0,P=g.get("symbol-sort-key");if(this.features=[],!M&&!k)return;const F=a.iconDependencies,B=a.glyphDependencies,j=a.availableImages,q=new Ce(this.zoom);for(const{feature:te,id:ie,index:se,sourceLayerIndex:de}of i){const pe=p._featureFilter.needGeometry,Ee=Gd(te,pe);if(!p._featureFilter.filter(q,Ee,l))continue;if(pe||(Ee.geometry=eu(te,l,d)),y&&1!==te.type&&l.z<=5){const je=Ee.geometry,dt=.98078528056,Pt=(st,Tt)=>{const et=pg(st.x,st.y,l,1),$t=pg(Tt.x,Tt.y,l,1);return h.v.dot(et,$t)<dt};for(let st=0;st<je.length;st++)je[st]=uf(je[st],Pt)}let Ie,Pe;if(M){const je=p.getValueAndResolveTokens("text-field",Ee,l,j),dt=ns.factory(je);QT(dt)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===ae()||this.hasRTLText&&Se.isParsed())&&(Ie=rI(dt,p,Ee))}if(k){const je=p.getValueAndResolveTokens("icon-image",Ee,l,j);Pe=je instanceof Io?je:Io.fromString(je)}if(!Ie&&!Pe)continue;const Ze=this.sortFeaturesByKey?P.evaluate(Ee,{},l):void 0;if(this.features.push({id:ie,text:Ie,icon:Pe,index:se,sourceLayerIndex:de,geometry:Ee.geometry,properties:te.properties,type:XT[te.type],sortKey:Ze}),Pe&&(F[Pe.namePrimary]=!0,Pe.nameSecondary&&(F[Pe.nameSecondary]=!0)),Ie){const je=x.evaluate(Ee,{},l).join(","),dt="map"===g.get("text-rotation-alignment")&&"point"!==g.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ra.vertical)>=0;for(const Pt of Ie.sections)if(Pt.image)F[Pt.image.namePrimary]=!0;else{const st=E(Ie.toString()),Tt=Pt.fontStack||je,et=B[Tt]=B[Tt]||{};this.calculateGlyphDependencies(Pt.text,et,dt,this.allowVerticalPlacement,st)}}}"line"===g.get("symbol-placement")&&(this.features=function(te){const ie={},se={},de=[];let pe=0;function Ee(je){de.push(te[je]),pe++}function Ie(je,dt,Pt){const st=se[je];return delete se[je],se[dt]=st,de[st].geometry[0].pop(),de[st].geometry[0]=de[st].geometry[0].concat(Pt[0]),st}function Pe(je,dt,Pt){const st=ie[dt];return delete ie[dt],ie[je]=st,de[st].geometry[0].shift(),de[st].geometry[0]=Pt[0].concat(de[st].geometry[0]),st}function Ze(je,dt,Pt){const st=Pt?dt[0][dt[0].length-1]:dt[0][0];return`${je}:${st.x}:${st.y}`}for(let je=0;je<te.length;je++){const dt=te[je],Pt=dt.geometry,st=dt.text?dt.text.toString():null;if(!st){Ee(je);continue}const Tt=Ze(st,Pt),et=Ze(st,Pt,!0);if(Tt in se&&et in ie&&se[Tt]!==ie[et]){const $t=Pe(Tt,et,Pt),on=Ie(Tt,et,de[$t].geometry);delete ie[Tt],delete se[et],se[Ze(st,de[on].geometry,!0)]=on,de[$t].geometry=null}else Tt in se?Ie(Tt,et,Pt):et in ie?Pe(Tt,et,Pt):(Ee(je),ie[Tt]=pe-1,se[et]=pe-1)}return de.filter(je=>je.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((te,ie)=>te.sortKey-ie.sortKey)}update(i,a,l,d,p){const g=0!==Object.keys(i).length;if(g&&!this.stateDependentLayers.length)return;const y=g?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(i,a,y,l,d,p),this.icon.programConfigurations.updatePaintArrays(i,a,y,l,d,p)}updateZOffset(){const i=(p,g,y)=>{l+=g,l>p.length&&p.resize(l);for(let x=-g;x<0;x++)p.emplace(x+l,y)},a=(p,g,y)=>{d+=g,d>p.length&&p.resize(d);for(let x=-g;x<0;x++)p.emplace(x+d,y)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let l=0,d=0;for(let p=0;p<this.symbolInstances.length;p++){const g=this.symbolInstances.get(p),{numHorizontalGlyphVertices:y,numVerticalGlyphVertices:x,numIconVertices:C}=g,D=g.zOffset,M=C>0;if((y>0||x>0)&&(i(this.text.zOffsetVertexArray,y,D),i(this.text.zOffsetVertexArray,x,D)),M){const{placedIconSymbolIndex:k,verticalPlacedIconSymbolIndex:P}=g;k>=0&&a(this.icon.zOffsetVertexArray,C,D),P>=0&&a(this.icon.zOffsetVertexArray,g.numVerticalIconVertices,D)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=_0(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,a){const l=this.lineVertexArray.length;if(void 0!==i.segment)for(const{x:d,y:p}of a)this.lineVertexArray.emplaceBack(d,p);return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(i,a,l,d,p,g,y,x,C,D,M,k,P,F,B,j){const q=i.indexArray,te=i.layoutVertexArray,ie=i.globeExtVertexArray,se=i.segments.prepareSegment(4*a.length,te,q,this.canOverlap?g.sortKey:void 0),de=this.glyphOffsetArray.length,pe=se.vertexLength,Ee=this.allowVerticalPlacement&&y===Ra.vertical?Math.PI/2:0,Ie=g.text&&g.text.sections;for(let Ze=0;Ze<a.length;Ze++){const{tl:je,tr:dt,bl:Pt,br:st,texPrimary:Tt,texSecondary:et,pixelOffsetTL:$t,pixelOffsetBR:on,minFontScaleX:It,minFontScaleY:On,glyphOffset:ln,isSDF:Gt,sectionIndex:An}=a[Ze],dn=se.vertexLength,Tn=ln[1];if(jp(te,C.x,C.y,je.x,Tn+je.y,Tt.x,Tt.y,l,Gt,$t.x,$t.y,It,On),jp(te,C.x,C.y,dt.x,Tn+dt.y,Tt.x+Tt.w,Tt.y,l,Gt,on.x,$t.y,It,On),jp(te,C.x,C.y,Pt.x,Tn+Pt.y,Tt.x,Tt.y+Tt.h,l,Gt,$t.x,on.y,It,On),jp(te,C.x,C.y,st.x,Tn+st.y,Tt.x+Tt.w,Tt.y+Tt.h,l,Gt,on.x,on.y,It,On),x){const{x:Bt,y:Te,z:vi}=x.anchor,[Jn,gi,hn]=x.up;Ry(ie,Bt,Te,vi,Jn,gi,hn),Ry(ie,Bt,Te,vi,Jn,gi,hn),Ry(ie,Bt,Te,vi,Jn,gi,hn),Ry(ie,Bt,Te,vi,Jn,gi,hn),Py(i.dynamicLayoutVertexArray,Bt,Te,vi,Ee)}else Py(i.dynamicLayoutVertexArray,C.x,C.y,C.z,Ee);if(j){const Bt=et||Tt;ky(i.iconTransitioningVertexArray,Bt.x,Bt.y),ky(i.iconTransitioningVertexArray,Bt.x+Bt.w,Bt.y),ky(i.iconTransitioningVertexArray,Bt.x,Bt.y+Bt.h),ky(i.iconTransitioningVertexArray,Bt.x+Bt.w,Bt.y+Bt.h)}q.emplaceBack(dn,dn+1,dn+2),q.emplaceBack(dn+1,dn+2,dn+3),se.vertexLength+=4,se.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ln[0]),Ze!==a.length-1&&An===a[Ze+1].sectionIndex||i.programConfigurations.populatePaintArrays(te.length,g,g.index,{},P,F,B,Ie&&Ie[An])}const Pe=x?x.anchor:C;i.placedSymbolArray.emplaceBack(Pe.x,Pe.y,Pe.z,C.x,C.y,de,this.glyphOffsetArray.length-de,pe,D,M,C.segment,l?l[0]:0,l?l[1]:0,d[0],d[1],y,0,!1,0,k,0)}_commitLayoutVertex(i,a,l,d,p,g,y){i.emplaceBack(a,l,d,p,g,Math.round(y.x),Math.round(y.y))}_addCollisionDebugVertices(i,a,l,d,p,g,y){const x=l.segments.prepareSegment(4,l.layoutVertexArray,l.indexArray),C=x.vertexLength,D=y.tileAnchorX,M=y.tileAnchorY;for(let P=0;P<4;P++)l.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(l.collisionVertexArrayExt,a,i.padding,y.zOffset),this._commitLayoutVertex(l.layoutVertexArray,d,p,g,D,M,new Le(i.x1,i.y1)),this._commitLayoutVertex(l.layoutVertexArray,d,p,g,D,M,new Le(i.x2,i.y1)),this._commitLayoutVertex(l.layoutVertexArray,d,p,g,D,M,new Le(i.x2,i.y2)),this._commitLayoutVertex(l.layoutVertexArray,d,p,g,D,M,new Le(i.x1,i.y2)),x.vertexLength+=4;const k=l.indexArray;k.emplaceBack(C,C+1),k.emplaceBack(C+1,C+2),k.emplaceBack(C+2,C+3),k.emplaceBack(C+3,C),x.primitiveLength+=4}_addTextDebugCollisionBoxes(i,a,l,d,p,g){for(let y=d;y<p;y++){const x=l.get(y),C=this.getSymbolInstanceTextSize(i,g,a,y);this._addCollisionDebugVertices(x,C,this.textCollisionBox,x.projectedAnchorX,x.projectedAnchorY,x.projectedAnchorZ,g)}}_addIconDebugCollisionBoxes(i,a,l,d,p,g){for(let y=d;y<p;y++){const x=l.get(y),C=this.getSymbolInstanceIconSize(i,a,g.placedIconSymbolIndex);this._addCollisionDebugVertices(x,C,this.iconCollisionBox,x.projectedAnchorX,x.projectedAnchorY,x.projectedAnchorZ,g)}}generateCollisionDebugBuffers(i,a){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new zl(ia,Kb.members,Er),this.iconCollisionBox=new zl(ia,Kb.members,Er);const l=Xr(this.iconSizeData,i),d=Xr(this.textSizeData,i);for(let p=0;p<this.symbolInstances.length;p++){const g=this.symbolInstances.get(p);this._addTextDebugCollisionBoxes(d,i,a,g.textBoxStartIndex,g.textBoxEndIndex,g),this._addTextDebugCollisionBoxes(d,i,a,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g),this._addIconDebugCollisionBoxes(l,i,a,g.iconBoxStartIndex,g.iconBoxEndIndex,g),this._addIconDebugCollisionBoxes(l,i,a,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g)}}getSymbolInstanceTextSize(i,a,l,d){const p=this.text.placedSymbolArray.get(a.rightJustifiedTextSymbolIndex>=0?a.rightJustifiedTextSymbolIndex:a.centerJustifiedTextSymbolIndex>=0?a.centerJustifiedTextSymbolIndex:a.leftJustifiedTextSymbolIndex>=0?a.leftJustifiedTextSymbolIndex:a.verticalPlacedTextSymbolIndex>=0?a.verticalPlacedTextSymbolIndex:d),g=Pg(this.textSizeData,i,p)/ss;return this.tilePixelRatio*g}getSymbolInstanceIconSize(i,a,l){const d=this.icon.placedSymbolArray.get(l),p=Pg(this.iconSizeData,i,d);return this.tilePixelRatio*p}_commitDebugCollisionVertexUpdate(i,a,l,d){i.emplaceBack(a,-l,-l,d),i.emplaceBack(a,l,-l,d),i.emplaceBack(a,l,l,d),i.emplaceBack(a,-l,l,d)}_updateTextDebugCollisionBoxes(i,a,l,d,p,g){for(let y=d;y<p;y++){const x=l.get(y),C=this.getSymbolInstanceTextSize(i,g,a,y);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,C,x.padding,g.zOffset)}}_updateIconDebugCollisionBoxes(i,a,l,d,p,g){for(let y=d;y<p;y++){const x=l.get(y),C=this.getSymbolInstanceIconSize(i,a,g.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,C,x.padding,g.zOffset)}}updateCollisionDebugBuffers(i,a){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const l=Xr(this.iconSizeData,i),d=Xr(this.textSizeData,i);for(let p=0;p<this.symbolInstances.length;p++){const g=this.symbolInstances.get(p);this._updateTextDebugCollisionBoxes(d,i,a,g.textBoxStartIndex,g.textBoxEndIndex,g),this._updateTextDebugCollisionBoxes(d,i,a,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g),this._updateIconDebugCollisionBoxes(l,i,a,g.iconBoxStartIndex,g.iconBoxEndIndex,g),this._updateIconDebugCollisionBoxes(l,i,a,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(i,a,l,d,p,g,y,x,C){const D={};if(a<l){const{x1:M,y1:k,x2:P,y2:F,padding:B,projectedAnchorX:j,projectedAnchorY:q,projectedAnchorZ:te,tileAnchorX:ie,tileAnchorY:se,featureIndex:de}=i.get(a);D.textBox={x1:M,y1:k,x2:P,y2:F,padding:B,projectedAnchorX:j,projectedAnchorY:q,projectedAnchorZ:te,tileAnchorX:ie,tileAnchorY:se},D.textFeatureIndex=de}if(d<p){const{x1:M,y1:k,x2:P,y2:F,padding:B,projectedAnchorX:j,projectedAnchorY:q,projectedAnchorZ:te,tileAnchorX:ie,tileAnchorY:se,featureIndex:de}=i.get(d);D.verticalTextBox={x1:M,y1:k,x2:P,y2:F,padding:B,projectedAnchorX:j,projectedAnchorY:q,projectedAnchorZ:te,tileAnchorX:ie,tileAnchorY:se},D.verticalTextFeatureIndex=de}if(g<y){const{x1:M,y1:k,x2:P,y2:F,padding:B,projectedAnchorX:j,projectedAnchorY:q,projectedAnchorZ:te,tileAnchorX:ie,tileAnchorY:se,featureIndex:de}=i.get(g);D.iconBox={x1:M,y1:k,x2:P,y2:F,padding:B,projectedAnchorX:j,projectedAnchorY:q,projectedAnchorZ:te,tileAnchorX:ie,tileAnchorY:se},D.iconFeatureIndex=de}if(x<C){const{x1:M,y1:k,x2:P,y2:F,padding:B,projectedAnchorX:j,projectedAnchorY:q,projectedAnchorZ:te,tileAnchorX:ie,tileAnchorY:se,featureIndex:de}=i.get(x);D.verticalIconBox={x1:M,y1:k,x2:P,y2:F,padding:B,projectedAnchorX:j,projectedAnchorY:q,projectedAnchorZ:te,tileAnchorX:ie,tileAnchorY:se},D.verticalIconFeatureIndex=de}return D}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const l=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(i,a){const l=i.placedSymbolArray.get(a),d=l.vertexStartIndex+4*l.numGlyphs;for(let p=l.vertexStartIndex;p<d;p+=4)i.indexArray.emplaceBack(p,p+1,p+2),i.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const a=Math.sin(i),l=Math.cos(i),d=[],p=[],g=[];for(let y=0;y<this.symbolInstances.length;++y){g.push(y);const x=this.symbolInstances.get(y);d.push(0|Math.round(a*x.tileAnchorX+l*x.tileAnchorY)),p.push(x.featureIndex)}return g.sort((y,x)=>d[y]-d[x]||p[x]-p[y]),g}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let i=0;i<this.symbolInstances.length;++i)this.symbolInstanceIndexesSortedZOffset.push(i)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((i,a)=>this.symbolInstances.get(a).zOffset-this.symbolInstances.get(i).zOffset)}addToSortKeyRanges(i,a){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===a?l.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const l=this.symbolInstances.get(a);this.featureSortOrder.push(l.featureIndex);const{rightJustifiedTextSymbolIndex:d,centerJustifiedTextSymbolIndex:p,leftJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:y,placedIconSymbolIndex:x,verticalPlacedIconSymbolIndex:C}=l;d>=0&&this.addIndicesForPlacedSymbol(this.text,d),p>=0&&p!==d&&this.addIndicesForPlacedSymbol(this.text,p),g>=0&&g!==p&&g!==d&&this.addIndicesForPlacedSymbol(this.text,g),y>=0&&this.addIndicesForPlacedSymbol(this.text,y),x>=0&&this.addIndicesForPlacedSymbol(this.icon,x),C>=0&&this.addIndicesForPlacedSymbol(this.icon,C)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}rn(Up,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Up.MAX_GLYPHS=65535,Up.addDynamicAttributes=Py;var Gg=Up;const Zw=_n([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:JT}=Zw,Yw=_n([{name:"a_packed",components:4,type:"Float32"}]),{members:Xw}=Yw,Oy=Tp.types,b0=Math.cos(Math.PI/180*37.5);class x0{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=i.index,this.projection=i.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new na,this.layoutVertexArray2=new zi,this.indexArray=new rr,this.programConfigurations=new Zc(i.layers,i.zoom),this.segments=new Dr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(i,a,l,d){this.hasPattern=Mg("line",this.layers,a);const p=this.layers[0].layout.get("line-sort-key"),g=[];for(const{feature:D,id:M,index:k,sourceLayerIndex:P}of i){const F=this.layers[0]._featureFilter.needGeometry,B=Gd(D,F);if(!this.layers[0]._featureFilter.filter(new Ce(this.zoom),B,l))continue;const j=p?p.evaluate(B,{},l):void 0,q={id:M,properties:D.properties,type:D.type,sourceLayerIndex:P,index:k,geometry:F?B.geometry:eu(D,l,d),patterns:{},sortKey:j};g.push(q)}p&&g.sort((D,M)=>D.sortKey-M.sortKey);const{lineAtlas:y,featureIndex:x}=a,C=this.addConstantDashes(y);for(const D of g){const{geometry:M,index:k,sourceLayerIndex:P}=D;if(C&&this.addFeatureDashes(D,y),this.hasPattern){const F=Vb("line",this.layers,D,this.zoom,a);this.patternFeatures.push(F)}else this.addFeature(D,M,k,l,y.positions,a.availableImages,a.brightness);x.insert(i[k].feature,M,k,P,this.index)}}addConstantDashes(i){let a=!1;for(const l of this.layers){const d=l.paint.get("line-dasharray").value,p=l.layout.get("line-cap").value;if("constant"!==d.kind||"constant"!==p.kind)a=!0;else{const g=p.value,y=d.value;if(!y)continue;i.addDash(y,g)}}return a}addFeatureDashes(i,a){const l=this.zoom;for(const d of this.layers){const p=d.paint.get("line-dasharray").value,g=d.layout.get("line-cap").value;if("constant"===p.kind&&"constant"===g.kind)continue;let y,x;if("constant"===p.kind){if(y=p.value,!y)continue}else y=p.evaluate({zoom:l},i);x="constant"===g.kind?g.value:g.evaluate({zoom:l},i),a.addDash(y,x),i.patterns[d.id]=a.getKey(y,x)}}update(i,a,l,d,p){const g=0!==Object.keys(i).length;g&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(i,a,g?this.stateDependentLayers:this.layers,l,d,p)}addFeatures(i,a,l,d,p,g){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,a,l,d,g)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,Xw)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,JT),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,a,l,d,p,g,y){const x=this.layers[0].layout,C=x.get("line-join").evaluate(i,{}),D=x.get("line-cap").evaluate(i,{}),M=x.get("line-miter-limit"),k=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const P of a)this.addLine(P,i,C,D,M,k);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,l,p,g,d,y)}addLine(i,a,l,d,p,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let q=0;q<i.length-1;q++)this.totalDistance+=i[q].dist(i[q+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const y="Polygon"===Oy[a.type];let x=i.length;for(;x>=2&&i[x-1].equals(i[x-2]);)x--;let C=0;for(;C<x-1&&i[C].equals(i[C+1]);)C++;if(x<(y?3:2))return;"bevel"===l&&(p=1.05);const D=this.overscaling<=16?15*Ht/(512*this.overscaling):0,M=this.segments.prepareSegment(10*x,this.layoutVertexArray,this.indexArray);let k,P,F,B,j;this.e1=this.e2=-1,y&&(k=i[x-2],j=i[C].sub(k)._unit()._perp());for(let q=C;q<x;q++){if(F=q===x-1?y?i[C+1]:void 0:i[q+1],F&&i[q].equals(F))continue;j&&(B=j),k&&(P=k),k=i[q],j=F?F.sub(k)._unit()._perp():B,B=B||j;let te=B.add(j);0===te.x&&0===te.y||te._unit();const ie=B.x*j.x+B.y*j.y,se=te.x*j.x+te.y*j.y,de=0!==se?1/se:1/0,pe=2*Math.sqrt(2-2*se),Ee=se<b0&&P&&F,Ie=B.x*j.y-B.y*j.x>0;if(Ee&&q>C){const je=k.dist(P);if(je>2*D){const dt=k.sub(k.sub(P)._mult(D/je)._round());this.updateDistance(P,dt),this.addCurrentVertex(dt,B,0,0,M),P=dt}}const Pe=P&&F;let Ze=Pe?l:y?"butt":d;if(Pe&&"round"===Ze&&(de<g?Ze="miter":de<=2&&(Ze="fakeround")),"miter"===Ze&&de>p&&(Ze="bevel"),"bevel"===Ze&&(de>2&&(Ze="flipbevel"),de<p&&(Ze="miter")),P&&this.updateDistance(P,k),"miter"===Ze)te._mult(de),this.addCurrentVertex(k,te,0,0,M);else if("flipbevel"===Ze){if(de>100)te=j.mult(-1);else{const je=de*B.add(j).mag()/B.sub(j).mag();te._perp()._mult(je*(Ie?-1:1))}this.addCurrentVertex(k,te,0,0,M),this.addCurrentVertex(k,te.mult(-1),0,0,M)}else if("bevel"===Ze||"fakeround"===Ze){const je=-Math.sqrt(de*de-1),dt=Ie?je:0,Pt=Ie?0:je;if(P&&this.addCurrentVertex(k,B,dt,Pt,M),"fakeround"===Ze){const st=Math.round(180*pe/Math.PI/20);for(let Tt=1;Tt<st;Tt++){let et=Tt/st;if(.5!==et){const on=et-.5;et+=et*on*(et-1)*((1.0904+ie*(ie*(3.55645-1.43519*ie)-3.2452))*on*on+(.848013+ie*(.215638*ie-1.06021)))}const $t=j.sub(B)._mult(et)._add(B)._unit()._mult(Ie?-1:1);this.addHalfVertex(k,$t.x,$t.y,!1,Ie,0,M)}}F&&this.addCurrentVertex(k,j,-dt,-Pt,M)}else if("butt"===Ze)this.addCurrentVertex(k,te,0,0,M);else if("square"===Ze){const je=P?1:-1;P||this.addCurrentVertex(k,te,je,je,M),this.addCurrentVertex(k,te,0,0,M),P&&this.addCurrentVertex(k,te,je,je,M)}else"round"===Ze&&(P&&(this.addCurrentVertex(k,B,0,0,M),this.addCurrentVertex(k,B,1,1,M,!0)),F&&(this.addCurrentVertex(k,j,-1,-1,M,!0),this.addCurrentVertex(k,j,0,0,M)));if(Ee&&q<x-1){const je=k.dist(F);if(je>2*D){const dt=k.add(F.sub(k)._mult(D/je)._round());this.updateDistance(k,dt),this.addCurrentVertex(dt,j,0,0,M),k=dt}}}}addCurrentVertex(i,a,l,d,p,g=!1){const y=a.y*d-a.x,x=-a.y-a.x*d;this.addHalfVertex(i,a.x+a.y*l,a.y-a.x*l,g,!1,l,p),this.addHalfVertex(i,y,x,g,!0,-d,p)}addHalfVertex({x:i,y:a},l,d,p,g,y,x){this.layoutVertexArray.emplaceBack((i<<1)+(p?1:0),(a<<1)+(g?1:0),Math.round(63*l)+128,Math.round(63*d)+128,1+(0===y?0:y<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const C=x.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,C),x.primitiveLength++),g?this.e2=C:this.e1=C}updateScaledDistance(){if(this.lineClips){const i=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=i*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(i,a){this.distance+=i.dist(a),this.updateScaledDistance()}}rn(x0,"LineBucket",{omit:["layers","patternFeatures"]});class ou{constructor(i,a,l,d){this.context=i,this.format=l,this.texture=i.gl.createTexture(),this.update(a,d)}update(i,a,l){const{width:d,height:p}=i,{context:g}=this,{gl:y}=g;if(y.bindTexture(y.TEXTURE_2D,this.texture),g.pixelStoreUnpackFlipY.set(!1),g.pixelStoreUnpack.set(1),g.pixelStoreUnpackPremultiplyAlpha.set(this.format===y.RGBA&&(!a||!1!==a.premultiply)),l||this.size&&this.size[0]===d&&this.size[1]===p){const{x,y:C}=l||{x:0,y:0};if(i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||ImageBitmap&&i instanceof ImageBitmap)y.texSubImage2D(y.TEXTURE_2D,0,x,C,y.RGBA,y.UNSIGNED_BYTE,i);else{let D=this.format,M=y.UNSIGNED_BYTE;this.format===y.R32F&&(D=y.RED,M=y.FLOAT),y.texSubImage2D(y.TEXTURE_2D,0,x,C,d,p,D,M,i.data)}}else if(this.size=[d,p],i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||ImageBitmap&&i instanceof ImageBitmap){let x=this.format;this.format===y.R8&&(x=y.RED),y.texImage2D(y.TEXTURE_2D,0,this.format,x,y.UNSIGNED_BYTE,i)}else{let x=this.format,C=this.format,D=y.UNSIGNED_BYTE;this.format===y.DEPTH_COMPONENT&&(x=y.DEPTH_COMPONENT16,D=y.UNSIGNED_SHORT),this.format===y.R8&&(C=y.RED),this.format===y.R32F&&(D=y.FLOAT,C=y.RED),y.texImage2D(y.TEXTURE_2D,0,x,d,p,0,C,D,i.data)}this.useMipmap=!(!a||!a.useMipmap),this.useMipmap&&y.generateMipmap(y.TEXTURE_2D)}bind(i,a,l=!1){const{context:d}=this,{gl:p}=d;p.bindTexture(p.TEXTURE_2D,this.texture),i!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,i),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap&&!l?i===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_LINEAR:i),this.minFilter=i),a!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,a),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,a),this.wrapS=a)}bindExtraParam(i,a,l,d){const{context:p}=this,{gl:g}=p;g.bindTexture(g.TEXTURE_2D,this.texture),a!==this.magFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,a),this.magFilter=a),i!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this.useMipmap?i===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_LINEAR:i),this.minFilter=i),l!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,l),this.wrapS=l),d!==this.wrapT&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,d),this.wrapT=d)}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class qg{constructor(i,a){this.context=i,this.texture=a}bind(i,a){const{context:l}=this,{gl:d}=l;d.bindTexture(d.TEXTURE_2D,this.texture),i!==this.minFilter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,i),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,i),this.minFilter=i),a!==this.wrapS&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,a),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,a),this.wrapS=a)}}const su=new Uint16Array(8184);for(let o=0;o<2046;o++){let i=o+2,a=0,l=0,d=0,p=0,g=0,y=0;for(1&i?d=p=g=32:a=l=y=32;(i>>=1)>1;){const C=a+d>>1,D=l+p>>1;1&i?(d=a,p=l,a=g,l=y):(a=d,l=p,d=g,p=y),g=C,y=D}const x=4*o;su[x+0]=a,su[x+1]=l,su[x+2]=d,su[x+3]=p}const ps=new Uint16Array(2178),Kd=new Uint8Array(1089),Fy=new Uint16Array(1089);function Ly(o){return 0===o?-.03125:32===o?.03125:0}var Ny=_n([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const w0={type:2,extent:Ht,loadGeometry:()=>[[new Le(0,0),new Le(Ht+1,0),new Le(Ht+1,Ht+1),new Le(0,Ht+1),new Le(0,0)]]};class C0{constructor(i,a,l,d,p){this.tileID=i,this.uid=qe(),this.uses=0,this.tileSize=a,this.tileZoom=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=p,d&&d.style&&(this._lastUpdatedBrightness=d.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",d&&d.transform&&(this.projection=d.transform.projection)}registerFadeDuration(i){const a=i+this.timeAdded;a<uo.now()||this.fadeEndTime&&a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=ru(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(i,a,l){if(this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(d,p){const g={};if(!p)return g;for(const y of d){const x=y.layerIds.map(C=>p.getLayer(C)).filter(Boolean);if(0!==x.length){y.layers=x,y.stateDependentLayerIds&&(y.stateDependentLayers=y.stateDependentLayerIds.map(C=>x.filter(D=>D.id===C)[0]));for(const C of x)g[C.fqid]=y}}return g}(i.buckets,a.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const p=this.buckets[d];if(p instanceof Gg){if(this.hasSymbolBuckets=!0,!l)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const p=this.buckets[d];if(p instanceof Gg&&p.hasRTLText){this.hasRTLText=!0,Se.isLoading()||Se.isLoaded()||"deferred"!==ae()||be();break}}this.queryPadding=0;for(const d in this.buckets){const p=this.buckets[d],g=a.style.getOwnLayer(d);if(!g)continue;const y=g.queryRadius(p);this.queryPadding=Math.max(this.queryPadding,y)}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage),i.lineAtlas&&(this.lineAtlas=i.lineAtlas),this._lastUpdatedBrightness=i.brightness}else this.collisionBoxArray=new N_}unloadVectorData(){if(this.hasData()){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(i){return this.buckets[i.fqid]}upload(i){for(const d in this.buckets){const p=this.buckets[d];p.uploadPending()&&p.upload(i)}const a=i.gl,l=this.imageAtlas;if(l&&!l.uploaded){const d=!!Object.keys(l.patternPositions).length;this.imageAtlasTexture=new ou(i,l.image,a.RGBA,{useMipmap:d}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new ou(i,this.glyphAtlasImage,a.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new ou(i,this.lineAtlas.image,a.R8),this.lineAtlas.uploaded=!0)}prepare(i,a,l){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture,l),!a||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const d=a.style.getBrightness();(this._lastUpdatedBrightness||d)&&(this._lastUpdatedBrightness&&d&&Math.abs(this._lastUpdatedBrightness-d)<.001||(this._lastUpdatedBrightness=d,this.updateBuckets(void 0,a)))}queryRenderedFeatures(i,a,l,d,p,g,y,x){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:d,pixelPosMatrix:y,transform:g,params:p,tileTransform:this.tileTransform},i,a,l):{}}querySourceFeatures(i,a){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const d=l.loadVTLayers(),p=a?a.sourceLayer:"",g=d._geojsonTileLayer||d[p];if(!g)return;const y=Qa(a&&a.filter),{z:x,x:C,y:D}=this.tileID.canonical,M={z:x,x:C,y:D};for(let k=0;k<g.length;k++){const P=g.feature(k);if(y.needGeometry){const j=Gd(P,!0);if(!y.filter(new Ce(this.tileID.overscaledZ),j,this.tileID.canonical))continue}else if(!y.filter(new Ce(this.tileID.overscaledZ),P))continue;const F=l.getId(P,p),B=new Cw(P,x,C,D,F);B.tile=M,i.push(B)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}bucketsLoaded(){for(const i in this.buckets)if(this.buckets[i].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const a=this.expirationTime;if(i.cacheControl){const l=St(i.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const l=Date.now();let d=!1;if(this.expirationTime>l)d=!1;else if(a)if(this.expirationTime<a)d=!0;else{const p=this.expirationTime-a;p?this.expirationTime=l+Math.max(p,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(i,a){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(i).length&&a&&this.updateBuckets(i,a)}updateBuckets(i,a){if(!this.latestFeatureIndex)return;const l=this.latestFeatureIndex.loadVTLayers(),d=a.style.listImages(),p=a.style.getBrightness();for(const g in this.buckets){if(!a.style.hasLayer(g))continue;const y=this.buckets[g],x=y.layers[0].sourceLayer||"_geojsonTileLayer",C=l[x];let D={};if(i&&(D=i[x],!C||!D||0===Object.keys(D).length))continue;if(y.update(D,C,d,this.imageAtlas&&this.imageAtlas.patternPositions||{},p),y instanceof x0||y instanceof yy){const k=a.style.getOwnSourceCache(y.layers[0].source);a._terrain&&a._terrain.enabled&&k&&y.programConfigurations.needsUpload&&a._terrain._clearRenderCacheForTile(k.id,this.tileID)}const M=a&&a.style&&a.style.getOwnLayer(g);M&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(y)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<uo.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=uo.now()+i}setTexture(i,a){const l=a.context,d=l.gl;this.texture=this.texture||a.getTileTexture(i.width),this.texture&&this.texture instanceof ou?this.texture.update(i,{useMipmap:!0}):(this.texture=new ou(l,i,d.RGBA,{useMipmap:!0}),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE))}setDependencies(i,a){const l={};for(const d of a)l[d]=!0;this.dependencies[i]=l}hasDependency(i,a){for(const l of i){const d=this.dependencies[l];if(d)for(const p of a)if(d[p])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(i,a){if(!a||"mercator"===a.name||this._tileDebugBuffer)return;const l=eu(w0,this.tileID.canonical,this.tileTransform)[0],d=new un,p=new Gh;for(let g=0;g<l.length;g++){const{x:y,y:x}=l[g];d.emplaceBack(y,x),p.emplaceBack(g)}p.emplaceBack(0),this._tileDebugIndexBuffer=i.createIndexBuffer(p),this._tileDebugBuffer=i.createVertexBuffer(d,ag.members),this._tileDebugSegments=Dr.simpleSegment(0,0,d.length,p.length)}_makeTileBoundsBuffers(i,a){if(this._tileBoundsBuffer||!a||"mercator"===a.name)return;const l=eu(w0,this.tileID.canonical,this.tileTransform)[0];let d,p;if(this.isRaster){const g=function(y,x){const C=ru(y,x),D=Math.pow(2,y.z);for(let j=0;j<33;j++)for(let q=0;q<33;q++){const te=Ia((y.x+(q+Ly(q))/32)/D),ie=os((y.y+(j+Ly(j))/32)/D),se=x.project(te,ie),de=33*j+q;ps[2*de+0]=Math.round((se.x*C.scale-C.x)*Ht),ps[2*de+1]=Math.round((se.y*C.scale-C.y)*Ht)}Kd.fill(0),Fy.fill(0);for(let j=2045;j>=0;j--){const q=4*j,te=su[q+0],ie=su[q+1],se=su[q+2],de=su[q+3],pe=te+se>>1,Ee=ie+de>>1,Ie=pe+Ee-ie,Pe=Ee+te-pe,Ze=33*ie+te,je=33*de+se,dt=33*Ee+pe,Pt=Math.hypot((ps[2*Ze+0]+ps[2*je+0])/2-ps[2*dt+0],(ps[2*Ze+1]+ps[2*je+1])/2-ps[2*dt+1])>=16;Kd[dt]=Kd[dt]||(Pt?1:0),j<1022&&(Kd[dt]=Kd[dt]||Kd[33*(ie+Pe>>1)+(te+Ie>>1)]||Kd[33*(de+Pe>>1)+(se+Ie>>1)])}const M=new Cn,k=new rr;let P=0;function F(j,q){const te=33*q+j;return 0===Fy[te]&&(M.emplaceBack(ps[2*te+0],ps[2*te+1],j*Ht/32,q*Ht/32),Fy[te]=++P),Fy[te]-1}function B(j,q,te,ie,se,de){const pe=j+te>>1,Ee=q+ie>>1;if(Math.abs(j-se)+Math.abs(q-de)>1&&Kd[33*Ee+pe])B(se,de,j,q,pe,Ee),B(te,ie,se,de,pe,Ee);else{const Ie=F(j,q),Pe=F(te,ie),Ze=F(se,de);k.emplaceBack(Ie,Pe,Ze)}}return B(0,0,32,32,32,0),B(32,32,0,0,0,32),{vertices:M,indices:k}}(this.tileID.canonical,a);d=g.vertices,p=g.indices}else{d=new Cn,p=new rr;for(const{x:y,y:x}of l)d.emplaceBack(y,x,0,0);const g=ff(d.int16,void 0,4);for(let y=0;y<g.length;y+=3)p.emplaceBack(g[y],g[y+1],g[y+2])}this._tileBoundsBuffer=i.createVertexBuffer(d,Ny.members),this._tileBoundsIndexBuffer=i.createIndexBuffer(p),this._tileBoundsSegments=Dr.simpleSegment(0,0,d.length,p.length)}_makeGlobeTileDebugBuffers(i,a){const l=a.projection;if(!l||"globe"!==l.name||a.freezeTileCoverage)return;const d=this.tileID.canonical,p=xp(Cb(d,a)),g=Jc(a.zoom);let y;g>0&&(y=h.m.invert(new Float64Array(16),a.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(i,d,a,p,y,g),this._makeGlobeTileDebugTextBuffer(i,d,a,p,y,g)}_globePoint(i,a,l,d,p,g,y){let x=pg(i,a,l);if(g){const C=1<<l.z,D=tl(d.center.lng),M=Nl(d.center.lat),k=(l.x+.5)/C-D;let P=0;k>.5?P=-1:k<-.5&&(P=1);let F=(i/Ht+l.x)/C+P,B=(a/Ht+l.y)/C;F=(F-D)*d._pixelsPerMercatorPixel+D,B=(B-M)*d._pixelsPerMercatorPixel+M;const j=[F*d.worldSize,B*d.worldSize,0];h.v.transformMat4(j,j,g),x=fc(x,j,y)}return h.v.transformMat4(x,x,p)}_makeGlobeTileDebugBorderBuffer(i,a,l,d,p,g){const y=new un,x=new Gh,C=new Mn,D=(k,P,F,B,j)=>{const q=(F-k)/(j-1),te=(B-P)/(j-1),ie=y.length;for(let se=0;se<j;se++){const de=k+se*q,pe=P+se*te;y.emplaceBack(de,pe);const Ee=this._globePoint(de,pe,a,l,d,p,g);C.emplaceBack(Ee[0],Ee[1],Ee[2]),x.emplaceBack(ie+se)}},M=Ht;D(0,0,M,0,16),D(M,0,M,M,16),D(M,M,0,M,16),D(0,M,0,0,16),this._tileDebugIndexBuffer=i.createIndexBuffer(x),this._tileDebugBuffer=i.createVertexBuffer(y,ag.members),this._globeTileDebugBorderBuffer=i.createVertexBuffer(C,pb.members),this._tileDebugSegments=Dr.simpleSegment(0,0,y.length,x.length)}_makeGlobeTileDebugTextBuffer(i,a,l,d,p,g){const y=Ht/4,x=new un,C=new rr,D=new Mn,M=25;C.reserve(32),x.reserve(M),D.reserve(M);const k=(P,F)=>M*P+F;for(let P=0;P<M;P++){const F=P*y;for(let B=0;B<M;B++){const j=B*y;x.emplaceBack(j,F);const q=this._globePoint(j,F,a,l,d,p,g);D.emplaceBack(q[0],q[1],q[2])}}for(let P=0;P<4;P++)for(let F=0;F<4;F++){const B=k(P,F),j=k(P,F+1),q=k(P+1,F),te=k(P+1,F+1);C.emplaceBack(B,j,q),C.emplaceBack(q,j,te)}this._tileDebugTextIndexBuffer=i.createIndexBuffer(C),this._tileDebugTextBuffer=i.createVertexBuffer(x,ag.members),this._globeTileDebugTextBuffer=i.createVertexBuffer(D,pb.members),this._tileDebugTextSegments=Dr.simpleSegment(0,0,M,32)}destroy(i=!1){for(const a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!i&&this.texture&&this.texture instanceof ou&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.latestFeatureIndex=null,this.state="unloaded"}}class By{constructor(i,a){this.max=i,this.onRemove=a,this.reset()}reset(){for(const i in this.data)for(const a of this.data[i])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(i,a,l){const d=i.wrapped().key;void 0===this.data[d]&&(this.data[d]=[]);const p={value:a,timeout:void 0};if(void 0!==l&&(p.timeout=setTimeout(()=>{this.remove(i,p)},l)),this.data[d].push(p),this.order.push(d),this.order.length>this.max){const g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const a=this.data[i].shift();return a.timeout&&clearTimeout(a.timeout),0===this.data[i].length&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),a.value}getByKey(i){const a=this.data[i];return a?a[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,a){if(!this.has(i))return this;const l=i.wrapped().key,d=void 0===a?0:this.data[l].indexOf(a),p=this.data[l][d];return this.data[l].splice(d,1),p.timeout&&clearTimeout(p.timeout),0===this.data[l].length&&delete this.data[l],this.onRemove(p.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(i){const a=[];for(const l in this.data)for(const d of this.data[l])i(d.value)||a.push(d);for(const l of a)this.remove(l.value.tileID,l)}}let Wg=(()=>{class o{constructor(a,l,d,p){this.id=o.uniqueIdxCounter,o.uniqueIdxCounter++,this.context=a;const g=a.gl;this.buffer=g.createBuffer(),this.dynamicDraw=!!d,this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||p||l.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(a){this.id=o.uniqueIdxCounter,o.uniqueIdxCounter++;const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}return o.uniqueIdxCounter=0,o})();class Cf{constructor(i,a,l){this.func=i,this.mask=a,this.range=l}}Cf.ReadOnly=!1,Cf.ReadWrite=!0,Cf.disabled=new Cf(519,Cf.ReadOnly,[0,1]);class Kw{constructor(i,a,l,d,p,g){this.test=i,this.ref=a,this.mask=l,this.fail=d,this.depthFail=p,this.pass=g}}Kw.disabled=new Kw({func:519,mask:0},0,0,7680,7680,7680);class Vl{constructor(i,a,l,d){this.blendFunction=i,this.blendColor=a,this.mask=l,this.blendEquation=d}}Vl.Replace=[1,0,1,0],Vl.disabled=new Vl(Vl.Replace,Pi.transparent,[!1,!1,!1,!1]),Vl.unblended=new Vl(Vl.Replace,Pi.transparent,[!0,!0,!0,!0]),Vl.alphaBlended=new Vl([1,771,1,771],Pi.transparent,[!0,!0,!0,!0]),Vl.multiply=new Vl([774,0,774,0],Pi.transparent,[!0,!0,!0,!0]);class yc{constructor(i,a,l){this.enable=i,this.mode=a,this.frontFace=l}}yc.disabled=new yc(!1,1029,2305),yc.backCCW=new yc(!0,1029,2305),yc.backCW=new yc(!0,1029,2304),yc.frontCW=new yc(!0,1028,2304),yc.frontCCW=new yc(!0,1028,2305);class Ef extends pa{constructor(i,a,l){super(),this.id=i,this._onlySymbols=l,a.on("data",d=>{"source"===d.dataType&&"metadata"===d.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===d.dataType&&"content"===d.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),a.on("error",()=>{this._sourceErrored=!0}),this._source=a,this._tiles={},this._cache=new By(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=a.minTileCacheSize,this._maxTileCacheSize=a.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Ew,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(i){this.map=i,this._minTileCacheSize=void 0===this._minTileCacheSize&&i?i._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&i?i._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const i in this._tiles){const a=this._tiles[i];if("errored"!==a.state&&("loaded"!==a.state||!a.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(i,a){return i.isSymbolTile=this._onlySymbols,i.isExtraShadowCaster=this._shadowCasterTiles[i.tileID.key],this._source.loadTile(i,a)}_unloadTile(i){if(this._source.unloadTile)return this._source.unloadTile(i,()=>{})}_abortTile(i){if(this._source.abortTile)return this._source.abortTile(i,()=>{})}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const l=this._tiles[a];l.upload(i),l.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Va(this._tiles).map(i=>i.tileID).sort(E0).map(i=>i.key)}getRenderableIds(i,a){const l=[];for(const d in this._tiles)this._isIdRenderable(+d,i,a)&&l.push(this._tiles[d]);return i?l.sort((d,p)=>{const g=d.tileID,y=p.tileID,x=new Le(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),C=new Le(y.canonical.x,y.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-y.overscaledZ||C.y-x.y||C.x-x.x}).map(d=>d.tileID.key):l.map(d=>d.tileID).sort(E0).map(d=>d.key)}hasRenderableParent(i){const a=this.findLoadedParent(i,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(i,a,l){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(a||!this._tiles[i].holdingForFade())&&(l||!this._shadowCasterTiles[i])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)"errored"!==this._tiles[i].state&&this._reloadTile(+i,"reloading")}}_reloadTile(i,a){const l=this._tiles[i];l&&("loading"!==l.state&&(l.state=a),this._loadTile(l,this._tileLoaded.bind(this,l,i,a)))}_tileLoaded(i,a,l,d){if(d)if(i.state="errored",404!==d.status)this._source.fire(new Xl(d,{tile:i}));else{if(!(i.tileID.key in this._loadedParentTiles))return void this._source.fire(new Ao("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id}));if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const p=this.map.painter.terrain;this.update(this.transform,p.getScaledDemTileSize(),!0),p.resetTileLookupCache(this.id)}else this.update(this.transform)}else i.timeAdded=uo.now(),"expired"===l&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(a,i),"raster-dem"===this._source.type&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),this._source.fire(new Ao("data",{dataType:"source",tile:i,coord:i.tileID,sourceCacheId:this.id}))}_backfillDEM(i){const a=this.getRenderableIds();for(let d=0;d<a.length;d++){const p=a[d];if(i.neighboringTiles&&i.neighboringTiles[p]){const g=this.getTileByID(p);l(i,g),l(g,i)}}function l(d,p){if(!d.dem||d.dem.borderReady)return;d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0;let g=p.tileID.canonical.x-d.tileID.canonical.x;const y=p.tileID.canonical.y-d.tileID.canonical.y,x=Math.pow(2,d.tileID.canonical.z),C=p.tileID.key;0===g&&0===y||Math.abs(y)>1||(Math.abs(g)>1&&(1===Math.abs(g+x)?g+=x:1===Math.abs(g-x)&&(g-=x)),p.dem&&d.dem&&(d.dem.backfillBorder(p.dem,g,y),d.neighboringTiles&&d.neighboringTiles[C]&&(d.neighboringTiles[C].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,a,l,d){for(const p in this._tiles){let g=this._tiles[p];if(d[p]||!g.hasData()||g.tileID.overscaledZ<=a||g.tileID.overscaledZ>l)continue;let y=g.tileID;for(;g&&g.tileID.overscaledZ>a+1;){const C=g.tileID.scaledTo(g.tileID.overscaledZ-1);g=this._tiles[C.key],g&&g.hasData()&&(y=C)}let x=y;for(;x.overscaledZ>a;)if(x=x.scaledTo(x.overscaledZ-1),i[x.key]){d[y.key]=y;break}}}findLoadedParent(i,a){if(i.key in this._loadedParentTiles){const l=this._loadedParentTiles[i.key];return l&&l.tileID.overscaledZ>=a?l:null}for(let l=i.overscaledZ-1;l>=a;l--){const d=i.scaledTo(l),p=this._getLoadedTile(d);if(p)return p}}_getLoadedTile(i){const a=this._tiles[i.key];return a&&a.hasData()?a:this._cache.getByKey(this._source.reparseOverscaled?i.wrapped().key:i.canonical.key)}updateCacheSize(i,a){a=a||this._source.tileSize;const l=Math.ceil(i.width/a)+1,d=Math.ceil(i.height/a)+1,p=Math.floor(l*d*5),g="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,p):p,y="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(y)}handleWrapJump(i){const a=Math.round((i-(void 0===this._prevLng?i:this._prevLng))/360);if(this._prevLng=i,a){const l={};for(const d in this._tiles){const p=this._tiles[d];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+a),l[p.tileID.key]=p}this._tiles=l;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(+d,this._tiles[d])}}update(i,a,l,d){if(this.transform=i,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!l)return;let p;if(this.updateCacheSize(i,a),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(x=>new Po(x.canonical.z,x.wrap,x.canonical.z,x.canonical.x,x.canonical.y)):(p=i.coveringTiles({tileSize:a||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!l,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(p=p.filter(x=>this._source.hasTile(x)))):p=[],p.length>0&&this.castsShadows&&d&&"globe"!==this.transform.projection.name&&!this.usedForTerrain&&!jy(this._source.type)){const x=i.coveringZoomLevel({tileSize:a||this._source.tileSize,roundZoom:this._source.roundZoom&&!l}),C=Math.min(x,this._source.maxzoom),D=i.extendTileCoverForShadows(p,d,C);for(const M of D)this._shadowCasterTiles[M.key]=!0,p.push(M)}const g=this._updateRetainedTiles(p);if(jy(this._source.type)&&0!==p.length){const x={},C={},D=Object.keys(g);for(const k of D){const P=g[k],F=this._tiles[k];if(!F||F.fadeEndTime&&F.fadeEndTime<=uo.now())continue;const B=this.findLoadedParent(P,Math.max(P.overscaledZ-Ef.maxOverzooming,this._source.minzoom));B&&(this._addTile(B.tileID),x[B.tileID.key]=B.tileID),C[k]=P}const M=p[p.length-1].overscaledZ;for(const k in this._tiles){const P=this._tiles[k];if(g[k]||!P.hasData())continue;let F=P.tileID;for(;F.overscaledZ>M;){F=F.scaledTo(F.overscaledZ-1);const B=this._tiles[F.key];if(B&&B.hasData()&&C[F.key]){g[k]=P.tileID;break}}}for(const k in x)g[k]||(this._coveredTiles[k]=!0,g[k]=x[k])}for(const x in g)this._tiles[x].clearFadeHold();const y=function(x,C){const D=[];for(const M in x)M in C||D.push(M);return D}(this._tiles,g);for(const x of y){const C=this._tiles[x];C.hasSymbolBuckets&&!C.holdingForFade()?C.setHoldDuration(this.map._fadeDuration):C.hasSymbolBuckets&&!C.symbolFadeFinished()||this._removeTile(+x)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(+i)}_updateRetainedTiles(i){const a={};if(0===i.length)return a;const l={},d=i.reduce((C,D)=>Math.min(C,D.overscaledZ),1/0),p=i[0].overscaledZ,g=Math.max(p-Ef.maxOverzooming,this._source.minzoom),y=Math.max(p+Ef.maxUnderzooming,this._source.minzoom),x={};for(const C of i){const D=this._addTile(C);a[C.key]=C,D.hasData()||d<this._source.maxzoom&&(x[C.key]=C)}this._retainLoadedChildren(x,d,y,a);for(const C of i){let D=this._tiles[C.key];if(D.hasData())continue;if(C.canonical.z>=this._source.maxzoom){const k=C.children(this._source.maxzoom)[0],P=this.getTile(k);if(P&&P.hasData()){a[k.key]=k;continue}}else{const k=C.children(this._source.maxzoom);if(a[k[0].key]&&a[k[1].key]&&a[k[2].key]&&a[k[3].key])continue}let M=D.wasRequested();for(let k=C.overscaledZ-1;k>=g;--k){const P=C.scaledTo(k);if(l[P.key]||(l[P.key]=!0,D=this.getTile(P),!D&&M&&(D=this._addTile(P)),D&&(a[P.key]=P,M=D.wasRequested(),D.hasData())))break}}return a}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const a=[];let l,d=this._tiles[i].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){l=this._loadedParentTiles[d.key];break}a.push(d.key);const p=d.scaledTo(d.overscaledZ-1);if(l=this._getLoadedTile(p),l)break;d=p}for(const p of a)this._loadedParentTiles[p]=l}}_addTile(i){let a=this._tiles[i.key];if(a)return!0!==a.isExtraShadowCaster||this._shadowCasterTiles[i.key]||this._reloadTile(i.key,"reloading"),a;a=this._cache.getAndRemove(i),a&&(this._setTileReloadTimer(i.key,a),a.tileID=i,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,a)));const l=!!a;if(!l){const d=this.map?this.map.painter:null;a=new C0(i,this._source.tileSize*i.overscaleFactor(),this.transform.tileZoom,d,this._isRaster),this._loadTile(a,this._tileLoaded.bind(this,a,i.key,a.state))}return a?(a.uses++,this._tiles[i.key]=a,l||this._source.fire(new Ao("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a):null}_setTileReloadTimer(i,a){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const l=a.getExpiryTimeout();l&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},l))}_removeTile(i){const a=this._tiles[i];a&&(a.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),a.uses>0||(a.hasData()&&"reloading"!==a.state?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(+i);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(i,a,l){const d=[],p=this.transform;if(!p)return d;const g="globe"===p.projection.name,y=tl(p.center.lng);for(const x in this._tiles){const C=this._tiles[x];if(l&&C.clearQueryDebugViz(),C.holdingForFade())continue;let D;if(g){const M=C.tileID.canonical;if(0===M.z){const k=[Math.abs(Hn(y,...Xu(M,-1))-y),Math.abs(Hn(y,...Xu(M,1))-y)];D=[0,2*k.indexOf(Math.min(...k))-1]}else{const k=[Math.abs(Hn(y,...Xu(M,-1))-y),Math.abs(Hn(y,...Xu(M,0))-y),Math.abs(Hn(y,...Xu(M,1))-y)];D=[k.indexOf(Math.min(...k))-1]}}else D=[0];for(const M of D){const k=i.containsTile(C,p,a,M);k&&d.push(k)}}return d}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(i){return this._getRenderableCoordinates(i)}_getRenderableCoordinates(i,a){const l=this.getRenderableIds(i,a).map(p=>this._tiles[p].tileID),d="globe"===this.transform.projection.name;for(const p of l)p.projMatrix=this.transform.calculateProjMatrix(p.toUnwrapped()),p.expandedProjMatrix=d?this.transform.calculateProjMatrix(p.toUnwrapped(),!1,!0):p.projMatrix;return l}sortCoordinatesByDistance(i){const a=i.slice(),l=this.transform._camera.position,d=this.transform._camera.forward(),p={};for(const g of a){const y=1/(1<<g.canonical.z);p[g.key]=((g.canonical.x+.5)*y+g.wrap-l[0])*d[0]+((g.canonical.y+.5)*y-l[1])*d[1]-l[2]*d[2]}return a.sort((g,y)=>p[g.key]-p[y.key]),a}hasTransition(){if(this._source.hasTransition())return!0;if(jy(this._source.type))for(const i in this._tiles){const a=this._tiles[i];if(void 0!==a.fadeEndTime&&a.fadeEndTime>=uo.now())return!0}return!1}setFeatureState(i,a,l){this._state.updateState(i=i||"_geojsonTileLayer",a,l)}removeFeatureState(i,a,l){this._state.removeFeatureState(i=i||"_geojsonTileLayer",a,l)}getFeatureState(i,a){return this._state.getState(i=i||"_geojsonTileLayer",a)}setDependencies(i,a,l){const d=this._tiles[i];d&&d.setDependencies(a,l)}reloadTilesForDependencies(i,a){for(const l in this._tiles)this._tiles[l].hasDependency(i,a)&&this._reloadTile(+l,"reloading");this._cache.filter(l=>!l.hasDependency(i,a))}_preloadTiles(i,a){if(!this._sourceLoaded){const y=()=>{this._sourceLoaded&&(this._source.off("data",y),this._preloadTiles(i,a))};return void this._source.on("data",y)}const l=new Map,d=Array.isArray(i)?i:[i],p=this.map.painter.terrain,g=this.usedForTerrain&&p?p.getScaledDemTileSize():this._source.tileSize;for(const y of d){const x=y.coveringTiles({tileSize:g,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const C of x)l.set(C.key,C);this.usedForTerrain&&y.updateElevation(!1)}Ho(Array.from(l.values()),(y,x)=>{const C=new C0(y,this._source.tileSize*y.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(C,D=>{"raster-dem"===this._source.type&&C.dem&&this._backfillDEM(C),x(D,C)})},a)}}function E0(o,i){const a=Math.abs(2*o.wrap)-+(o.wrap<0),l=Math.abs(2*i.wrap)-+(i.wrap<0);return o.overscaledZ-i.overscaledZ||l-a||i.canonical.y-o.canonical.y||i.canonical.x-o.canonical.x}function jy(o){return"raster"===o||"image"===o||"video"===o||"custom"===o}function Xu(o,i){const a=1<<o.z;return[o.x/a+i,(o.x+1)/a+i]}Ef.maxOverzooming=10,Ef.maxUnderzooming=3;const eS=_n([{name:"a_pos_3f",components:3,type:"Float32"}]),Qw=_n([{name:"a_color_3f",components:3,type:"Float32"}]),Jw=_n([{name:"a_color_4f",components:4,type:"Float32"}]),tS=_n([{name:"a_uv_2f",components:2,type:"Float32"}]),nS=_n([{name:"a_normal_3f",components:3,type:"Float32"}]),Zg=_n([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),iS=_n([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);function eC(o,i){const a=Uy(o.projection,o.zoom,o.width,o.height),l=function(p,g,y,x,C){const D=new er(y.lng-180*Qd,y.lat),M=new er(y.lng+180*Qd,y.lat),k=p.project(D.lng,D.lat),P=p.project(M.lng,M.lat),F=-Math.atan2(P.y-k.y,P.x-k.x),B=Ko.fromLngLat(y);B.y=Hn(B.y,-1+Qd,1-Qd);const j=B.toLngLat(),q=p.project(j.lng,j.lat),te=Ko.fromLngLat(j);te.x+=Qd;const ie=te.toLngLat(),se=p.project(ie.lng,ie.lat),de=iC(se.x-q.x,se.y-q.y,F),pe=Ko.fromLngLat(j);pe.y+=Qd;const Ee=pe.toLngLat(),Ie=p.project(Ee.lng,Ee.lat),Pe=iC(Ie.x-q.x,Ie.y-q.y,F),Ze=Math.abs(de.x)/Math.abs(Pe.y),je=h.m.identity([]);h.m.rotateZ(je,je,-F*(1-(C?0:x)));const dt=h.m.identity([]);return h.m.scale(dt,dt,[1,1-(1-Ze)*x,1]),dt[4]=-Pe.x/Pe.y*x,h.m.rotateZ(dt,dt,F),h.m.multiply(dt,je,dt),dt}(o.projection,0,o.center,a,i),d=tC(o);return h.m.scale(l,l,[d,d,1]),l}function tC(o){const i=o.projection,a=Uy(o.projection,o.zoom,o.width,o.height),l=nC(i,o.center),d=nC(i,er.convert(i.center));return Math.pow(2,l*a+(1-a)*d)}function Uy(o,i,a,l,d=1/0){const p=o.range;if(!p)return 0;const g=Math.min(d,Math.max(a,l)),y=Math.log(g/1024)/Math.LN2;return Is(p[0]+y,p[1]+y,i)}const Qd=1/4e4;function nC(o,i){const a=Hn(i.lat,-so,so),l=new er(i.lng-180*Qd,a),d=new er(i.lng+180*Qd,a),p=o.project(l.lng,a),g=o.project(d.lng,a),y=Ko.fromLngLat(l),x=Ko.fromLngLat(d),C=g.x-p.x,D=g.y-p.y,M=x.x-y.x,k=x.y-y.y,P=Math.sqrt((M*M+k*k)/(C*C+D*D));return Math.log(P)/Math.LN2}function iC(o,i,a){const l=Math.cos(a),d=Math.sin(a);return{x:o*l-i*d,y:o*d+i*l}}function rC(o,i,a){return i*(Ht/(o.tileSize*Math.pow(2,a-o.tileID.overscaledZ)))}function D0(o,i,a){h.m.identity(o),h.m.rotateZ(o,o,Et(i[2])),h.m.rotateX(o,o,Et(i[0])),h.m.rotateY(o,o,Et(i[1])),h.m.scale(o,o,a),h.m.multiply(o,o,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function ki(o,i,a,l,d,p,g,y){const x=[a[0]-i[0],a[1]-i[1],0],C=[l[0]-i[0],l[1]-i[1],0];if(h.v.length(x)<1e-12||h.v.length(C)<1e-12)return h.q.identity(o);const D=h.v.cross([],x,C);h.v.normalize(D,D),h.v.subtract(C,l,i),x[2]=(p-d)*y,C[2]=(g-d)*y;const M=x;return h.v.cross(M,x,C),h.v.normalize(M,M),h.q.rotationTo(o,D,M)}function oC(o,i,a=!1){const l=Jc(i.zoom),d=function(p,g,y){const x=g.worldSize,C=[p[12],p[13],p[14]],D=os(C[1]/x),M=Ia(C[0]/x),k=h.m.identity([]),P=zo(1,D)*x,F=zo(1,0)*x*af(D,g.zoom),B=1/iy(x);let j=F*B;if(y){const se=Uy(g.projection,g.zoom,g.width,g.height,1024);j=B*g.projection.pixelSpaceConversion(g.center.lat,x,se)}const q=Qc(D,M);h.v.add(q,q,h.v.scale([],h.v.normalize([],q),P*j*C[2]));const te=function(se){const de=[se[0],se[1],se[2]];let pe=[0,1,0];const Ee=h.v.cross([],pe,de);return h.v.cross(pe,de,Ee),0===h.v.squaredLength(pe)&&(pe=[0,1,0],h.v.cross(Ee,de,pe)),h.v.normalize(Ee,Ee),h.v.normalize(pe,pe),h.v.normalize(de,de),[Ee[0],Ee[1],Ee[2],0,pe[0],pe[1],pe[2],0,de[0],de[1],de[2],0,se[0],se[1],se[2],1]}(q);h.m.scale(k,k,[j,j,j*P]),h.m.translate(k,k,[-C[0],-C[1],-C[2]]);const ie=h.m.multiply([],g.globeMatrix,te);return h.m.multiply(ie,ie,k),h.m.multiply(ie,ie,p),ie}(o,i,a);return l>0?function(g,y,x){const C=(F,B,j)=>{const q=h.v.length(F),te=h.v.length(B),ie=fc(F,B,j);return h.v.scale(ie,ie,1/h.v.length(ie)*oi(q,te,j))},D=C([g[0],g[1],g[2]],[y[0],y[1],y[2]],x),M=C([g[4],g[5],g[6]],[y[4],y[5],y[6]],x),k=C([g[8],g[9],g[10]],[y[8],y[9],y[10]],x),P=fc([g[12],g[13],g[14]],[y[12],y[13],y[14]],x);return[D[0],D[1],D[2],0,M[0],M[1],M[2],0,k[0],k[1],k[2],0,P[0],P[1],P[2],1]}(d,function(g,y){const x=y.worldSize,C=zo(1,0)*x*af(y.center.lat,y.zoom)/iy(x),D=zo(1,y.center.lat)*x,M=h.m.identity([]);return h.m.rotateY(M,M,Et(y.center.lng)),h.m.rotateX(M,M,Et(y.center.lat)),h.m.translate(M,M,[0,0,el]),h.m.scale(M,M,[C,C,C*D]),h.m.translate(M,M,[y.point.x-.5*x,y.point.y-.5*x,0]),h.m.multiply(M,M,g),h.m.multiply(M,y.globeMatrix,M)}(o,i),l):d}const Hy={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4};function Yg(o,i,a=!1){o.uploaded||(o.gfxTexture=new ou(i,o.image,a?i.gl.R8:i.gl.RGBA,{useMipmap:o.sampler.minFilter>=i.gl.NEAREST_MIPMAP_NEAREST}),o.uploaded=!0,o.image=null)}function rS(o,i,a){o.indexBuffer=i.createIndexBuffer(o.indexArray,!1,!0),o.vertexBuffer=i.createVertexBuffer(o.vertexArray,eS.members,!1,!0),o.normalArray&&(o.normalBuffer=i.createVertexBuffer(o.normalArray,nS.members,!1,!0)),o.texcoordArray&&(o.texcoordBuffer=i.createVertexBuffer(o.texcoordArray,tS.members,!1,!0)),o.colorArray&&(o.colorBuffer=i.createVertexBuffer(o.colorArray,(12===o.colorArray.bytesPerElement?Qw:Jw).members,!1,!0)),o.featureArray&&(o.pbrBuffer=i.createVertexBuffer(o.featureArray,iS.members,!0)),o.segments=Dr.simpleSegment(0,0,o.vertexArray.length,o.indexArray.length);const l=o.material;l.pbrMetallicRoughness.baseColorTexture&&Yg(l.pbrMetallicRoughness.baseColorTexture,i),l.pbrMetallicRoughness.metallicRoughnessTexture&&Yg(l.pbrMetallicRoughness.metallicRoughnessTexture,i),l.normalTexture&&Yg(l.normalTexture,i),l.occlusionTexture&&Yg(l.occlusionTexture,i,a),l.emissionTexture&&Yg(l.emissionTexture,i)}function T0(o,i,a){if(o.meshes)for(const l of o.meshes)rS(l,i,a);if(o.children)for(const l of o.children)T0(l,i,a)}function $y(o){if(o.meshes)for(const i of o.meshes)i.indexArray.destroy(),i.vertexArray.destroy(),i.colorArray&&i.colorArray.destroy(),i.normalArray&&i.normalArray.destroy(),i.texcoordArray&&i.texcoordArray.destroy(),i.featureArray&&i.featureArray.destroy();if(o.children)for(const i of o.children)$y(i)}function Gy(o){if(o.meshes)for(const a of o.meshes)a.vertexBuffer&&(a.vertexBuffer.destroy(),a.indexBuffer.destroy(),a.normalBuffer&&a.normalBuffer.destroy(),a.texcoordBuffer&&a.texcoordBuffer.destroy(),a.colorBuffer&&a.colorBuffer.destroy(),a.pbrBuffer&&a.pbrBuffer.destroy(),a.segments.destroy(),a.material&&((i=a.material).pbrMetallicRoughness.baseColorTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),i.pbrMetallicRoughness.metallicRoughnessTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),i.normalTexture&&i.normalTexture.gfxTexture&&i.normalTexture.gfxTexture.destroy(),i.emissionTexture&&i.emissionTexture.gfxTexture&&i.emissionTexture.gfxTexture.destroy(),i.occlusionTexture&&i.occlusionTexture.gfxTexture&&i.occlusionTexture.gfxTexture.destroy()));var i;if(o.children)for(const a of o.children)Gy(a)}class sC{constructor(i,a){this.feature=i,this.instancedDataOffset=a,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class S0{constructor(){this.instancedDataArray=new Um,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class M0{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.fqid),this.projection=i.projection,this.index=i.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0}}populate(i,a,l,d){this.tileToMeter=cf(l);const p=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:g,id:y,index:x,sourceLayerIndex:C}of i){const D=Gd(g,p);if(!this.layers[0]._featureFilter.filter(new Ce(this.zoom),D,l))continue;const M={id:y,sourceLayerIndex:C,index:x,geometry:p?D.geometry:eu(g,l,d),properties:g.properties,type:g.type,patterns:{}},k=this.addFeature(M,M.geometry,D);k&&a.featureIndex.insert(g,M.geometry,x,C,this.index,this.instancesPerModel[k].instancedDataArray.length)}this.lookup=null}update(i,a,l,d){for(const p in this.instancesPerModel){const g=this.instancesPerModel[p];for(const y in i)g.idToFeaturesIndex.hasOwnProperty(y)&&this.evaluate(g.features[g.idToFeaturesIndex[y]],i[y],g,!0)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let i=!1;for(const a in this.instancesPerModel){const l=this.instancesPerModel[a];for(const d of l.features){const p=this.layers[0],g=d.feature,y=this.canonical,x=p.paint.get("model-rotation").evaluate(g,{},y),C=p.paint.get("model-scale").evaluate(g,{},y),D=p.paint.get("model-translation").evaluate(g,{},y);h.v.exactEquals(d.rotation,x)&&h.v.exactEquals(d.scale,C)&&h.v.exactEquals(d.translation,D)||(this.evaluate(d,d.featureStates,l,!0),i=!0)}}return i}isEmpty(){for(const i in this.instancesPerModel)if(0!==this.instancesPerModel[i].instancedDataArray.length)return!1;return!0}uploadPending(){return!this.uploaded}upload(i){if(!this.uploaded)for(const a in this.instancesPerModel){const l=this.instancesPerModel[a];l.instancedDataArray.length<0||0===l.instancedDataArray.length||(l.instancedDataBuffer?l.instancedDataBuffer.updateData(l.instancedDataArray):l.instancedDataBuffer=i.createVertexBuffer(l.instancedDataArray,Zg.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const i in this.instancesPerModel){const a=this.instancesPerModel[i];0!==a.instancedDataArray.length&&a.instancedDataBuffer&&a.instancedDataBuffer.destroy()}}addFeature(i,a,l){const d=this.layers[0],p=d.layout.get("model-id").evaluate(l,{},this.canonical);if(!p)return ar(`modelId is not evaluated for layer ${d.id} and it is not going to get rendered.`),p;this.instancesPerModel[p]||(this.instancesPerModel[p]=new S0);const g=this.instancesPerModel[p],y=g.instancedDataArray,x=new sC(l,y.length);for(const C of a)for(const D of C){if(D.x<0||D.x>=Ht||D.y<0||D.y>=Ht)continue;const M=(this.lookupDim-1)/Ht,k=this.lookupDim*(D.y*M|0)+D.x*M|0;if(this.lookup){if(0!==this.lookup[k])continue;this.lookup[k]=1}this.instanceCount++;const P=y.length;y.resize(P+1),g.instancesEvaluatedElevation.push(0),y.float32[16*P]=D.x,y.float32[16*P+1]=D.y}return x.instancedDataCount=g.instancedDataArray.length-x.instancedDataOffset,x.instancedDataCount>0&&(i.id&&(g.idToFeaturesIndex[i.id]=g.features.length),g.features.push(x),this.evaluate(x,{},g,!1)),p}evaluate(i,a,l,d){const p=this.layers[0],g=i.feature,y=this.canonical,x=i.rotation=p.paint.get("model-rotation").evaluate(g,a,y),C=i.scale=p.paint.get("model-scale").evaluate(g,a,y),D=i.translation=p.paint.get("model-translation").evaluate(g,a,y),M=p.paint.get("model-color").evaluate(g,a,y);M.a=p.paint.get("model-color-mix-intensity").evaluate(g,a,y);const k=[];this.maxVerticalOffset<D[2]&&(this.maxVerticalOffset=D[2]),this.maxScale=Math.max(Math.max(this.maxScale,C[0]),Math.max(C[1],C[2])),D0(k,x,C);const P=Math.round(100*M.a)+M.b/1.05;for(let F=0;F<i.instancedDataCount;++F){const B=i.instancedDataOffset+F,j=16*B,q=l.instancedDataArray.float32;let te=0;d&&(te=q[j+6]-l.instancesEvaluatedElevation[B]);const ie=0|q[j+1];q[j]=(0|q[j])+M.r/1.05,q[j+1]=ie+M.g/1.05,q[j+2]=P,q[j+3]=1/(y.z>10?this.tileToMeter:cf(y,ie)),q[j+4]=D[0],q[j+5]=D[1],q[j+6]=D[2]+te,q[j+7]=k[0],q[j+8]=k[1],q[j+9]=k[2],q[j+10]=k[4],q[j+11]=k[5],q[j+12]=k[6],q[j+13]=k[8],q[j+14]=k[9],q[j+15]=k[10],l.instancesEvaluatedElevation[B]=D[2]}}}rn(M0,"ModelBucket",{omit:["layers"]}),rn(S0,"PerModelAttributes"),rn(sC,"ModelFeature");const oS=new vt({visibility:new fe(He.layout_model.visibility),"model-id":new Ne(He.layout_model["model-id"])});var lI={paint:new vt({"model-opacity":new fe(He.paint_model["model-opacity"]),"model-rotation":new Ne(He.paint_model["model-rotation"]),"model-scale":new Ne(He.paint_model["model-scale"]),"model-translation":new Ne(He.paint_model["model-translation"]),"model-color":new Ne(He.paint_model["model-color"]),"model-color-mix-intensity":new Ne(He.paint_model["model-color-mix-intensity"]),"model-type":new fe(He.paint_model["model-type"]),"model-cast-shadows":new fe(He.paint_model["model-cast-shadows"]),"model-receive-shadows":new fe(He.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new fe(He.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Ne(He.paint_model["model-emissive-strength"]),"model-roughness":new Ne(He.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Ne(He.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new fe(He.paint_model["model-cutoff-fade-range"])}),layout:oS};const qy=new Float32Array(262144),Jd=new Uint8Array(262144);function sS(o){let i=0;if(o.meshes)for(const a of o.meshes)i=Math.max(i,a.aabb.max[2]);if(o.children)for(const a of o.children)i=Math.max(i,sS(a));return i}const Xg=["","wall","door","roof","window","lamp","logo"];class aC{constructor(i){this.node=i,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:i.id,geometry:[],properties:{height:sS(i)}}}}class lC{constructor(i,a,l,d){this.nodes=i,this.id=a,this.modelTraits|=Hy.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,l&&(this.modelTraits|=Hy.HasMapboxMeshFeatures),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=d,this.dirty=!0,this.needsUpload=!1}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(i){if(!this.needsUpload)return;const a=this.getNodesInfo();for(const l of a){const d=l.node;this.uploaded?this.updatePbrBuffer(d):T0(d,i,!0)}for(const l of a)$y(l.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(i){let a=!1;if(!i.meshes)return a;for(const l of i.meshes)l.pbrBuffer&&(l.pbrBuffer.updateData(l.featureArray),a=!0);return a}needsReEvaluation(i,a,l){const d=i.transform.projectionOptions,p=i.style.getBrightness(),g=this.brightness!==p;return!!(!this.uploaded||this.dirty||d.name!==this.projection.name||Df(l.paint.get("model-color").value,g)||Df(l.paint.get("model-color-mix-intensity").value,g)||Df(l.paint.get("model-roughness").value,g)||Df(l.paint.get("model-emissive-strength").value,g)||Df(l.paint.get("model-height-based-emissive-strength-multiplier").value,g))&&(this.projection=d,this.brightness=p,!0)}evaluateScale(i,a){if(i.transform.zoom===this.zoom)return;this.zoom=i.transform.zoom;const l=this.getNodesInfo(),d=this.id.canonical;for(const p of l){const g=p.feature;p.evaluatedScale=a.paint.get("model-scale").evaluate(g,{},d)}}evaluate(i){const a=this.getNodesInfo();for(const l of a){if(!l.node.meshes)continue;const d=l.feature,p=l.node.meshes&&l.node.meshes[0].featureData,g=l.evaluatedColor[2],y=l.evaluatedRMEA[2],x=this.id.canonical;if(l.hasTranslucentParts=!1,p){for(let C=0;C<Xg.length;C++){const D=Xg[C];D.length&&(d.properties.part=D);const M=i.paint.get("model-color").evaluate(d,{},x),k=i.paint.get("model-color-mix-intensity").evaluate(d,{},x);l.evaluatedColor[C]=[M.r,M.g,M.b,k],l.evaluatedRMEA[C][0]=i.paint.get("model-roughness").evaluate(d,{},x),l.evaluatedRMEA[C][2]=i.paint.get("model-emissive-strength").evaluate(d,{},x),l.evaluatedRMEA[C][3]=M.a,l.emissionHeightBasedParams[C]=i.paint.get("model-height-based-emissive-strength-multiplier").evaluate(d,{},x),!l.hasTranslucentParts&&M.a<1&&(l.hasTranslucentParts=!0)}delete d.properties.part,lu(l,g!==l.evaluatedColor[2]||y!==l.evaluatedRMEA[2])}else l.evaluatedRMEA[0][2]=i.paint.get("model-emissive-strength").evaluate(d,{},x);l.evaluatedScale=i.paint.get("model-scale").evaluate(d,{},x),this.updatePbrBuffer(l.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(i,a,l,d){const p=i.findDEMTileFor(l);if(p&&(p.tileID.canonical!==this.terrainTile||a!==this.terrainExaggeration)){if(p.dem&&p.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=p.tileID.overscaledZ;const g=Fp.create(i,l,p);if(!g)return;this.modelTraits&Hy.HasMapboxMeshFeatures&&this.updateDEM(i,g,l,d);for(const y of this.getNodesInfo()){const x=y.node;if(!x.footprint||!x.footprint.vertices||!x.footprint.vertices.length)continue;const C=x.footprint.vertices;let D=g.getElevationAt(C[0].x,C[0].y,!0,!0);for(let M=1;M<C.length;M++)D=Math.min(D,g.getElevationAt(C[M].x,C[M].y,!0,!0));x.elevation=D}}this.terrainTile=p.tileID.canonical,this.terrainExaggeration=a}}updateDEM(i,a,l,d){let p=a._dem._modifiedForSources[d];if(void 0===p&&(a._dem._modifiedForSources[d]=[],p=a._dem._modifiedForSources[d]),p.includes(l.canonical))return;const g=a._dem.dim;p.push(l.canonical);let y=!1;for(const x of this.getNodesInfo()){const C=x.node;if(!C.footprint||!C.footprint.grid)continue;const D=C.footprint.grid,M=a.tileCoordToPixel(D.min.x,D.min.y),k=a.tileCoordToPixel(D.max.x,D.max.y),P=Math.min(Math.min(g-k.y,M.x),Math.min(M.y,g-k.x));if(P<0)continue;const F=Hn(P,2,5);let B=Math.max(0,M.x-F),j=Math.max(0,M.y-F),q=Math.min(k.x+F,g-1),te=Math.min(k.y+F,g-1);for(let pe=j;pe<=te;++pe)for(let Ee=B;Ee<=q;++Ee)Jd[pe*g+Ee]=255;let ie=0,se=0;for(let pe=0;pe<D.cellsY;++pe)for(let Ee=0;Ee<D.cellsX;++Ee){if(!D.cells[pe*D.cellsX+Ee])continue;const Ie=a.tileCoordToPixel(D.min.x+Ee/D.xScale,D.min.y+pe/D.yScale),Pe=a.tileCoordToPixel(D.min.x+(Ee+1)/D.xScale,D.min.y+(pe+1)/D.yScale);for(let Ze=Ie.y;Ze<=Math.min(Pe.y+1,g-1);++Ze)for(let je=Ie.x;je<=Math.min(Pe.x+1,g-1);++je)255===Jd[Ze*g+je]&&(Jd[Ze*g+je]=0,ie+=a.getElevationAtPixel(je,Ze),se++)}const de=ie/se;B=Math.max(1,M.x-F),j=Math.max(1,M.y-F),q=Math.min(k.x+F,g-2),te=Math.min(k.y+F,g-2),y=!0;for(let pe=j;pe<=te;++pe)for(let Ee=B;Ee<=q;++Ee)0===Jd[pe*g+Ee]&&(qy[pe*g+Ee]=a._dem.set(Ee,pe,de));for(let pe=1;pe<F;++pe){B=Math.max(1,M.x-pe),j=Math.max(1,M.y-pe),q=Math.min(k.x+pe,g-2),te=Math.min(k.y+pe,g-2);for(let Ee=j;Ee<=te;++Ee)for(let Ie=B;Ie<=q;++Ie){const Pe=Ee*g+Ie;if(255===Jd[Pe]){let Ze=0,je=0,dt=-1,Pt=-1;for(let st=-1;st<=1;++st)for(let Tt=-1;Tt<=1;++Tt){const et=(Ee+st)*g+Ie+Tt;if(Jd[et]>=pe)continue;const $t=qy[et],on=Math.abs($t);on>je&&(Ze=$t,je=on,dt=Tt,Pt=st)}if(je>.1){const st=1-(pe+.5*Math.abs(dt*Pt))/F;let Tt=a._dem.get(Ie,Ee)+Ze*st;const et=a._dem.get(Ie+dt,Ee+Pt),$t=a._dem.get(Ie-dt,Ee-Pt,!0);(Tt-et)*(Tt-$t)>0&&(Tt=(et+$t)/2),qy[Pe]=a._dem.set(Ie,Ee,Tt),Jd[Pe]=pe}}}}}y&&(a._demTile.needsDEMTextureUpload=!0,a._dem._timestamp=uo.now())}getNodesInfo(){if(!this.nodesInfo){this.nodesInfo=[];for(const i of this.nodes)this.nodesInfo.push(new aC(i));this.freeNodes()}return this.nodesInfo}freeNodes(){if(this.nodes){for(const i of this.nodes)Gy(i);this.nodes.splice(0,this.nodes.length)}}destroy(){this.freeNodes();const i=this.getNodesInfo();for(const a of i)$y(a.node),Gy(a.node)}isEmpty(){return!this.nodes.length}updateReplacement(i,a){if(a.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=a.updateTime;const l=a.getReplacementRegionsForTile(i.toUnwrapped()),d=this.getNodesInfo();for(let p=0;p<this.nodesInfo.length;p++){const g=d[p].node;d[p].hiddenByReplacement=!!g.footprint&&!l.find(y=>y.footprint===g.footprint)}}getHeightAtTileCoord(i,a){const l=this.getNodesInfo(),d=[];for(let p=0;p<this.nodesInfo.length;p++){const g=l[p],y=g.node.meshes[0];if(i<y.aabb.min[0]||a<y.aabb.min[1]||i>y.aabb.max[0]||a>y.aabb.max[1])continue;const x=(i-y.aabb.min[0])/(y.aabb.max[0]-y.aabb.min[0])*64|0,C=64*Math.min(63,(a-y.aabb.min[1])/(y.aabb.max[1]-y.aabb.min[1])*64|0)+Math.min(63,x);if(!(y.heightmap[C]<0&&g.node.footprint))return g.hiddenByReplacement?void 0:{height:y.heightmap[C],maxHeight:g.feature.properties.height,hidden:!1,verticalScale:g.evaluatedScale[2]};if(g.node.footprint.grid.query(new Le(i,a),new Le(i,a),d),d.length>0)return{height:void 0,maxHeight:g.feature.properties.height,hidden:g.hiddenByReplacement,verticalScale:g.evaluatedScale[2]}}}}function Df(o,i){return!o.isLightConstant&&i}function aS(o,i,a,l,d,p,g,y){let x=(61440&i|(61440&i)>>4)>>8,C=(3840&i|(3840&i)>>4)>>4,D=240&i|(240&i)>>4;a[3]>0&&(x=oi(x,255*a[0],a[3]),C=oi(C,255*a[1],a[3]),D=oi(D,255*a[2],a[3]));const M=x<<8|C,k=D<<8|Math.floor(255*l[3]),P=function(pe){const Ee=Hn(pe,0,2);return Math.min(Math.round(.5*Ee*255),255)}(l[2])<<8|15*l[0]<<4|15*l[1],F=Hn(d[0],0,1),B=Hn(d[1],0,1),j=Hn(d[2],0,1),q=Hn(d[3],0,1);let te,ie,se,de;if(F!==B&&g!==p&&B!==F){const pe=g-p;ie=1/(pe*(B-F)),se=-(p+pe*F)/(pe*(B-F));const Ee=Hn(d[4],-1,1);de=Math.pow(10,Ee),te=255*j<<8|255*q}else te=65535,ie=0,se=1,de=1;if(o.emplaceBack(M,k,P,te,ie,se,de),y){const pe=y.length;y.clear();for(let Ee=0;Ee<pe;Ee++)y.emplaceBack(M,k,P,te,ie,se,de)}}function lu(o,i){const a=o.node;let l=0;for(const d of a.meshes){if(a.lights&&a.lightMeshIndex===l||!d.featureData)continue;d.featureArray=new Hm,d.featureArray.reserve(d.featureData.length);let p=i;for(const g of d.featureData){let y;const x=65535&g,C=(15&x)<8?15&x:0,D=g>>16&65535,M=o.evaluatedRMEA[C],k=o.evaluatedColor[C],P=o.emissionHeightBasedParams[C];if(p&&2===C&&a.lights&&(y=new Hm,y.resize(10*a.lights.length)),aS(d.featureArray,D,k,M,P,d.aabb.min[2],d.aabb.max[2],y),y&&p){p=!1;const F=a.meshes[a.lightMeshIndex];F.featureArray=y,F.featureArray._trim()}}d.featureArray._trim(),l++}}function eh(o,i){return o.x-i.x||o.y-i.y}function Ds(o,i){return 0===eh(o.min,i.min)&&0===eh(o.max,i.max)}function th(o,i){return!(o.min.x>i.max.x||o.max.x<i.min.x||o.min.y>i.max.y||o.max.y<i.min.y)}function Kg(o,i,a){const l=1/Ht,d=1/(1<<a.canonical.z),p=(i.x*l+a.canonical.x)*d+a.wrap,g=(i.y*l+a.canonical.y)*d;return{min:new Le((o.x*l+a.canonical.x)*d+a.wrap,(o.y*l+a.canonical.y)*d),max:new Le(p,g)}}function jl(o,i,a){const l=1<<a.canonical.z,d=((i.x-a.wrap)*l-a.canonical.x)*Ht,p=(i.y*l-a.canonical.y)*Ht;return{min:new Le(((o.x-a.wrap)*l-a.canonical.x)*Ht,(o.y*l-a.canonical.y)*Ht),max:new Le(d,p)}}function Fr(o,i,a,l,d,p,g){const y=o.indices,x=o.vertices,C=[];for(let D=l;D<l+d;D+=3){const M=i[a[D+0]+p],k=i[a[D+1]+p],P=i[a[D+2]+p],F=Math.min(M.x,k.x,P.x),B=Math.max(M.x,k.x,P.x),j=Math.min(M.y,k.y,P.y),q=Math.max(M.y,k.y,P.y);C.length=0,o.grid.query(new Le(F,j),new Le(B,q),C);for(let te=0;te<C.length;te++){const ie=C[te];if(uy(x[y[3*ie+0]],x[y[3*ie+1]],x[y[3*ie+2]],M,k,P,g))return!0}}return!1}function Tf(o,i,a,l){if(!o||!a)return!1;let d=o.vertices;if(!i.canonical.equals(l.canonical)||i.wrap!==l.wrap){if(a.vertices.length<o.vertices.length)return Tf(a,l,o,i);const p=i.canonical,g=l.canonical,y=Math.pow(2,g.z-p.z);d=o.vertices.map(x=>new Le(x.x*p.x*Ht*y-g.x*Ht,x.y*p.y*Ht*y-g.y*Ht))}return Fr(a,d,o.indices,0,o.indices.length,0,0)}rn(lC,"Tiled3dModelBucket",{omit:["layers"]}),rn(aC,"Tiled3dModelFeature");const $p=Tp.types,Gp=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],qp=["fill-extrusion-flood-light-ground-radius"],Wp=Math.pow(2,13),Zp=Math.pow(2,15)-1,Sf=new Le(0,1),ll=2147483648;function cu(o,i,a,l,d,p,g,y){o.emplaceBack((i<<1)+g,(a<<1)+p,(Math.floor(l*Wp)<<1)+d,Math.round(y))}function Qg(o,i,a,l,d,p){o.emplaceBack(i.x,i.y,(a.x<<1)+l,(a.y<<1)+d,p)}function Yp(o,i,a){o.emplaceBack(i.x,i.y,i.z,16384*a[0],16384*a[1],16384*a[2])}class A0{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class I0{constructor(){this.centroidXY=new Le(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Le(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Le(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Le(this.max.x-this.min.x,this.max.y-this.min.y)}}class k0{constructor(){this.acc=new Le(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(i,a){i.min.x===Number.MAX_VALUE&&(i.min.x=i.max.x=a.x,i.min.y=i.max.y=a.y)}appendEdge(i,a,l){this.accCount++,this.acc._add(a);let d=!!this.borders;a.x<i.min.x?(i.min.x=a.x,d=!0):a.x>i.max.x&&(i.max.x=a.x,d=!0),a.y<i.min.y?(i.min.y=a.y,d=!0):a.y>i.max.y&&(i.max.y=a.y,d=!0),((0===a.x||a.x===Ht)&&a.x===l.x)!=((0===a.y||a.y===Ht)&&a.y===l.y)&&this.processBorderOverlap(a,l),d&&this.checkBorderIntersection(a,l)}checkBorderIntersection(i,a){a.x<0!=i.x<0&&this.addBorderIntersection(0,oi(a.y,i.y,(0-a.x)/(i.x-a.x))),a.x>Ht!=i.x>Ht&&this.addBorderIntersection(1,oi(a.y,i.y,(Ht-a.x)/(i.x-a.x))),a.y<0!=i.y<0&&this.addBorderIntersection(2,oi(a.x,i.x,(0-a.y)/(i.y-a.y))),a.y>Ht!=i.y>Ht&&this.addBorderIntersection(3,oi(a.x,i.x,(Ht-a.y)/(i.y-a.y)))}addBorderIntersection(i,a){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const l=this.borders[i];a<l[0]&&(l[0]=a),a>l[1]&&(l[1]=a)}processBorderOverlap(i,a){if(i.x===a.x){if(i.y===a.y)return;const l=0===i.x?0:1;this.addBorderIntersection(l,a.y),this.addBorderIntersection(l,i.y)}else{const l=0===i.y?2:3;this.addBorderIntersection(l,a.x),this.addBorderIntersection(l,i.x)}}centroid(){return 0===this.accCount?new Le(0,0):new Le(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((i,a)=>i+ +(a[0]!==Number.MAX_VALUE),0):0}}function R0(o,i){const a=o.add(i)._unit(),l=Hn(o.x*a.x+o.y*a.y,-1,1);var d,p,g;return d=Math.acos(l),Math.min(4,Math.max(-4,Math.tan(d)))/4*Zp*((p=o).x*(g=i).y-p.y*g.x<0?-1:1)}const cC=[o=>o.x<0,o=>o.x>Ht,o=>o.y<0,o=>o.y>Ht];function uC(o,i,a,l){const d=[4];if(0===l)return d;a._mult(l);const p=o.sub(a),g=i.sub(a),y=[o,i,p,g];for(let x=0;x<4;x++)for(const C of y)if(cC[x](C)){d.push(x);break}return d}class P0{constructor(i){this.vertexArray=new hr,this.indexArray=new rr,this.programConfigurations=new Zc(i.layers,i.zoom,a=>qp.includes(a)),this._segments=new Dr,this.hiddenByLandmarkVertexArray=new L_,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Dr}getDefaultSegment(){return this.regionSegments[4]}hasData(){return 0!==this.vertexArray.length}addData(i,a,l,d=!1){const p=i.length;if(p>2){let g=Math.max(0,this._segments.get().length-1);const y=this._segments._prepareSegment(4*p,this.vertexArray.length,2*this._segmentToGroundQuads[g].length);let x;g!==this._segments.get().length-1&&(g++,this._segmentToGroundQuads[g]=[],this._segmentToRegionTriCounts[g]=[0,0,0,0,0]);{const C=i[0],D=i[1];x=R0(C.sub(i[p-1])._perp()._unit(),D.sub(C)._perp()._unit())}for(let C=0;C<p;C++){const D=C===p-1?0:C+1,M=i[C],k=i[D],P=i[D===p-1?0:D+1],F=k.sub(M)._perp()._unit(),B=R0(F,P.sub(k)._perp()._unit()),j=x,q=B;if(O0(M,k,a)||d&&hC(M,a)&&hC(k,a)){x=B;continue}const te=y.vertexLength;Qg(this.vertexArray,M,k,1,1,j),Qg(this.vertexArray,M,k,1,0,j),Qg(this.vertexArray,M,k,0,1,q),Qg(this.vertexArray,M,k,0,0,q),y.vertexLength+=4;const ie=uC(M,k,F,l);for(const se of ie)this._segmentToGroundQuads[g].push({id:te,region:se}),this._segmentToRegionTriCounts[g][se]+=2,y.primitiveLength+=2;x=B}}}prepareBorderSegments(){if(!this.hasData())return;const i=this._segments.get(),a=i.length;for(let l=0;l<a;l++)this._segmentToGroundQuads[l].sort((d,p)=>d.region-p.region);for(let l=0;l<a;l++){const d=this._segmentToGroundQuads[l],p=i[l],g=this._segmentToRegionTriCounts[l];g.reduce((x,C)=>x+C,0);let y=0;for(let x=0;x<=4;x++){const C=g[x];if(0!==C){let D=this.regionSegments[x];D||(D=this.regionSegments[x]=new Dr);const M={vertexOffset:p.vertexOffset,primitiveOffset:p.primitiveOffset+y,vertexLength:p.vertexLength,primitiveLength:C};D.get().push(M)}y+=C}for(let x=0;x<d.length;x++){const C=d[x].id;this.indexArray.emplaceBack(C,C+1,C+3),this.indexArray.emplaceBack(C,C+3,C+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(i,a,l,d,p,g){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,i,a,l,d,p,g)}upload(i){this.hasData()&&(this.vertexBuffer=i.createVertexBuffer(this.vertexArray,bT.members),this.indexBuffer=i.createIndexBuffer(this.indexArray))}uploadPaintProperties(i){this.hasData()&&this.programConfigurations.upload(i)}update(i,a,l,d,p,g){this.hasData()&&this.programConfigurations.updatePaintArrays(i,a,l,d,p,g)}updateHiddenByLandmark(i){if(!this.hasData())return;const a=i.groundVertexCount+i.groundVertexArrayOffset;if(0===i.groundVertexCount)return;const l=i.flags&ll?1:0;for(let d=i.groundVertexArrayOffset;d<a;++d)this.hiddenByLandmarkVertexArray.emplace(d,l);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(i){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=i.createVertexBuffer(this.hiddenByLandmarkVertexArray,jb.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let i=0;i<=4;i++){const a=this.regionSegments[i];a&&a.destroy()}}}}class Mf{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=i.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=i.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new rr,this.footprintVertices=new un,this.footprintSegments=[],this.layoutVertexArray=new Cn,this.centroidVertexArray=new V_,this.indexArray=new rr,this.programConfigurations=new Zc(i.layers,i.zoom,a=>Gp.includes(a)),this.segments=new Dr,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.groundEffect=new P0(i),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}populate(i,a,l,d){this.features=[],this.hasPattern=Mg("fill-extrusion",this.layers,a),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=cf(l),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:p,id:g,index:y,sourceLayerIndex:x}of i){const C=this.layers[0]._featureFilter.needGeometry,D=Gd(p,C);if(!this.layers[0]._featureFilter.filter(new Ce(this.zoom),D,l))continue;const M={id:g,sourceLayerIndex:x,index:y,geometry:C?D.geometry:eu(p,l,d),properties:p.properties,type:p.type,patterns:{}},k=this.layoutVertexArray.length;this.hasPattern?this.features.push(Vb("fill-extrusion",this.layers,M,this.zoom,a)):this.addFeature(M,M.geometry,y,l,{},a.availableImages,d,a.brightness),a.featureIndex.insert(p,M.geometry,y,x,this.index,k)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(i,a,l,d,p,g){for(const y of this.features){const{geometry:x}=y;this.addFeature(y,x,y.index,a,l,d,p,g)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles()}update(i,a,l,d,p){const g=0!==Object.keys(i).length;if(g&&!this.stateDependentLayers.length)return;const y=g?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(i,a,y,l,d,p),this.groundEffect.update(i,a,y,l,d,p)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,wT),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=i.createVertexBuffer(this.layoutVertexExtArray,Ag.members,!0)),this.groundEffect.upload(i)),this.groundEffect.uploadPaintProperties(i),this.programConfigurations.upload(i),this.uploaded=!0}uploadCentroid(i){this.groundEffect.uploadHiddenByLandmark(i),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,xT.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,a,l,d,p,g,y,x){const C=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(i,{})/this.tileToMeter,D=[new Le(0,0),new Le(Ht,Ht)],M=y.projection,k="globe"===M.name,P="Polygon"===$p[i.type],F=new k0;F.centroidDataIndex=this.centroidData.length;const B=new I0,j=this.layers[0].paint.get("fill-extrusion-base").evaluate(i,{},d)<=0,q=this.layers[0].paint.get("fill-extrusion-height").evaluate(i,{},d);B.height=q,B.vertexArrayOffset=this.layoutVertexArray.length,B.groundVertexArrayOffset=this.groundEffect.vertexArray.length,k&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new fr);const te=ra(a,500);for(let Ie=te.length-1;Ie>=0;Ie--){const Pe=te[Ie];(0===Pe.length||(ie=Pe[0]).every(Ze=>Ze.x<=0)||ie.every(Ze=>Ze.x>=Ht)||ie.every(Ze=>Ze.y<=0)||ie.every(Ze=>Ze.y>=Ht))&&te.splice(Ie,1)}var ie;let se;if(k)se=pC(te,D,d);else{se=[];for(const Ie of te)se.push({polygon:Ie,bounds:D})}const de=P?this.edgeRadius:0,pe=de>0&&this.zoom<17,Ee=(Ie,Pe)=>{if(0===Ie.length)return!1;const Ze=Ie[Ie.length-1];return Pe.x===Ze.x&&Pe.y===Ze.y};for(const{polygon:Ie,bounds:Pe}of se){let Ze=0,je=0;for(const Tt of Ie)P&&!Tt[0].equals(Tt[Tt.length-1])&&Tt.push(Tt[0]),je+=P?Tt.length-1:Tt.length;const dt=this.segments.prepareSegment((P?5:4)*je,this.layoutVertexArray,this.indexArray);B.footprintSegIdx<0&&(B.footprintSegIdx=this.footprintSegments.length),B.polygonSegIdx<0&&(B.polygonSegIdx=this.polygonSegments.length);const Pt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},st=new A0;if(st.vertexOffset=this.footprintVertices.length,st.indexOffset=3*this.footprintIndices.length,st.ringIndices=[],P){const Tt=[],et=[];Ze=dt.vertexLength;for(let on=0;on<Ie.length;on++){const It=Ie[on];It.length&&0!==on&&et.push(Tt.length/2);const On=[];let ln,Gt;ln=It[1].sub(It[0])._perp()._unit(),st.ringIndices.push(It.length-1);for(let An=1;An<It.length;An++){const dn=It[An],Tn=It[An===It.length-1?1:An+1],Bt=dn.clone();if(de){Gt=Tn.sub(dn)._perp()._unit();const Te=ln.add(Gt)._unit(),vi=de*Math.min(4,1/(ln.x*Te.x+ln.y*Te.y));Bt.x+=vi*Te.x,Bt.y+=vi*Te.y,Bt.x=Math.round(Bt.x),Bt.y=Math.round(Bt.y),ln=Gt}!j||0!==de&&!pe||Ee(On,Bt)||On.push(Bt),cu(this.layoutVertexArray,Bt.x,Bt.y,0,0,1,1,0),dt.vertexLength++,this.footprintVertices.emplaceBack(dn.x,dn.y),Tt.push(dn.x,dn.y),k&&Yp(this.layoutVertexExtArray,M.projectTilePoint(Bt.x,Bt.y,d),M.upVector(d,Bt.x,Bt.y))}j&&(0===de||pe)&&(0!==On.length&&Ee(On,On[0])&&On.pop(),this.groundEffect.addData(On,Pe,C))}const $t=ff(Tt,et);for(let on=0;on<$t.length;on+=3)this.footprintIndices.emplaceBack(st.vertexOffset+$t[on+0],st.vertexOffset+$t[on+1],st.vertexOffset+$t[on+2]),this.indexArray.emplaceBack(Ze+$t[on],Ze+$t[on+2],Ze+$t[on+1]),dt.primitiveLength++;st.indexCount+=$t.length,st.vertexCount+=this.footprintVertices.length-st.vertexOffset}for(let Tt=0;Tt<Ie.length;Tt++){const et=Ie[Tt];F.startRing(B,et[0]);let $t=et.length>4&&cS(et[et.length-2],et[0],et[1]),on=de?cI(et[et.length-2],et[0],et[1],de):0;const It=[];let On,ln,Gt;ln=et[1].sub(et[0])._perp()._unit();let An=!0;for(let dn=1,Tn=0;dn<et.length;dn++){let Bt=et[dn-1],Te=et[dn];const vi=et[dn===et.length-1?1:dn+1];if(F.appendEdge(B,Te,Bt),O0(Te,Bt,Pe)){de&&(ln=vi.sub(Te)._perp()._unit(),An=!An);continue}const Jn=Te.sub(Bt)._perp(),gi=Jn.x/(Math.abs(Jn.x)+Math.abs(Jn.y)),hn=Jn.y>0?1:0,Xn=Bt.dist(Te);if(Tn+Xn>32768&&(Tn=0),de){Gt=vi.sub(Te)._perp()._unit();let Wi=lS(Bt,Te,vi,dC(ln,Gt),de);isNaN(Wi)&&(Wi=0);const nr=Te.sub(Bt)._unit();Bt=Bt.add(nr.mult(on))._round(),Te=Te.add(nr.mult(-Wi))._round(),on=Wi,ln=Gt,j&&this.zoom>=17&&(Ee(It,Bt)||It.push(Bt),Ee(It,Te)||It.push(Te))}const Kn=dt.vertexLength,vr=et.length>4&&cS(Bt,Te,vi);let cr=fC(Tn,$t,An);if(cu(this.layoutVertexArray,Bt.x,Bt.y,gi,hn,0,0,cr),cu(this.layoutVertexArray,Bt.x,Bt.y,gi,hn,0,1,cr),Tn+=Xn,cr=fC(Tn,vr,!An),$t=vr,cu(this.layoutVertexArray,Te.x,Te.y,gi,hn,0,0,cr),cu(this.layoutVertexArray,Te.x,Te.y,gi,hn,0,1,cr),dt.vertexLength+=4,this.indexArray.emplaceBack(Kn+0,Kn+1,Kn+2),this.indexArray.emplaceBack(Kn+1,Kn+3,Kn+2),dt.primitiveLength+=2,de){const Wi=Ze+(1===dn?et.length-2:dn-2),nr=1===dn?Ze:Wi+1;if(this.indexArray.emplaceBack(Kn+1,Wi,Kn+3),this.indexArray.emplaceBack(Wi,nr,Kn+3),dt.primitiveLength+=2,void 0===On&&(On=Kn),!O0(vi,et[dn],Pe)){const Vi=dn===et.length-1?On:dt.vertexLength;this.indexArray.emplaceBack(Kn+2,Kn+3,Vi),this.indexArray.emplaceBack(Kn+3,Vi+1,Vi),this.indexArray.emplaceBack(Kn+3,nr,Vi+1),dt.primitiveLength+=3}An=!An}if(k){const Wi=this.layoutVertexExtArray,nr=M.projectTilePoint(Bt.x,Bt.y,d),Vi=M.projectTilePoint(Te.x,Te.y,d),Lr=M.upVector(d,Bt.x,Bt.y),br=M.upVector(d,Te.x,Te.y);Yp(Wi,nr,Lr),Yp(Wi,nr,Lr),Yp(Wi,Vi,br),Yp(Wi,Vi,br)}}P&&(Ze+=et.length-1),j&&de&&this.zoom>=17&&(0!==It.length&&Ee(It,It[0])&&It.pop(),this.groundEffect.addData(It,Pe,C,de>0))}this.footprintSegments.push(st),Pt.triangleCount=this.indexArray.length-Pt.triangleArrayOffset,this.polygonSegments.push(Pt),++B.footprintSegLen,++B.polygonSegLen}if(B.vertexCount=this.layoutVertexArray.length-B.vertexArrayOffset,B.groundVertexCount=this.groundEffect.vertexArray.length-B.groundVertexArrayOffset,0!==B.vertexCount){if(B.centroidXY=F.borders?Sf:this.encodeCentroid(F,B),this.centroidData.push(B),F.borders){this.featuresOnBorder.push(F);const Ie=this.featuresOnBorder.length-1;for(let Pe=0;Pe<F.borders.length;Pe++)F.borders[Pe][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Pe].push(Ie)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,l,p,g,d,x),this.groundEffect.addPaintPropertiesData(i,l,p,g,d,x),this.maxHeight=Math.max(this.maxHeight,q)}}sortBorders(){for(let i=0;i<this.borderFeatureIndices.length;i++)this.borderFeatureIndices[i].sort((a,l)=>this.featuresOnBorder[a].borders[i][0]-this.featuresOnBorder[l].borders[i][0])}splitToSubtiles(){const i=[];for(let y=0;y<this.centroidData.length;y++){const x=this.centroidData[y],C=+(x.min.y+x.max.y>Ht),D=2*C+(+(x.min.x+x.max.x>Ht)^C);for(let M=0;M<x.polygonSegLen;M++){const k=x.polygonSegIdx+M;i.push({centroidIdx:y,subtile:D,polygonSegmentIdx:k,triangleSegmentIdx:this.polygonSegments[k].triangleSegIdx})}}const a=new rr;i.sort((y,x)=>y.triangleSegmentIdx===x.triangleSegmentIdx?y.subtile-x.subtile:y.triangleSegmentIdx-x.triangleSegmentIdx);let l=0,d=0,p=0;for(const y of i){if(y.triangleSegmentIdx!==l)break;p++}const g=i.length;for(;d!==i.length;){l=i[d].triangleSegmentIdx;let y=0,x=d,C=d;for(let D=x;D<p&&i[D].subtile===y;D++)C++;for(;x!==p;){const D=i[x];y=D.subtile;const M=this.centroidData[D.centroidIdx].min.clone(),k=this.centroidData[D.centroidIdx].max.clone(),P={vertexOffset:this.segments.segments[l].vertexOffset,primitiveOffset:a.length,vertexLength:this.segments.segments[l].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let F=x;F<C;F++){const B=i[F],j=this.polygonSegments[B.polygonSegmentIdx],q=this.centroidData[B.centroidIdx].min,te=this.centroidData[B.centroidIdx].max,ie=this.indexArray.uint16;for(let se=j.triangleArrayOffset;se<j.triangleArrayOffset+j.triangleCount;se++)a.emplaceBack(ie[3*se],ie[3*se+1],ie[3*se+2]);P.primitiveLength+=j.triangleCount,M.x=Math.min(M.x,q.x),M.y=Math.min(M.y,q.y),k.x=Math.max(k.x,te.x),k.y=Math.max(k.y,te.y)}P.primitiveLength>0&&this.triangleSubSegments.push({segment:P,min:M,max:k}),x=C;for(let F=x;F<p&&i[F].subtile===i[x].subtile;F++)C++}d=p;for(let D=d;D<g&&i[D].triangleSegmentIdx===i[d].triangleSegmentIdx;D++)p++}a._trim(),this.indexArray=a}getVisibleSegments(i,a,l){let d=0,p=0;const g=1<<i.canonical.z;if(a){const B=a.getMinMaxForTile(i);B&&(d=B.min,p=B.max)}p+=this.maxHeight;const y=i.toUnwrapped();let x;const C=[y.canonical.x/g+y.wrap,y.canonical.y/g],D=[(y.canonical.x+1)/g+y.wrap,(y.canonical.y+1)/g],M=new Dr,k=(B,j,q)=>[B[0]*(1-q[0])+j[0]*q[0],B[1]*(1-q[1])+j[1]*q[1]],P=[],F=[];for(const B of this.triangleSubSegments){P[0]=B.min.x/Ht,P[1]=B.min.y/Ht,F[0]=B.max.x/Ht,F[1]=B.max.y/Ht;const j=k(C,D,P),q=k(C,D,F);if(0===new oo([j[0],j[1],d],[q[0],q[1],p]).intersectsPrecise(l)){x&&(M.segments.push(x),x=void 0);continue}const te=B.segment;x&&x.vertexOffset!==te.vertexOffset&&(M.segments.push(x),x=void 0),x?(x.vertexLength+=te.vertexLength,x.primitiveLength+=te.primitiveLength):x={vertexOffset:te.vertexOffset,primitiveLength:te.primitiveLength,vertexLength:te.vertexLength,primitiveOffset:te.primitiveOffset,sortKey:void 0,vaos:{}}}return x&&M.segments.push(x),M}encodeCentroid(i,a){const l=i.centroid(),d=a.span(),p=Math.min(7,Math.round(d.x*this.tileToMeter/10)),g=Math.min(7,Math.round(d.y*this.tileToMeter/10));return new Le(Hn(l.x,1,Ht-1)<<3|p,Hn(l.y,1,Ht-1)<<3|g)}encodeBorderCentroid(i){if(!i.borders)return new Le(0,0);const a=i.borders,l=Number.MAX_VALUE;if(a[0][0]!==l||a[1][0]!==l){const d=a[0][0]!==l?0:1;return new Le(6|(a[0][0]!==l?0:65528),((a[d][0]+a[d][1])/2|0)<<3|6)}{const d=a[2][0]!==l?2:3;return new Le(((a[d][0]+a[d][1])/2|0)<<3|6,6|(a[2][0]!==l?0:65528))}}showCentroid(i){const a=this.centroidData[i.centroidDataIndex];a.flags&=ll,a.centroidXY.x=0,a.centroidXY.y=0,this.writeCentroidToBuffer(a)}writeCentroidToBuffer(i){this.groundEffect.updateHiddenByLandmark(i);const a=i.vertexArrayOffset,l=i.vertexCount+i.vertexArrayOffset,d=i.flags&ll?Sf:i.centroidXY,p=this.centroidVertexArray.geta_centroid_pos0(a);if(this.centroidVertexArray.geta_centroid_pos1(a)!==d.y||p!==d.x){for(let g=a;g<l;++g)this.centroidVertexArray.emplace(g,d.x,d.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const i of this.centroidData)this.writeCentroidToBuffer(i)}updateReplacement(i,a){if(a.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=a.updateTime;const l=a.getReplacementRegionsForTile(i.toUnwrapped());if(function(p,g){if(p.length!==g.length)return!1;for(let y=0;y<p.length;y++)if(p[y].sourceId!==g[y].sourceId||!Ds(p[y],g[y]))return!1;return!0}(this.activeReplacements,l))return;if(this.activeReplacements=l,0===this.centroidVertexArray.length)this.createCentroidsBuffer();else for(const p of this.centroidData)p.flags&=2147483647;const d=[];for(const p of this.activeReplacements){const g=Math.pow(2,p.footprintTileId.canonical.z-i.canonical.z);for(const y of this.centroidData)if(!(y.flags&ll||p.min.x>y.max.x||y.min.x>p.max.x||p.min.y>y.max.y||y.min.y>p.max.y))for(let x=0;x<y.footprintSegLen;x++){const C=this.footprintSegments[y.footprintSegIdx+x];if(d.length=0,dS(this.footprintVertices,C.vertexOffset,C.vertexCount,p.footprintTileId.canonical,i.canonical,d),Fr(p.footprint,d,this.footprintIndices.uint16,C.indexOffset,C.indexCount,-C.vertexOffset,-g)){y.flags|=ll;break}}}for(const p of this.centroidData)this.writeCentroidToBuffer(p);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(i,a,l){let d=!1;for(let p=0;p<l.footprintSegLen;p++){const g=this.footprintSegments[l.footprintSegIdx+p];let y=0;for(const x of g.ringIndices){for(let C=y,D=x+y-1;C<x+y;D=C++){const M=this.footprintVertices.int16[2*(C+g.vertexOffset)+0],k=this.footprintVertices.int16[2*(C+g.vertexOffset)+1],P=this.footprintVertices.int16[2*(D+g.vertexOffset)+1];k>a!=P>a&&i<(this.footprintVertices.int16[2*(D+g.vertexOffset)+0]-M)*(a-k)/(P-k)+M&&(d=!d)}y=x}}return d}getHeightAtTileCoord(i,a){let l=Number.NEGATIVE_INFINITY,d=!0;const p=4*(i+Ht)*Ht+(a+Ht);if(this.partLookup.hasOwnProperty(p)){const g=this.partLookup[p];return g?{height:g.height,hidden:!!(g.flags&ll)}:void 0}for(const g of this.centroidData)i>g.max.x||g.min.x>i||a>g.max.y||g.min.y>a||this.footprintContainsPoint(i,a,g)&&g&&g.height>l&&(l=g.height,this.partLookup[p]=g,d=!!(g.flags&ll));if(l!==Number.NEGATIVE_INFINITY)return{height:l,hidden:d};this.partLookup[p]=void 0}}function dC(o,i){const a=o.add(i)._unit();return o.x*a.x+o.y*a.y}function cI(o,i,a,l){const d=i.sub(o)._perp()._unit(),p=a.sub(i)._perp()._unit();return lS(o,i,a,dC(d,p),l)}function lS(o,i,a,l,d){const p=Math.sqrt(1-l*l);return Math.min(o.dist(i)/3,i.dist(a)/3,d*p/l)}function O0(o,i,a){return o.x<a[0].x&&i.x<a[0].x||o.x>a[1].x&&i.x>a[1].x||o.y<a[0].y&&i.y<a[0].y||o.y>a[1].y&&i.y>a[1].y}function hC(o,i){return o.x<i[0].x||o.x>i[1].x||o.y<i[0].y||o.y>i[1].y}function cS(o,i,a){if(o.x<0||o.x>=Ht||i.x<0||i.x>=Ht||a.x<0||a.x>=Ht)return!1;const l=a.sub(i),d=l.perp(),p=o.sub(i);return(l.x*p.x+l.y*p.y)/Math.sqrt((l.x*l.x+l.y*l.y)*(p.x*p.x+p.y*p.y))>-.866&&d.x*p.x+d.y*p.y<0}function fC(o,i,a){const l=i?2|o:-3&o;return a?1|l:-2&l}function uS(){const o=Math.PI/32,i=Math.tan(o),a=vg;return a*Math.sqrt(1+2*i*i)-a}function pC(o,i,a){const l=1<<a.z,d=Ia(a.x/l),p=Ia((a.x+1)/l),g=os(a.y/l),y=os((a.y+1)/l);return function(x,C,D,M,k=0,P){const F=[];if(!x.length||!D||!M)return F;const B=(pe,Ee)=>{for(const Ie of pe)F.push({polygon:Ie,bounds:Ee})},j=Math.ceil(Math.log2(D)),q=Math.ceil(Math.log2(M)),te=j-q,ie=[];for(let pe=0;pe<Math.abs(te);pe++)ie.push(te>0?0:1);for(let pe=0;pe<Math.min(j,q);pe++)ie.push(0),ie.push(1);let se=x;if(se=Sp(se,C[0].y-k,C[1].y+k,1),se=Sp(se,C[0].x-k,C[1].x+k,0),!se.length)return F;const de=[];for(ie.length?de.push({polygons:se,bounds:C,depth:0}):B(se,C);de.length;){const pe=de.pop(),Ee=pe.depth,Ie=ie[Ee],Pe=pe.bounds[0],Ze=pe.bounds[1],je=0===Ie?Pe.x:Pe.y,dt=0===Ie?Ze.x:Ze.y,Pt=P?P(Ie,je,dt):.5*(je+dt),st=Sp(pe.polygons,je-k,Pt+k,Ie),Tt=Sp(pe.polygons,Pt-k,dt+k,Ie);if(st.length){const et=[Pe,new Le(0===Ie?Pt:Ze.x,1===Ie?Pt:Ze.y)];ie.length>Ee+1?de.push({polygons:st,bounds:et,depth:Ee+1}):B(st,et)}if(Tt.length){const et=[new Le(0===Ie?Pt:Pe.x,1===Ie?Pt:Pe.y),Ze];ie.length>Ee+1?de.push({polygons:Tt,bounds:et,depth:Ee+1}):B(Tt,et)}}return F}(o,i,Math.ceil((p-d)/11.25),Math.ceil((g-y)/11.25),1,(x,C,D)=>{if(0===x)return.5*(C+D);{const M=os((a.y+C/Ht)/l);return(Nl(.5*(os((a.y+D/Ht)/l)+M))*l-a.y)*Ht}})}function dS(o,i,a,l,d,p){const g=Math.pow(2,l.z-d.z);for(let y=0;y<a;y++){let x=o.int16[2*(y+i)+0],C=o.int16[2*(y+i)+1];x=(x+d.x*Ht)*g-l.x*Ht,C=(C+d.y*Ht)*g-l.y*Ht,p.push(new Le(x,C))}}rn(Mf,"FillExtrusionBucket",{omit:["layers","features"]}),rn(I0,"PartData"),rn(A0,"FootprintSegment"),rn(k0,"BorderCentroidData"),rn(P0,"GroundEffect");const hS=new vt({visibility:new fe(He["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new fe(He["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var F0={paint:new vt({"fill-extrusion-opacity":new fe(He["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ne(He["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new fe(He["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new fe(He["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ne(He["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ne(He["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ne(He["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new fe(He["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new fe(He["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new fe(He["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new fe(He["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new fe(He["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new fe(He["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new fe(He["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new fe(He["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Ne(He["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Ne(He["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new fe(He["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new fe(He["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new fe(He["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new fe(He["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new fe(He["paint_fill-extrusion"]["fill-extrusion-emissive-strength"])}),layout:hS};class uu extends Le{constructor(i,a,l){super(i,a),this.z=l}}function Af(o,i){return o.x*i.x+o.y*i.y}function Jg(o,i){if(1===o.length){let a=0;const l=i[a++];let d;for(;!d||l.equals(d);)if(d=i[a++],!d)return 1/0;for(;a<i.length;a++){const p=i[a],g=o[0],y=d.sub(l),x=p.sub(l),C=g.sub(l),D=Af(y,y),M=Af(y,x),k=Af(x,x),P=Af(C,y),F=Af(C,x),B=D*k-M*M,j=(k*P-M*F)/B,q=(D*F-M*P)/B,te=l.z*(1-j-q)+d.z*j+p.z*q;if(isFinite(te))return te}return 1/0}{let a=1/0;for(const l of i)a=Math.min(a,l.z);return a}}function L0(o,i,a,l,d,p,g,y){const x=g*d.getElevationAt(o,i,!0,!0),C=0!==p[0],D=C?0===p[1]?g*(p[0]/7-450):g*function(M,k,P){const F=Math.floor(k[0]/8),B=Math.floor(k[1]/8),j=10*(k[0]-8*F),q=10*(k[1]-8*B),te=M.getElevationAt(F,B,!0,!0),ie=M.getMeterToDEM(P),se=Math.floor(.5*(j*ie-1)),de=Math.floor(.5*(q*ie-1)),pe=M.tileCoordToPixel(F,B),Ee=2*se+1,Ie=2*de+1,Pe=(on=Ee,It=Ie,[(Tt=M).getElevationAtPixel(et=pe.x-se,$t=pe.y-de,!0),Tt.getElevationAtPixel(et+It,$t,!0),Tt.getElevationAtPixel(et,$t+It,!0),Tt.getElevationAtPixel(et+on,$t+It,!0)]),Ze=Math.abs(Pe[0]-Pe[1]),je=Math.abs(Pe[2]-Pe[3]),dt=Math.abs(Pe[0]-Pe[2])+Math.abs(Pe[1]-Pe[3]),Pt=Math.min(.25,.5*ie*(Ze+je)/Ee),st=Math.min(.25,.5*ie*dt/Ie);var Tt,et,$t,on,It;return te+Math.max(Pt*j,st*q)}(d,p,y):x;return{base:x+(0===a)?-1:a,top:C?Math.max(D+l,x+a+2):x+l}}const e_=new vt({"line-cap":new Ne(He.layout_line["line-cap"]),"line-join":new Ne(He.layout_line["line-join"]),"line-miter-limit":new fe(He.layout_line["line-miter-limit"]),"line-round-limit":new fe(He.layout_line["line-round-limit"]),"line-sort-key":new Ne(He.layout_line["line-sort-key"]),visibility:new fe(He.layout_line.visibility)});var N0={paint:new vt({"line-opacity":new Ne(He.paint_line["line-opacity"]),"line-color":new Ne(He.paint_line["line-color"]),"line-translate":new fe(He.paint_line["line-translate"]),"line-translate-anchor":new fe(He.paint_line["line-translate-anchor"]),"line-width":new Ne(He.paint_line["line-width"]),"line-gap-width":new Ne(He.paint_line["line-gap-width"]),"line-offset":new Ne(He.paint_line["line-offset"]),"line-blur":new Ne(He.paint_line["line-blur"]),"line-dasharray":new Ne(He.paint_line["line-dasharray"]),"line-pattern":new Ne(He.paint_line["line-pattern"]),"line-gradient":new At(He.paint_line["line-gradient"]),"line-trim-offset":new fe(He.paint_line["line-trim-offset"]),"line-emissive-strength":new fe(He.paint_line["line-emissive-strength"]),"line-border-width":new Ne(He.paint_line["line-border-width"]),"line-border-color":new Ne(He.paint_line["line-border-color"])}),layout:e_};function mC(o,i){return 1/rC(o,1,i.tileZoom)}function Xp(o,i,a,l){return o.translatePosMatrix(l||i.tileID.projMatrix,i,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const gC=o=>{const i=[];_C(o)&&i.push("RENDER_LINE_DASH"),o.paint.get("line-gradient")&&i.push("RENDER_LINE_GRADIENT");const a=o.paint.get("line-trim-offset");return 0===a[0]&&0===a[1]||i.push("RENDER_LINE_TRIM_OFFSET"),0!==o.paint.get("line-border-width").constantOr(1)&&i.push("RENDER_LINE_BORDER"),i};function _C(o){const i=o.paint.get("line-dasharray").value;return i.value||"constant"!==i.kind}const yC=new class extends Ne{possiblyEvaluate(o,i){return i=new Ce(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,transition:i.transition}),super.possiblyEvaluate(o,i)}evaluate(o,i,a,l){return i=Gr({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(o,i,a,l)}}(N0.paint.properties["line-width"].specification);function vC(o,i){return i>0?i+2*o:o}yC.useIntegerZoom=!0;const B0=new vt({visibility:new fe(He.layout_background.visibility)});var Wy={paint:new vt({"background-color":new fe(He.paint_background["background-color"]),"background-pattern":new fe(He.paint_background["background-pattern"]),"background-opacity":new fe(He.paint_background["background-opacity"]),"background-emissive-strength":new fe(He.paint_background["background-emissive-strength"])}),layout:B0};const Zy=new vt({visibility:new fe(He.layout_raster.visibility)});var uI={paint:new vt({"raster-opacity":new fe(He.paint_raster["raster-opacity"]),"raster-color":new At(He.paint_raster["raster-color"]),"raster-color-mix":new fe(He.paint_raster["raster-color-mix"]),"raster-color-range":new fe(He.paint_raster["raster-color-range"]),"raster-hue-rotate":new fe(He.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new fe(He.paint_raster["raster-brightness-min"]),"raster-brightness-max":new fe(He.paint_raster["raster-brightness-max"]),"raster-saturation":new fe(He.paint_raster["raster-saturation"]),"raster-contrast":new fe(He.paint_raster["raster-contrast"]),"raster-resampling":new fe(He.paint_raster["raster-resampling"]),"raster-fade-duration":new fe(He.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new fe(He.paint_raster["raster-emissive-strength"]),"raster-array-band":new fe(He.paint_raster["raster-array-band"]),"raster-elevation":new fe(He.paint_raster["raster-elevation"])}),layout:Zy};function Yy(o,i,a,l,d,p,g,y){const x=[o,i,1,a,l,1,d,p,1],C=[g,y,1],D=h.bx.adjoint([],x),[M,k,P]=h.v.transformMat3(C,C,D);return h.bx.multiply(x,x,[M,0,0,0,k,0,0,0,P])}function bC(o,i,a,l,d,p,g,y){const x=function(C,D,M,k,P,F,B,j){const q=Yy(0,0,1,0,1,1,0,1),te=Yy(C,D,M,k,P,F,B,j),ie=h.bx.adjoint([],q);return h.bx.multiply(te,te,ie)}(o,i,a,l,d,p,g,y);return[x[2]/x[8]/Ht,x[5]/x[8]/Ht]}function Kp(o){return[o[0],Math.min(Math.max(o[1],-so),so)]}class xC extends pa{constructor(i,a,l,d){super(),this.id=i,this.dispatcher=l,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(d),this.options=a,this._dirty=!1}load(i,a){if(this._loaded=a||!1,this.fire(new Ao("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return i&&(this.coordinates=i),this._loaded=!0,void this._finishLoading();this._imageRequest=rt(this.map._requestManager.transformRequest(this.url,qr.Image),(l,d)=>{this._imageRequest=null,this._loaded=!0,l?this.fire(new Xl(l)):d&&(this.image=d instanceof HTMLImageElement?uo.getImageData(d):d,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,i&&(this.coordinates=i),this._finishLoading())})}loaded(){return this._loaded}updateImage(i){return i.url?(this._imageRequest&&i.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=i.url,this.load(i.coordinates,this._loaded),this):this}setTexture(i){if(!(i.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new qg(this.map.painter.context,i.handle),this.width=i.dimensions[0],this.height=i.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Ao("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof qg||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(i){if(this.coordinates=i,this._boundsArray=void 0,this._unsupportedCoords=!1,!i.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let a=i[0][1],l=i[0][1];for(const p of i)p[1]>l&&(l=p[1]),p[1]<a&&(a=p[1]);const d=(l+a)/2;if(d>so?this.onNorthPole=!0:d<-so&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const p=i.map(Ko.fromLngLat);this.tileID=function(g){let y=1/0,x=1/0,C=-1/0,D=-1/0;for(const B of g)y=Math.min(y,B.x),x=Math.min(x,B.y),C=Math.max(C,B.x),D=Math.max(D,B.y);const M=Math.max(C-y,D-x),k=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),P=Math.pow(2,k);let F=Math.floor((y+C)/2*P);return F>1&&(F-=1),new nf(k,F,Math.floor((x+D)/2*P))}(p),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Ao("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(i){for(const j in this.tiles){const q=this.tiles[j];"loaded"!==q.state&&(q.state="loaded",q.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const a=ru(new nf(0,0,0),this.map.transform.projection),l=[a.projection.project(this.coordinates[0][0],this.coordinates[0][1]),a.projection.project(this.coordinates[1][0],this.coordinates[1][1]),a.projection.project(this.coordinates[2][0],this.coordinates[2][1]),a.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(j){const q=j[1].x-j[0].x,te=j[1].y-j[0].y,ie=j[2].x-j[1].x,se=j[2].y-j[1].y,de=j[3].x-j[2].x,pe=j[3].y-j[2].y,Ee=j[0].x-j[3].x,Ie=j[0].y-j[3].y,Pe=q*se-ie*te,Ze=ie*pe-de*se,je=de*Ie-Ee*pe,dt=Ee*te-q*Ie;return Pe>0&&Ze>0&&je>0&&dt>0||Pe<0&&Ze<0&&je<0&&dt<0}(l))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const d=ru(this.tileID,this.map.transform.projection),[p,g,y,x]=this.coordinates.map(j=>{const q=d.projection.project(j[0],j[1]);return Ay(d,q)._round()});this.perspectiveTransform=bC(p.x,p.y,g.x,g.y,y.x,y.y,x.x,x.y);const C=this._boundsArray=new Cn;C.emplaceBack(p.x,p.y,0,0),C.emplaceBack(g.x,g.y,Ht,0),C.emplaceBack(x.x,x.y,0,Ht),C.emplaceBack(y.x,y.y,Ht,Ht),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=i.createVertexBuffer(C,Ny.members),this.boundsSegments=Dr.simpleSegment(0,0,4,2);const D=[],M=[Kp((j=this.coordinates)[0]),Kp(j[1]),Kp(j[2]),Kp(j[3])],[k,P,F,B]=function(j){let q=j[0][0],te=q,ie=j[0][1],se=ie;for(let de=1;de<j.length;de++)j[de][0]<q?q=j[de][0]:j[de][0]>te&&(te=j[de][0]),j[de][1]<ie?ie=j[de][1]:j[de][1]>se&&(se=j[de][1]);return[q,ie,te-q,se-ie]}(M);var j;{const j=new Cn,[q,te,ie,se]=function(et){let $t=et[0].x,on=$t,It=et[0].y,On=It;for(let ln=1;ln<et.length;ln++)et[ln].x<$t?$t=et[ln].x:et[ln].x>on&&(on=et[ln].x),et[ln].y<It?It=et[ln].y:et[ln].y>On&&(On=et[ln].y);return[$t,It,on-$t,On-It]}(l),de=et=>[(et.x-q)/ie,(et.y-te)/se],[pe,Ee,Ie,Pe]=l.map(de),Ze=function(et,$t,on,It,On,ln,Gt,An){const dn=Yy(0,0,1,0,1,1,0,1),Tn=Yy(et,$t,on,It,On,ln,Gt,An),Bt=h.bx.adjoint([],Tn);return h.bx.multiply(dn,dn,Bt)}(pe[0],pe[1],Ee[0],Ee[1],Ie[0],Ie[1],Pe[0],Pe[1]);this.elevatedGlobePerspectiveTransform=bC(pe[0],pe[1],Ee[0],Ee[1],Ie[0],Ie[1],Pe[0],Pe[1]);const je=(et,$t)=>{D.push(et.lng);const on=Math.round((et.lng-k)/F*Ht),It=Math.round((et.lat-P)/B*Ht),On=de($t),ln=h.v.transformMat3([],[On[0],On[1],1],Ze),Gt=Math.round(ln[0]/ln[2]*Ht),An=Math.round(ln[1]/ln[2]*Ht);j.emplaceBack(on,It,Gt,An)},dt=l[3].x-l[0].x,Pt=l[3].y-l[0].y,st=l[2].x-l[1].x,Tt=l[2].y-l[1].y;for(let et=0;et<65;et++){const $t=et/64,on=[l[0].x+$t*dt,l[0].y+$t*Pt],It=[l[1].x+$t*st,l[1].y+$t*Tt],On=It[0]-on[0],ln=It[1]-on[1];for(let Gt=0;Gt<65;Gt++){const An=Gt/64,dn={x:on[0]+On*An,y:on[1]+ln*An,z:0};je(a.projection.unproject(dn.x,dn.y),dn)}}this.elevatedGlobeVertexBuffer=i.createVertexBuffer(j,Ny.members)}{this.maxLongitudeTriangleSize=0;let j=[],q=new rr;const te=(ie,se,de)=>{q.emplaceBack(ie,se,de);const pe=D[ie],Ee=D[se],Ie=D[de],Pe=Math.min(Math.min(pe,Ee),Ie),Ze=Math.max(Math.max(pe,Ee),Ie)-Pe;Ze>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Ze),j.push(Pe+Ze/2)};for(let ie=0;ie<64;ie++)for(let se=0;se<64;se++){const de=65*ie+se,pe=de+1,Ee=de+65,Ie=Ee+1;te(de,Ee,pe),te(pe,Ee,Ie)}[j,q]=function(ie,se){const de=Array.from({length:ie.length},(Ie,Pe)=>Pe);de.sort((Ie,Pe)=>ie[Ie]-ie[Pe]);const pe=[],Ee=new rr;for(let Ie=0;Ie<de.length;Ie++){const Pe=de[Ie];pe.push(ie[Pe]);const Ze=3*Pe,je=Ze+1;Ee.emplaceBack(se.uint16[Ze],se.uint16[je],se.uint16[je+1])}return[pe,Ee]}(j,q),this.elevatedGlobeTrianglesCenterLongitudes=j,this.elevatedGlobeIndexBuffer=i.createIndexBuffer(q)}this.elevatedGlobeSegments=Dr.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,F/Ht,0,B/Ht,0,0,P,k,0])}prepare(){const i=0!==Object.keys(this.tiles).length;if(this.tileID&&!i)return;const a=this.map.painter.context,l=a.gl;!this._dirty||this.texture instanceof qg||(this.texture?this.texture.update(this.image):(this.texture=new ou(a,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this._dirty=!1),i&&this._prepareData(a)}loadTile(i,a){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},a(null)):(i.state="errored",a(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(i){const a=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!a)return null;const l=this.elevatedGlobeTrianglesCenterLongitudes;let d=(D=i+180)+360*Math.round((l[0]-D)/360);var D;const p=new Dr,g=(D,M)=>{p.segments.push({vertexOffset:0,primitiveOffset:D,vertexLength:a.segments[0].vertexLength,primitiveLength:M,sortKey:void 0,vaos:{}})},y=.51*this.maxLongitudeTriangleSize;if(Math.abs(l[0]-d)<=y){const D=En(l,0,l.length,d+y);return D===l.length||g(D,kt(l,D+1,l.length,d+360-y)-D),p}d<l[0]&&(d+=360);const x=kt(l,0,l.length,d-y);if(x===l.length)return g(0,l.length),p;g(0,x-0);const C=En(l,x+1,l.length,d+y);return C!==l.length&&g(C,l.length-C),p}}class wC extends nn{constructor(i,a){super(i,{},a),this.implementation=i,i.slot&&(this.slot=i.slot)}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(i){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)}onRemove(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)}}const fS=new vt({visibility:new fe(He.layout_sky.visibility)});var pS={paint:new vt({"sky-type":new fe(He.paint_sky["sky-type"]),"sky-atmosphere-sun":new fe(He.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new fe(He.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new fe(He.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new fe(He.paint_sky["sky-gradient-radius"]),"sky-gradient":new At(He.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new fe(He.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new fe(He.paint_sky["sky-atmosphere-color"]),"sky-opacity":new fe(He.paint_sky["sky-opacity"])}),layout:fS};function Ln(o,i,a){const l=[0,0,1],d=h.q.identity([]);return h.q.rotateY(d,d,a?-Et(o)+Math.PI:Et(o)),h.q.rotateX(d,d,-Et(i)),h.v.transformQuat(l,l,d),h.v.normalize(l,l)}var CC={paint:new vt({})};const EC={circle:class extends nn{constructor(o,i,a){super(o,Ob,i,a)}createBucket(o){return new kb(o)}queryRadius(o){const i=o;return hf("circle-radius",this,i)+hf("circle-stroke-width",this,i)+xg(this.paint.get("circle-translate"))}queryIntersectsFeature(o,i,a,l,d,p,g,y){const x=lT(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),p.angle,o.pixelToTileUnitsFactor),C=this.paint.get("circle-radius").evaluate(i,a)+this.paint.get("circle-stroke-width").evaluate(i,a);return uT(o,l,p,g,y,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),x,C)}getProgramIds(){return["circle"]}getDefaultProgramParams(o,i){const a=cT(this);return{config:new Wc(this,i),defines:a,overrideFog:!1}}},heatmap:class extends nn{createBucket(o){return new mw(o)}constructor(o,i,a){super(o,fT,i,a),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){"heatmap-color"===o&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=qd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(o){return hf("heatmap-radius",this,o)}queryIntersectsFeature(o,i,a,l,d,p,g,y){const x=this.paint.get("heatmap-radius").evaluate(i,a);return uT(o,l,p,g,y,!0,!0,new Le(0,0),x)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(o,i){return"heatmap"===o?{config:new Wc(this,i),overrideFog:!1}:{}}},hillshade:class extends nn{constructor(o,i,a){super(o,pT,i,a)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(o,i){return{overrideFog:!1}}},fill:class extends nn{constructor(o,i,a){super(o,Dp,i,a)}getProgramIds(){const o=this.paint.get("fill-pattern"),i=o&&o.constantOr(1),a=[i?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&a.push(i&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),a}getDefaultProgramParams(o,i){return{config:new Wc(this,i),overrideFog:!1}}recalculate(o,i){super.recalculate(o,i);const a=this.paint._values["fill-outline-color"];"constant"===a.value.kind&&void 0===a.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(o){return new yy(o)}queryRadius(){return xg(this.paint.get("fill-translate"))}queryIntersectsFeature(o,i,a,l,d,p){return!o.queryGeometry.isAboveHorizon&&cw(aT(o.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),p.angle,o.pixelToTileUnitsFactor),l)}isTileClipped(){return!0}},"fill-extrusion":class extends nn{constructor(o,i,a){super(o,F0,i,a),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(o){return new Mf(o)}queryRadius(){return xg(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(o,i,a,l,d,p,g,y,x){const C=lT(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),p.angle,o.pixelToTileUnitsFactor),D=this.paint.get("fill-extrusion-height").evaluate(i,a),M=this.paint.get("fill-extrusion-base").evaluate(i,a),k=[0,0],P=y&&p.elevation,F=p.elevation?p.elevation.exaggeration():1,B=o.tile.getBucket(this);if(P&&B instanceof Mf){const se=B.centroidVertexArray,de=x+1;de<se.length&&(k[0]=se.geta_centroid_pos0(de),k[1]=se.geta_centroid_pos1(de))}if(0===k[0]&&1===k[1])return!1;"globe"===p.projection.name&&(l=pC([l],[new Le(0,0),new Le(Ht,Ht)],o.tileID.canonical).map(se=>se.polygon).flat());const j=P?y:null,[q,te]=(de=l,pe=M,Ee=D,Ie=C,Pe=g,Ze=j,je=k,dt=F,Pt=p.center.lat,"globe"===(se=p).projection.name?function(Tt,et,$t,on,It,On,ln,Gt,An,dn,Tn){const Bt=[],Te=[],vi=Tt.projection.upVectorScale(Tn,Tt.center.lat,Tt.worldSize).metersToTile,Jn=[0,0,0,1],gi=[0,0,0,1],hn=(Kn,vr,cr,Wi)=>{Kn[0]=vr,Kn[1]=cr,Kn[2]=Wi,Kn[3]=1},Xn=uS();$t>0&&($t+=Xn),on+=Xn;for(const Kn of et){const vr=[],cr=[];for(const Wi of Kn){const nr=Wi.x+It.x,Vi=Wi.y+It.y,Lr=Tt.projection.projectTilePoint(nr,Vi,Tn),br=Tt.projection.upVector(Tn,Wi.x,Wi.y);let ao=$t,Vo=on;if(ln){const Vs=L0(nr,Vi,$t,on,ln,Gt,An,dn);ao+=Vs.base,Vo+=Vs.top}0!==$t?hn(Jn,Lr.x+br[0]*vi*ao,Lr.y+br[1]*vi*ao,Lr.z+br[2]*vi*ao):hn(Jn,Lr.x,Lr.y,Lr.z),hn(gi,Lr.x+br[0]*vi*Vo,Lr.y+br[1]*vi*Vo,Lr.z+br[2]*vi*Vo),h.v.transformMat4(Jn,Jn,On),h.v.transformMat4(gi,gi,On),vr.push(new uu(Jn[0],Jn[1],Jn[2])),cr.push(new uu(gi[0],gi[1],gi[2]))}Bt.push(vr),Te.push(cr)}return[Bt,Te]}(se,de,pe,Ee,Ie,Pe,Ze,je,dt,Pt,o.tileID.canonical):Ze?function(Tt,et,$t,on,It,On,ln,Gt,An){const dn=[],Tn=[],Bt=[0,0,0,1];for(const Te of Tt){const vi=[],Jn=[];for(const gi of Te){const hn=gi.x+on.x,Xn=gi.y+on.y,Kn=L0(hn,Xn,et,$t,On,ln,Gt,An);Bt[0]=hn,Bt[1]=Xn,Bt[2]=Kn.base,Bt[3]=1,h.e.transformMat4(Bt,Bt,It),Bt[3]=Math.max(Bt[3],1e-5);const vr=new uu(Bt[0]/Bt[3],Bt[1]/Bt[3],Bt[2]/Bt[3]);Bt[0]=hn,Bt[1]=Xn,Bt[2]=Kn.top,Bt[3]=1,h.e.transformMat4(Bt,Bt,It),Bt[3]=Math.max(Bt[3],1e-5);const cr=new uu(Bt[0]/Bt[3],Bt[1]/Bt[3],Bt[2]/Bt[3]);vi.push(vr),Jn.push(cr)}dn.push(vi),Tn.push(Jn)}return[dn,Tn]}(de,pe,Ee,Ie,Pe,Ze,je,dt,Pt):function(Tt,et,$t,on,It){const On=[],ln=[],Gt=It[8]*et,An=It[9]*et,dn=It[10]*et,Tn=It[11]*et,Bt=It[8]*$t,Te=It[9]*$t,vi=It[10]*$t,Jn=It[11]*$t;for(const gi of Tt){const hn=[],Xn=[];for(const Kn of gi){const vr=Kn.x+on.x,cr=Kn.y+on.y,Wi=It[0]*vr+It[4]*cr+It[12],nr=It[1]*vr+It[5]*cr+It[13],Vi=It[2]*vr+It[6]*cr+It[14],Lr=It[3]*vr+It[7]*cr+It[15],br=Wi+Gt,ao=nr+An,Vo=Vi+dn,Vs=Math.max(Lr+Tn,1e-5),mo=Wi+Bt,Kr=nr+Te,Ts=Vi+vi,Ss=Math.max(Lr+Jn,1e-5);hn.push(new uu(br/Vs,ao/Vs,Vo/Vs)),Xn.push(new uu(mo/Ss,Kr/Ss,Ts/Ss))}On.push(hn),ln.push(Xn)}return[On,ln]}(de,pe,Ee,Ie,Pe)),ie=o.queryGeometry;var se,de,pe,Ee,Ie,Pe,Ze,je,dt,Pt;return function(se,de,pe){let Ee=1/0;cw(pe,de)&&(Ee=Jg(pe,de[0]));for(let Ie=0;Ie<de.length;Ie++){const Pe=de[Ie],Ze=se[Ie];for(let je=0;je<Pe.length-1;je++){const dt=Pe[je],Pt=[dt,Pe[je+1],Ze[je+1],Ze[je],dt];lw(pe,Pt)&&(Ee=Math.min(Ee,Jg(pe,Pt)))}}return Ee!==1/0&&Ee}(q,te,ie.isPointQuery()?ie.screenBounds:ie.screenGeometry)}},line:class extends nn{constructor(o,i,a){super(o,N0,i,a),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(o){if("line-gradient"===o){const i=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=i._styleExpression&&i._styleExpression.expression instanceof kh,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(o,i){super.recalculate(o,i),this.paint._values["line-floorwidth"]=yC.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,o)}createBucket(o){return new x0(o)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(o,i){const a=gC(this);return{config:new Wc(this,i),defines:a,overrideFog:!1}}queryRadius(o){const i=o,a=vC(hf("line-width",this,i),hf("line-gap-width",this,i)),l=hf("line-offset",this,i);return a/2+Math.abs(l)+xg(this.paint.get("line-translate"))}queryIntersectsFeature(o,i,a,l,d,p){if(o.queryGeometry.isAboveHorizon)return!1;const g=aT(o.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),p.angle,o.pixelToTileUnitsFactor),y=o.pixelToTileUnitsFactor/2*vC(this.paint.get("line-width").evaluate(i,a),this.paint.get("line-gap-width").evaluate(i,a)),x=this.paint.get("line-offset").evaluate(i,a);return x&&(l=function(C,D){const M=[],k=new Le(0,0);for(let P=0;P<C.length;P++){const F=C[P],B=[];for(let j=0;j<F.length;j++){const q=F[j],te=F[j+1],ie=0===j?k:q.sub(F[j-1])._unit()._perp(),se=j===F.length-1?k:te.sub(q)._unit()._perp(),de=ie._add(se)._unit();de._mult(1/(de.x*se.x+de.y*se.y)),B.push(de._mult(D)._add(q))}M.push(B)}return M}(l,x*o.pixelToTileUnitsFactor)),function(C,D,M){for(let k=0;k<D.length;k++){const P=D[k];if(C.length>=3)for(let F=0;F<P.length;F++)if(df(C,P[F]))return!0;if(sT(C,P,M))return!0}return!1}(g,l,y)}isTileClipped(){return!0}},symbol:$g,background:class extends nn{constructor(o,i,a){super(o,Wy,i,a)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(o,i){return{overrideFog:!1}}},raster:class extends nn{constructor(o,i,a){super(o,uI,i,a),this._updateColorRamp()}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}isLayerDraped(o){return!(o&&o._source instanceof xC)||!o._source.onNorthPole&&!o._source.onSouthPole&&0===this.paint.get("raster-elevation")}_handleSpecialPaintPropertyUpdate(o){"raster-color"!==o&&"raster-color-range"!==o||this._updateColorRamp()}_updateColorRamp(){if(!this.hasColorMap())return;const o=this._transitionablePaint._values["raster-color"].value.expression,[i,a]=this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0});this.colorRamp=qd({expression:o,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:i,end:a}],resolution:256}),this.colorRampTexture=null}},sky:class extends nn{constructor(o,i,a){super(o,pS,i,a),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){"sky-gradient"===o?this._updateColorRamp():"sky-atmosphere-sun"!==o&&"sky-atmosphere-halo-color"!==o&&"sky-atmosphere-color"!==o&&"sky-atmosphere-sun-intensity"!==o||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=qd({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(o){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const i=o.style.light.properties.get("position");return this._lightPosition.azimuthal!==i.azimuthal||this._lightPosition.polar!==i.polar}return!1}getCenter(o,i){if("atmosphere"===this.paint.get("sky-type")){const l=this.paint.get("sky-atmosphere-sun"),d=!l,p=o.style.light,g=p.properties.get("position");return d&&"viewport"===p.properties.get("anchor")&&ar("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),d?Ln(g.azimuthal,90-g.polar,i):Ln(l[0],90-l[1],i)}const a=this.paint.get("sky-gradient-center");return Ln(a[0],90-a[1],i)}isSky(){return!0}markSkyboxValid(o){this._skyboxInvalidated=!1,this._lightPosition=o.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const o=this.paint.get("sky-type");return"atmosphere"===o?["skyboxCapture","skybox"]:"gradient"===o?["skyboxGradient"]:null}},slot:class extends nn{constructor(o,i,a){super(o,CC,i)}},model:class extends nn{constructor(o,i,a){super(o,lI,i,a)}createBucket(o){return new M0(o)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(){return 0}queryIntersectsFeature(){return!1}_handleOverridablePaintPropertyUpdate(o,i,a){return!(!this.layout||i.isDataDriven()||a.isDataDriven()||"model-color"!==o&&"model-color-mix-intensity"!==o&&"model-rotation"!==o&&"model-scale"!==o&&"model-translation"!==o&&"model-emissive-strength"!==o)}_isPropertyZoomDependent(o){const i=this._transitionablePaint._values[o];return null!=i&&null!=i.value&&null!=i.value.expression&&i.value.expression instanceof np}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}}};class mS{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class gS{constructor(){this.tasks={},this.taskQueue=[],ai(["process"],this),this.invoker=new mS(this.process),this.nextId=0}add(i,a){const l=this.nextId++,d=function({type:p,isSymbolTile:g,zoom:y}){return y=y||0,"message"===p?0:"maybePrepare"!==p||g?"parseTile"!==p||g?"parseTile"===p&&g?300-y:"maybePrepare"===p&&g?400-y:500:200-y:100-y}(a);if(0===d){Re();try{i()}finally{}return null}return this.tasks[l]={fn:i,metadata:a,priority:d,id:l},this.taskQueue.push(l),this.invoker.trigger(),{cancel:()=>{delete this.tasks[l]}}}process(){Re();try{if(this.taskQueue=this.taskQueue.filter(l=>!!this.tasks[l]),!this.taskQueue.length)return;const i=this.pick();if(null===i)return;const a=this.tasks[i];if(delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),!a)return;a.fn()}finally{}}pick(){let i=null,a=1/0;for(let d=0;d<this.taskQueue.length;d++){const p=this.tasks[this.taskQueue[d]];p.priority<a&&(a=p.priority,i=d)}if(null===i)return null;const l=this.taskQueue[i];return this.taskQueue.splice(i,1),l}remove(){this.invoker.remove()}}class DC{constructor(i,a,l){this.target=i,this.parent=a,this.mapId=l,this.callbacks={},this.cancelCallbacks={},ai(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new gS}send(i,a,l,d,p=!1,g){const y=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(l.metadata=g,this.callbacks[y]=l);const x=new Set;return this.target.postMessage({id:y,type:i,hasCallback:!!l,targetMapId:d,mustQueue:p,sourceMapId:this.mapId,data:f(a,x)},x),{cancel:()=>{l&&delete this.callbacks[y],this.target.postMessage({id:y,type:"<cancel>",targetMapId:d,sourceMapId:this.mapId})}}}receive(i){const a=i.data,l=a.id;if(l&&(!a.targetMapId||this.mapId===a.targetMapId))if("<cancel>"===a.type){const d=this.cancelCallbacks[l];delete this.cancelCallbacks[l],d&&d.cancel()}else if(a.mustQueue||Re()){const d=this.callbacks[l],p=this.scheduler.add(()=>this.processTask(l,a),d&&d.metadata||{type:"message"});p&&(this.cancelCallbacks[l]=p)}else this.processTask(l,a)}processTask(i,a){if(delete this.cancelCallbacks[i],"<response>"===a.type){const l=this.callbacks[i];delete this.callbacks[i],l&&(a.error?l(v(a.error)):l(null,v(a.data)))}else{const l=new Set,d=a.hasCallback?(g,y)=>{this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:g?f(g):null,data:f(y,l)},l)}:g=>{},p=v(a.data);if(this.parent[a.type])this.parent[a.type](a.sourceMapId,p,d);else if(this.parent.getWorkerSource){const g=a.type.split(".");this.parent.getWorkerSource(a.sourceMapId,g[0],p.source,p.scope)[g[1]](p,d)}else d(new Error(`Could not find function ${a.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}let Pa=(()=>{class o{constructor(a,l){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=qe();const d=this.workerPool.acquire(this.id);for(let p=0;p<d.length;p++){const g=new o.Actor(d[p],l,this.id);g.name=`Worker ${p}`,this.actors.push(g)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(a,l,d){Ho(this.actors,(p,g)=>{p.send(a,l,g)},d=d||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(a=>{a.remove()}),this.actors=[],this.workerPool.release(this.id)}}return o.Actor=DC,o})();class Be{constructor(i,a){this.width=i,this.height=a,this.nextRow=0,this.image=new pc({width:i,height:a}),this.positions={},this.uploaded=!1}getDash(i,a){const l=this.getKey(i,a);return this.positions[l]}trim(){const i=this.width,a=this.height=ys(this.nextRow);this.image.resize({width:i,height:a})}getKey(i,a){return i.join(",")+a}getDashRanges(i,a,l){const d=[];let p=i.length%2==1?-i[i.length-1]*l:0,g=i[0]*l,y=!0;d.push({left:p,right:g,isDash:y,zeroLength:0===i[0]});let x=i[0];for(let C=1;C<i.length;C++){y=!y;const D=i[C];p=x*l,x+=D,g=x*l,d.push({left:p,right:g,isDash:y,zeroLength:0===D})}return d}addRoundDash(i,a,l){const d=a/2;for(let p=-l;p<=l;p++){const g=this.width*(this.nextRow+l+p);let y=0,x=i[y];for(let C=0;C<this.width;C++){C/x.right>1&&(x=i[++y]);const D=Math.abs(C-x.left),M=Math.abs(C-x.right),k=Math.min(D,M);let P;const F=p/l*(d+1);if(x.isDash){const B=d-Math.abs(F);P=Math.sqrt(k*k+B*B)}else P=d-Math.sqrt(k*k+F*F);this.image.data[g+C]=Math.max(0,Math.min(255,P+128))}}}addRegularDash(i,a){for(let x=i.length-1;x>=0;--x){const C=i[x],D=i[x+1];C.zeroLength?i.splice(x,1):D&&D.isDash===C.isDash&&(D.left=C.left,i.splice(x,1))}const l=i[0],d=i[i.length-1];l.isDash===d.isDash&&(l.left=d.left-this.width,d.right=l.right+this.width);const p=this.width*this.nextRow;let g=0,y=i[g];for(let x=0;x<this.width;x++){x/y.right>1&&(y=i[++g]);const C=Math.abs(x-y.left),D=Math.abs(x-y.right),M=Math.min(C,D);this.image.data[p+x]=Math.max(0,Math.min(255,(y.isDash?M:-M)+a+128))}}addDash(i,a){const l=this.getKey(i,a);if(this.positions[l])return this.positions[l];const d="round"===a,p=d?7:0,g=2*p+1;if(this.nextRow+g>this.height)return ar("LineAtlas out of space"),null;0===i.length&&i.push(1);let y=0;for(let D=0;D<i.length;D++)i[D]<0&&(ar("Negative value is found in line dasharray, replacing values with 0"),i[D]=0),y+=i[D];if(0!==y){const D=this.width/y,M=this.getDashRanges(i,this.width,D);d?this.addRoundDash(M,D,p):this.addRegularDash(M,"square"===a?.5*D:0)}const x=this.nextRow+p;this.nextRow+=g;const C={tl:[x,p],br:[y,0]};return this.positions[l]=C,C}}rn(Be,"LineAtlas");const Xy=1*gc;class TC{constructor(i){const a={},l=[];for(const y in i){const x=i[y],C=a[y]={};for(const D in x.glyphs){const M=x.glyphs[+D];if(!M||0===M.bitmap.width||0===M.bitmap.height)continue;const k=M.metrics.localGlyph?Xy:1,P={x:0,y:0,w:M.bitmap.width+2*k,h:M.bitmap.height+2*k};l.push(P),C[D]=P}}const{w:d,h:p}=Og(l),g=new pc({width:d||1,height:p||1});for(const y in i){const x=i[y];for(const C in x.glyphs){const D=x.glyphs[+C];if(!D||0===D.bitmap.width||0===D.bitmap.height)continue;const M=a[y][C],k=D.metrics.localGlyph?Xy:1;pc.copy(D.bitmap,g,{x:0,y:0},{x:M.x+k,y:M.y+k},D.bitmap)}}this.image=g,this.positions=a}}rn(TC,"GlyphAtlas");class ce{constructor(i){this.tileID=new Po(i.tileID.overscaledZ,i.tileID.wrap,i.tileID.canonical.z,i.tileID.canonical.x,i.tileID.canonical.y),this.tileZoom=i.tileZoom,this.uid=i.uid,this.zoom=i.zoom,this.canonical=i.tileID.canonical,this.pixelRatio=i.pixelRatio,this.tileSize=i.tileSize,this.source=i.source,this.scope=i.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=i.showCollisionBoxes,this.collectResourceTiming=!!i.collectResourceTiming,this.promoteId=i.promoteId,this.isSymbolTile=i.isSymbolTile,this.tileTransform=ru(i.tileID.canonical,i.projection),this.projection=i.projection,this.brightness=i.brightness,this.extraShadowCaster=!!i.extraShadowCaster}parse(i,a,l,d,p){this.status="parsing",this.data=i,this.collisionBoxArray=new N_;const g=new Mp(Object.keys(i.layers).sort()),y=new Gu(this.tileID,this.promoteId);y.bucketLayerIDs=[];const x={},C=new Be(256,256),D={featureIndex:y,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:C,availableImages:l,brightness:this.brightness},M=a.familiesBySource[this.source];for(const te in M){const ie=i.layers[te];if(!ie)continue;let se=!1,de=!1,pe=!1;for(const Pe of M[te])"symbol"===Pe[0].type?se=!0:de=!0,Pe[0].is3D()&&"model"!==Pe[0].type&&(pe=!0);if(this.extraShadowCaster&&!pe||!0===this.isSymbolTile&&!se||!1===this.isSymbolTile&&!de)continue;1===ie.version&&ar(`Vector tile source "${this.source}" layer "${te}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ee=g.encode(te),Ie=[];for(let Pe=0;Pe<ie.length;Pe++){const Ze=ie.feature(Pe),je=y.getId(Ze,te);Ie.push({feature:Ze,id:je,index:Pe,sourceLayerIndex:Ee})}for(const Pe of M[te]){const Ze=Pe[0];(!this.extraShadowCaster||Ze.is3D()&&"model"!==Ze.type)&&(void 0!==this.isSymbolTile&&"symbol"===Ze.type!==this.isSymbolTile||Ze.minzoom&&this.zoom<Math.floor(Ze.minzoom)||Ze.maxzoom&&this.zoom>=Ze.maxzoom||"none"!==Ze.visibility&&(ue(Pe,this.zoom,D.brightness,l),(x[Ze.id]=Ze.createBucket({index:y.bucketLayerIDs.length,layers:Pe,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ee,sourceID:this.source,projection:this.projection.spec})).populate(Ie,D,this.tileID.canonical,this.tileTransform),y.bucketLayerIDs.push(Pe.map(je=>je.id))))}}let k,P,F,B;C.trim();const j={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},q=()=>{if(k)return this.status="done",p(k);if(this.extraShadowCaster)this.status="done",p(null,{buckets:Va(x).filter(te=>!te.isEmpty()),featureIndex:y,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:D.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(P&&F&&B){const te=new TC(P),ie=new l0(F,B);for(const se in x){const de=x[se];de instanceof Gg?(ue(de.layers,this.zoom,D.brightness,l),Bi(de,P,te.positions,F,ie.iconPositions,this.showCollisionBoxes,l,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):de.hasPattern&&(de instanceof x0||de instanceof yy||de instanceof Mf)&&(ue(de.layers,this.zoom,D.brightness,l),de.addFeatures(D,this.tileID.canonical,ie.patternPositions,l,this.tileTransform,this.brightness))}this.status="done",p(null,{buckets:Va(x).filter(se=>!se.isEmpty()),featureIndex:y,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:te.image,lineAtlas:C,imageAtlas:ie,brightness:D.brightness})}};if(!this.extraShadowCaster){const te=ii(D.glyphDependencies,de=>Object.keys(de).map(Number));Object.keys(te).length?d.send("getGlyphs",{uid:this.uid,stacks:te,scope:this.scope},(de,pe)=>{k||(k=de,P=pe,q())},void 0,!1,j):P={};const ie=Object.keys(D.iconDependencies);ie.length?d.send("getImages",{icons:ie,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(de,pe)=>{k||(k=de,F=pe,q())},void 0,!1,j):F={};const se=Object.keys(D.patternDependencies);se.length?d.send("getImages",{icons:se,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(de,pe)=>{k||(k=de,B=pe,q())},void 0,!1,j):B={}}q()}}function ue(o,i,a,l){const d=new Ce(i,{brightness:a});for(const p of o)p.recalculate(d,l)}class it{constructor(i){this.entries={},this.scheduler=i}request(i,a,l,d){const p=this.entries[i]=this.entries[i]||{callbacks:[]};if(p.result){const[g,y]=p.result;return this.scheduler?this.scheduler.add(()=>{d(g,y)},a):d(g,y),()=>{}}return p.callbacks.push(d),p.cancel||(p.cancel=l((g,y)=>{p.result=[g,y];for(const x of p.callbacks)this.scheduler?this.scheduler.add(()=>{x(g,y)},a):x(g,y);setTimeout(()=>delete this.entries[i],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(g=>g!==d),p.callbacks.length||(p.cancel(),delete this.entries[i]))}}}function z0(o,i,a){const l=JSON.stringify(o.request);return o.data&&(this.deduped.entries[l]={result:[null,o.data]}),this.deduped.request(l,{type:"parseTile",isSymbolTile:o.isSymbolTile,zoom:o.tileZoom},d=>{const p=Mo(o.request,(g,y,x,C)=>{g?d(g):y&&d(null,{vectorTile:a?void 0:new Yd(new Op(y)),rawData:y,cacheControl:x,expires:C})});return()=>{p.cancel(),d()}},i)}var t_={workerUrl:"",workerClass:null,workerParams:void 0};function _S(){return null!=t_.workerClass?new t_.workerClass:new self.Worker(t_.workerUrl,t_.workerParams)}const V0="mapboxgl_preloaded_worker_pool";class jr{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<jr.workerCount;)this.workers.push(new _S);return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.workers&&0===this.numActive()&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[V0]}numActive(){return Object.keys(this.active).length}}let Ur;function Ky(){return Ur||(Ur=new jr),Ur}jr.workerCount=2;let n_,j0,vc,Sr=null;function Qp(){return Re()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:j0||Oe.DRACO_URL}const Qy=5123,zt=5126,Jp={5120:Int8Array,5121:Uint8Array,5122:Int16Array,[Qy]:Uint16Array,5125:Uint32Array,[zt]:Float32Array},yS={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",[Qy]:"DT_UINT16",5125:"DT_UINT32",[zt]:"DT_FLOAT32"},Jy={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function U0(o,i,a){const l=a.json.bufferViews.length,d=a.buffers.length;i.bufferView=l,a.json.bufferViews[l]={buffer:d,byteLength:o.byteLength},a.buffers[d]=o}const ev="KHR_draco_mesh_compression";function Dn(o,i){const a=o.extensions&&o.extensions[ev];if(!a)return;const l=new vc.Decoder,d=em(i,a.bufferView),p=new vc.Mesh;if(!l.DecodeArrayToMesh(d,d.byteLength,p))throw new Error("Failed to decode Draco mesh");const g=i.json.accessors[o.indices],y=Jp[g.componentType],x=g.count*y.BYTES_PER_ELEMENT,C=vc._malloc(x);y===Uint16Array?l.GetTrianglesUInt16Array(p,x,C):l.GetTrianglesUInt32Array(p,x,C),U0(vc.memory.buffer.slice(C,C+x),g,i),vc._free(C);for(const D of Object.keys(a.attributes)){const M=l.GetAttributeByUniqueId(p,a.attributes[D]),k=i.json.accessors[o.attributes[D]],P=yS[k.componentType],F=k.count*Jy[k.type]*Jp[k.componentType].BYTES_PER_ELEMENT,B=vc._malloc(F);l.GetAttributeDataArrayForAllPoints(p,M,vc[P],F,B),U0(vc.memory.buffer.slice(B,B+F),k,i),vc._free(B)}l.destroy(),p.destroy(),delete o.extensions[ev]}const SC=1179937895,If=new TextDecoder("utf8");function Ku(o,i){return new URL(o,i).href}function bc(o,i,a,l){return fetch(Ku(o.uri,l)).then(d=>d.arrayBuffer()).then(d=>{i.buffers[a]=d})}function em(o,i){const a=o.json.bufferViews[i];return new Uint8Array(o.buffers[a.buffer],a.byteOffset||0,a.byteLength)}function MC(o,i,a,l){if(o.uri){const d=Ku(o.uri,l);return fetch(d).then(p=>p.blob()).then(p=>createImageBitmap(p)).then(p=>{i.images[a]=p})}if(void 0!==o.bufferView){const d=em(i,o.bufferView),p=new Blob([d],{type:o.mimeType});return createImageBitmap(p).then(g=>{i.images[a]=g})}}function H0(o,i=0,a){const l={json:null,images:[],buffers:[]};if(new Uint32Array(o,i,1)[0]===SC){const C=new Uint32Array(o,i);let D=2;const M=(C[D++]>>2)-3,k=C[D++]>>2;if(D++,l.json=JSON.parse(If.decode(C.subarray(D,D+k))),D+=k,D<M){const P=C[D++];D++;const F=i+(D<<2);l.buffers[0]=o.slice(F,F+P)}}else l.json=JSON.parse(If.decode(new Uint8Array(o,i)));const{buffers:d,images:p,meshes:g,extensionsUsed:y}=l.json;let x=Promise.resolve();if(d){const C=[];for(let D=0;D<d.length;D++){const M=d[D];M.uri?C.push(bc(M,l,D,a)):l.buffers[D]||(l.buffers[D]=null)}x=Promise.all(C)}return x.then(()=>{const C=[],D=y&&y.includes(ev);if(D&&C.push(function(){if(!vc)return n_||(n_=function(M){let k,P=null;function F(){k=new Uint8Array(P.buffer)}function B(){throw new Error("Unexpected Draco error.")}const j={a:{a:B,d:function(q,te,ie){return k.copyWithin(q,te,te+ie)},c:function(q){const te=k.length,ie=Math.max(q>>>0,Math.ceil(1.2*te)),se=Math.ceil((ie-te)/65536);try{return P.grow(se),F(),!0}catch{return!1}},b:B}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(M,j):M.then(q=>q.arrayBuffer()).then(q=>WebAssembly.instantiate(q,j))).then(q=>{const{Rb:te,Qb:ie,P:se,T:de,X:pe,Ja:Ee,La:Ie,Qa:Pe,Va:Ze,Wa:je,eb:dt,jb:Pt,f:st,e:Tt,yb:et,zb:$t,Ab:on,Bb:It,Db:On,Gb:ln}=q.instance.exports;P=Tt;const Gt=(()=>{let An=0,dn=0,Tn=0,Bt=0;return Te=>{Tn&&(te(Bt),te(An),dn+=Tn,Tn=An=0),An||(dn+=128,An=ie(dn));const vi=Te.length+7&-8;let Jn=An;vi>=dn&&(Tn=vi,Jn=Bt=ie(vi));for(let gi=0;gi<Te.length;gi++)k[Jn+gi]=Te[gi];return Jn}})();return F(),st(),{memory:Tt,_free:te,_malloc:ie,Mesh:class{constructor(){this.ptr=se()}destroy(){de(this.ptr)}},Decoder:class{constructor(){this.ptr=Ee()}destroy(){Pt(this.ptr)}DecodeArrayToMesh(An,dn,Tn){const Bt=Gt(An),Te=Ie(this.ptr,Bt,dn,Tn.ptr);return!!pe(Te)}GetAttributeByUniqueId(An,dn){return{ptr:Pe(this.ptr,An.ptr,dn)}}GetTrianglesUInt16Array(An,dn,Tn){Ze(this.ptr,An.ptr,dn,Tn)}GetTrianglesUInt32Array(An,dn,Tn){je(this.ptr,An.ptr,dn,Tn)}GetAttributeDataArrayForAllPoints(An,dn,Tn,Bt,Te){dt(this.ptr,An.ptr,dn.ptr,Tn,Bt,Te)}},DT_INT8:et(),DT_UINT8:$t(),DT_INT16:on(),DT_UINT16:It(),DT_UINT32:On(),DT_FLOAT32:ln()}})}(fetch(Qp())),n_.then(M=>{vc=M,n_=void 0}))}()),p)for(let M=0;M<p.length;M++)C.push(MC(p[M],l,M,a));return(C.length?Promise.all(C):Promise.resolve()).then(()=>{if(D&&g)for(const{primitives:M}of g)for(const k of M)Dn(k,l);return l})})}class $0{constructor(i,a,l){if(this.triangleCount=a.length/3,this.min=new Le(0,0),this.max=new Le(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],0===this.triangleCount||0===i.length||0===l)return;const d=i.map(D=>D.x),p=i.map(D=>D.y);this.min=new Le(Math.min(...d),Math.min(...p)),this.max=new Le(Math.max(...d),Math.max(...p));const g=this.max.sub(this.min);g.x=Math.max(g.x,1),g.y=Math.max(g.y,1);const y=Math.max(g.x,g.y)/l;this.cellsX=Math.max(1,Math.ceil(g.x/y)),this.cellsY=Math.max(1,Math.ceil(g.y/y)),this.xScale=1/y,this.yScale=1/y;const x=[];for(let D=0;D<this.triangleCount;D++){const M=i[a[3*D+0]].sub(this.min),k=i[a[3*D+1]].sub(this.min),P=i[a[3*D+2]].sub(this.min),F=Qu(Math.floor(Math.min(M.x,k.x,P.x)),this.xScale,this.cellsX),B=Qu(Math.floor(Math.max(M.x,k.x,P.x)),this.xScale,this.cellsX),j=Qu(Math.floor(Math.min(M.y,k.y,P.y)),this.yScale,this.cellsY),q=Qu(Math.floor(Math.max(M.y,k.y,P.y)),this.yScale,this.cellsY),te=new Le(0,0),ie=new Le(0,0),se=new Le(0,0),de=new Le(0,0);for(let pe=j;pe<=q;++pe){te.y=ie.y=pe*y,se.y=de.y=(pe+1)*y;for(let Ee=F;Ee<=B;++Ee)te.x=se.x=Ee*y,ie.x=de.x=(Ee+1)*y,(uy(M,k,P,te,ie,de)||uy(M,k,P,te,de,se))&&x.push({cellIdx:pe*this.cellsX+Ee,triIdx:D})}}if(0===x.length)return;x.sort((D,M)=>D.cellIdx-M.cellIdx||D.triIdx-M.triIdx);let C=0;for(;C<x.length;){const D=x[C].cellIdx,M={start:this.payload.length,len:0};for(;C<x.length&&x[C].cellIdx===D;)++M.len,this.payload.push(x[C++].triIdx);this.cells[D]=M}}query(i,a,l){if(0===this.triangleCount||0===this.cells.length||i.x>this.max.x||this.min.x>a.x||i.y>this.max.y||this.min.y>a.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let x=0;x<this.lookup.length;x++)this.lookup[x]=0;const d=Qu(i.x-this.min.x,this.xScale,this.cellsX),p=Qu(a.x-this.min.x,this.xScale,this.cellsX),g=Qu(i.y-this.min.y,this.yScale,this.cellsY),y=Qu(a.y-this.min.y,this.yScale,this.cellsY);for(let x=g;x<=y;x++)for(let C=d;C<=p;C++){const D=this.cells[x*this.cellsX+C];if(D)for(let M=0;M<D.len;M++){const k=this.payload[D.start+M],P=Math.floor(k/8),F=1<<k%8;if(!(this.lookup[P]&F)&&(this.lookup[P]|=F,l.push(k),l.length===this.triangleCount))return}}}}function Qu(o,i,a){return Math.max(0,Math.min(a-1,Math.floor(o*i)))}function nh(o,i){const a=o.json.bufferViews[i.bufferView];return new Jp[i.componentType](o.buffers[a.buffer],(i.byteOffset||0)+(a.byteOffset||0),i.count*Jy[i.type])}function AC(o,i,a){const l=o.indices,d=o.attributes,p={};p.indexArray=new rr;const g=i.json.accessors[l],y=g.count/3;p.indexArray.reserve(y);const x=nh(i,g);for(let k=0;k<y;k++)p.indexArray.emplaceBack(x[3*k],x[3*k+1],x[3*k+2]);p.indexArray._trim(),p.vertexArray=new qh;const C=i.json.accessors[d.POSITION];p.vertexArray.reserve(C.count);const D=nh(i,C);for(let k=0;k<C.count;k++)p.vertexArray.emplaceBack(D[3*k],D[3*k+1],D[3*k+2]);if(p.vertexArray._trim(),p.aabb=new oo(C.min,C.max),p.centroid=function(k,P){const F=[0,0,0],B=k.length;if(B>0){for(let j=0;j<B;j++){const q=3*k[j];F[0]+=P[q],F[1]+=P[q+1],F[2]+=P[q+2]}F[0]/=B,F[1]/=B,F[2]/=B}return F}(x,D),void 0!==d.COLOR_0){const k=i.json.accessors[d.COLOR_0],P=Jy[k.type];if(k.componentType===zt){p.colorArray=3===P?new qh:new zi,p.colorArray.reserve(k.count);const F=nh(i,k);if(3===P)for(let B=0;B<k.count;B++)p.colorArray.emplaceBack(F[3*B],F[3*B+1],F[3*B+2]);else for(let B=0;B<k.count;B++)p.colorArray.emplaceBack(F[4*B],F[4*B+1],F[4*B+2],F[4*B+3]);p.colorArray._trim()}else if(k.componentType===Qy&&4===P){p.colorArray=new zi,p.colorArray.resize(k.count);const F=nh(i,k),B=1/65535,j=p.colorArray.float32;for(let q=0;q<4*F.length;++q)j[q]=F[q]*B}else ar(`glTF color buffer parsing for accessor ${JSON.stringify(k)} is not supported`)}if(void 0!==d.NORMAL){p.normalArray=new qh;const k=i.json.accessors[d.NORMAL];p.normalArray.reserve(k.count);const P=nh(i,k);for(let F=0;F<k.count;F++)p.normalArray.emplaceBack(P[3*F],P[3*F+1],P[3*F+2]);p.normalArray._trim()}if(void 0!==d.TEXCOORD_0&&a.length>0){p.texcoordArray=new dp;const k=i.json.accessors[d.TEXCOORD_0];p.texcoordArray.reserve(k.count);const P=nh(i,k);for(let F=0;F<k.count;F++)p.texcoordArray.emplaceBack(P[2*F],P[2*F+1]);p.texcoordArray._trim()}const M=o.material;return p.material=function(k,P){const{emissiveFactor:F=[0,0,0],alphaMode:B="OPAQUE",alphaCutoff:j=.5,normalTexture:q,occlusionTexture:te,emissiveTexture:ie,doubleSided:se}=k,{baseColorFactor:de=[1,1,1,1],metallicFactor:pe=1,roughnessFactor:Ee=1,baseColorTexture:Ie,metallicRoughnessTexture:Pe}=k.pbrMetallicRoughness||{};return{pbrMetallicRoughness:{baseColorFactor:new Pi(...de),metallicFactor:pe,roughnessFactor:Ee,baseColorTexture:Ie?P[Ie.index]:void 0,metallicRoughnessTexture:Pe?P[Pe.index]:void 0},doubleSided:se,emissiveFactor:F,alphaMode:B,alphaCutoff:j,normalTexture:q?P[q.index]:void 0,occlusionTexture:te?P[te.index]:void 0,emissionTexture:ie?P[ie.index]:void 0,defined:void 0===k.defined}}(void 0!==M?i.json.materials[M]:{defined:!1},a),void 0!==d._FEATURE_RGBA4444&&(p.featureData=new Uint32Array(nh(i,i.json.accessors[d._FEATURE_RGBA4444]).buffer)),p}function G0(o,i,a){const{matrix:l,rotation:d,translation:p,scale:g,mesh:y,extras:x,children:C}=o,D={};if(D.matrix=l||h.m.fromRotationTranslationScale([],d||[0,0,0,1],p||[0,0,0],g||[1,1,1]),void 0!==y){D.meshes=a[y];const M=D.anchor=[0,0];for(const k of D.meshes){const{min:P,max:F}=k.aabb;M[0]+=P[0]+F[0],M[1]+=P[1]+F[1]}M[0]=Math.floor(M[0]/D.meshes.length/2),M[1]=Math.floor(M[1]/D.meshes.length/2)}if(x&&(x.id&&(D.id=x.id),x.lights&&(D.lights=function(M){if(!M.length)return[];const k=function(q){const te=atob(q),ie=new Uint8Array(te.length);for(let se=0;se<te.length;se++)ie[se]=te.codePointAt(se);return ie}(M),P=[],F=k.length/24,B=new Uint16Array(k.buffer),j=new Float32Array(k.buffer);for(let q=0;q<F;q++){const te=B[2*q*6]/30,ie=B[2*q*6+1]/30,se=B[2*q*6+10]/100,de=j[6*q+1],pe=j[6*q+2],Ee=j[6*q+3],Ie=j[6*q+4],Pe=Ee-de,Ze=Ie-pe,je=Math.hypot(Pe,Ze);P.push({pos:[de+.5*Pe,pe+.5*Ze,ie],normal:[Ze/je,-Pe/je,0],width:je,height:te,depth:se,points:[de,pe,Ee,Ie]})}return P}(x.lights))),C){const M=[];for(const k of C)M.push(G0(i.json.nodes[k],i,a));D.children=M}return D}function IC(o){if(0===o.vertices.length||0===o.indices.length)return null;const[i,a]=[o.vertices[0].clone(),o.vertices[0].clone()];for(let g=1;g<o.vertices.length;++g){const y=o.vertices[g];i.x=Math.min(i.x,y.x),i.y=Math.min(i.y,y.y),a.x=Math.max(a.x,y.x),a.y=Math.max(a.y,y.y)}const l=Math.ceil(Math.max(a.x-i.x,a.y-i.y)/256),d=Math.max(8,l),p=new $0(o.vertices,o.indices,d);return{vertices:o.vertices,indices:o.indices,grid:p,min:i,max:a}}function tv(o){if(!o.extras||!o.extras.ground)return null;const i=o.extras.ground;if(!i||!Array.isArray(i)||0===i.length)return null;const a=i[0];if(!a||!Array.isArray(a)||0===a.length)return null;const l=[];for(const g of a){if(!Array.isArray(g)||2!==g.length)continue;const y=g[0],x=g[1];"number"==typeof y&&"number"==typeof x&&l.push(new Le(y,x))}if(l.length<3)return null;l.length>1&&l[l.length-1].equals(l[0])&&l.pop();let d=0;for(let g=0;g<l.length;g++){const y=l[g],x=l[(g+1)%l.length],C=l[(g+2)%l.length];d+=(y.x-x.x)*(C.y-x.y)-(C.x-x.x)*(y.y-x.y)}d>0&&l.reverse();const p=ff(l.flatMap(g=>[g.x,g.y]),[]);return 0===p.length?null:{vertices:l,indices:p}}function ih(o){const i=[],a=[];let l=0;for(const d of o){l=i.length;const p=d.vertexArray.float32,g=d.indexArray.uint16;for(let y=0;y<d.vertexArray.length;y++)i.push(new Le(p[3*y+0],p[3*y+1]));for(let y=0;y<3*d.indexArray.length;y++)a.push(g[y]+l)}if(a.length%3!=0)return null;for(let d=0;d<a.length;d+=3){const p=i[a[d+0]],g=i[a[d+1]],y=i[a[d+2]];(p.x-g.x)*(y.y-g.y)-(y.x-g.x)*(p.y-g.y)>0&&([a[d+1],a[d+2]]=[a[d+2],a[d+1]])}return{vertices:i,indices:a}}function kC(o){const a=function(x,C){const D=[];for(const M of x.json.meshes){const k=[];for(const P of M.primitives)k.push(AC(P,x,C));D.push(k)}return D}(o,function(x,C){const D=[],M=WebGL2RenderingContext;if(x.json.textures)for(const k of x.json.textures){const P={magFilter:M.LINEAR,minFilter:M.NEAREST,wrapS:M.REPEAT,wrapT:M.REPEAT};void 0!==k.sampler&&Object.assign(P,x.json.samplers[k.sampler]),D.push({image:C[k.source],sampler:P,uploaded:!1})}return D}(o,o.images)),{scenes:l,scene:d,nodes:p}=o.json,g=l?l[d||0].nodes:p,y=[];for(const x of g)y.push(G0(p[x],o,a));return function(x,C,D){const M={},k=new Set;for(let P=0;P<x.length;P++){const F=D[C[P]];if(!F.extras)continue;const B=F.extras["mapbox:footprint:version"],j=F.extras["mapbox:footprint:id"];(B||j)&&k.add(P),"1.0.0"===B&&j&&(M[j]=P)}for(let P=0;P<x.length;P++){if(k.has(P))continue;const F=x[P],B=D[C[P]];if(!B.extras)continue;let j=null;F.id in M&&(j=ih(x[M[F.id]].meshes)),j||(j=tv(B)),j&&(F.footprint=IC(j))}if(k.size>0){const P=Array.from(k.values()).sort((F,B)=>F-B);for(let F=P.length-1;F>=0;F--)x.splice(P[F],1)}}(y,g,o.json.nodes),y}function vS(o){o.heightmap=new Float32Array(4096),o.heightmap.fill(-1);const i=o.vertexArray.float32,a=o.aabb.min[0]-1,l=o.aabb.min[1]-1,d=64/(o.aabb.max[0]-a+2),p=64/(o.aabb.max[1]-l+2);for(let g=0;g<i.length;g+=3){const y=i[g+2],x=(i[g+0]-a)*d|0,C=(i[g+1]-l)*p|0;y>o.heightmap[64*C+x]&&(o.heightmap[64*C+x]=y)}}function q0(o,i){const a={};a.indexArray=new rr,a.indexArray.reserve(4*o.length),a.vertexArray=new qh,a.vertexArray.reserve(10*o.length),a.colorArray=new zi,a.vertexArray.reserve(10*o.length);let l=0;for(const g of o){const y=Math.min(10,Math.max(4,1.3*g.height))*i,x=[-g.normal[1],g.normal[0],0],C=Math.min(.29,.1*g.width/g.depth),D=g.width-2*g.depth*i*(C+.01),M=h.v.scaleAndAdd([],g.pos,x,D/2),k=h.v.scaleAndAdd([],g.pos,x,-D/2),P=[M[0],M[1],M[2]+g.height],F=[k[0],k[1],k[2]+g.height],B=h.v.scaleAndAdd([],g.normal,x,C);h.v.scale(B,B,y);const j=h.v.scaleAndAdd([],g.normal,x,-C);h.v.scale(j,j,y),h.v.add(B,M,B),h.v.add(j,k,j),M[2]+=.1,k[2]+=.1,a.vertexArray.emplaceBack(B[0],B[1],B[2]),a.vertexArray.emplaceBack(j[0],j[1],j[2]),a.vertexArray.emplaceBack(M[0],M[1],M[2]),a.vertexArray.emplaceBack(k[0],k[1],k[2]),a.vertexArray.emplaceBack(P[0],P[1],P[2]),a.vertexArray.emplaceBack(F[0],F[1],F[2]),a.vertexArray.emplaceBack(M[0],M[1],M[2]),a.vertexArray.emplaceBack(k[0],k[1],k[2]),a.vertexArray.emplaceBack(B[0],B[1],B[2]),a.vertexArray.emplaceBack(j[0],j[1],j[2]);const q=D/y/2;a.colorArray.emplaceBack(-q-C,-1,q,.8),a.colorArray.emplaceBack(q+C,-1,q,.8),a.colorArray.emplaceBack(-q,0,q,1.3),a.colorArray.emplaceBack(q,0,q,1.3),a.colorArray.emplaceBack(q+C,-.8,q,.7),a.colorArray.emplaceBack(q+C,-.8,q,.7),a.colorArray.emplaceBack(0,0,q,1.3),a.colorArray.emplaceBack(0,0,q,1.3),a.colorArray.emplaceBack(q+C,-1.2,q,.8),a.colorArray.emplaceBack(q+C,-1.2,q,.8),a.indexArray.emplaceBack(6+l,4+l,8+l),a.indexArray.emplaceBack(7+l,9+l,5+l),a.indexArray.emplaceBack(0+l,1+l,2+l),a.indexArray.emplaceBack(1+l,3+l,2+l),l+=10}const d={defined:!0,emissiveFactor:[0,0,0]},p={};return p.baseColorFactor=Pi.white,d.pbrMetallicRoughness=p,a.material=d,a.aabb=new oo([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),a}rn($0,"TriangleGridIndex");const rh=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class i_{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,l]=new Uint8Array(i,0,2);if(219!==a)throw new Error("Data does not appear to be in a KDBush format.");const d=l>>4;if(1!==d)throw new Error(`Got v${d} data when expected v1.`);const p=rh[15&l];if(!p)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(i,2,1),[y]=new Uint32Array(i,4,1);return new i_(y,g,p,i)}constructor(i,a=64,l=Float64Array,d){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=l,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const p=rh.indexOf(this.ArrayType),g=2*i*this.ArrayType.BYTES_PER_ELEMENT,y=i*this.IndexArrayType.BYTES_PER_ELEMENT,x=(8-y%8)%8;if(p<0)throw new Error(`Unexpected typed array class: ${l}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+y+x,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+g+y+x),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+y+x,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+p]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=i)}add(i,a){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=i,this.coords[this._pos++]=a,l}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return W0(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,a,l,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:g,nodeSize:y}=this,x=[0,p.length-1,0],C=[];for(;x.length;){const D=x.pop()||0,M=x.pop()||0,k=x.pop()||0;if(M-k<=y){for(let j=k;j<=M;j++){const q=g[2*j],te=g[2*j+1];q>=i&&q<=l&&te>=a&&te<=d&&C.push(p[j])}continue}const P=k+M>>1,F=g[2*P],B=g[2*P+1];F>=i&&F<=l&&B>=a&&B<=d&&C.push(p[P]),(0===D?i<=F:a<=B)&&(x.push(k),x.push(P-1),x.push(1-D)),(0===D?l>=F:d>=B)&&(x.push(P+1),x.push(M),x.push(1-D))}return C}within(i,a,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:p,nodeSize:g}=this,y=[0,d.length-1,0],x=[],C=l*l;for(;y.length;){const D=y.pop()||0,M=y.pop()||0,k=y.pop()||0;if(M-k<=g){for(let j=k;j<=M;j++)PC(p[2*j],p[2*j+1],i,a)<=C&&x.push(d[j]);continue}const P=k+M>>1,F=p[2*P],B=p[2*P+1];PC(F,B,i,a)<=C&&x.push(d[P]),(0===D?i-l<=F:a-l<=B)&&(y.push(k),y.push(P-1),y.push(1-D)),(0===D?i+l>=F:a+l>=B)&&(y.push(P+1),y.push(M),y.push(1-D))}return x}}function W0(o,i,a,l,d,p){if(d-l<=a)return;const g=l+d>>1;nv(o,i,g,l,d,p),W0(o,i,a,l,g-1,1-p),W0(o,i,a,g+1,d,1-p)}function nv(o,i,a,l,d,p){for(;d>l;){if(d-l>600){const C=d-l+1,D=a-l+1,M=Math.log(C),k=.5*Math.exp(2*M/3),P=.5*Math.sqrt(M*k*(C-k)/C)*(D-C/2<0?-1:1);nv(o,i,a,Math.max(l,Math.floor(a-D*k/C+P)),Math.min(d,Math.floor(a+(C-D)*k/C+P)),p)}const g=i[2*a+p];let y=l,x=d;for(iv(o,i,l,a),i[2*d+p]>g&&iv(o,i,l,d);y<x;){for(iv(o,i,y,x),y++,x--;i[2*y+p]<g;)y++;for(;i[2*x+p]>g;)x--}i[2*l+p]===g?iv(o,i,l,x):(x++,iv(o,i,x,d)),x<=a&&(l=x+1),a<=x&&(d=x-1)}}function iv(o,i,a,l){RC(o,a,l),RC(i,2*a,2*l),RC(i,2*a+1,2*l+1)}function RC(o,i,a){const l=o[i];o[i]=o[a],o[a]=l}function PC(o,i,a,l){const d=o-a,p=i-l;return d*d+p*p}h.$=45,h.A=so,h.B=function(o){const i=h.m.identity(new Float64Array(16));h.m.multiply(i,o.pixelMatrix,o.globeMatrix);const a=[0,Fl,0],l=[0,Ll,0];return h.v.transformMat4(a,a,i),h.v.transformMat4(l,l,i),[a[0]>0&&a[0]<=o.width&&a[1]>0&&a[1]<=o.height&&!Cp(o,new er(o.center.lat,90)),l[0]>0&&l[0]<=o.width&&l[1]>0&&l[1]<=o.height&&!Cp(o,new er(o.center.lat,-90))]},h.C=Pi,h.D=zu,h.E=tl,h.F=vp,h.G=dg,h.H=Nl,h.I=Wg,h.J=Ht,h.K=function(o,i){const{scale:a}=o.tileTransform,l=a*Ht/(o.tileSize*Math.pow(2,i.zoom-o.tileID.overscaledZ+o.tileID.canonical.z));return h.h.scale(new Float32Array(4),i.inverseAdjustmentMatrix,[l,l])},h.L=er,h.M=Ko,h.N=Uy,h.O=Po,h.P=Le,h.Q=eC,h.R=gb,h.S=function(o){const i=eC(o,!0);return h.h.invert([],[i[0],i[1],i[4],i[5]])},h.T=_b,h.U=ty,h.V=function(o){const{x:i,y:a}=o.point,{lng:l,lat:d}=o._center;return wp(i,a,o.worldSize,l,d)},h.W=Ra,h.X=ar,h.Y=Si,h.Z=ug,h._=function(o){const i=Math.round((o+45+360)%360/90)%4;return mr[i]},h.a=Vl,h.a$=Zv,h.a0=sy,h.a1=function(o,i){return Ws(Gr(o,{type:"json"}),i)},h.a2=qr,h.a3=rt,h.a4=uo,h.a5=il,h.a6=pa,h.a7=Xl,h.a8=Ao,h.a9=ou,h.aA=df,h.aB=Ab,h.aC=el,h.aD=it,h.aE=Xt,h.aF=z0,h.aG=function(o){zr++,zr>$i&&(o.getActor().send("enforceCacheSizeLimit",Vn),zr=0)},h.aH=Ir,h.aI=yh,h.aJ=function(o){return o<=1?1:Math.pow(2,Math.floor(Math.log(o)/Math.LN2))},h.aK=xC,h.aL=function(o,i){const a=document.createElement("video");a.muted=!0,a.onloadstart=function(){i(null,a)};for(let l=0;l<o.length;l++){const d=document.createElement("source");Zs(o[l])||(a.crossOrigin="Anonymous"),d.src=o[l],a.appendChild(d)}return{cancel:()=>{}}},h.aM=sn,h.aN=qg,h.aO=function(o){return fetch(o).then(i=>i.arrayBuffer()).then(i=>H0(i,0,o))},h.aP=kC,h.aQ=class{constructor(o,i,a,l){this.id=o,this.position=null!=i?new er(i[0],i[1]):new er(0,0),this.orientation=a??[0,0,0],this.nodes=l,this.uploaded=!1,this.aabb=new oo([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(o,i){if(h.m.multiply(o.matrix,i,o.matrix),o.meshes)for(const a of o.meshes){const l=oo.applyTransform(a.aabb,o.matrix);this.aabb.encapsulate(l)}if(o.children)for(const a of o.children)this._applyTransformations(a,o.matrix)}computeBoundsAndApplyParent(){const o=h.m.identity([]);for(const i of this.nodes)this._applyTransformations(i,o)}_positionModelOnTerrain(o,i){const a=o.elevation;if(!a)return 0;const l=oo.projectAabbCorners(this.aabb,this.matrix),d=zo(1,this.position.lat)*o.worldSize,p=function(j,q){const te=[0,0,1],ie=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const se of ie){const de=j[se.corners[0]],pe=j[se.corners[1]],Ee=j[se.corners[2]],Ie=[pe[0]-de[0],pe[1]-de[1],q*(pe[2]-de[2])],Pe=h.v.cross(Ie,Ie,[Ee[0]-de[0],Ee[1]-de[1],q*(Ee[2]-de[2])]);h.v.normalize(Pe,Pe),se.dotProductWithUp=h.v.dot(Pe,te)}return ie.sort((se,de)=>se.dotProductWithUp-de.dotProductWithUp),ie[0].corners}(l,d),g=l[p[0]],y=l[p[1]],x=l[p[2]],C=l[p[3]],D=a.getAtPointOrZero(new Ko(g[0]/o.worldSize,g[1]/o.worldSize),0),M=a.getAtPointOrZero(new Ko(y[0]/o.worldSize,y[1]/o.worldSize),0),k=a.getAtPointOrZero(new Ko(x[0]/o.worldSize,x[1]/o.worldSize),0),P=a.getAtPointOrZero(new Ko(C[0]/o.worldSize,C[1]/o.worldSize),0),F=(D+P)/2,B=(M+k)/2;return F>B?M<k?ki(i,y,C,g,M,P,D,d):ki(i,x,g,C,k,D,P,d):D<P?ki(i,g,y,x,D,M,k,d):ki(i,C,x,y,P,k,M,d),Math.max(F,B)}computeModelMatrix(o,i,a,l,d,p,g=!1){const y=o.transform,x=y.zoom,C=y.project(this.position),D=af(this.position.lat,x),M=1/D;h.m.identity(this.matrix),h.m.translate(this.matrix,this.matrix,[C.x+l[0]*M,C.y+l[1]*M,l[2]]);let k=1,P=1;const F=y.worldSize;if(g){if("mercator"===y.projection.name){let te=0;y.elevation&&(te=y.elevation.getAtPointOrZero(new Ko(C.x/F,C.y/F),0));const ie=h.e.transformMat4([],[C.x,C.y,te,1],y.projMatrix)[3]/y.cameraToCenterDistance;k=ie,P=ie*af(y.center.lat,x)}else if("globe"===y.projection.name){const te=oC(this.matrix,y),ie=h.m.multiply([],y.projMatrix,te),se=[0,0,0,1];h.e.transformMat4(se,se,ie);const de=se[3]/y.cameraToCenterDistance,pe=Jc(x),Ee=y.projection.pixelsPerMeter(this.position.lat,F)*af(this.position.lat,x),Ie=y.projection.pixelsPerMeter(y.center.lat,F)*af(y.center.lat,x);k=de/oi(Ee,ay(y.center.lat),pe),P=de*D/Ee,k*=Ie,P*=Ie}}else k=M;h.m.scale(this.matrix,this.matrix,[k,k,P]);const B=[...this.matrix],j=this.orientation,q=[];if(D0(q,[j[0]+i[0],j[1]+i[1],j[2]+i[2]],a),h.m.multiply(this.matrix,B,q),d&&y.elevation){let te=0;const ie=[];if(p&&y.elevation){te=this._positionModelOnTerrain(y,ie);const se=h.m.fromQuat([],ie),de=h.m.multiply([],se,q);h.m.multiply(this.matrix,B,de)}else te=y.elevation.getAtPointOrZero(new Ko(C.x/F,C.y/F),0);0!==te&&(this.matrix[14]+=te)}}upload(o){if(!this.uploaded){for(const i of this.nodes)T0(i,o);for(const i of this.nodes)$y(i);this.uploaded=!0}}destroy(){for(const o of this.nodes)Gy(o)}},h.aR=ai,h.aS=["type","source","source-layer","minzoom","maxzoom","filter","layout"],h.aT=a0,h.aU=lw,h.aV=ss,h.aW=h0,h.aX=we,h.aY=Sy,h.aZ=i_,h.a_=Wm,h.aa=Og,h.ab=Np,h.ac=vt,h.ad=fe,h.ae=He,h.af=class{constructor(o){this.specification=o}possiblyEvaluate(o,i){return ve(o.expression.evaluate(i))}interpolate(o,i,a){return{x:oi(o.x,i.x,a),y:oi(o.y,i.y,a),z:oi(o.z,i.z,a),azimuthal:oi(o.azimuthal,i.azimuthal,a),polar:oi(o.polar,i.polar,a)}}},h.ag=$e,h.ah=o=>wa(Hh(o)),h.ai=Vm,h.aj=O_,h.ak=Gr,h.al=Ce,h.am=np,h.an=Is,h.ao=Jc,h.ap=o=>wa(P_(o)),h.aq=Dd,h.ar=Ue,h.as=class{constructor(o){this.specification=o}possiblyEvaluate(o,i){return function([a,l]){const d=ve([1,a,l]);return{x:d.x,y:d.y,z:d.z}}(o.expression.evaluate(i))}interpolate(o,i,a){return{x:oi(o.x,i.x,a),y:oi(o.y,i.y,a),z:oi(o.z,i.z,a)}}},h.at=function(o,i,a=0,l=!0){const d=new Le(a,a),p=o.sub(d),g=i.add(d),y=[p,new Le(g.x,p.y),g,new Le(p.x,g.y)];return l&&y.push(p.clone()),y},h.au=function(o,i){const a=[];for(let l=0;l<o.length;l++){const d=wn(l-1,-1,o.length-1),p=wn(l+1,-1,o.length-1),g=o[l],y=o[p],x=o[d].sub(g).unit(),C=y.sub(g).unit(),D=C.angleWithSep(x.x,x.y),M=x.add(C).unit().mult(-1*i/Math.sin(D/2));a.push(g.add(M))}return a},h.av=Ay,h.aw=bg,h.ax=function(o,i,a=0){return h.v.fromValues(((i.x-a)*o.scale-o.x)*Ht,(i.y*o.scale-o.y)*Ht,iT(i.z,i.y))},h.ay=rC,h.az=function(o){let i=1/0,a=1/0,l=-1/0,d=-1/0;for(const p of o)i=Math.min(i,p.x),a=Math.min(a,p.y),l=Math.max(l,p.x),d=Math.max(d,p.y);return{min:new Le(i,a),max:new Le(l,d)}},h.b=zo,h.b$=0,h.b0=Zh,h.b1=H_,h.b2=Ls,h.b3=function(o,i,a){const l=Math.sqrt(o*o+i*i+a*a),d=l>0?Math.acos(a/l)*xn:0;let p=0!==o||0!==i?Math.atan2(-i,-o)*xn+90:0;return p<0&&(p+=360),[l,p,d]},h.b4=Cf,h.b5=yc,h.b6=Kw,h.b7=D1,h.b8=class extends dc{constructor(o){super(o),this.current=Zm}set(o,i,a){if(this.fetchUniformLocation(o,i))for(let l=0;l<9;l++)if(a[l]!==this.current[l]){this.current=a,this.gl.uniformMatrix3fv(this.location,!1,a);break}}},h.b9=FD,h.bA=function(o,i){const a=[0,0,0],l=xp(Kc(i.canonical));return h.v.transformMat4(a,a,l),h.v.transformMat4(a,a,o),a},h.bB=o=>({u_camera_to_center_distance:new Ls(o),u_extrude_scale:new fp(o),u_device_pixel_ratio:new Ls(o),u_matrix:new Wm(o),u_inv_rot_matrix:new Wm(o),u_merc_center:new Zh(o),u_tile_id:new D1(o),u_zoom_transition:new Ls(o),u_up_dir:new D1(o),u_emissive_strength:new Ls(o)}),h.bC=o=>({u_matrix:new Wm(o),u_pixels_to_tile_units:new fp(o),u_device_pixel_ratio:new Ls(o),u_units_to_pixels:new Zh(o),u_dash_image:new Zv(o),u_gradient_image:new Zv(o),u_image_height:new Ls(o),u_texsize:new Zh(o),u_tile_units_to_pixels:new Ls(o),u_alpha_discard_threshold:new Ls(o),u_trim_offset:new Zh(o),u_emissive_strength:new Ls(o)}),h.bD=o=>({u_matrix:new Wm(o),u_texsize:new Zh(o),u_pixels_to_tile_units:new fp(o),u_device_pixel_ratio:new Ls(o),u_image:new Zv(o),u_units_to_pixels:new Zh(o),u_tile_units_to_pixels:new Ls(o),u_alpha_discard_threshold:new Ls(o)}),h.bE=Os,h.bF=BT,h.bG=kw,h.bH=cT,h.bI=(o,i,a,l,d,p)=>{const g=o.transform,y="globe"===g.projection.name;let x;if("map"===p.paint.get("circle-pitch-alignment"))if(y){const D=_g(g.zoom,i.canonical)*g._pixelsPerMercatorPixel;x=Float32Array.from([D,0,0,D])}else x=g.calculatePixelsToTileUnitsMatrix(a);else x=new Float32Array([g.pixelsToGLUnits[0],0,0,g.pixelsToGLUnits[1]]);const C={u_camera_to_center_distance:o.transform.getCameraToCenterDistance(g.projection),u_matrix:o.translatePosMatrix(i.projMatrix,a,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_device_pixel_ratio:uo.devicePixelRatio,u_extrude_scale:x,u_inv_rot_matrix:Fb,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:p.paint.get("circle-emissive-strength")};if(y){C.u_inv_rot_matrix=l,C.u_merc_center=d,C.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],C.u_zoom_transition=Jc(g.zoom);const D=d[0]*Ht,M=d[1]*Ht;C.u_up_dir=g.projection.upVector(new nf(0,0,0),D,M)}return C},h.bJ=gC,h.bK=(o,i,a,l,d)=>{const p=o.transform;return{u_matrix:Xp(o,i,a,l),u_texsize:i.imageAtlasTexture?i.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:p.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:d,u_image:0,u_tile_units_to_pixels:mC(i,p),u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}},h.bL=(o,i,a,l,d,p,g)=>{const y=o.transform,x=y.calculatePixelsToTileUnitsMatrix(i);return{u_matrix:Xp(o,i,a,l),u_pixels_to_tile_units:x,u_device_pixel_ratio:p,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:d,u_texsize:_C(a)&&i.lineAtlasTexture?i.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:mC(i,o.transform),u_alpha_discard_threshold:0,u_trim_offset:g,u_emissive_strength:a.paint.get("line-emissive-strength")}},h.bM=ys,h.bN=qd,h.bO=uS,h.bP=cg,h.bQ=Mf,h.bR=ll,h.bS=450,h.bT=7,h.bU=Cb,h.bV=gg,h.bW=_n,h.bX=qh,h.bY=Nu,h.bZ=1,h.b_=771,h.ba=To,h.bb=function(o,i,a){const l=Jc(a.zoom),d=o.style.map._antialias,p=i.options.extStandardDerivativesForceOff||o.terrain&&o.terrain.exaggeration()>0;return 0===l&&!d&&!p},h.bc=function(o){const i=o.pixelsPerMeter,a=i/zo(1,o.center.lat),l=h.m.identity(new Float64Array(16));return h.m.translate(l,l,[o.point.x,o.point.y,0]),h.m.scale(l,l,[a,a,i]),Float32Array.from(l)},h.bd=Xs,h.be=hg,h.bf=function(o){const i=so-5;o=Hn(o,-i,i)/i*90;const a=Math.pow(Math.abs(Math.sin(Et(o))),3);return Math.round(a*(bb.length-1))},h.bg=function(o,i,a,l){const d=i.getNorth(),p=i.getSouth(),g=i.getWest(),y=i.getEast(),x=1<<o.z,C=y-g,D=d-p,M=C/64,k=-D/bb[a],P=[0,M,0,k,0,0,d,g,0];if(o.z>0){const F=180/l;h.bx.multiply(P,P,[F/C+1,0,0,0,F/D+1,0,-.5*F/M,.5*F/k,1])}return P[2]=x,P[5]=o.x,P[8]=o.y,P},h.bh=xp,h.bi=Kc,h.bj=function(o,i,a){const l=h.m.identity(new Float64Array(16)),d=(i/(1<<o)-.5)*Math.PI*2;return h.m.rotateY(l,a.globeMatrix,d),Float32Array.from(l)},h.bk=class{isDataAvailableAtPoint(o){const i=this._source();if(this.isUsingMockSource()||!i||o.y<0||o.y>1)return!1;const a=i.getSource().maxzoom,l=1<<a,d=Math.floor(o.x),p=Math.floor((o.x-d)*l),g=Math.floor(o.y*l),y=this.findDEMTileFor(new Po(a,d,a,p,g));return!(!y||!y.dem)}getAtPointOrZero(o,i=0){return this.getAtPoint(o,i)||0}getAtPoint(o,i,a=!0){if(this.isUsingMockSource())return null;null==i&&(i=null);const l=this._source();if(!l||o.y<0||o.y>1)return i;const d=l.getSource().maxzoom,p=1<<d,g=Math.floor(o.x),y=o.x-g,x=new Po(d,g,d,Math.floor(y*p),Math.floor(o.y*p)),C=this.findDEMTileFor(x);if(!C||!C.dem)return i;const D=C.dem,M=1<<C.tileID.canonical.z,k=(y*M-C.tileID.canonical.x)*D.dim,P=(o.y*M-C.tileID.canonical.y)*D.dim,F=Math.floor(k),B=Math.floor(P);return(a?this.exaggeration():1)*oi(oi(D.get(F,B),D.get(F,B+1),P-B),oi(D.get(F+1,B),D.get(F+1,B+1),P-B),k-F)}getAtTileOffset(o,i,a){const l=1<<o.canonical.z;return this.getAtPointOrZero(new Ko(o.wrap+(o.canonical.x+i/Ht)/l,(o.canonical.y+a/Ht)/l))}getAtTileOffsetFunc(o,i,a,l){return d=>{const p=this.getAtTileOffset(o,d.x,d.y),g=l.upVector(o.canonical,d.x,d.y),y=l.upVectorScale(o.canonical,i,a).metersToTile;return h.v.scale(g,g,p*y),g}}getForTilePoints(o,i,a,l){if(this.isUsingMockSource())return!1;const d=Fp.create(this,o,l);return!!d&&(i.forEach(p=>{p[2]=this.exaggeration()*d.getElevationAt(p[0],p[1],a)}),!0)}getMinMaxForTile(o){if(this.isUsingMockSource())return null;const i=this.findDEMTileFor(o);if(!i||!i.dem)return null;const a=i.dem.tree,l=i.tileID,d=1<<o.canonical.z-l.canonical.z;let p=o.canonical.x/d-l.canonical.x,g=o.canonical.y/d-l.canonical.y,y=0;for(let x=0;x<o.canonical.z-l.canonical.z&&!a.leaves[y];x++){p*=2,g*=2;const C=2*Math.floor(g)+Math.floor(p);y=a.childOffsets[y]+C,p%=1,g%=1}return{min:this.exaggeration()*a.minimums[y],max:this.exaggeration()*a.maximums[y]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(o,i,a){throw new Error("Pure virtual method called.")}pointCoordinate(o){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(o){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const o=this.visibleDemTiles;if(0===o.length)return null;let i=!1,a=Number.MAX_VALUE,l=Number.MIN_VALUE;for(const d of o){const p=this.getMinMaxForTile(d.tileID);p&&(a=Math.min(a,p.min),l=Math.max(l,p.max),i=!0)}return i?{min:a,max:l}:null}},h.bl=ag,h.bm=Dr,h.bn=sf,h.bo=un,h.bp=rr,h.bq=Ef,h.br=Pa,h.bs=Ky,h.bt=C0,h.bu=ka,h.bv=function(o,i){return[Math.pow(o[0],2.2)*i,Math.pow(o[1],2.2)*i,Math.pow(o[2],2.2)*i]},h.bw=function(o){return[Math.pow(o[0],1/2.2),Math.pow(o[1],1/2.2),Math.pow(o[2],1/2.2)]},h.by=_g,h.bz=256,h.c=Hn,h.c$=me,h.c0=jm,h.c1=function(o,i,a,l,d){return Hn((o-i)/(a-i)*(d-l)+l,l,d)},h.c2=Xa,h.c3=oo,h.c4=af,h.c5=oC,h.c6=[1,1,1],h.c7=Fp,h.c8=Hy,h.c9=Er,h.cA=da,h.cB=o=>wa(zm(o)),h.cC=re,h.cD=Ws,h.cE=Uo,h.cF=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},h.cG=ts,h.cH=lf,h.cI=Qc,h.cJ=function([o,i,a]){const l=Math.hypot(o,i,a),d=Math.atan2(o,a),p=.5*Math.PI-Math.acos(-i/l);return new er(Si(d),Si(p))},h.cK=Ia,h.cL=vg,h.cM=Oe,h.cN=Cp,h.cO=ry,h.cP=function(o){const i=[0,0,0],a=h.m.identity(new Float64Array(16));return h.m.multiply(a,o.pixelMatrix,o.globeMatrix),h.v.transformMat4(i,i,a),new Le(i[0],i[1])},h.cQ=function(o){const i=o.navigator?o.navigator.userAgent:null;return!!function(a){if(null==bt){const l=a.navigator?a.navigator.userAgent:null;bt=!!a.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return bt}(o)&&i&&(i.match("Version/15.4")||i.match("Version/15.5")||i.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},h.cR=qe,h.cS=class{constructor(o,i,a){this._transformRequestFn=o,this._customAccessToken=i,this._silenceAuthErrors=!!a,this._createSkuToken()}_createSkuToken(){const o=function(){let i="";for(let a=0;a<10;a++)i+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Yt,i].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=o.token,this._skuTokenExpiresAt=o.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(o,i){return this._transformRequestFn&&this._transformRequestFn(o,i)||{url:o}}normalizeStyleURL(o,i){if(!Nt(o))return o;const a=Rt(o);return a.params.push(`sdk=js-${me}`),a.path=`/styles/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||i)}normalizeGlyphsURL(o,i){if(!Nt(o))return o;const a=Rt(o);return a.path=`/fonts/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||i)}normalizeModelURL(o,i){if(!Nt(o))return o;const a=Rt(o);return a.path=`/models/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||i)}normalizeSourceURL(o,i,a,l){if(!Nt(o))return o;const d=Rt(o);return d.path=`/v4/${d.authority}.json`,d.params.push("secure"),a&&d.params.push(`language=${a}`),l&&d.params.push(`worldview=${l}`),this._makeAPIURL(d,this._customAccessToken||i)}normalizeSpriteURL(o,i,a,l){const d=Rt(o);return Nt(o)?(d.path=`/styles/v1${d.path}/sprite${i}${a}`,this._makeAPIURL(d,this._customAccessToken||l)):(d.path+=`${i}${a}`,Un(d))}normalizeTileURL(o,i,a){if(this._isSkuTokenExpired()&&this._createSkuToken(),o&&!Nt(o))return o;const l=Rt(o);l.path=l.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${i||a&&"raster"!==l.authority&&512===a?"@2x":""}${tt.supported?".webp":"$1"}`),"raster"===l.authority?l.path=`/${Oe.RASTER_URL_PREFIX}${l.path}`:(l.path=l.path.replace(/^.+\/v4\//,"/"),l.path=`/${Oe.TILE_URL_VERSION}${l.path}`);const d=this._customAccessToken||function(p){for(const g of p){const y=g.match(/^access_token=(.*)$/);if(y)return y[1]}return null}(l.params)||Oe.ACCESS_TOKEN;return Oe.REQUIRE_ACCESS_TOKEN&&d&&this._skuToken&&l.params.push(`sku=${this._skuToken}`),this._makeAPIURL(l,d)}canonicalizeTileURL(o,i){const a=Rt(o);if(!a.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!a.path.match(/\.[\w]+$/))return o;let l="mapbox://";a.path.match(/^\/raster\/v1\//)?l+=`raster/${a.path.replace(`/${Oe.RASTER_URL_PREFIX}/`,"")}`:l+=`tiles/${a.path.replace(`/${Oe.TILE_URL_VERSION}/`,"")}`;let d=a.params;return i&&(d=d.filter(p=>!p.match(/^access_token=/))),d.length&&(l+=`?${d.join("&")}`),l}canonicalizeTileset(o,i){const a=!!i&&Nt(i),l=[];for(const d of o.tiles||[])Mt(d)?l.push(this.canonicalizeTileURL(d,a)):l.push(d);return l}_makeAPIURL(o,i){const a="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",l=Rt(Oe.API_URL);if(o.protocol=l.protocol,o.authority=l.authority,"http"===o.protocol){const d=o.params.indexOf("secure");d>=0&&o.params.splice(d,1)}if("/"!==l.path&&(o.path=`${l.path}${o.path}`),!Oe.REQUIRE_ACCESS_TOKEN)return Un(o);if(i=i||Oe.ACCESS_TOKEN,!this._silenceAuthErrors){if(!i)throw new Error(`An API access token is required to use Mapbox GL. ${a}`);if("s"===i[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${a}`)}return o.params=o.params.filter(d=>-1===d.indexOf("access_token")),o.params.push(`access_token=${i||""}`),Un(o)}},h.cT=function(o,i){i?eo.add(o):eo.delete(o)},h.cU=tt,h.cV=ls,h.cW=Co,h.cX=Dt,h.cY=dr,h.cZ=function(o){eo.delete(o)},h.c_=Ho,h.ca=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(o){const i=Kg(new Le(0,0),new Le(Ht,Ht),o),a=[];for(const l of this._activeRegions){if(l.hiddenByOverlap||!th(i,l))continue;const d=jl(l.min,l.max,o);a.push({min:d.min,max:d.max,sourceId:this._sourceIds[l.priority],footprint:l.footprint,footprintTileId:l.tileId})}return a}setSources(o){this._setSources(o.map(i=>({getSourceId:()=>i.cache.id,getFootprints:()=>{const a=[];for(const l of i.cache.getVisibleCoordinates()){const d=i.cache.getTile(l).buckets[i.layer];if(d)for(const p of d.getNodesInfo()){const g=p.node;g.footprint&&a.push({footprint:g.footprint,id:l.toUnwrapped()})}}return a}})))}_addSource(o){const i=o.getFootprints();if(0!==i.length){for(const a of i){if(!a.footprint)continue;const l=Kg(a.footprint.min,a.footprint.max,a.id);this._activeRegions.push({min:l.min,max:l.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:a.id,footprint:a.footprint})}this._sourceIds.push(o.getSourceId())}}_computeReplacement(){this._activeRegions.sort((i,a)=>i.priority-a.priority||eh(i.min,a.min)||eh(i.max,a.max));let o=this._activeRegions.length!==this._prevRegions.length;if(!o){let i=0,a=0;for(;!o&&i!==this._activeRegions.length;){const l=this._activeRegions[i],d=this._prevRegions[a];o=l.priority!==d.priority||!Ds(l,d),++i,++a}}if(o){++this._updateTime;const i=a=>{const l=this._activeRegions;if(a>=l.length)return a;const d=l[a].priority;for(;a<l.length&&l[a].priority===d;)++a;return a};if(this._sourceIds.length>1){let a=0,l=i(a);for(;a!==l;){let d=a;const p=a;for(;d!==l;){const g=this._activeRegions[d];g.hiddenByOverlap=!1;for(let y=0;y<p;y++){const x=this._activeRegions[y];if(!x.hiddenByOverlap&&th(g,x)&&(g.hiddenByOverlap=Tf(g.footprint,g.tileId,x.footprint,x.tileId),g.hiddenByOverlap))break}++d}a=l,l=i(a)}}}}_setSources(o){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let i=o.length-1;i>=0;i--)this._addSource(o[i]);this._computeReplacement()}},h.cb=Cn,h.cc=Ny,h.cd=Gh,h.ce=class{constructor(o){this._createGrid(o),this._createPoles(o)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const o of this._poleSegments)o.destroy();for(const o of this._gridSegments)o.withSkirts.destroy(),o.withoutSkirts.destroy()}_fillGridMeshWithLods(o,i){const a=new un,l=new rr,d=[],p=o+1+2,g=i[0]+1,y=i[0]+1+(1+i.length),x=(C,D,M)=>{let k=C===p-1?C-2:0===C?C:C-1;return k+=M?24575:0,[k,D]};for(let C=0;C<p;++C)a.emplaceBack(...x(C,0,!0));for(let C=0;C<g;++C)for(let D=0;D<p;++D)a.emplaceBack(...x(D,C,(0===D||D===p-1)&&!0));for(let C=0;C<i.length;++C){const D=i[C];for(let M=0;M<p;++M)a.emplaceBack(...x(M,D,!0))}for(let C=0;C<i.length;++C){const D=l.length,M=i[C]+1+2,k=new rr;for(let B=0;B<M-1;B++){const j=B===M-2,q=j?p*(y-i.length+C-B):p;for(let te=0;te<p-1;te++){const ie=B*p+te;0===B||j||0===te||te===p-2?(k.emplaceBack(ie+1,ie,ie+q),k.emplaceBack(ie+q,ie+q+1,ie+1)):(l.emplaceBack(ie+1,ie,ie+q),l.emplaceBack(ie+q,ie+q+1,ie+1))}}const P=Dr.simpleSegment(0,D,a.length,l.length-D);for(let B=0;B<k.uint16.length;B+=3)l.emplaceBack(k.uint16[B],k.uint16[B+1],k.uint16[B+2]);const F=Dr.simpleSegment(0,D,a.length,l.length-D);d.push({withoutSkirts:P,withSkirts:F})}return{vertices:a,indices:l,segments:d}}_createGrid(o){const i=this._fillGridMeshWithLods(64,bb);this._gridSegments=i.segments,this._gridBuffer=o.createVertexBuffer(i.vertices,ag.members),this._gridIndexBuffer=o.createIndexBuffer(i.indices,!0)}_createPoles(o){const i=new rr;for(let g=0;g<=64;g++)i.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=o.createIndexBuffer(i,!0);const a=new Nu,l=new Nu,d=new Nu,p=new Nu;this._poleSegments=[];for(let g=0,y=0;g<ug;g++){const x=360/(1<<g);a.emplaceBack(0,-el,0,.5,0),l.emplaceBack(0,-el,0,.5,1),d.emplaceBack(0,-el,0,.5,.5),p.emplaceBack(0,-el,0,.5,.5);for(let C=0;C<=64;C++){let D=C/64,M=0;const k=oi(0,x,D),[P,F,B]=fg(Mb,yg,k,el);a.emplaceBack(P,F,B,D,M),l.emplaceBack(P,F,B,D,1-M);const j=Et(k);D=.5+.5*Math.sin(j),M=.5+.5*Math.cos(j),d.emplaceBack(P,F,B,D,M),p.emplaceBack(P,F,B,D,1-M)}this._poleSegments.push(Dr.simpleSegment(y,0,66,64)),y+=66}this._poleNorthVertexBuffer=o.createVertexBuffer(a,ey,!1),this._poleSouthVertexBuffer=o.createVertexBuffer(l,ey,!1),this._texturedPoleNorthVertexBuffer=o.createVertexBuffer(d,ey,!1),this._texturedPoleSouthVertexBuffer=o.createVertexBuffer(p,ey,!1)}getGridBuffers(o,i){return[this._gridBuffer,this._gridIndexBuffer,i?this._gridSegments[o].withSkirts:this._gridSegments[o].withoutSkirts]}getPoleBuffers(o,i){return[i?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,i?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[o]]}},h.cf=function(o){return eo.has(o)},h.cg=cf,h.ch=ve,h.ci=function(o){return o({pluginStatus:J,pluginURL:oe}),re.on("pluginStateChange",o),o},h.cj=vf,h.ck=c0,h.cl=So,h.cm=_e,h.cn=Nt,h.co=qs,h.cp=function(o,i,a){return"custom"===o.type?new wC(o,i):new EC[o.type](o,i,a)},h.cq=function(o){const i=o.indexOf("\x1f");return i>=0?o.slice(0,i):o},h.cr=o=>wa(lp(o)),h.cs=o=>wa(Bm(o)),h.ct=o=>wa(Pd(o)),h.cu=function(o){return o.indexOf("\x1f")>=0},h.cv=function(o){const i=o.indexOf("\x1f");return i>=0?o.slice(i+1):""},h.cw=ep,h.cx=function(o){const i=[],a=o.id;return void 0===a&&i.push({message:`layers.${a}: missing required property "id"`}),void 0===o.render&&i.push({message:`layers.${a}: missing required method "render"`}),o.renderingMode&&"2d"!==o.renderingMode&&"3d"!==o.renderingMode&&i.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),i},h.cy=o=>wa(Uh(o)),h.cz=o=>wa(kd(o)),h.d=Et,h.d0=function(o,i){Vn=o,$i=i},h.d1=function(o,i,a=!1){if(J===Y||J===ee||J===K)throw new Error("setRTLTextPlugin cannot be called multiple times.");oe=uo.resolveURL(o),J=Y,ne=i,ye(),a||be()},h.d2=ae,h.d3=function(){Ky().acquire(V0)},h.d4=function(){const o=Ur;o&&(o.isPreloaded()&&1===o.numActive()?(o.release(V0),Ur=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},h.d5=jr,h.d6=function(o){const i=Yi();if(!i)return;const a=i.delete(zn);o&&a.catch(o).then(()=>o())},h.d7=t_,h.d8=Qp,h.d9=function(o){j0=uo.resolveURL(o),Sr||(Sr=new Pa(Ky(),new pa)),Sr.broadcast("setDracoUrl",j0)},h.da=Va,h.db=Cy,h.dc=De,h.dd=Tp,h.de=Ig,h.df=Ge,h.dg=pf,h.dh=class extends pa{constructor(o,i,a,l,d,p){super(),this.actor=o,this.layerIndex=i,this.availableImages=a,this.loadVectorData=d||z0,this.loading={},this.loaded={},this.deduped=new it(o.scheduler),this.isSpriteLoaded=l,this.scheduler=o.scheduler,this.brightness=p}loadTile(o,i){const a=o.uid,l=o&&o.request,d=l&&l.collectResourceTiming,p=this.loading[a]=new ce(o);p.abort=this.loadVectorData(o,(g,y)=>{const x=!this.loading[a];if(delete this.loading[a],x||g||!y)return p.status="done",x||(this.loaded[a]=p),i(g);const C=y.rawData,D={};y.expires&&(D.expires=y.expires),y.cacheControl&&(D.cacheControl=y.cacheControl),p.vectorTile=y.vectorTile||new Yd(new Op(C));const M=()=>{p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,(k,P)=>{if(k||!P)return i(k);const F={};if(d){const B=_l(l);B.length>0&&(F.resourceTiming=JSON.parse(JSON.stringify(B)))}i(null,Gr({rawTileData:C.slice(0)},P,D,F))})};this.isSpriteLoaded?M():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(M,{type:"parseTile",isSymbolTile:o.isSymbolTile,zoom:o.tileZoom}):M()}),this.loaded=this.loaded||{},this.loaded[a]=p})}reloadTile(o,i){const a=this.loaded,l=o.uid,d=this;if(a&&a[l]){const p=a[l];p.showCollisionBoxes=o.showCollisionBoxes,p.projection=o.projection,p.brightness=o.brightness,p.tileTransform=ru(o.tileID.canonical,o.projection),p.extraShadowCaster=o.extraShadowCaster;const g=(y,x)=>{const C=p.reloadCallback;C&&(delete p.reloadCallback,p.parse(p.vectorTile,d.layerIndex,this.availableImages,d.actor,C)),i(y,x)};"parsing"===p.status?p.reloadCallback=g:"done"===p.status&&(p.vectorTile?p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,g):g())}else i(null,void 0)}abortTile(o,i){const a=o.uid,l=this.loading[a];l&&(l.abort&&l.abort(),delete this.loading[a]),i()}removeTile(o,i){const a=this.loaded,l=o.uid;a&&a[l]&&delete a[l],i()}},h.di=_l,h.dj=Mo,h.dk=Gu,h.dl=function(o){let i=0;if(new Uint32Array(o,0,1)[0]!==SC){const a=new Uint32Array(o,0,7),[,,l,d,p,g]=a;i=a.byteLength+d+p+g+p,(l!==o.byteLength||i>=o.byteLength)&&ar("Invalid b3dm header information.")}return H0(o,i)},h.dm=function(o,i){const a=kC(o);for(const l of a){for(const d of l.meshes)vS(d);l.lights&&(l.lightMeshIndex=l.meshes.length,l.meshes.push(q0(l.lights,i)))}return a},h.dn=lC,h.dp=DC,h.dq=Se,h.dr=function(o){Mi(),or&&or.then(i=>{i.keys().then(a=>{for(let l=0;l<a.length-o;l++)i.delete(a[l])})})},h.f=function(o,i){const{x:a,y:l}=o.point,d=wp(a,l,o.worldSize/o._pixelsPerMercatorPixel,0,0);return h.m.multiply(d,d,gg(Kc(i)))},h.g=cn,h.i=Xr,h.j=Pg,h.k=Py,h.l=os,h.n=oi,h.o=_0,h.p=function(o,i){const a={};for(let l=0;l<i.length;l++){const d=i[l];d in o&&(a[d]=o[d])}return a},h.r=tC,h.s=function(o,i,a){o[4*i+0]=a[0],o[4*i+1]=a[1],o[4*i+2]=a[2],o[4*i+3]=a[3]},h.t=nf,h.u=function(o,i,a,l,d){const p=5*i+2;o.float32[p+0]=a,o.float32[p+1]=l,o.float32[p+2]=d},h.w=wn,h.x=Eb,h.y=function(o,i,a,l,d,p,g,y,x){if("globe"===x.name)return Eb(o,i,new nf(a,l,d),!1);const C=ru({z:a,x:l,y:d},x);return new oo([(p+C.x/C.scale)*i,i*(C.y/C.scale),g],[(p+C.x2/C.scale)*i,i*(C.y2/C.scale),y])},h.z=function(o,i,a){let l=0;for(let d=0;d<2;++d){const p=a?a[d]:0;o[d]>p&&(l+=(o[d]-p)*(o[d]-p)),i[d]<p&&(l+=(p-i[d])*(p-i[d]))}return l}}),gt(0,function(h){function me(Ot){if("number"==typeof Ot||"boolean"==typeof Ot||"string"==typeof Ot||null==Ot)return JSON.stringify(Ot);if(Array.isArray(Ot)){let ve="[";for(const Re of Ot)ve+=`${me(Re)},`;return`${ve}]`}let ge="{";for(const ve of Object.keys(Ot).sort())ge+=`${ve}:${me(Ot[ve])},`;return`${ge}}`}function Xe(Ot){let ge="";for(const ve of h.aS)ge+=`/${me(Ot[ve])}`;return ge}class Oe{constructor(ge){this.keyCache={},this._layers={},this._layerConfigs={},ge&&this.replace(ge)}replace(ge,ve){this._layerConfigs={},this._layers={},this.update(ge,[],ve)}update(ge,ve,Re){this._options=Re;for(const bt of ge)this._layerConfigs[bt.id]=bt,(this._layers[bt.id]=h.cp(bt,this.scope,this._options)).compileFilter(),this.keyCache[bt.id]&&delete this.keyCache[bt.id];for(const bt of ve)delete this.keyCache[bt],delete this._layerConfigs[bt],delete this._layers[bt];this.familiesBySource={};const St=function(bt,Lt){const cn={};for(let En=0;En<bt.length;En++){const zn=Lt&&Lt[bt[En].id]||Xe(bt[En]);Lt&&(Lt[bt[En].id]=zn);let Vn=cn[zn];Vn||(Vn=cn[zn]=[]),Vn.push(bt[En])}const kt=[];for(const En in cn)kt.push(cn[En]);return kt}(h.da(this._layerConfigs),this.keyCache);for(const bt of St){const Lt=bt.map($i=>this._layers[$i.id]),cn=Lt[0];if("none"===cn.visibility)continue;const kt=cn.source||"";let En=this.familiesBySource[kt];En||(En=this.familiesBySource[kt]={});const zn=cn.sourceLayer||"_geojsonTileLayer";let Vn=En[zn];Vn||(Vn=En[zn]=[]),Vn.push(Lt)}}}class tt{loadTile(ge,ve){const{uid:Re,encoding:St,rawImageData:bt,padding:Lt}=ge,cn=ImageBitmap&&bt instanceof ImageBitmap?this.getImageData(bt,Lt):bt;ve(null,new h.db(Re,cn,St,Lt<1))}getImageData(ge,ve){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ge.width,ge.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ge.width,this.offscreenCanvas.height=ge.height,this.offscreenCanvasContext.drawImage(ge,0,0,ge.width,ge.height);const Re=this.offscreenCanvasContext.getImageData(-ve,-ve,ge.width+2*ve,ge.height+2*ve);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Re}}function Ye(Ot,ge){if(0!==Ot.length){Vt(Ot[0],ge);for(var ve=1;ve<Ot.length;ve++)Vt(Ot[ve],!ge)}}function Vt(Ot,ge){for(var ve=0,Re=0,St=0,bt=Ot.length,Lt=bt-1;St<bt;Lt=St++){var cn=(Ot[St][0]-Ot[Lt][0])*(Ot[Lt][1]+Ot[St][1]),kt=ve+cn;Re+=Math.abs(ve)>=Math.abs(cn)?ve-kt+cn:cn-kt+ve,ve=kt}ve+Re>=0!=!!ge&&Ot.reverse()}var Fn=h.dc(function Ot(ge,ve){var Re,St=ge&&ge.type;if("FeatureCollection"===St)for(Re=0;Re<ge.features.length;Re++)Ot(ge.features[Re],ve);else if("GeometryCollection"===St)for(Re=0;Re<ge.geometries.length;Re++)Ot(ge.geometries[Re],ve);else if("Feature"===St)Ot(ge.geometry,ve);else if("Polygon"===St)Ye(ge.coordinates,ve);else if("MultiPolygon"===St)for(Re=0;Re<ge.coordinates.length;Re++)Ye(ge.coordinates[Re],ve);return ge});const pn=h.dd.prototype.toGeoJSON;var vn={exports:{}},en=h.df,Yt=h.de.VectorTileFeature,De=ct;function ct(Ot,ge){this.options=ge||{},this.features=Ot,this.length=Ot.length}function qt(Ot,ge){this.id="number"==typeof Ot.id?Ot.id:void 0,this.type=Ot.type,this.rawGeometry=1===Ot.type?[Ot.geometry]:Ot.geometry,this.properties=Ot.tags,this.extent=ge||4096}ct.prototype.feature=function(Ot){return new qt(this.features[Ot],this.options.extent)},qt.prototype.loadGeometry=function(){var Ot=this.rawGeometry;this.geometry=[];for(var ge=0;ge<Ot.length;ge++){for(var ve=Ot[ge],Re=[],St=0;St<ve.length;St++)Re.push(new en(ve[St][0],ve[St][1]));this.geometry.push(Re)}return this.geometry},qt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ot=this.geometry,ge=1/0,ve=-1/0,Re=1/0,St=-1/0,bt=0;bt<Ot.length;bt++)for(var Lt=Ot[bt],cn=0;cn<Lt.length;cn++){var kt=Lt[cn];ge=Math.min(ge,kt.x),ve=Math.max(ve,kt.x),Re=Math.min(Re,kt.y),St=Math.max(St,kt.y)}return[ge,Re,ve,St]},qt.prototype.toGeoJSON=Yt.prototype.toGeoJSON;var nt=h.dg,Ge=De;function Ct(Ot){var ge=new nt;return function(ve,Re){for(var St in ve.layers)Re.writeMessage(3,Le,ve.layers[St])}(Ot,ge),ge.finish()}function Le(Ot,ge){var ve;ge.writeVarintField(15,Ot.version||1),ge.writeStringField(1,Ot.name||""),ge.writeVarintField(5,Ot.extent||4096);var Re={keys:[],values:[],keycache:{},valuecache:{}};for(ve=0;ve<Ot.length;ve++)Re.feature=Ot.feature(ve),ge.writeMessage(2,Qt,Re);var St=Re.keys;for(ve=0;ve<St.length;ve++)ge.writeStringField(3,St[ve]);var bt=Re.values;for(ve=0;ve<bt.length;ve++)ge.writeMessage(4,To,bt[ve])}function Qt(Ot,ge){var ve=Ot.feature;void 0!==ve.id&&ge.writeVarintField(1,ve.id),ge.writeMessage(2,xn,Ot),ge.writeVarintField(3,ve.type),ge.writeMessage(4,mr,ve)}function xn(Ot,ge){var ve=Ot.feature,Re=Ot.keys,St=Ot.values,bt=Ot.keycache,Lt=Ot.valuecache;for(var cn in ve.properties){var kt=ve.properties[cn],En=bt[cn];if(null!==kt){void 0===En&&(Re.push(cn),bt[cn]=En=Re.length-1),ge.writeVarint(En);var zn=typeof kt;"string"!==zn&&"boolean"!==zn&&"number"!==zn&&(kt=JSON.stringify(kt));var Vn=zn+":"+kt,$i=Lt[Vn];void 0===$i&&(St.push(kt),Lt[Vn]=$i=St.length-1),ge.writeVarint($i)}}}function Et(Ot,ge){return(ge<<3)+(7&Ot)}function Si(Ot){return Ot<<1^Ot>>31}function mr(Ot,ge){for(var ve=Ot.loadGeometry(),Re=Ot.type,St=0,bt=0,Lt=ve.length,cn=0;cn<Lt;cn++){var kt=ve[cn],En=1;1===Re&&(En=kt.length),ge.writeVarint(Et(1,En));for(var zn=3===Re?kt.length-1:kt.length,Vn=0;Vn<zn;Vn++){1===Vn&&1!==Re&&ge.writeVarint(Et(2,zn-1));var $i=kt[Vn].x-St,or=kt[Vn].y-bt;ge.writeVarint(Si($i)),ge.writeVarint(Si(or)),St+=$i,bt+=or}3===Re&&ge.writeVarint(Et(7,1))}}function To(Ot,ge){var ve=typeof Ot;"string"===ve?ge.writeStringField(1,Ot):"boolean"===ve?ge.writeBooleanField(7,Ot):"number"===ve&&(Ot%1!=0?ge.writeDoubleField(3,Ot):Ot<0?ge.writeSVarintField(6,Ot):ge.writeVarintField(5,Ot))}vn.exports=Ct,vn.exports.fromVectorTileJs=Ct,vn.exports.fromGeojsonVt=function(Ot,ge){ge=ge||{};var ve={};for(var Re in Ot)ve[Re]=new Ge(Ot[Re].features,ge),ve[Re].name=Re,ve[Re].version=ge.version,ve[Re].extent=ge.extent;return Ct({layers:ve})},vn.exports.GeoJSONWrapper=Ge;var Uo=h.dc(vn.exports);const ts={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ot=>Ot},Hn=Math.fround||(Is=new Float32Array(1),Ot=>(Is[0]=+Ot,Is[0]));var Is;const wn=3,Ho=5,Va=6;class Gr{constructor(ge){this.options=Object.assign(Object.create(ts),ge),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ge){const{log:ve,minZoom:Re,maxZoom:St}=this.options;ve&&console.time("total time");const bt=`prepare ${ge.length} points`;ve&&console.time(bt),this.points=ge;const Lt=[];for(let kt=0;kt<ge.length;kt++){const En=ge[kt];if(!En.geometry)continue;const[zn,Vn]=En.geometry.coordinates,$i=Hn(ua(zn)),or=Hn(ys(Vn));Lt.push($i,or,1/0,kt,-1,1),this.options.reduce&&Lt.push(0)}let cn=this.trees[St+1]=this._createTree(Lt);ve&&console.timeEnd(bt);for(let kt=St;kt>=Re;kt--){const En=+Date.now();cn=this.trees[kt]=this._createTree(this._cluster(cn,kt)),ve&&console.log("z%d: %d clusters in %dms",kt,cn.numItems,+Date.now()-En)}return ve&&console.timeEnd("total time"),this}getClusters(ge,ve){let Re=((ge[0]+180)%360+360)%360-180;const St=Math.max(-90,Math.min(90,ge[1]));let bt=180===ge[2]?180:((ge[2]+180)%360+360)%360-180;const Lt=Math.max(-90,Math.min(90,ge[3]));if(ge[2]-ge[0]>=360)Re=-180,bt=180;else if(Re>bt){const Vn=this.getClusters([Re,St,180,Lt],ve),$i=this.getClusters([-180,St,bt,Lt],ve);return Vn.concat($i)}const cn=this.trees[this._limitZoom(ve)],kt=cn.range(ua(Re),ys(Lt),ua(bt),ys(St)),En=cn.data,zn=[];for(const Vn of kt){const $i=this.stride*Vn;zn.push(En[$i+Ho]>1?ja(En,$i,this.clusterProps):this.points[En[$i+wn]])}return zn}getChildren(ge){const ve=this._getOriginId(ge),Re=this._getOriginZoom(ge),St="No cluster with the specified id.",bt=this.trees[Re];if(!bt)throw new Error(St);const Lt=bt.data;if(ve*this.stride>=Lt.length)throw new Error(St);const cn=this.options.radius/(this.options.extent*Math.pow(2,Re-1)),kt=bt.within(Lt[ve*this.stride],Lt[ve*this.stride+1],cn),En=[];for(const zn of kt){const Vn=zn*this.stride;Lt[Vn+4]===ge&&En.push(Lt[Vn+Ho]>1?ja(Lt,Vn,this.clusterProps):this.points[Lt[Vn+wn]])}if(0===En.length)throw new Error(St);return En}getLeaves(ge,ve,Re){const St=[];return this._appendLeaves(St,ge,ve=ve||10,Re=Re||0,0),St}getTile(ge,ve,Re){const St=this.trees[this._limitZoom(ge)],bt=Math.pow(2,ge),{extent:Lt,radius:cn}=this.options,kt=cn/Lt,En=(Re-kt)/bt,zn=(Re+1+kt)/bt,Vn={features:[]};return this._addTileFeatures(St.range((ve-kt)/bt,En,(ve+1+kt)/bt,zn),St.data,ve,Re,bt,Vn),0===ve&&this._addTileFeatures(St.range(1-kt/bt,En,1,zn),St.data,bt,Re,bt,Vn),ve===bt-1&&this._addTileFeatures(St.range(0,En,kt/bt,zn),St.data,-1,Re,bt,Vn),Vn.features.length?Vn:null}getClusterExpansionZoom(ge){let ve=this._getOriginZoom(ge)-1;for(;ve<=this.options.maxZoom;){const Re=this.getChildren(ge);if(ve++,1!==Re.length)break;ge=Re[0].properties.cluster_id}return ve}_appendLeaves(ge,ve,Re,St,bt){const Lt=this.getChildren(ve);for(const cn of Lt){const kt=cn.properties;if(kt&&kt.cluster?bt+kt.point_count<=St?bt+=kt.point_count:bt=this._appendLeaves(ge,kt.cluster_id,Re,St,bt):bt<St?bt++:ge.push(cn),ge.length===Re)break}return bt}_createTree(ge){const ve=new h.aZ(ge.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Re=0;Re<ge.length;Re+=this.stride)ve.add(ge[Re],ge[Re+1]);return ve.finish(),ve.data=ge,ve}_addTileFeatures(ge,ve,Re,St,bt,Lt){for(const cn of ge){const kt=cn*this.stride,En=ve[kt+Ho]>1;let zn,Vn,$i;if(En)zn=qe(ve,kt,this.clusterProps),Vn=ve[kt],$i=ve[kt+1];else{const Yi=this.points[ve[kt+wn]];zn=Yi.properties;const[Mi,Xi]=Yi.geometry.coordinates;Vn=ua(Mi),$i=ys(Xi)}const or={type:1,geometry:[[Math.round(this.options.extent*(Vn*bt-Re)),Math.round(this.options.extent*($i*bt-St))]],tags:zn};let lr;lr=En||this.options.generateId?ve[kt+wn]:this.points[ve[kt+wn]].id,void 0!==lr&&(or.id=lr),Lt.features.push(or)}}_limitZoom(ge){return Math.max(this.options.minZoom,Math.min(Math.floor(+ge),this.options.maxZoom+1))}_cluster(ge,ve){const{radius:Re,extent:St,reduce:bt,minPoints:Lt}=this.options,cn=Re/(St*Math.pow(2,ve)),kt=ge.data,En=[],zn=this.stride;for(let Vn=0;Vn<kt.length;Vn+=zn){if(kt[Vn+2]<=ve)continue;kt[Vn+2]=ve;const $i=kt[Vn],or=kt[Vn+1],lr=ge.within(kt[Vn],kt[Vn+1],cn),Yi=kt[Vn+Ho];let Mi=Yi;for(const Xi of lr){const zr=Xi*zn;kt[zr+2]>ve&&(Mi+=kt[zr+Ho])}if(Mi>Yi&&Mi>=Lt){let Xi,zr=$i*Yi,qr=or*Yi,vs=-1;const So=((Vn/zn|0)<<5)+(ve+1)+this.points.length;for(const Ws of lr){const Mo=Ws*zn;if(kt[Mo+2]<=ve)continue;kt[Mo+2]=ve;const Zs=kt[Mo+Ho];zr+=kt[Mo]*Zs,qr+=kt[Mo+1]*Zs,kt[Mo+4]=So,bt&&(Xi||(Xi=this._map(kt,Vn,!0),vs=this.clusterProps.length,this.clusterProps.push(Xi)),bt(Xi,this._map(kt,Mo)))}kt[Vn+4]=So,En.push(zr/Mi,qr/Mi,1/0,So,-1,Mi),bt&&En.push(vs)}else{for(let Xi=0;Xi<zn;Xi++)En.push(kt[Vn+Xi]);if(Mi>1)for(const Xi of lr){const zr=Xi*zn;if(!(kt[zr+2]<=ve)){kt[zr+2]=ve;for(let qr=0;qr<zn;qr++)En.push(kt[zr+qr])}}}}return En}_getOriginId(ge){return ge-this.points.length>>5}_getOriginZoom(ge){return(ge-this.points.length)%32}_map(ge,ve,Re){if(ge[ve+Ho]>1){const Lt=this.clusterProps[ge[ve+Va]];return Re?Object.assign({},Lt):Lt}const St=this.points[ge[ve+wn]].properties,bt=this.options.map(St);return Re&&bt===St?Object.assign({},bt):bt}}function ja(Ot,ge,ve){return{type:"Feature",id:Ot[ge+wn],properties:qe(Ot,ge,ve),geometry:{type:"Point",coordinates:[(Re=Ot[ge],360*(Re-.5)),ur(Ot[ge+1])]}};var Re}function qe(Ot,ge,ve){const Re=Ot[ge+Ho],St=Re>=1e4?`${Math.round(Re/1e3)}k`:Re>=1e3?Math.round(Re/100)/10+"k":Re,bt=Ot[ge+Va],Lt=-1===bt?{}:Object.assign({},ve[bt]);return Object.assign(Lt,{cluster:!0,cluster_id:Ot[ge+wn],point_count:Re,point_count_abbreviated:St})}function ua(Ot){return Ot/360+.5}function ys(Ot){const ge=Math.sin(Ot*Math.PI/180),ve=.5-.25*Math.log((1+ge)/(1-ge))/Math.PI;return ve<0?0:ve>1?1:ve}function ur(Ot){const ge=(180-360*Ot)*Math.PI/180;return 360*Math.atan(Math.exp(ge))/Math.PI-90}var ai={exports:{}};ai.exports=function(){function Ot(ut,rt,Dt,Nt){for(var Mt,Wt=Nt,Zt=Dt-rt>>1,jt=Dt-rt,Ft=ut[rt],Rt=ut[rt+1],Un=ut[Dt],xi=ut[Dt+1],tn=rt+3;tn<Dt;tn+=3){var ni=ge(ut[tn],ut[tn+1],Ft,Rt,Un,xi);if(ni>Wt)Mt=tn,Wt=ni;else if(ni===Wt){var Ai=Math.abs(tn-Zt);Ai<jt&&(Mt=tn,jt=Ai)}}Wt>Nt&&(Mt-rt>3&&Ot(ut,rt,Mt,Nt),ut[Mt+2]=Wt,Dt-Mt>3&&Ot(ut,Mt,Dt,Nt))}function ge(ut,rt,Dt,Nt,Mt,Wt){var Zt=Mt-Dt,jt=Wt-Nt;if(0!==Zt||0!==jt){var Ft=((ut-Dt)*Zt+(rt-Nt)*jt)/(Zt*Zt+jt*jt);Ft>1?(Dt=Mt,Nt=Wt):Ft>0&&(Dt+=Zt*Ft,Nt+=jt*Ft)}return(Zt=ut-Dt)*Zt+(jt=rt-Nt)*jt}function ve(ut,rt,Dt,Nt){var Mt={id:void 0===ut?null:ut,type:rt,geometry:Dt,tags:Nt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Wt){var Zt=Wt.geometry,jt=Wt.type;if("Point"===jt||"MultiPoint"===jt||"LineString"===jt)Re(Wt,Zt);else if("Polygon"===jt||"MultiLineString"===jt)for(var Ft=0;Ft<Zt.length;Ft++)Re(Wt,Zt[Ft]);else if("MultiPolygon"===jt)for(Ft=0;Ft<Zt.length;Ft++)for(var Rt=0;Rt<Zt[Ft].length;Rt++)Re(Wt,Zt[Ft][Rt])}(Mt),Mt}function Re(ut,rt){for(var Dt=0;Dt<rt.length;Dt+=3)ut.minX=Math.min(ut.minX,rt[Dt]),ut.minY=Math.min(ut.minY,rt[Dt+1]),ut.maxX=Math.max(ut.maxX,rt[Dt]),ut.maxY=Math.max(ut.maxY,rt[Dt+1])}function St(ut,rt,Dt,Nt){if(rt.geometry){var Mt=rt.geometry.coordinates,Wt=rt.geometry.type,Zt=Math.pow(Dt.tolerance/((1<<Dt.maxZoom)*Dt.extent),2),jt=[],Ft=rt.id;if(Dt.promoteId?Ft=rt.properties[Dt.promoteId]:Dt.generateId&&(Ft=Nt||0),"Point"===Wt)bt(Mt,jt);else if("MultiPoint"===Wt)for(var Rt=0;Rt<Mt.length;Rt++)bt(Mt[Rt],jt);else if("LineString"===Wt)Lt(Mt,jt,Zt,!1);else if("MultiLineString"===Wt){if(Dt.lineMetrics){for(Rt=0;Rt<Mt.length;Rt++)Lt(Mt[Rt],jt=[],Zt,!1),ut.push(ve(Ft,"LineString",jt,rt.properties));return}cn(Mt,jt,Zt,!1)}else if("Polygon"===Wt)cn(Mt,jt,Zt,!0);else{if("MultiPolygon"!==Wt){if("GeometryCollection"===Wt){for(Rt=0;Rt<rt.geometry.geometries.length;Rt++)St(ut,{id:Ft,geometry:rt.geometry.geometries[Rt],properties:rt.properties},Dt,Nt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Rt=0;Rt<Mt.length;Rt++){var Un=[];cn(Mt[Rt],Un,Zt,!0),jt.push(Un)}}ut.push(ve(Ft,Wt,jt,rt.properties))}}function bt(ut,rt){rt.push(kt(ut[0])),rt.push(En(ut[1])),rt.push(0)}function Lt(ut,rt,Dt,Nt){for(var Mt,Wt,Zt=0,jt=0;jt<ut.length;jt++){var Ft=kt(ut[jt][0]),Rt=En(ut[jt][1]);rt.push(Ft),rt.push(Rt),rt.push(0),jt>0&&(Zt+=Nt?(Mt*Rt-Ft*Wt)/2:Math.sqrt(Math.pow(Ft-Mt,2)+Math.pow(Rt-Wt,2))),Mt=Ft,Wt=Rt}var Un=rt.length-3;rt[2]=1,Ot(rt,0,Un,Dt),rt[Un+2]=1,rt.size=Math.abs(Zt),rt.start=0,rt.end=rt.size}function cn(ut,rt,Dt,Nt){for(var Mt=0;Mt<ut.length;Mt++){var Wt=[];Lt(ut[Mt],Wt,Dt,Nt),rt.push(Wt)}}function kt(ut){return ut/360+.5}function En(ut){var rt=Math.sin(ut*Math.PI/180),Dt=.5-.25*Math.log((1+rt)/(1-rt))/Math.PI;return Dt<0?0:Dt>1?1:Dt}function zn(ut,rt,Dt,Nt,Mt,Wt,Zt,jt){if(Nt/=rt,Wt>=(Dt/=rt)&&Zt<Nt)return ut;if(Zt<Dt||Wt>=Nt)return null;for(var Ft=[],Rt=0;Rt<ut.length;Rt++){var Un=ut[Rt],xi=Un.geometry,tn=Un.type,ni=0===Mt?Un.minX:Un.minY,Ai=0===Mt?Un.maxX:Un.maxY;if(ni>=Dt&&Ai<Nt)Ft.push(Un);else if(!(Ai<Dt||ni>=Nt)){var Ir=[];if("Point"===tn||"MultiPoint"===tn)Vn(xi,Ir,Dt,Nt,Mt);else if("LineString"===tn)$i(xi,Ir,Dt,Nt,Mt,!1,jt.lineMetrics);else if("MultiLineString"===tn)lr(xi,Ir,Dt,Nt,Mt,!1);else if("Polygon"===tn)lr(xi,Ir,Dt,Nt,Mt,!0);else if("MultiPolygon"===tn)for(var xr=0;xr<xi.length;xr++){var dr=[];lr(xi[xr],dr,Dt,Nt,Mt,!0),dr.length&&Ir.push(dr)}if(Ir.length){if(jt.lineMetrics&&"LineString"===tn){for(xr=0;xr<Ir.length;xr++)Ft.push(ve(Un.id,tn,Ir[xr],Un.tags));continue}"LineString"!==tn&&"MultiLineString"!==tn||(1===Ir.length?(tn="LineString",Ir=Ir[0]):tn="MultiLineString"),"Point"!==tn&&"MultiPoint"!==tn||(tn=3===Ir.length?"Point":"MultiPoint"),Ft.push(ve(Un.id,tn,Ir,Un.tags))}}}return Ft.length?Ft:null}function Vn(ut,rt,Dt,Nt,Mt){for(var Wt=0;Wt<ut.length;Wt+=3){var Zt=ut[Wt+Mt];Zt>=Dt&&Zt<=Nt&&(rt.push(ut[Wt]),rt.push(ut[Wt+1]),rt.push(ut[Wt+2]))}}function $i(ut,rt,Dt,Nt,Mt,Wt,Zt){for(var jt,Ft,Rt=or(ut),Un=0===Mt?Mi:Xi,xi=ut.start,tn=0;tn<ut.length-3;tn+=3){var ni=ut[tn],Ai=ut[tn+1],Ir=ut[tn+2],xr=ut[tn+3],dr=ut[tn+4],bs=0===Mt?ni:Ai,ls=0===Mt?xr:dr,cs=!1;Zt&&(jt=Math.sqrt(Math.pow(ni-xr,2)+Math.pow(Ai-dr,2))),bs<Dt?ls>Dt&&(Ft=Un(Rt,ni,Ai,xr,dr,Dt),Zt&&(Rt.start=xi+jt*Ft)):bs>Nt?ls<Nt&&(Ft=Un(Rt,ni,Ai,xr,dr,Nt),Zt&&(Rt.start=xi+jt*Ft)):Yi(Rt,ni,Ai,Ir),ls<Dt&&bs>=Dt&&(Ft=Un(Rt,ni,Ai,xr,dr,Dt),cs=!0),ls>Nt&&bs<=Nt&&(Ft=Un(Rt,ni,Ai,xr,dr,Nt),cs=!0),!Wt&&cs&&(Zt&&(Rt.end=xi+jt*Ft),rt.push(Rt),Rt=or(ut)),Zt&&(xi+=jt)}var Co=ut.length-3;ni=ut[Co],Ai=ut[Co+1],Ir=ut[Co+2],(bs=0===Mt?ni:Ai)>=Dt&&bs<=Nt&&Yi(Rt,ni,Ai,Ir),Co=Rt.length-3,Wt&&Co>=3&&(Rt[Co]!==Rt[0]||Rt[Co+1]!==Rt[1])&&Yi(Rt,Rt[0],Rt[1],Rt[2]),Rt.length&&rt.push(Rt)}function or(ut){var rt=[];return rt.size=ut.size,rt.start=ut.start,rt.end=ut.end,rt}function lr(ut,rt,Dt,Nt,Mt,Wt){for(var Zt=0;Zt<ut.length;Zt++)$i(ut[Zt],rt,Dt,Nt,Mt,Wt,!1)}function Yi(ut,rt,Dt,Nt){ut.push(rt),ut.push(Dt),ut.push(Nt)}function Mi(ut,rt,Dt,Nt,Mt,Wt){var Zt=(Wt-rt)/(Nt-rt);return ut.push(Wt),ut.push(Dt+(Mt-Dt)*Zt),ut.push(1),Zt}function Xi(ut,rt,Dt,Nt,Mt,Wt){var Zt=(Wt-Dt)/(Mt-Dt);return ut.push(rt+(Nt-rt)*Zt),ut.push(Wt),ut.push(1),Zt}function zr(ut,rt){for(var Dt=[],Nt=0;Nt<ut.length;Nt++){var Mt,Wt=ut[Nt],Zt=Wt.type;if("Point"===Zt||"MultiPoint"===Zt||"LineString"===Zt)Mt=qr(Wt.geometry,rt);else if("MultiLineString"===Zt||"Polygon"===Zt){Mt=[];for(var jt=0;jt<Wt.geometry.length;jt++)Mt.push(qr(Wt.geometry[jt],rt))}else if("MultiPolygon"===Zt)for(Mt=[],jt=0;jt<Wt.geometry.length;jt++){for(var Ft=[],Rt=0;Rt<Wt.geometry[jt].length;Rt++)Ft.push(qr(Wt.geometry[jt][Rt],rt));Mt.push(Ft)}Dt.push(ve(Wt.id,Zt,Mt,Wt.tags))}return Dt}function qr(ut,rt){var Dt=[];Dt.size=ut.size,void 0!==ut.start&&(Dt.start=ut.start,Dt.end=ut.end);for(var Nt=0;Nt<ut.length;Nt+=3)Dt.push(ut[Nt]+rt,ut[Nt+1],ut[Nt+2]);return Dt}function vs(ut,rt){if(ut.transformed)return ut;var Dt,Nt,Mt,Wt=1<<ut.z,Zt=ut.x,jt=ut.y;for(Dt=0;Dt<ut.features.length;Dt++){var Ft=ut.features[Dt],Rt=Ft.geometry,Un=Ft.type;if(Ft.geometry=[],1===Un)for(Nt=0;Nt<Rt.length;Nt+=2)Ft.geometry.push(So(Rt[Nt],Rt[Nt+1],rt,Wt,Zt,jt));else for(Nt=0;Nt<Rt.length;Nt++){var xi=[];for(Mt=0;Mt<Rt[Nt].length;Mt+=2)xi.push(So(Rt[Nt][Mt],Rt[Nt][Mt+1],rt,Wt,Zt,jt));Ft.geometry.push(xi)}}return ut.transformed=!0,ut}function So(ut,rt,Dt,Nt,Mt,Wt){return[Math.round(Dt*(ut*Nt-Mt)),Math.round(Dt*(rt*Nt-Wt))]}function Ws(ut,rt,Dt,Nt,Mt){for(var Wt=rt===Mt.maxZoom?0:Mt.tolerance/((1<<rt)*Mt.extent),Zt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Dt,y:Nt,z:rt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},jt=0;jt<ut.length;jt++){Zt.numFeatures++,Mo(Zt,ut[jt],Wt,Mt);var Ft=ut[jt].minX,Rt=ut[jt].minY,Un=ut[jt].maxX,xi=ut[jt].maxY;Ft<Zt.minX&&(Zt.minX=Ft),Rt<Zt.minY&&(Zt.minY=Rt),Un>Zt.maxX&&(Zt.maxX=Un),xi>Zt.maxY&&(Zt.maxY=xi)}return Zt}function Mo(ut,rt,Dt,Nt){var Mt=rt.geometry,Wt=rt.type,Zt=[];if("Point"===Wt||"MultiPoint"===Wt)for(var jt=0;jt<Mt.length;jt+=3)Zt.push(Mt[jt]),Zt.push(Mt[jt+1]),ut.numPoints++,ut.numSimplified++;else if("LineString"===Wt)Zs(Zt,Mt,ut,Dt,!1,!1);else if("MultiLineString"===Wt||"Polygon"===Wt)for(jt=0;jt<Mt.length;jt++)Zs(Zt,Mt[jt],ut,Dt,"Polygon"===Wt,0===jt);else if("MultiPolygon"===Wt)for(var Ft=0;Ft<Mt.length;Ft++){var Rt=Mt[Ft];for(jt=0;jt<Rt.length;jt++)Zs(Zt,Rt[jt],ut,Dt,!0,0===jt)}if(Zt.length){var Un=rt.tags||null;if("LineString"===Wt&&Nt.lineMetrics){for(var xi in Un={},rt.tags)Un[xi]=rt.tags[xi];Un.mapbox_clip_start=Mt.start/Mt.size,Un.mapbox_clip_end=Mt.end/Mt.size}var tn={geometry:Zt,type:"Polygon"===Wt||"MultiPolygon"===Wt?3:"LineString"===Wt||"MultiLineString"===Wt?2:1,tags:Un};null!==rt.id&&(tn.id=rt.id),ut.features.push(tn)}}function Zs(ut,rt,Dt,Nt,Mt,Wt){var Zt=Nt*Nt;if(Nt>0&&rt.size<(Mt?Zt:Nt))Dt.numPoints+=rt.length/3;else{for(var jt=[],Ft=0;Ft<rt.length;Ft+=3)(0===Nt||rt[Ft+2]>Zt)&&(Dt.numSimplified++,jt.push(rt[Ft]),jt.push(rt[Ft+1])),Dt.numPoints++;Mt&&function(Rt,Un){for(var xi=0,tn=0,ni=Rt.length,Ai=ni-2;tn<ni;Ai=tn,tn+=2)xi+=(Rt[tn]-Rt[Ai])*(Rt[tn+1]+Rt[Ai+1]);if(xi>0===Un)for(tn=0,ni=Rt.length;tn<ni/2;tn+=2){var Ir=Rt[tn],xr=Rt[tn+1];Rt[tn]=Rt[ni-2-tn],Rt[tn+1]=Rt[ni-1-tn],Rt[ni-2-tn]=Ir,Rt[ni-1-tn]=xr}}(jt,Wt),ut.push(jt)}}function ha(ut,rt){var Dt=(rt=this.options=function(Mt,Wt){for(var Zt in Wt)Mt[Zt]=Wt[Zt];return Mt}(Object.create(this.options),rt)).debug;if(Dt&&console.time("preprocess data"),rt.maxZoom<0||rt.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(rt.promoteId&&rt.generateId)throw new Error("promoteId and generateId cannot be used together.");var Mt,Wt,Zt,jt,Ft,Rt,Nt=function(Mt,Wt){var Zt=[];if("FeatureCollection"===Mt.type)for(var jt=0;jt<Mt.features.length;jt++)St(Zt,Mt.features[jt],Wt,jt);else St(Zt,"Feature"===Mt.type?Mt:{geometry:Mt},Wt);return Zt}(ut,rt);this.tiles={},this.tileCoords=[],Dt&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",rt.indexMaxZoom,rt.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Mt=Nt,Wt=rt,Zt=Wt.buffer/Wt.extent,jt=Mt,Ft=zn(Mt,1,-1-Zt,Zt,0,-1,2,Wt),Rt=zn(Mt,1,1-Zt,2+Zt,0,-1,2,Wt),(Ft||Rt)&&(jt=zn(Mt,1,-Zt,1+Zt,0,-1,2,Wt)||[],Ft&&(jt=zr(Ft,1).concat(jt)),Rt&&(jt=jt.concat(zr(Rt,-1)))),Nt=jt).length&&this.splitTile(Nt,0,0,0),Dt&&(Nt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function co(ut,rt,Dt){return 32*((1<<ut)*Dt+rt)+ut}return ha.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ha.prototype.splitTile=function(ut,rt,Dt,Nt,Mt,Wt,Zt){for(var jt=[ut,rt,Dt,Nt],Ft=this.options,Rt=Ft.debug;jt.length;){Nt=jt.pop(),Dt=jt.pop(),rt=jt.pop(),ut=jt.pop();var Un=1<<rt,xi=co(rt,Dt,Nt),tn=this.tiles[xi];if(!tn&&(Rt>1&&console.time("creation"),tn=this.tiles[xi]=Ws(ut,rt,Dt,Nt,Ft),this.tileCoords.push({z:rt,x:Dt,y:Nt}),Rt)){Rt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",rt,Dt,Nt,tn.numFeatures,tn.numPoints,tn.numSimplified),console.timeEnd("creation"));var ni="z"+rt;this.stats[ni]=(this.stats[ni]||0)+1,this.total++}if(tn.source=ut,Mt){if(rt===Ft.maxZoom||rt===Mt)continue;var Ai=1<<Mt-rt;if(Dt!==Math.floor(Wt/Ai)||Nt!==Math.floor(Zt/Ai))continue}else if(rt===Ft.indexMaxZoom||tn.numPoints<=Ft.indexMaxPoints)continue;if(tn.source=null,0!==ut.length){Rt>1&&console.time("clipping");var Ir,xr,dr,bs,ls,cs,Co=.5*Ft.buffer/Ft.extent,eo=.5-Co,fa=.5+Co,Wr=1+Co;Ir=xr=dr=bs=null,ls=zn(ut,Un,Dt-Co,Dt+fa,0,tn.minX,tn.maxX,Ft),cs=zn(ut,Un,Dt+eo,Dt+Wr,0,tn.minX,tn.maxX,Ft),ut=null,ls&&(Ir=zn(ls,Un,Nt-Co,Nt+fa,1,tn.minY,tn.maxY,Ft),xr=zn(ls,Un,Nt+eo,Nt+Wr,1,tn.minY,tn.maxY,Ft),ls=null),cs&&(dr=zn(cs,Un,Nt-Co,Nt+fa,1,tn.minY,tn.maxY,Ft),bs=zn(cs,Un,Nt+eo,Nt+Wr,1,tn.minY,tn.maxY,Ft),cs=null),Rt>1&&console.timeEnd("clipping"),jt.push(Ir||[],rt+1,2*Dt,2*Nt),jt.push(xr||[],rt+1,2*Dt,2*Nt+1),jt.push(dr||[],rt+1,2*Dt+1,2*Nt),jt.push(bs||[],rt+1,2*Dt+1,2*Nt+1)}}},ha.prototype.getTile=function(ut,rt,Dt){var Nt=this.options,Mt=Nt.extent,Wt=Nt.debug;if(ut<0||ut>24)return null;var Zt=1<<ut,jt=co(ut,rt=(rt%Zt+Zt)%Zt,Dt);if(this.tiles[jt])return vs(this.tiles[jt],Mt);Wt>1&&console.log("drilling down to z%d-%d-%d",ut,rt,Dt);for(var Ft,Rt=ut,Un=rt,xi=Dt;!Ft&&Rt>0;)Rt--,Un=Math.floor(Un/2),xi=Math.floor(xi/2),Ft=this.tiles[co(Rt,Un,xi)];return Ft&&Ft.source?(Wt>1&&console.log("found parent tile z%d-%d-%d",Rt,Un,xi),Wt>1&&console.time("drilling down"),this.splitTile(Ft.source,Rt,Un,xi,ut,rt,Dt),Wt>1&&console.timeEnd("drilling down"),this.tiles[jt]?vs(this.tiles[jt],Mt):null):null},function(ut,rt){return new ha(ut,rt)}}();var gr=h.dc(ai.exports);function ii(Ot,ge){const ve=Ot.tileID.canonical;if(!this._geoJSONIndex)return ge(null,null);const Re=this._geoJSONIndex.getTile(ve.z,ve.x,ve.y);if(!Re)return ge(null,null);const St=new class{constructor(Lt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=h.J,this.length=Lt.length,this._features=Lt}feature(Lt){return new class{constructor(cn){this._feature=cn,this.extent=h.J,this.type=cn.type,this.properties=cn.tags,"id"in cn&&!isNaN(cn.id)&&(this.id=parseInt(cn.id,10))}loadGeometry(){if(1===this._feature.type){const cn=[];for(const kt of this._feature.geometry)cn.push([new h.P(kt[0],kt[1])]);return cn}{const cn=[];for(const kt of this._feature.geometry){const En=[];for(const zn of kt)En.push(new h.P(zn[0],zn[1]));cn.push(En)}return cn}}toGeoJSON(cn,kt,En){return pn.call(this,cn,kt,En)}}(this._features[Lt])}}(Re.features);let bt=Uo(St);0===bt.byteOffset&&bt.byteLength===bt.buffer.byteLength||(bt=new Uint8Array(bt)),ge(null,{vectorTile:St,rawData:bt.buffer})}class da extends h.dh{constructor(ge,ve,Re,St,bt,Lt){super(ge,ve,Re,St,ii,Lt),bt&&(this.loadGeoJSON=bt)}loadData(ge,ve){const Re=ge&&ge.request,St=Re&&Re.collectResourceTiming;this.loadGeoJSON(ge,(bt,Lt)=>{if(bt||!Lt)return ve(bt);if("object"!=typeof Lt)return ve(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`));{Fn(Lt,!0);try{if(ge.filter){const kt=h.cw(ge.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===kt.result)throw new Error(kt.value.map(zn=>`${zn.key}: ${zn.message}`).join(", "));Lt={type:"FeatureCollection",features:Lt.features.filter(zn=>kt.value.evaluate({zoom:0},zn))}}this._geoJSONIndex=ge.cluster?new Gr(function({superclusterOptions:kt,clusterProperties:En}){if(!En||!kt)return kt;const zn={},Vn={},$i={accumulated:null,zoom:0},or={properties:null},lr=Object.keys(En);for(const Yi of lr){const[Mi,Xi]=En[Yi],zr=h.cw(Xi),qr=h.cw("string"==typeof Mi?[Mi,["accumulated"],["get",Yi]]:Mi);zn[Yi]=zr.value,Vn[Yi]=qr.value}return kt.map=Yi=>{or.properties=Yi;const Mi={};for(const Xi of lr)Mi[Xi]=zn[Xi].evaluate($i,or);return Mi},kt.reduce=(Yi,Mi)=>{or.properties=Mi;for(const Xi of lr)$i.accumulated=Yi[Xi],Yi[Xi]=Vn[Xi].evaluate($i,or)},kt}(ge)).load(Lt.features):gr(Lt,ge.geojsonVtOptions)}catch(kt){return ve(kt)}this.loaded={};const cn={};if(St){const kt=h.di(Re);kt&&(cn.resourceTiming={},cn.resourceTiming[ge.source]=JSON.parse(JSON.stringify(kt)))}ve(null,cn)}})}reloadTile(ge,ve){const Re=this.loaded;return Re&&Re[ge.uid]?super.reloadTile(ge,ve):this.loadTile(ge,ve)}loadGeoJSON(ge,ve){if(ge.request)h.a1(ge.request,ve);else{if("string"!=typeof ge.data)return ve(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`));try{return ve(null,JSON.parse(ge.data))}catch{return ve(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ge,ve){try{ve(null,this._geoJSONIndex.getClusterExpansionZoom(ge.clusterId))}catch(Re){ve(Re)}}getClusterChildren(ge,ve){try{ve(null,this._geoJSONIndex.getChildren(ge.clusterId))}catch(Re){ve(Re)}}getClusterLeaves(ge,ve){try{ve(null,this._geoJSONIndex.getLeaves(ge.clusterId,ge.limit,ge.offset))}catch(Re){ve(Re)}}}class qs{constructor(ge,ve){this.tileID=new h.O(ge.tileID.overscaledZ,ge.tileID.wrap,ge.tileID.canonical.z,ge.tileID.canonical.x,ge.tileID.canonical.y),this.tileZoom=ge.tileZoom,this.uid=ge.uid,this.zoom=ge.zoom,this.canonical=ge.tileID.canonical,this.pixelRatio=ge.pixelRatio,this.tileSize=ge.tileSize,this.source=ge.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ge.projection,this.brightness=ve}parse(ge,ve,Re,St){this.status="parsing";const bt=new h.O(Re.tileID.overscaledZ,Re.tileID.wrap,Re.tileID.canonical.z,Re.tileID.canonical.x,Re.tileID.canonical.y),Lt={},cn=ve.familiesBySource[Re.source],kt=new h.dk(bt,Re.promoteId);return kt.bucketLayerIDs=[],h.dl(ge).then(En=>{if(!En)return St(new Error("Could not parse tile"));const zn=h.dm(En,1/h.cg(Re.tileID.canonical)),Vn=En.json.extensionsUsed&&En.json.extensionsUsed.includes("MAPBOX_mesh_features"),$i=new h.al(this.zoom,{brightness:this.brightness});for(const or in cn)for(const lr of cn[or]){const Yi=lr[0],Mi=En.json.extensionsUsed;Yi.recalculate($i,[]);const Xi=new h.dn(zn,bt,Mi&&Mi.includes("MAPBOX_mesh_features"),this.brightness);Vn||(Xi.needsUpload=!0),Lt[Yi.fqid]=Xi,Xi.evaluate(Yi)}this.status="done",St(null,{buckets:Lt,featureIndex:kt})}).catch(En=>St(new Error(En.message)))}}class Pc{constructor(ge,ve,Re,St,bt,Lt){this.actor=ge,this.layerIndex=ve,this.brightness=Lt,this.loading={},this.loaded={}}loadTile(ge,ve){const Re=ge.uid,St=this.loading[Re]=new qs(ge,this.brightness);h.dj(ge.request,(bt,Lt)=>{const cn=!this.loading[Re];return delete this.loading[Re],cn||bt?(St.status="done",cn||(this.loaded[Re]=St),ve(bt)):Lt&&0!==Lt.byteLength?void St.parse(Lt,this.layerIndex,ge,(kt,En)=>{St.status="done",this.loaded=this.loaded||{},this.loaded[Re]=St,kt||!En?ve(kt):ve(null,En)}):(St.status="done",this.loaded[Re]=St,ve())})}reloadTile(ge,ve){const Re=this.loaded,St=ge.uid;if(Re&&Re[St]){const bt=Re[St];bt.projection=ge.projection,bt.brightness=ge.brightness;const Lt=(cn,kt)=>{bt.reloadCallback&&(delete bt.reloadCallback,this.loadTile(ge,ve)),ve(cn,kt)};"parsing"===bt.status?bt.reloadCallback=Lt:"done"===bt.status&&this.loadTile(ge,ve)}}abortTile(ge,ve){const Re=ge.uid;this.loading[Re]&&delete this.loading[Re],ve()}removeTile(ge,ve){const Re=this.loaded,St=ge.uid;Re&&Re[St]&&delete Re[St],ve()}}class ar{constructor(ge){this.self=ge,this.actor=new h.dp(ge,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=h.o({name:"mercator"}),this.workerSourceTypes={vector:h.dh,geojson:da,"batched-model":Pc},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ve,Re)=>{if(this.workerSourceTypes[ve])throw new Error(`Worker source with name "${ve}" already registered.`);this.workerSourceTypes[ve]=Re},this.self.registerRTLTextPlugin=ve=>{if(h.dq.isParsed())throw new Error("RTL text plugin already registered.");h.dq.applyArabicShaping=ve.applyArabicShaping,h.dq.processBidirectionalText=ve.processBidirectionalText,h.dq.processStyledBidirectionalText=ve.processStyledBidirectionalText}}clearCaches(ge,ve,Re){delete this.layerIndexes[ge],delete this.availableImages[ge],delete this.workerSources[ge],delete this.demWorkerSources[ge],Re()}checkIfReady(ge,ve,Re){Re()}setReferrer(ge,ve){this.referrer=ve}spriteLoaded(ge,{scope:ve,isLoaded:Re}){if(this.isSpriteLoaded[ge]||(this.isSpriteLoaded[ge]={}),this.isSpriteLoaded[ge][ve]=Re,this.workerSources[ge]&&this.workerSources[ge][ve])for(const St in this.workerSources[ge][ve]){const bt=this.workerSources[ge][ve][St];for(const Lt in bt)bt[Lt]instanceof h.dh&&(bt[Lt].isSpriteLoaded=Re,bt[Lt].fire(new h.a8("isSpriteLoaded")))}}setImages(ge,{scope:ve,images:Re},St){if(this.availableImages[ge]||(this.availableImages[ge]={}),this.availableImages[ge][ve]=Re,this.workerSources[ge]&&this.workerSources[ge][ve]){for(const bt in this.workerSources[ge][ve]){const Lt=this.workerSources[ge][ve][bt];for(const cn in Lt)Lt[cn].availableImages=Re}St()}else St()}setProjection(ge,ve){this.projections[ge]=h.o(ve)}setBrightness(ge,ve,Re){this.brightness=ve,Re()}setLayers(ge,ve,Re){this.getLayerIndex(ge,ve.scope).replace(ve.layers,ve.options),Re()}updateLayers(ge,ve,Re){this.getLayerIndex(ge,ve.scope).update(ve.layers,ve.removedIds,ve.options),Re()}loadTile(ge,ve,Re){ve.projection=this.projections[ge]||this.defaultProjection,this.getWorkerSource(ge,ve.type,ve.source,ve.scope).loadTile(ve,Re)}loadDEMTile(ge,ve,Re){this.getDEMWorkerSource(ge,ve.source,ve.scope).loadTile(ve,Re)}reloadTile(ge,ve,Re){ve.projection=this.projections[ge]||this.defaultProjection,this.getWorkerSource(ge,ve.type,ve.source,ve.scope).reloadTile(ve,Re)}abortTile(ge,ve,Re){this.getWorkerSource(ge,ve.type,ve.source,ve.scope).abortTile(ve,Re)}removeTile(ge,ve,Re){this.getWorkerSource(ge,ve.type,ve.source,ve.scope).removeTile(ve,Re)}removeSource(ge,ve,Re){if(!(this.workerSources[ge]&&this.workerSources[ge][ve.scope]&&this.workerSources[ge][ve.scope][ve.type]&&this.workerSources[ge][ve.scope][ve.type][ve.source]))return;const St=this.workerSources[ge][ve.scope][ve.type][ve.source];delete this.workerSources[ge][ve.scope][ve.type][ve.source],void 0!==St.removeSource?St.removeSource(ve,Re):Re()}loadWorkerSource(ge,ve,Re){try{this.self.importScripts(ve.url),Re()}catch(St){Re(St.toString())}}syncRTLPluginState(ge,ve,Re){try{h.dq.setState(ve);const St=h.dq.getPluginURL();if(h.dq.isLoaded()&&!h.dq.isParsed()&&null!=St){this.self.importScripts(St);const bt=h.dq.isParsed();Re(bt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${St}`),bt)}}catch(St){Re(St.toString())}}setDracoUrl(ge,ve){this.dracoUrl=ve}getAvailableImages(ge,ve){this.availableImages[ge]||(this.availableImages[ge]={});let Re=this.availableImages[ge][ve];return Re||(Re=[]),Re}getLayerIndex(ge,ve){this.layerIndexes[ge]||(this.layerIndexes[ge]={});let Re=this.layerIndexes[ge][ve];return Re||(Re=this.layerIndexes[ge][ve]=new Oe,Re.scope=ve),Re}getWorkerSource(ge,ve,Re,St){return this.workerSources[ge]||(this.workerSources[ge]={}),this.workerSources[ge][St]||(this.workerSources[ge][St]={}),this.workerSources[ge][St][ve]||(this.workerSources[ge][St][ve]={}),this.isSpriteLoaded[ge]||(this.isSpriteLoaded[ge]={}),this.workerSources[ge][St][ve][Re]||(this.workerSources[ge][St][ve][Re]=new this.workerSourceTypes[ve]({send:(Lt,cn,kt,En,zn,Vn)=>{this.actor.send(Lt,cn,kt,ge,zn,Vn)},scheduler:this.actor.scheduler},this.getLayerIndex(ge,St),this.getAvailableImages(ge,St),this.isSpriteLoaded[ge][St],void 0,this.brightness)),this.workerSources[ge][St][ve][Re]}getDEMWorkerSource(ge,ve,Re){return this.demWorkerSources[ge]||(this.demWorkerSources[ge]={}),this.demWorkerSources[ge][Re]||(this.demWorkerSources[ge][Re]={}),this.demWorkerSources[ge][Re][ve]||(this.demWorkerSources[ge][Re][ve]=new tt),this.demWorkerSources[ge][Re][ve]}enforceCacheSizeLimit(ge,ve){h.dr(ve)}getWorkerPerformanceMetrics(ge,ve,Re){Re(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new ar(self)),ar}),gt(0,function(h){function me(_,c){if(Array.isArray(_)){if(!Array.isArray(c)||_.length!==c.length)return!1;for(let f=0;f<_.length;f++)if(!me(_[f],c[f]))return!1;return!0}if("object"==typeof _&&null!==_&&null!==c){if("object"!=typeof c||Object.keys(_).length!==Object.keys(c).length)return!1;for(const f in _)if(!me(_[f],c[f]))return!1;return!0}return _===c}var Xe=Oe;function Oe(_){return c=_,!(typeof window>"u"||typeof document>"u"||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var v,w,E=new Blob([""],{type:"text/javascript"}),S=URL.createObjectURL(E);try{w=new Worker(S),v=!0}catch{v=!1}return w&&w.terminate(),URL.revokeObjectURL(S),v}()||!function(){var v=document.createElement("canvas");v.width=v.height=1;var w=v.getContext("2d");if(!w)return!1;var E=w.getImageData(0,0,1,1);return E&&E.width===v.width}()||(void 0===tt[f=c&&c.failIfMajorPerformanceCaveat]&&(tt[f]=function(v){var w,S,I,O,E=(S=v,I=document.createElement("canvas"),(O=Object.create(Oe.webGLContextAttributes)).failIfMajorPerformanceCaveat=S,I.getContext("webgl2",O));if(!E)return!1;try{w=E.createShader(E.VERTEX_SHADER)}catch{return!1}return!(!w||E.isContextLost())&&(E.shaderSource(w,"void main() {}"),E.compileShader(w),!0===E.getShaderParameter(w,E.COMPILE_STATUS))}(f)),!tt[f]||document.documentMode));var c,f}var tt={};function Ye(_,c,f){const v=document.createElement(_);return null!=c&&(v.className=c),f&&f.appendChild(v),v}function Vt(_,c,f){const v=document.createElementNS("http://www.w3.org/2000/svg",_);for(const w of Object.keys(c))v.setAttributeNS(null,w,String(c[w]));return f&&f.appendChild(v),v}Oe.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Fn=typeof document<"u"?document.documentElement&&document.documentElement.style:null,pn=Fn&&void 0!==Fn.userSelect?"userSelect":"WebkitUserSelect";let vn;function en(){Fn&&pn&&(vn=Fn[pn],Fn[pn]="none")}function Yt(){Fn&&pn&&(Fn[pn]=vn)}function De(_){_.preventDefault(),_.stopPropagation(),window.removeEventListener("click",De,!0)}function ct(){window.addEventListener("click",De,!0),window.setTimeout(()=>{window.removeEventListener("click",De,!0)},0)}function qt(_,c){const f=_.getBoundingClientRect();return Ct(_,f,c)}function nt(_,c){const f=_.getBoundingClientRect(),v=[];for(let w=0;w<c.length;w++)v.push(Ct(_,f,c[w]));return v}function Ge(_){return void 0!==window.InstallTrigger&&2===_.button&&_.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:_.button}function Ct(_,c,f){const v=_.offsetWidth===c.width?1:_.offsetWidth/c.width;return new h.P((f.clientX-c.left)*v,(f.clientY-c.top)*v)}class Le{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(c,f){this._updatedSourceCaches[c]=f,this.setDirty()}discardSourceCacheUpdate(c){delete this._updatedSourceCaches[c]}updateLayer(c){const f=c.scope;this._updatedLayers[f]=this._updatedLayers[f]||new Set,this._updatedLayers[f].add(c.id),this.setDirty()}removeLayer(c){const f=c.scope;this._removedLayers[f]=this._removedLayers[f]||{},this._updatedLayers[f]=this._updatedLayers[f]||new Set,this._removedLayers[f][c.id]=c,this._updatedLayers[f].delete(c.id),this._updatedPaintProps.delete(c.fqid),this.setDirty()}getRemovedLayer(c){return this._removedLayers[c.scope]?this._removedLayers[c.scope][c.id]:null}discardLayerRemoval(c){this._removedLayers[c.scope]&&delete this._removedLayers[c.scope][c.id]}getLayerUpdatesByScope(){const c={};for(const f in this._updatedLayers)c[f]=c[f]||{},c[f].updatedIds=Array.from(this._updatedLayers[f].values());for(const f in this._removedLayers)c[f]=c[f]||{},c[f].removedIds=Object.keys(this._removedLayers[f]);return c}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(c){this._updatedPaintProps.add(c.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(c){this._updatedImages.add(c),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}const Qt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class xn{constructor(c,f,v,w,E,S){this.length=f.length,this.attributes=v,this.itemSize=f.bytesPerElement,this.dynamicDraw=w,this.instanceCount=S,this.context=c;const I=c.gl;this.buffer=I.createBuffer(),c.bindVertexBuffer.set(this.buffer),I.bufferData(I.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?I.DYNAMIC_DRAW:I.STATIC_DRAW),this.dynamicDraw||E||f.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){const f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,f){for(let v=0;v<this.attributes.length;v++){const w=f.attributes[this.attributes[v].name];void 0!==w&&c.enableVertexAttribArray(w)}}setVertexAttribPointers(c,f,v){for(let w=0;w<this.attributes.length;w++){const E=this.attributes[w],S=f.attributes[E.name];void 0!==S&&c.vertexAttribPointer(S,E.components,c[Qt[E.type]],!1,this.itemSize,E.offset+this.itemSize*(v||0))}}setVertexAttribDivisor(c,f,v){for(let w=0;w<this.attributes.length;w++){const E=f.attributes[this.attributes[w].name];void 0!==E&&this.instanceCount&&this.instanceCount>0&&c.vertexAttribDivisor(E,v)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Et{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Si extends Et{getDefault(){return h.C.transparent}set(c){const f=this.current;(c.r!==f.r||c.g!==f.g||c.b!==f.b||c.a!==f.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class mr extends Et{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class To extends Et{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class Uo extends Et{getDefault(){return[!0,!0,!0,!0]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||c[3]!==f[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class ts extends Et{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class Hn extends Et{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class Is extends Et{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const f=this.current;(c.func!==f.func||c.ref!==f.ref||c.mask!==f.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class wn extends Et{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class Ho extends Et{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST),this.current=c,this.dirty=!1}}class Va extends Et{getDefault(){return[0,1]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class Gr extends Et{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this.current=c,this.dirty=!1}}class ja extends Et{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class qe extends Et{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.BLEND):f.disable(f.BLEND),this.current=c,this.dirty=!1}}class ua extends Et{getDefault(){const c=this.gl;return[c.ONE,c.ZERO,c.ONE,c.ZERO]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||c[3]!==f[3]||this.dirty)&&(this.gl.blendFuncSeparate(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class ys extends Et{getDefault(){return h.C.transparent}set(c){const f=this.current;(c.r!==f.r||c.g!==f.g||c.b!==f.b||c.a!==f.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class ur extends Et{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(c,c),this.current=c,this.dirty=!1)}}class ai extends Et{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this.current=c,this.dirty=!1}}class gr extends Et{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class ii extends Et{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}let da=class extends Et{getDefault(){return null}set(_){(_!==this.current||this.dirty)&&(this.gl.useProgram(_),this.current=_,this.dirty=!1)}};class qs extends Et{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class Pc extends Et{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||c[3]!==f[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class ar extends Et{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class Ot extends Et{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindRenderbuffer(f.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class ge extends Et{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindTexture(f.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class ve extends Et{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class Re extends Et{getDefault(){return null}set(c){const f=this.gl;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class St extends Et{getDefault(){return null}set(c){this.gl&&(c!==this.current||this.dirty)&&(this.gl.bindVertexArray(c),this.current=c,this.dirty=!1)}}class bt extends Et{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class Lt extends Et{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class cn extends Et{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class kt extends Et{constructor(c,f){super(c),this.context=c,this.parent=f}getDefault(){return null}}class En extends kt{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class zn extends kt{attachment(){return this.gl.DEPTH_ATTACHMENT}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,this.attachment(),f.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class Vn extends kt{attachment(){return this.gl.DEPTH_ATTACHMENT}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,this.attachment(),f.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class $i extends zn{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class or{constructor(c,f,v,w,E){this.context=c,this.width=f,this.height=v;const S=this.framebuffer=c.gl.createFramebuffer();w&&(this.colorAttachment=new En(c,S)),E&&(this.depthAttachmentType=E,this.depthAttachment="renderbuffer"===E?new zn(c,S):new Vn(c,S))}destroy(){const c=this.context.gl;if(this.colorAttachment){const f=this.colorAttachment.get();f&&c.deleteTexture(f)}if(this.depthAttachment&&this.depthAttachmentType)if("renderbuffer"===this.depthAttachmentType){const f=this.depthAttachment.get();f&&c.deleteRenderbuffer(f)}else{const f=this.depthAttachment.get();f&&c.deleteTexture(f)}c.deleteFramebuffer(this.framebuffer)}}class lr{constructor(c,f){this.gl=c,this.clearColor=new Si(this),this.clearDepth=new mr(this),this.clearStencil=new To(this),this.colorMask=new Uo(this),this.depthMask=new ts(this),this.stencilMask=new Hn(this),this.stencilFunc=new Is(this),this.stencilOp=new wn(this),this.stencilTest=new Ho(this),this.depthRange=new Va(this),this.depthTest=new Gr(this),this.depthFunc=new ja(this),this.blend=new qe(this),this.blendFunc=new ua(this),this.blendColor=new ys(this),this.blendEquation=new ur(this),this.cullFace=new ai(this),this.cullFaceSide=new gr(this),this.frontFace=new ii(this),this.program=new da(this),this.activeTexture=new qs(this),this.viewport=new Pc(this),this.bindFramebuffer=new ar(this),this.bindRenderbuffer=new Ot(this),this.bindTexture=new ge(this),this.bindVertexBuffer=new ve(this),this.bindElementBuffer=new Re(this),this.bindVertexArrayOES=new St(this),this.pixelStoreUnpack=new bt(this),this.pixelStoreUnpackPremultiplyAlpha=new Lt(this),this.pixelStoreUnpackFlipY=new cn(this),this.options=f?{...f}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=c.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=c.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=c.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=c.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,f,v){return new h.I(this,c,f,v)}createVertexBuffer(c,f,v,w,E){return new xn(this,c,f,v,w,E)}createRenderbuffer(c,f,v){const w=this.gl,E=w.createRenderbuffer();return this.bindRenderbuffer.set(E),w.renderbufferStorage(w.RENDERBUFFER,c,f,v),this.bindRenderbuffer.set(null),E}createFramebuffer(c,f,v,w){return new or(this,c,f,v,w)}clear({color:c,depth:f,stencil:v,colorMask:w}){const E=this.gl;let S=0;c&&(S|=E.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set(w||[!0,!0,!0,!0])),void 0!==f&&(S|=E.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),void 0!==v&&(S|=E.STENCIL_BUFFER_BIT,this.clearStencil.set(v),this.stencilMask.set(255)),E.clear(S)}setCullFace(c){!1===c.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){me(c.blendFunction,h.a.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor),c.blendEquation?this.blendEquation.set(c.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(c.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class Yi{constructor(c=0,f=0,v=0,w=0){if(isNaN(c)||c<0||isNaN(f)||f<0||isNaN(v)||v<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=f,this.left=v,this.right=w}interpolate(c,f,v){return null!=f.top&&null!=c.top&&(this.top=h.n(c.top,f.top,v)),null!=f.bottom&&null!=c.bottom&&(this.bottom=h.n(c.bottom,f.bottom,v)),null!=f.left&&null!=c.left&&(this.left=h.n(c.left,f.left,v)),null!=f.right&&null!=c.right&&(this.right=h.n(c.right,f.right,v)),this}getCenter(c,f){const v=h.c((this.left+c-this.right)/2,0,c),w=h.c((this.top+f-this.bottom)/2,0,f);return new h.P(v,w)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new Yi(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Mi(_,c){const f=h.g(_,3);h.m.fromQuat(_,c),h.s(_,3,f)}function Xi(_,c){const f=h.q.identity([]);return h.q.rotateZ(f,f,-c),h.q.rotateX(f,f,-_),f}function zr(_,c){const f=[_[0],_[1],0],v=[c[0],c[1],0];if(h.v.length(f)>=1e-15){const S=h.v.normalize([],f);h.v.scale(v,S,h.v.dot(v,S)),c[0]=v[0],c[1]=v[1]}const w=h.v.cross([],c,_);if(h.v.len(w)<1e-15)return null;const E=Math.atan2(-w[1],w[0]);return Xi(Math.atan2(Math.sqrt(_[0]*_[0]+_[1]*_[1]),-_[2]),E)}class qr{constructor(c,f){this.position=c,this.orientation=f}get position(){return this._position}set position(c){if(c){const f=c instanceof h.M?c:new h.M(c[0],c[1],c[2]);this._renderWorldCopies&&(f.x=h.w(f.x,0,1)),this._position=f}else this._position=null}lookAtPoint(c,f){if(this.orientation=null,!this.position)return;const v=this.position,w=this._elevation?this._elevation.getAtPointOrZero(h.M.fromLngLat(c)):0,E=h.M.fromLngLat(c,w),S=[E.x-v.x,E.y-v.y,E.z-v.z];f||(f=[0,0,1]),f[2]=Math.abs(f[2]),this.orientation=zr(S,f)}setPitchBearing(c,f){this.orientation=Xi(h.d(c),h.d(-f))}}class vs{constructor(c,f){this._transform=h.m.identity([]),this.orientation=f,this.position=c}get mercatorPosition(){const c=this.position;return new h.M(c[0],c[1],c[2])}get position(){const c=h.g(this._transform,3);return[c[0],c[1],c[2]]}set position(c){var f;c&&h.s(this._transform,3,[(f=c)[0],f[1],f[2],1])}get orientation(){return this._orientation}set orientation(c){this._orientation=c||h.q.identity([]),c&&Mi(this._transform,this._orientation)}getPitchBearing(){const c=this.forward(),f=this.right();return{bearing:Math.atan2(-f[1],f[0]),pitch:Math.atan2(Math.sqrt(c[0]*c[0]+c[1]*c[1]),-c[2])}}setPitchBearing(c,f){this._orientation=Xi(c,f),Mi(this._transform,this._orientation)}forward(){const c=h.g(this._transform,2);return[-c[0],-c[1],-c[2]]}up(){const c=h.g(this._transform,1);return[-c[0],-c[1],-c[2]]}right(){const c=h.g(this._transform,0);return[c[0],c[1],c[2]]}getCameraToWorld(c,f){const v=new Float64Array(16);return h.m.invert(v,this.getWorldToCamera(c,f)),v}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(c,f,v){const w=this.position;h.v.scale(w,w,-c);const E=new Float64Array(16);return h.m.fromScaling(E,[v,v,v]),h.m.translate(E,E,w),E[10]*=f,E}getWorldToCamera(c,f){const v=new Float64Array(16),w=new Float64Array(4),E=this.position;return h.q.conjugate(w,this._orientation),h.v.scale(E,E,-c),h.m.fromQuat(v,w),h.m.translate(v,v,E),v[1]*=-1,v[5]*=-1,v[9]*=-1,v[13]*=-1,v[8]*=f,v[9]*=f,v[10]*=f,v[11]*=f,v}getCameraToClipPerspective(c,f,v,w){const E=new Float64Array(16);return h.m.perspective(E,c,f,v,w),E}getCameraToClipOrthographic(c,f,v,w,E,S){const I=new Float64Array(16);return h.m.ortho(I,c,f,v,w,E,S),I}getDistanceToElevation(c,f=!1){const v=0===c?0:h.b(c,f?h.l(this.position[1]):this.position[1]),w=this.forward();return(v-this.position[2])/w[2]}clone(){return new vs([...this.position],[...this.orientation])}}const So={unknown:0,flipRequired:1,flipNotRequired:2},Ws=Math.tan(85*Math.PI/180);function Mo(_,c,f,v,w,E,S){const I=h.m.create();if(f)if("globe"===E.name){const O=h.f(w,c);h.m.multiply(I,I,O)}else{const O=h.h.invert([],S);I[0]=O[0],I[1]=O[1],I[4]=O[2],I[5]=O[3],v||h.m.rotateZ(I,I,w.angle)}else h.m.multiply(I,w.labelPlaneMatrix,_);return I}function Zs(_,c,f,v,w,E,S){const I=Mo(_,c,f,v,w,E,S);return"globe"===E.name&&f||(I[2]=I[6]=I[10]=I[14]=0),I}function ha(_,c,f,v,w,E,S){if(f){if("globe"===E.name){const I=Mo(_,c,f,v,w,E,S);return h.m.invert(I,I),h.m.multiply(I,_,I),I}{const I=h.m.clone(_),O=h.m.identity([]);return O[0]=S[0],O[1]=S[1],O[4]=S[2],O[5]=S[3],h.m.multiply(I,I,O),v||h.m.rotateZ(I,I,-w.angle),I}}return w.glCoordMatrix}function co(_,c,f,v){const w=[_,c,f,1];f?h.e.transformMat4(w,w,v):Un(w,w,v);const E=w[3];return w[0]/=E,w[1]/=E,w[2]/=E,w}function ut(_,c){return Math.min(.5+_/c*.5,1.5)}function rt(_,c){const f=_[0]/_[3],v=_[1]/_[3];return f>=-c[0]&&f<=c[0]&&v>=-c[1]&&v<=c[1]}function Dt(_,c,f,v,w,E,S,I,O,N){const V=f.transform,H=v?_.textSizeData:_.iconSizeData,G=h.i(H,f.transform.zoom),Y="globe"===V.projection.name,ee=[256/f.width*2+1,256/f.height*2+1],K=v?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;K.clear();let ne=null;Y&&(ne=v?_.text.globeExtVertexArray:_.icon.globeExtVertexArray);const J=_.lineVertexArray,oe=v?_.text.placedSymbolArray:_.icon.placedSymbolArray,_e=f.transform.width/f.transform.height;let ye,re=!1;for(let ae=0;ae<oe.length;ae++){const be=oe.get(ae),{numGlyphs:Se,writingMode:Ce}=be;if(Ce!==h.W.vertical||re||ye===h.W.horizontal||(re=!0),ye=Ce,(be.hidden||Ce===h.W.vertical)&&!re){Rt(Se,K);continue}re=!1;const ke=new h.P(be.tileAnchorX,be.tileAnchorY);let{x:lt,y:$e,z:Qe}=V.projection.projectTilePoint(ke.x,ke.y,N.canonical);if(O){const[Xt,mn,nn]=O(ke);lt+=Xt,$e+=mn,Qe+=nn}const Fe=[lt,$e,Qe,1];if(h.e.transformMat4(Fe,Fe,c),!rt(Fe,ee)){Rt(Se,K);continue}const ot=Fe[3],Ke=ut(f.transform.getCameraToCenterDistance(V.projection),ot),Ue=h.j(H,G,be),fe=S?Ue/Ke:Ue*Ke,Ne=co(lt,$e,Qe,w);if(Ne[3]<=0){Rt(Se,K);continue}let At={};const vt=S?null:O,an=Wt(be,fe,!1,I,c,w,E,_.glyphOffsetArray,J,K,ne,Ne,ke,At,_e,vt,V.projection,N,S);re=an.useVertical,vt&&an.needsFlipping&&(At={}),(an.notEnoughRoom||re||an.needsFlipping&&Wt(be,fe,!0,I,c,w,E,_.glyphOffsetArray,J,K,ne,Ne,ke,At,_e,vt,V.projection,N,S).notEnoughRoom)&&Rt(Se,K)}v?(_.text.dynamicLayoutVertexBuffer.updateData(K),ne&&_.text.globeExtVertexBuffer&&_.text.globeExtVertexBuffer.updateData(ne)):(_.icon.dynamicLayoutVertexBuffer.updateData(K),ne&&_.icon.globeExtVertexBuffer&&_.icon.globeExtVertexBuffer.updateData(ne))}function Nt(_,c,f,v,w,E,S,I,O,N,V,H,G,Y,ee,K){const{lineStartIndex:ne,glyphStartIndex:J,segment:oe}=I,_e=J+I.numGlyphs,ye=ne+I.lineLength,re=c.getoffsetX(J),ae=c.getoffsetX(_e-1),be=Ft(_*re,f,v,w,E,S,oe,ne,ye,O,N,V,H,G,!0,Y,ee,K);if(!be)return null;const Se=Ft(_*ae,f,v,w,E,S,oe,ne,ye,O,N,V,H,G,!0,Y,ee,K);return Se?{first:be,last:Se}:null}function Mt(_,c,f,v){return _===h.W.horizontal&&Math.abs(v)>Math.abs(f)?{useVertical:!0}:_===h.W.vertical?v>0?{needsFlipping:!0}:null:c!==So.unknown&&(0===(w=f)||Math.abs(v/w)>Ws)?c===So.flipRequired?{needsFlipping:!0}:null:f<0?{needsFlipping:!0}:null;var w}function Wt(_,c,f,v,w,E,S,I,O,N,V,H,G,Y,ee,K,ne,J,oe){const _e=c/24,ye=_.lineOffsetX*_e,re=_.lineOffsetY*_e,{lineStartIndex:ae,glyphStartIndex:be,numGlyphs:Se,segment:Ce,writingMode:ke,flipState:lt}=_,$e=ae+_.lineLength,Qe=Fe=>{if(V){const[fe,Ne,At]=Fe.up,vt=N.length;h.u(V,vt+0,fe,Ne,At),h.u(V,vt+1,fe,Ne,At),h.u(V,vt+2,fe,Ne,At),h.u(V,vt+3,fe,Ne,At)}const[ot,Ke,Ue]=Fe.point;h.k(N,ot,Ke,Ue,Fe.angle)};if(Se>1){const Fe=Nt(_e,I,ye,re,f,H,G,_,O,E,Y,K,!1,ne,J,oe);if(!Fe)return{notEnoughRoom:!0};if(v&&!f){let[ot,Ke,Ue]=Fe.first.point,[fe,Ne,At]=Fe.last.point;[ot,Ke]=co(ot,Ke,Ue,S),[fe,Ne]=co(fe,Ne,At,S);const vt=Mt(ke,lt,(fe-ot)*ee,Ne-Ke);if(_.flipState=vt&&vt.needsFlipping?So.flipRequired:So.flipNotRequired,vt)return vt}Qe(Fe.first);for(let ot=be+1;ot<be+Se-1;ot++){const Ke=Ft(_e*I.getoffsetX(ot),ye,re,f,H,G,Ce,ae,$e,O,E,Y,K,!1,!1,ne,J,oe);if(!Ke)return N.length-=4*(ot-be),{notEnoughRoom:!0};Qe(Ke)}Qe(Fe.last)}else{if(v&&!f){const ot=co(G.x,G.y,0,w),Ke=ae+Ce+1,Ue=new h.P(O.getx(Ke),O.gety(Ke)),fe=co(Ue.x,Ue.y,0,w),Ne=fe[3]>0?fe:jt(G,Ue,ot,1,w,void 0,ne,J.canonical),At=Mt(ke,lt,(Ne[0]-ot[0])*ee,Ne[1]-ot[1]);if(_.flipState=At&&At.needsFlipping?So.flipRequired:So.flipNotRequired,At)return At}const Fe=Ft(_e*I.getoffsetX(be),ye,re,f,H,G,Ce,ae,$e,O,E,Y,K,!1,!1,ne,J,oe);if(!Fe)return{notEnoughRoom:!0};Qe(Fe)}return{}}function Zt(_,c,f,v,w){const{x:E,y:S,z:I}=v.projectTilePoint(_.x,_.y,c);if(!w)return co(E,S,I,f);const[O,N,V]=w(_);return co(E+O,S+N,I+V,f)}function jt(_,c,f,v,w,E,S,I){const O=Zt(_.sub(c)._unit()._add(_),I,w,S,E);return h.v.sub(O,f,O),h.v.normalize(O,O),h.v.scaleAndAdd(O,f,O,v)}function Ft(_,c,f,v,w,E,S,I,O,N,V,H,G,Y,ee,K,ne,J){const oe=v?_-c:_+c;let _e=oe>0?1:-1,ye=0;v&&(_e*=-1,ye=Math.PI),_e<0&&(ye+=Math.PI);let re=I+S+(_e>0?0:1)|0,ae=w,be=w,Se=0,Ce=0;const ke=Math.abs(oe),lt=[],$e=[];let Qe=E,Fe=Qe;const ot=()=>jt(Fe,Qe,be,ke-Se+1,V,G,K,ne.canonical);for(;Se+Ce<=ke;){if(re+=_e,re<I||re>=O)return null;if(be=ae,Fe=Qe,lt.push(be),Y&&$e.push(Fe),Qe=new h.P(N.getx(re),N.gety(re)),ae=H[re],!ae){const mn=Zt(Qe,ne.canonical,V,K,G);ae=mn[3]>0?H[re]=mn:ot()}Se+=Ce,Ce=h.v.distance(be,ae)}ee&&G&&(H[re]&&(ae=ot(),Ce=h.v.distance(be,ae)),H[re]=ae);const Ke=(ke-Se)/Ce,Ue=Qe.sub(Fe)._mult(Ke)._add(Fe),fe=h.v.sub([],ae,be),Ne=h.v.scaleAndAdd([],be,fe,Ke);let At=[0,0,1],vt=fe[0],an=fe[1];if(J&&(At=K.upVector(ne.canonical,Ue.x,Ue.y),0!==At[0]||0!==At[1]||1!==At[2])){const mn=[At[2],0,-At[0]],nn=h.v.cross([],At,mn);h.v.normalize(mn,mn),h.v.normalize(nn,nn),vt=h.v.dot(fe,mn),an=h.v.dot(fe,nn)}if(f){const mn=h.v.cross([],At,fe);h.v.normalize(mn,mn),h.v.scaleAndAdd(Ne,Ne,mn,f*_e)}const Xt=ye+Math.atan2(an,vt);return lt.push(Ne),Y&&$e.push(Ue),{point:Ne,angle:Xt,path:lt,tilePath:$e,up:At}}function Rt(_,c){const f=c.length,v=f+4*_;c.resize(v),c.float32.fill(-1/0,4*f,4*v)}function Un(_,c,f){const v=c[0],w=c[1];return _[0]=f[0]*v+f[4]*w+f[12],_[1]=f[1]*v+f[5]*w+f[13],_[3]=f[3]*v+f[7]*w+f[15],_}const xi=(_,c,f)=>(1-f)*_+f*c,tn=_=>_*_*_*_*_;class ni{constructor(c,f,v,w,E,S,I){this.tileSize=512,this._renderWorldCopies=void 0===E||E,this._minZoom=c||0,this._maxZoom=f||22,this._minPitch=v??0,this._maxPitch=w??60,this.setProjection(S),this.setMaxBounds(I),this.width=0,this.height=0,this._center=new h.L(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Yi,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new vs,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const c=new ni(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return c._elevation=this._elevation,c._centerAltitude=this._centerAltitude,c._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,c.tileSize=this.tileSize,c.mercatorFromTransition=this.mercatorFromTransition,c.width=this.width,c.height=this.height,c.cameraElevationReference=this.cameraElevationReference,c._center=this._center,c._setZoom(this.zoom),c._seaLevelZoom=this._seaLevelZoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._nearZ=this._nearZ,c._farZ=this._farZ,c._averageElevation=this._averageElevation,c._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._camera=this._camera.clone(),c._calcMatrices(),c.freezeTileCoverage=this.freezeTileCoverage,c.frustumCorners=this.frustumCorners,c}get isOrthographic(){return"globe"!==this.projection.name&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(c){this._elevation!==c&&(this._elevation=c,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return"globe"!==this.projection.name&&!this.isOrthographic}updateElevation(c,f=!1){const v=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||v)&&this._updateCameraOnTerrain(),(c||v)&&this._constrainCamera(f),this._calcMatrices()}getProjection(){return h.p(this.projection,["name","center","parallels"])}setProjection(c){this.projectionOptions=c||{name:"mercator"};const f=this.projection?this.getProjection():void 0;this.projection=h.o(this.projectionOptions);const v=!me(f,this.getProjection());return v&&this._calcMatrices(),this.mercatorFromTransition=!1,v}setOrthographicProjectionAtLowPitch(c){return this._orthographicProjectionAtLowPitch!==c&&(this._orthographicProjectionAtLowPitch=c,this._calcMatrices(),!0)}setMercatorFromTransition(){const c=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=h.o({name:"mercator"});const f=c!==this.projection.name;return f&&this._calcMatrices(),f}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(c){void 0===c?c=!0:null===c&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get cameraWorldSize(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return h.b(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new h.P(this.width,this.height)}get bearing(){return h.w(this.rotation,-180,180)}set bearing(c){this.rotation=c}get rotation(){return-this.angle/Math.PI*180}set rotation(c){const f=-c*Math.PI/180;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=h.h.create(),h.h.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const f=h.c(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const c=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/c)}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=h.d(c),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(c){this._averageElevation=c,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(c){const f=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._setZoom(f),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(c){this._zoom=c,this.scale=this.zoomScale(c),this.tileZoom=Math.floor(c),this.zoomFraction=c-this.tileZoom}_updateCameraOnTerrain(){const c=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,f=this.elevation&&c===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||c===Number.NEGATIVE_INFINITY&&(!f||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const v=this._elevation;f||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&v.exaggeration()&&this._centerAltitudeValidForExaggeration!==v.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*v.exaggeration(),this._centerAltitudeValidForExaggeration=v.exaggeration()):(this._centerAltitude=c||0,this._centerAltitudeValidForExaggeration=v.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const c=this._elevation,f=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],v=this.horizonLineFromTop();let w=0,E=0;for(let S=0;S<f.length;S++){const I=new h.P(f[S][0]*this.width,v+f[S][1]*(this.height-v)),O=c.pointCoordinate(I);if(!O)continue;const N=1/Math.hypot(O[0]-this._camera.position[0],O[1]-this._camera.position[1]);w+=O[3]*N,E+=N}return 0===E?NaN:w/E}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const c=this._seaLevelZoom,f=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),v=this.pixelsPerMeter/this.worldSize*f,w=this._mercatorZfromZoom(c),E=this._mercatorZfromZoom(this._maxZoom),S=Math.max(w-v,E);this._setZoom(this._zoomFromMercatorZ(S))}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}computeZoomRelativeTo(c){const f=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,c.toAltitude()));let v;v=c.z<this._camera.position[2]?[f.x,f.y,f.z]:[c.x,c.y,c.z];const w=h.v.length(h.v.sub([],this._camera.position,v));return h.c(this._zoomFromMercatorZ(w),this._minZoom,this._maxZoom)}setFreeCameraOptions(c){if(!this.height||!c.position&&!c.orientation)return;this._updateCameraState();let f=!1;if(c.orientation&&!h.q.exactEquals(c.orientation,this._camera.orientation)&&(f=this._setCameraOrientation(c.orientation)),c.position){const v=[c.position.x,c.position.y,c.position.z];h.v.exactEquals(v,this._camera.position)||(this._setCameraPosition(v),f=!0)}f&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const c=this._camera.position,f=new qr;return f.position=new h.M(c[0],c[1],c[2]),f.orientation=this._camera.orientation,f._elevation=this.elevation,f._renderWorldCopies=this.renderWorldCopies,f}_setCameraOrientation(c){if(!h.q.length(c))return!1;h.q.normalize(c,c);const f=h.v.transformQuat([],[0,0,-1],c),v=h.v.transformQuat([],[0,-1,0],c);if(v[2]<0)return!1;const w=zr(f,v);return!!w&&(this._camera.orientation=w,!0)}_setCameraPosition(c){const f=this.zoomScale(this.minZoom)*this.tileSize,v=this.zoomScale(this.maxZoom)*this.tileSize,w=this.cameraToCenterDistance;c[2]=h.c(c[2],w/v,w/f),this._camera.position=c}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,f,v){this._unmodified=!1,this._edgeInsets.interpolate(c,f,v),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const f=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,f)}getVisibleUnwrappedCoordinates(c){const f=[new h.U(0,c)];if(this.renderWorldCopies){const v=this.pointCoordinate(new h.P(0,0)),w=this.pointCoordinate(new h.P(this.width,0)),E=this.pointCoordinate(new h.P(this.width,this.height)),S=this.pointCoordinate(new h.P(0,this.height)),I=Math.floor(Math.min(v.x,w.x,E.x,S.x)),O=Math.floor(Math.max(v.x,w.x,E.x,S.x)),N=1;for(let V=I-N;V<=O+N;V++)0!==V&&f.push(new h.U(V,c))}return f}isLODDisabled(c){return(!c||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(c,f,v){let w=[];if(0===f[0]&&0===f[1])return w;for(const S of c){const I=S.canonical,O=S.overscaledZ,N=S.wrap,V=1<<I.z,H=I.x+1<V,G=I.x>0,Y=I.y+1<V,ee=I.y>0,K=S.wrap-(G?0:1),ne=S.wrap+(H?0:1),J=G?I.x-1:V-1,oe=H?I.x+1:0;f[0]<0?(w.push(new h.O(O,ne,I.z,oe,I.y)),f[1]<0&&Y&&(w.push(new h.O(O,N,I.z,I.x,I.y+1)),w.push(new h.O(O,ne,I.z,oe,I.y+1))),f[1]>0&&ee&&(w.push(new h.O(O,N,I.z,I.x,I.y-1)),w.push(new h.O(O,ne,I.z,oe,I.y-1)))):f[0]>0?(w.push(new h.O(O,K,I.z,J,I.y)),f[1]<0&&Y&&(w.push(new h.O(O,N,I.z,I.x,I.y+1)),w.push(new h.O(O,K,I.z,J,I.y+1))),f[1]>0&&ee&&(w.push(new h.O(O,N,I.z,I.x,I.y-1)),w.push(new h.O(O,K,I.z,J,I.y-1)))):f[1]<0&&Y?w.push(new h.O(O,N,I.z,I.x,I.y+1)):ee&&w.push(new h.O(O,N,I.z,I.x,I.y-1))}if(w.length>1){w.sort((O,N)=>O.overscaledZ-N.overscaledZ||O.wrap-N.wrap||O.canonical.z-N.canonical.z||O.canonical.x-N.canonical.x||O.canonical.y-N.canonical.y);let S=0,I=0;for(;I<w.length;)w[I].equals(w[S])?++I:w[++S]=w[I++];w.length=S+1}const E=[];for(const S of w)w.some(I=>S.isChildOf(I))||E.push(S);return w=E.filter(S=>!c.some(I=>!!(S.overscaledZ<v&&I.isChildOf(S))||S.equals(I)||S.isChildOf(I))),w}coveringTiles(c){let f=this.coveringZoomLevel(c);const v=f,w=this.elevation&&this.elevation.exaggeration(),E=w&&!c.isTerrainDEM,S="mercator"===this.projection.name;if(void 0!==c.minzoom&&f<c.minzoom)return[];void 0!==c.maxzoom&&f>c.maxzoom&&(f=c.maxzoom);const I=this.locationCoordinate(this.center),O=this.center.lat,N=1<<f,V=[N*I.x,N*I.y,0],H="globe"===this.projection.name,G=!H,Y=h.F.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f,G),ee=H?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),K=N*h.b(1,this.center.lat),ne=this._camera.position[2]/h.b(1,this.center.lat),J=[N*ee.x,N*ee.y,ne*(G?1:K)],oe=H||w,_e=this.cameraToCenterDistance/c.tileSize*(c.roundZoom?1:.502),ye=this.isLODDisabled(!0)?f:0;let re;if(this._elevation&&c.isTerrainDEM)re=1e4*this._elevation.exaggeration();else if(this._elevation){const fe=this._elevation.getMinMaxForVisibleTiles();re=fe?fe.max:this._centerAltitude}else re=this._centerAltitude;const ae=c.isTerrainDEM?-re:this._elevation?this._elevation.getMinElevationBelowMSL():0,be=this.projection.isReprojectedInTileSpace?h.r(this):1,Se=fe=>{const At=new h.M(fe.x+25e-6,fe.y,fe.z),vt=new h.M(fe.x,fe.y+25e-6,fe.z),an=fe.toLngLat(),Xt=At.toLngLat(),mn=vt.toLngLat(),nn=this.locationCoordinate(an),Rn=this.locationCoordinate(Xt),Pn=this.locationCoordinate(mn),gn=Math.hypot(Rn.x-nn.x,Rn.y-nn.y),_n=Math.hypot(Pn.x-nn.x,Pn.y-nn.y);return Math.sqrt(gn*_n)*be/25e-6},Ce=fe=>{const Ne=re,At=ae;return{aabb:h.y(this,N,0,0,0,fe,At,Ne,this.projection),zoom:0,x:0,y:0,minZ:At,maxZ:Ne,wrap:fe,fullyVisible:!1}},ke=[];let lt=[];const $e=f,Qe=c.reparseOverscaled?v:f,Fe=fe=>fe*fe,ot=Fe((ne-this._centerAltitude)*K),Ke=fe=>{if(!this._elevation||!fe.tileID||!S)return;const Ne=this._elevation.getMinMaxForTile(fe.tileID),At=fe.aabb;Ne?(At.min[2]=Ne.min,At.max[2]=Ne.max,At.center[2]=(At.min[2]+At.max[2])/2):(fe.shouldSplit=Ue(fe),fe.shouldSplit||(At.min[2]=At.max[2]=At.center[2]=this._centerAltitude))},Ue=fe=>{if(fe.zoom<ye)return!0;if(fe.zoom===$e)return!1;if(null!=fe.shouldSplit)return fe.shouldSplit;const Ne=fe.aabb.distanceX(J),At=fe.aabb.distanceY(J);let vt=ot,an=1;if(H){vt=Fe(fe.aabb.distanceZ(J));const nn=Math.pow(2,fe.zoom),Rn=h.l((fe.y+1)/nn),Pn=h.l(fe.y/nn),gn=Math.min(Math.max(O,Rn),Pn),_n=h.a0(gn)/h.a0(O);if(an=gn===O?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,_n/this._mercatorScaleRatio),this.zoom<=h.Z&&fe.zoom===$e-1&&_n>=.9)return!0}else if(E&&(vt=Fe(fe.aabb.distanceZ(J)*K)),this.projection.isReprojectedInTileSpace&&v<=5){const nn=Math.pow(2,fe.zoom),Rn=Se(new h.M((fe.x+.5)/nn,(fe.y+.5)/nn));an=Rn>.85?1:Rn}const Xt=Ne*Ne+At*At+vt;return Xt<Fe((1<<$e-fe.zoom)*_e*an*((nn,Rn)=>{if(Rn*Fe(.707)<nn)return 1;const Pn=Math.sqrt(Rn/nn);return Pn/(1.4144271570014144+(Math.pow(1.1,Pn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(vt,ot),Xt))};if(this.renderWorldCopies)for(let fe=1;fe<=3;fe++)ke.push(Ce(-fe)),ke.push(Ce(fe));for(ke.push(Ce(0));ke.length>0;){const fe=ke.pop(),Ne=fe.x,At=fe.y;let vt=fe.fullyVisible;const an=()=>"globe"===this.projection.name&&(0===fe.y||fe.y===(1<<fe.zoom)-1);if(!vt){let Xt=oe?fe.aabb.intersects(Y):fe.aabb.intersectsFlat(Y);if(0===Xt&&an()){const mn=new h.t(fe.zoom,Ne,At);Xt=h.x(this,N,mn,!0).intersects(Y)}if(0===Xt)continue;vt=2===Xt}if(fe.zoom!==$e&&Ue(fe))for(let Xt=0;Xt<4;Xt++){const mn=(Ne<<1)+Xt%2,nn=(At<<1)+(Xt>>1),Rn={aabb:S?fe.aabb.quadrant(Xt):h.y(this,N,fe.zoom+1,mn,nn,fe.wrap,fe.minZ,fe.maxZ,this.projection),zoom:fe.zoom+1,x:mn,y:nn,wrap:fe.wrap,fullyVisible:vt,tileID:void 0,shouldSplit:void 0,minZ:fe.minZ,maxZ:fe.maxZ};E&&!H&&(Rn.tileID=new h.O(fe.zoom+1===$e?Qe:fe.zoom+1,fe.wrap,fe.zoom+1,mn,nn),Ke(Rn)),ke.push(Rn)}else{const Xt=fe.zoom===$e?Qe:fe.zoom;if(c.minzoom&&c.minzoom>Xt)continue;if(!vt){let Pn=oe?fe.aabb.intersectsPrecise(Y):fe.aabb.intersectsPreciseFlat(Y);if(0===Pn&&an()){const gn=new h.t(fe.zoom,Ne,At);Pn=h.x(this,N,gn,!0).intersectsPrecise(Y)}if(0===Pn)continue}const mn=V[0]-(.5+Ne+(fe.wrap<<fe.zoom))*(1<<f-fe.zoom),nn=V[1]-.5-At,Rn=fe.tileID?fe.tileID:new h.O(Xt,fe.wrap,fe.zoom,Ne,At);lt.push({tileID:Rn,distanceSq:mn*mn+nn*nn})}}if(this.fogCullDistSq){const fe=this.fogCullDistSq,Ne=this.horizonLineFromTop();lt=lt.filter(At=>{const vt=[0,0,0,1],an=[h.J,h.J,0,1],Xt=this.calculateFogTileMatrix(At.tileID.toUnwrapped());h.e.transformMat4(vt,vt,Xt),h.e.transformMat4(an,an,Xt);const mn=h.e.min([],vt,an),nn=h.e.max([],vt,an),Rn=h.z(mn,nn);if(0===Rn)return!0;let Pn=!1;const gn=this._elevation;if(gn&&Rn>fe&&0!==Ne){const _n=this.calculateProjMatrix(At.tileID.toUnwrapped());let mt;c.isTerrainDEM||(mt=gn.getMinMaxForTile(At.tileID)),mt||(mt={min:ae,max:re});const un=h._(this.rotation),Mn=[un[0]*h.J,un[1]*h.J,mt.max];h.v.transformMat4(Mn,Mn,_n),Pn=(1-Mn[1])*this.height*.5<Ne}return Rn<fe||Pn})}return lt.sort((fe,Ne)=>fe.distanceSq-Ne.distanceSq).map(fe=>fe.tileID)}resize(c,f){this.width=c,this.height=f,this.pixelsToGLUnits=[2/c,-2/f],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const f=h.c(c.lat,-h.A,h.A),v=this.projection.project(c.lng,f);return new h.P(v.x*this.worldSize,v.y*this.worldSize)}unproject(c){return this.projection.unproject(c.x/this.worldSize,c.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/h.b(1,this.center.lat)/this.worldSize}setLocationAtPoint(c,f){let v,w;const E=this.centerPoint;if("globe"===this.projection.name){const I=this.worldSize;v=(f.x-E.x)/I,w=(f.y-E.y)/I}else{const I=this.pointCoordinate(f),O=this.pointCoordinate(E);v=I.x-O.x,w=I.y-O.y}const S=this.locationCoordinate(c);this.setLocation(new h.M(S.x-v,S.y-w))}setLocation(c){this.center=this.coordinateLocation(c),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(c){return this.projection.locationPoint(this,c)}locationPoint3D(c){return this.projection.locationPoint(this,c,!0)}pointLocation(c){return this.coordinateLocation(this.pointCoordinate(c))}pointLocation3D(c){return this.coordinateLocation(this.pointCoordinate3D(c))}locationCoordinate(c,f){const v=f?h.b(f,c.lat):void 0,w=this.projection.project(c.lng,c.lat);return new h.M(w.x,w.y,v)}coordinateLocation(c){return this.projection.unproject(c.x,c.y)}pointRayIntersection(c,f){const v=f??this._centerAltitude,w=[c.x,c.y,0,1],E=[c.x,c.y,1,1];h.e.transformMat4(w,w,this.pixelMatrixInverse),h.e.transformMat4(E,E,this.pixelMatrixInverse);const S=E[3];h.e.scale(w,w,1/w[3]),h.e.scale(E,E,1/S);const I=w[2],O=E[2];return{p0:w,p1:E,t:I===O?0:(v-I)/(O-I)}}screenPointToMercatorRay(c){const f=[c.x,c.y,0,1],v=[c.x,c.y,1,1];return h.e.transformMat4(f,f,this.pixelMatrixInverse),h.e.transformMat4(v,v,this.pixelMatrixInverse),h.e.scale(f,f,1/f[3]),h.e.scale(v,v,1/v[3]),f[2]=h.b(f[2],this._center.lat)*this.worldSize,v[2]=h.b(v[2],this._center.lat)*this.worldSize,h.e.scale(f,f,1/this.worldSize),h.e.scale(v,v,1/this.worldSize),new h.R([f[0],f[1],f[2]],h.v.normalize([],h.v.sub([],v,f)))}rayIntersectionCoordinate(c){const{p0:f,p1:v,t:w}=c,E=h.b(f[2],this._center.lat),S=h.b(v[2],this._center.lat);return new h.M(h.n(f[0],v[0],w)/this.worldSize,h.n(f[1],v[1],w)/this.worldSize,h.n(E,S,w))}pointCoordinate(c,f=this._centerAltitude){return this.projection.pointCoordinate(this,c.x,c.y,f)}pointCoordinate3D(c){if(!this.elevation)return this.pointCoordinate(c);let f=this.projection.pointCoordinate3D(this,c.x,c.y);if(f)return new h.M(f[0],f[1],f[2]);let v=0,w=this.horizonLineFromTop();if(c.y>w)return this.pointCoordinate(c);const E=.02*w,S=c.clone();for(let I=0;I<10&&w-v>E;I++){S.y=h.n(v,w,.66);const O=this.projection.pointCoordinate3D(this,S.x,S.y);O?(w=S.y,f=O):v=S.y}return f?new h.M(f[0],f[1],f[2]):this.pointCoordinate(c)}isPointAboveHorizon(c){return this.projection.isPointAboveHorizon(this,c)}isPointOnSurface(c){if(c.y<0||c.y>this.height||c.x<0||c.x>this.width)return!1;if(this.elevation||this.zoom>=h.G)return!this.isPointAboveHorizon(c);const f=this.pointCoordinate(c);return f.y>=0&&f.y<=1}_coordinatePoint(c,f){const v=f&&this.elevation?this.elevation.getAtPointOrZero(c,this._centerAltitude):this._centerAltitude,w=[c.x*this.worldSize,c.y*this.worldSize,v+c.toAltitude(),1];return h.e.transformMat4(w,w,this.pixelMatrix),w[3]>0?new h.P(w[0]/w[3],w[1]/w[3]):new h.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:c,left:f}=this._edgeInsets,v=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,E=this.pointLocation3D(new h.P(f,c)),S=this.pointLocation3D(new h.P(w,c)),I=this.pointLocation3D(new h.P(w,v)),O=this.pointLocation3D(new h.P(f,v));let N=Math.min(E.lng,S.lng,I.lng,O.lng),V=Math.max(E.lng,S.lng,I.lng,O.lng),H=Math.min(E.lat,S.lat,I.lat,O.lat),G=Math.max(E.lat,S.lat,I.lat,O.lat);const Y=Math.pow(2,-this.zoom)/16*270,ee="globe"===this.projection.name?1:4,K=(ne,J,oe,_e,ye)=>{const re=(ne+oe)/2,ae=(J+_e)/2,be=new h.P(re,ae),{lng:Se,lat:Ce}=this.pointLocation3D(be),ke=Math.max(0,N-Se,H-Ce,Se-V,Ce-G);N=Math.min(N,Se),V=Math.max(V,Se),H=Math.min(H,Ce),G=Math.max(G,Ce),(ye<ee||ke>Y)&&(K(ne,J,re,ae,ye+1),K(re,ae,oe,_e,ye+1))};if(K(f,c,w,c,1),K(w,c,w,v,1),K(w,v,f,v,1),K(f,v,f,c,1),"globe"===this.projection.name){const[ne,J]=h.B(this);ne?(G=90,V=180,N=-180):J&&(H=-90,V=180,N=-180)}return new h.D(new h.L(N,H),new h.L(V,G))}_getBoundsRectangular(c,f){const{top:v,left:w}=this._edgeInsets,E=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,I=new h.P(w,v),O=new h.P(S,v),N=new h.P(S,E),V=new h.P(w,E);let H=this.pointCoordinate(I,c),G=this.pointCoordinate(O,c);const Y=this.pointCoordinate(N,f),ee=this.pointCoordinate(V,f),K=(ne,J)=>(J.y-ne.y)/(J.x-ne.x);return H.y>1&&G.y>=0?H=new h.M((1-ee.y)/K(ee,H)+ee.x,1):H.y<0&&G.y<=1&&(H=new h.M(-ee.y/K(ee,H)+ee.x,0)),G.y>1&&H.y>=0?G=new h.M((1-Y.y)/K(Y,G)+Y.x,1):G.y<0&&H.y<=1&&(G=new h.M(-Y.y/K(Y,G)+Y.x,0)),(new h.D).extend(this.coordinateLocation(H)).extend(this.coordinateLocation(G)).extend(this.coordinateLocation(ee)).extend(this.coordinateLocation(Y))}_getBoundsRectangularTerrain(){const c=this.elevation;if(!c.visibleDemTiles.length||c.isUsingMockSource())return this._getBoundsRectangular(0,0);const f=c.visibleDemTiles.reduce((v,w)=>{if(w.dem){const E=w.dem.tree;v.min=Math.min(v.min,E.minimums[0]),v.max=Math.max(v.max,E.maximums[0])}return v},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(f.min*c.exaggeration(),f.max*c.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(c=!0){const f=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,v=this.height/2-f*(1-this._horizonShift);return c?Math.max(0,v):v}getMaxBounds(){return this.maxBounds}setMaxBounds(c){this.maxBounds=c,this.minLat=-h.A,this.maxLat=h.A,this.minLng=-180,this.maxLng=180,c&&(this.minLat=c.getSouth(),this.maxLat=c.getNorth(),this.minLng=c.getWest(),this.maxLng=c.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=h.E(this.minLng)*this.tileSize,this.worldMaxX=h.E(this.maxLng)*this.tileSize,this.worldMinY=h.H(this.maxLat)*this.tileSize,this.worldMaxY=h.H(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(c,f){return this.projection.createTileMatrix(this,f,c)}calculateDistanceTileData(c){const f=c.key,v=this._distanceTileDataCache;if(v[f])return v[f];const w=c.canonical,E=1/this.height,S=this.cameraWorldSize,I=S/this.zoomScale(w.z),O=(w.x+Math.pow(2,w.z)*c.wrap)*I,N=w.y*I,V=this.point;V.x*=S/this.worldSize,V.y*=S/this.worldSize;const H=this.angle,G=Math.sin(-H),Y=-Math.cos(-H);return v[f]={bearing:[G,Y],center:[(V.x-O)*E,(V.y-N)*E],scale:I/h.J*E},v[f]}calculateFogTileMatrix(c){const f=c.key,v=this._fogTileMatrixCache;if(v[f])return v[f];const w=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,c);return h.m.multiply(w,this.worldToFogMatrix,w),v[f]=new Float32Array(w),v[f]}calculateProjMatrix(c,f=!1,v=!1){const w=c.key;let E;if(E=v?this._expandedProjMatrixCache:f?this._alignedProjMatrixCache:this._projMatrixCache,E[w])return E[w];const S=this.calculatePosMatrix(c,this.worldSize);let I;return I=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:v?this.expandedFarZProjMatrix:f?this.alignedProjMatrix:this.projMatrix,h.m.multiply(S,I,S),E[w]=new Float32Array(S),E[w]}calculatePixelsToTileUnitsMatrix(c){const f=c.tileID.key,v=this._pixelsToTileUnitsCache;if(v[f])return v[f];const w=h.K(c,this);return v[f]=w,v[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const c=1/this.worldSize,f=h.m.fromScaling([],[c,c,c]);return h.m.multiply(f,f,this.globeMatrix),f}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const c=this._elevation;this._updateCameraState();const f=h.b(1,this._center.lat)*this.worldSize,v=this._computeCameraPosition(f),w=this._camera.forward(),E=h.b(1,this._center.lat);v[2]/=E,w[2]/=E,h.v.normalize(w,w);const S=c.raycast(v,w,c.exaggeration());if(S){const I=h.v.scaleAndAdd([],v,w,S),O=new h.M(I[0],I[1],h.b(I[2],h.l(I[1]))),N=(O.z+h.v.length([O.x-v[0],O.y-v[1],O.z-v[2]*E]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(N),this._centerAltitude=O.toAltitude(),this._center=this.coordinateLocation(O),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(c=!1){if(!this._elevation)return;const f=this._elevation,v=h.b(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(v),E=f.getAtPointOrZero(new h.M(...w)),S=this.pixelsPerMeter/this.worldSize*E,I=this._minimumHeightOverTerrain(),O=w[2]-S;if(O<=I)if(O<0||c){const N=this.locationCoordinate(this._center,this._centerAltitude),V=[w[0],w[1],N.z-w[2]],H=h.v.length(V);V[2]-=(I-O)/this._pixelsPerMercatorPixel;const G=h.v.length(V);if(0===G)return;h.v.scale(V,V,H/G*this._pixelsPerMercatorPixel),this._camera.position=[w[0],w[1],N.z*this._pixelsPerMercatorPixel-V[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const c="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||c){const G=this.center;return G.lat=h.c(G.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!c)&&(G.lng=h.c(G.lng,this.minLng,this.maxLng)),this.center=G,void(this._constraining=!1)}const f=this._unmodified,{x:v,y:w}=this.point;let E=0,S=v,I=w;const O=this.width/2,N=this.height/2,V=this.worldMinY*this.scale,H=this.worldMaxY*this.scale;if(w-N<V&&(I=V+N),w+N>H&&(I=H-N),H-V<this.height&&(E=Math.max(E,this.height/(H-V)),I=(H+V)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const G=this.worldMinX*this.scale,Y=this.worldMaxX*this.scale,ee=this.worldSize/2-(G+Y)/2;S=(v+ee+this.worldSize)%this.worldSize-ee,S-O<G&&(S=G+O),S+O>Y&&(S=Y-O),Y-G<this.width&&(E=Math.max(E,this.width/(Y-G)),S=(Y+G)/2)}S===v&&I===w||(this.center=this.unproject(new h.P(S,I))),E&&(this.zoom+=this.scaleZoom(E)),this._constrainCamera(),this._unmodified=f,this._constraining=!1}_minZoomForBounds(){let c=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(c=Math.max(c,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),c}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,f="globe"===this.projection.name,v=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=h.b(1,this.center.lat)/h.b(1,h.$));const w=h.N(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,w),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const E="meters"===this.projection.zAxisUnit?v:1,S=this._camera.getWorldToCamera(this.worldSize,E);let I;const O=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(O[8]=2*-c.x/this.width,O[9]=2*c.y/this.height,this.isOrthographic){let Ce=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),ke=Ce*this.aspect,lt=-ke,$e=-Ce;ke-=c.x,lt-=c.x,Ce+=c.y,$e+=c.y,I=this._camera.getCameraToClipOrthographic(lt,ke,$e,Ce,this._nearZ,this._farZ),((Qe,Fe,ot,Ke)=>{for(let Ue=0;Ue<16;Ue++)Qe[Ue]=xi(Fe[Ue],ot[Ue],Ke)})(I,I,O,tn(this.pitch>=15?1:this.pitch/15))}else I=O;const N=h.m.mul([],O,S);let V=h.m.mul([],I,S);if(this.projection.isReprojectedInTileSpace){const Ce=this.locationCoordinate(this.center),ke=h.m.identity([]);h.m.translate(ke,ke,[Ce.x*this.worldSize,Ce.y*this.worldSize,0]),h.m.multiply(ke,ke,h.Q(this)),h.m.translate(ke,ke,[-Ce.x*this.worldSize,-Ce.y*this.worldSize,0]),h.m.multiply(V,V,ke),h.m.multiply(N,N,ke),this.inverseAdjustmentMatrix=h.S(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=h.m.scale([],V,[this.worldSize,this.worldSize,this.worldSize/E,1]),this.projMatrix=V,this.invProjMatrix=h.m.invert(new Float64Array(16),this.projMatrix),f){const Ce=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Ce[8]=2*-c.x/this.width,Ce[9]=2*c.y/this.height,this.expandedFarZProjMatrix=h.m.mul([],Ce,S)}else this.expandedFarZProjMatrix=this.projMatrix;const H=h.m.invert([],I);this.frustumCorners=h.T.fromInvProjectionMatrix(H,this.horizonLineFromTop(),this.height),this.cameraFrustum=h.F.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!f);const G=new Float32Array(16);h.m.identity(G),h.m.scale(G,G,[1,-1,1]),h.m.rotateX(G,G,this._pitch),h.m.rotateZ(G,G,this.angle);const Y=h.m.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=h.m.clone(Y);const ee=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Y[8]=2*-c.x/this.width,Y[9]=2*(c.y+ee)/this.height,this.skyboxMatrix=h.m.multiply(G,Y,G);const K=this.point,ne=K.x,J=K.y,oe=this.width%2/2,_e=this.height%2/2,ye=Math.cos(this.angle),re=Math.sin(this.angle),ae=ne-Math.round(ne)+ye*oe+re*_e,be=J-Math.round(J)+ye*_e+re*oe,Se=new Float64Array(V);if(h.m.translate(Se,Se,[ae>.5?ae-1:ae,be>.5?be-1:be,0]),this.alignedProjMatrix=Se,V=h.m.create(),h.m.scale(V,V,[this.width/2,-this.height/2,1]),h.m.translate(V,V,[1,-1,0]),this.labelPlaneMatrix=V,V=h.m.create(),h.m.scale(V,V,[1,-1,1]),h.m.translate(V,V,[-1,-1,0]),h.m.scale(V,V,[2/this.width,2/this.height,1]),this.glCoordMatrix=V,this.pixelMatrix=h.m.multiply(new Float64Array(16),this.labelPlaneMatrix,N),this._calcFogMatrices(),this._distanceTileDataCache={},V=h.m.invert(new Float64Array(16),this.pixelMatrix),!V)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=V,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=h.V(this);const Ce=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=h.v.transformMat4(Ce,Ce,S),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=V;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const c=this.cameraWorldSizeForFog,f=this.cameraPixelsPerMeter,v=this._camera.position,w=1/this.height/this._pixelsPerMercatorPixel,E=[c,c,f];h.v.scale(E,E,w),h.v.scale(v,v,-1),h.v.multiply(v,v,E);const S=h.m.create();h.m.translate(S,S,v),h.m.scale(S,S,E),this.mercatorFogMatrix=S,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(c,f,w)}_computeCameraPosition(c){const f=(c=c||this.pixelsPerMeter)/this.pixelsPerMeter,v=this._camera.forward(),w=this.point,E=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*f-c/this.worldSize*this._centerAltitude;return[w.x/this.worldSize-v[0]*E,w.y/this.worldSize-v[1]*E,c/this.worldSize*this._centerAltitude-v[2]*E]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(c){const f=this._maxCameraBoundsDistance()*Math.cos(this._pitch),v=this._camera.position[2],w=c[2];let E=1;this.projection.wrap&&(this.center=this.center.wrap()),w>0&&(E=Math.min((f-v)/w,1)),this._camera.position=h.v.scaleAndAdd([],this._camera.position,c,E),this._updateStateFromCamera()}_updateStateFromCamera(){const c=this._camera.position,f=this._camera.forward(),{pitch:v,bearing:w}=this._camera.getPitchBearing(),E=h.b(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,S=this._mercatorZfromZoom(this._maxZoom)*Math.cos(h.d(this._maxPitch)),I=Math.max((c[2]-E)/Math.cos(v),S),O=this._zoomFromMercatorZ(I);h.v.scaleAndAdd(c,c,f,I),this._pitch=h.c(v,h.d(this.minPitch),h.d(this.maxPitch)),this.angle=h.w(w,-Math.PI,Math.PI),this._setZoom(h.c(O,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new h.M(c[0],c[1],c[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(c){return Math.pow(2,c)*this.tileSize}_mercatorZfromZoom(c){return this.cameraToCenterDistance/this._worldSizeFromZoom(c)}_minimumHeightOverTerrain(){const c=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(c)}_zoomFromMercatorZ(c){return this.scaleZoom(this.cameraToCenterDistance/(c*this.tileSize))}zoomFromMercatorZAdjusted(c){let f=0,v=h.G,w=0,E=1/0;for(;v-f>1e-6&&v>f;){const S=f+.5*(v-f),I=this.tileSize*Math.pow(2,S),O=this.getCameraToCenterDistance(this.projection,S,I),N=this.scaleZoom(O/(c*this.tileSize)),V=Math.abs(S-N);V<E&&(E=V,w=S),S<N?f=S:v=S}return w}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(h.X("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(c,f){const v=Math.min(c.x,f.x),w=Math.max(c.x,f.x),E=Math.min(c.y,f.y),S=Math.max(c.y,f.y);if(E<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const I=[new h.P(v,E),new h.P(w,S),new h.P(v,S),new h.P(w,E)],O=this.renderWorldCopies?-3:0,N=this.renderWorldCopies?4:1;for(const V of I){const H=this.pointRayIntersection(V);if(H.t<0)return!0;const G=this.rayIntersectionCoordinate(H);if(G.x<O||G.y<0||G.x>N||G.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+h.Y(this.fovAboveCenter)>88||this.anyCornerOffEdge(new h.P(0,0),new h.P(this.width,this.height))}zoomDeltaToMovement(c,f){const v=h.v.length(h.v.sub([],this._camera.position,c)),w=this._zoomFromMercatorZ(v)+f;return v-this._mercatorZfromZoom(w)}getCameraPoint(){if("globe"===this.projection.name){const c=function([f,v,w],E){const S=[f,v,w,1];h.e.transformMat4(S,S,E);const I=S[3]=Math.max(S[3],1e-6);return S[0]/=I,S[1]/=I,S[2]/=I,S}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new h.P(c[0],c[1])}{const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.P(0,c))}}getCameraToCenterDistance(c,f=this.zoom,v=this.worldSize){const w=h.N(c,f,this.width,this.height,1024),E=c.pixelSpaceConversion(this.center.lat,v,w);let S=.5/Math.tan(.5*this._fov)*this.height*E;return this.isOrthographic&&(S=xi(1,S,tn(this.pitch>=15?1:this.pitch/15))),S}getWorldToCameraMatrix(){const c=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&h.m.multiply(c,c,this.globeMatrix),c}getFrustum(c){return h.F.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,"meters"===this.projection.zAxisUnit)}}function Ai(_){const{userImage:c}=_;return!!(c&&c.render&&c.render())&&(_.data.replace(new Uint8Array(c.data.buffer)),!0)}class Ir extends h.a6{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(c){this.images[c]={},this.loaded[c]=!1,this.updatedImages[c]={},this.patterns[c]={},this.callbackDispatchedThisFrame[c]={},this.atlasImage[c]=new h.a5({width:1,height:1})}isLoaded(){for(const c in this.loaded)if(!this.loaded[c])return!1;return!0}setLoaded(c,f){if(this.loaded[f]!==c&&(this.loaded[f]=c,c)){for(const{ids:v,callback:w}of this.requestors)this._notify(v,f,w);this.requestors=[]}}hasImage(c,f){return!!this.getImage(c,f)}getImage(c,f){return this.images[f][c]}addImage(c,f,v){this._validate(c,v)&&(this.images[f][c]=v)}_validate(c,f){let v=!0;return this._validateStretch(f.stretchX,f.data&&f.data.width)||(this.fire(new h.a7(new Error(`Image "${c}" has invalid "stretchX" value`))),v=!1),this._validateStretch(f.stretchY,f.data&&f.data.height)||(this.fire(new h.a7(new Error(`Image "${c}" has invalid "stretchY" value`))),v=!1),this._validateContent(f.content,f)||(this.fire(new h.a7(new Error(`Image "${c}" has invalid "content" value`))),v=!1),v}_validateStretch(c,f){if(!c)return!0;let v=0;for(const w of c){if(w[0]<v||w[1]<w[0]||f<w[1])return!1;v=w[1]}return!0}_validateContent(c,f){return!(c&&(4!==c.length||c[0]<0||f.data.width<c[0]||c[1]<0||f.data.height<c[1]||c[2]<0||f.data.width<c[2]||c[3]<0||f.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))}updateImage(c,f,v){v.version=this.images[f][c].version+1,this.images[f][c]=v,this.updatedImages[f][c]=!0}removeImage(c,f){const v=this.images[f][c];delete this.images[f][c],delete this.patterns[f][c],v.userImage&&v.userImage.onRemove&&v.userImage.onRemove()}listImages(c){return Object.keys(this.images[c])}getImages(c,f,v){let w=!0;const E=!!this.loaded[f];if(!E)for(const S of c)this.images[f][S]||(w=!1);E||w?this._notify(c,f,v):this.requestors.push({ids:c,scope:f,callback:v})}getUpdatedImages(c){return this.updatedImages[c]}_notify(c,f,v){const w={};for(const E of c){this.images[f][E]||this.fire(new h.a8("styleimagemissing",{id:E}));const S=this.images[f][E];S?w[E]={data:S.data.clone(),pixelRatio:S.pixelRatio,sdf:S.sdf,version:S.version,stretchX:S.stretchX,stretchY:S.stretchY,content:S.content,hasRenderCallback:!(!S.userImage||!S.userImage.render)}:h.X(`Image "${E}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}v(null,w)}getPixelSize(c){const{width:f,height:v}=this.atlasImage[c];return{width:f,height:v}}getPattern(c,f){const v=this.patterns[f][c],w=this.getImage(c,f);if(!w)return null;if(v&&v.position.version===w.version)return v.position;if(v)v.position.version=w.version;else{const E={w:w.data.width+2,h:w.data.height+2,x:0,y:0},S=new h.ab(E,w);this.patterns[f][c]={bin:E,position:S}}return this._updatePatternAtlas(f),this.patterns[f][c].position}bind(c,f){const v=c.gl;let w=this.atlasTexture[f];w?this.dirty&&(w.update(this.atlasImage[f]),this.dirty=!1):(w=new h.a9(c,this.atlasImage[f],v.RGBA),this.atlasTexture[f]=w),w.bind(v.LINEAR,v.CLAMP_TO_EDGE)}_updatePatternAtlas(c){const f=[];for(const S in this.patterns[c])f.push(this.patterns[c][S].bin);const{w:v,h:w}=h.aa(f),E=this.atlasImage[c];E.resize({width:v||1,height:w||1});for(const S in this.patterns[c]){const{bin:I}=this.patterns[c][S],O=I.x+1,N=I.y+1,V=this.images[c][S].data,H=V.width,G=V.height;h.a5.copy(V,E,{x:0,y:0},{x:O,y:N},{width:H,height:G}),h.a5.copy(V,E,{x:0,y:G-1},{x:O,y:N-1},{width:H,height:1}),h.a5.copy(V,E,{x:0,y:0},{x:O,y:N+G},{width:H,height:1}),h.a5.copy(V,E,{x:H-1,y:0},{x:O-1,y:N},{width:1,height:G}),h.a5.copy(V,E,{x:0,y:0},{x:O+H,y:N},{width:1,height:G})}this.dirty=!0}beginFrame(){for(const c in this.images)this.callbackDispatchedThisFrame[c]={}}dispatchRenderCallbacks(c,f){for(const v of c){if(this.callbackDispatchedThisFrame[f][v])continue;this.callbackDispatchedThisFrame[f][v]=!0;const w=this.images[f][v];Ai(w)&&this.updateImage(v,f,w)}}}const xr=new h.ac({anchor:new h.ad(h.ae.light.anchor),position:new h.af(h.ae.light.position),color:new h.ad(h.ae.light.color),intensity:new h.ad(h.ae.light.intensity)});class dr extends h.a6{constructor(c,f="flat"){super(),this._transitionable=new h.ag(xr),this.setLight(c,f),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,f,v={}){this._validate(h.ah,c,v)||(this._transitionable.setTransitionOrValue(c),this.id=f)}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,f,v){return(!v||!1!==v.validate)&&h.ai(this,c.call(h.aj,h.ak({value:f,style:{glyphs:!0,sprite:!0},styleSpec:h.ae})))}}const bs=new h.ac({source:new h.ad(h.ae.terrain.source),exaggeration:new h.ad(h.ae.terrain.exaggeration)});let ls=class extends h.a6{constructor(_,c,f,v){super(),this.scope=f,this._transitionable=new h.ag(bs,f,v),this._transitionable.setTransitionOrValue(_,v),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=c}get(){return this._transitionable.serialize()}set(_,c){this._transitionable.setTransitionOrValue(_,c)}updateTransitions(_){this._transitioning=this._transitionable.transitioned(_,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(_){this.properties=this._transitioning.possiblyEvaluate(_)}getExaggeration(_){return this._transitioning.possiblyEvaluate(new h.al(_)).get("exaggeration")}isZoomDependent(){const _=this._transitionable._values.exaggeration;return null!=_&&null!=_.value&&null!=_.value.expression&&_.value.expression instanceof h.am}};const cs=45,Co=65,eo=.05;function fa(_,c,f,v){const w=h.an(cs,Co,f),[E,S]=Wr(_,v);let I=1-Math.min(1,Math.exp((c-E)/(S-E)*-6));return I*=I*I,I=Math.min(1,1.00747*I),I*w*_.alpha}function Wr(_,c){const f=.5/Math.tan(.5*c);return[_.range[0]+f,_.range[1]+f]}function _l(_,c,f,v,w){const E=h.v.transformMat4([],[c,f,v],w.mercatorFogMatrix);return fa(_,h.v.length(E),w.pitch,w._fov)}function Eo(_,c,f,v,w,E,S){const I=[[f,v,0],[w,v,0],[w,E,0],[f,E,0]];let O=Number.MAX_VALUE,N=-Number.MAX_VALUE;for(const V of I){const H=h.v.transformMat4([],V,c),G=h.v.length(H);O=Math.min(O,G),N=Math.max(N,G)}return[fa(_,O,S.pitch,S._fov),fa(_,N,S.pitch,S._fov)]}const gh=new h.ac({range:new h.ad(h.ae.fog.range),color:new h.ad(h.ae.fog.color),"high-color":new h.ad(h.ae.fog["high-color"]),"space-color":new h.ad(h.ae.fog["space-color"]),"horizon-blend":new h.ad(h.ae.fog["horizon-blend"]),"star-intensity":new h.ad(h.ae.fog["star-intensity"]),"vertical-range":new h.ad(h.ae.fog["vertical-range"])});class _h extends h.a6{constructor(c,f){super(),this._transitionable=new h.ag(gh),this.set(c),this._transitioning=this._transitionable.untransitioned(),this._transform=f}get state(){const c=this._transform,f="globe"===c.projection.name,v=h.ao(c.zoom),w=this.properties.get("range"),E=[.5,3];return{range:f?[h.n(E[0],w[0],v),h.n(E[1],w[1],v)]:w,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(c,f={}){if(this._validate(h.ap,c,f))return;const v=h.ak({},c);for(const w of Object.keys(h.ae.fog))void 0===v[w]&&(v[w]=h.ae.fog[w].default);this._transitionable.setTransitionOrValue(v)}getOpacity(c){if(!this._transform.projection.supportsFog)return 0;const f=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:h.an(cs,Co,c))*f.a}getOpacityAtLatLng(c,f){return this._transform.projection.supportsFog?function(v,w,E){const S=h.M.fromLngLat(w),I=E.elevation?E.elevation.getAtPointOrZero(S):0;return _l(v,S.x,S.y,I,E)}(this.state,c,f):0}getOpacityForTile(c){if(!this._transform.projection.supportsFog)return[1,1];const f=this._transform.calculateFogTileMatrix(c.toUnwrapped());return Eo(this.state,f,0,0,h.J,h.J,this._transform)}getOpacityForBounds(c,f,v,w,E){return this._transform.projection.supportsFog?Eo(this.state,c,f,v,w,E,this._transform):[1,1]}getFovAdjustedRange(c){return this._transform.projection.supportsFog?Wr(this.state,c):[0,1]}isVisibleOnFrustum(c){if(!this._transform.projection.supportsFog)return!1;const f=[4,5,6,7];for(const v of f){const w=c.points[v];let E;if(w[2]>=0)E=w;else{const S=c.points[v-4];E=h.aq(S,w,S[2]/(S[2]-w[2]))}if(_l(this.state,E[0],E[1],0,this._transform)>=eo)return!0}return!1}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,f,v){return(!v||!1!==v.validate)&&h.ai(this,c.call(h.aj,h.ak({value:f,style:{glyphs:!0,sprite:!0},styleSpec:h.ae})))}}class Oc extends h.a6{constructor(c,f,v,w){super(),this.scope=v,this._options=c,this.properties=new h.ar(f),this._transitionable=new h.ag(f,v,new Map(w)),this._transitionable.setTransitionOrValue(c.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(c){this._transitionable.setTransitionOrValue(this._options.properties,new Map(c))}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(c,f){this._options=c,this._transitionable.setTransitionOrValue(c.properties,f)}shadowsEnabled(){return!!this.properties&&!0===this.properties.get("cast-shadows")}}const Ua=new h.ac({color:new h.ad(h.ae.properties_light_ambient.color),intensity:new h.ad(h.ae.properties_light_ambient.intensity)}),yh=new h.ac({direction:new h.as(h.ae.properties_light_directional.direction),color:new h.ad(h.ae.properties_light_directional.color),intensity:new h.ad(h.ae.properties_light_directional.intensity),"cast-shadows":new h.ad(h.ae.properties_light_directional["cast-shadows"]),"shadow-intensity":new h.ad(h.ae.properties_light_directional["shadow-intensity"])});class uo{constructor(c,f,v,w){this.screenBounds=c,this.cameraPoint=f,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=v,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,w)}static createFromScreenPoints(c,f){let v,w;if(c instanceof h.P||"number"==typeof c[0]){const E=h.P.convert(c);v=[E],w=f.isPointAboveHorizon(E)}else{const E=h.P.convert(c[0]),S=h.P.convert(c[1]);v=[E,S],w=h.at(E,S).every(I=>f.isPointAboveHorizon(I))}return new uo(v,f.getCameraPoint(),w,f)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(c){return h.at(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],c)}bufferedCameraGeometry(c){const f=this.screenBounds[0],v=1===this.screenBounds.length?this.screenBounds[0].add(new h.P(1,1)):this.screenBounds[1],w=h.at(f,v,0,!1);return this.cameraPoint.y>v.y&&(this.cameraPoint.x>f.x&&this.cameraPoint.x<v.x?w.splice(3,0,this.cameraPoint):this.cameraPoint.x>=v.x?w[2]=this.cameraPoint:this.cameraPoint.x<=f.x&&(w[3]=this.cameraPoint)),h.au(w,c)}bufferedCameraGeometryGlobe(c){const f=this.screenBounds[0],v=1===this.screenBounds.length?this.screenBounds[0].add(new h.P(1,1)):this.screenBounds[1],w=h.at(f,v,c),E=this.cameraPoint.clone();switch(3*((E.y>f.y)+(E.y>v.y))+((E.x>f.x)+(E.x>v.x))){case 0:w[0]=E,w[4]=E.clone();break;case 1:w.splice(1,0,E);break;case 2:w[1]=E;break;case 3:w.splice(4,0,E);break;case 5:w.splice(2,0,E);break;case 6:w[3]=E;break;case 7:w.splice(3,0,E);break;case 8:w[2]=E}return w}containsTile(c,f,v,w=0){const E=c.queryPadding/f._pixelsPerMercatorPixel+1,S=v?this._bufferedCameraMercator(E,f):this._bufferedScreenMercator(E,f);let I=c.tileID.wrap+(S.unwrapped?w:0);const O=S.polygon.map(ne=>h.av(c.tileTransform,ne,I));if(!h.aw(O,0,0,h.J,h.J))return;I=c.tileID.wrap+(this.screenGeometryMercator.unwrapped?w:0);const N=this.screenGeometryMercator.polygon.map(ne=>h.ax(c.tileTransform,ne,I)),V=N.map(ne=>new h.P(ne[0],ne[1])),H=f.getFreeCameraOptions().position||new h.M(0,0,0),G=h.ax(c.tileTransform,H,I),Y=N.map(ne=>{const J=h.v.sub(ne,ne,G);return h.v.normalize(J,J),new h.R(G,J)}),ee=h.ay(c,1,f.zoom)*f._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:V,tilespaceRays:Y,bufferedTilespaceGeometry:O,bufferedTilespaceBounds:(K=h.az(O),K.min.x=h.c(K.min.x,0,h.J),K.min.y=h.c(K.min.y,0,h.J),K.max.x=h.c(K.max.x,0,h.J),K.max.y=h.c(K.max.y,0,h.J),K),tile:c,tileID:c.tileID,pixelToTileUnitsFactor:ee};var K}_bufferedScreenMercator(c,f){const v=Ao(c);if(this._screenRaycastCache[v])return this._screenRaycastCache[v];{let w;return w="globe"===f.projection.name?this._projectAndResample(this.bufferedScreenGeometry(c),f):{polygon:this.bufferedScreenGeometry(c).map(E=>f.pointCoordinate3D(E)),unwrapped:!0},this._screenRaycastCache[v]=w,w}}_bufferedCameraMercator(c,f){const v=Ao(c);if(this._cameraRaycastCache[v])return this._cameraRaycastCache[v];{let w;return w="globe"===f.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(c),f):{polygon:this.bufferedCameraGeometry(c).map(E=>f.pointCoordinate3D(E)),unwrapped:!0},this._cameraRaycastCache[v]=w,w}}_projectAndResample(c,f){const v=function(E,S){const I=h.m.multiply([],S.pixelMatrix,S.globeMatrix),O=[0,-h.aC,0,1],N=[0,h.aC,0,1],V=[0,0,0,1];h.e.transformMat4(O,O,I),h.e.transformMat4(N,N,I),h.e.transformMat4(V,V,I);const H=new h.P(O[0]/O[3],O[1]/O[3]),G=new h.P(N[0]/N[3],N[1]/N[3]),Y=h.aA(E,H)&&O[3]<V[3],ee=h.aA(E,G)&&N[3]<V[3];if(!Y&&!ee)return null;const K=function(be,Se,Ce){for(let ke=1;ke<be.length;ke++){const lt=yl(Se.pointCoordinate3D(be[ke-1]).x),$e=yl(Se.pointCoordinate3D(be[ke]).x);if(Ce<0){if(lt<$e)return{idx:ke,t:-lt/($e-1-lt)}}else if($e<lt)return{idx:ke,t:(1-lt)/($e+1-lt)}}return null}(E,S,Y?-1:1);if(!K)return null;const{idx:ne,t:J}=K;let oe=ne>1?ud(E.slice(0,ne),S):[],_e=ne<E.length?ud(E.slice(ne),S):[];oe=oe.map(be=>new h.P(yl(be.x),be.y)),_e=_e.map(be=>new h.P(yl(be.x),be.y));const ye=[...oe];0===ye.length&&ye.push(_e[_e.length-1]);const re=h.n(ye[ye.length-1].y,(0===_e.length?oe[0]:_e[0]).y,J);let ae;return ae=Y?[new h.P(0,re),new h.P(0,0),new h.P(1,0),new h.P(1,re)]:[new h.P(1,re),new h.P(1,1),new h.P(0,1),new h.P(0,re)],ye.push(...ae),0===_e.length?ye.push(oe[0]):ye.push(..._e),{polygon:ye.map(be=>new h.M(be.x,be.y)),unwrapped:!1}}(c,f);if(v)return v;const w=function(E,S){let I=!1,O=-1/0,N=0;for(let H=0;H<E.length-1;H++)E[H].x>O&&(O=E[H].x,N=H);for(let H=0;H<E.length-1;H++){const G=(N+H)%(E.length-1),Y=E[G],ee=E[G+1];Math.abs(Y.x-ee.x)>.5&&(Y.x<ee.x?(Y.x+=1,0===G&&(E[E.length-1].x+=1)):(ee.x+=1,G+1===E.length-1&&(E[0].x+=1)),I=!0)}const V=h.E(S.center.lng);return I&&V<Math.abs(V-1)&&E.forEach(H=>{H.x-=1}),{polygon:E,unwrapped:I}}(ud(c,f).map(E=>new h.P(yl(E.x),E.y)),f);return{polygon:w.polygon.map(E=>new h.M(E.x,E.y)),unwrapped:w.unwrapped}}}function ud(_,c){return h.aB(_,f=>{const v=c.pointCoordinate3D(f);f.x=v.x,f.y=v.y},1/256)}function yl(_){return _<0?1+_%1:_%1}function Ao(_){return 100*_|0}function Xl(_,c,f,v,w){const E=function(S,I){if(S)return w(S);if(I){_.url&&I.tiles&&_.tiles&&delete _.tiles;const O=h.p(h.ak(I,_),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);I.vector_layers&&(O.vectorLayers=I.vector_layers,O.vectorLayerIds=O.vectorLayers.map(N=>N.id)),O.tiles=c.canonicalizeTileset(O,_.url),w(null,O)}};return _.url?h.a1(c.transformRequest(c.normalizeSourceURL(_.url,null,f,v),h.a2.Source),E):h.a4.frame(()=>E(null,_))}class pa{constructor(c,f,v){this.bounds=h.D.convert(this.validateBounds(c)),this.minzoom=f||0,this.maxzoom=v||24}validateBounds(c){return Array.isArray(c)&&4===c.length?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const f=Math.pow(2,c.z),v=Math.floor(h.E(this.bounds.getWest())*f),w=Math.floor(h.H(this.bounds.getNorth())*f),E=Math.ceil(h.E(this.bounds.getEast())*f),S=Math.ceil(h.H(this.bounds.getSouth())*f);return c.x>=v&&c.x<E&&c.y>=w&&c.y<S}}class He extends h.a6{constructor(c,f,v,w){if(super(),this.id=c,this.dispatcher=v,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.ak(this,h.p(f,["url","scheme","tileSize","promoteId"])),this._options=h.ak({type:"vector"},f),this._collectResourceTiming=!!f.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w),this._tileWorkers={},this._deduped=new h.aD}load(c){this._loaded=!1,this.fire(new h.a8("dataloading",{dataType:"source"}));const f=Array.isArray(this.map._language)?this.map._language.join():this.map._language,v=this.map._worldview;this._tileJSONRequest=Xl(this._options,this.map._requestManager,f,v,(w,E)=>{this._tileJSONRequest=null,this._loaded=!0,w?(f&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${f}`),v&&2!==v.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${v}`),this.fire(new h.a7(w))):E&&(h.ak(this,E),E.bounds&&(this.tileBounds=new pa(E.bounds,this.minzoom,this.maxzoom)),h.aH(E.tiles,this.map._requestManager._customAccessToken),this.fire(new h.a8("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.a8("data",{dataType:"source",sourceDataType:"content"}))),c&&c(w)})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest();const c=h.aE(this.id,this.scope);this.load(()=>this.map.style.clearSource(c))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return h.ak({},this._options)}loadTile(c,f){const v=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(v,h.a2.Tile),data:void 0,uid:c.uid,tileID:c.tileID,tileZoom:c.tileZoom,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:h.a4.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:c.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:c.isExtraShadowCaster};if(w.request.collectResourceTiming=this._collectResourceTiming,c.actor&&"expired"!==c.state)"loading"===c.state?c.reloadCallback=f:c.request=c.actor.send("reloadTile",w,E.bind(this));else if(c.actor=this._tileWorkers[v]=this._tileWorkers[v]||this.dispatcher.getActor(),this.dispatcher.ready)c.request=c.actor.send("loadTile",w,E.bind(this),void 0,!0);else{const S=h.aF.call({deduped:this._deduped},w,(I,O)=>{I||!O?E.call(this,I):(w.data={cacheControl:O.cacheControl,expires:O.expires,rawData:O.rawData.slice(0)},c.actor&&c.actor.send("loadTile",w,E.bind(this),void 0,!0))},!0);c.request={cancel:S}}function E(S,I){return delete c.request,c.aborted?f(null):S&&404!==S.status?f(S):(I&&I.resourceTiming&&(c.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&I&&c.setExpiryData(I),c.loadVectorData(I,this.map.painter),h.aG(this.dispatcher),f(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(c){c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id,scope:this.scope}),c.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class sn extends h.a6{constructor(c,f,v,w){super(),this.id=c,this.dispatcher=v,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.ak({type:"raster"},f),h.ak(this,h.p(f,["url","scheme","tileSize"]))}load(c){this._loaded=!1,this.fire(new h.a8("dataloading",{dataType:"source"})),this._tileJSONRequest=Xl(this._options,this.map._requestManager,null,null,(f,v)=>{this._tileJSONRequest=null,this._loaded=!0,f?this.fire(new h.a7(f)):v&&(h.ak(this,v),v.bounds&&(this.tileBounds=new pa(v.bounds,this.minzoom,this.maxzoom)),h.aH(v.tiles),this.fire(new h.a8("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.a8("data",{dataType:"source",sourceDataType:"content"}))),c&&c(f)})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest();const c=h.aE(this.id,this.scope);this.load(()=>this.map.style.clearSource(c))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return h.ak({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,f){const v=h.a4.devicePixelRatio>=2,w=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),v,this.tileSize);c.request=h.a3(this.map._requestManager.transformRequest(w,h.a2.Tile),(E,S,I,O)=>(delete c.request,c.aborted?(c.state="unloaded",f(null)):E?(c.state="errored",f(E)):S?(this.map._refreshExpiredTiles&&c.setExpiryData({cacheControl:I,expires:O}),c.setTexture(S,this.map.painter),c.state="loaded",h.aG(this.dispatcher),void f(null)):f(null)))}abortTile(c,f){c.request&&(c.request.cancel(),delete c.request),f()}unloadTile(c,f){c.texture&&c.texture instanceof h.a9?(c.destroy(!0),c.texture&&c.texture instanceof h.a9&&this.map.painter.saveTileTexture(c.texture)):c.destroy(),f()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}const Ys={vector:He,raster:sn,"raster-dem":class extends sn{constructor(_,c,f,v){super(_,c,f,v),this.type="raster-dem",this.maxzoom=22,this._options=h.ak({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}loadTile(_,c){const f=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function v(w,E){w&&(_.state="errored",c(w)),E&&(_.dem=E,_.dem.onDeserialize(),_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0,_.state="loaded",c(null))}_.request=h.a3(this.map._requestManager.transformRequest(f,h.a2.Tile),function(w,E,S,I){if(delete _.request,_.aborted)_.state="unloaded",c(null);else if(w)_.state="errored",c(w);else if(E){this.map._refreshExpiredTiles&&_.setExpiryData({cacheControl:S,expires:I});const O=ImageBitmap&&E instanceof ImageBitmap&&h.aI(),N=1-(E.width-h.aJ(E.width))/2;N<1||_.neighboringTiles||(_.neighboringTiles=this._getNeighboringTiles(_.tileID));const V=O?E:h.a4.getImageData(E,N),H={uid:_.uid,coord:_.tileID,source:this.id,scope:this.scope,rawImageData:V,encoding:this.encoding,padding:N};_.actor&&"expired"!==_.state||(_.actor=this.dispatcher.getActor(),_.actor.send("loadDEMTile",H,v.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(_){const c=_.canonical,f=Math.pow(2,c.z),v=(c.x-1+f)%f,w=0===c.x?_.wrap-1:_.wrap,E=(c.x+1+f)%f,S=c.x+1===f?_.wrap+1:_.wrap,I={};return I[new h.O(_.overscaledZ,w,c.z,v,c.y).key]={backfilled:!1},I[new h.O(_.overscaledZ,S,c.z,E,c.y).key]={backfilled:!1},c.y>0&&(I[new h.O(_.overscaledZ,w,c.z,v,c.y-1).key]={backfilled:!1},I[new h.O(_.overscaledZ,_.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},I[new h.O(_.overscaledZ,S,c.z,E,c.y-1).key]={backfilled:!1}),c.y+1<f&&(I[new h.O(_.overscaledZ,w,c.z,v,c.y+1).key]={backfilled:!1},I[new h.O(_.overscaledZ,_.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},I[new h.O(_.overscaledZ,S,c.z,E,c.y+1).key]={backfilled:!1}),I}},geojson:class extends h.a6{constructor(_,c,f,v){super(),this.id=_,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=f.getActor(),this.setEventedParent(v),this._data=c.data,this._options=h.ak({},c),this._collectResourceTiming=c.collectResourceTiming,void 0!==c.maxzoom&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;const w=h.J/this.tileSize;this.workerOptions=h.ak({source:this.id,scope:this.scope,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(void 0!==c.buffer?c.buffer:128)*w,tolerance:(void 0!==c.tolerance?c.tolerance:.375)*w,extent:h.J,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:void 0!==c.clusterMaxZoom?c.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:h.J,radius:(void 0!==c.clusterRadius?c.clusterRadius:50)*w,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}onAdd(_){this.map=_,this.setData(this._data)}setData(_){return this._data=_,this._updateWorkerData(),this}getClusterExpansionZoom(_,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:_,source:this.id,scope:this.scope},c),this}getClusterChildren(_,c){return this.actor.send("geojson.getClusterChildren",{clusterId:_,source:this.id,scope:this.scope},c),this}getClusterLeaves(_,c,f,v){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:_,limit:c,offset:f},v),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new h.a8("dataloading",{dataType:"source"})),this._loaded=!1;const _=h.ak({},this.workerOptions);_.scope=this.scope;const c=this._data;"string"==typeof c?(_.request=this.map._requestManager.transformRequest(h.a4.resolveURL(c),h.a2.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(c),this._pendingLoad=this.actor.send(`${this.type}.loadData`,_,(f,v)=>{if(this._loaded=!0,this._pendingLoad=null,f)this.fire(new h.a7(f));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&v&&v.resourceTiming&&v.resourceTiming[this.id]&&(w.resourceTiming=v.resourceTiming[this.id]),this.fire(new h.a8("data",w)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(_,c){const f=_.actor?"reloadTile":"loadTile";_.actor=this.actor;const v={type:this.type,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:h.a4.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};_.request=this.actor.send(f,v,(w,E)=>(delete _.request,_.destroy(),_.aborted?c(null):w?c(w):(_.loadVectorData(E,this.map.painter,"reloadTile"===f),c(null))),void 0,"loadTile"===f)}abortTile(_){_.request&&(_.request.cancel(),delete _.request),_.aborted=!0}unloadTile(_){this.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id,scope:this.scope}),_.destroy()}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return h.ak({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends h.aK{constructor(_,c,f,v){super(_,c,f,v),this.roundZoom=!0,this.type="video",this.options=c}load(){this._loaded=!1;const _=this.options;this.urls=[];for(const c of _.urls)this.urls.push(this.map._requestManager.transformRequest(c,h.a2.Source).url);h.aL(this.urls,(c,f)=>{this._loaded=!0,c?this.fire(new h.a7(c)):f&&(this.video=f,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(_){if(this.video){const c=this.video.seekable;_<c.start(0)||_>c.end(0)?this.fire(new h.a7(new h.aM(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=_}}getVideo(){return this.video}onAdd(_){this.map||(this.map=_,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const _=this.map.painter.context,c=_.gl;this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new h.a9(_,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(_)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:h.aK,model:class extends h.a6{constructor(_,c,f,v){super(),this.id=_,this.type="model",this.models=[],this._loaded=!1,this._options=c}load(){const _=[];for(const c in this._options.models){const f=this._options.models[c],v=h.aO(this.map._requestManager.transformRequest(f.uri,h.a2.Model).url).then(w=>{if(!w)return;const E=h.aP(w),S=new h.aQ(c,f.position,f.orientation,E);S.computeBoundsAndApplyParent(),this.models.push(S)}).catch(w=>{this.fire(new h.a7(new Error(`Could not load model ${c} from ${f.uri}: ${w.message}`)))});_.push(v)}return Promise.allSettled(_).then(()=>{this._loaded=!0,this.fire(new h.a8("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(c=>{this.fire(new h.a7(new Error(`Could not load models: ${c.message}`)))})}onAdd(_){this.map=_,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(_,c){}serialize(){return{type:"model"}}},"batched-model":class extends h.a6{constructor(_,c,f,v){super(),this.type="batched-model",this.id=_,this.tileSize=512,this._options=c,this.tiles=this._options.tiles,this.maxzoom=c.maxzoom||19,this.minzoom=c.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=f,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(v)}onAdd(_){this.map=_,this.load()}load(_){this._loaded=!1,this.fire(new h.a8("dataloading",{dataType:"source"}));const c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,f=this.map._worldview;this._tileJSONRequest=Xl(this._options,this.map._requestManager,c,f,(v,w)=>{this._tileJSONRequest=null,this._loaded=!0,v?(c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),f&&2!==f.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${f}`),this.fire(new h.a7(v))):w&&(h.ak(this,w),w.bounds&&(this.tileBounds=new pa(w.bounds,this.minzoom,this.maxzoom)),h.aH(w.tiles,this.map._requestManager._customAccessToken),this.fire(new h.a8("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.a8("data",{dataType:"source",sourceDataType:"content"}))),_&&_(v)})}hasTransition(){return!1}hasTile(_){return!this.tileBounds||this.tileBounds.contains(_.canonical)}loaded(){return this._loaded}loadTile(_,c){const f=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme)),v={request:this.map._requestManager.transformRequest(f,h.a2.Tile),data:void 0,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,tileSize:this.tileSize*_.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:_.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(_.actor&&"expired"!==_.state)if("loading"===_.state)_.reloadCallback=c;else{if(_.buckets){const E=Object.values(_.buckets);for(const S of E)S.dirty=!0;return void(_.state="loaded")}_.request=_.actor.send("reloadTile",v,w.bind(this))}else _.actor=this.dispatcher.getActor(),_.request=_.actor.send("loadTile",v,w.bind(this),void 0,!0);function w(E,S){return _.aborted?c(null):E&&404!==E.status?c(E):(S&&(S.resourceTiming&&(_.resourceTiming=S.resourceTiming),this.map._refreshExpiredTiles&&_.setExpiryData(S),_.buckets={..._.buckets,...S.buckets}),_.state="loaded",void c(null))}}serialize(){return h.ak({},this._options)}},canvas:class extends h.aK{constructor(_,c,f,v){super(_,c,f,v),c.coordinates?Array.isArray(c.coordinates)&&4===c.coordinates.length&&!c.coordinates.some(w=>!Array.isArray(w)||2!==w.length||w.some(E=>"number"!=typeof E))||this.fire(new h.a7(new h.aM(`sources.${_}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.a7(new h.aM(`sources.${_}`,null,'missing required property "coordinates"'))),c.animate&&"boolean"!=typeof c.animate&&this.fire(new h.a7(new h.aM(`sources.${_}`,null,'optional "animate" property must be a boolean value'))),c.canvas?"string"==typeof c.canvas||c.canvas instanceof HTMLCanvasElement||this.fire(new h.a7(new h.aM(`sources.${_}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.a7(new h.aM(`sources.${_}`,null,'missing required property "canvas"'))),this.options=c,this.animate=void 0===c.animate||c.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.a7(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(_){this.map=_,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let _=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,_=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,_=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const c=this.map.painter.context;this.texture?!_&&!this._playing||this.texture instanceof h.aN||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new h.a9(c,this.canvas,c.gl.RGBA,{premultiply:!0}),this._prepareData(c)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const _ of[this.canvas.width,this.canvas.height])if(isNaN(_)||_<=0)return!0;return!1}},custom:class extends h.a6{constructor(_,c,f,v){super(),this.id=_,this.type="custom",this._dataType="raster",this._dispatcher=f,this._implementation=c,this.setEventedParent(v),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new h.a7(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new h.a7(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new pa(this._implementation.bounds,this.minzoom,this.maxzoom)),c.update=this._update.bind(this),c.clearTiles=this._clearTiles.bind(this),c.coveringTiles=this._coveringTiles.bind(this),h.ak(this,h.p(c,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return h.p(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new h.a8("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.a8("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(_){this._map=_,this._loaded=!1,this.fire(new h.a8("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(_),this.load()}onRemove(_){this._implementation.onRemove&&this._implementation.onRemove(_)}hasTile(_){if(this._implementation.hasTile){const{x:c,y:f,z:v}=_.canonical;return this._implementation.hasTile({x:c,y:f,z:v})}return!this.tileBounds||this.tileBounds.contains(_.canonical)}loadTile(_,c){const{x:f,y:v,z:w}=_.tileID.canonical,E=new AbortController;_.request=Promise.resolve(this._implementation.loadTile({x:f,y:v,z:w},{signal:E.signal})).then(function(S){return delete _.request,_.aborted?(_.state="unloaded",c(null)):void 0===S?(_.state="errored",c(null)):null===S?(this.loadTileData(_,{width:this.tileSize,height:this.tileSize,data:null}),_.state="loaded",c(null)):(I=S)instanceof ImageData||I instanceof HTMLCanvasElement||I instanceof ImageBitmap||I instanceof HTMLImageElement?(this.loadTileData(_,S),_.state="loaded",void c(null)):(_.state="errored",c(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var I}.bind(this)).catch(S=>{20!==S.code&&(_.state="errored",c(S))}),_.request.cancel=()=>E.abort()}loadTileData(_,c){_.setTexture(c,this._map.painter)}unloadTile(_,c){if(_.texture&&_.texture instanceof h.a9?(_.destroy(!0),_.texture&&_.texture instanceof h.a9&&this._map.painter.saveTileTexture(_.texture)):_.destroy(),this._implementation.unloadTile){const{x:f,y:v,z:w}=_.tileID.canonical;this._implementation.unloadTile({x:f,y:v,z:w})}c()}abortTile(_,c){_.request&&_.request.cancel&&(_.request.cancel(),delete _.request),c()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(_=>({x:_.canonical.x,y:_.canonical.y,z:_.canonical.z}))}_clearTiles(){const _=h.aE(this.id,this.scope);this._map.style.clearSource(_)}_update(){this.fire(new h.a8("data",{dataType:"source",sourceDataType:"content"}))}}},Xs=function(_,c,f,v){const w=new Ys[c.type](_,c,f,v);if(w.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${w.id}`);return h.aR(["load","abort","unload","serialize","prepare"],w),w};function Zr(_,c){const f=h.m.identity([]);return h.m.scale(f,f,[.5*_.width,.5*-_.height,1]),h.m.translate(f,f,[1,-1,0]),h.m.multiply(f,f,_.calculateProjMatrix(c.toUnwrapped())),Float32Array.from(f)}function wr(_,c,f,v,w,E,S,I=!1){const O=_.tilesIn(v,S,I);O.sort(ui);const N=[];for(const H of O)N.push({wrappedTileID:H.tile.tileID.wrapped().key,queryResults:H.tile.queryRenderedFeatures(c,f,_._state,H,w,E,Zr(_.transform,H.tile.tileID),I)});const V=function(H){const G={},Y={};for(const ee of H){const K=ee.queryResults,ne=ee.wrappedTileID,J=Y[ne]=Y[ne]||{};for(const oe in K){const _e=K[oe],ye=J[oe]=J[oe]||{},re=G[oe]=G[oe]||[];for(const ae of _e)ye[ae.featureIndex]||(ye[ae.featureIndex]=!0,re.push(ae))}}return G}(N);for(const H in V)V[H].forEach(G=>{const Y=G.feature,ee=Y.layer;ee&&"background"!==ee.type&&"sky"!==ee.type&&"slot"!==ee.type&&(Y.source=ee.source,ee["source-layer"]&&(Y.sourceLayer=ee["source-layer"]),Y.state=void 0!==Y.id?_.getFeatureState(ee["source-layer"],Y.id):{})});return V}function vh(_,c){const f=_.getRenderableIds().map(E=>_.getTileByID(E)),v=[],w={};for(let E=0;E<f.length;E++){const S=f[E],I=S.tileID.canonical.key;w[I]||(w[I]=!0,S.querySourceFeatures(v,c))}return v}function ui(_,c){const f=_.tileID,v=c.tileID;return f.overscaledZ-v.overscaledZ||f.canonical.y-v.canonical.y||f.wrap-v.wrap||f.canonical.x-v.canonical.x}class Gn{constructor(c){this.style=c}processLayersChanged(){this.layers=[];for(const c in this.style._mergedLayers){const f=this.style._mergedLayers[c];if("fill-extrusion"===f.type)this.layers.push(f);else if("model"===f.type){const v=this.style.getLayerSource(f);v&&"batched-model"===v.type&&this.layers.push(f)}}}updateZOffset(c,f){this.currentBuildingBuckets=[];for(let w=0;w<this.layers.length;++w){const E=this.layers[w],S=this.style.getLayerSourceCache(E);let I=1;"fill-extrusion"===E.type&&(I=E.paint.get("fill-extrusion-opacity")>0?E.paint.get("fill-extrusion-vertical-scale"):0);let O=S?S.getTile(f):null;if(!O&&S&&f.canonical.z>S.getSource().minzoom){let N=f.scaledTo(Math.min(S.getSource().maxzoom,f.overscaledZ-1));for(;N.overscaledZ>=S.getSource().minzoom&&(O=S.getTile(N),!O&&0!==N.overscaledZ);)N=N.scaledTo(N.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:O?O.getBucket(E):null,tileID:O?O.tileID:f,verticalScale:I})}c.hasAnyZOffset=!1;let v=!1;for(let w=0;w<c.symbolInstances.length;w++){const E=c.symbolInstances.get(w),S=E.zOffset,I=this._getHeightAtTileOffset(f,E.tileAnchorX,E.tileAnchorY);E.zOffset=-1!==I?I:S,v||S===E.zOffset||(v=!0),c.hasAnyZOffset||0===E.zOffset||(c.hasAnyZOffset=!0)}v&&(c.zOffsetBuffersNeedUpload=!0,c.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(c,f,v,w){let E=f,S=v;if(c.canonical.z!==w.canonical.z){const I=w.canonical,O=1/(1<<c.canonical.z-I.z);E=(f+c.canonical.x*h.J)*O-I.x*h.J|0,S=(v+c.canonical.y*h.J)*O-I.y*h.J|0}return{tileX:E,tileY:S}}_getHeightAtTileOffset(c,f,v){let w,E;for(let S=0;S<this.layers.length;++S){if("fill-extrusion"!==this.layers[S].type)continue;const{bucket:I,tileID:O,verticalScale:N}=this.currentBuildingBuckets[S];if(!I)continue;const{tileX:V,tileY:H}=this._mapCoordToOverlappingTile(c,f,v,O),G=I.getHeightAtTileCoord(V,H);G&&void 0!==G.height&&(G.hidden?w=G.height:E=Math.max(G.height*N,E||0))}if(void 0!==E)return E;for(let S=0;S<this.layers.length;++S){if("model"!==this.layers[S].type)continue;const{bucket:I,tileID:O}=this.currentBuildingBuckets[S];if(!I)continue;const{tileX:N,tileY:V}=this._mapCoordToOverlappingTile(c,f,v,O),H=I.getHeightAtTileCoord(N,V);if(H&&!H.hidden)return void 0===H.height&&void 0!==w?Math.min(H.maxHeight,w)*H.verticalScale:(H.height||0)*H.verticalScale}return-1}}function bh(_,c){const f={};for(const v in _)"ref"!==v&&(f[v]=_[v]);return h.aS.forEach(v=>{v in c&&(f[v]=c[v])}),f}function Ha(_){_=_.slice();const c=Object.create(null);for(let f=0;f<_.length;f++)c[_[f].id]=_[f];for(let f=0;f<_.length;f++)"ref"in _[f]&&(_[f]=bh(_[f],c[_[f].ref]));return _}const pt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",setImportUrl:"setImportUrl",setImportData:"setImportData",setImportConfig:"setImportConfig"};function hi(_,c,f){f.push({command:pt.addSource,args:[_,c[_]]})}function Di(_,c,f){c.push({command:pt.removeSource,args:[_]}),f[_]=!0}function Ii(_,c,f,v){Di(_,f,v),hi(_,c,f)}function xs(_,c,f){let v;for(v in _[f])if(_[f].hasOwnProperty(v)&&"data"!==v&&!me(_[f][v],c[f][v]))return!1;for(v in c[f])if(c[f].hasOwnProperty(v)&&"data"!==v&&!me(_[f][v],c[f][v]))return!1;return!0}function jn(_,c,f,v,w,E){let S;for(S in c=c||{},_=_||{})_.hasOwnProperty(S)&&(me(_[S],c[S])||f.push({command:E,args:[v,S,c[S],w]}));for(S in c)c.hasOwnProperty(S)&&!_.hasOwnProperty(S)&&(me(_[S],c[S])||f.push({command:E,args:[v,S,c[S],w]}))}function ks(_){return _.id}function _r(_,c){return _[c.id]=c,_}class Ki{constructor(c,f){this.reset(c,f)}reset(c,f){this.points=c||[],this._distances=[0];for(let v=1;v<this.points.length;v++)this._distances[v]=this._distances[v-1]+this.points[v].dist(this.points[v-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(1===this.points.length)return this.points[0];c=h.c(c,0,1);let f=1,v=this._distances[f];const w=c*this.paddedLength+this.padding;for(;v<w&&f<this._distances.length;)v=this._distances[++f];const E=f-1,S=this._distances[E],I=v-S,O=I>0?(w-S)/I:0;return this.points[E].mult(1-O).add(this.points[f].mult(O))}}class $n{constructor(c,f,v){const w=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(c/v),this.yCellCount=Math.ceil(f/v);for(let S=0;S<this.xCellCount*this.yCellCount;S++)w.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=f,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,f,v,w,E){this._forEachCell(f,v,w,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(f),this.bboxes.push(v),this.bboxes.push(w),this.bboxes.push(E)}insertCircle(c,f,v,w){this._forEachCell(f-w,v-w,f+w,v+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(f),this.circles.push(v),this.circles.push(w)}_insertBoxCell(c,f,v,w,E,S){this.boxCells[E].push(S)}_insertCircleCell(c,f,v,w,E,S){this.circleCells[E].push(S)}_query(c,f,v,w,E,S){if(v<0||c>this.width||w<0||f>this.height)return!E&&[];const I=[];if(c<=0&&f<=0&&this.width<=v&&this.height<=w){if(E)return!0;for(let O=0;O<this.boxKeys.length;O++)I.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const N=this.circles[3*O],V=this.circles[3*O+1],H=this.circles[3*O+2];I.push({key:this.circleKeys[O],x1:N-H,y1:V-H,x2:N+H,y2:V+H})}return S?I.filter(S):I}return this._forEachCell(c,f,v,w,this._queryCell,I,{hitTest:E,seenUids:{box:{},circle:{}}},S),E?I.length>0:I}_queryCircle(c,f,v,w,E){const S=c-v,I=c+v,O=f-v,N=f+v;if(I<0||S>this.width||N<0||O>this.height)return!w&&[];const V=[];return this._forEachCell(S,O,I,N,this._queryCellCircle,V,{hitTest:w,circle:{x:c,y:f,radius:v},seenUids:{box:{},circle:{}}},E),w?V.length>0:V}query(c,f,v,w,E){return this._query(c,f,v,w,!1,E)}hitTest(c,f,v,w,E){return this._query(c,f,v,w,!0,E)}hitTestCircle(c,f,v,w){return this._queryCircle(c,f,v,!0,w)}_queryCell(c,f,v,w,E,S,I,O){const N=I.seenUids,V=this.boxCells[E];if(null!==V){const G=this.bboxes;for(const Y of V)if(!N.box[Y]){N.box[Y]=!0;const ee=4*Y;if(c<=G[ee+2]&&f<=G[ee+3]&&v>=G[ee+0]&&w>=G[ee+1]&&(!O||O(this.boxKeys[Y]))){if(I.hitTest)return S.push(!0),!0;S.push({key:this.boxKeys[Y],x1:G[ee],y1:G[ee+1],x2:G[ee+2],y2:G[ee+3]})}}}const H=this.circleCells[E];if(null!==H){const G=this.circles;for(const Y of H)if(!N.circle[Y]){N.circle[Y]=!0;const ee=3*Y;if(this._circleAndRectCollide(G[ee],G[ee+1],G[ee+2],c,f,v,w)&&(!O||O(this.circleKeys[Y]))){if(I.hitTest)return S.push(!0),!0;{const K=G[ee],ne=G[ee+1],J=G[ee+2];S.push({key:this.circleKeys[Y],x1:K-J,y1:ne-J,x2:K+J,y2:ne+J})}}}}}_queryCellCircle(c,f,v,w,E,S,I,O){const N=I.circle,V=I.seenUids,H=this.boxCells[E];if(null!==H){const Y=this.bboxes;for(const ee of H)if(!V.box[ee]){V.box[ee]=!0;const K=4*ee;if(this._circleAndRectCollide(N.x,N.y,N.radius,Y[K+0],Y[K+1],Y[K+2],Y[K+3])&&(!O||O(this.boxKeys[ee])))return S.push(!0),!0}}const G=this.circleCells[E];if(null!==G){const Y=this.circles;for(const ee of G)if(!V.circle[ee]){V.circle[ee]=!0;const K=3*ee;if(this._circlesCollide(Y[K],Y[K+1],Y[K+2],N.x,N.y,N.radius)&&(!O||O(this.circleKeys[ee])))return S.push(!0),!0}}}_forEachCell(c,f,v,w,E,S,I,O){const N=this._convertToXCellCoord(c),V=this._convertToYCellCoord(f),H=this._convertToXCellCoord(v),G=this._convertToYCellCoord(w);for(let Y=N;Y<=H;Y++)for(let ee=V;ee<=G;ee++)if(E.call(this,c,f,v,w,this.xCellCount*ee+Y,S,I,O))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,f,v,w,E,S){const I=w-c,O=E-f,N=v+S;return N*N>I*I+O*O}_circleAndRectCollide(c,f,v,w,E,S,I){const O=(S-w)/2,N=Math.abs(c-(w+O));if(N>O+v)return!1;const V=(I-E)/2,H=Math.abs(f-(E+V));if(H>V+v)return!1;if(N<=O||H<=V)return!0;const G=N-O,Y=H-V;return G*G+Y*Y<=v*v}}const Qi=100;class dd{constructor(c,f,v=new $n(c.width+200,c.height+200,25),w=new $n(c.width+200,c.height+200,25)){this.transform=c,this.grid=v,this.ignoredGrid=w,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+Qi,this.screenBottomBoundary=c.height+Qi,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.fogState=f}placeCollisionBox(c,f,v,w,E,S,I,O){let N=v.projectedAnchorX,V=v.projectedAnchorY,H=v.projectedAnchorZ;const G=v.elevation,Y=v.tileID,ee=c.getProjection();if(G&&Y){const[ae,be,Se]=ee.upVector(Y.canonical,v.tileAnchorX,v.tileAnchorY),Ce=ee.upVectorScale(Y.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;N+=ae*G*Ce,V+=be*G*Ce,H+=Se*G*Ce}const K=this.projectAndGetPerspectiveRatio(I,N,V,H,v.tileID,"globe"===ee.name||!!G||this.transform.pitch>0,ee),ne=S*K.perspectiveRatio,J=(v.x1*f+w.x-v.padding)*ne+K.point.x,oe=(v.y1*f+w.y-v.padding)*ne+K.point.y,_e=(v.x2*f+w.x+v.padding)*ne+K.point.x,ye=(v.y2*f+w.y+v.padding)*ne+K.point.y,re=K.perspectiveRatio<=.55||K.occluded;return!this.isInsideGrid(J,oe,_e,ye)||!E&&this.grid.hitTest(J,oe,_e,ye,O)||re?{box:[],offscreen:!1,occluded:K.occluded}:{box:[J,oe,_e,ye],offscreen:this.isOffscreen(J,oe,_e,ye),occluded:!1}}placeCollisionCircles(c,f,v,w,E,S,I,O,N,V,H,G,Y,ee,K){const ne=[],J=this.transform.elevation,oe=c.getProjection(),_e=J?J.getAtTileOffsetFunc(K,this.transform.center.lat,this.transform.worldSize,oe):null,ye=new h.P(v.tileAnchorX,v.tileAnchorY);let{x:re,y:ae,z:be}=oe.projectTilePoint(ye.x,ye.y,K.canonical);if(_e){const[Ue,fe,Ne]=_e(ye);re+=Ue,ae+=fe,be+=Ne}const Se="globe"===oe.name,Ce=this.projectAndGetPerspectiveRatio(I,re,ae,be,K,Se||!!J||this.transform.pitch>0,oe),{perspectiveRatio:ke}=Ce,lt=(H?S/ke:S*ke)/h.aV,$e=co(re,ae,be,O),Qe=Ce.signedDistanceFromCamera>0?Nt(lt,E,v.lineOffsetX*lt,v.lineOffsetY*lt,!1,$e,ye,v,w,O,{},J&&!H?_e:null,H&&!!J,oe,K,H):null;let Fe=!1,ot=!1,Ke=!0;if(Qe&&!Ce.occluded){const Ue=.5*Y*ke+ee,fe=new h.P(-100,-100),Ne=new h.P(this.screenRightBoundary,this.screenBottomBoundary),At=new Ki,{first:vt,last:an}=Qe,Xt=vt.path.length;let mn=[];for(let Pn=Xt-1;Pn>=1;Pn--)mn.push(vt.path[Pn]);for(let Pn=1;Pn<an.path.length;Pn++)mn.push(an.path[Pn]);const nn=2.5*Ue;N&&(mn=mn.map(([Pn,gn,_n],mt)=>(_e&&!Se&&(_n=_e(mt<Xt-1?vt.tilePath[Xt-1-mt]:an.tilePath[mt-Xt+2])[2]),co(Pn,gn,_n,N))),mn.some(Pn=>Pn[3]<=0)&&(mn=[]));let Rn=[];if(mn.length>0){let Pn=1/0,gn=-1/0,_n=1/0,mt=-1/0;for(const un of mn)Pn=Math.min(Pn,un[0]),_n=Math.min(_n,un[1]),gn=Math.max(gn,un[0]),mt=Math.max(mt,un[1]);gn>=fe.x&&Pn<=Ne.x&&mt>=fe.y&&_n<=Ne.y&&(Rn=[mn.map(un=>new h.P(un[0],un[1]))],(Pn<fe.x||gn>Ne.x||_n<fe.y||mt>Ne.y)&&(Rn=h.aT(Rn,fe.x,fe.y,Ne.x,Ne.y)))}for(const Pn of Rn){At.reset(Pn,.25*Ue);let gn=0;gn=At.length<=.5*Ue?1:Math.ceil(At.paddedLength/nn)+1;for(let _n=0;_n<gn;_n++){const mt=_n/Math.max(gn-1,1),un=At.lerp(mt),Mn=un.x+Qi,Cn=un.y+Qi;ne.push(Mn,Cn,Ue,0);const hr=Mn-Ue,na=Cn-Ue,zi=Mn+Ue,ci=Cn+Ue;if(Ke=Ke&&this.isOffscreen(hr,na,zi,ci),ot=ot||this.isInsideGrid(hr,na,zi,ci),!f&&this.grid.hitTestCircle(Mn,Cn,Ue,G)&&(Fe=!0,!V))return{circles:[],offscreen:!1,collisionDetected:Fe,occluded:!1}}}}return{circles:!V&&Fe||!ot?[]:ne,offscreen:Ke,collisionDetected:Fe,occluded:Ce.occluded}}queryRenderedSymbols(c){if(0===c.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const f=[];let v=1/0,w=1/0,E=-1/0,S=-1/0;for(const V of c){const H=new h.P(V.x+Qi,V.y+Qi);v=Math.min(v,H.x),w=Math.min(w,H.y),E=Math.max(E,H.x),S=Math.max(S,H.y),f.push(H)}const I=this.grid.query(v,w,E,S).concat(this.ignoredGrid.query(v,w,E,S)),O={},N={};for(const V of I){const H=V.key;if(void 0===O[H.bucketInstanceId]&&(O[H.bucketInstanceId]={}),O[H.bucketInstanceId][H.featureIndex])continue;const G=[new h.P(V.x1,V.y1),new h.P(V.x2,V.y1),new h.P(V.x2,V.y2),new h.P(V.x1,V.y2)];h.aU(f,G)&&(O[H.bucketInstanceId][H.featureIndex]=!0,void 0===N[H.bucketInstanceId]&&(N[H.bucketInstanceId]=[]),N[H.bucketInstanceId].push(H.featureIndex))}return N}insertCollisionBox(c,f,v,w,E){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:w,collisionGroupID:E},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,f,v,w,E){const S=f?this.ignoredGrid:this.grid,I={bucketInstanceId:v,featureIndex:w,collisionGroupID:E};for(let O=0;O<c.length;O+=4)S.insertCircle(I,c[O],c[O+1],c[O+2])}projectAndGetPerspectiveRatio(c,f,v,w,E,S,I){const O=[f,v,w,1];let N=!1;w||this.transform.pitch>0?(h.e.transformMat4(O,O,c),this.fogState&&E&&"globe"!==I.name&&(N=function(G,Y,ee,K,ne,J){const oe=J.calculateFogTileMatrix(ne),_e=[Y,ee,K];return h.v.transformMat4(_e,_e,oe),fa(G,h.v.length(_e),J.pitch,J._fov)}(this.fogState,f,v,w,E.toUnwrapped(),this.transform)>.9)):Un(O,O,c);const V=O[3];return{point:new h.P((O[0]/V+1)/2*this.transform.width+Qi,(-O[1]/V+1)/2*this.transform.height+Qi),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(I)/V*.5,1.5),signedDistanceFromCamera:V,occluded:S&&O[2]>V||N}}isOffscreen(c,f,v,w){return v<Qi||c>=this.screenRightBoundary||w<Qi||f>this.screenBottomBoundary}isInsideGrid(c,f,v,w){return v>=0&&c<this.gridRightBoundary&&w>=0&&f<this.gridBottomBoundary}getViewportMatrix(){const c=h.m.identity([]);return h.m.translate(c,c,[-100,-100,0]),c}}function Fc(_,c,f){const v=c.createTileMatrix(_,_.worldSize,f.toUnwrapped());return h.m.multiply(new Float32Array(16),_.projMatrix,v)}function hd(_,c,f){if(c.projection.name===f.projection.name)return _.projMatrix;const v=f.clone();return v.setProjection(c.projection),Fc(v,c.getProjection(),_)}function yt(_,c,f){return c.name===f.projection.name?_.projMatrix:Fc(f,c,_)}class vl{constructor(c,f,v,w){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?f:-f))):w&&v?1:0,this.placed=v}isHidden(){return 0===this.opacity&&!this.placed}}class li{constructor(c,f,v,w,E,S=!1){this.text=new vl(c?c.text:null,f,v,E),this.icon=new vl(c?c.icon:null,f,w,E),this.clipped=S}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class qi{constructor(c,f,v,w=!1){this.text=c,this.icon=f,this.skipFade=v,this.clipped=w}}class xh{constructor(){this.invProjMatrix=h.m.create(),this.viewportMatrix=h.m.create(),this.circles=[]}}class wh{constructor(c,f,v,w,E){this.bucketInstanceId=c,this.featureIndex=f,this.sourceLayerIndex=v,this.bucketIndex=w,this.tileID=E}}class Ch{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const f=++this.maxGroupID;this.collisionGroups[c]={ID:f,predicate:v=>v.collisionGroupID===f}}return this.collisionGroups[c]}}function Oo(_,c,f,v,w){const{horizontalAlign:E,verticalAlign:S}=h.aY(_),I=-(E-.5)*c,O=-(S-.5)*f,N=h.aW(_,v);return new h.P(I+N[0]*w,O+N[1]*w)}function Pi(_,c,f,v,w){const E=new h.P(_,c);return f&&E._rotate(v?w:-w),E}class jf{constructor(c,f,v,w,E,S){this.transform=c.clone(),this.projection=c.projection.name,this.collisionIndex=new dd(this.transform,E),this.buildingIndex=S,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Ch(v),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,f,v,w){const E=v.getBucket(f),S=v.latestFeatureIndex;if(!E||!S||f.fqid!==E.layerIds[0])return;const I=E.layers[0].layout,O=v.collisionBoxArray,N=Math.pow(2,this.transform.zoom-v.tileID.overscaledZ),V=v.tileSize/h.J,H=v.tileID.toUnwrapped();this.transform.setProjection(E.projection);const G=(Y=v.tileID,ee=E.getProjection(),K=this.transform,ee.name===this.projection?K.calculateProjMatrix(Y.toUnwrapped()):Fc(K,ee,Y));var Y,ee,K;const ne="map"===I.get("text-pitch-alignment"),J="map"===I.get("text-rotation-alignment");f.compileFilter();const oe=f.dynamicFilter(),_e=f.dynamicFilterNeedsFeature(),ye=this.transform.calculatePixelsToTileUnitsMatrix(v),re=Zs(G,v.tileID.canonical,ne,J,this.transform,E.getProjection(),ye);let ae=null;if(ne){const Ce=ha(G,v.tileID.canonical,ne,J,this.transform,E.getProjection(),ye);ae=h.m.multiply([],this.transform.labelPlaneMatrix,Ce)}let be=null;oe&&v.latestFeatureIndex&&(be={unwrappedTileID:H,dynamicFilter:oe,dynamicFilterNeedsFeature:_e,featureIndex:v.latestFeatureIndex}),this.retainedQueryData[E.bucketInstanceId]=new wh(E.bucketInstanceId,S,E.sourceLayerIndex,E.index,v.tileID);const Se={bucket:E,layout:I,posMatrix:G,textLabelPlaneMatrix:re,labelToScreenMatrix:ae,clippingData:be,scale:N,textPixelRatio:V,holdingForFade:v.holdingForFade(),collisionBoxArray:O,partiallyEvaluatedTextSize:h.i(E.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:h.i(E.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(w)for(const Ce of E.sortKeyRanges){const{sortKey:ke,symbolInstanceStart:lt,symbolInstanceEnd:$e}=Ce;c.push({sortKey:ke,symbolInstanceStart:lt,symbolInstanceEnd:$e,parameters:Se})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:Se})}attemptAnchorPlacement(c,f,v,w,E,S,I,O,N,V,H,G,Y,ee,K,ne,J,oe){const{textOffset0:_e,textOffset1:ye,crossTileID:re}=G,ae=[_e,ye],be=Oo(c,v,w,ae,E),Se=this.collisionIndex.placeCollisionBox(ee,E,f,Pi(be.x,be.y,S,I,this.transform.angle),H,O,N,V.predicate);if(ne){const Ce=ee.getSymbolInstanceIconSize(oe,this.transform.zoom,G.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(ee,Ce,ne,Pi(be.x,be.y,S,I,this.transform.angle),H,O,N,V.predicate).box.length)return}if(Se.box.length>0){let Ce;return this.prevPlacement&&this.prevPlacement.variableOffsets[re]&&this.prevPlacement.placements[re]&&this.prevPlacement.placements[re].text&&(Ce=this.prevPlacement.variableOffsets[re].anchor),this.variableOffsets[re]={textOffset:ae,width:v,height:w,anchor:c,textScale:E,prevAnchor:Ce},this.markUsedJustification(ee,c,G,K),ee.allowVerticalPlacement&&(this.markUsedOrientation(ee,K,G),this.placedOrientations[re]=K),{shift:be,placedGlyphBoxes:Se}}}placeLayerBucketPart(c,f,v,w){const{bucket:E,layout:S,posMatrix:I,textLabelPlaneMatrix:O,labelToScreenMatrix:N,clippingData:V,textPixelRatio:H,holdingForFade:G,collisionBoxArray:Y,partiallyEvaluatedTextSize:ee,partiallyEvaluatedIconSize:K,collisionGroup:ne}=c.parameters,J=S.get("text-optional"),oe=S.get("icon-optional"),_e=S.get("text-allow-overlap"),ye=S.get("icon-allow-overlap"),re="map"===S.get("text-rotation-alignment"),ae="map"===S.get("text-pitch-alignment"),be="viewport-y"===S.get("symbol-z-order"),Se=S.get("symbol-z-elevate");this.transform.setProjection(E.projection);let Ce=_e&&(ye||!E.hasIconData()||oe),ke=ye&&(_e||!E.hasTextData()||J);!E.collisionArrays&&Y&&E.deserializeCollisionBoxes(Y),v&&w&&E.updateCollisionDebugBuffers(this.transform.zoom,Y);const lt=($e,Qe,Fe)=>{const{crossTileID:ot,numVerticalGlyphVertices:Ke}=$e;if(V){const zi={zoom:this.transform.zoom,pitch:this.transform.pitch};let ci=null;if(V.dynamicFilterNeedsFeature){const Ni=this.retainedQueryData[E.bucketInstanceId];ci=V.featureIndex.loadFeature({featureIndex:$e.featureIndex,bucketIndex:Ni.bucketIndex,sourceLayerIndex:Ni.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,V.dynamicFilter)(zi,ci,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new h.P($e.tileAnchorX,$e.tileAnchorY),this.transform.calculateDistanceTileData(V.unwrappedTileID)))return this.placements[ot]=new qi(!1,!1,!1,!0),void f.add(ot)}if(f.has(ot))return;if(G)return void(this.placements[ot]=new qi(!1,!1,!1));let Ue=!1,fe=!1,Ne=!0,At=!1,vt=!1,an=null,Xt={box:null,offscreen:null,occluded:null},mn={box:null,offscreen:null,occluded:null},nn=null,Rn=null,Pn=null,gn=0,_n=0,mt=0;Fe.textFeatureIndex?gn=Fe.textFeatureIndex:$e.useRuntimeCollisionCircles&&(gn=$e.featureIndex),Fe.verticalTextFeatureIndex&&(_n=Fe.verticalTextFeatureIndex);const un=zi=>{zi.tileID=this.retainedQueryData[E.bucketInstanceId].tileID;const ci=this.transform.elevation;zi.elevation=$e.zOffset+(ci?ci.getAtTileOffset(zi.tileID,zi.tileAnchorX,zi.tileAnchorY):0)},Mn=Fe.textBox;if(Mn){un(Mn);const zi=Ni=>{let fr=h.W.horizontal;if(E.allowVerticalPlacement&&!Ni&&this.prevPlacement){const No=this.prevPlacement.placedOrientations[ot];No&&(this.placedOrientations[ot]=No,fr=No,this.markUsedOrientation(E,fr,$e))}return fr},ci=(Ni,fr)=>{if(E.allowVerticalPlacement&&Ke>0&&Fe.verticalTextBox){for(const No of E.writingModes)if(No===h.W.vertical?(Xt=fr(),mn=Xt):Xt=Ni(),Xt&&Xt.box&&Xt.box.length)break}else Xt=Ni()};if(S.get("text-variable-anchor")){let Ni=S.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ot]){const yr=this.prevPlacement.variableOffsets[ot];Ni.indexOf(yr.anchor)>0&&(Ni=Ni.filter(Wo=>Wo!==yr.anchor),Ni.unshift(yr.anchor))}const fr=(yr,Wo,Er)=>{const Yr=E.getSymbolInstanceTextSize(ee,$e,this.transform.zoom,Qe),ia=(yr.x2-yr.x1)*Yr+2*yr.padding,Os=(yr.y2-yr.y1)*Yr+2*yr.padding,Bo=$e.hasIconTextFit&&!ye?Wo:null;Bo&&un(Bo);let rr={box:[],offscreen:!1,occluded:!1};const Ca=_e?2*Ni.length:Ni.length;for(let kl=0;kl<Ca;++kl){const uc=this.attemptAnchorPlacement(Ni[kl%Ni.length],yr,ia,Os,Yr,re,ae,H,I,ne,kl>=Ni.length,$e,Qe,E,Er,Bo,ee,K);if(uc&&(rr=uc.placedGlyphBoxes,rr&&rr.box&&rr.box.length)){Ue=!0,an=uc.shift;break}}return rr};ci(()=>fr(Mn,Fe.iconBox,h.W.horizontal),()=>{const yr=Fe.verticalTextBox;return yr&&un(yr),E.allowVerticalPlacement&&!(Xt&&Xt.box&&Xt.box.length)&&Ke>0&&yr?fr(yr,Fe.verticalIconBox,h.W.vertical):{box:null,offscreen:null,occluded:null}}),Xt&&(Ue=Xt.box,Ne=Xt.offscreen,At=Xt.occluded);const No=zi(!(!Xt||!Xt.box));if(!Ue&&this.prevPlacement){const yr=this.prevPlacement.variableOffsets[ot];yr&&(this.variableOffsets[ot]=yr,this.markUsedJustification(E,yr.anchor,$e,No))}}else{const Ni=(fr,No)=>{const yr=E.getSymbolInstanceTextSize(ee,$e,this.transform.zoom,Qe),Wo=this.collisionIndex.placeCollisionBox(E,yr,fr,new h.P(0,0),_e,H,I,ne.predicate);return Wo&&Wo.box&&Wo.box.length&&(this.markUsedOrientation(E,No,$e),this.placedOrientations[ot]=No),Wo};ci(()=>Ni(Mn,h.W.horizontal),()=>{const fr=Fe.verticalTextBox;return E.allowVerticalPlacement&&Ke>0&&fr?(un(fr),Ni(fr,h.W.vertical)):{box:null,offscreen:null,occluded:null}}),zi(!!(Xt&&Xt.box&&Xt.box.length))}}if(nn=Xt,Ue=nn&&nn.box&&nn.box.length>0,Ne=nn&&nn.offscreen,At=nn&&nn.occluded,$e.useRuntimeCollisionCircles){const zi=E.text.placedSymbolArray.get($e.centerJustifiedTextSymbolIndex>=0?$e.centerJustifiedTextSymbolIndex:$e.verticalPlacedTextSymbolIndex),ci=h.j(E.textSizeData,ee,zi),Ni=S.get("text-padding");Rn=this.collisionIndex.placeCollisionCircles(E,_e,zi,E.lineVertexArray,E.glyphOffsetArray,ci,I,O,N,v,ae,ne.predicate,$e.collisionCircleDiameter*ci/h.aV,Ni,this.retainedQueryData[E.bucketInstanceId].tileID),Ue=_e||Rn.circles.length>0&&!Rn.collisionDetected,Ne=Ne&&Rn.offscreen,At=Rn.occluded}if(Fe.iconFeatureIndex&&(mt=Fe.iconFeatureIndex),Fe.iconBox){const zi=ci=>{un(ci);const Ni=$e.hasIconTextFit&&an?Pi(an.x,an.y,re,ae,this.transform.angle):new h.P(0,0),fr=E.getSymbolInstanceIconSize(K,this.transform.zoom,$e.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(E,fr,ci,Ni,ye,H,I,ne.predicate)};mn&&mn.box&&mn.box.length&&Fe.verticalIconBox?(Pn=zi(Fe.verticalIconBox),fe=Pn.box.length>0):(Pn=zi(Fe.iconBox),fe=Pn.box.length>0),Ne=Ne&&Pn.offscreen,vt=Pn.occluded}const Cn=J||0===$e.numHorizontalGlyphVertices&&0===Ke,hr=oe||0===$e.numIconVertices;if(Cn||hr?hr?Cn||(fe=fe&&Ue):Ue=fe&&Ue:fe=Ue=fe&&Ue,Ue&&nn&&nn.box&&this.collisionIndex.insertCollisionBox(nn.box,S.get("text-ignore-placement"),E.bucketInstanceId,mn&&mn.box&&_n?_n:gn,ne.ID),fe&&Pn&&this.collisionIndex.insertCollisionBox(Pn.box,S.get("icon-ignore-placement"),E.bucketInstanceId,mt,ne.ID),Rn&&(Ue&&this.collisionIndex.insertCollisionCircles(Rn.circles,S.get("text-ignore-placement"),E.bucketInstanceId,gn,ne.ID),v)){const zi=E.bucketInstanceId;let ci=this.collisionCircleArrays[zi];void 0===ci&&(ci=this.collisionCircleArrays[zi]=new xh);for(let Ni=0;Ni<Rn.circles.length;Ni+=4)ci.circles.push(Rn.circles[Ni+0]),ci.circles.push(Rn.circles[Ni+1]),ci.circles.push(Rn.circles[Ni+2]),ci.circles.push(Rn.collisionDetected?1:0)}const na="globe"!==E.projection.name;Ce=Ce&&(na||!At),ke=ke&&(na||!vt),this.placements[ot]=new qi(Ue||Ce,fe||ke,Ne||E.justReloaded),f.add(ot)};if(Se&&this.buildingIndex&&(this.buildingIndex.updateZOffset(E,this.retainedQueryData[E.bucketInstanceId].tileID),E.updateZOffset()),be){const $e=E.getSortedSymbolIndexes(this.transform.angle);for(let Qe=$e.length-1;Qe>=0;--Qe){const Fe=$e[Qe];lt(E.symbolInstances.get(Fe),Fe,E.collisionArrays[Fe])}E.hasAnyZOffset&&h.X(`${E.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(E.hasAnyZOffset){const $e=E.getSortedIndexesByZOffset();for(let Qe=0;Qe<$e.length;++Qe){const Fe=$e[Qe];lt(E.symbolInstances.get(Fe),Fe,E.collisionArrays[Fe])}}else for(let $e=c.symbolInstanceStart;$e<c.symbolInstanceEnd;$e++)lt(E.symbolInstances.get($e),$e,E.collisionArrays[$e]);if(v&&E.bucketInstanceId in this.collisionCircleArrays){const $e=this.collisionCircleArrays[E.bucketInstanceId];h.m.invert($e.invProjMatrix,I),$e.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(c,f,v,w){const{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:S,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:O,crossTileID:N}=v,V=h.aX(f),H=w===h.W.vertical?O:"left"===V?E:"center"===V?S:"right"===V?I:-1;E>=0&&(c.text.placedSymbolArray.get(E).crossTileID=H>=0&&E!==H?0:N),S>=0&&(c.text.placedSymbolArray.get(S).crossTileID=H>=0&&S!==H?0:N),I>=0&&(c.text.placedSymbolArray.get(I).crossTileID=H>=0&&I!==H?0:N),O>=0&&(c.text.placedSymbolArray.get(O).crossTileID=H>=0&&O!==H?0:N)}markUsedOrientation(c,f,v){const w=f===h.W.horizontal||f===h.W.horizontalOnly?f:0,E=f===h.W.vertical?f:0,{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:N}=v,V=c.text.placedSymbolArray;S>=0&&(V.get(S).placedOrientation=w),I>=0&&(V.get(I).placedOrientation=w),O>=0&&(V.get(O).placedOrientation=w),N>=0&&(V.get(N).placedOrientation=E)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const f=this.prevPlacement;let v=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;const w=f?f.symbolFadeChange(c):1,E=f?f.opacities:{},S=f?f.variableOffsets:{},I=f?f.placedOrientations:{};for(const O in this.placements){const N=this.placements[O],V=E[O];V?(this.opacities[O]=new li(V,w,N.text,N.icon,null,N.clipped),v=v||N.text!==V.text.placed||N.icon!==V.icon.placed):(this.opacities[O]=new li(null,w,N.text,N.icon,N.skipFade,N.clipped),v=v||N.text||N.icon)}for(const O in E){const N=E[O];if(!this.opacities[O]){const V=new li(N,w,!1,!1);V.isHidden()||(this.opacities[O]=V,v=v||N.text.placed||N.icon.placed)}}for(const O in S)this.variableOffsets[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.variableOffsets[O]=S[O]);for(const O in I)this.placedOrientations[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.placedOrientations[O]=I[O]);v?this.lastPlacementChangeTime=c:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:c)}updateLayerOpacities(c,f){const v=new Set;for(const w of f){const E=w.getBucket(c);E&&w.latestFeatureIndex&&c.fqid===E.layerIds[0]&&(this.updateBucketOpacities(E,v,w.collisionBoxArray),E.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(E,w.tileID),E.updateZOffset()))}}updateBucketOpacities(c,f,v){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const w=c.layers[0].layout,E=!!c.layers[0].dynamicFilter(),S=new li(null,0,!1,!1,!0),I=w.get("text-allow-overlap"),O=w.get("icon-allow-overlap"),N=w.get("text-variable-anchor"),V="map"===w.get("text-rotation-alignment"),H="map"===w.get("text-pitch-alignment"),G=new li(null,0,I&&(O||!c.hasIconData()||w.get("icon-optional")),O&&(I||!c.hasTextData()||w.get("text-optional")),!0);!c.collisionArrays&&v&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(v);const Y=(K,ne,J)=>{for(let oe=0;oe<ne/4;oe++)K.opacityVertexArray.emplaceBack(J)};let ee=0;for(let K=0;K<c.symbolInstances.length;K++){const ne=c.symbolInstances.get(K),{numHorizontalGlyphVertices:J,numVerticalGlyphVertices:oe,crossTileID:_e,numIconVertices:ye}=ne,re=f.has(_e);let ae=this.opacities[_e];re?ae=S:ae||(ae=G,this.opacities[_e]=ae),f.add(_e);const be=J>0||oe>0,Se=ye>0,Ce=this.placedOrientations[_e],ke=Ce===h.W.vertical,lt=Ce===h.W.horizontal||Ce===h.W.horizontalOnly;if(!be&&!Se||ae.isHidden()||ee++,be){const $e=bu(ae.text);Y(c.text,J,ke?Or:$e),Y(c.text,oe,lt?Or:$e);const Qe=ae.text.isHidden(),{leftJustifiedTextSymbolIndex:Fe,centerJustifiedTextSymbolIndex:ot,rightJustifiedTextSymbolIndex:Ke,verticalPlacedTextSymbolIndex:Ue}=ne,fe=c.text.placedSymbolArray,Ne=Qe||ke?1:0;Fe>=0&&(fe.get(Fe).hidden=Ne),ot>=0&&(fe.get(ot).hidden=Ne),Ke>=0&&(fe.get(Ke).hidden=Ne),Ue>=0&&(fe.get(Ue).hidden=Qe||lt?1:0);const At=this.variableOffsets[_e];At&&this.markUsedJustification(c,At.anchor,ne,Ce);const vt=this.placedOrientations[_e];vt&&(this.markUsedJustification(c,"left",ne,vt),this.markUsedOrientation(c,vt,ne))}if(Se){const $e=bu(ae.icon),{placedIconSymbolIndex:Qe,verticalPlacedIconSymbolIndex:Fe}=ne,ot=c.icon.placedSymbolArray,Ke=ae.icon.isHidden()?1:0;Qe>=0&&(Y(c.icon,ye,ke?Or:$e),ot.get(Qe).hidden=Ke),Fe>=0&&(Y(c.icon,ne.numVerticalIconVertices,lt?Or:$e),ot.get(Fe).hidden=Ke)}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const $e=c.collisionArrays[K];if($e){let Qe=new h.P(0,0),Fe=!0;if($e.textBox||$e.verticalTextBox){if(N){const Ke=this.variableOffsets[_e];Ke?(Qe=Oo(Ke.anchor,Ke.width,Ke.height,Ke.textOffset,Ke.textScale),V&&Qe._rotate(H?this.transform.angle:-this.transform.angle)):Fe=!1}E&&(Fe=!ae.clipped),$e.textBox&&Kl(c.textCollisionBox.collisionVertexArray,ae.text.placed,!Fe||ke,Qe.x,Qe.y),$e.verticalTextBox&&Kl(c.textCollisionBox.collisionVertexArray,ae.text.placed,!Fe||lt,Qe.x,Qe.y)}const ot=Fe&&!(lt||!$e.verticalIconBox);$e.iconBox&&Kl(c.iconCollisionBox.collisionVertexArray,ae.icon.placed,ot,ne.hasIconTextFit?Qe.x:0,ne.hasIconTextFit?Qe.y:0),$e.verticalIconBox&&Kl(c.iconCollisionBox.collisionVertexArray,ae.icon.placed,!ot,ne.hasIconTextFit?Qe.x:0,ne.hasIconTextFit?Qe.y:0)}}}if(c.fullyClipped=0===ee,c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.bucketInstanceId in this.collisionCircleArrays){const K=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=K.invProjMatrix,c.placementViewportMatrix=K.viewportMatrix,c.collisionCircleArray=K.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return 0===this.fadeDuration?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,f){const v=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*v>c}setStale(){this.stale=!0}}function Kl(_,c,f,v,w){_.emplaceBack(c?1:0,f?1:0,v||0,w||0),_.emplaceBack(c?1:0,f?1:0,v||0,w||0),_.emplaceBack(c?1:0,f?1:0,v||0,w||0),_.emplaceBack(c?1:0,f?1:0,v||0,w||0)}const ns=Math.pow(2,25),Io=Math.pow(2,24),Uf=Math.pow(2,17),vu=Math.pow(2,16),yo=Math.pow(2,9),$a=Math.pow(2,8),fd=Math.pow(2,1);function bu(_){if(0===_.opacity&&!_.placed)return 0;if(1===_.opacity&&_.placed)return 4294967295;const c=_.placed?1:0,f=Math.floor(127*_.opacity);return f*ns+c*Io+f*Uf+c*vu+f*yo+c*$a+f*fd+c}const Or=0;class Eh{constructor(c){this._sortAcrossTiles="viewport-y"!==c.layout.get("symbol-z-order")&&void 0!==c.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(c,f,v,w,E){const S=this._bucketParts;for(;this._currentTileIndex<c.length;)if(f.getBucketParts(S,w,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((I,O)=>I.sortKey-O.sortKey));this._currentPartIndex<S.length;){const I=S[this._currentPartIndex];if(f.placeLayerBucketPart(I,this._seenCrossTileIDs,v,0===I.symbolInstanceStart),this._currentPartIndex++,E())return!0}return!1}}class us{constructor(c,f,v,w,E,S,I,O,N){this.placement=new jf(c,E,S,I,O,N),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(c,f,v,w){const E=h.a4.now(),S=()=>{const I=h.a4.now()-E;return!this._forceFullPlacement&&I>2};for(;this._currentPlacementIndex>=0;){const I=f[c[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if("symbol"===I.type&&(!I.minzoom||I.minzoom<=O)&&(!I.maxzoom||I.maxzoom>O)){const N=I,V=N.layout.get("symbol-z-elevate"),H=this._inProgressLayer=this._inProgressLayer||new Eh(N),G=h.aE(I.source,I.scope);if(H.continuePlacement(V?w[G]:v[G],this.placement,this._showCollisionBoxes,I,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const Zn=512/h.J/2;class pd{constructor(c,f,v){this.tileID=c,this.bucketInstanceId=v,this.index=new h.aZ(f.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const w=c.canonical.x*h.J,E=c.canonical.y*h.J;for(let S=0;S<f.length;S++){const{key:I,crossTileID:O,tileAnchorX:N,tileAnchorY:V}=f.get(S),H=Math.floor((w+N)*Zn),G=Math.floor((E+V)*Zn);this.index.add(H,G),this.keys.push(I),this.crossTileIDs.push(O)}this.index.finish()}findMatches(c,f,v){const w=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z),E=Zn/Math.pow(2,f.canonical.z-this.tileID.canonical.z),S=f.canonical.x*h.J,I=f.canonical.y*h.J;for(let O=0;O<c.length;O++){const N=c.get(O);if(N.crossTileID)continue;const{key:V,tileAnchorX:H,tileAnchorY:G}=N,Y=Math.floor((S+H)*E),ee=Math.floor((I+G)*E),K=this.index.range(Y-w,ee-w,Y+w,ee+w);for(const ne of K){const J=this.crossTileIDs[ne];if(this.keys[ne]===V&&!v.has(J)){v.add(J),N.crossTileID=J;break}}}}}class md{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ji{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const f=Math.round((c-this.lng)/360);if(0!==f)for(const v in this.indexes){const w=this.indexes[v],E={};for(const S in w){const I=w[S];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+f),E[I.tileID.key]=I}this.indexes[v]=E}this.lng=c}addBucket(c,f,v){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let E=0;E<f.symbolInstances.length;E++)f.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]=new Set);const w=this.usedCrossTileIDs[c.overscaledZ];for(const E in this.indexes){const S=this.indexes[E];if(Number(E)>c.overscaledZ)for(const I in S){const O=S[I];O.tileID.isChildOf(c)&&O.findMatches(f.symbolInstances,c,w)}else{const I=S[c.scaledTo(Number(E)).key];I&&I.findMatches(f.symbolInstances,c,w)}}for(let E=0;E<f.symbolInstances.length;E++){const S=f.symbolInstances.get(E);S.crossTileID||(S.crossTileID=v.generate(),w.add(S.crossTileID))}return void 0===this.indexes[c.overscaledZ]&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new pd(c,f.symbolInstances,f.bucketInstanceId),!0}removeBucketCrossTileIDs(c,f){for(const v of f.crossTileIDs)this.usedCrossTileIDs[c].delete(v)}removeStaleBuckets(c){let f=!1;for(const v in this.indexes){const w=this.indexes[v];for(const E in w)c[w[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(v,w[E]),delete w[E],f=!0)}return f}}class Ut{constructor(){this.layerIndexes={},this.crossTileIDs=new md,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,f,v,w){let E=this.layerIndexes[c.fqid];void 0===E&&(E=this.layerIndexes[c.fqid]=new ji);let S=!1;const I={};"globe"!==w.name&&E.handleWrapJump(v);for(const O of f){const N=O.getBucket(c);N&&c.fqid===N.layerIds[0]&&(N.bucketInstanceId||(N.bucketInstanceId=++this.maxBucketInstanceId),E.addBucket(O.tileID,N,this.crossTileIDs)&&(S=!0),I[N.bucketInstanceId]=!0)}return E.removeStaleBuckets(I)&&(S=!0),S}pruneUnusedLayers(c){const f={};c.forEach(v=>{f[v]=!0});for(const v in this.layerIndexes)f[v]||delete this.layerIndexes[v]}}var bl="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef RENDER_CUTOFF\nfloat cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}\n#endif",Oi="\nout vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#ifdef INDICATOR_CUTOUT\nuniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;\n#endif\nvec4 applyCutout(vec4 color) {\n#ifdef INDICATOR_CUTOUT\nfloat holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);\n#else\nreturn color;\n#endif\n}\n#ifdef DEBUG_WIREFRAME\n#define HANDLE_WIREFRAME_DEBUG \\\nglFragColor=vec4(0.7,0.0,0.0,0.7); \\\ngl_FragDepth=gl_FragCoord.z-0.0001;\n#else\n#define HANDLE_WIREFRAME_DEBUG\n#endif\n#ifdef RENDER_CUTOFF\nuniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;\n#endif\nvec4 textureLodCustom(sampler2D image,vec2 pos,vec2 lod_coord) {vec2 size=vec2(textureSize(image,0));vec2 dx=dFdx(lod_coord.xy*size);vec2 dy=dFdy(lod_coord.xy*size);float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}",Lc="\n#define EXTENT 8192.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}\n#ifdef RENDER_CUTOFF\nuniform vec4 u_cutoff_params;out float v_cutoff_opacity;\n#endif\nconst vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}",gd="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Ga="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture(u_depth,uv-df.xz)),unpack_depth(texture(u_depth,uv+df.xz)),unpack_depth(texture(u_depth,uv-df.zy)),unpack_depth(texture(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",Hf="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",ds="highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {\n#ifdef FOG_DITHERING\nvec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);\n#else\nreturn color;\n#endif\n}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif",xl="#ifdef RASTER_ARRAY\nuniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);vec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return (texCoord.xxyy+vec2(1.5,0.5).xyxy)/texResolution.xxyy;}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;vec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texture(u_image0,c.yz),texture(u_image0,c.xz),texture(u_image0,c.yw),texture(u_image0,c.xw)\n);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;vec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texture(u_image1,c.yz),texture(u_image1,c.xz),texture(u_image1,c.yw),texture(u_image1,c.xw)\n);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texture(u_image0,texCoord);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texture(u_image1,texCoord);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}\n#endif",xu="#ifdef RENDER_SHADOWS\nuniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}\n#endif//RENDER_SHADOWS",Dh="#ifdef RENDER_SHADOWS\n#ifdef DEPTH_TEXTURE\nuniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;\n#else\nuniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;\n#endif\nuniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_1,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_0,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;\n#ifdef NATIVE\nhighp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));\n#else\nhighp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(\nshadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)\n);\n#endif\nvec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {\n#ifdef SHADOWS_SINGLE_CASCADE\nlight_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);\n#else\nlight_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));\n#endif\n}highp float calculate_shadow_bias(float NDotL) {\n#ifdef NORMAL_OFFSET\nreturn 0.5*u_shadow_bias.x;\n#else\nreturn 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));\n#endif\n}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}\n#endif";const _d=[];is(bl,_d),is(Lc,_d),is(Oi,_d);const ri={"_prelude_fog.vertex.glsl":Hf,"_prelude_terrain.vertex.glsl":Ga,"_prelude_shadow.vertex.glsl":xu,"_prelude_fog.fragment.glsl":ds,"_prelude_shadow.fragment.glsl":Dh,"_prelude_lighting.glsl":"\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}\n#endif//LIGHTING_3D_MODE","_prelude_raster_array.glsl":xl},ma={};In("",Ga),In(ds,Hf),In(Dh,xu),In(xl,"");const Th=In(Oi,Lc),ho=bl;var yd={background:In('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nin vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_lighting.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),backgroundPattern:In('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),circle:In('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\nglFragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}'),clippingMask:In("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:In('#include "_prelude_fog.fragment.glsl"\nuniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),heatmapTexture:In("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(0.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}","in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:In("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",'#include "_prelude_terrain.vertex.glsl"\nin vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}'),collisionCircle:In("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}","in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:In("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",'#include "_prelude_terrain.vertex.glsl"\nin vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;\n#endif\nout vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}'),fill:In('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutline:In('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin highp vec2 v_pos;uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutlinePattern:In('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;out highp vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillPattern:In('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillExtrusion:In('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec4 v_color;in vec4 v_flat;\n#ifdef RENDER_SHADOWS\nin highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;\n#endif\nuniform lowp float u_opacity;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec2 v_ao;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nin vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nin highp vec3 v_normal;\n#endif\nuniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nin float v_flood_radius;in float v_has_floodlight;\n#endif\nuniform float u_emissive_strength;in float v_height;void main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nvec3 normal=normalize(v_normal);\n#endif\nfloat z;vec4 color=v_color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);\n#ifdef LIGHTING_3D_MODE\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#else\ncolor=mix(v_color,v_roof_color,z);\n#endif\n#endif\nfloat h=max(0.0,v_height);float ao_shade=1.0;\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\ncolor.rgb*=mix(ao_shade,1.0,v_has_floodlight);\n#else\ncolor.rgb*=ao_shade;\n#endif\n#else\ncolor.rgb*=ao_shade;\n#endif\n#endif\n#ifdef LIGHTING_3D_MODE\nfloat flood_radiance=0.0;\n#ifdef FLOOD_LIGHT\nflood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef FLOOD_LIGHT\nfloat ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);\n#else\nfloat shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);\n#endif\n#else\ncolor.rgb=apply_lighting(color.rgb,normal);\n#ifdef FLOOD_LIGHT\ncolor.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);\n#endif\n#endif\ncolor.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));\n#endif\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nuniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nout vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nout highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec2 v_ao;\n#endif\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nout float v_flood_radius;out float v_has_floodlight;\n#endif\nout float v_height;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define highp float flood_light_wall_radius\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize highp float flood_light_wall_radius\nbase*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nv_normal=normal;\n#endif\nbase=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat cutoff=1.0;vec3 scaled_pos=pos;\n#ifdef RENDER_CUTOFF\nvec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=max(0.01,cutoff_opacity(u_cutoff_params,ground.z));if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);\n#endif\nfloat hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff < 0.01 && centroid_pos.x !=0.0));gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=pos;vec3 shd_pos1=pos;\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifndef LIGHTING_3D_MODE\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#endif\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\nfloat is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;\n#endif\nv_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);\n#else\nv_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),fillExtrusionDepth:In("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\nout highp float v_depth;void main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\nbase*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nvec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);\n#else\npos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}'),fillExtrusionPattern:In('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nin vec3 v_normal;\n#endif\nin vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nout vec2 v_pos;out vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nout vec3 v_normal;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_normal=normal;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}'),groundShadow:In('#include "_prelude_shadow.fragment.glsl"\nprecision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\nvoid main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);\n#ifdef RENDER_CUTOFF\nshadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,v_depth));\n#endif\n#ifdef FOG\nshadow=mix(shadow,vec3(1.0),v_fog_opacity);\n#endif\n#ifdef INDICATOR_CUTOUT\nshadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);\n#endif\nglFragColor=vec4(shadow,1.0);}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);v_depth=gl_Position.w;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);\n#endif\n}'),fillExtrusionGroundEffect:In("uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;\n#ifdef SDF_SUBPASS\nin highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}\n#ifdef FOG\nin highp float v_fog;\n#endif\n#endif\nvoid main() {\n#ifdef CLEAR_SUBPASS\nvec4 color=vec4(1.0);\n#ifdef CLEAR_FROM_TEXTURE\ncolor=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));\n#endif\nglFragColor=color;\n#else\n#ifdef SDF_SUBPASS\nhighp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;\n#ifdef FOG\nfog=v_fog;\n#endif\n#ifdef RENDER_CUTOFF\nfog*=v_cutoff_opacity;\n#endif\nglFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));\n#else\nvec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);\n#ifdef OVERDRAW_INSPECTOR\ncolor=vec4(1.0);\n#endif\nglFragColor=color;HANDLE_WIREFRAME_DEBUG;\n#endif\n#endif\n}",'#include "_prelude_fog.vertex.glsl"\nin highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;\n#ifdef SDF_SUBPASS\nout highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;\n#ifdef FOG\nout highp float v_fog;\n#endif\n#endif\nuniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;\n#pragma mapbox: define highp float flood_light_ground_radius\nconst float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {\n#pragma mapbox: initialize highp float flood_light_ground_radius\nvec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;\n#ifdef SDF_SUBPASS\nv_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);\n#ifdef FOG\nv_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);\n#endif\n#endif\nfloat hidden_by_landmark=0.0;\n#ifdef HAS_CENTROID\nhidden_by_landmark=a_hidden_by_landmark;\n#endif\nfloat isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n}'),hillshadePrepare:In("precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}","uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:In('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\nglFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);\n#endif\n#ifdef FOG\nglFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),line:In('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;in vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nfloat luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\nif (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    \nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nout_color*=(alpha*opacity);\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#define EXTRUDE_SCALE 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nin highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nin float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),linePattern:In('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float pattern_x=v_linesofar/pattern_size.x*aspect;float x=mod(pattern_x,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting_ground(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=(alpha*opacity);\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;in float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),raster:In('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_raster_array.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;\n#ifndef RASTER_ARRAY\nuniform sampler2D u_image0;uniform sampler2D u_image1;\n#endif\n#ifdef RASTER_COLOR\nuniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;\n#endif\nvoid main() {vec4 color0,color1,color;vec2 value;\n#ifdef RASTER_COLOR\n#ifdef RASTER_ARRAY\n#ifdef RASTER_ARRAY_LINEAR\nvalue=mix(\nraTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#else\nvalue=mix(\nraTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#endif\nif (value.y > 0.0) value.x/=value.y;\n#else\ncolor=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);\n#endif\ncolor=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;\n#else\ncolor0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);\n#endif\ncolor.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef RENDER_CUTOFF\nglFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8;\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;in vec2 a_texture_pos;\n#endif\nout vec2 v_pos0;out vec2 v_pos1;out float v_depth;void main() {vec2 uv;\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);\n#endif\n#else\nfloat w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\ngl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;\n#ifdef RENDER_CUTOFF\nv_depth=gl_Position.z;\n#endif\n}'),symbolIcon:In('#include "_prelude_lighting.glsl"\nuniform sampler2D u_texture;\n#ifdef ICON_TRANSITION\nuniform float u_icon_transition;\n#endif\nin float v_fade_opacity;in vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nin vec2 v_tex_b;\n#endif\nuniform mediump float u_icon_saturation;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float emissive_strength\nlowp float alpha=opacity*v_fade_opacity;vec4 out_color;\n#ifdef ICON_TRANSITION\nvec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;\n#else\nout_color=texture(u_texture,v_tex_a)*alpha;\n#endif\n#ifdef SATURATION\nvec3 luma=vec3(dot(out_color.rgb,vec3(0.2126,0.7152,0.0722)));out_color.rgb=mix(luma,out_color.rgb,u_icon_saturation);\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\n#ifdef ICON_TRANSITION\nin vec2 a_texb;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nout vec2 v_tex_b;\n#endif\nout float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float emissive_strength\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nv_tex_a=a_tex/u_texsize;\n#ifdef ICON_TRANSITION\nv_tex_b=a_texb/u_texsize;\n#endif\nv_fade_opacity=out_fade_opacity;}'),symbolSDF:In('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\nuniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout float v_draw_halo;out vec2 v_data0;out vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}'),symbolTextAndIcon:In('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout float v_draw_halo;out vec4 v_data0;out vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nfloat out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}'),terrainRaster:In('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;in vec2 v_pos0;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth;\n#endif\nuniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;\n#ifdef LIGHTING_3D_MODE\nconst vec3 normal=vec3(0.0,0.0,1.0);\n#ifdef RENDER_SHADOWS\nfloat cutoffOpacity=1.0;\n#ifdef RENDER_CUTOFF\ncutoffOpacity=cutoff_opacity(u_cutoff_params,v_depth);\n#endif\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nvec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,v_depth,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;\n#else\nfloat lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));\n#endif\n#else\nfloat lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;\n#endif\n#endif\n#else\ncolor=image_color;\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;\n#endif\nvoid main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}'),terrainDepth:In("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}'),skybox:In('#include "_prelude_fog.fragment.glsl"\nin lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',gd),skyboxGradient:In('#include "_prelude_fog.fragment.glsl"\nin highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',gd),skyboxCapture:In("\nin highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}","in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:In('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;in vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nraster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);\n#else\nraster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;\n#else\ncolor=apply_lighting_ground(color);\n#endif\n#endif\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;\n#endif\nout vec2 v_pos0;void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);globe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}'),globeAtmosphere:In('#include "_prelude_fog.fragment.glsl"\nuniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {\n#ifdef ALPHA_PASS\nglFragColor=vec4(0,0,0,0);return;\n#else\n#ifdef NATIVE\nglFragColor=vec4(1,1,1,1);\n#else\nglFragColor=vec4(0,0,0,1);\n#endif\nreturn;\n#endif\n}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;\n#ifdef ALPHA_PASS\nfloat a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);\n#else\nvec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;\n#ifndef NATIVE\nc=dither(c,gl_FragCoord.xy+u_temporal_offset);\n#endif\nglFragColor=vec4(c*t,t);\n#endif\n}',"in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}"),model:In('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth_shadows;\n#endif\n#ifdef OCCLUSION_TEXTURE_TRANSFORM\nuniform vec4 u_occlusionTextureTransform;\n#endif\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#ifdef HAS_ATTRIBUTE_a_pbr\nin lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;\n#endif\n#ifdef HAS_TEXTURE_u_baseColorTexture\nuniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;\n#endif\n#ifdef HAS_TEXTURE_u_metallicRoughnessTexture\nuniform sampler2D u_metallicRoughnessTexture;\n#endif\n#ifdef HAS_TEXTURE_u_occlusionTexture\nuniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;\n#endif\n#ifdef HAS_TEXTURE_u_normalTexture\nuniform sampler2D u_normalTexture;\n#endif\n#ifdef HAS_TEXTURE_u_emissionTexture\nuniform sampler2D u_emissionTexture;\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nin highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture(u_depthTexture,coord));return v_depth > depth+0.0005;}\n#endif\n#define saturate(_x) clamp(_x,0.,1.)\nvec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)\n{\n#ifdef LIGHTING_3D_MODE\nvec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));\n#endif\nreturn apply_lighting(albedo,transformed_normal,lighting_factor);\n#else\nvec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;\n#endif\n}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;\n#ifdef HAS_ATTRIBUTE_a_color_3f\nalbedo*=vec4(color_3f,1.0);\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#else\n#ifdef HAS_ATTRIBUTE_a_color_4f\nalbedo*=color_4f;\n#endif\n#endif\n#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)\nvec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}\n#ifdef UNPREMULT_TEXTURE_IN_SHADER\nif(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;\n#endif\nif(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}\n#endif\nreturn vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {\n#ifdef HAS_TEXTURE_u_normalTexture\nhighp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;\n#else\nreturn mat3(1.0);\n#endif\n}highp vec3 getNormal(){highp vec3 n;\n#ifdef HAS_ATTRIBUTE_a_normal_3f\nn=normalize(normal_3f);\n#else\nhighp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;\n#endif\n#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nvec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);\n#endif\nreturn n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;\n#ifdef HAS_ATTRIBUTE_a_pbr\nmat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;\n#endif\n#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) \nvec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;\n#endif\nconst float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)\n{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)\n{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)\n{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)\n{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)\n{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)\n{\n#ifdef LIGHTING_3D_MODE\nreturn mat.diffuseColor;\n#else\nreturn mat.diffuseColor/PI;\n#endif\n}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)\n{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)\n{vec3 env_light=vec3(0.65,0.65,0.65);\n#ifdef LIGHTING_3D_MODE\nfloat ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;\n#endif\nvec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)\n{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=NdotL;\n#endif\nvec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;\n#if !defined(LIGHTING_3D_MODE)\nconst vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);\n#endif\ncolor*=intensityFactor;return color;}void main() {\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nif (isOccluded()) {discard;}\n#endif\nvec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;\n#ifdef LIGHTING_3D_MODE\nlightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;\n#endif\nvec4 finalColor;\n#ifdef DIFFUSE_SHADED\nvec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);\n#ifdef HAS_TEXTURE_u_occlusionTexture\nfloat ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;\n#endif\nfinalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;\n#else\nMaterial mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;\n#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\n#ifdef OCCLUSION_TEXTURE_TRANSFORM\nvec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;\n#else\nvec2 uv=uv_2f;\n#endif\nao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;\n#endif\nvec4 emissive=u_emissiveFactor;\n#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nemissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);\n#endif\ncolor+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;\n#ifdef HAS_ATTRIBUTE_a_pbr\nfloat resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));\n#ifdef HAS_ATTRIBUTE_a_color_4f\nfloat distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);\n#endif\n#endif\nvec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);\n#endif\n#ifdef FOG\nfinalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));\n#endif\n#ifdef RENDER_CUTOFF\nfinalColor*=v_cutoff_opacity;\n#endif\n#ifdef INDICATOR_CUTOUT\nfinalColor=applyCutout(finalColor);\n#endif\nglFragColor=finalColor;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nin vec3 a_pos_3f;\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr\n#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength\nuniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_normal_matrix;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth_shadows;\n#endif\nout vec4 v_position_height;out lowp vec4 v_color_mix;\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nout highp float v_depth;\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\nout lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;\n#endif\nvec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute-custom highp vec4 pbr\n#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength\nhighp mat4 normal_matrix;\n#ifdef INSTANCED_ARRAYS\nnormal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\nnormal_matrix=u_normal_matrix;\n#endif\nvec3 local_pos;mat3 rs;\n#ifdef MODEL_POSITION_ON_GPU\nvec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;\n#else\nlocal_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);\n#endif\nv_position_height.w=a_pos_3f.z;\n#ifdef HAS_ATTRIBUTE_a_pbr\nvec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(local_pos);\n#endif\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nfloat x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);\n#else\nnormal_3f=vec3(normal_matrix*vec4(normal_3f,0));\n#endif\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#ifdef HAS_ATTRIBUTE_a_color_4f\nv_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 shadow_pos=local_pos;\n#ifdef NORMAL_OFFSET\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nvec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();\n#else\nvec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();\n#endif\n#endif\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;\n#endif\n}'),modelDepth:In("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}","in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;\n#ifdef MODEL_POSITION_ON_GPU\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_instance;\n#endif\nuniform highp mat4 u_node_matrix;\n#endif\nvoid main() {\n#ifdef MODEL_POSITION_ON_GPU\nhighp mat4 instance;\n#ifdef INSTANCED_ARRAYS\ninstance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\ninstance=u_instance;\n#endif\nvec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;\n#else\ngl_Position=u_matrix*vec4(a_pos_3f,1);\n#endif\nv_depth=gl_Position.z/gl_Position.w;}"),stars:In("in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)\n{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}","\nin vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}")};function is(_,c){const f=_.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let v of f)if(v=v.trim(),"#"===v[0]&&v.includes("if")&&!v.includes("endif")){v=v.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const w=v.split(" ");for(const E of w)c.includes(E)||c.push(E)}}function In(_,c){const f=/#include\s+"([^"]+)"/g,v=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let w=c.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);w&&(w=w.map(N=>{const V=N.split(" ");return V[V.length-1]}),w=[...new Set(w)]);const E={},S=[],I=[];if(_=_.replace(f,(N,V)=>(I.push(V),"")),(c=c.replace(f,(N,V)=>(S.push(V),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let O=[..._d];is(_,O),is(c,O);for(const N of[...S,...I])ri[N]||console.error(`Undefined include: ${N}`),ma[N]||(ma[N]=[],is(ri[N],ma[N])),O=[...O,...ma[N]];return{fragmentSource:_=_.replace(v,(N,V,H,G,Y)=>(E[Y]=!0,"define"===V?`\n#ifndef HAS_UNIFORM_u_${Y}\nin ${H} ${G} ${Y};\n#else\nuniform ${H} ${G} u_${Y};\n#endif\n`:"initialize"===V?`\n#ifdef HAS_UNIFORM_u_${Y}\n    ${H} ${G} ${Y} = u_${Y};\n#endif\n`:"define-attribute"===V?`\n#ifdef HAS_ATTRIBUTE_a_${Y}\n    in ${H} ${G} ${Y};\n#endif\n`:"initialize-attribute"===V?"":void 0)),vertexSource:c=c.replace(v,(N,V,H,G,Y)=>{const ee="float"===G?"vec2":G,K=Y.match(/color/)?"color":ee;return"define-attribute-vertex-shader-only"===V?`\n#ifdef HAS_ATTRIBUTE_a_${Y}\nin ${H} ${G} a_${Y};\n#endif\n`:E[Y]?"define"===V?`\n#ifndef HAS_UNIFORM_u_${Y}\nuniform lowp float u_${Y}_t;\nin ${H} ${ee} a_${Y};\nout ${H} ${G} ${Y};\n#else\nuniform ${H} ${G} u_${Y};\n#endif\n`:"initialize"===V?"vec4"===K?`\n#ifndef HAS_UNIFORM_u_${Y}\n    ${Y} = a_${Y};\n#else\n    ${H} ${G} ${Y} = u_${Y};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${Y}\n    ${Y} = unpack_mix_${K}(a_${Y}, u_${Y}_t);\n#else\n    ${H} ${G} ${Y} = u_${Y};\n#endif\n`:"define-attribute"===V?`\n#ifdef HAS_ATTRIBUTE_a_${Y}\n    in ${H} ${G} a_${Y};\n    out ${H} ${G} ${Y};\n#endif\n`:"initialize-attribute"===V?`\n#ifdef HAS_ATTRIBUTE_a_${Y}\n    ${Y} = a_${Y};\n#endif\n`:void 0:"define"===V?`\n#ifndef HAS_UNIFORM_u_${Y}\nuniform lowp float u_${Y}_t;\nin ${H} ${ee} a_${Y};\n#else\nuniform ${H} ${G} u_${Y};\n#endif\n`:"define-instanced"===V?"mat4"===K?`\n#ifdef INSTANCED_ARRAYS\nin vec4 a_${Y}0;\nin vec4 a_${Y}1;\nin vec4 a_${Y}2;\nin vec4 a_${Y}3;\n#else\nuniform ${H} ${G} u_${Y};\n#endif\n`:`\n#ifdef INSTANCED_ARRAYS\nin ${H} ${ee} a_${Y};\n#else\nuniform ${H} ${G} u_${Y};\n#endif\n`:"initialize-attribute-custom"===V?`\n#ifdef HAS_ATTRIBUTE_a_${Y}\n    ${H} ${G} ${Y} = a_${Y};\n#endif\n`:"vec4"===K?`\n#ifndef HAS_UNIFORM_u_${Y}\n    ${H} ${G} ${Y} = a_${Y};\n#else\n    ${H} ${G} ${Y} = u_${Y};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${Y}\n    ${H} ${G} ${Y} = unpack_mix_${K}(a_${Y}, u_${Y}_t);\n#else\n    ${H} ${G} ${Y} = u_${Y};\n#endif\n`}),staticAttributes:w,usedDefines:O,vertexIncludes:S,fragmentIncludes:I}}class Sm{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(c,f,v,w,E,S,I,O){this.context=c;let N=this.boundPaintVertexBuffers.length!==w.length;for(let H=0;!N&&H<w.length;H++)this.boundPaintVertexBuffers[H]!==w[H]&&(N=!0);let V=this.boundDynamicVertexBuffers.length!==I.length;for(let H=0;!V&&H<I.length;H++)this.boundDynamicVertexBuffers[H]!==I[H]&&(V=!0);if(!this.vao||this.boundProgram!==f||this.boundLayoutVertexBuffer!==v||N||V||this.boundIndexBuffer!==E||this.boundVertexOffset!==S)this.freshBind(f,v,w,E,S,I,O);else{c.bindVertexArrayOES.set(this.vao);for(const H of I)H&&(H.bind(),O&&H.instanceCount&&H.setVertexAttribDivisor(c.gl,f,O));E&&E.dynamicDraw&&E.bind()}}freshBind(c,f,v,w,E,S,I){const O=c.numAttributes,N=this.context,V=N.gl;this.vao&&this.destroy(),this.vao=N.gl.createVertexArray(),N.bindVertexArrayOES.set(this.vao),this.boundProgram=c,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=v,this.boundIndexBuffer=w,this.boundVertexOffset=E,this.boundDynamicVertexBuffers=S,f.enableAttributes(V,c),f.bind(),f.setVertexAttribPointers(V,c,E);for(const H of v)H.enableAttributes(V,c),H.bind(),H.setVertexAttribPointers(V,c,E);for(const H of S)H&&(H.enableAttributes(V,c),H.bind(),H.setVertexAttribPointers(V,c,E),I&&H.instanceCount&&H.setVertexAttribDivisor(V,c,I));w&&w.bind(),N.currentNumAttributes=O}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function vd(_,c){const f=Math.pow(2,c.canonical.z),v=c.canonical.y;return[new h.M(0,v/f).toLngLat().lat,new h.M(0,(v+1)/f).toLngLat().lat]}function Sh(_,c,f,v,w,E,S){const I=_.context,O=I.gl,N=f.hillshadeFBO;if(!N)return;_.prepareDrawTile();const V=_.isTileAffectedByFog(c),H=_.getOrCreateProgram("hillshade",{overrideFog:V});I.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,N.colorAttachment.get());const G=((ne,J,oe,_e)=>{const ye=oe.paint.get("hillshade-shadow-color"),re=oe.paint.get("hillshade-highlight-color"),ae=oe.paint.get("hillshade-accent-color"),be=oe.paint.get("hillshade-emissive-strength");let Se=h.d(oe.paint.get("hillshade-illumination-direction"));if("viewport"===oe.paint.get("hillshade-illumination-anchor"))Se-=ne.transform.angle;else if(ne.style&&ne.style.enable3dLights()&&ne.style.directionalLight){const ke=ne.style.directionalLight.properties.get("direction"),lt=h.b3(ke.x,ke.y,ke.z);Se=h.d(lt[1])}const Ce=!ne.options.moving;return{u_matrix:_e||ne.transform.calculateProjMatrix(J.tileID.toUnwrapped(),Ce),u_image:0,u_latrange:vd(0,J.tileID),u_light:[oe.paint.get("hillshade-exaggeration"),Se],u_shadow:ye,u_highlight:re,u_emissive_strength:be,u_accent:ae}})(_,f,v,_.terrain?c.projMatrix:null);_.uploadCommonUniforms(I,H,c.toUnwrapped());const{tileBoundsBuffer:Y,tileBoundsIndexBuffer:ee,tileBoundsSegments:K}=_.getTileBoundsBuffers(f);H.draw(_,O.TRIANGLES,w,E,S,h.b5.disabled,G,v.id,Y,ee,K)}function wu(_,c,f){if(!c.needsDEMTextureUpload)return;const v=_.context,w=v.gl;v.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||_.getTileTexture(f.stride);const E=f.getPixels();c.demTexture?c.demTexture.update(E,{premultiply:!1}):c.demTexture=new h.a9(v,E,w.R32F,{premultiply:!1}),c.needsDEMTextureUpload=!1}function $f(_,c,f){const v=_.context,w=v.gl;if(!c.dem)return;const E=c.dem;if(v.activeTexture.set(w.TEXTURE1),wu(_,c,E),!c.demTexture)return;c.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);const S=E.dim;v.activeTexture.set(w.TEXTURE0);let I=c.hillshadeFBO;if(!I){const G=new h.a9(v,{width:S,height:S,data:null},w.RGBA);G.bind(w.LINEAR,w.CLAMP_TO_EDGE),I=c.hillshadeFBO=v.createFramebuffer(S,S,!0,"renderbuffer"),I.colorAttachment.set(G.texture)}v.bindFramebuffer.set(I.framebuffer),v.viewport.set([0,0,S,S]);const{tileBoundsBuffer:O,tileBoundsIndexBuffer:N,tileBoundsSegments:V}=_.getMercatorTileBoundsBuffers(),H=[];_.linearFloatFilteringSupported()&&H.push("TERRAIN_DEM_FLOAT_FORMAT"),_.getOrCreateProgram("hillshadePrepare",{defines:H}).draw(_,w.TRIANGLES,h.b4.disabled,h.b6.disabled,h.a.unblended,h.b5.disabled,((G,Y)=>{const ee=Y.stride,K=h.m.create();return h.m.ortho(K,0,h.J,-h.J,0,0,1),h.m.translate(K,K,[0,-h.J,0]),{u_matrix:K,u_image:1,u_dimension:[ee,ee],u_zoom:G.overscaledZ}})(c.tileID,E),f.id,O,N,V),c.needsHillshadePrepare=!1}const Ql=_=>({u_matrix:new h.a_(_),u_image0:new h.a$(_),u_skirt_height:new h.b2(_),u_ground_shadow_factor:new h.b7(_)}),wl=(_,c,f)=>({u_matrix:_,u_image0:0,u_skirt_height:c,u_ground_shadow_factor:f}),Cu=(_,c,f,v,w,E,S,I,O,N,V,H,G,Y,ee)=>({u_proj_matrix:Float32Array.from(_),u_globe_matrix:c,u_normalize_matrix:Float32Array.from(v),u_merc_matrix:f,u_zoom_transition:w,u_merc_center:E,u_image0:0,u_frustum_tl:S,u_frustum_tr:I,u_frustum_br:O,u_frustum_bl:N,u_globe_pos:V,u_globe_radius:H,u_viewport:G,u_grid_matrix:ee?Float32Array.from(ee):new Float32Array(9),u_skirt_height:Y}),Nc=(_,c)=>{if(c>0&&_.terrain&&h.X("Cutoff is currently disabled on terrain"),c<=0||_.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const f=_.transform,v=Math.max(Math.abs(f._zoom-(_.minCutoffZoom-1)),1),w=f.isLODDisabled(!1)?h.an(60,45,f.pitch):h.an(30,15,f.pitch),E=f._farZ-f._nearZ,S=c*f.height,I=((1-(O=w))*f.cameraToCenterDistance+O*(f._farZ+S))*v;var O;return{shouldRenderCutoff:w<1,uniformValues:{u_cutoff_params:[f._nearZ,f._farZ,(I-f._nearZ)/E,(I-S-f._nearZ)/E]}}};function Gf(_,c){return null!=_&&null!=c&&!(!_.hasData()||!c.hasData())&&null!=_.demTexture&&null!=c.demTexture&&_.tileID.key!==c.tileID.key}const qa=new class{constructor(){this.operations={}}newMorphing(_,c,f,v,w){if(_ in this.operations){const E=this.operations[_];E.to.tileID.key!==f.tileID.key&&(E.queued=f)}else this.operations[_]={startTime:v,phase:0,duration:w,from:c,to:f,queued:null}}getMorphValuesForProxy(_){if(!(_ in this.operations))return null;const c=this.operations[_];return{from:c.from,to:c.to,phase:c.phase}}update(_){for(const c in this.operations){const f=this.operations[c];for(f.phase=(_-f.startTime)/f.duration;f.phase>=1||!this._validOp(f);)if(!this._nextOp(f,_)){delete this.operations[c];break}}}_nextOp(_,c){return!!_.queued&&(_.from=_.to,_.to=_.queued,_.queued=null,_.phase=0,_.startTime=c,!0)}_validOp(_){return _.from.hasData()&&_.to.hasData()}},Mh={0:null,1:"TERRAIN_VERTEX_MORPHING"};function qf(_,c,f){if(0===c)return 0;const v=c<1&&514===f?.25/c:1;return 6*Math.pow(1.5,22-_)*Math.max(c,1)*v}function Jl(_,c){const f=1<<_.z;return!c&&(0===_.x||_.x===f-1)||0===_.y||_.y===f-1}const Bc=_=>({u_matrix:_});function ec(_,c,f,v,w){if(w>0){const E=h.a4.now(),S=(E-_.timeAdded)/w,I=c?(E-c.timeAdded)/w:-1,O=f.getSource(),N=v.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),V=!c||Math.abs(c.tileID.overscaledZ-N)>Math.abs(_.tileID.overscaledZ-N),H=V&&_.refreshedUponExpiration?1:h.c(V?S:1-I,0,1);return _.refreshedUponExpiration&&S>=1&&(_.refreshedUponExpiration=!1),c?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}class Ht extends h.bq{constructor(c){const f={type:"raster-dem",maxzoom:c.transform.maxZoom},v=new h.br(h.bs(),null),w=Xs("mock-dem",f,v,c.style);super("mock-dem",w,!1),w.setEventedParent(this),this._sourceLoaded=!0}_loadTile(c,f){c.state="loaded",f(null)}}class Ah extends h.bq{constructor(c){const f=Xs("proxy",{type:"geojson",maxzoom:c.transform.maxZoom},new h.br(h.bs(),null),c.style);super("proxy",f,!1),f.setEventedParent(this),this.map=this.getSource().map=c,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(c,f,v){if(c.freezeTileCoverage)return;this.transform=c;const w=c.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((E,S)=>{if(E[S.key]="",!this._tiles[S.key]){const I=new h.bt(S,this._source.tileSize*S.overscaleFactor(),c.tileZoom);I.state="loaded",this._tiles[S.key]=I}return E},{});for(const E in this._tiles)E in w||(this.freeFBO(E),this._tiles[E].unloadVectorData(),delete this._tiles[E])}freeFBO(c){const f=this.proxyCachedFBO[c];if(void 0!==f){const v=Object.values(f);this.renderCachePool.push(...v),delete this.proxyCachedFBO[c]}}deallocRenderCache(){this.renderCache.forEach(c=>c.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Eu extends h.O{constructor(c,f,v){super(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y),this.proxyTileKey=f,this.projMatrix=v}}class tc extends h.bk{constructor(c,f){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},c.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),c.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),c.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=c,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[v,w,E]=function(O){const N=new h.bo,V=new h.bp,H=131;N.reserve(17161),V.reserve(33800);const G=h.J/128,Y=h.J+G/2,ee=Y+G;for(let ne=-G;ne<ee;ne+=G)for(let J=-G;J<ee;J+=G){const oe=J<0||J>Y||ne<0||ne>Y?24575:0,_e=h.c(Math.round(J),0,h.J),ye=h.c(Math.round(ne),0,h.J);N.emplaceBack(_e+oe,ye)}const K=(ne,J)=>{const oe=J*H+ne;V.emplaceBack(oe+1,oe,oe+H),V.emplaceBack(oe+H,oe+H+1,oe+1)};for(let ne=1;ne<129;ne++)for(let J=1;J<129;J++)K(J,ne);return[0,129].forEach(ne=>{for(let J=0;J<130;J++)K(J,ne),K(ne,J)}),[N,V,32768]}(),S=c.context;this.gridBuffer=S.createVertexBuffer(v,h.bl.members),this.gridIndexBuffer=S.createIndexBuffer(w),this.gridSegments=h.bm.simpleSegment(0,0,v.length,w.length),this.gridNoSkirtSegments=h.bm.simpleSegment(0,0,v.length,E),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Ah(f.map),this.orthoMatrix=h.m.create(),h.m.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,h.J,0,h.J,0,1);const I=S.gl;this._overlapStencilMode=new h.b6({func:I.GEQUAL,mask:255},0,255,I.KEEP,I.KEEP,I.REPLACE),this._previousZoom=c.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=f,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Ht(f.map),this._pendingGroundEffectLayers=[]}set style(c){c.on("data",this._onStyleDataEvent.bind(this)),this._style=c,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(c,f,v){if(c&&c.terrain){this._style!==c&&(this.style=c,this._evaluationZoom=void 0);const w=c.terrain.properties,E=0===c.terrain.drapeRenderMode,S=c.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=h.a4.now();const I=c.terrain&&c.terrain.scope,O=w.get("source"),N=E?this._mockSourceCache:c.getSourceCache(O,I);if(!N)return void h.X(`Couldn't find terrain source "${O}".`);if(this.sourceCache=N,this._exaggeration=S?this.calculateExaggeration(f):w.get("exaggeration"),!f.projection.requiresDraping&&S&&0===this._exaggeration)return void this._disable();this.enabled=!0;const V=()=>{this.sourceCache.used&&h.X(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const H=this.getScaledDemTileSize();this.sourceCache.update(f,H,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,V(),this._initializing=!0),V(),f.updateElevation(!0,v),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(f),this._emptyDEMTextureDirty=!0,this._previousZoom=f.zoom}else this._disable()}calculateExaggeration(c){const f=this._previousCameraAltitude,v=c.getFreeCameraOptions().position.z/c.pixelsPerMeter*c.worldSize;this._previousCameraAltitude=v;const w=null!=f?v-f:Number.MAX_VALUE;if(Math.abs(w)<2)return this._exaggeration;const E=c.zoom,S=this._style.terrain;if(!this._previousUpdateTimestamp)return S.getExaggeration(E);let I=E-this._previousZoom;const O=this._previousUpdateTimestamp;let N=E;null!=this._evaluationZoom&&(N=this._evaluationZoom,Math.abs(E-N)>.5&&(I=.5*(E-N+I)),I*w<0&&(N+=I)),this._evaluationZoom=N;const V=S.getExaggeration(N),H=V===S.getExaggeration(Math.max(0,N-.1));if(H&&Math.abs(V-this._exaggeration)<.01)return V;let G=Math.min(.1,.00375*(this._updateTimestamp-O));return(H||V<.1||Math.abs(I)<1e-4)&&(G=Math.min(.2,4*G)),h.n(this._exaggeration,V,G)}resetTileLookupCache(c){this._findCoveringTileCache[c]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(c){c.coord&&"source"===c.dataType?this._clearRenderCacheForTile(c.sourceCacheId,c.coord):"style"===c.dataType&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const c in this._style._mergedSourceCaches)this._style._mergedSourceCaches[c].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(c=>c.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const c=2*this.proxySourceCache.getSource().tileSize;return[c,c]}set useVertexMorphing(c){this._useVertexMorphing=c}updateTileBinding(c){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const f=this.proxySourceCache,v=this.painter.transform;this._initializing&&(this._initializing=0===v._centerAltitude&&-1===this.getAtPointOrZero(h.M.fromLngLat(v.center),-1),this._emptyDEMTextureDirty=!this._initializing);const w=this.proxyCoords=f.getIds().map(O=>{const N=f.getTileByID(O).tileID;return N.projMatrix=v.calculateProjMatrix(N.toUnwrapped()),N});!function(O,N){const V=N.transform.pointCoordinate(N.transform.getCameraPoint()),H=new h.P(V.x,V.y);O.sort((G,Y)=>{if(Y.overscaledZ-G.overscaledZ)return Y.overscaledZ-G.overscaledZ;const ee=new h.P(G.canonical.x+(1<<G.canonical.z)*G.wrap,G.canonical.y),K=new h.P(Y.canonical.x+(1<<Y.canonical.z)*Y.wrap,Y.canonical.y),ne=H.mult(1<<G.canonical.z);return ne.x-=.5,ne.y-=.5,ne.distSqr(ee)-ne.distSqr(K)})}(w,this.painter);const E=this.proxyToSource||{};this.proxyToSource={},w.forEach(O=>{this.proxyToSource[O.key]={}}),this.terrainTileForTile={};const S=this._style._mergedSourceCaches;for(const O in S){const N=S[O];if(!N.used||(N!==this.sourceCache&&this.resetTileLookupCache(N.id),this._setupProxiedCoordsForOrtho(N,c[O],E),N.usedForTerrain))continue;const V=c[O];N.getSource().reparseOverscaled&&this._assignTerrainTiles(V)}this.proxiedCoords[f.id]=w.map(O=>new Eu(O,O.key,this.orthoMatrix)),this._assignTerrainTiles(w),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(E),this.renderingToTexture=!1;const I={};this._visibleDemTiles=[];for(const O of this.proxyCoords){const N=this.terrainTileForTile[O.key];if(!N)continue;const V=N.tileID.key;V in I||(this._visibleDemTiles.push(N),I[V]=V)}}_assignTerrainTiles(c){this._initializing||c.forEach(f=>{if(this.terrainTileForTile[f.key])return;const v=this._findTileCoveringTileID(f,this.sourceCache);v&&(this.terrainTileForTile[f.key]=v)})}_prepareDEMTextures(){const c=this.painter.context,f=c.gl;for(const v in this.terrainTileForTile){const w=this.terrainTileForTile[v],E=w.dem;!E||w.demTexture&&!w.needsDEMTextureUpload||(c.activeTexture.set(f.TEXTURE1),wu(this.painter,w,E))}}_prepareDemTileUniforms(c,f,v,w){if(!f||null==f.demTexture)return!1;const E=c.tileID.canonical,S=Math.pow(2,f.tileID.canonical.z-E.z),I=w||"";return v[`u_dem_tl${I}`]=[E.x*S%1,E.y*S%1],v[`u_dem_scale${I}`]=S,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const c=this.painter.context,f=c.gl;if(!this._emptyDepthBufferTexture){const v=new h.a5({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new h.a9(c,v,f.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let c=0;const f=this._visibleDemTiles.reduce((v,w)=>{if(!w.dem)return v;const E=w.dem.tree.minimums[0];return E>0&&c++,v+E},0);return c?f/c:0}_updateEmptyDEMTexture(){const c=this.painter.context,f=c.gl;c.activeTexture.set(f.TEXTURE2);const v=this._getLoadedAreaMinimum(),[w,E]=(()=>{const I=new h.bu({width:1,height:1},new Float32Array([v]));return[f.R32F,I]})();this._emptyDEMTextureDirty=!1;let S=this._emptyDEMTexture;return S?S.update(E,{premultiply:!1}):S=this._emptyDEMTexture=new h.a9(c,E,w,{premultiply:!1}),S}setupElevationDraw(c,f,v){const w=this.painter.context,E=w.gl,S={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0};S.u_exaggeration=this.exaggeration();let I=null,O=null,N=1;if(v&&v.morphing&&this._useVertexMorphing){const G=v.morphing.srcDemTile,Y=v.morphing.dstDemTile;N=v.morphing.phase,G&&Y&&(this._prepareDemTileUniforms(c,G,S,"_prev")&&(O=G),this._prepareDemTileUniforms(c,Y,S)&&(I=Y))}const V=G=>G&&G.demTexture&&this.painter.linearFloatFilteringSupported()?E.LINEAR:E.NEAREST,H=G=>{S.u_dem_size=1===G.size[0]?1:G.size[0]-2};if(O&&I)w.activeTexture.set(E.TEXTURE2),I.demTexture.bind(V(I),E.CLAMP_TO_EDGE),w.activeTexture.set(E.TEXTURE4),O.demTexture.bind(V(O),E.CLAMP_TO_EDGE),I.demTexture&&H(I.demTexture),S.u_dem_lerp=N;else{I=this.terrainTileForTile[c.tileID.key],w.activeTexture.set(E.TEXTURE2);const G=this._prepareDemTileUniforms(c,I,S)?I.demTexture:this.emptyDEMTexture;G.bind(V(I),E.CLAMP_TO_EDGE),H(G)}if(w.activeTexture.set(E.TEXTURE3),v&&v.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),this._depthFBO&&(S.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),S.u_depth_size_inv=[1,1]),v&&v.useMeterToDem&&I){const G=(1<<I.tileID.canonical.z)*h.b(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;S.u_meter_to_dem=G}if(v&&v.labelPlaneMatrixInv&&(S.u_label_plane_matrix_inv=v.labelPlaneMatrixInv),f.setTerrainUniformValues(w,S),"globe"===this.painter.transform.projection.name){const G=this.globeUniformValues(this.painter.transform,c.tileID.canonical,v&&v.useDenormalizedUpVectorScale);f.setGlobeUniformValues(w,G)}}globeUniformValues(c,f,v){const w=c.projection;return{u_tile_tl_up:w.upVector(f,0,0),u_tile_tr_up:w.upVector(f,h.J,0),u_tile_br_up:w.upVector(f,h.J,h.J),u_tile_bl_up:w.upVector(f,0,h.J),u_tile_up_scale:v?h.bn(1):w.upVectorScale(f,c.center.lat,c.worldSize).metersToTile}}renderToBackBuffer(c){const f=this.painter,v=this.painter.context;0!==c.length&&(v.bindFramebuffer.set(null),v.viewport.set([0,0,f.width,f.height]),f.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(w,E,S,I,O){if("globe"===w.transform.projection.name)!function(N,V,H,G,Y){const ee=N.context,K=ee.gl;let ne,J;const oe=N.transform,_e=h.bb(N,ee,oe),ye=(Qe,Fe)=>{if(J===Fe)return;const ot=[Mh[Fe],"PROJECTION_GLOBE_VIEW"];_e&&ot.push("CUSTOM_ANTIALIASING");const Ke=N.isTileAffectedByFog(Qe);ne=N.getOrCreateProgram("globeRaster",{defines:ot,overrideFog:Ke}),J=Fe},re=N.colorModeForRenderPass(),ae=new h.b4(K.LEQUAL,h.b4.ReadWrite,N.depthRangeFor3D);qa.update(Y);const be=h.bc(oe),Se=[h.E(oe.center.lng),h.H(oe.center.lat)],Ce=N.globeSharedBuffers,ke=[oe.width*h.a4.devicePixelRatio,oe.height*h.a4.devicePixelRatio],lt=Float32Array.from(oe.globeMatrix),$e={useDenormalizedUpVectorScale:!0};{const Qe=N.transform,Fe=qf(Qe.zoom,V.exaggeration(),V.sourceCache._source.tileSize);J=-1;const ot=K.TRIANGLES;for(const Ke of G){const Ue=H.getTile(Ke),fe=h.b6.disabled,Ne=V.prevTerrainTileForTile[Ke.key],At=V.terrainTileForTile[Ke.key];Gf(Ne,At)&&qa.newMorphing(Ke.key,Ne,At,Y,250),ee.activeTexture.set(K.TEXTURE0),Ue.texture&&Ue.texture.bind(K.LINEAR,K.CLAMP_TO_EDGE);const vt=qa.getMorphValuesForProxy(Ke.key),an=vt?1:0;vt&&h.bd($e,{morphing:{srcDemTile:vt.from,dstDemTile:vt.to,phase:h.ba(vt.phase)}});const Xt=h.be(Ke.canonical),mn=h.bf(Xt.getCenter().lat),nn=h.bg(Ke.canonical,Xt,mn,Qe.worldSize/Qe._pixelsPerMercatorPixel),Rn=h.bh(h.bi(Ke.canonical)),Pn=Cu(Qe.expandedFarZProjMatrix,lt,be,Rn,h.ao(Qe.zoom),Se,Qe.frustumCorners.TL,Qe.frustumCorners.TR,Qe.frustumCorners.BR,Qe.frustumCorners.BL,Qe.globeCenterInViewSpace,Qe.globeRadius,ke,Fe,nn);if(ye(Ke,an),ne&&(V.setupElevationDraw(Ue,ne,$e),N.uploadCommonUniforms(ee,ne,Ke.toUnwrapped()),Ce)){const[gn,_n,mt]=Ce.getGridBuffers(mn,0!==Fe);ne.draw(N,ot,ae,fe,re,h.b5.backCCW,Pn,"globe_raster",gn,_n,mt)}}}if(Ce&&(N.renderDefaultNorthPole||N.renderDefaultSouthPole)){const Qe=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];_e&&Qe.push("CUSTOM_ANTIALIASING"),ne=N.getOrCreateProgram("globeRaster",{defines:Qe});for(const Fe of G){const{x:ot,y:Ke,z:Ue}=Fe.canonical,fe=0===Ke,Ne=Ke===(1<<Ue)-1,[At,vt,an,Xt]=Ce.getPoleBuffers(Ue,!1);if(Xt&&(fe||Ne)){const mn=H.getTile(Fe);ee.activeTexture.set(K.TEXTURE0),mn.texture&&mn.texture.bind(K.LINEAR,K.CLAMP_TO_EDGE);let nn=h.bj(Ue,ot,oe);const Rn=h.bh(h.bi(Fe.canonical)),Pn=(gn,_n)=>gn.draw(N,K.TRIANGLES,ae,h.b6.disabled,re,h.b5.disabled,Cu(oe.expandedFarZProjMatrix,nn,nn,Rn,0,Se,oe.frustumCorners.TL,oe.frustumCorners.TR,oe.frustumCorners.BR,oe.frustumCorners.BL,oe.globeCenterInViewSpace,oe.globeRadius,ke,0),"globe_pole_raster",_n,an,Xt);V.setupElevationDraw(mn,ne,$e),N.uploadCommonUniforms(ee,ne,Fe.toUnwrapped()),fe&&N.renderDefaultNorthPole&&Pn(ne,At),Ne&&N.renderDefaultSouthPole&&(nn=h.m.scale(h.m.create(),nn,[1,-1,1]),Pn(ne,vt))}}}}(w,E,S,I,O);else{const N=w.context,V=N.gl;let H,G;const Y=w.shadowRenderer,ee=Nc(w,w.longestCutoffRange),K=re=>{if(G===re)return;const ae=[];ae.push(Mh[re]),ee.shouldRenderCutoff&&ae.push("RENDER_CUTOFF"),H=w.getOrCreateProgram("terrainRaster",{defines:ae}),G=re},ne=w.colorModeForRenderPass(),J=new h.b4(V.LEQUAL,h.b4.ReadWrite,w.depthRangeFor3D);qa.update(O);const oe=w.transform,_e=qf(oe.zoom,E.exaggeration(),E.sourceCache._source.tileSize);let ye=[0,0,0];if(Y){const re=w.style.directionalLight,ae=w.style.ambientLight;re&&ae&&(ye=Li(re,ae))}{G=-1;const re=V.TRIANGLES,[ae,be]=[E.gridIndexBuffer,E.gridSegments];for(const Se of I){const Ce=S.getTile(Se),ke=h.b6.disabled,lt=E.prevTerrainTileForTile[Se.key],$e=E.terrainTileForTile[Se.key];Gf(lt,$e)&&qa.newMorphing(Se.key,lt,$e,O,250),N.activeTexture.set(V.TEXTURE0),Ce.texture&&Ce.texture.bind(V.LINEAR,V.CLAMP_TO_EDGE);const Qe=qa.getMorphValuesForProxy(Se.key),Fe=Qe?1:0;let ot;Qe&&(ot={morphing:{srcDemTile:Qe.from,dstDemTile:Qe.to,phase:h.ba(Qe.phase)}});const Ke=wl(Se.projMatrix,Jl(Se.canonical,oe.renderWorldCopies)?_e/10:_e,ye);if(K(Fe),!H)continue;E.setupElevationDraw(Ce,H,ot);const Ue=Se.toUnwrapped();Y&&Y.setupShadows(Ue,H),w.uploadCommonUniforms(N,H,Ue,null,ee),H.draw(w,re,J,ke,ne,h.b5.backCCW,Ke,"terrain_raster",E.gridBuffer,ae,be)}}}}(f,this,this.proxySourceCache,c,this._updateTimestamp),this.renderingToTexture=!0,f.gpuTimingDeferredRenderEnd(),c.splice(0,c.length))}renderBatch(c){if(0===this._drapedRenderBatches.length)return c+1;this.renderingToTexture=!0;const f=this.painter,v=this.painter.context,w=this.proxySourceCache,E=this.proxiedCoords[w.id],S=this._drapedRenderBatches.shift(),I=f.style.order,O=[];let N=0;for(const V of E){const H=w.getTileByID(V.proxyTileKey),G=w.proxyCachedFBO[V.key]?w.proxyCachedFBO[V.key][c]:void 0,Y=void 0!==G?w.renderCache[G]:this.pool[N++],ee=void 0!==G;if(H.texture=Y.tex,ee&&!Y.dirty){O.push(H.tileID);continue}let K;v.bindFramebuffer.set(Y.fb.framebuffer),this.renderedToTile=!1,Y.dirty&&(v.clear({color:h.C.transparent,stencil:0}),Y.dirty=!1);for(let ne=S.start;ne<=S.end;++ne){const J=f.style._mergedLayers[I[ne]];if(J.isHidden(f.transform.zoom))continue;const oe=f.style.getLayerSourceCache(J),_e=oe?this.proxyToSource[V.key][oe.id]:[V];if(!_e)continue;const ye=_e;v.viewport.set([0,0,Y.fb.width,Y.fb.height]),K!==(oe?oe.id:null)&&(this._setupStencil(Y,_e,J,oe),K=oe?oe.id:null),f.renderLayer(f,oe,J,ye)}if(0===this._drapedRenderBatches.length)for(const ne of this._pendingGroundEffectLayers){const J=f.style._mergedLayers[I[ne]];if(J.isHidden(f.transform.zoom))continue;const oe=f.style.getLayerSourceCache(J),_e=oe?this.proxyToSource[V.key][oe.id]:[V];if(!_e)continue;const ye=_e;v.viewport.set([0,0,Y.fb.width,Y.fb.height]),K!==(oe?oe.id:null)&&(this._setupStencil(Y,_e,J,oe),K=oe?oe.id:null),f.renderLayer(f,oe,J,ye)}this.renderedToTile?(Y.dirty=!0,O.push(H.tileID)):ee||--N,5===N&&(N=0,this.renderToBackBuffer(O))}return this.renderToBackBuffer(O),this.renderingToTexture=!1,v.bindFramebuffer.set(null),v.viewport.set([0,0,f.width,f.height]),S.end+1}postRender(){}isLayerOrderingCorrect(c){const f=c.order.length;let v=-1,w=f;for(let E=0;E<f;++E)this._style.isLayerDraped(c._mergedLayers[c.order[E]])?v=Math.max(v,E):w=Math.min(w,E);return w>v}getMinElevationBelowMSL(){let c=0;return this._visibleDemTiles.filter(f=>f.dem).forEach(f=>{c=Math.min(c,f.dem.tree.minimums[0])}),0===c?c:(c-30)*this._exaggeration}raycast(c,f,v){if(!this._visibleDemTiles)return null;const w=this._visibleDemTiles.filter(E=>E.dem).map(E=>{const S=E.tileID,I=1<<S.overscaledZ,{x:O,y:N}=S.canonical,V=O/I,H=(O+1)/I,G=N/I,Y=(N+1)/I;return{minx:V,miny:G,maxx:H,maxy:Y,t:E.dem.tree.raycastRoot(V,G,H,Y,c,f,v),tile:E}});w.sort((E,S)=>(null!==E.t?E.t:Number.MAX_VALUE)-(null!==S.t?S.t:Number.MAX_VALUE));for(const E of w){if(null==E.t)return null;const S=E.tile.dem.tree.raycast(E.minx,E.miny,E.maxx,E.maxy,c,f,v);if(null!=S)return S}return null}_createFBO(){const c=this.painter.context,f=c.gl,v=this.drapeBufferSize;c.activeTexture.set(f.TEXTURE0);const w=new h.a9(c,{width:v[0],height:v[1],data:null},f.RGBA);w.bind(f.LINEAR,f.CLAMP_TO_EDGE);const E=c.createFramebuffer(v[0],v[1],!0,null);return E.colorAttachment.set(w.texture),E.depthAttachment=new $i(c,E.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=c.createRenderbuffer(c.gl.DEPTH_STENCIL,v[0],v[1]),this._stencilRef=0,E.depthAttachment.set(this._sharedDepthStencil),c.clear({stencil:0})):E.depthAttachment.set(this._sharedDepthStencil),c.extTextureFilterAnisotropic&&f.texParameterf(f.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax),{fb:E,tex:w,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const c in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[c].hasTransition())return!0;return this._style.order.some(c=>{const f=this._style._mergedLayers[c],v=f.isHidden(this.painter.transform.zoom);return"custom"===f.type?!v&&f.shouldRedrape():!v&&f.hasTransition()})}_clearLineLayersFromRenderCache(){let c=!1;for(const v of this._style.getSources())if(v instanceof He){c=!0;break}if(!c)return;const f={};for(let v=0;v<this._style.order.length;++v){const w=this._style._mergedLayers[this._style.order[v]],E=this._style.getLayerSourceCache(w);if(E&&!f[E.id]&&!w.isHidden(this.painter.transform.zoom)&&"line"===w.type&&w.widthExpression()instanceof h.am){f[E.id]=!0;for(const S of this.proxyCoords){const I=this.proxyToSource[S.key][E.id];if(I)for(const O of I)this._clearRenderCacheForTile(E.id,O)}}}}_clearRasterLayersFromRenderCache(){let c=!1;for(const v in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[v]._source instanceof sn){c=!0;break}if(!c)return;const f={};for(let v=0;v<this._style.order.length;++v){const w=this._style._mergedLayers[this._style.order[v]],E=this._style.getLayerSourceCache(w);if(!E||f[E.id]||w.isHidden(this.painter.transform.zoom)||"raster"!==w.type)continue;const S=w.paint.get("raster-fade-duration");for(const I of this.proxyCoords){const O=this.proxyToSource[I.key][E.id];if(O)for(const N of O){const V=ec(E.getTile(N),E.findLoadedParent(N,0),E,this.painter.transform,S);(1!==V.opacity||0!==V.mix)&&this._clearRenderCacheForTile(E.id,N)}}}}_setupDrapedRenderBatches(){const c=this._style.order,f=c.length;if(0===f)return;const v=[];this._pendingGroundEffectLayers=[];let w,E=0,S=this._style._mergedLayers[c[E]];for(;!this._style.isLayerDraped(S)&&S.isHidden(this.painter.transform.zoom)&&++E<f;)S=this._style._mergedLayers[c[E]];for(;E<f;++E){const I=this._style._mergedLayers[c[E]];I.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(I)?void 0===w&&(w=E):("fill-extrusion"===I.type&&this._pendingGroundEffectLayers.push(E),void 0!==w&&(v.push({start:w,end:E-1}),w=void 0)))}if(void 0!==w&&v.push({start:w,end:E-1}),0!==v.length){const I=v[v.length-1];this._pendingGroundEffectLayers.every(O=>O>I.end)||h.X("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=v}_setupRenderCache(c){const f=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,f.renderCache.length>f.renderCachePool.length){const S=Object.values(f.proxyCachedFBO);f.proxyCachedFBO={};for(let I=0;I<S.length;++I){const O=Object.values(S[I]);f.renderCachePool.push(...O)}}return}this._clearRasterLayersFromRenderCache();const v=this.proxyCoords,w=this._tilesDirty;for(let S=v.length-1;S>=0;S--){const I=v[S];if(f.getTileByID(I.key),void 0!==f.proxyCachedFBO[I.key]){const O=c[I.key],N=this.proxyToSource[I.key];let V=0;for(const H in N){const G=N[H],Y=O[H];if(!Y||Y.length!==G.length||G.some((ee,K)=>ee!==Y[K]||w[H]&&w[H].hasOwnProperty(ee.key))){V=-1;break}++V}for(const H in f.proxyCachedFBO[I.key])f.renderCache[f.proxyCachedFBO[I.key][H]].dirty=V<0||V!==Object.values(O).length}}const E=[...this._drapedRenderBatches];E.sort((S,I)=>I.end-I.start-(S.end-S.start));for(const S of E)for(const I of v){if(f.proxyCachedFBO[I.key])continue;let O=f.renderCachePool.pop();void 0===O&&f.renderCache.length<50&&(O=f.renderCache.length,f.renderCache.push(this._createFBO())),void 0!==O&&(f.proxyCachedFBO[I.key]={},f.proxyCachedFBO[I.key][S.start]=O,f.renderCache[O].dirty=!0)}this._tilesDirty={}}_setupStencil(c,f,v,w){if(!w||!this._sourceTilesOverlap[w.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const E=this.painter.context,S=E.gl;if(f.length<=1)return void(this._overlapStencilType=!1);let I;if(v.isTileClipped())I=f.length,this._overlapStencilMode.test={func:S.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(f[0].overscaledZ>f[f.length-1].overscaledZ))return void(this._overlapStencilType=!1);I=1,this._overlapStencilMode.test={func:S.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+I>255&&(E.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=I,this._overlapStencilMode.ref=this._stencilRef,v.isTileClipped()&&this._renderTileClippingMasks(f,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(c){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[c.key]),this._overlapStencilMode):h.b6.disabled}_renderTileClippingMasks(c,f){const v=this.painter,w=this.painter.context,E=w.gl;v._tileClippingMaskIDs={},w.setColorMode(h.a.disabled),w.setDepthMode(h.b4.disabled);const S=v.getOrCreateProgram("clippingMask");for(const I of c){const O=v._tileClippingMaskIDs[I.key]=--f;S.draw(v,E.TRIANGLES,h.b4.disabled,new h.b6({func:E.ALWAYS,mask:0},O,255,E.KEEP,E.KEEP,E.REPLACE),h.a.disabled,h.b5.disabled,Bc(I.projMatrix),"$clipping",v.tileExtentBuffer,v.quadTriangleIndexBuffer,v.tileExtentSegments)}}pointCoordinate(c){const f=this.painter.transform;if(c.x<0||c.x>f.width||c.y<0||c.y>f.height)return null;const v=[c.x,c.y,1,1];h.e.transformMat4(v,v,f.pixelMatrixInverse),h.e.scale(v,v,1/v[3]),v[0]/=f.worldSize,v[1]/=f.worldSize;const w=f._camera.position,E=h.b(1,f.center.lat),S=[w[0],w[1],w[2]/E,0],I=h.v.subtract([],v.slice(0,3),S);h.v.normalize(I,I);const O=this.raycast(S,I,this._exaggeration);return null!==O&&O?(h.v.scaleAndAdd(S,S,I,O),S[3]=S[2],S[2]*=E,S):null}drawDepth(){const c=this.painter,f=c.context,v=this.proxySourceCache,w=Math.ceil(c.width),E=Math.ceil(c.height);if(!this._depthFBO||this._depthFBO.width===w&&this._depthFBO.height===E||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const S=f.gl,I=f.createFramebuffer(w,E,!0,"renderbuffer");f.activeTexture.set(S.TEXTURE0);const O=new h.a9(f,{width:w,height:E,data:null},S.RGBA);O.bind(S.NEAREST,S.CLAMP_TO_EDGE),I.colorAttachment.set(O.texture);const N=f.createRenderbuffer(f.gl.DEPTH_COMPONENT16,w,E);I.depthAttachment.set(N),this._depthFBO=I,this._depthTexture=O}f.bindFramebuffer.set(this._depthFBO.framebuffer),f.viewport.set([0,0,w,E]),function(S,I,O,N){if("globe"===S.transform.projection.name)return;const V=S.context,H=V.gl;V.clear({depth:1});const G=S.getOrCreateProgram("terrainDepth"),Y=new h.b4(H.LESS,h.b4.ReadWrite,S.depthRangeFor3D);for(const ee of N){const K=O.getTile(ee),ne=wl(ee.projMatrix,0,[0,0,0]);I.setupElevationDraw(K,G),G.draw(S,H.TRIANGLES,Y,h.b6.disabled,h.a.unblended,h.b5.backCCW,ne,"terrain_depth",I.gridBuffer,I.gridIndexBuffer,I.gridNoSkirtSegments)}}(c,this,v,this.proxyCoords)}_setupProxiedCoordsForOrtho(c,f,v){if(c.getSource()instanceof h.aK)return this._setupProxiedCoordsForImageSource(c,f,v);this._findCoveringTileCache[c.id]=this._findCoveringTileCache[c.id]||{};const w=this.proxiedCoords[c.id]=[],E=this.proxyCoords;for(let O=0;O<E.length;O++){const N=E[O],V=this._findTileCoveringTileID(N,c);if(V){const H=this._createProxiedId(N,V,v[N.key]&&v[N.key][c.id]);w.push(H),this.proxyToSource[N.key][c.id]=[H]}}let S=!1;const I=new Set;for(let O=0;O<f.length;O++){const N=c.getTile(f[O]);if(!N||!N.hasData())continue;const V=this._findTileCoveringTileID(N.tileID,this.proxySourceCache);if(V&&V.tileID.canonical.z!==N.tileID.canonical.z){const H=this.proxyToSource[V.tileID.key][c.id],G=this._createProxiedId(V.tileID,N,v[V.tileID.key]&&v[V.tileID.key][c.id]);H?H.splice(H.length-1,0,G):this.proxyToSource[V.tileID.key][c.id]=[G];const Y=this.proxyToSource[V.tileID.key][c.id];I.has(Y)||I.add(Y),w.push(G),S=!0}}if(this._sourceTilesOverlap[c.id]=S,S&&this._debugParams.sortTilesHiZFirst)for(const O of I)O.sort((N,V)=>V.overscaledZ-N.overscaledZ)}_setupProxiedCoordsForImageSource(c,f,v){if(!c.getSource().loaded())return;const w=this.proxiedCoords[c.id]=[],E=this.proxyCoords,S=c.getSource(),I=S.tileID;if(!I)return;const O=new h.P(I.x,I.y)._div(1<<I.z),N=S.coordinates.map(h.M.fromLngLat).reduce((H,G)=>(H.min.x=Math.min(H.min.x,G.x-O.x),H.min.y=Math.min(H.min.y,G.y-O.y),H.max.x=Math.max(H.max.x,G.x-O.x),H.max.y=Math.max(H.max.y,G.y-O.y),H),{min:new h.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new h.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),V=(H,G)=>{const Y=H.wrap+H.canonical.x/(1<<H.canonical.z),ee=H.canonical.y/(1<<H.canonical.z),K=h.J/(1<<H.canonical.z),ne=G.wrap+G.canonical.x/(1<<G.canonical.z),J=G.canonical.y/(1<<G.canonical.z);return Y+K<ne+N.min.x||Y>ne+N.max.x||ee+K<J+N.min.y||ee>J+N.max.y};for(let H=0;H<E.length;H++){const G=E[H];for(let Y=0;Y<f.length;Y++){const ee=c.getTile(f[Y]);if(!ee||!ee.hasData()||V(G,ee.tileID))continue;const K=this._createProxiedId(G,ee,v[G.key]&&v[G.key][c.id]),ne=this.proxyToSource[G.key][c.id];ne?ne.push(K):this.proxyToSource[G.key][c.id]=[K],w.push(K)}}}_createProxiedId(c,f,v){let w=this.orthoMatrix;if(v){const E=v.find(S=>S.key===f.tileID.key);if(E)return E}if(f.tileID.key!==c.key){const E=c.canonical.z-f.tileID.canonical.z;let S,I,O;w=h.m.create();const N=f.tileID.wrap-c.wrap<<c.overscaledZ;E>0?(S=h.J>>E,I=S*((f.tileID.canonical.x<<E)-c.canonical.x+N),O=S*((f.tileID.canonical.y<<E)-c.canonical.y)):(S=h.J<<-E,I=h.J*(f.tileID.canonical.x-(c.canonical.x+N<<-E)),O=h.J*(f.tileID.canonical.y-(c.canonical.y<<-E))),h.m.ortho(w,0,S,0,S,0,1),h.m.translate(w,w,[I,O,0])}return new Eu(f.tileID,c.key,w)}_findTileCoveringTileID(c,f){let v=f.getTile(c);if(v&&v.hasData())return v;const w=this._findCoveringTileCache[f.id],E=w[c.key];if(v=E?f.getTileByID(E):null,v&&v.hasData()||null===E)return v;let S=v?v.tileID:c,I=S.overscaledZ;const O=f.getSource().minzoom,N=[];if(!E){const H=f.getSource().maxzoom;if(c.canonical.z>=H){const G=c.canonical.z-H;f.getSource().reparseOverscaled?(I=Math.max(c.canonical.z+2,f.transform.tileZoom),S=new h.O(I,c.wrap,H,c.canonical.x>>G,c.canonical.y>>G)):0!==G&&(I=H,S=new h.O(I,c.wrap,H,c.canonical.x>>G,c.canonical.y>>G))}S.key!==c.key&&(N.push(S.key),v=f.getTile(S))}const V=H=>{N.forEach(G=>{w[G]=H}),N.length=0};for(I-=1;I>=O&&(!v||!v.hasData());I--){v&&V(v.tileID.key);const H=S.calculateScaledKey(I);if(v=f.getTileByID(H),v&&v.hasData())break;const G=w[H];if(null===G)break;void 0===G?N.push(H):v=f.getTileByID(G)}return V(v?v.tileID.key:null),v&&v.hasData()?v:null}findDEMTileFor(c){return this.enabled?this._findTileCoveringTileID(c,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(c,f){let v=this._tilesDirty[c];v||(v=this._tilesDirty[c]={}),v[f.key]=!0}}function nc(_,c,f){const v=function(I,O,N){const V=h.v.dot(O,I),H=h.v.dot(N,[.2126,.7152,.0722]),G=(ee,K,ne)=>(1-ne)*ee+ne*K,Y=G(1-.3*Math.min(H,1),1,Math.min(V+1,1));return G(.92,1,Math.asin(h.c(O[2],-1,1))/Math.PI+.5)*Y}(_,[0,0,1],c),w=[0,0,0];h.v.scale(w,f.slice(0,3),v);const E=[0,0,0];h.v.scale(E,c.slice(0,3),_[2]);const S=[0,0,0];return h.v.add(S,w,E),h.bw(S)}const bd=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],$o=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class Du{static cacheKey(c,f,v,w){let E=`${f}${w?w.cacheKey:""}`;for(const S of v)c.usedDefines.includes(S)&&(E+=`/${S}`);return E}constructor(c,f,v,w,E,S){const I=c.gl;this.program=I.createProgram(),this.configuration=w,this.name=f,this.fixedDefines=[...S];const O=w?w.getBinderAttributes():[],N=(v.staticAttributes||[]).concat(O);let V=w?w.defines():[];V=V.concat(S.map(ne=>`#define ${ne}`));const H="#version 300 es\n";let G=H+V.concat("precision mediump float;",ho,Th.fragmentSource).join("\n");for(const ne of v.fragmentIncludes)G+=`\n${ri[ne]}`;G+=`\n${v.fragmentSource}`;let Y=H+V.concat("precision highp float;",ho,Th.vertexSource).join("\n");for(const ne of v.vertexIncludes)Y+=`\n${ri[ne]}`;Y+=`\n${v.vertexSource}`;const ee=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(ee,G),I.compileShader(ee),I.attachShader(this.program,ee);const K=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())this.failedToCreate=!0;else{I.shaderSource(K,Y),I.compileShader(K),I.attachShader(this.program,K),this.attributes={},this.numAttributes=N.length;for(let ne=0;ne<this.numAttributes;ne++)if(N[ne]){const J=N[ne].startsWith("a_")?N[ne]:`a_${N[ne]}`;I.bindAttribLocation(this.program,ne,J),this.attributes[J]=ne}I.linkProgram(this.program),I.deleteShader(K),I.deleteShader(ee),this.fixedUniforms=E(c),this.binderUniforms=w?w.getUniforms(c):[],S.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new h.a$(ne=c),u_dem_prev:new h.a$(ne),u_dem_tl:new h.b0(ne),u_dem_scale:new h.b2(ne),u_dem_tl_prev:new h.b0(ne),u_dem_scale_prev:new h.b2(ne),u_dem_size:new h.b2(ne),u_dem_lerp:new h.b2(ne),u_exaggeration:new h.b2(ne),u_depth:new h.a$(ne),u_depth_size_inv:new h.b0(ne),u_meter_to_dem:new h.b2(ne),u_label_plane_matrix_inv:new h.a_(ne)}),S.includes("GLOBE")&&(this.globeUniforms=(ne=>({u_tile_tl_up:new h.b7(ne),u_tile_tr_up:new h.b7(ne),u_tile_br_up:new h.b7(ne),u_tile_bl_up:new h.b7(ne),u_tile_up_scale:new h.b2(ne)}))(c)),S.includes("FOG")&&(this.fogUniforms=(ne=>({u_fog_matrix:new h.a_(ne),u_fog_range:new h.b0(ne),u_fog_color:new h.b9(ne),u_fog_horizon_blend:new h.b2(ne),u_fog_vertical_limit:new h.b0(ne),u_fog_temporal_offset:new h.b2(ne),u_frustum_tl:new h.b7(ne),u_frustum_tr:new h.b7(ne),u_frustum_br:new h.b7(ne),u_frustum_bl:new h.b7(ne),u_globe_pos:new h.b7(ne),u_globe_radius:new h.b2(ne),u_globe_transition:new h.b2(ne),u_is_globe:new h.a$(ne),u_viewport:new h.b0(ne)}))(c)),S.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(ne=>({u_cutoff_params:new h.b9(ne)}))(c)),S.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(ne=>({u_lighting_ambient_color:new h.b7(ne),u_lighting_directional_dir:new h.b7(ne),u_lighting_directional_color:new h.b7(ne),u_ground_radiance:new h.b7(ne)}))(c)),S.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(ne=>({u_light_matrix_0:new h.a_(ne),u_light_matrix_1:new h.a_(ne),u_fade_range:new h.b0(ne),u_shadow_normal_offset:new h.b7(ne),u_shadow_intensity:new h.b2(ne),u_shadow_texel_size:new h.b2(ne),u_shadow_map_resolution:new h.b2(ne),u_shadow_direction:new h.b7(ne),u_shadow_bias:new h.b7(ne),u_shadowmap_0:new h.a$(ne),u_shadowmap_1:new h.a$(ne)}))(c))}var ne}setTerrainUniformValues(c,f){if(!this.terrainUniforms)return;const v=this.terrainUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const w in f)v[w]&&v[w].set(this.program,w,f[w])}}setGlobeUniformValues(c,f){if(!this.globeUniforms)return;const v=this.globeUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const w in f)v[w]&&v[w].set(this.program,w,f[w])}}setFogUniformValues(c,f){if(!this.fogUniforms)return;const v=this.fogUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const w in f)v[w].set(this.program,w,f[w])}}setCutoffUniformValues(c,f){if(!this.cutoffUniforms)return;const v=this.cutoffUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const w in f)v[w].set(this.program,w,f[w])}}setLightsUniformValues(c,f){if(!this.lightsUniforms)return;const v=this.lightsUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const w in f)v[w].set(this.program,w,f[w])}}setShadowUniformValues(c,f){if(this.failedToCreate||!this.shadowUniforms)return;const v=this.shadowUniforms;c.program.set(this.program);for(const w in f)v[w].set(this.program,w,f[w])}_drawDebugWireframe(c,f,v,w,E,S,I,O,N,V){const H=c.options.wireframe;if(!1===H.terrain&&!1===H.layers2D&&!1===H.layers3D)return;const G=c.context;if(!(()=>!(!H.terrain||"terrainRaster"!==this.name&&"globeRaster"!==this.name)||!(!H.layers2D||c._terrain&&c._terrain.renderingToTexture||!bd.includes(this.name))||!(!H.layers3D||!$o.includes(this.name)))())return;const Y=G.gl,ee=c.wireframeDebugCache.getLinesFromTrianglesBuffer(c.frameCounter,E,G);if(!ee)return;const K=[...this.fixedDefines];K.push("DEBUG_WIREFRAME");const ne=c.getOrCreateProgram(this.name,{config:this.configuration,defines:K});G.program.set(ne.program);const J=(ye,re,ae)=>{if(re[ye]&&ae[ye])for(const be in re[ye])ae[ye][be]&&ae[ye][be].set(ae.program,be,re[ye][be].current)};N&&N.setUniforms(ne.program,G,ne.binderUniforms,I,{zoom:O}),J("fixedUniforms",this,ne),J("terrainUniforms",this,ne),J("globeUniforms",this,ne),J("fogUniforms",this,ne),J("lightsUniforms",this,ne),J("shadowUniforms",this,ne),ee.bind(),G.setColorMode(new h.a([Y.ONE,Y.ONE_MINUS_SRC_ALPHA,Y.ZERO,Y.ONE],h.C.transparent,[!0,!0,!0,!1])),G.setDepthMode(new h.b4(f.func===Y.LESS?Y.LEQUAL:f.func,h.b4.ReadOnly,f.range)),G.setStencilMode(h.b6.disabled);const oe=3*S.primitiveLength*2,_e=3*S.primitiveOffset*2*2;V&&V>1?Y.drawElementsInstanced(Y.LINES,oe,Y.UNSIGNED_SHORT,_e,V):Y.drawElements(Y.LINES,oe,Y.UNSIGNED_SHORT,_e),E.bind(),G.program.set(this.program),G.setDepthMode(f),G.setStencilMode(v),G.setColorMode(w)}draw(c,f,v,w,E,S,I,O,N,V,H,G,Y,ee,K,ne){const J=c.context,oe=J.gl;if(this.failedToCreate)return;J.program.set(this.program),J.setDepthMode(v),J.setStencilMode(w),J.setColorMode(E),J.setCullFace(S);for(const re of Object.keys(this.fixedUniforms))this.fixedUniforms[re].set(this.program,re,I[re]);ee&&ee.setUniforms(this.program,J,this.binderUniforms,G,{zoom:Y});const _e={[oe.LINES]:2,[oe.TRIANGLES]:3,[oe.LINE_STRIP]:1}[f],ye=ne&&ne>0?1:void 0;for(const re of H.get()){const ae=re.vaos||(re.vaos={});(ae[O]||(ae[O]=new Sm)).bind(J,this,N,ee?ee.getPaintVertexBuffers():[],V,re.vertexOffset,K||[],ye),ne&&ne>1?oe.drawElementsInstanced(f,re.primitiveLength*_e,oe.UNSIGNED_SHORT,re.primitiveOffset*_e*2,ne):oe.drawElements(f,re.primitiveLength*_e,oe.UNSIGNED_SHORT,re.primitiveOffset*_e*2),f===oe.TRIANGLES&&this._drawDebugWireframe(c,v,w,E,V,re,G,Y,ee,ne)}}}function ze(_,c){const f=Math.pow(2,c.tileID.overscaledZ),v=c.tileSize*Math.pow(2,_.transform.tileZoom)/f,w=v*(c.tileID.canonical.x+c.tileID.wrap*f),E=v*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture?c.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/h.ay(c,1,_.transform.tileZoom),u_pixel_coord_upper:[w>>16,E>>16],u_pixel_coord_lower:[65535&w,65535&E]}}const ic=h.m.create(),Jt=(_,c,f,v,w,E,S,I,O,N,V,H,G,Y,ee,K)=>{const ne=c.style.light,J=ne.properties.get("position"),oe=[J.x,J.y,J.z],_e=h.bx.create();"viewport"===ne.properties.get("anchor")&&(h.bx.fromRotation(_e,-c.transform.angle),h.v.transformMat3(oe,oe,_e));const ye=ne.properties.get("color"),re=c.transform,ae={u_matrix:_,u_lightpos:oe,u_lightintensity:ne.properties.get("intensity"),u_lightcolor:[ye.r,ye.g,ye.b],u_vertical_gradient:+f,u_opacity:v,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ic,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:w,u_edge_radius:E,u_flood_light_color:H,u_vertical_scale:G,u_flood_light_intensity:Y,u_ground_shadow_factor:ee,u_emissive_strength:K};return"globe"===re.projection.name&&(ae.u_tile_id=[S.canonical.x,S.canonical.y,1<<S.canonical.z],ae.u_zoom_transition=O,ae.u_inv_rot_matrix=V,ae.u_merc_center=N,ae.u_up_dir=re.projection.upVector(new h.t(0,0,0),N[0]*h.J,N[1]*h.J),ae.u_height_lift=I),ae},rc=(_,c,f)=>({u_matrix:_,u_edge_radius:c,u_vertical_scale:f}),Tu=(_,c,f,v,w,E,S,I,O,N,V,H,G,Y)=>{const ee=Jt(_,c,f,v,w,E,S,O,N,V,H,G,Y,1,[0,0,0],0),K={u_height_factor:-Math.pow(2,S.overscaledZ)/I.tileSize/8};return h.ak(ee,ze(c,I),K)},ga=(_,c)=>({u_matrix:_,u_emissive_strength:c}),Ih=(_,c,f,v)=>h.ak(ga(_,c),ze(f,v)),xd=(_,c,f)=>({u_matrix:_,u_world:f,u_emissive_strength:c}),Wf=(_,c,f,v,w)=>h.ak(Ih(_,c,f,v),{u_world:w}),_a=(_,c,f,v)=>{const w=h.J/f.tileSize;return{u_matrix:_,u_camera_to_center_distance:c.getCameraToCenterDistance(v),u_extrude_scale:[c.pixelsToGLUnits[0]/w,c.pixelsToGLUnits[1]/w]}},zc=(_,c,f=1)=>({u_matrix:_,u_color:c,u_overlay:0,u_overlay_scale:f}),ws=h.m.create(),Rs=(_,c,f,v,w,E,S)=>{const I=_.transform,O="globe"===I.projection.name,N=O?h.by(I.zoom,c.canonical)*I._pixelsPerMercatorPixel:h.ay(f,1,E),V={u_matrix:c.projMatrix,u_extrude_scale:N,u_intensity:S,u_inv_rot_matrix:ws,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(O){V.u_inv_rot_matrix=v,V.u_merc_center=w,V.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],V.u_zoom_transition=h.ao(I.zoom);const H=w[0]*h.J,G=w[1]*h.J;V.u_up_dir=I.projection.upVector(new h.t(0,0,0),H,G)}return V},ir=(_,c,f,v,w,E,S,I,O,N,V,H,G,Y,ee,K,ne,J,oe,_e,ye)=>{return{u_matrix:_,u_normalize_matrix:c,u_globe_matrix:f,u_merc_matrix:v,u_grid_matrix:w,u_tl_parent:E,u_scale_parent:N,u_fade_t:V.mix,u_opacity:V.opacity*H.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:H.paint.get("raster-brightness-min"),u_brightness_high:H.paint.get("raster-brightness-max"),u_saturation_factor:(ae=H.paint.get("raster-saturation"),ae>0?1-1/(1.001-ae):-ae),u_contrast_factor:(re=H.paint.get("raster-contrast"),re>0?1/(1-re):1+re),u_spin_weights:Cl(H.paint.get("raster-hue-rotate")),u_perspective_transform:G,u_raster_elevation:Y,u_zoom_transition:S,u_merc_center:I,u_cutoff_params:O,u_colorization_mix:wd(K,J),u_colorization_offset:Wa(ne,J),u_color_ramp:ee,u_texture_offset:[_e/(oe+2*_e),oe/(oe+2*_e)],u_texture_res:[oe+2*_e,oe+2*_e],u_emissive_strength:ye};var re,ae};function Cl(_){_*=Math.PI/180;const c=Math.sin(_),f=Math.cos(_);return[(2*f+1)/3,(-Math.sqrt(3)*c-f+1)/3,(Math.sqrt(3)*c-f+1)/3]}function wd([_,c,f,v],[w,E]){if(w===E)return[0,0,0,0];const S=(h.bz+3)/(h.bz+1)/(E-w);return[_*S,c*S,f*S,v*S]}function Wa(_,[c,f]){return c===f?0:((_-c)/(f-c)*(h.bz+3)-1)/(h.bz+1)}const Su=h.m.create(),Cs=(_,c,f,v,w,E,S,I,O,N,V,H,G,Y,ee,K,ne,J)=>{const oe=w.transform,_e={u_is_size_zoom_constant:+("constant"===_||"source"===_),u_is_size_feature_constant:+("constant"===_||"camera"===_),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:oe.getCameraToCenterDistance(K),u_rotate_symbol:+f,u_aspect_ratio:oe.width/oe.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:S,u_coord_matrix:I,u_is_text:+O,u_pitch_with_map:+v,u_texsize:N,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Su,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Su,u_up_vector:[0,-1,0],u_icon_transition:J||0,u_icon_saturation:ne};return"globe"===K.name&&(_e.u_tile_id=[V.canonical.x,V.canonical.y,1<<V.canonical.z],_e.u_zoom_transition=H,_e.u_inv_rot_matrix=Y,_e.u_merc_center=G,_e.u_camera_forward=oe._camera.forward(),_e.u_ecef_origin=h.bA(oe.globeMatrix,V.toUnwrapped()),_e.u_tile_matrix=Float32Array.from(oe.globeMatrix),_e.u_up_vector=ee),_e},El=(_,c,f,v,w,E,S,I,O,N,V,H,G,Y,ee,K,ne)=>h.ak(Cs(_,c,f,v,w,E,S,I,O,N,H,G,Y,ee,K,ne,1),{u_gamma_scale:v?w.transform.getCameraToCenterDistance(ne)*Math.cos(w.terrain?0:w.transform._pitch):1,u_device_pixel_ratio:h.a4.devicePixelRatio,u_is_halo:+V,undefined:void 0}),oc=(_,c,f,v,w,E,S,I,O,N,V,H,G,Y,ee,K)=>h.ak(El(_,c,f,v,w,E,S,I,!0,O,!0,V,H,G,Y,ee,K),{u_texsize_icon:N,u_texture_icon:1}),Mu=(_,c,f,v)=>({u_matrix:_,u_emissive_strength:c,u_opacity:f,u_color:v}),Za=(_,c,f,v,w,E,S)=>h.ak(function(I,O,N,V){const H=N.imageManager.getPattern(I.toString(),O),{width:G,height:Y}=N.imageManager.getPixelSize(O),ee=Math.pow(2,V.tileID.overscaledZ),K=V.tileSize*Math.pow(2,N.transform.tileZoom)/ee,ne=K*(V.tileID.canonical.x+V.tileID.wrap*ee),J=K*V.tileID.canonical.y;return{u_image:0,u_pattern_tl:H.tl,u_pattern_br:H.br,u_texsize:[G,Y],u_pattern_size:H.displaySize,u_tile_units_to_pixels:1/h.ay(V,1,N.transform.tileZoom),u_pixel_coord_upper:[ne>>16,J>>16],u_pixel_coord_lower:[65535&ne,65535&J]}}(w,E,v,S),{u_matrix:_,u_emissive_strength:c,u_opacity:f}),Do={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},Vc=(_,c,f,v,w,E,S,I,O,N,V,H,G=[0,0,0])=>{const Y=v.style.light,ee=Y.properties.get("position"),K=[-ee.x,-ee.y,ee.z],ne=h.bx.create();"viewport"===Y.properties.get("anchor")&&(h.bx.fromRotation(ne,-v.transform.angle),h.v.transformMat3(K,K,ne));const J="MASK"===N.alphaMode,oe=Y.properties.get("color"),_e=H.paint.get("model-ambient-occlusion-intensity"),ye=H.paint.get("model-color").constantOr(h.C.white),re=H.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:_,u_lighting_matrix:c,u_normal_matrix:f,u_lightpos:K,u_lightintensity:Y.properties.get("intensity"),u_lightcolor:[oe.r,oe.g,oe.b],u_camera_pos:G,u_opacity:w,u_baseTextureIsAlpha:0,u_alphaMask:+J,u_alphaCutoff:N.alphaCutoff,u_baseColorFactor:[E.r,E.g,E.b,E.a],u_emissiveFactor:[S[0],S[1],S[2],1],u_metallicFactor:I,u_roughnessFactor:O,u_baseColorTexture:Do.BaseColor,u_metallicRoughnessTexture:Do.MetallicRoughness,u_normalTexture:Do.Normal,u_occlusionTexture:Do.Occlusion,u_emissionTexture:Do.Emission,u_color_mix:[ye.r,ye.g,ye.b,re],u_aoIntensity:_e,u_emissive_strength:V}},Ks=new Float32Array(16),Au=(_,c=Ks,f=Ks)=>({u_matrix:_,u_instance:c,u_node_matrix:f}),Cd={fillExtrusion:_=>({u_matrix:new h.a_(_),u_lightpos:new h.b7(_),u_lightintensity:new h.b2(_),u_lightcolor:new h.b7(_),u_vertical_gradient:new h.b2(_),u_opacity:new h.b2(_),u_edge_radius:new h.b2(_),u_ao:new h.b0(_),u_tile_id:new h.b7(_),u_zoom_transition:new h.b2(_),u_inv_rot_matrix:new h.a_(_),u_merc_center:new h.b0(_),u_up_dir:new h.b7(_),u_height_lift:new h.b2(_),u_flood_light_color:new h.b7(_),u_vertical_scale:new h.b2(_),u_flood_light_intensity:new h.b2(_),u_ground_shadow_factor:new h.b7(_),u_emissive_strength:new h.b2(_)}),fillExtrusionDepth:_=>({u_matrix:new h.a_(_),u_edge_radius:new h.b2(_),u_vertical_scale:new h.b2(_)}),fillExtrusionPattern:_=>({u_matrix:new h.a_(_),u_lightpos:new h.b7(_),u_lightintensity:new h.b2(_),u_lightcolor:new h.b7(_),u_vertical_gradient:new h.b2(_),u_height_factor:new h.b2(_),u_edge_radius:new h.b2(_),u_ao:new h.b0(_),u_tile_id:new h.b7(_),u_zoom_transition:new h.b2(_),u_inv_rot_matrix:new h.a_(_),u_merc_center:new h.b0(_),u_up_dir:new h.b7(_),u_height_lift:new h.b2(_),u_image:new h.a$(_),u_texsize:new h.b0(_),u_pixel_coord_upper:new h.b0(_),u_pixel_coord_lower:new h.b0(_),u_tile_units_to_pixels:new h.b2(_),u_opacity:new h.b2(_)}),fillExtrusionGroundEffect:_=>({u_matrix:new h.a_(_),u_opacity:new h.b2(_),u_ao_pass:new h.b2(_),u_meter_to_tile:new h.b2(_),u_ao:new h.b0(_),u_flood_light_intensity:new h.b2(_),u_flood_light_color:new h.b7(_),u_attenuation:new h.b2(_),u_edge_radius:new h.b2(_),u_fb:new h.a$(_),u_fb_size:new h.b2(_)}),fill:_=>({u_matrix:new h.a_(_),u_emissive_strength:new h.b2(_)}),fillPattern:_=>({u_matrix:new h.a_(_),u_emissive_strength:new h.b2(_),u_image:new h.a$(_),u_texsize:new h.b0(_),u_pixel_coord_upper:new h.b0(_),u_pixel_coord_lower:new h.b0(_),u_tile_units_to_pixels:new h.b2(_)}),fillOutline:_=>({u_matrix:new h.a_(_),u_emissive_strength:new h.b2(_),u_world:new h.b0(_)}),fillOutlinePattern:_=>({u_matrix:new h.a_(_),u_emissive_strength:new h.b2(_),u_world:new h.b0(_),u_image:new h.a$(_),u_texsize:new h.b0(_),u_pixel_coord_upper:new h.b0(_),u_pixel_coord_lower:new h.b0(_),u_tile_units_to_pixels:new h.b2(_)}),circle:h.bB,collisionBox:_=>({u_matrix:new h.a_(_),u_camera_to_center_distance:new h.b2(_),u_extrude_scale:new h.b0(_)}),collisionCircle:_=>({u_matrix:new h.a_(_),u_inv_matrix:new h.a_(_),u_camera_to_center_distance:new h.b2(_),u_viewport_size:new h.b0(_)}),debug:_=>({u_color:new h.b1(_),u_matrix:new h.a_(_),u_overlay:new h.a$(_),u_overlay_scale:new h.b2(_)}),clippingMask:_=>({u_matrix:new h.a_(_)}),heatmap:_=>({u_extrude_scale:new h.b2(_),u_intensity:new h.b2(_),u_matrix:new h.a_(_),u_inv_rot_matrix:new h.a_(_),u_merc_center:new h.b0(_),u_tile_id:new h.b7(_),u_zoom_transition:new h.b2(_),u_up_dir:new h.b7(_)}),heatmapTexture:_=>({u_image:new h.a$(_),u_color_ramp:new h.a$(_),u_opacity:new h.b2(_)}),hillshade:_=>({u_matrix:new h.a_(_),u_image:new h.a$(_),u_latrange:new h.b0(_),u_light:new h.b0(_),u_shadow:new h.b1(_),u_highlight:new h.b1(_),u_emissive_strength:new h.b2(_),u_accent:new h.b1(_)}),hillshadePrepare:_=>({u_matrix:new h.a_(_),u_image:new h.a$(_),u_dimension:new h.b0(_),u_zoom:new h.b2(_)}),line:h.bC,linePattern:h.bD,raster:_=>({u_matrix:new h.a_(_),u_normalize_matrix:new h.a_(_),u_globe_matrix:new h.a_(_),u_merc_matrix:new h.a_(_),u_grid_matrix:new h.b8(_),u_tl_parent:new h.b0(_),u_scale_parent:new h.b2(_),u_fade_t:new h.b2(_),u_opacity:new h.b2(_),u_image0:new h.a$(_),u_image1:new h.a$(_),u_brightness_low:new h.b2(_),u_brightness_high:new h.b2(_),u_saturation_factor:new h.b2(_),u_contrast_factor:new h.b2(_),u_spin_weights:new h.b7(_),u_perspective_transform:new h.b0(_),u_raster_elevation:new h.b2(_),u_zoom_transition:new h.b2(_),u_merc_center:new h.b0(_),u_cutoff_params:new h.b9(_),u_colorization_mix:new h.b9(_),u_colorization_offset:new h.b2(_),u_color_ramp:new h.a$(_),u_texture_offset:new h.b0(_),u_texture_res:new h.b0(_),u_emissive_strength:new h.b2(_)}),symbolIcon:_=>({u_is_size_zoom_constant:new h.a$(_),u_is_size_feature_constant:new h.a$(_),u_size_t:new h.b2(_),u_size:new h.b2(_),u_camera_to_center_distance:new h.b2(_),u_rotate_symbol:new h.a$(_),u_aspect_ratio:new h.b2(_),u_fade_change:new h.b2(_),u_matrix:new h.a_(_),u_label_plane_matrix:new h.a_(_),u_coord_matrix:new h.a_(_),u_is_text:new h.a$(_),u_pitch_with_map:new h.a$(_),u_texsize:new h.b0(_),u_tile_id:new h.b7(_),u_zoom_transition:new h.b2(_),u_inv_rot_matrix:new h.a_(_),u_merc_center:new h.b0(_),u_camera_forward:new h.b7(_),u_tile_matrix:new h.a_(_),u_up_vector:new h.b7(_),u_ecef_origin:new h.b7(_),u_texture:new h.a$(_),u_icon_transition:new h.b2(_),u_icon_saturation:new h.b2(_)}),symbolSDF:_=>({u_is_size_zoom_constant:new h.a$(_),u_is_size_feature_constant:new h.a$(_),u_size_t:new h.b2(_),u_size:new h.b2(_),u_camera_to_center_distance:new h.b2(_),u_rotate_symbol:new h.a$(_),u_aspect_ratio:new h.b2(_),u_fade_change:new h.b2(_),u_matrix:new h.a_(_),u_label_plane_matrix:new h.a_(_),u_coord_matrix:new h.a_(_),u_is_text:new h.a$(_),u_pitch_with_map:new h.a$(_),u_texsize:new h.b0(_),u_texture:new h.a$(_),u_gamma_scale:new h.b2(_),u_device_pixel_ratio:new h.b2(_),u_tile_id:new h.b7(_),u_zoom_transition:new h.b2(_),u_inv_rot_matrix:new h.a_(_),u_merc_center:new h.b0(_),u_camera_forward:new h.b7(_),u_tile_matrix:new h.a_(_),u_up_vector:new h.b7(_),u_ecef_origin:new h.b7(_),u_is_halo:new h.a$(_)}),symbolTextAndIcon:_=>({u_is_size_zoom_constant:new h.a$(_),u_is_size_feature_constant:new h.a$(_),u_size_t:new h.b2(_),u_size:new h.b2(_),u_camera_to_center_distance:new h.b2(_),u_rotate_symbol:new h.a$(_),u_aspect_ratio:new h.b2(_),u_fade_change:new h.b2(_),u_matrix:new h.a_(_),u_label_plane_matrix:new h.a_(_),u_coord_matrix:new h.a_(_),u_is_text:new h.a$(_),u_pitch_with_map:new h.a$(_),u_texsize:new h.b0(_),u_texsize_icon:new h.b0(_),u_texture:new h.a$(_),u_texture_icon:new h.a$(_),u_gamma_scale:new h.b2(_),u_device_pixel_ratio:new h.b2(_),u_is_halo:new h.a$(_)}),background:_=>({u_matrix:new h.a_(_),u_emissive_strength:new h.b2(_),u_opacity:new h.b2(_),u_color:new h.b1(_)}),backgroundPattern:_=>({u_matrix:new h.a_(_),u_emissive_strength:new h.b2(_),u_opacity:new h.b2(_),u_image:new h.a$(_),u_pattern_tl:new h.b0(_),u_pattern_br:new h.b0(_),u_texsize:new h.b0(_),u_pattern_size:new h.b0(_),u_pixel_coord_upper:new h.b0(_),u_pixel_coord_lower:new h.b0(_),u_tile_units_to_pixels:new h.b2(_)}),terrainRaster:Ql,terrainDepth:Ql,skybox:_=>({u_matrix:new h.a_(_),u_sun_direction:new h.b7(_),u_cubemap:new h.a$(_),u_opacity:new h.b2(_),u_temporal_offset:new h.b2(_)}),skyboxGradient:_=>({u_matrix:new h.a_(_),u_color_ramp:new h.a$(_),u_center_direction:new h.b7(_),u_radius:new h.b2(_),u_opacity:new h.b2(_),u_temporal_offset:new h.b2(_)}),skyboxCapture:_=>({u_matrix_3f:new h.b8(_),u_sun_direction:new h.b7(_),u_sun_intensity:new h.b2(_),u_color_tint_r:new h.b9(_),u_color_tint_m:new h.b9(_),u_luminance:new h.b2(_)}),globeRaster:_=>({u_proj_matrix:new h.a_(_),u_globe_matrix:new h.a_(_),u_normalize_matrix:new h.a_(_),u_merc_matrix:new h.a_(_),u_zoom_transition:new h.b2(_),u_merc_center:new h.b0(_),u_image0:new h.a$(_),u_grid_matrix:new h.b8(_),u_skirt_height:new h.b2(_),u_frustum_tl:new h.b7(_),u_frustum_tr:new h.b7(_),u_frustum_br:new h.b7(_),u_frustum_bl:new h.b7(_),u_globe_pos:new h.b7(_),u_globe_radius:new h.b2(_),u_viewport:new h.b0(_)}),globeAtmosphere:_=>({u_frustum_tl:new h.b7(_),u_frustum_tr:new h.b7(_),u_frustum_br:new h.b7(_),u_frustum_bl:new h.b7(_),u_horizon:new h.b2(_),u_transition:new h.b2(_),u_fadeout_range:new h.b2(_),u_color:new h.b9(_),u_high_color:new h.b9(_),u_space_color:new h.b9(_),u_temporal_offset:new h.b2(_),u_horizon_angle:new h.b2(_)}),model:_=>({u_matrix:new h.a_(_),u_lighting_matrix:new h.a_(_),u_normal_matrix:new h.a_(_),u_lightpos:new h.b7(_),u_lightintensity:new h.b2(_),u_lightcolor:new h.b7(_),u_camera_pos:new h.b7(_),u_opacity:new h.b2(_),u_baseColorFactor:new h.b9(_),u_emissiveFactor:new h.b9(_),u_metallicFactor:new h.b2(_),u_roughnessFactor:new h.b2(_),u_baseTextureIsAlpha:new h.a$(_),u_alphaMask:new h.a$(_),u_alphaCutoff:new h.b2(_),u_baseColorTexture:new h.a$(_),u_metallicRoughnessTexture:new h.a$(_),u_normalTexture:new h.a$(_),u_occlusionTexture:new h.a$(_),u_emissionTexture:new h.a$(_),u_color_mix:new h.b9(_),u_aoIntensity:new h.b2(_),u_emissive_strength:new h.b2(_)}),modelDepth:_=>({u_matrix:new h.a_(_),u_instance:new h.a_(_),u_node_matrix:new h.a_(_)}),groundShadow:_=>({u_matrix:new h.a_(_),u_ground_shadow_factor:new h.b7(_)}),stars:_=>({u_matrix:new h.a_(_),u_up:new h.b7(_),u_right:new h.b7(_),u_intensity_multiplier:new h.b2(_)})};let jc;function Iu(_,c,f,v,w,E,S){const I=_.context,O=I.gl,N=_.transform,V=_.getOrCreateProgram("collisionBox"),H=[];let G=0,Y=0;for(let ye=0;ye<v.length;ye++){const re=v[ye],ae=c.getTile(re),be=ae.getBucket(f);if(!be)continue;const Se=hd(re,be,N);let Ce=Se;0===w[0]&&0===w[1]||(Ce=_.translatePosMatrix(Se,ae,w,E));const ke=S?be.textCollisionBox:be.iconCollisionBox,lt=be.collisionCircleArray;if(lt.length>0){const $e=h.m.create(),Qe=Ce;h.m.mul($e,be.placementInvProjMatrix,N.glCoordMatrix),h.m.mul($e,$e,be.placementViewportMatrix),H.push({circleArray:lt,circleOffset:Y,transform:Qe,invTransform:$e,projection:be.getProjection()}),G+=lt.length/4,Y=G}ke&&(_.terrain&&_.terrain.setupElevationDraw(ae,V),V.draw(_,O.LINES,h.b4.disabled,h.b6.disabled,_.colorModeForRenderPass(),h.b5.disabled,_a(Ce,N,ae,be.getProjection()),f.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,null,N.zoom,null,[ke.collisionVertexBuffer,ke.collisionVertexBufferExt]))}if(!S||!H.length)return;const ee=_.getOrCreateProgram("collisionCircle"),K=new h.bE;K.resize(4*G),K._trim();let ne=0;for(const ye of H)for(let re=0;re<ye.circleArray.length/4;re++){const ae=4*re,be=ye.circleArray[ae+0],Se=ye.circleArray[ae+1],Ce=ye.circleArray[ae+2],ke=ye.circleArray[ae+3];K.emplace(ne++,be,Se,Ce,ke,0),K.emplace(ne++,be,Se,Ce,ke,1),K.emplace(ne++,be,Se,Ce,ke,2),K.emplace(ne++,be,Se,Ce,ke,3)}(!jc||jc.length<2*G)&&(jc=function(ye){const re=2*ye,ae=new h.bp;ae.resize(re),ae._trim();for(let be=0;be<re;be++){const Se=6*be;ae.uint16[Se+0]=4*be+0,ae.uint16[Se+1]=4*be+1,ae.uint16[Se+2]=4*be+2,ae.uint16[Se+3]=4*be+2,ae.uint16[Se+4]=4*be+3,ae.uint16[Se+5]=4*be+0}return ae}(G));const J=I.createIndexBuffer(jc,!0),oe=I.createVertexBuffer(K,h.bF.members,!0);for(const ye of H){const re={u_matrix:ye.transform,u_inv_matrix:ye.invTransform,u_camera_to_center_distance:(_e=N).getCameraToCenterDistance(ye.projection),u_viewport_size:[_e.width,_e.height]};ee.draw(_,O.TRIANGLES,h.b4.disabled,h.b6.disabled,_.colorModeForRenderPass(),h.b5.disabled,re,f.id,oe,J,h.bm.simpleSegment(0,2*ye.circleOffset,ye.circleArray.length,ye.circleArray.length/2),null,N.zoom)}var _e;oe.destroy(),J.destroy()}const Ed=h.m.create();function ku({width:_,height:c,anchor:f,textOffset:v,textScale:w},E){const{horizontalAlign:S,verticalAlign:I}=h.aY(f),O=-(S-.5)*_,N=-(I-.5)*c,V=h.aW(f,v);return new h.P((O/w+V[0])*E,(N/w+V[1])*E)}function rs(_,c,f,v,w,E,S,I,O,N,V){const H=_.text.placedSymbolArray,G=_.text.dynamicLayoutVertexArray,Y=_.icon.dynamicLayoutVertexArray,ee={},K=_.getProjection(),ne=yt(I,K,E),J=E.elevation,oe=K.upVectorScale(I.canonical,E.center.lat,E.worldSize).metersToTile;G.clear();for(let _e=0;_e<H.length;_e++){const ye=H.get(_e),{tileAnchorX:re,tileAnchorY:ae,numGlyphs:be}=ye,Se=ye.hidden||!ye.crossTileID||_.allowVerticalPlacement&&!ye.placedOrientation?null:v[ye.crossTileID];if(Se){let Ce=0,ke=0,lt=0;if(J){const At=J?J.getAtTileOffset(I,re,ae):0,[vt,an,Xt]=K.upVector(I.canonical,re,ae);Ce=At*vt*oe,ke=At*an*oe,lt=At*Xt*oe}let[$e,Qe,Fe,ot]=co(ye.projectedAnchorX+Ce,ye.projectedAnchorY+ke,ye.projectedAnchorZ+lt,f?ne:S);const Ke=ut(E.getCameraToCenterDistance(K),ot);let Ue=w.evaluateSizeForFeature(_.textSizeData,N,ye)*Ke/h.aV;f&&(Ue*=_.tilePixelRatio/O);const fe=ku(Se,Ue);f?(({x:$e,y:Qe,z:Fe}=K.projectTilePoint(re+fe.x,ae+fe.y,I.canonical)),[$e,Qe,Fe]=co($e+Ce,Qe+ke,Fe+lt,S)):(c&&fe._rotate(-E.angle),$e+=fe.x,Qe+=fe.y,Fe=0);const Ne=_.allowVerticalPlacement&&ye.placedOrientation===h.W.vertical?Math.PI/2:0;for(let At=0;At<be;At++)h.k(G,$e,Qe,Fe,Ne);V&&ye.associatedIconIndex>=0&&(ee[ye.associatedIconIndex]={x:$e,y:Qe,z:Fe,angle:Ne})}else Rt(be,G)}if(V){Y.clear();const _e=_.icon.placedSymbolArray;for(let ye=0;ye<_e.length;ye++){const re=_e.get(ye),{numGlyphs:ae}=re,be=ee[ye];if(re.hidden||!be)Rt(ae,Y);else{const{x:Se,y:Ce,z:ke,angle:lt}=be;for(let $e=0;$e<ae;$e++)h.k(Y,Se,Ce,ke,lt)}}_.icon.dynamicLayoutVertexBuffer.updateData(Y)}_.text.dynamicLayoutVertexBuffer.updateData(G)}function kh(_,c,f){return f.iconsInText&&c?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function oi(_,c,f,v,w,E,S,I,O,N,V,H,G){const Y=_.context,ee=Y.gl,K=_.transform,ne="map"===I,J="map"===O,oe=ne&&"point"!==f.layout.get("symbol-placement"),_e=ne&&!J&&!oe,ye=void 0!==f.layout.get("symbol-sort-key").constantOr(1);let re=!1;const ae=_.depthModeForSublayer(0,h.b4.ReadOnly),be=[h.E(K.center.lng),h.H(K.center.lat)],Se=f.layout.get("text-variable-anchor"),Ce="globe"===K.projection.name,ke=[],lt=[0,-1,0];let $e=lt;!Ce&&!K.mercatorFromTransition||ne||($e=function(Qe){const Fe=Qe._camera.getWorldToCamera(Qe.worldSize,1),ot=h.m.multiply([],Fe,Qe.globeMatrix);h.m.invert(ot,ot);const Ke=[0,0,0],Ue=[0,1,0,0];return h.e.transformMat4(Ue,Ue,ot),Ke[0]=Ue[0],Ke[1]=Ue[1],Ke[2]=Ue[2],h.v.normalize(Ke,Ke),Ke}(K));for(const Qe of v){const Fe=c.getTile(Qe),ot=Fe.getBucket(f);if(!ot||"mercator"===ot.projection.name&&Ce)continue;const Ke=w?ot.text:ot.icon;if(!Ke||ot.fullyClipped||!Ke.segments.get().length)continue;const Ue=Ke.programConfigurations.get(f.id),fe=w||ot.sdfIcons,Ne=w?ot.textSizeData:ot.iconSizeData,At=J||0!==K.pitch,vt=h.i(Ne,K.zoom);let an,Xt,mn,nn,Rn=[0,0],Pn=null;if(w)Xt=Fe.glyphAtlasTexture?Fe.glyphAtlasTexture:null,mn=ee.LINEAR,an=Fe.glyphAtlasTexture?Fe.glyphAtlasTexture.size:[0,0],ot.iconsInText&&(Rn=Fe.imageAtlasTexture?Fe.imageAtlasTexture.size:[0,0],Pn=Fe.imageAtlasTexture?Fe.imageAtlasTexture:null,nn=At||_.options.rotating||_.options.zooming||"composite"===Ne.kind||"camera"===Ne.kind?ee.LINEAR:ee.NEAREST);else{const rr=1!==f.layout.get("icon-size").constantOr(0)||ot.iconsNeedLinear;Xt=Fe.imageAtlasTexture?Fe.imageAtlasTexture:null,mn=fe||_.options.rotating||_.options.zooming||rr||At?ee.LINEAR:ee.NEAREST,an=Fe.imageAtlasTexture?Fe.imageAtlasTexture.size:[0,0]}const gn="globe"===ot.projection.name,_n=gn?$e:lt,mt=gn?h.ao(K.zoom):0,un=yt(Qe,ot.getProjection(),K),Mn=K.calculatePixelsToTileUnitsMatrix(Fe),Cn=Mo(un,Fe.tileID.canonical,J,ne,K,ot.getProjection(),Mn),hr=_.terrain&&J&&oe?h.m.invert(h.m.create(),Cn):Ed,na=ha(un,Fe.tileID.canonical,J,ne,K,ot.getProjection(),Mn),zi=Se&&ot.hasTextData(),ci=ot.hasIconTextFit()&&zi&&ot.hasIconData();if(oe){const rr=K.elevation,Ca=rr?rr.getAtTileOffsetFunc(Qe,K.center.lat,K.worldSize,ot.getProjection()):null,kl=Zs(un,Fe.tileID.canonical,J,ne,K,ot.getProjection(),Mn);Dt(ot,un,_,w,kl,na,J,N,Ca,Qe)}const Ni=oe||w&&Se||ci,fr=_.translatePosMatrix(un,Fe,E,S),No=Ni?Ed:Cn,yr=_.translatePosMatrix(na,Fe,E,S,!0),Wo=ot.getProjection().createInversionMatrix(K,Qe.canonical),Er=f.paint.get("icon-image-cross-fade").constantOr(0),Yr=[];_.terrainRenderModeElevated()&&J&&Yr.push("PITCH_WITH_MAP_TERRAIN"),gn&&(Yr.push("PROJECTION_GLOBE_VIEW"),Ni&&Yr.push("PROJECTED_POS_ON_VIEWPORT")),Er>0&&Yr.push("ICON_TRANSITION"),Ke.zOffsetVertexBuffer&&Yr.push("Z_OFFSET");const ia=fe&&0!==f.paint.get(w?"text-halo-width":"icon-halo-width").constantOr(1);let Os;fe?Os=ot.iconsInText?oc(Ne.kind,vt,_e,J,_,fr,No,yr,an,Rn,Qe,mt,be,Wo,_n,ot.getProjection()):El(Ne.kind,vt,_e,J,_,fr,No,yr,w,an,!0,Qe,mt,be,Wo,_n,ot.getProjection()):(V<1&&Yr.push("SATURATION"),Os=Cs(Ne.kind,vt,_e,J,_,fr,No,yr,w,an,Qe,mt,be,Wo,_n,ot.getProjection(),V,Er));const Bo={program:_.getOrCreateProgram(kh(fe,w,ot),{config:Ue,defines:Yr}),buffers:Ke,uniformValues:Os,atlasTexture:Xt,atlasTextureIcon:Pn,atlasInterpolation:mn,atlasInterpolationIcon:nn,isSDF:fe,hasHalo:ia,tile:Fe,labelPlaneMatrixInv:hr};if(ye&&ot.canOverlap){re=!0;const rr=Ke.segments.get();for(const Ca of rr)ke.push({segments:new h.bm([Ca]),sortKey:Ca.sortKey,state:Bo})}else ke.push({segments:Ke.segments,sortKey:0,state:Bo})}re&&ke.sort((Qe,Fe)=>Qe.sortKey-Fe.sortKey);for(const Qe of ke){const Fe=Qe.state;if(_.terrain&&_.terrain.setupElevationDraw(Fe.tile,Fe.program,{useDepthForOcclusion:K.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Fe.labelPlaneMatrixInv}),Y.activeTexture.set(ee.TEXTURE0),Fe.atlasTexture&&Fe.atlasTexture.bind(Fe.atlasInterpolation,ee.CLAMP_TO_EDGE,!0),Fe.atlasTextureIcon&&(Y.activeTexture.set(ee.TEXTURE1),Fe.atlasTextureIcon&&Fe.atlasTextureIcon.bind(Fe.atlasInterpolationIcon,ee.CLAMP_TO_EDGE,!0)),_.uploadCommonLightUniforms(_.context,Fe.program),Fe.hasHalo){const ot=Fe.uniformValues;ot.u_is_halo=1,Dd(Fe.buffers,Qe.segments,f,_,Fe.program,ae,H,G,ot,2),ot.u_is_halo=0}else{if(Fe.isSDF){const ot=Fe.uniformValues;Fe.hasHalo&&(ot.u_is_halo=1,Dd(Fe.buffers,Qe.segments,f,_,Fe.program,ae,H,G,ot,1)),ot.u_is_halo=0}Dd(Fe.buffers,Qe.segments,f,_,Fe.program,ae,H,G,Fe.uniformValues,1)}}}function Dd(_,c,f,v,w,E,S,I,O,N){const V=[_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer,_.iconTransitioningVertexBuffer,_.globeExtVertexBuffer,_.zOffsetVertexBuffer];w.draw(v,v.context.gl.TRIANGLES,E,S,I,h.b5.disabled,O,f.id,_.layoutVertexBuffer,_.indexBuffer,c,f.paint,v.transform.zoom,_.programConfigurations.get(f.id),V,N)}function Ru(_,c,f,v,w,E,S){const I=_.context.gl,O=f.paint.get("fill-pattern"),N=O&&O.constantOr(1);let V,H,G,Y,ee;S?(H=N&&!f.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=I.LINES):(H=N?"fillPattern":"fill",V=I.TRIANGLES);for(const K of v){const ne=c.getTile(K);if(N&&!ne.patternsLoaded())continue;const J=ne.getBucket(f);if(!J)continue;_.prepareDrawTile();const oe=J.programConfigurations.get(f.id),_e=_.isTileAffectedByFog(K),ye=_.getOrCreateProgram(H,{config:oe,overrideFog:_e});N&&(_.context.activeTexture.set(I.TEXTURE0),ne.imageAtlasTexture&&ne.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),oe.updatePaintBuffers());const re=O.constantOr(null);if(re&&ne.imageAtlas){const Se=ne.imageAtlas.patternPositions[re.toString()];Se&&oe.setConstantPatternPositions(Se)}const ae=_.translatePosMatrix(K.projMatrix,ne,f.paint.get("fill-translate"),f.paint.get("fill-translate-anchor")),be=f.paint.get("fill-emissive-strength");if(S){Y=J.indexBuffer2,ee=J.segments2;const Se=_.terrain&&_.terrain.renderingToTexture?_.terrain.drapeBufferSize:[I.drawingBufferWidth,I.drawingBufferHeight];G="fillOutlinePattern"===H&&N?Wf(ae,be,_,ne,Se):xd(ae,be,Se)}else Y=J.indexBuffer,ee=J.segments,G=N?Ih(ae,be,_,ne):ga(ae,be);_.uploadCommonUniforms(_.context,ye,K.toUnwrapped()),ye.draw(_,V,w,_.stencilModeForClipping(K),E,h.b5.disabled,G,f.id,J.layoutVertexBuffer,Y,ee,f.paint,_.transform.zoom,oe,void 0)}}function Dl(_,c,f,v,w,E,S,I){f.resetLayerRenderingStats();const O=_.context,N=O.gl,V=_.transform,H=f.paint.get("fill-extrusion-pattern"),G=H.constantOr(1),Y=f.paint.get("fill-extrusion-opacity"),ee=_.style.enable3dLights(),K=f.paint.get(ee&&!G?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),ne=[f.paint.get("fill-extrusion-ambient-occlusion-intensity"),K],J=f.layout.get("fill-extrusion-edge-radius"),oe=J>0&&!f.paint.get("fill-extrusion-rounded-roof"),_e=oe?0:J,ye="globe"===V.projection.name?h.bO():0,re="globe"===V.projection.name,ae=re?h.ao(V.zoom):0,be=[h.E(V.center.lng),h.H(V.center.lat)],Se=f.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),Ce=f.paint.get("fill-extrusion-flood-light-intensity"),ke=f.paint.get("fill-extrusion-vertical-scale"),lt=Nc(_,f.paint.get("fill-extrusion-cutoff-fade-range")),$e=f.paint.get("fill-extrusion-emissive-strength"),Qe=[];let Fe;re&&Qe.push("PROJECTION_GLOBE_VIEW"),ne[0]>0&&Qe.push("FAUX_AO"),oe&&Qe.push("ZERO_ROOF_RADIUS"),I&&Qe.push("HAS_CENTROID"),Ce>0&&Qe.push("FLOOD_LIGHT"),lt.shouldRenderCutoff&&Qe.push("RENDER_CUTOFF");const ot="shadow"===_.renderPass,Ke=_.shadowRenderer,Ue=ot&&!!Ke;_.shadowRenderer&&(_.shadowRenderer.useNormalOffset=!0);let fe=[0,0,0];if(Ke){const vt=_.style.directionalLight,an=_.style.ambientLight;vt&&an&&(fe=Li(vt,an)),Fe=Qe.concat(["SHADOWS_SINGLE_CASCADE"])}const Ne=Ue?"fillExtrusionDepth":G?"fillExtrusionPattern":"fillExtrusion",At=f.getLayerRenderingStats();for(const vt of v){const an=c.getTile(vt),Xt=an.getBucket(f);if(!Xt||Xt.projection.name!==V.projection.name)continue;let mn=!1;Ke&&(mn=0===Ke.getMaxCascadeForTile(vt.toUnwrapped()));const nn=_.isTileAffectedByFog(vt),Rn=Xt.programConfigurations.get(f.id),Pn=_.getOrCreateProgram(Ne,{config:Rn,defines:mn?Fe:Qe,overrideFog:nn});if(_.terrain&&_.terrain.setupElevationDraw(an,Pn,{useMeterToDem:!0}),!Xt.centroidVertexBuffer){const Cn=Pn.attributes.a_centroid_pos;void 0!==Cn&&N.vertexAttrib2f(Cn,0,0)}!ot&&Ke&&Ke.setupShadows(an.tileID.toUnwrapped(),Pn,"vector-tile",an.tileID.overscaledZ),G&&(_.context.activeTexture.set(N.TEXTURE0),an.imageAtlasTexture&&an.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),Rn.updatePaintBuffers());const gn=H.constantOr(null);if(gn&&an.imageAtlas){const Cn=an.imageAtlas.patternPositions[gn.toString()];Cn&&Rn.setConstantPatternPositions(Cn)}const _n=f.paint.get("fill-extrusion-vertical-gradient");let mt;if(ot&&Ke){if(Ci(an.tileID,Xt,_))continue;const Cn=Ke.calculateShadowPassMatrixFromTile(an.tileID.toUnwrapped());mt=rc(Cn,_e,ke)}else{const Cn=_.translatePosMatrix(vt.expandedProjMatrix,an,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),hr=V.projection.createInversionMatrix(V,vt.canonical);mt=G?Tu(Cn,_,_n,Y,ne,_e,vt,an,ye,ae,be,hr,Se,ke):Jt(Cn,_,_n,Y,ne,_e,vt,ye,ae,be,hr,Se,ke,Ce,fe,$e)}_.uploadCommonUniforms(O,Pn,vt.toUnwrapped(),null,lt);let un=Xt.segments;if("mercator"===V.projection.name&&!ot&&(un=Xt.getVisibleSegments(an.tileID,_.terrain,_.transform.getFrustum(0)),!un.get().length))continue;if(At)if(ot)for(const Cn of un.get())At.numRenderedVerticesInShadowPass+=Cn.primitiveLength;else for(const Cn of un.get())At.numRenderedVerticesInTransparentPass+=Cn.primitiveLength;const Mn=[];(_.terrain||I)&&Mn.push(Xt.centroidVertexBuffer),re&&Mn.push(Xt.layoutVertexExtBuffer),Pn.draw(_,O.gl.TRIANGLES,w,E,S,h.b5.backCCW,mt,f.id,Xt.layoutVertexBuffer,Xt.indexBuffer,un,f.paint,_.transform.zoom,Rn,Mn)}_.shadowRenderer&&(_.shadowRenderer.useNormalOffset=!1)}function sc(_,c,f,v,w,E,S,I,O,N,V,H,G,Y,ee,K,ne,J,oe){const _e=_.context,ye=_e.gl,re=_.transform,ae=_.transform.zoom,be=[],Se=Nc(_,f.paint.get("fill-extrusion-cutoff-fade-range"));"clear"===N?(be.push("CLEAR_SUBPASS"),oe&&(be.push("CLEAR_FROM_TEXTURE"),_e.activeTexture.set(ye.TEXTURE0),oe.bind(ye.LINEAR,ye.CLAMP_TO_EDGE))):"sdf"===N&&be.push("SDF_SUBPASS"),ne&&be.push("HAS_CENTROID"),Se.shouldRenderCutoff&&be.push("RENDER_CUTOFF");const Ce=f.layout.get("fill-extrusion-edge-radius"),ke=(lt,$e,Qe,Fe,ot)=>{const Ke=$e.programConfigurations.get(f.id),Ue=_.isTileAffectedByFog(lt),fe=_.getOrCreateProgram("fillExtrusionGroundEffect",{config:Ke,defines:be,overrideFog:Ue}),Ne={u_matrix:Fe,u_opacity:V,u_ao_pass:O?1:0,u_meter_to_tile:ot,u_ao:[H,G*ot],u_flood_light_intensity:Y,u_flood_light_color:ee,u_attenuation:K,u_edge_radius:ae>=17?0:Ce*ot,u_fb:0,u_fb_size:oe?oe.size[0]:0},At=[];ne&&At.push($e.hiddenByLandmarkVertexBuffer),_.uploadCommonUniforms(_e,fe,lt.toUnwrapped(),null,Se),fe.draw(_,_e.gl.TRIANGLES,w,E,S,I,Ne,f.id,$e.vertexBuffer,$e.indexBuffer,Qe,f.paint,ae,Ke,At)};for(const lt of v){const $e=c.getTile(lt),Qe=$e.getBucket(f);if(!Qe||Qe.projection.name!==re.projection.name||!Qe.groundEffect||Qe.groundEffect&&!Qe.groundEffect.hasData())continue;const Fe=Qe.groundEffect,ot=1/Qe.tileToMeter;{const Ke=_.translatePosMatrix(lt.projMatrix,$e,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),Ue=Fe.getDefaultSegment();ke(lt,Fe,Ue,Ke,ot)}if(J)for(let Ke=0;Ke<4;Ke++){const Ue=h.bP[Ke](lt),fe=c.getTile(Ue);if(!fe)continue;const Ne=fe.getBucket(f);if(!Ne||Ne.projection.name!==re.projection.name||!Ne.groundEffect||Ne.groundEffect&&!Ne.groundEffect.hasData())continue;const At=Ne.groundEffect;let vt,an;0===Ke?(vt=[-h.J,0,0],an=1):1===Ke?(vt=[h.J,0,0],an=0):2===Ke?(vt=[0,-h.J,0],an=3):(vt=[0,h.J,0],an=2);const Xt=At.regionSegments[an];if(!Xt)continue;const mn=new Float32Array(16);h.m.translate(mn,lt.projMatrix,vt),ke(lt,At,Xt,_.translatePosMatrix(mn,$e,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),ot)}}}function Rh(_,c,f,v,w,E,S){0===v.centroidVertexArray.length&&v.createCentroidsBuffer();const I=E?E.findDEMTileFor(f):null;if(!(I&&I.dem||S))return;const O=J=>new h.P(Math.ceil((J+h.bS)*h.bT),0),N=J=>{const oe=c.getSource().minzoom,_e=re=>{const ae=c.getTileByID(re);if(ae&&ae.hasData())return ae.getBucket(w)},ye=[0,-1,1];for(const re of ye){if(J.overscaledZ+re<oe)continue;const ae=_e(J.calculateScaledKey(J.overscaledZ+re));if(ae)return ae}},V=[0,0,0],H=(J,oe)=>(V[0]=Math.min(J.min.y,oe.min.y),V[1]=Math.max(J.max.y,oe.max.y),V[2]=h.J-oe.min.x>J.max.x?oe.min.x-h.J:J.max.x,V),G=(J,oe)=>(V[0]=Math.min(J.min.x,oe.min.x),V[1]=Math.max(J.max.x,oe.max.x),V[2]=h.J-oe.min.y>J.max.y?oe.min.y-h.J:J.max.y,V),Y=[(J,oe)=>H(J,oe),(J,oe)=>H(oe,J),(J,oe)=>G(J,oe),(J,oe)=>G(oe,J)],ee=(J,oe,_e,ye,re,ae,be)=>{if(!E)return 0;const Se=[[ae?_e:J,ae?J:_e,0],[ae?_e:oe,ae?oe:_e,0]],Ce=be<0?h.J+be:be,ke=[ae?Ce:(J+oe)/2,ae?(J+oe)/2:Ce,0];return 0===_e&&be<0||0!==_e&&be>0?E.getForTilePoints(re,[ke],!0,ye):Se.push(ke),E.getForTilePoints(f,Se,!0,I),Math.max(Se[0][2],Se[1][2],ke[2])/E.exaggeration()};for(let J=0;J<4;J++){const oe=v.borderFeatureIndices[J];if(0===oe.length)continue;const _e=h.bP[J](f),ye=N(_e);if(!(ye&&ye instanceof h.bQ)||v.borderDoneWithNeighborZ[J]===ye.canonical.z)continue;0===ye.centroidVertexArray.length&&ye.createCentroidsBuffer();const re=E?E.findDEMTileFor(_e):null;if(!(re&&re.dem||S))continue;const ae=(J<2?1:5)-J,be=ye.borderDoneWithNeighborZ[ae]!==v.canonical.z,Se=ye.borderFeatureIndices[ae];let Ce=0;if(v.canonical.z!==ye.canonical.z){for(const ke of oe)v.showCentroid(v.featuresOnBorder[ke]);if(be)for(const ke of Se)ye.showCentroid(ye.featuresOnBorder[ke]);v.borderDoneWithNeighborZ[J]=ye.canonical.z,ye.borderDoneWithNeighborZ[ae]=v.canonical.z}for(const ke of oe){const lt=v.featuresOnBorder[ke],$e=v.centroidData[lt.centroidDataIndex],Qe=lt.borders[J];let Fe;for(;Ce<Se.length;){Fe=ye.featuresOnBorder[Se[Ce]];const ot=Fe.borders[ae];if(ot[1]>Qe[0]+3||ot[0]>Qe[0]-3)break;ye.showCentroid(Fe),Ce++}if(Fe&&Ce<Se.length){const ot=Ce;let Ke=0;for(;!(Fe.borders[ae][0]>Qe[1]-3)&&(Ke++,++Ce!==Se.length);)Fe=ye.featuresOnBorder[Se[Ce]];if(Fe=ye.featuresOnBorder[Se[ot]],Ke>1){const Ne=Fe.borders[ae];Math.abs(Qe[0]-Ne[0])<3&&Math.abs(Qe[1]-Ne[1])<3&&(Ke=1,Ce=ot+1)}else if(0===Ke){v.showCentroid(lt);continue}const Ue=ye.centroidData[Fe.centroidDataIndex];S&&1===Ke&&(((K=$e).flags|(ne=Ue).flags)&h.bR?(K.flags|=h.bR,ne.flags|=h.bR):(K.flags&=~h.bR,ne.flags&=~h.bR));const fe=lt.intersectsCount()>1||Fe.intersectsCount()>1;if(Ke>1)Ce=ot,$e.centroidXY=Ue.centroidXY=new h.P(0,0);else if(re&&re.dem&&!fe){const Ne=Y[J]($e,Ue),At=J%2?h.J-1:0,vt=ee(Ne[0],Math.min(h.J-1,Ne[1]),At,re,_e,J<2,Ne[2]);$e.centroidXY=Ue.centroidXY=O(vt)}else fe?$e.centroidXY=Ue.centroidXY=new h.P(0,0):($e.centroidXY=v.encodeBorderCentroid(lt),Ue.centroidXY=ye.encodeBorderCentroid(Fe));v.writeCentroidToBuffer($e),ye.writeCentroidToBuffer(Ue)}else v.showCentroid(lt)}v.borderDoneWithNeighborZ[J]=ye.canonical.z,ye.borderDoneWithNeighborZ[ae]=v.canonical.z}var K,ne;(v.needsCentroidUpdate||!v.centroidVertexBuffer&&0!==v.centroidVertexArray.length)&&v.uploadCentroid(_)}const Uc=[1,0,0],Zf=[0,1,0],Yf=[0,0,1];function Ci(_,c,f){const v=f.transform,w=f.shadowRenderer;if(!w)return!0;const E=_.toUnwrapped(),S=v.tileSize*w._cascades[f.currentShadowCascade].scale;let I=c.maxHeight;if(v.elevation){const K=v.elevation.getMinMaxForTile(_);K&&(I+=K.max)}const O=[...w.shadowDirection];O[2]=-O[2];const N=w.computeSimplifiedTileShadowVolume(E,I,S,O);if(!N)return!1;const V=[Uc,Zf,Yf,O,[O[0],0,O[2]],[0,O[1],O[2]]],H="globe"===v.projection.name,G=v.scaleZoom(S),Y=h.F.fromInvProjectionMatrix(v.invProjMatrix,v.worldSize,G,!H),ee=w.getCurrentCascadeFrustum();return 0===Y.intersectsPrecise(N.vertices,N.planes,V)||0===ee.intersectsPrecise(N.vertices,N.planes,V)}function Mm(_){const c=_._nearZ,f=_.projection.farthestPixelDistance(_),v=f-c,w=.2*_.height,E=c+w;return[c,f,(E-w-c)/v,(E-c)/v]}const Ph=new h.C(1,0,0,1),Oh=new h.C(0,1,0,1),Ji=new h.C(0,0,1,1),Td=new h.C(1,0,1,1),Fh=new h.C(0,1,1,1);function Bn(_,c,f,v,w,E){const S=_.context,I=_.transform,O=S.gl,N="globe"===I.projection.name,V=N?["PROJECTION_GLOBE_VIEW"]:[];let H=h.m.clone(f.projMatrix);if(N&&h.ao(I.zoom)>0){const Fe=h.bU(f.canonical,I),ot=h.bV(Fe);H=h.m.multiply(new Float32Array(16),I.globeMatrix,ot),h.m.multiply(H,I.projMatrix,H)}const G=h.m.create();G[12]+=2*w/(h.a4.devicePixelRatio*I.width),G[13]+=2*E/(h.a4.devicePixelRatio*I.height),h.m.multiply(H,G,H);const Y=_.getOrCreateProgram("debug",{defines:V}),ee=c.getTileByID(f.key);_.terrain&&_.terrain.setupElevationDraw(ee,Y);const K=h.b4.disabled,ne=h.b6.disabled,J=_.colorModeForRenderPass();S.activeTexture.set(O.TEXTURE0),_.emptyTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),N?ee._makeGlobeTileDebugBuffers(_.context,I):ee._makeDebugTileBoundsBuffers(_.context,I.projection);const _e=ee._tileDebugBuffer||_.debugBuffer,ye=ee._tileDebugIndexBuffer||_.debugIndexBuffer,re=ee._tileDebugSegments||_.debugSegments;Y.draw(_,O.LINE_STRIP,K,ne,J,h.b5.disabled,zc(H,v),"$debug",_e,ye,re,null,null,null,[ee._globeTileDebugBorderBuffer]);const ae=ee.latestRawTileData,be=Math.floor((ae&&ae.byteLength||0)/1024),Se=c.getTile(f).tileSize,Ce=512/Math.min(Se,512)*(f.overscaledZ/I.zoom)*.5;let ke=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(ke+=` => ${f.overscaledZ}`),ke+=` ${be}kb`,function(Fe,ot){Fe.initDebugOverlayCanvas();const Ke=Fe.debugOverlayCanvas,Ue=Fe.context.gl,fe=Fe.debugOverlayCanvas.getContext("2d");fe.clearRect(0,0,Ke.width,Ke.height),fe.shadowColor="white",fe.shadowBlur=2,fe.lineWidth=1.5,fe.strokeStyle="white",fe.textBaseline="top",fe.font="bold 36px Open Sans, sans-serif",fe.fillText(ot,5,5),fe.strokeText(ot,5,5),Fe.debugOverlayTexture.update(Ke),Fe.debugOverlayTexture.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE)}(_,ke);const lt=ee._tileDebugTextBuffer||_.debugBuffer,$e=ee._tileDebugTextIndexBuffer||_.quadTriangleIndexBuffer,Qe=ee._tileDebugTextSegments||_.debugSegments;Y.draw(_,O.TRIANGLES,K,ne,h.a.alphaBlended,h.b5.disabled,zc(H,h.C.transparent,Ce),"$debug",lt,$e,Qe,null,null,null,[ee._globeTileDebugTextBuffer])}function vo(_,c,f,v){kr(_,0,c+f/2,_.transform.width,f,v)}function Fi(_,c,f,v){kr(_,c-f/2,0,f,_.transform.height,v)}function kr(_,c,f,v,w,E){const S=_.context,I=S.gl;I.enable(I.SCISSOR_TEST),I.scissor(c*h.a4.devicePixelRatio,f*h.a4.devicePixelRatio,v*h.a4.devicePixelRatio,w*h.a4.devicePixelRatio),S.clear({color:E}),I.disable(I.SCISSOR_TEST)}const Go=h.bW([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Ya}=Go;function to(_,c,f,v){_.emplaceBack(c,f,v)}class Ps{constructor(c){this.vertexArray=new h.bX,this.indices=new h.bp,to(this.vertexArray,-1,-1,1),to(this.vertexArray,1,-1,1),to(this.vertexArray,-1,1,1),to(this.vertexArray,1,1,1),to(this.vertexArray,-1,-1,-1),to(this.vertexArray,1,-1,-1),to(this.vertexArray,-1,1,-1),to(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=c.createVertexBuffer(this.vertexArray,Ya),this.indexBuffer=c.createIndexBuffer(this.indices),this.segment=h.bm.simpleSegment(0,0,36,12)}}function ya(_,c,f,v,w,E){const S=_.context.gl,I=c.paint.get("sky-atmosphere-color"),O=c.paint.get("sky-atmosphere-halo-color"),N=c.paint.get("sky-atmosphere-sun-intensity"),V={u_matrix_3f:h.bx.fromMat4(h.bx.create(),v),u_sun_direction:w,u_sun_intensity:N,u_color_tint_r:[(ee=I).r,ee.g,ee.b,ee.a],u_color_tint_m:[(K=O).r,K.g,K.b,K.a],u_luminance:5e-5};var ee,K;S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,S.TEXTURE_CUBE_MAP_POSITIVE_X+E,c.skyboxTexture,0),f.draw(_,S.TRIANGLES,h.b4.disabled,h.b6.disabled,h.a.unblended,h.b5.frontCW,V,"skyboxCapture",c.skyboxGeometry.vertexBuffer,c.skyboxGeometry.indexBuffer,c.skyboxGeometry.segment)}const Pu=h.bW([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Lh{constructor(c){const f=new h.bY;f.emplaceBack(-1,1,1,0,0),f.emplaceBack(1,1,1,1,0),f.emplaceBack(1,-1,1,1,1),f.emplaceBack(-1,-1,1,0,1);const v=new h.bp;v.emplaceBack(0,1,2),v.emplaceBack(2,3,0),this.vertexBuffer=c.createVertexBuffer(f,Pu.members),this.indexBuffer=c.createIndexBuffer(v),this.segments=h.bm.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Xf=h.bW([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Vr{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15}}class kn{constructor(c){this.colorModeAlphaBlendedWriteRGB=new h.a([h.bZ,h.b_,h.bZ,h.b_],h.C.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new h.a([h.bZ,h.b$,h.bZ,h.b$],h.C.transparent,[!1,!1,!1,!0]),this.params=new Vr,this.allocatedStarsCount=0,c.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1}),c.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01})}update(c){const f=c.context;if(!this.atmosphereBuffer||this.allocatedStarsCount!==this.params.starsCount){this.atmosphereBuffer=new Lh(f),this.allocatedStarsCount=this.params.starsCount;const v=100,w=200,E=function(V){const H=h.c2(30),G=[];for(let Y=0;Y<V;++Y){const ee=2*Math.PI*H(),K=Math.acos(1-2*H())-.5*Math.PI;G.push(h.v.fromValues(Math.cos(K)*Math.cos(ee),Math.cos(K)*Math.sin(ee),Math.sin(K)))}return G}(this.allocatedStarsCount),S=h.c2(300),I=new h.c0,O=new h.bp;let N=0;for(let V=0;V<E.length;++V){const H=h.v.scale([],E[V],200),G=Math.max(0,1+.01*v*(1*S()-.5)),Y=Math.max(0,1+.01*w*(1*S()-.5));I.emplaceBack(H[0],H[1],H[2],-1,-1,G,Y),I.emplaceBack(H[0],H[1],H[2],1,-1,G,Y),I.emplaceBack(H[0],H[1],H[2],1,1,G,Y),I.emplaceBack(H[0],H[1],H[2],-1,1,G,Y),O.emplaceBack(N+0,N+1,N+2),O.emplaceBack(N+0,N+2,N+3),N+=4}this.starsVx=f.createVertexBuffer(I,Xf.members),this.starsIdx=f.createIndexBuffer(O),this.starsSegments=h.bm.simpleSegment(0,0,I.length,O.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(c,f){const v=c.context,w=v.gl,E=c.transform,S=new h.b4(w.LEQUAL,h.b4.ReadOnly,[0,1]),I=h.ao(E.zoom),O=f.properties.get("color").toArray01(),N=f.properties.get("high-color").toArray01(),V=f.properties.get("space-color").toArray01PremultipliedAlpha(),H=5e-4,G=h.c1(f.properties.get("horizon-blend"),0,1,H,.25),Y=h.bb(c,v,E)&&G===H?E.worldSize/(2*Math.PI*1.025)-1:E.globeRadius,ee=c.frameCounter/1e3%1,K=h.v.length(E.globeCenterInViewSpace),ne=Math.sqrt(Math.pow(K,2)-Math.pow(Y,2)),J=Math.acos(ne/K),oe=_e=>{const ye="globe"===E.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];_e&&ye.push("ALPHA_PASS");const re=c.getOrCreateProgram("globeAtmosphere",{defines:ye}),ae={u_frustum_tl:E.frustumCorners.TL,u_frustum_tr:E.frustumCorners.TR,u_frustum_br:E.frustumCorners.BR,u_frustum_bl:E.frustumCorners.BL,u_horizon:E.frustumCorners.horizon,u_transition:I,u_fadeout_range:G,u_color:O,u_high_color:N,u_space_color:V,u_temporal_offset:ee,u_horizon_angle:J};c.uploadCommonUniforms(v,re);const be=this.atmosphereBuffer;be&&re.draw(c,w.TRIANGLES,S,h.b6.disabled,_e?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,h.b5.backCW,ae,_e?"atmosphere_glow_alpha":"atmosphere_glow",be.vertexBuffer,be.indexBuffer,be.segments)};oe(!1),oe(!0)}drawStars(c,f){const v=h.c(f.properties.get("star-intensity"),0,1);if(0===v)return;const w=c.context,E=w.gl,S=c.transform,I=c.getOrCreateProgram("stars"),O=h.q.identity([]);h.q.rotateX(O,O,-S._pitch),h.q.rotateZ(O,O,-S.angle),h.q.rotateX(O,O,h.d(S._center.lat)),h.q.rotateY(O,O,-h.d(S._center.lng));const N=h.m.fromQuat(new Float32Array(16),O),V=h.m.multiply([],S.starsProjMatrix,N),H=h.bx.fromMat4([],N),G=h.bx.invert([],H),Y=[0,1,0];h.v.transformMat3(Y,Y,G),h.v.scale(Y,Y,this.params.sizeMultiplier);const ee=[1,0,0];h.v.transformMat3(ee,ee,G),h.v.scale(ee,ee,this.params.sizeMultiplier);const K=(ne=Y,J=ee,oe=v,{u_matrix:Float32Array.from(V),u_up:ne,u_right:J,u_intensity_multiplier:oe});var ne,J,oe;c.uploadCommonUniforms(w,I),this.starsVx&&this.starsIdx&&I.draw(c,E.TRIANGLES,h.b4.disabled,h.b6.disabled,this.colorModeAlphaBlendedWriteRGB,h.b5.disabled,K,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function yi(_,c){const f=[..._],v=c.cameraWorldSizeForFog/c.worldSize,w=h.m.identity([]);return h.m.scale(w,w,[v,v,1]),h.m.multiply(f,w,f),h.m.multiply(f,c.worldToFogMatrix,f),f}function Rr(_,c,f,v){const w=f.material,E=v.context,{baseColorTexture:S,metallicRoughnessTexture:I}=w.pbrMetallicRoughness,{normalTexture:O,occlusionTexture:N,emissionTexture:V}=w;function H(G,Y,ee){if(G&&(_.push(Y),E.activeTexture.set(E.gl.TEXTURE0+ee),G.gfxTexture)){const{minFilter:K,magFilter:ne,wrapS:J,wrapT:oe}=G.sampler;G.gfxTexture.bindExtraParam(K,ne,J,oe)}}H(S,"HAS_TEXTURE_u_baseColorTexture",Do.BaseColor),H(I,"HAS_TEXTURE_u_metallicRoughnessTexture",Do.MetallicRoughness),H(O,"HAS_TEXTURE_u_normalTexture",Do.Normal),H(N,"HAS_TEXTURE_u_occlusionTexture",Do.Occlusion),H(V,"HAS_TEXTURE_u_emissionTexture",Do.Emission),f.texcoordBuffer&&(_.push("HAS_ATTRIBUTE_a_uv_2f"),c.push(f.texcoordBuffer)),f.colorBuffer&&(_.push(12===f.colorBuffer.itemSize?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),c.push(f.colorBuffer)),f.normalBuffer&&(_.push("HAS_ATTRIBUTE_a_normal_3f"),c.push(f.normalBuffer)),f.pbrBuffer&&(_.push("HAS_ATTRIBUTE_a_pbr"),_.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),c.push(f.pbrBuffer)),"OPAQUE"!==w.alphaMode&&"MASK"!==w.alphaMode||_.push("UNPREMULT_TEXTURE_IN_SHADER"),w.defined||_.push("DIFFUSE_SHADED"),_.push("USE_STANDARD_DERIVATIVES")}function Fo(_,c,f,v,w,E){const S=f.paint.get("model-opacity"),I=c.context,O=new h.b4(c.context.gl.LEQUAL,h.b4.ReadWrite,c.depthRangeFor3D),N=c.transform,V=_.mesh,H=V.material,G=H.pbrMetallicRoughness,Y=c.style.fog;let ee;ee="pixels"===c.transform.projection.zAxisUnit?[..._.nodeModelMatrix]:h.m.multiply([],v.zScaleMatrix,_.nodeModelMatrix),h.m.multiply(ee,v.negCameraPosMatrix,ee);const K=h.m.invert([],ee);h.m.transpose(K,K);const ne=f.paint.get("model-emissive-strength").constantOr(0),J=Vc(new Float32Array(_.worldViewProjection),new Float32Array(ee),new Float32Array(K),c,S,G.baseColorFactor,H.emissiveFactor,G.metallicFactor,G.roughnessFactor,H,ne,f),oe={defines:[]},_e=[];Rr(oe.defines,_e,V,c);const ye=c.shadowRenderer;ye&&(ye.useNormalOffset=!1);let re=null;if(Y){const Se=yi(_.nodeModelMatrix,c.transform);if(re=new Float32Array(Se),"globe"!==N.projection.name){const Ce=V.aabb.min,ke=V.aabb.max,[lt,$e]=Y.getOpacityForBounds(Se,Ce[0],Ce[1],ke[0],ke[1]);oe.overrideFog=lt>=eo||$e>=eo}}const ae=Nc(c,f.paint.get("model-cutoff-fade-range"));ae.shouldRenderCutoff&&oe.defines.push("RENDER_CUTOFF");const be=c.getOrCreateProgram("model",oe);c.uploadCommonUniforms(I,be,null,re,ae),"shadow"!==c.renderPass&&ye&&ye.setupShadowsFromMatrix(_.nodeModelMatrix,be),be.draw(c,I.gl.TRIANGLES,O,w,E,V.material.doubleSided?h.b5.disabled:h.b5.backCCW,J,f.id,V.vertexBuffer,V.indexBuffer,V.segments,f.paint,c.transform.zoom,void 0,_e)}function Hc(_,c,f,v,w,E,S){let I;I="globe"===_.projection.name?h.c5(f,_):[...f],h.m.multiply(I,I,c.matrix);const O=h.m.multiply([],v,I);if(c.meshes)for(const N of c.meshes){if("BLEND"!==N.material.alphaMode){S.push({mesh:N,depth:0,modelIndex:w,worldViewProjection:O,nodeModelMatrix:I});continue}const V=h.v.transformMat4([],N.centroid,O);V[2]>0&&E.push({mesh:N,depth:V[2],modelIndex:w,worldViewProjection:O,nodeModelMatrix:I})}if(c.children)for(const N of c.children)Hc(_,N,f,v,w,E,S)}function Pr(_,c,f,v){const w=f.shadowRenderer;if(!w)return;const E=w.getShadowPassDepthMode(),S=w.getShadowPassColorMode(),I=w.calculateShadowPassMatrixFromMatrix(c),O=Au(I);f.getOrCreateProgram("modelDepth",{defines:["DEPTH_TEXTURE"]}).draw(f,f.context.gl.TRIANGLES,E,h.b6.disabled,S,h.b5.backCCW,O,v.id,_.vertexBuffer,_.indexBuffer,_.segments,v.paint,f.transform.zoom,void 0,void 0)}function ac(_,c,f){const v=c.updateZoomBasedPaintProperties(),w=function(E,S,I){let O,N,V,H=E.terrain?E.terrain.exaggeration():0;if(E.terrain&&H>0){const G=E.terrain,Y=G.findDEMTileFor(I);Y&&Y.dem?O=h.c7.create(G,I,Y):H=0}if(0===H&&(S.terrainElevationMin=0,S.terrainElevationMax=0),H===S.validForExaggeration&&(0===H||O&&O._demTile&&O._demTile.tileID===S.validForDEMTile.id&&O._dem._timestamp===S.validForDEMTile.timestamp))return!1;for(const G in S.instancesPerModel){const Y=S.instancesPerModel[G];for(let ee=0;ee<Y.instancedDataArray.length;++ee){const K=(O?H*O.getElevationAt(0|Y.instancedDataArray.float32[16*ee],0|Y.instancedDataArray.float32[16*ee+1],!0,!0):0)+Y.instancesEvaluatedElevation[ee];Y.instancedDataArray.float32[16*ee+6]=K,N=N?Math.min(S.terrainElevationMin,K):K,V=V?Math.max(S.terrainElevationMax,K):K}}return S.terrainElevationMin=N||0,S.terrainElevationMax=V||0,S.validForExaggeration=H,S.validForDEMTile=O&&O._demTile?{id:O._demTile.tileID,timestamp:O._dem._timestamp}:{id:void 0,timestamp:0},!0}(_,c,f);(v||w)&&(c.uploaded=!1,c.upload(_.context))}const sr={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new h.c3([0,0,0],[h.J,h.J,0])};function Tl(_,c){const f=1<<_.canonical.z,v=c.getFreeCameraOptions().position,w=c.elevation,E=_.canonical.x/f,S=(_.canonical.x+1)/f,I=_.canonical.y/f,O=(_.canonical.y+1)/f;let N=c._centerAltitude;if(w){const Y=w.getMinMaxForTile(_);Y&&Y.max>N&&(N=Y.max)}const V=h.c(v.x,E,S)-v.x,H=h.c(v.y,I,O)-v.y,G=h.b(N,c.center.lat)-v.z;return c._zoomFromMercatorZ(Math.sqrt(V*V+H*H+G*G))}function va(_,c,f,v,w,E,S){const I=_.context,O="shadow"===_.renderPass,N=_.shadowRenderer,V=O&&N?N.getShadowPassDepthMode():new h.b4(I.gl.LEQUAL,h.b4.ReadWrite,_.depthRangeFor3D),H=_.isTileAffectedByFog(E);if(f.meshes)for(const G of f.meshes){const Y=["MODEL_POSITION_ON_GPU"],ee=[];let K,ne,J;v.instancedDataArray.length>20&&Y.push("INSTANCED_ARRAYS");const oe=Nc(_,c.paint.get("model-cutoff-fade-range"));if(oe.shouldRenderCutoff&&Y.push("RENDER_CUTOFF"),O&&N)K=_.getOrCreateProgram("modelDepth",{defines:Y}),ne=Au(S.shadowTileMatrix,S.shadowTileMatrix,Float32Array.from(f.matrix)),J=N.getShadowPassColorMode();else{Rr(Y,ee,G,_),K=_.getOrCreateProgram("model",{defines:Y,overrideFog:H});const ye=G.material,re=ye.pbrMetallicRoughness,ae=c.paint.get("model-opacity"),be=c.paint.get("model-emissive-strength").constantOr(0);ne=Vc(E.expandedProjMatrix,Float32Array.from(f.matrix),new Float32Array(16),_,ae,re.baseColorFactor,ye.emissiveFactor,re.metallicFactor,re.roughnessFactor,ye,be,c,w),N&&(S.shadowUniformsInitialized?K.setShadowUniformValues(I,N.getShadowUniformValues()):(N.setupShadows(E.toUnwrapped(),K,"model-tile",E.overscaledZ),S.shadowUniformsInitialized=!0)),J=oe.shouldRenderCutoff||ae<1||"OPAQUE"!==ye.alphaMode?h.a.alphaBlended:h.a.unblended}_.uploadCommonUniforms(I,K,E.toUnwrapped(),null,oe);const _e=G.material.doubleSided?h.b5.disabled:h.b5.backCCW;if(v.instancedDataArray.length>20)ee.push(v.instancedDataBuffer),K.draw(_,I.gl.TRIANGLES,V,h.b6.disabled,J,_e,ne,c.id,G.vertexBuffer,G.indexBuffer,G.segments,c.paint,_.transform.zoom,void 0,ee,v.instancedDataArray.length);else{const ye=O?"u_instance":"u_normal_matrix";for(let re=0;re<v.instancedDataArray.length;++re)ne[ye]=new Float32Array(v.instancedDataArray.arrayBuffer,64*re,16),K.draw(_,I.gl.TRIANGLES,V,h.b6.disabled,J,_e,ne,c.id,G.vertexBuffer,G.indexBuffer,G.segments,c.paint,_.transform.zoom,void 0,ee)}}if(f.children)for(const G of f.children)va(_,c,G,v,w,E,S)}const wi=[1,-1,1];function $c(_,c,f,v){if(!f.modelManager)return!0;const w=f.modelManager;if(!f.shadowRenderer)return!0;const E=f.shadowRenderer,S=c.aabb;let I=!0,O=_.maxHeight;if(0===O){let V=0;for(const H in _.instancesPerModel){const G=w.getModel(H,v);G?V=Math.max(V,Math.max(Math.max(G.aabb.max[0],G.aabb.max[1]),G.aabb.max[2])):I=!1}O=_.maxScale*V*1.41+_.maxVerticalOffset,I&&(_.maxHeight=O)}S.max[2]=O,S.min[2]+=_.terrainElevationMin,S.max[2]+=_.terrainElevationMax,h.v.transformMat4(S.min,S.min,c.tileMatrix),h.v.transformMat4(S.max,S.max,c.tileMatrix);const N=S.intersects(E.getCurrentCascadeFrustum());return 0===f.currentShadowCascade&&(_.isInsideFirstShadowMapFrustum=2===N),0===N}class Sd{}class Qs{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(c,f,v){{const H=this._storage.get(f.id);if(H)return H.lastUsedFrameIdx=c,H.buf}const w=v.gl,E=w.getBufferParameter(w.ELEMENT_ARRAY_BUFFER,w.BUFFER_SIZE),S=new ArrayBuffer(E),I=new Int16Array(S);w.getBufferSubData(w.ELEMENT_ARRAY_BUFFER,0,new Int16Array(S));const O=new h.c9;for(let H=0;H<E/2;H+=3){const G=I[H],Y=I[H+1],ee=I[H+2];O.emplaceBack(G,Y),O.emplaceBack(Y,ee),O.emplaceBack(ee,G)}const N=v.bindVertexArrayOES.current,V=new Sd;return V.buf=new h.I(v,O),V.lastUsedFrameIdx=c,this._storage.set(f.id,V),v.bindVertexArrayOES.set(N),V.buf}update(c){for(const[f,v]of this._storage)c-v.lastUsedFrameIdx>30&&(v.buf.destroy(),this._storage.delete(f))}destroy(){for(const[c,f]of this._storage)f.buf.destroy(),this._storage.delete(c)}}class no{registerParameter(c,f,v,w,E){}registerButton(c,f,v){}}const lc={symbol:function(_,c,f,v,w){if("translucent"!==_.renderPass)return;const E=h.b6.disabled,S=_.colorModeForRenderPass();f.layout.get("text-variable-anchor")&&function(I,O,N,V,H,G,Y){const ee=O.transform,K="map"===H,ne="map"===G;for(const J of I){const oe=V.getTile(J),_e=oe.getBucket(N);if(!_e||!_e.text||!_e.text.segments.get().length)continue;const ye=h.i(_e.textSizeData,ee.zoom),re=yt(J,_e.getProjection(),ee),ae=ee.calculatePixelsToTileUnitsMatrix(oe),be=Mo(re,oe.tileID.canonical,ne,K,ee,_e.getProjection(),ae),Se=_e.hasIconTextFit()&&_e.hasIconData();if(ye){const Ce=Math.pow(2,ee.zoom-oe.tileID.overscaledZ);rs(_e,K,ne,Y,h.bG,ee,be,J,Ce,ye,Se)}}}(v,_,f,c,f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),w),0!==f.paint.get("icon-opacity").constantOr(1)&&oi(_,c,f,v,!1,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),f.layout.get("icon-rotation-alignment"),f.layout.get("icon-pitch-alignment"),f.layout.get("icon-keep-upright"),f.paint.get("icon-color-saturation"),E,S),0!==f.paint.get("text-opacity").constantOr(1)&&oi(_,c,f,v,!0,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),f.layout.get("text-keep-upright"),f.paint.get("icon-color-saturation"),E,S),c.map.showCollisionBoxes&&(Iu(_,c,f,v,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),!0),Iu(_,c,f,v,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),!1))},circle:function(_,c,f,v){if("translucent"!==_.renderPass)return;const w=f.paint.get("circle-opacity"),E=f.paint.get("circle-stroke-width"),S=f.paint.get("circle-stroke-opacity"),I=void 0!==f.layout.get("circle-sort-key").constantOr(1),O=f.paint.get("circle-emissive-strength");if(0===w.constantOr(1)&&(0===E.constantOr(1)||0===S.constantOr(1)))return;const N=_.context,V=N.gl,H=_.transform,G=_.depthModeForSublayer(0,h.b4.ReadOnly),Y=h.b6.disabled,ee=_.colorModeForDrapableLayerRenderPass(O),K="globe"===H.projection.name,ne=[h.E(H.center.lng),h.H(H.center.lat)],J=[];for(let _e=0;_e<v.length;_e++){const ye=v[_e],re=c.getTile(ye),ae=re.getBucket(f);if(!ae||ae.projection.name!==H.projection.name)continue;const be=ae.programConfigurations.get(f.id),Se=h.bH(f),Ce=_.isTileAffectedByFog(ye);K&&Se.push("PROJECTION_GLOBE_VIEW");const ke=_.getOrCreateProgram("circle",{config:be,defines:Se,overrideFog:Ce}),lt=ae.layoutVertexBuffer,$e=ae.globeExtVertexBuffer,Qe=ae.indexBuffer,Fe=H.projection.createInversionMatrix(H,ye.canonical),ot={programConfiguration:be,program:ke,layoutVertexBuffer:lt,globeExtVertexBuffer:$e,indexBuffer:Qe,uniformValues:h.bI(_,ye,re,Fe,ne,f),tile:re};if(I){const Ke=ae.segments.get();for(const Ue of Ke)J.push({segments:new h.bm([Ue]),sortKey:Ue.sortKey,state:ot})}else J.push({segments:ae.segments,sortKey:0,state:ot})}I&&J.sort((_e,ye)=>_e.sortKey-ye.sortKey);const oe={useDepthForOcclusion:H.depthOcclusionForSymbolsAndCircles};for(const _e of J){const{programConfiguration:ye,program:re,layoutVertexBuffer:ae,globeExtVertexBuffer:be,indexBuffer:Se,uniformValues:Ce,tile:ke}=_e.state,lt=_e.segments;_.terrain&&_.terrain.setupElevationDraw(ke,re,oe),_.uploadCommonUniforms(N,re,ke.tileID.toUnwrapped()),re.draw(_,V.TRIANGLES,G,Y,ee,h.b5.disabled,Ce,f.id,ae,Se,lt,f.paint,H.zoom,ye,[be])}},heatmap:function(_,c,f,v){if(0!==f.paint.get("heatmap-opacity"))if("offscreen"===_.renderPass){const w=_.context,E=w.gl,S=h.b6.disabled,I=new h.a([E.ONE,E.ONE,E.ONE,E.ONE],h.C.transparent,[!0,!0,!0,!0]);(function(Y,ee,K,ne){const J=Y.gl,oe=ee.width*ne,_e=ee.height*ne;Y.activeTexture.set(J.TEXTURE1),Y.viewport.set([0,0,oe,_e]);let ye=K.heatmapFbo;if(!ye||ye&&(ye.width!==oe||ye.height!==_e)){ye&&ye.destroy();const re=J.createTexture();J.bindTexture(J.TEXTURE_2D,re),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_S,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_T,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MIN_FILTER,J.LINEAR),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MAG_FILTER,J.LINEAR),ye=K.heatmapFbo=Y.createFramebuffer(oe,_e,!0,null),function(ae,be,Se,Ce,ke,lt){const $e=ae.gl;$e.texImage2D($e.TEXTURE_2D,0,ae.extRenderToTextureHalfFloat?$e.RGBA16F:$e.RGBA,ke,lt,0,$e.RGBA,ae.extRenderToTextureHalfFloat?$e.HALF_FLOAT:$e.UNSIGNED_BYTE,null),Ce.colorAttachment.set(Se)}(Y,0,re,ye,oe,_e)}else J.bindTexture(J.TEXTURE_2D,ye.colorAttachment.get()),Y.bindFramebuffer.set(ye.framebuffer)})(w,_,f,"globe"===_.transform.projection.name?.5:.25),w.clear({color:h.C.transparent});const O=_.transform,N="globe"===O.projection.name,V=N?["PROJECTION_GLOBE_VIEW"]:[],H=N?h.b5.frontCCW:h.b5.disabled,G=[h.E(O.center.lng),h.H(O.center.lat)];for(let Y=0;Y<v.length;Y++){const ee=v[Y];if(c.hasRenderableParent(ee))continue;const K=c.getTile(ee),ne=K.getBucket(f);if(!ne||ne.projection.name!==O.projection.name)continue;const J=_.isTileAffectedByFog(ee),oe=ne.programConfigurations.get(f.id),_e=_.getOrCreateProgram("heatmap",{config:oe,defines:V,overrideFog:J}),{zoom:ye}=_.transform;_.terrain&&_.terrain.setupElevationDraw(K,_e),_.uploadCommonUniforms(w,_e,ee.toUnwrapped());const re=O.projection.createInversionMatrix(O,ee.canonical);_e.draw(_,E.TRIANGLES,h.b4.disabled,S,I,H,Rs(_,ee,K,re,G,ye,f.paint.get("heatmap-intensity")),f.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,f.paint,_.transform.zoom,oe,N?[ne.globeExtVertexBuffer]:null)}w.viewport.set([0,0,_.width,_.height])}else"translucent"===_.renderPass&&(_.context.setColorMode(_.colorModeForRenderPass()),function(w,E){const S=w.context,I=S.gl,O=E.heatmapFbo;if(!O)return;S.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,O.colorAttachment.get()),S.activeTexture.set(I.TEXTURE1);let N=E.colorRampTexture;N||(N=E.colorRampTexture=new h.a9(S,E.colorRamp,I.RGBA)),N.bind(I.LINEAR,I.CLAMP_TO_EDGE),w.getOrCreateProgram("heatmapTexture").draw(w,I.TRIANGLES,h.b4.disabled,h.b6.disabled,w.colorModeForRenderPass(),h.b5.disabled,{u_image:0,u_color_ramp:1,u_opacity:E.paint.get("heatmap-opacity")},E.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,E.paint,w.transform.zoom)}(_,f))},line:function(_,c,f,v){if("translucent"!==_.renderPass)return;const w=f.paint.get("line-opacity"),E=f.paint.get("line-width");if(0===w.constantOr(1)||0===E.constantOr(1))return;const S=f.paint.get("line-emissive-strength"),I=_.depthModeForSublayer(0,h.b4.ReadOnly),O=_.colorModeForDrapableLayerRenderPass(S),N=_.terrain&&_.terrain.renderingToTexture?1:h.a4.devicePixelRatio,V=f.paint.get("line-dasharray"),H=V.constantOr(1),G=f.layout.get("line-cap"),Y=f.paint.get("line-pattern"),ee=Y.constantOr(1),K=f.paint.get("line-pattern").constantOr(1),ne=1!==f.paint.get("line-opacity").constantOr(1);let J=!K&&ne;const oe=f.paint.get("line-gradient"),_e=ee?"linePattern":"line",ye=_.context,re=ye.gl,ae=h.bJ(f);_.terrain&&_.terrain.clipOrMaskOverlapStencilType()&&(J=!1);for(const be of v){const Se=c.getTile(be);if(ee&&!Se.patternsLoaded())continue;const Ce=Se.getBucket(f);if(!Ce)continue;_.prepareDrawTile();const ke=Ce.programConfigurations.get(f.id),lt=_.isTileAffectedByFog(be),$e=_.getOrCreateProgram(_e,{config:ke,defines:ae,overrideFog:lt}),Qe=Y.constantOr(null);if(Qe&&Se.imageAtlas){const vt=Se.imageAtlas.patternPositions[Qe.toString()];vt&&ke.setConstantPatternPositions(vt)}const Fe=V.constantOr(null),ot=G.constantOr(null);if(!ee&&Fe&&ot&&Se.lineAtlas){const vt=Se.lineAtlas.getDash(Fe,ot);vt&&ke.setConstantPatternPositions(vt)}let[Ke,Ue]=f.paint.get("line-trim-offset");("round"===ot||"square"===ot)&&Ke!==Ue&&(0===Ke&&(Ke-=1),1===Ue&&(Ue+=1));const fe=_.terrain?be.projMatrix:null,Ne=ee?h.bK(_,Se,f,fe,N):h.bL(_,Se,f,fe,Ce.lineClipsArray.length,N,[Ke,Ue]);if(oe){const vt=Ce.gradients[f.id];let an=vt.texture;if(f.gradientVersion!==vt.version){let Xt=256;if(f.stepInterpolant){const mn=c.getSource().maxzoom,nn=be.canonical.z===mn?Math.ceil(1<<_.transform.maxZoom-be.canonical.z):1;Xt=h.c(h.bM(Ce.maxLineLength/h.J*1024*nn),256,ye.maxTextureSize)}vt.gradient=h.bN({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:Xt,image:vt.gradient||void 0,clips:Ce.lineClipsArray}),vt.texture?vt.texture.update(vt.gradient):vt.texture=new h.a9(ye,vt.gradient,re.RGBA),vt.version=f.gradientVersion,an=vt.texture}ye.activeTexture.set(re.TEXTURE1),an.bind(f.stepInterpolant?re.NEAREST:re.LINEAR,re.CLAMP_TO_EDGE)}H&&(ye.activeTexture.set(re.TEXTURE0),Se.lineAtlasTexture&&Se.lineAtlasTexture.bind(re.LINEAR,re.REPEAT),ke.updatePaintBuffers()),ee&&(ye.activeTexture.set(re.TEXTURE0),Se.imageAtlasTexture&&Se.imageAtlasTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),ke.updatePaintBuffers()),_.uploadCommonUniforms(ye,$e,be.toUnwrapped());const At=vt=>{$e.draw(_,re.TRIANGLES,I,vt,O,h.b5.disabled,Ne,f.id,Ce.layoutVertexBuffer,Ce.indexBuffer,Ce.segments,f.paint,_.transform.zoom,ke,[Ce.layoutVertexBuffer2])};if(J){const vt=_.stencilModeForClipping(be).ref;0===vt&&_.terrain&&ye.clear({stencil:0});const an={func:re.EQUAL,mask:255};Ne.u_alpha_discard_threshold=.8,At(new h.b6(an,vt,255,re.KEEP,re.KEEP,re.INVERT)),Ne.u_alpha_discard_threshold=0,At(new h.b6(an,vt,255,re.KEEP,re.KEEP,re.KEEP))}else At(_.stencilModeForClipping(be))}J&&(_.resetStencilClippingMasks(),_.terrain&&ye.clear({stencil:0}))},fill:function(_,c,f,v){const w=f.paint.get("fill-color"),E=f.paint.get("fill-opacity");if(0===E.constantOr(1))return;const S=f.paint.get("fill-emissive-strength"),I=_.colorModeForDrapableLayerRenderPass(S),O=f.paint.get("fill-pattern"),N=_.opaquePassEnabledForLayer()&&!O.constantOr(1)&&1===w.constantOr(h.C.transparent).a&&1===E.constantOr(0)?"opaque":"translucent";if(_.renderPass===N){const V=_.depthModeForSublayer(1,"opaque"===_.renderPass?h.b4.ReadWrite:h.b4.ReadOnly);Ru(_,c,f,v,V,I,!1)}if("translucent"===_.renderPass&&f.paint.get("fill-antialias")){const V=_.depthModeForSublayer(f.getPaintProperty("fill-outline-color")?2:0,h.b4.ReadOnly);Ru(_,c,f,v,V,I,!0)}},"fill-extrusion":function(_,c,f,v){const w=f.paint.get("fill-extrusion-opacity"),E=_.context,S=E.gl,I=_.terrain,O=I&&I.renderingToTexture;if(0===w)return;const N=_.conflationActive&&_.layerUsedInConflation(f,c.getSource());if(N&&function(V,H,G,Y){for(const ee of Y){const K=H.getTile(ee).getBucket(G);K&&(K.updateReplacement(ee,V.replacementSource),K.uploadCentroid(V.context))}}(_,c,f,v),I||N)for(const V of v){const H=c.getTile(V).getBucket(f);H&&Rh(_.context,c,V,H,f,I,N)}if("shadow"===_.renderPass&&_.shadowRenderer){const V=_.shadowRenderer;if(I&&w<.65&&f._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof h.am)return;const H=V.getShadowPassDepthMode(),G=V.getShadowPassColorMode();Dl(_,c,f,v,H,h.b6.disabled,G,N)}else if("translucent"===_.renderPass){const V=!f.paint.get("fill-extrusion-pattern").constantOr(1),H=f.paint.get("fill-extrusion-color").constantOr(h.C.white);if(!O&&0!==H.a){const G=new h.b4(_.context.gl.LEQUAL,h.b4.ReadWrite,_.depthRangeFor3D);1===w&&V?Dl(_,c,f,v,G,h.b6.disabled,h.a.unblended,N):(Dl(_,c,f,v,G,h.b6.disabled,h.a.disabled,N),Dl(_,c,f,v,G,_.stencilModeFor3D(),_.colorModeForRenderPass(),N),_.resetStencilClippingMasks())}if(_.style.enable3dLights()&&V&&(!I&&"globe"!==_.transform.projection.name||O)){const G=f.paint.get("fill-extrusion-opacity"),Y=f.paint.get("fill-extrusion-ambient-occlusion-intensity"),ee=f.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),K=f.paint.get("fill-extrusion-flood-light-intensity"),ne=f.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),J=Y>0&&ee>0,oe=K>0,_e=(re,ae,be)=>(1-be)*re+be*ae,ye=re=>{const ae=_.depthModeForSublayer(1,h.b4.ReadOnly,S.LEQUAL,!0),be=f.paint.get(re?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Se=_e(.1,3,be),Ce=_._showOverdrawInspector;if(!Ce){const ke=new h.b6({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),lt=new h.a([S.ONE,S.ONE,S.ONE,S.ONE],h.C.transparent,[!1,!1,!1,!0],S.MIN);sc(_,c,f,v,ae,ke,lt,h.b5.disabled,re,"sdf",G,Y,ee,K,ne,Se,N,!1)}{const ke=Ce?h.b6.disabled:new h.b6({func:S.EQUAL,mask:255},255,255,S.KEEP,S.DECR,S.DECR),lt=Ce?_.colorModeForRenderPass():new h.a([S.ONE_MINUS_DST_ALPHA,S.DST_ALPHA,S.ONE,S.ONE],h.C.transparent,[!0,!0,!0,!0]);sc(_,c,f,v,ae,ke,lt,h.b5.disabled,re,"color",G,Y,ee,K,ne,Se,N,!1)}};if(O){const re=(ae,be,Se)=>{const Ce=_.depthModeForSublayer(1,h.b4.ReadOnly,S.LEQUAL,!1),ke=f.paint.get(ae?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),lt=_e(.1,3,ke);{const $e=new h.a([S.ONE,S.ONE,S.ONE,S.ONE],h.C.transparent,[!1,!1,!1,!0]);sc(_,c,f,v,Ce,h.b6.disabled,$e,h.b5.disabled,ae,"clear",G,Y,ee,K,ne,lt,N,be)}{const $e=new h.b6({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),Qe=new h.a([S.ONE,S.ONE,S.ONE,S.ONE],h.C.transparent,[!1,!1,!1,!0],S.MIN);sc(_,c,f,v,Ce,$e,Qe,h.b5.disabled,ae,"sdf",G,Y,ee,K,ne,lt,N,be)}{const $e=ae?S.ZERO:S.ONE_MINUS_DST_ALPHA,Qe=new h.b6({func:S.EQUAL,mask:255},255,255,S.KEEP,S.DECR,S.DECR),Fe=new h.a([$e,S.DST_ALPHA,S.ONE_MINUS_DST_ALPHA,S.ZERO],h.C.transparent,[!0,!0,!0,!0]);sc(_,c,f,v,Ce,Qe,Fe,h.b5.disabled,ae,"color",G,Y,ee,K,ne,lt,N,be)}{const $e=new h.a([S.ONE,S.ONE,S.ONE,ae?S.ZERO:S.ONE],h.C.transparent,[!1,!1,!1,!0],ae?S.FUNC_ADD:S.MAX);sc(_,c,f,v,Ce,h.b6.disabled,$e,h.b5.disabled,ae,"clear",G,Y,ee,K,ne,lt,N,be,Se)}};if(J||oe){let ae;if(_.prepareDrawTile(),I){const be=I.drapeBufferSize[0],Se=I.drapeBufferSize[1];ae=I.framebufferCopyTexture,ae&&(!ae||ae.size[0]===be&&ae.size[1]===Se)||(ae&&ae.destroy(),ae=I.framebufferCopyTexture=new h.a9(E,new h.a5({width:be,height:Se}),S.RGBA)),ae.bind(S.LINEAR,S.CLAMP_TO_EDGE),S.copyTexImage2D(S.TEXTURE_2D,0,S.RGBA,0,0,be,Se,0)}J&&re(!0,!1,ae),oe&&re(!1,!0,ae)}}else J&&ye(!0),oe&&ye(!1)}}},hillshade:function(_,c,f,v){if("offscreen"!==_.renderPass&&"translucent"!==_.renderPass||_.style.disableElevatedTerrain)return;const w=_.context,E=_.terrain&&_.terrain.renderingToTexture,[S,I]="translucent"!==_.renderPass||E?[{},v]:_.stencilConfigForOverlap(v);for(const O of I){const N=c.getTile(O);if(N.needsHillshadePrepare&&"offscreen"===_.renderPass)$f(_,N,f);else if("translucent"===_.renderPass){const V=_.depthModeForSublayer(0,h.b4.ReadOnly),H=f.paint.get("hillshade-emissive-strength"),G=_.colorModeForDrapableLayerRenderPass(H),Y=E&&_.terrain?_.terrain.stencilModeForRTTOverlap(O):S[O.overscaledZ];Sh(_,O,N,f,V,Y,G)}}w.viewport.set([0,0,_.width,_.height]),_.resetStencilClippingMasks()},raster:function(_,c,f,v,w,E){if("translucent"!==_.renderPass||0===f.paint.get("raster-opacity"))return;const S=_.context,I=S.gl,O=c.getSource(),N=function(be,Se,Ce){const ke=be.paint.get("raster-color"),lt=[],$e=be.paint.get("raster-resampling"),Qe=be.paint.get("raster-color-mix"),Fe=be.paint.get("raster-color-range"),ot=[Qe[0],Qe[1],Qe[2],0],Ke=Qe[3],Ue="nearest"===$e?Ce.NEAREST:Ce.LINEAR;if(ke&&lt.push("RASTER_COLOR"),ke){Se.activeTexture.set(Ce.TEXTURE2);let fe=be.colorRampTexture;fe||(fe=be.colorRampTexture=new h.a9(Se,be.colorRamp,Ce.RGBA)),fe.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE)}return{mix:ot,range:Fe,offset:Ke,defines:lt,resampling:Ue}}(f,S,I),V=N.defines,H="globe"===_.transform.projection.name;let G=!1;if(O instanceof h.aK&&!v.length){if(!H)return;if(O.onNorthPole)G=!0,V.push("GLOBE_POLES");else{if(!O.onSouthPole)return;G=!0,V.push("GLOBE_POLES")}}const Y=f.paint.get("raster-emissive-strength"),ee=_.colorModeForDrapableLayerRenderPass(Y),K=_.terrain&&_.terrain.renderingToTexture,ne=O instanceof h.aK&&0!==f.paint.get("raster-elevation"),J=!_.options.moving,oe="nearest"===f.paint.get("raster-resampling")?I.NEAREST:I.LINEAR;if(G){const be=c.getSource();if(!(be instanceof h.aK))return;const Se=be.texture;if(!Se)return;const Ce=_.globeSharedBuffers;if(!Ce)return;const ke=new h.b4(I.LEQUAL,h.b4.ReadWrite,_.depthRangeFor3D),lt=Float32Array.from(_.transform.expandedFarZProjMatrix);let $e=h.bj(0,0,_.transform);const Qe=Float32Array.from(h.bh(h.bi(new h.t(0,0,0)))),Fe={opacity:1,mix:0};_.terrain&&_.terrain.prepareDrawTile(),S.activeTexture.set(I.TEXTURE0),Se.bind(oe,I.CLAMP_TO_EDGE),S.activeTexture.set(I.TEXTURE1),Se.bind(oe,I.CLAMP_TO_EDGE),Se.useMipmap&&S.extTextureFilterAnisotropic&&_.transform.pitch>20&&I.texParameterf(I.TEXTURE_2D,S.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,S.extTextureFilterAnisotropicMax);const[ot,Ke,Ue,fe]=Ce.getPoleBuffers(0,!0);let Ne;be.onNorthPole?(Ne=ot,_.renderDefaultNorthPole=!1):($e=h.m.scale(h.m.create(),$e,[1,-1,1]),Ne=Ke,_.renderDefaultSouthPole=!1);const At=(an=lt,Xt=Qe,mn=$e,nn=Fe,Rn=f,gn=f.paint.get("raster-elevation"),mt=N.mix,un=N.offset,Mn=N.range,Cn=Y,ir(an,Xt,mn,new Float32Array(16),new Float32Array(9),[0,0],0,[0,0],[0,0,0,0],1,nn,Rn,[0,0],gn,2,mt,un,Mn,1,0,Cn)),vt=_.getOrCreateProgram("raster",{defines:N.defines});return _.uploadCommonUniforms(S,vt,null),void vt.draw(_,I.TRIANGLES,ke,h.b6.disabled,ee,h.b5.disabled,At,f.id,Ne,Ue,fe)}var an,Xt,mn,nn,Rn,gn,mt,un,Mn,Cn;if(!v.length)return;const[_e,ye]=O instanceof h.aK||K?[{},v]:_.stencilConfigForOverlap(v),re=ye[ye.length-1].overscaledZ,ae=ne&&H;ae&&N.defines.push("PROJECTION_GLOBE_VIEW"),ne&&N.defines.push("RENDER_CUTOFF");for(const be of ye){const Se=be.toUnwrapped(),Ce=c.getTile(be);if(K&&(!Ce||!Ce.hasData())||!Ce.texture)continue;let ke,lt;K?(ke=h.b4.disabled,lt=be.projMatrix):ne?(ke=new h.b4(I.LEQUAL,h.b4.ReadWrite,_.depthRangeFor3D),lt=H?Float32Array.from(_.transform.expandedFarZProjMatrix):_.transform.calculateProjMatrix(Se,J)):(ke=_.depthModeForSublayer(be.overscaledZ-re,1===f.paint.get("raster-opacity")?h.b4.ReadWrite:h.b4.ReadOnly,I.LESS),lt=_.transform.calculateProjMatrix(Se,J));const $e=_.terrain&&K?_.terrain.stencilModeForRTTOverlap(be):_e[be.overscaledZ],Qe=E?0:f.paint.get("raster-fade-duration");Ce.registerFadeDuration(Qe);const Fe=c.findLoadedParent(be,0),ot=ec(Ce,Fe,c,_.transform,Qe);let Ke,Ue;_.terrain&&_.terrain.prepareDrawTile(),S.activeTexture.set(I.TEXTURE0),Ce.texture&&Ce.texture.bind(oe,I.CLAMP_TO_EDGE),S.activeTexture.set(I.TEXTURE1),Fe?(Fe.texture&&Fe.texture.bind(oe,I.CLAMP_TO_EDGE),Ke=Math.pow(2,Fe.tileID.overscaledZ-Ce.tileID.overscaledZ),Ue=[Ce.tileID.canonical.x*Ke%1,Ce.tileID.canonical.y*Ke%1]):Ce.texture&&Ce.texture.bind(oe,I.CLAMP_TO_EDGE),Ce.texture&&Ce.texture.useMipmap&&S.extTextureFilterAnisotropic&&_.transform.pitch>20&&I.texParameterf(I.TEXTURE_2D,S.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,S.extTextureFilterAnisotropicMax);const fe=_.transform;let Ne;const At=ne?Mm(fe):[0,0,0,0];let vt,an,Xt,mn,nn;ae&&O instanceof h.aK&&O.coordinates.length>3?(vt=Float32Array.from(h.bh(h.bi(new h.t(0,0,0)))),an=Float32Array.from(fe.globeMatrix),Xt=Float32Array.from(h.bc(fe)),mn=[h.E(fe.center.lng),h.H(fe.center.lat)],Ne=O.elevatedGlobePerspectiveTransform,nn=O.elevatedGlobeGridMatrix||new Float32Array(9)):(Ne=O instanceof h.aK?O.perspectiveTransform:[0,0],vt=new Float32Array(16),an=new Float32Array(9),Xt=new Float32Array(16),mn=[0,0],nn=new Float32Array(9));const Rn=ir(lt,vt,an,Xt,nn,Ue||[0,0],h.ao(_.transform.zoom),mn,At,Ke||1,ot,f,Ne,ne?f.paint.get("raster-elevation"):0,2,N.mix,N.offset,N.range,1,0,Y),Pn=_.isTileAffectedByFog(be),gn=_.getOrCreateProgram("raster",{defines:N.defines,overrideFog:Pn});if(_.uploadCommonUniforms(S,gn,Se),O instanceof h.aK){const _n=O.elevatedGlobeVertexBuffer,mt=O.elevatedGlobeIndexBuffer;if(K||!H)O.boundsBuffer&&O.boundsSegments&&gn.draw(_,I.TRIANGLES,ke,h.b6.disabled,ee,h.b5.disabled,Rn,f.id,O.boundsBuffer,_.quadTriangleIndexBuffer,O.boundsSegments);else if(_n&&mt){const un=fe.zoom<=h.Z?O.elevatedGlobeSegments:O.getSegmentsForLongitude(fe.center.lng);un&&(gn.draw(_,I.TRIANGLES,ke,h.b6.disabled,ee,h.b5.backCW,Rn,f.id,_n,mt,un),gn.draw(_,I.TRIANGLES,ke,h.b6.disabled,ee,h.b5.frontCW,Rn,f.id,_n,mt,un))}}else{const{tileBoundsBuffer:_n,tileBoundsIndexBuffer:mt,tileBoundsSegments:un}=_.getTileBoundsBuffers(Ce);gn.draw(_,I.TRIANGLES,ke,$e,ee,h.b5.disabled,Rn,f.id,_n,mt,un)}}_.resetStencilClippingMasks()},background:function(_,c,f,v){const w=f.paint.get("background-color"),E=f.paint.get("background-opacity"),S=f.paint.get("background-emissive-strength");if(0===E)return;const I=_.context,O=I.gl,N=_.transform,V=N.tileSize,H=f.paint.get("background-pattern");if(_.isPatternMissing(H,f.scope))return;const G=!H&&1===w.a&&1===E&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==G)return;const Y=h.b6.disabled,ee=_.depthModeForSublayer(0,"opaque"===G?h.b4.ReadWrite:h.b4.ReadOnly),K=_.colorModeForDrapableLayerRenderPass(S),ne=H?"backgroundPattern":"background";let J,oe=v;oe||(J=_.getBackgroundTiles(),oe=Object.values(J).map(_e=>_e.tileID)),H&&(I.activeTexture.set(O.TEXTURE0),_.imageManager.bind(_.context,f.scope));for(const _e of oe){const ye=_.isTileAffectedByFog(_e),re=_.getOrCreateProgram(ne,{overrideFog:ye}),ae=_e.toUnwrapped(),be=v?_e.projMatrix:_.transform.calculateProjMatrix(ae);_.prepareDrawTile();const Se=c?c.getTile(_e):J?J[_e.key]:new h.bt(_e,V,N.zoom,_),Ce=H?Za(be,S,E,_,H,f.scope,{tileID:_e,tileSize:V}):Mu(be,S,E,w);_.uploadCommonUniforms(I,re,ae);const{tileBoundsBuffer:ke,tileBoundsIndexBuffer:lt,tileBoundsSegments:$e}=_.getTileBoundsBuffers(Se);re.draw(_,O.TRIANGLES,ee,Y,K,h.b5.disabled,Ce,f.id,ke,lt,$e)}},sky:function(_,c,f){const v=_._atmosphere?h.ao(_.transform.zoom):1,w=f.paint.get("sky-opacity")*v;if(0===w)return;const E=_.context,S=f.paint.get("sky-type"),I=new h.b4(E.gl.LEQUAL,h.b4.ReadOnly,[0,1]),O=_.frameCounter/1e3%1;"atmosphere"===S?"offscreen"===_.renderPass?f.needsSkyboxCapture(_)&&(function(N,V,H,G){const Y=N.context,ee=Y.gl;let K=V.skyboxFbo;if(!K){K=V.skyboxFbo=Y.createFramebuffer(32,32,!0,null),V.skyboxGeometry=new Ps(Y),V.skyboxTexture=Y.gl.createTexture(),ee.bindTexture(ee.TEXTURE_CUBE_MAP,V.skyboxTexture),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_WRAP_S,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_WRAP_T,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_MIN_FILTER,ee.LINEAR),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_MAG_FILTER,ee.LINEAR);for(let _e=0;_e<6;++_e)ee.texImage2D(ee.TEXTURE_CUBE_MAP_POSITIVE_X+_e,0,ee.RGBA,32,32,0,ee.RGBA,ee.UNSIGNED_BYTE,null)}Y.bindFramebuffer.set(K.framebuffer),Y.viewport.set([0,0,32,32]);const ne=V.getCenter(N,!0),J=N.getOrCreateProgram("skyboxCapture"),oe=new Float64Array(16);h.m.identity(oe),h.m.rotateY(oe,oe,.5*-Math.PI),ya(N,V,J,oe,ne,0),h.m.identity(oe),h.m.rotateY(oe,oe,.5*Math.PI),ya(N,V,J,oe,ne,1),h.m.identity(oe),h.m.rotateX(oe,oe,.5*-Math.PI),ya(N,V,J,oe,ne,2),h.m.identity(oe),h.m.rotateX(oe,oe,.5*Math.PI),ya(N,V,J,oe,ne,3),h.m.identity(oe),ya(N,V,J,oe,ne,4),h.m.identity(oe),h.m.rotateY(oe,oe,Math.PI),ya(N,V,J,oe,ne,5),Y.viewport.set([0,0,N.width,N.height])}(_,f),f.markSkyboxValid(_)):"sky"===_.renderPass&&function(N,V,H,G,Y){const ee=N.context,K=ee.gl,ne=N.transform,J=N.getOrCreateProgram("skybox");ee.activeTexture.set(K.TEXTURE0),K.bindTexture(K.TEXTURE_CUBE_MAP,V.skyboxTexture);const oe={u_matrix:ne.skyboxMatrix,u_sun_direction:V.getCenter(N,!1),u_cubemap:0,u_opacity:G,u_temporal_offset:Y};N.uploadCommonUniforms(ee,J),J.draw(N,K.TRIANGLES,H,h.b6.disabled,N.colorModeForRenderPass(),h.b5.backCW,oe,"skybox",V.skyboxGeometry.vertexBuffer,V.skyboxGeometry.indexBuffer,V.skyboxGeometry.segment)}(_,f,I,w,O):"gradient"===S&&"sky"===_.renderPass&&function(N,V,H,G,Y){const ee=N.context,K=ee.gl,ne=N.transform,J=N.getOrCreateProgram("skyboxGradient");V.skyboxGeometry||(V.skyboxGeometry=new Ps(ee)),ee.activeTexture.set(K.TEXTURE0);let oe=V.colorRampTexture;oe||(oe=V.colorRampTexture=new h.a9(ee,V.colorRamp,K.RGBA)),oe.bind(K.LINEAR,K.CLAMP_TO_EDGE);const _e=(ye=ne.skyboxMatrix,re=V.getCenter(N,!1),ae=V.paint.get("sky-gradient-radius"),be=G,Se=Y,{u_matrix:ye,u_color_ramp:0,u_center_direction:re,u_radius:h.d(ae),u_opacity:be,u_temporal_offset:Se});var ye,re,ae,be,Se;N.uploadCommonUniforms(ee,J),J.draw(N,K.TRIANGLES,H,h.b6.disabled,N.colorModeForRenderPass(),h.b5.backCW,_e,"skyboxGradient",V.skyboxGeometry.vertexBuffer,V.skyboxGeometry.indexBuffer,V.skyboxGeometry.segment)}(_,f,I,w,O)},debug:function(_,c,f,v,w){for(let E=0;E<f.length;E++)if(w){const O=new h.C(.8*v.r,.8*v.g,.8*v.b,1);Bn(_,c,f[E],v,-1,-1),Bn(_,c,f[E],v,-1,1),Bn(_,c,f[E],v,1,1),Bn(_,c,f[E],v,1,-1),Bn(_,c,f[E],O,0,0)}else Bn(_,c,f[E],v,0,0)},custom:function(_,c,f,v){const w=_.context,E=f.implementation;if(!_.transform.projection.unsupportedLayers||!_.transform.projection.unsupportedLayers.includes("custom")||_.terrain&&(_.terrain.renderingToTexture||"offscreen"===_.renderPass)&&f.isLayerDraped(c)){if("offscreen"===_.renderPass){const S=E.prerender;if(S){if(_.setCustomLayerDefaults(),w.setColorMode(_.colorModeForRenderPass()),"globe"===_.transform.projection.name){const I=_.transform.pointMerc;S.call(E,w.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),h.ao(_.transform.zoom),[I.x,I.y],_.transform.pixelsPerMeterRatio)}else S.call(E,w.gl,_.transform.customLayerMatrix());w.setDirty(),_.setBaseState()}}else if("translucent"===_.renderPass){if(_.terrain&&_.terrain.renderingToTexture){const I=E.renderToTile;if(I){const O=v[0].canonical,N=new h.M(O.x+v[0].wrap*(1<<O.z),O.y,O.z);w.setDepthMode(h.b4.disabled),w.setStencilMode(h.b6.disabled),w.setColorMode(_.colorModeForRenderPass()),_.setCustomLayerDefaults(),I.call(E,w.gl,N),w.setDirty(),_.setBaseState()}return}_.setCustomLayerDefaults(),w.setColorMode(_.colorModeForRenderPass()),w.setStencilMode(h.b6.disabled);const S="3d"===E.renderingMode?new h.b4(_.context.gl.LEQUAL,h.b4.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,h.b4.ReadOnly);if(w.setDepthMode(S),"globe"===_.transform.projection.name){const I=_.transform.pointMerc;E.render(w.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),h.ao(_.transform.zoom),[I.x,I.y],_.transform.pixelsPerMeterRatio)}else E.render(w.gl,_.transform.customLayerMatrix());w.setDirty(),_.setBaseState(),w.bindFramebuffer.set(null)}}else h.X("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(_,c,f,v){if("opaque"===_.renderPass)return;const w=f.paint.get("model-opacity");if(0===w)return;const E=f.paint.get("model-cast-shadows");if("shadow"===_.renderPass&&(!E||_.terrain&&w<.65&&f._transitionablePaint._values["model-opacity"].value.expression instanceof h.am))return;const S=_.shadowRenderer,I=f.paint.get("model-receive-shadows");S&&(S.useNormalOffset=!0,I||(S.enabled=!1));const O=()=>{S&&(S.useNormalOffset=!0,I||(S.enabled=!0))},N=c.getSource();if("light-beam"===_.renderPass&&"batched-model"!==N.type)return;if("vector"===N.type||"geojson"===N.type)return function(J,oe,_e,ye){const re=J.transform;if("mercator"!==re.projection.name)return void h.X(`Drawing 3D models for ${re.projection.name} projection is not yet implemented`);const ae=re.getFreeCameraOptions().position;if(!J.modelManager)return;const be=J.modelManager,Se=J.shadowRenderer;if(!_e._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Ce=_e._unevaluatedLayout._values["model-id"],ke={..._e.layout.get("model-id").parameters};for(const lt of ye){const $e=oe.getTile(lt).getBucket(_e);if(!$e||$e.projection.name!==re.projection.name)continue;const Qe=Tl(lt,re);ke.zoom=Qe;const Fe=Ce.possiblyEvaluate(ke);if(ac(J,$e,lt),sr.shadowUniformsInitialized=!1,sr.useSingleShadowCascade=!!Se&&0===Se.getMaxCascadeForTile(lt.toUnwrapped()),"shadow"===J.renderPass&&Se){if(1===J.currentShadowCascade&&$e.isInsideFirstShadowMapFrustum)continue;const Ue=re.calculatePosMatrix(lt.toUnwrapped(),re.worldSize);if(sr.tileMatrix.set(Ue),sr.shadowTileMatrix=Float32Array.from(Se.calculateShadowPassMatrixFromMatrix(Ue)),sr.aabb.min.fill(0),sr.aabb.max[0]=sr.aabb.max[1]=h.J,sr.aabb.max[2]=0,$c($e,sr,J,_e.scope))continue}const ot=1<<lt.canonical.z,Ke=[((ae.x-lt.wrap)*ot-lt.canonical.x)*h.J,(ae.y*ot-lt.canonical.y)*h.J,ae.z*ot*h.J];for(let Ue in $e.instancesPerModel){const fe=$e.instancesPerModel[Ue];fe.features.length>0&&(Ue=Fe.evaluate(fe.features[0].feature,{}));const Ne=be.getModel(Ue,_e.scope);if(Ne&&Ne.uploaded)for(const At of Ne.nodes)va(J,_e,At,fe,Ke,lt,sr)}}}(_,c,f,v),void O();if(!N.loaded())return;if("batched-model"===N.type)return function(J,oe,_e,ye){const re=J.context,ae=J.transform,be=J.style.fog,Se=J.shadowRenderer;if("mercator"!==ae.projection.name)return void h.X(`Drawing 3D landmark models for ${ae.projection.name} projection is not yet implemented`);const Ce=J.transform.getFreeCameraOptions().position,ke=h.v.scale([],[Ce.x,Ce.y,Ce.z],J.transform.worldSize);h.v.negate(ke,ke);const lt=h.m.identity([]),$e=h.c4(ae.center.lat,ae.zoom),Qe=h.m.fromScaling([],[1,1,1/$e]);h.m.translate(lt,lt,ke);const Fe=_e.paint.get("model-opacity"),ot=new h.b4(re.gl.LEQUAL,h.b4.ReadWrite,J.depthRangeFor3D),Ke=new h.b4(re.gl.LEQUAL,h.b4.ReadOnly,J.depthRangeFor3D),Ue=function(fe,Ne){for(const At of ye){const vt=oe.getTile(At).getBucket(_e);if(!vt||!vt.uploaded)continue;let an=!1;Se&&(an=0===Se.getMaxCascadeForTile(At.toUnwrapped()));const Xt=ae.calculatePosMatrix(At.toUnwrapped(),ae.worldSize),mn=vt.modelTraits;for(const nn of vt.getNodesInfo()){if(nn.hiddenByReplacement||!nn.node.meshes)continue;const Rn=nn.node,Pn="light-beam"===J.renderPass,gn=[...Xt],_n=nn.evaluatedScale;let mt=0;J.terrain&&Rn.elevation&&(mt=Rn.elevation*J.terrain.exaggeration()),h.m.translate(gn,gn,[(Rn.anchor?Rn.anchor[0]:0)*(_n[0]-1),(Rn.anchor?Rn.anchor[1]:0)*(_n[1]-1),mt]),_n!==h.c6&&h.m.scale(gn,gn,_n),h.m.multiply(gn,gn,Rn.matrix);const un=h.m.multiply([],Qe,gn);h.m.multiply(un,lt,un);const Mn=h.m.invert([],un);h.m.transpose(Mn,Mn),h.m.scale(Mn,Mn,wi);const Cn=h.m.multiply([],ae.expandedFarZProjMatrix,gn),hr=mn&h.c8.HasMapboxMeshFeatures,na=hr?0:nn.evaluatedRMEA[0][2];for(let zi=0;zi<Rn.meshes.length;++zi){const ci=Rn.meshes[zi],Ni=zi===Rn.lightMeshIndex;if(Ni){if(!Pn&&!J.terrain&&J.shadowRenderer){J.currentLayer<J.firstLightBeamLayer&&(J.firstLightBeamLayer=J.currentLayer);continue}}else if(Pn)continue;const fr={defines:[]},No=[];Rr(fr.defines,No,ci,J),hr||fr.defines.push("DIFFUSE_SHADED"),an&&fr.defines.push("SHADOWS_SINGLE_CASCADE");const yr="shadow"===J.renderPass;if(yr){Pr(ci,gn,J,_e);continue}let Wo=null;if(be){const Bo=yi(gn,J.transform);if(Wo=new Float32Array(Bo),"globe"!==ae.projection.name){const rr=ci.aabb.min,Ca=ci.aabb.max,[kl,uc]=be.getOpacityForBounds(Bo,rr[0],rr[1],Ca[0],Ca[1]);fr.overrideFog=kl>=eo||uc>=eo}}const Er=J.getOrCreateProgram("model",fr);!yr&&Se&&(Se.useNormalOffset=!!ci.normalBuffer,Se.setupShadowsFromMatrix(gn,Er,Se.useNormalOffset)),J.uploadCommonUniforms(re,Er,At.toUnwrapped(),Wo);const Yr=ci.material,ia=Yr.pbrMetallicRoughness;ia.metallicFactor=.9,ia.roughnessFactor=.5;const Os=Vc(new Float32Array(Cn),new Float32Array(un),new Float32Array(Mn),J,Fe,ia.baseColorFactor,Yr.emissiveFactor,ia.metallicFactor,ia.roughnessFactor,Yr,na,_e);Er.draw(J,re.gl.TRIANGLES,Ne&&!Ni?ot:Ke,h.b6.disabled,fe?Ni||Fe<1||nn.hasTranslucentParts?h.a.alphaBlended:h.a.unblended:h.a.disabled,h.b5.backCCW,Os,_e.id,ci.vertexBuffer,ci.indexBuffer,ci.segments,_e.paint,J.transform.zoom,void 0,No)}}}};(function(fe,Ne,At,vt){const an=fe.terrain?fe.terrain.exaggeration():0,Xt=fe.transform.zoom;for(const mn of vt){const nn=Ne.getTile(mn).getBucket(At);nn&&(fe.conflationActive&&nn.updateReplacement(mn,fe.replacementSource),nn.evaluateScale(fe,At),fe.terrain&&an>0&&nn.elevationUpdate(fe.terrain,an,mn,At.source),nn.needsReEvaluation(fe,Xt,At)&&nn.evaluate(At))}})(J,oe,_e,ye),1===Fe?Ue(!0,!0):(Ue(!1,!0),Ue(!0,!1))}(_,c,f,v),void O();const V=N.getModels(),H=[],G=_.transform.getFreeCameraOptions().position,Y=h.v.scale([],[G.x,G.y,G.z],_.transform.worldSize);h.v.negate(Y,Y);const ee=[],K=[];let ne=0;for(const J of V){const oe=f.paint.get("model-rotation").constantOr(null),_e=f.paint.get("model-scale").constantOr(null),ye=f.paint.get("model-translation").constantOr(null);J.computeModelMatrix(_,oe,_e,ye,!0,!0,!1);const re=h.m.identity([]),ae=h.c4(J.position.lat,_.transform.zoom),be=h.m.fromScaling([],[1,1,1/ae]);h.m.translate(re,re,Y),H.push({zScaleMatrix:be,negCameraPosMatrix:re});for(const Se of J.nodes)Hc(_.transform,Se,J.matrix,_.transform.expandedFarZProjMatrix,ne,ee,K);ne++}if(ee.sort((J,oe)=>oe.depth-J.depth),"shadow"!==_.renderPass){if(1===w)for(const J of K)Fo(J,_,f,H[J.modelIndex],h.b6.disabled,_.colorModeForRenderPass());else{for(const J of K)Fo(J,_,f,H[J.modelIndex],h.b6.disabled,h.a.disabled);for(const J of K)Fo(J,_,f,H[J.modelIndex],_.stencilModeFor3D(),_.colorModeForRenderPass());_.resetStencilClippingMasks()}for(const J of ee)Fo(J,_,f,H[J.modelIndex],h.b6.disabled,_.colorModeForRenderPass());O()}else{for(const J of K)Pr(J.mesh,J.nodeModelMatrix,_,f);for(const J of ee)Pr(J.mesh,J.nodeModelMatrix,_,f);O()}}},qo={modelUpload:function(_,c,f){const v=c.getSource();if(!v.loaded())return;if("vector"===v.type||"geojson"===v.type)return void(_.modelManager&&_.modelManager.upload(_,f));if("batched-model"===v.type)return;const w=v.getModels();for(const E of w)E.upload(_.context)}};class Es{constructor(c,f,v,w){this.context=new lr(c,f),this.transform=v,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=w,this._debugParams={showTerrainProxyTiles:!1},w.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),this.setup(),this.numSublayers=h.bq.maxUnderzooming+h.bq.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new h.ca,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Js(this),this._wireframeDebugCache=new Qs,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0}updateTerrain(c,f){const v=!!c&&!!c.terrain&&this.transform.projection.supportsTerrain;if(!(v||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new tc(this,c));const w=this._terrain;this.transform.elevation=v?w:null,w.update(c,this.transform,f),this.transform.elevation&&!w.enabled&&(this.transform.elevation=null)}_updateFog(c){const f=c.fog;if(!f||"globe"===this.transform.projection.name||f.getOpacity(this.transform.pitch)<1||f.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[v,w]=f.getFovAdjustedRange(this.transform._fov);if(v>w)return void(this.transform.fogCullDistSq=null);const E=v+.78*(w-v);this.transform.fogCullDistSq=E*E}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(c,f){if(this.width=c*h.a4.devicePixelRatio,this.height=f*h.a4.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style.order)this.style._mergedLayers[v].resize()}setup(){const c=this.context,f=new h.bo;f.emplaceBack(0,0),f.emplaceBack(h.J,0),f.emplaceBack(0,h.J),f.emplaceBack(h.J,h.J),this.tileExtentBuffer=c.createVertexBuffer(f,h.bl.members),this.tileExtentSegments=h.bm.simpleSegment(0,0,4,2);const v=new h.bo;v.emplaceBack(0,0),v.emplaceBack(h.J,0),v.emplaceBack(0,h.J),v.emplaceBack(h.J,h.J),this.debugBuffer=c.createVertexBuffer(v,h.bl.members),this.debugSegments=h.bm.simpleSegment(0,0,4,5);const w=new h.bo;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(-1,1),w.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(w,h.bl.members),this.viewportSegments=h.bm.simpleSegment(0,0,4,2);const E=new h.cb;E.emplaceBack(0,0,0,0),E.emplaceBack(h.J,0,h.J,0),E.emplaceBack(0,h.J,0,h.J),E.emplaceBack(h.J,h.J,h.J,h.J),this.mercatorBoundsBuffer=c.createVertexBuffer(E,h.cc.members),this.mercatorBoundsSegments=h.bm.simpleSegment(0,0,4,2);const S=new h.bp;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(S);const I=new h.cd;for(const N of[0,1,3,2,0])I.emplaceBack(N);this.debugIndexBuffer=c.createIndexBuffer(I),this.emptyTexture=new h.a9(c,new h.a5({width:1,height:1},Uint8Array.of(0,0,0,0)),c.gl.RGBA),this.identityMat=h.m.create();const O=this.context.gl;this.stencilClearMode=new h.b6({func:O.ALWAYS,mask:0},0,255,O.ZERO,O.ZERO,O.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(c){return c._makeTileBoundsBuffers(this.context,this.transform.projection),c._tileBoundsBuffer?{tileBoundsBuffer:c._tileBoundsBuffer,tileBoundsIndexBuffer:c._tileBoundsIndexBuffer,tileBoundsSegments:c._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const c=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,c.TRIANGLES,h.b4.disabled,this.stencilClearMode,h.a.disabled,h.b5.disabled,Bc(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(c,f,v){if(!f||this.currentStencilSource===f.id||!c.isTileClipped()||!v||0===v.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let I=!1;for(const O of v)if(void 0===this._tileClippingMaskIDs[O.key]){I=!0;break}if(!I)return}this.currentStencilSource=f.id;const w=this.context,E=w.gl;this.nextStencilID+v.length>256&&this.clearStencil(),w.setColorMode(h.a.disabled),w.setDepthMode(h.b4.disabled);const S=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const I of v){const O=f.getTile(I),N=this._tileClippingMaskIDs[I.key]=this.nextStencilID++,{tileBoundsBuffer:V,tileBoundsIndexBuffer:H,tileBoundsSegments:G}=this.getTileBoundsBuffers(O);S.draw(this,E.TRIANGLES,h.b4.disabled,new h.b6({func:E.ALWAYS,mask:0},N,255,E.KEEP,E.KEEP,E.REPLACE),h.a.disabled,h.b5.disabled,Bc(I.projMatrix),"$clipping",V,H,G)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,f=this.context.gl;return new h.b6({func:f.NOTEQUAL,mask:255},c,255,f.KEEP,f.KEEP,f.REPLACE)}stencilModeForClipping(c){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(c);const f=this.context.gl;return new h.b6({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,f.KEEP,f.KEEP,f.REPLACE)}stencilConfigForOverlap(c){const f=this.context.gl,v=c.sort((S,I)=>I.overscaledZ-S.overscaledZ),w=v[v.length-1].overscaledZ,E=v[0].overscaledZ-w+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const S={};for(let I=0;I<E;I++)S[I+w]=new h.b6({func:f.GEQUAL,mask:255},I+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=E,[S,v]}return[{[w]:h.b6.disabled},v]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new h.a([c.CONSTANT_COLOR,c.ONE,c.CONSTANT_COLOR,c.ONE],new h.C(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?h.a.unblended:h.a.alphaBlended}colorModeForDrapableLayerRenderPass(c){const f=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&"translucent"===this.renderPass?new h.a([f.ONE,f.ONE_MINUS_SRC_ALPHA,f.CONSTANT_ALPHA,f.ONE_MINUS_SRC_ALPHA],new h.C(0,0,0,void 0===c?0:c),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(c,f,v,w=!1){if(!this.opaquePassEnabledForLayer()&&!w)return h.b4.disabled;const E=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new h.b4(v||this.context.gl.LEQUAL,f,[E,E])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,f){this._wireframeDebugCache.update(this.frameCounter),this.style=c,this.options=f;const v=this.style._mergedLayers,w=this.style.order,E=w.map(re=>v[re]),S=this.style._mergedSourceCaches;this.imageManager=c.imageManager,this.modelManager=c.modelManager,this.symbolFadeChange=c.placement.symbolFadeChange(h.a4.now()),this.imageManager.beginFrame();let I=0,O=!1;for(const re in S){const ae=S[re];ae.used&&(ae.prepare(this.context),ae.getSource().usedInConflation&&++I)}const N={},V={},H={},G={},Y={};for(const re in S){const ae=S[re];N[re]=ae.getVisibleCoordinates(),V[re]=N[re].slice().reverse(),H[re]=ae.getVisibleCoordinates(!0).reverse(),G[re]=ae.getShadowCasterCoordinates(),Y[re]=ae.sortCoordinatesByDistance(N[re])}const ee=re=>{const ae=this.style.getLayerSourceCache(re);return ae&&ae.used?ae.getSource():null};if(I){const re=[];for(const ae of E)this.layerUsedInConflation(ae,ee(ae))&&re.push(ae);if(re&&re.length>1){const ae=[];for(const be of re){const Se=this.style.getLayerSourceCache(be);Se&&Se.used&&Se.getSource().usedInConflation&&ae.push({layer:be.fqid,cache:Se})}this.replacementSource.setSources(ae),O=!0}}O||this.replacementSource.clear(),this.conflationActive=O,this.minCutoffZoom=0,this.longestCutoffRange=0;for(const re of E){const ae=re.cutoffRange();if(this.longestCutoffRange=Math.max(ae,this.longestCutoffRange),ae>0){const be=ee(re);be&&(this.minCutoffZoom=Math.max(be.minzoom,this.minCutoffZoom)),re.minzoom&&(this.minCutoffZoom=Math.max(re.minzoom,this.minCutoffZoom))}}this.opaquePassCutoff=1/0;for(let re=0;re<E.length;re++)if(E[re].is3D()){this.opaquePassCutoff=re;break}const K=this.style&&this.style.fog;K?(this._fogVisible=0!==K.getOpacity(this.transform.pitch),this._fogVisible&&"globe"!==this.transform.projection.name&&(this._fogVisible=K.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(H),this.opaquePassCutoff=0);const ne=this._shadowRenderer;if(ne){ne.updateShadowParameters(this.transform,this.style.directionalLight);for(const re in S)for(const ae of N[re]){let be={min:0,max:0};this.terrain&&(be=this.terrain.getMinMaxForTile(ae)||be),ne.addShadowReceiver(ae.toUnwrapped(),be.min,be.max)}}"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new h.ce(this.context));for(const re of E){if(re.isHidden(this.transform.zoom))continue;const ae=c.getLayerSourceCache(re);this.uploadLayer(this,re,ae)}if(this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new kn(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!h.cf(this.context.gl))return;this.renderPass="offscreen";for(const re of E){const ae=c.getLayerSourceCache(re);if(!re.hasOffscreenPass()||re.isHidden(this.transform.zoom))continue;const be=ae?V[ae.id]:void 0;("custom"===re.type||"raster"===re.type||re.isSky()||be&&be.length)&&this.renderLayer(this,ae,re,be)}this.depthRangeFor3D=[0,1-(E.length+2)*this.numSublayers*this.depthEpsilon];const J=this.terrain;J&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&J.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,G)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const oe="globe"===this.transform.projection.name||this.transform.isHorizonVisible(),_e=(()=>{if(f.showOverdrawInspector)return h.C.black;if(this.style.fog&&this.transform.projection.supportsFog&&!oe){const re=this.style.fog.properties.get("color").toArray01();return new h.C(...re)}if(this.style.fog&&this.transform.projection.supportsFog&&oe){const re=this.style.fog.properties.get("space-color").toArray01();return new h.C(...re)}return h.C.transparent})();if(this.context.clear({color:_e,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&oe&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const re=E[this.currentLayer],ae=c.getLayerSourceCache(re);if(re.isSky())continue;const be=ae?(re.is3D()?Y:V)[ae.id]:void 0;this._renderTileClippingMasks(re,ae,be),this.renderLayer(this,ae,re,be)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&oe&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||h.ao(this.transform.zoom)>0)&&("globe"===this.transform.projection.name||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const re=E[this.currentLayer],ae=c.getLayerSourceCache(re);re.isSky()&&this.renderLayer(this,ae,re,ae?V[ae.id]:void 0)}this.renderPass="translucent",this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let ye=0;for(ne&&(ye=ne.getShadowCastingLayerCount());this.currentLayer<w.length;){const re=E[this.currentLayer],ae=c.getLayerSourceCache(re);if(re.isSky()){++this.currentLayer;continue}if(J&&this.style.isLayerDraped(re)){if(re.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=J.renderBatch(this.currentLayer);continue}let be;if(ae&&(be=("symbol"===re.type?H:re.is3D()?Y:V)[ae.id]),this._renderTileClippingMasks(re,ae,ae?N[ae.id]:void 0),this.renderLayer(this,ae,re,be),!J&&ne&&ye>0&&re.hasShadowPass()&&0==--ye&&(ne.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Se=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Se;this.currentLayer++){const Ce=E[this.currentLayer];if(!Ce.hasLightBeamPass())continue;const ke=c.getLayerSourceCache(Ce);this.renderLayer(this,ke,Ce,ke?V[ke.id]:void 0)}this.currentLayer=Se,this.renderPass="translucent"}++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let re=null;E.forEach(ae=>{const be=c.getLayerSourceCache(ae);be&&!ae.isHidden(this.transform.zoom)&&be.getVisibleCoordinates().length&&(!re||re.getSource().maxzoom<be.getSource().maxzoom)&&(re=be)}),re&&this.options.showTileBoundaries&&lc.debug(this,re,re.getVisibleCoordinates(),h.C.red,!1)}this.terrain&&this._debugParams.showTerrainProxyTiles&&lc.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new h.C(1,.8,.1,1),!0),this.options.showPadding&&function(re){const ae=re.transform.padding;vo(re,re.transform.height-(ae.top||0),3,Ph),vo(re,ae.bottom||0,3,Oh),Fi(re,ae.left||0,3,Ji),Fi(re,re.transform.width-(ae.right||0),3,Td);const be=re.transform.centerPoint;var Se,Ce,ke,lt;kr(Se=re,(Ce=be.x)-1,(ke=re.transform.height-be.y)-10,2,20,lt=Fh),kr(Se,Ce-10,ke-1,20,2,lt)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),O||(this.conflationActive=!1)}uploadLayer(c,f,v){this.gpuTimingStart(f),(!c.transform.projection.unsupportedLayers||!c.transform.projection.unsupportedLayers.includes(f.type)||c.terrain&&"custom"===f.type)&&qo[`${f.type}Upload`]&&qo[`${f.type}Upload`](c,v,f.scope),this.gpuTimingEnd()}renderLayer(c,f,v,w){v.isHidden(this.transform.zoom)||("background"===v.type||"sky"===v.type||"custom"===v.type||"model"===v.type||"raster"===v.type||w&&w.length)&&(this.id=v.id,this.gpuTimingStart(v),(!c.transform.projection.unsupportedLayers||!c.transform.projection.unsupportedLayers.includes(v.type)||c.terrain&&"custom"===v.type)&&lc[v.type](c,f,v,w,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const f=this.context.extTimerQuery,v=this.context.gl;let w=this.gpuTimers[c.id];w||(w=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:v.createQuery()}),w.calls++,v.beginQuery(f.TIME_ELAPSED_EXT,w.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const c=this.context.extTimerQuery,f=this.context.gl,v=f.createQuery();this.deferredRenderGpuTimeQueries.push(v),f.beginQuery(c.TIME_ELAPSED_EXT,v)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}collectDeferredRenderGpuQueries(){const c=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],c}queryGpuTimers(c){const f={};for(const v in c){const w=c[v],E=this.context.extTimerQuery,S=E.getQueryParameter(w.query,this.context.gl.QUERY_RESULT)/1e6;E.deleteQueryEXT(w.query),f[v]=S}return f}queryGpuTimeDeferredRender(c){if(!this.options.gpuTimingDeferredRender)return 0;const f=this.context.extTimerQuery,v=this.context.gl;let w=0;for(const E of c)w+=f.getQueryParameter(E,v.QUERY_RESULT)/1e6,f.deleteQueryEXT(E);return w}translatePosMatrix(c,f,v,w,E){if(!v[0]&&!v[1])return c;const S=E?"map"===w?this.transform.angle:0:"viewport"===w?-this.transform.angle:0;if(S){const N=Math.sin(S),V=Math.cos(S);v=[v[0]*V-v[1]*N,v[0]*N+v[1]*V]}const I=[E?v[0]:h.ay(f,v[0],this.transform.zoom),E?v[1]:h.ay(f,v[1],this.transform.zoom),0],O=new Float32Array(16);return h.m.translate(O,c,I),O}saveTileTexture(c){const f=c.size[0],v=this._tileTextures[f];v?v.push(c):this._tileTextures[f]=[c]}getTileTexture(c){const f=this._tileTextures[c];return f&&f.length>0?f.pop():null}isPatternMissing(c,f){return null===c||void 0!==c&&!this.imageManager.getPattern(c.toString(),f)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}linearFloatFilteringSupported(){return null!=this.context.extTextureFloatLinear}currentGlobalDefines(c,f,v){const w=void 0===v?this.terrain&&this.terrain.renderingToTexture:v,E=this.terrain&&0===this.terrain.exaggeration(),S=[];return this.style&&this.style.enable3dLights()&&("globeRaster"===c||"terrainRaster"===c?(S.push("LIGHTING_3D_MODE"),S.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):w||S.push("LIGHTING_3D_MODE")),"shadow"===this.renderPass?this._shadowMapDebug||S.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?S.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):S.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(S.push("TERRAIN"),this.linearFloatFilteringSupported()&&S.push("TERRAIN_DEM_FLOAT_FORMAT"),E&&S.push("ZERO_EXAGGERATION")),"globe"===this.transform.projection.name&&S.push("GLOBE"),!this._fogVisible||w||void 0!==f&&!f||S.push("FOG","FOG_DITHERING"),w&&S.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&S.push("OVERDRAW_INSPECTOR"),S}getOrCreateProgram(c,f){this.cache=this.cache||{};const v=f&&f.defines||[],w=f&&f.config,E=this.currentGlobalDefines(c,f&&f.overrideFog,f&&f.overrideRtt).concat(v),S=Du.cacheKey(yd[c],c,E,w);return this.cache[S]||(this.cache[S]=new Du(this.context,c,yd[c],w,Cd[c],E)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new h.a9(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(c,f){if(this.style.enable3dLights()){const v=this.style.directionalLight,w=this.style.ambientLight;if(v&&w){const E=((S,I)=>{const O=S.properties.get("direction"),N=S.properties.get("color").toArray01(),V=S.properties.get("intensity"),H=I.properties.get("color").toArray01(),G=I.properties.get("intensity"),Y=[O.x,O.y,O.z],ee=h.bv(H,G),K=h.bv(N,V);return{u_lighting_ambient_color:ee,u_lighting_directional_dir:Y,u_lighting_directional_color:K,u_ground_radiance:nc(Y,K,ee)}})(v,w);f.setLightsUniformValues(c,E)}}}uploadCommonUniforms(c,f,v,w,E){if(this.uploadCommonLightUniforms(c,f),this.terrain&&this.terrain.renderingToTexture)return;const S=this.style.fog;if(S){const I=S.getOpacity(this.transform.pitch),O=((N,V,H,G,Y,ee,K,ne,J,oe,_e,ye)=>{const re=N.transform,ae=V.properties.get("color").toArray01();ae[3]=G;const be=N.frameCounter/1e3%1,[Se,Ce]=V.properties.get("vertical-range");return{u_fog_matrix:H?re.calculateFogTileMatrix(H):ye||N.identityMat,u_fog_range:V.getFovAdjustedRange(re._fov),u_fog_color:ae,u_fog_horizon_blend:V.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Se,Ce),Ce],u_fog_temporal_offset:be,u_frustum_tl:Y,u_frustum_tr:ee,u_frustum_br:K,u_frustum_bl:ne,u_globe_pos:J,u_globe_radius:oe,u_viewport:_e,u_globe_transition:h.ao(re.zoom),u_is_globe:+("globe"===re.projection.name)}})(this,S,v,I,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*h.a4.devicePixelRatio,this.transform.height*h.a4.devicePixelRatio],w);f.setFogUniformValues(c,O)}E&&f.setCutoffUniformValues(c,E.uniformValues)}setTileLoadedFlag(c){this.tileLoaded=c}saveCanvasCopy(){const c=this.canvasCopy();c&&(this.frameCopies.push(c),this.tileLoaded=!1)}canvasCopy(){const c=this.context.gl,f=c.createTexture();return c.bindTexture(c.TEXTURE_2D,f),c.copyTexImage2D(c.TEXTURE_2D,0,c.RGBA,0,0,c.drawingBufferWidth,c.drawingBufferHeight,0),f}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const c=this.style&&this.style.fog;return!!c&&0!==c.getOpacity(this.transform.pitch)}getBackgroundTiles(){const c=this._backgroundTiles,f=this._backgroundTiles={},v=this.transform.coveringTiles({tileSize:512});for(const w of v)f[w.key]=c[w.key]||new h.bt(w,512,this.transform.tileZoom,this);return f}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(c,f){return!(!c.is3D()||c.minzoom&&c.minzoom>this.transform.zoom||"building"!==c.sourceLayer&&(!f||"batched-model"!==f.type))}isTileAffectedByFog(c){if(!this.style||!this.style.fog)return!1;if("globe"===this.transform.projection.name)return!0;let f=this._cachedTileFogOpacities[c.key];return f||(this._cachedTileFogOpacities[c.key]=f=this.style.fog.getOpacityForTile(c)),f[0]>=eo||f[1]>=eo}}const Ui={cascadeCount:2,shadowMapResolution:2048};class Kf{constructor(c,f){this.aabb=c,this.lastCascade=f}}class ba{add(c,f){const v=this.receivers[c.key];void 0!==v?(v.aabb.min[0]=Math.min(v.aabb.min[0],f.min[0]),v.aabb.min[1]=Math.min(v.aabb.min[1],f.min[1]),v.aabb.min[2]=Math.min(v.aabb.min[2],f.min[2]),v.aabb.max[0]=Math.max(v.aabb.max[0],f.max[0]),v.aabb.max[1]=Math.max(v.aabb.max[1],f.max[1]),v.aabb.max[2]=Math.max(v.aabb.max[2],f.max[2])):this.receivers[c.key]=new Kf(f,null)}clear(){this.receivers={}}get(c){return this.receivers[c.key]}computeRequiredCascades(c,f,v){const w=h.c3.fromPoints(c.points);let E=0;for(const S in this.receivers){const I=this.receivers[S];if(!I||!w.intersectsAabb(I.aabb))continue;I.aabb.min=w.closestPoint(I.aabb.min),I.aabb.max=w.closestPoint(I.aabb.max);const O=I.aabb.getCorners();for(let N=0;N<v.length;N++){let V=!0;for(const H of O){const G=[H[0]*f,H[1]*f,H[2]];if(h.v.transformMat4(G,G,v[N].matrix),G[0]<-1||G[0]>1||G[1]<-1||G[1]>1){V=!1;break}}if(I.lastCascade=N,E=Math.max(E,N),V)break}}return E+1}}class Js{constructor(c){this.painter=c,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new ba,this._depthMode=new h.b4(c.context.gl.LEQUAL,h.b4.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1,c.tp.registerParameter(Ui,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),c.tp.registerParameter(Ui,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32})}destroy(){for(const c of this._cascades)c.texture.destroy(),c.framebuffer.destroy();this._cascades=[]}updateShadowParameters(c,f){const v=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!f||!f.properties)return;const w=f.properties.get("shadow-intensity");if(!f.shadowsEnabled()||w<=0||(this._shadowLayerCount=v.style.order.reduce((ee,K)=>{const ne=v.style._mergedLayers[K];return ee+(ne.hasShadowPass()&&!ne.isHidden(c.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const E=v.context,S=Ui.shadowMapResolution,I=Ui.shadowMapResolution;if(0===this._cascades.length||Ui.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ee=0;ee<Ui.cascadeCount;++ee){const K=v._shadowMapDebug,ne=E.gl,J=E.createFramebuffer(S,I,K,"texture"),oe=new h.a9(E,{width:S,height:I,data:null},ne.DEPTH_COMPONENT);if(J.depthAttachment.set(oe.texture),K){const _e=new h.a9(E,{width:S,height:I,data:null},ne.RGBA);J.colorAttachment.set(_e.texture)}this._cascades.push({framebuffer:J,texture:oe,matrix:[],far:0,boundingSphereRadius:0,frustum:new h.F,scale:0})}}this.shadowDirection=cc(f);let O=0;if(c.elevation){const ee=c.elevation,K=[1e4,-1e4];ee.visibleDemTiles.filter(ne=>ne.dem).forEach(ne=>{const J=ne.dem.tree;K[0]=Math.min(K[0],J.minimums[0]),K[1]=Math.max(K[1],J.maximums[0])}),1e4!==K[0]&&(O=(K[1]-K[0])*ee.exaggeration())}const N=1.5*c.cameraToCenterDistance,V=3*N,H=new Float64Array(16);for(let ee=0;ee<this._cascades.length;++ee){const K=this._cascades[ee];let ne=c.height/50,J=1;1===Ui.cascadeCount?J=V:0===ee?J=N:(ne=N,J=V);const[oe,_e]=Am(c,this.shadowDirection,ne,J,Ui.shadowMapResolution,O);K.scale=c.scale,K.matrix=oe,K.boundingSphereRadius=_e,h.m.invert(H,K.matrix),K.frustum=h.F.fromInvProjectionMatrix(H,1,0,!0),K.far=J}const G=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[G].far,this._cascades[G].far],this._uniformValues.u_shadow_intensity=w,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Ui.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Ui.shadowMapResolution,this._uniformValues.u_shadowmap_0=Do.ShadowMap0,this._uniformValues.u_shadowmap_1=Do.ShadowMap0+1,this._groundShadowTiles=v.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const Y=v.transform.elevation;for(const ee of this._groundShadowTiles){let K={min:0,max:0};if(Y){const ne=Y.getMinMaxForTile(ee);ne&&(K=ne)}this.addShadowReceiver(ee.toUnwrapped(),K.min,K.max)}}get enabled(){return this._enabled}set enabled(c){this._enabled=c}drawShadowPass(c,f){if(!this._enabled)return;const v=this.painter,w=v.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(v.transform.getFrustum(0),v.transform.worldSize,this._cascades),w.viewport.set([0,0,Ui.shadowMapResolution,Ui.shadowMapResolution]);for(let E=0;E<this._numCascadesToRender;++E){v.currentShadowCascade=E,w.bindFramebuffer.set(this._cascades[E].framebuffer.framebuffer),w.clear({color:h.C.white,depth:1});for(const S of c.order){const I=c._mergedLayers[S];if(!I.hasShadowPass()||I.isHidden(v.transform.zoom))continue;const O=c.getLayerSourceCache(I),N=O?f[O.id]:void 0;("model"===I.type||N&&N.length)&&v.renderLayer(v,O,I,N)}}v.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const c=this.painter,f=c.style,v=c.context,w=f.directionalLight,E=f.ambientLight;if(!w||!E)return;const S=[],I=Nc(c,c.longestCutoffRange);I.shouldRenderCutoff&&S.push("RENDER_CUTOFF");const O=Li(w,E),N=new h.b4(v.gl.LEQUAL,h.b4.ReadOnly,c.depthRangeFor3D);for(const V of this._groundShadowTiles){const H=V.toUnwrapped(),G=c.isTileAffectedByFog(V),Y=c.getOrCreateProgram("groundShadow",{defines:S,overrideFog:G});this.setupShadows(H,Y),c.uploadCommonUniforms(v,Y,H,null,I);const ee={u_matrix:c.transform.calculateProjMatrix(H),u_ground_shadow_factor:O};Y.draw(c,v.gl.TRIANGLES,N,h.b6.disabled,h.a.multiply,h.b5.disabled,ee,"ground_shadow",c.tileExtentBuffer,c.quadTriangleIndexBuffer,c.tileExtentSegments,{},c.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?h.a.unblended:h.a.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(c){const f=this.painter.transform,v=f.calculatePosMatrix(c,f.worldSize);return h.m.multiply(v,this._cascades[this.painter.currentShadowCascade].matrix,v),Float32Array.from(v)}calculateShadowPassMatrixFromMatrix(c){return h.m.multiply(c,this._cascades[this.painter.currentShadowCascade].matrix,c),Float32Array.from(c)}setupShadows(c,f,v,w=0){if(!this._enabled)return;const E=this.painter.transform,S=this.painter.context,I=S.gl,O=this._uniformValues,N=new Float64Array(16),V=E.calculatePosMatrix(c,E.worldSize);for(let H=0;H<this._cascades.length;H++)h.m.multiply(N,this._cascades[H].matrix,V),O[0===H?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(N),S.activeTexture.set(I.TEXTURE0+Do.ShadowMap0+H),this._cascades[H].texture.bind(I.NEAREST,I.CLAMP_TO_EDGE);if(this.useNormalOffset=!!v,this.useNormalOffset){const H=h.cg(c.canonical),G=2/E.tileSize*h.J/Ui.shadowMapResolution,Y=G*this._cascades[0].boundingSphereRadius,ee=G*this._cascades[this._cascades.length-1].boundingSphereRadius,K=("vector-tile"===v?1:3)/Math.pow(2,w-c.canonical.z-(1-E.zoom+Math.floor(E.zoom)));O.u_shadow_normal_offset=[H,Y*K,ee*K],O.u_shadow_bias=[6e-5,.0012,.012]}else O.u_shadow_bias=[36e-5,.0012,.012];f.setShadowUniformValues(S,O)}setupShadowsFromMatrix(c,f,v=!1){if(!this._enabled)return;const w=this.painter.context,E=w.gl,S=this._uniformValues,I=new Float64Array(16);for(let O=0;O<Ui.cascadeCount;O++)h.m.multiply(I,this._cascades[O].matrix,c),S[0===O?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(I),w.activeTexture.set(E.TEXTURE0+Do.ShadowMap0+O),this._cascades[O].texture.bind(E.NEAREST,E.CLAMP_TO_EDGE);this.useNormalOffset=v,v?(S.u_shadow_normal_offset=[1,5,5],S.u_shadow_bias=[6e-5,.0012,.012]):S.u_shadow_bias=[36e-5,.0012,.012],f.setShadowUniformValues(w,S)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(c,f,v,w){if(w[2]>=0)return{};const E=function(O,N,V){const H=V/(1<<O.canonical.z);return new h.c3([O.canonical.x*H+O.wrap*V,O.canonical.y*H+O.wrap*V,0],[(O.canonical.x+1)*H+O.wrap*V,(O.canonical.y+1)*H+O.wrap*V,N])}(c,f,v).getCorners(),S=f/-w[2];w[0]<0?(h.v.add(E[0],E[0],[w[0]*S,0,0]),h.v.add(E[3],E[3],[w[0]*S,0,0])):w[0]>0&&(h.v.add(E[1],E[1],[w[0]*S,0,0]),h.v.add(E[2],E[2],[w[0]*S,0,0])),w[1]<0?(h.v.add(E[0],E[0],[0,w[1]*S,0]),h.v.add(E[1],E[1],[0,w[1]*S,0])):w[1]>0&&(h.v.add(E[2],E[2],[0,w[1]*S,0]),h.v.add(E[3],E[3],[0,w[1]*S,0]));const I={};return I.vertices=E,I.planes=[Xa(E[1],E[0],E[4]),Xa(E[2],E[1],E[5]),Xa(E[3],E[2],E[6]),Xa(E[0],E[3],E[7])],I}addShadowReceiver(c,f,v){this._receivers.add(c,h.c3.fromTileIdAndHeight(c,f,v))}getMaxCascadeForTile(c){const f=this._receivers.get(c);return f&&f.lastCascade?f.lastCascade:0}}function Xa(_,c,f){const v=h.v.sub([],f,c),w=h.v.sub([],_,c),E=h.v.cross([],v,w),S=h.v.length(E);return 0===S?[0,0,1,0]:(h.v.scale(E,E,1/S),[E[0],E[1],E[2],-h.v.dot(E,c)])}function cc(_){const c=_.properties.get("direction"),f=h.b3(c.x,c.y,c.z);f[2]=h.c(f[2],0,75);const v=h.ch([f[0],f[1],f[2]]);return h.v.fromValues(v.x,v.y,v.z)}function Li(_,c){const f=_.properties.get("color"),v=_.properties.get("intensity"),w=_.properties.get("direction"),E=[w.x,w.y,w.z],S=c.properties.get("color"),I=c.properties.get("intensity"),O=Math.max(h.v.dot([0,0,1],E),0),N=[0,0,0];h.v.scale(N,S.toArray01Linear().slice(0,3),I);const V=[0,0,0];return h.v.scale(V,f.toArray01Linear().slice(0,3),O*v),h.bw([N[0]>0?N[0]/(N[0]+V[0]):0,N[1]>0?N[1]/(N[1]+V[1]):0,N[2]>0?N[2]/(N[2]+V[2]):0])}function Am(_,c,f,v,w,E){const S=_.zoom,I=_.scale,O=_.worldSize,N=1/O,V=_.aspect,H=Math.sqrt(1+V*V)*Math.tan(.5*_.fovX),G=H*H,Y=v-f,ee=v+f;let K,ne;G>Y/ee?(K=v,ne=v*H):(K=.5*ee*(1+G),ne=.5*Math.sqrt(Y*Y+2*(v*v+f*f)*G+ee*ee*G*G));const J=_.projection.pixelsPerMeter(_.center.lat,O),oe=_._camera.getCameraToWorldMercator(),_e=[0,0,-K*N];h.v.transformMat4(_e,_e,oe);let ye=ne*N;const re=_._edgeInsets;if(!(0===re.left&&0===re.top&&0===re.right&&0===re.bottom||re.left===re.right&&re.top===re.bottom)){const vt=_._camera.getWorldToCamera(_.worldSize,"meters"===_.projection.zAxisUnit?J:1),an=_._camera.getCameraToClipPerspective(_._fov,_.width/_.height,f,v);an[8]=2*-_.centerOffset.x/_.width,an[9]=2*_.centerOffset.y/_.height;const Xt=new Float64Array(16);h.m.mul(Xt,an,vt);const mn=new Float64Array(16);h.m.invert(mn,Xt);const nn=h.F.fromInvProjectionMatrix(mn,O,S,!0);for(const Rn of nn.points){const Pn=((ae=Rn)[0]/=I,ae[1]/=I,ae[2]=h.b(ae[2],_._center.lat),ae);ye=Math.max(ye,h.v.len(h.v.subtract([],_e,Pn)))}}var ae;ye*=w/(w-1);const be=Math.acos(c[2]),Se=Math.atan2(-c[0],-c[1]),Ce=new vs;Ce.position=_e,Ce.setPitchBearing(be,Se);const ke=Ce.getWorldToCamera(O,J),lt=ye*O,$e=Math.min(_._mercatorZfromZoom(17)*O*-2,-2*lt),Qe=Ce.getCameraToClipOrthographic(-lt,lt,-lt,lt,$e,(lt+E*J)/c[2]),Fe=new Float64Array(16);h.m.multiply(Fe,Qe,ke);const ot=h.v.fromValues(Math.floor(1e6*_e[0])/1e6*O,Math.floor(1e6*_e[1])/1e6*O,0),Ke=.5*w,Ue=[0,0,0];h.v.transformMat4(Ue,ot,Fe),h.v.scale(Ue,Ue,Ke);const fe=[Math.floor(Ue[0]),Math.floor(Ue[1]),Math.floor(Ue[2])],Ne=[0,0,0];h.v.sub(Ne,Ue,fe),h.v.scale(Ne,Ne,-1/Ke);const At=new Float64Array(16);return h.m.identity(At),h.m.translate(At,At,Ne),h.m.multiply(Fe,At,Fe),[Fe,lt]}class Ou extends h.a6{constructor(c){super(),this.requestManager=c,this.models={"":{}},this.numModelsLoading={}}loadModel(c,f){return h.aO(this.requestManager.transformRequest(f,h.a2.Model).url).then(v=>{if(!v)return;const w=h.aP(v),E=new h.aQ(c,void 0,void 0,w);return E.computeBoundsAndApplyParent(),E}).catch(v=>{this.fire(new h.a7(new Error(`Could not load model ${c} from ${f}: ${v.message}`)))})}load(c,f){this.models[f]||(this.models[f]={});const v=Object.keys(c);this.numModelsLoading[f]=(this.numModelsLoading[f]||0)+v.length;const w=[];for(const E of v)w.push(this.loadModel(E,c[E]));Promise.allSettled(w).then(E=>{for(let S=0;S<E.length;S++){const{status:I,value:O}=E[S];"fulfilled"===I&&O&&(this.models[f][v[S]]=O)}this.numModelsLoading[f]-=v.length,this.fire(new h.a8("data",{dataType:"style"}))}).catch(E=>{this.fire(new h.a7(new Error(`Could not load models: ${E.message}`)))})}isLoaded(){for(const c in this.numModelsLoading)if(this.numModelsLoading[c]>0)return!1;return!0}hasModel(c,f){return!!this.getModel(c,f)}getModel(c,f){return this.models[f]||(this.models[f]={}),this.models[f][c]}addModel(c,f,v){this.models[v]||(this.models[v]={}),this.hasModel(c,v)&&this.removeModel(c,v),this.load({[c]:this.requestManager.normalizeModelURL(f)},v)}addModels(c,f){const v={};for(const w in c)v[w]=this.requestManager.normalizeModelURL(c[w]);this.load(v,f)}removeModel(c,f){this.models[f]||(this.models[f]={});const v=this.models[f][c];delete this.models[f][c],v.destroy()}listModels(c){return this.models[c]||(this.models[c]={}),Object.keys(this.models[c])}upload(c,f){this.models[f]||(this.models[f]={});for(const v in this.models[f])this.models[f][v].upload(c.context)}}const Ka=(_,c)=>h.ai(_,c&&c.filter(f=>"source.canvas"!==f.identifier)),hs=h.p(pt,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","setImportUrl","setImportData","setImportConfig"]),Q=h.p(pt,["setCenter","setZoom","setBearing","setPitch"]),L={version:8,layers:[],sources:{}},U={duration:300,delay:0},X=new Set(["fill","line","background","hillshade","raster"]);class Ae extends h.a6{constructor(c,f={}){super(),this.map=c,this.scope=f.scope||"",this.fragments=[],this.importDepth=f.importDepth||0,this.importsCache=f.importsCache||new Map,this.resolvedImports=f.resolvedImports||new Set,this.transition=h.ak({},U),this._buildingIndex=new Gn(this),this.crossTileSymbolIndex=new Ut,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=f.styleChanges||new Le,this.dispatcher=f.dispatcher?f.dispatcher:new h.br(h.bs(),this),f.imageManager?this.imageManager=f.imageManager:(this.imageManager=new Ir,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=f.glyphManager?f.glyphManager:new h.cj(c._requestManager,f.localFontFamily?h.ck.all:f.localIdeographFontFamily?h.ck.ideographs:h.ck.none,f.localFontFamily||f.localIdeographFontFamily),f.modelManager?this.modelManager=f.modelManager:(this.modelManager=new Ou(c._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=f.configOptions?f.configOptions:new Map,this._configDependentLayers=f.configDependentLayers?f.configDependentLayers:new Set,this._config=f.config,this.dispatcher.broadcast("setReferrer",h.cl());const v=this;this._rtlTextPluginCallback=Ae.registerForPluginStateChange(w=>{v.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(E,S)=>{if(h.cm(E),S&&S.every(I=>I))for(const I in v._sourceCaches){const O=v._sourceCaches[I],N=O.getSource().type;"vector"!==N&&"geojson"!==N||O.reload()}})}),this.on("data",w=>{if("source"!==w.dataType||"metadata"!==w.sourceDataType)return;const E=this.getOwnSource(w.sourceId);if(E&&E.vectorLayerIds)for(const S in this._layers){const I=this._layers[S];I.source===E.id&&this._validateLayer(I)}})}loadURL(c,f={}){this.fire(new h.a8("dataloading",{dataType:"style"}));const v="boolean"==typeof f.validate?f.validate:!h.cn(c);c=this.map._requestManager.normalizeStyleURL(c,f.accessToken),this.resolvedImports.add(c);const w=this.importsCache.get(c);if(w)return this._load(w,v);const E=this.map._requestManager.transformRequest(c,h.a2.Style);this._request=h.a1(E,(S,I)=>{if(this._request=null,S)this.fire(new h.a7(S));else if(I)return this.importsCache.set(c,I),this._load(I,v)})}loadJSON(c,f={}){this.fire(new h.a8("dataloading",{dataType:"style"})),this._request=h.a4.frame(()=>{this._request=null,this._load(c,!1!==f.validate)})}loadEmpty(){this.fire(new h.a8("dataloading",{dataType:"style"})),this._load(L,!1)}_loadImports(c,f){if(this.importDepth>=4)return h.X("Style doesn't support nesting deeper than 5"),Promise.resolve();const v=[];for(const w of c){const E=this._createFragmentStyle(w),S=new Promise(O=>{E.once("style.import.load",O),E.once("error",O)}).then(()=>this.mergeAll());if(v.push(S),this.resolvedImports.has(w.url)){E.loadEmpty();continue}const I=w.data||this.importsCache.get(w.url);I?E.loadJSON(I,{validate:f}):w.url?E.loadURL(w.url,{validate:f}):E.loadEmpty(),this.fragments.push({style:E,id:w.id,config:w.config})}return Promise.allSettled(v)}_createFragmentStyle(c){const f=this.scope?h.aE(c.id,this.scope):c.id,v=new Ae(this.map,{scope:f,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:c.config,configOptions:this.options,configDependentLayers:this._configDependentLayers});return v.setEventedParent(this.map,{style:v}),v}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options});const c=this.isRootStyle();this._shouldPrecompile=c,this.fire(new h.a8(c?"style.load":"style.import.load"))}_load(c,f){const v=c.schema;if(this.isRootStyle()&&(c.fragment||v&&!1!==c.fragment)){const S=h.ak({},L,{imports:[{id:"basemap",data:c,url:""}]});return void this._load(S,f)}if(this.setConfig(this._config,v),f&&Ka(this,h.aj(c)))return;this._loaded=!0,this.stylesheet=h.co(c);for(const S in c.sources)this.addSource(S,c.sources[S],{validate:!1,isInitialLoad:!0});c.sprite?this._loadSprite(c.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(c.glyphs,this.scope);const w=Ha(this.stylesheet.layers);if(this._order=w.map(S=>S.id),this.stylesheet.light&&h.X("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(1===this.stylesheet.lights.length&&"flat"===this.stylesheet.lights[0].type){const S=this.stylesheet.lights[0];this.light=new dr(S.properties,S.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new dr(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const S of w){const I=h.cp(S,this.scope,this.options);I.isConfigDependent&&this._configDependentLayers.add(I.fqid),I.setEventedParent(this,{layer:{id:I.id}}),this._layers[I.id]=I,this._serializedLayers[I.id]=I.serialize();const O=this.getOwnLayerSourceCache(I),N=!!this.directionalLight&&this.directionalLight.shadowsEnabled();O&&I.canCastShadows()&&N&&(O.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const E=this.stylesheet.terrain;E&&(void 0===this.disableElevatedTerrain&&(this.disableElevatedTerrain=h.a4.hasCanvasFingerprintNoise()),this.disableElevatedTerrain?h.X("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."):this.terrainSetForDrapingOnly()||this._createTerrain(E,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new h.a8("data",{dataType:"style"})),c.imports?this._loadImports(c.imports,f).then(()=>this._reloadImports()):this._reloadImports()}isRootStyle(){return 0===this.importDepth}mergeAll(){let c,f,v,w,E,S,I,O;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(N=>{if(N.stylesheet){if(null!=N.light&&(c=N.light),N.stylesheet.lights)for(const V of N.stylesheet.lights)"ambient"===V.type&&null!=N.ambientLight&&(f=N.ambientLight),"directional"===V.type&&null!=N.directionalLight&&(v=N.directionalLight);w=this._prioritizeTerrain(w,N.terrain,N.stylesheet.terrain),N.stylesheet.fog&&null!=N.fog&&(E=N.fog),null!=N.stylesheet.camera&&(O=N.stylesheet.camera),null!=N.stylesheet.projection&&(S=N.stylesheet.projection),null!=N.stylesheet.transition&&(I=N.stylesheet.transition)}}),this.light=c,this.ambientLight=f,this.directionalLight=v,this.fog=E,null===w?delete this.terrain:this.terrain=w,this.camera=O||{"camera-projection":"perspective"},this.projection=S||{name:"mercator"},this.transition=h.ak({},U,I),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(c){const f=v=>{for(const w of v.fragments)f(w.style);c(v)};f(this)}_prioritizeTerrain(c,f,v){const w=c&&0===c.drapeRenderMode;return null===v?f&&0===f.drapeRenderMode?f:w?c:null:null!=f&&(!c||w||f&&1===f.drapeRenderMode)?f:c}mergeTerrain(){let c;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(f=>{c=this._prioritizeTerrain(c,f.terrain,f.stylesheet.terrain)}),null===c?delete this.terrain:this.terrain=c}mergeProjection(){let c;this.forEachFragmentStyle(f=>{null!=f.stylesheet.projection&&(c=f.stylesheet.projection)}),this.projection=c||{name:"mercator"}}mergeSources(){const c={},f={},v={};this.forEachFragmentStyle(w=>{for(const E in w._sourceCaches){const S=h.aE(E,w.scope);c[S]=w._sourceCaches[E]}for(const E in w._otherSourceCaches){const S=h.aE(E,w.scope);f[S]=w._otherSourceCaches[E]}for(const E in w._symbolSourceCaches){const S=h.aE(E,w.scope);v[S]=w._symbolSourceCaches[E]}}),this._mergedSourceCaches=c,this._mergedOtherSourceCaches=f,this._mergedSymbolSourceCaches=v}mergeLayers(){const c={},f=[],v={};this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(E=>{for(const S of E._order){const I=E._layers[S];if("slot"===I.type){const O=h.cq(S);if(c[O])continue;c[O]=[]}I.slot&&c[I.slot]?c[I.slot].push(I):f.push(I)}}),this._mergedOrder=[];const w=(E=[])=>{for(const S of E)if("slot"===S.type){const I=h.cq(S.id);c[I]&&w(c[I])}else{const I=h.aE(S.id,S.scope);this._mergedOrder.push(I),v[I]=S,S.is3D()&&(this._has3DLayers=!0),"circle"===S.type&&(this._hasCircleLayers=!0),"symbol"===S.type&&(this._hasSymbolLayers=!0)}};w(f),this._mergedLayers=v,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}getCamera(){return this.stylesheet.camera}setCamera(c){return this.stylesheet.camera=h.ak({},this.stylesheet.camera,c),this.camera=this.stylesheet.camera,this}setProjection(c){c?this.stylesheet.projection=c:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(c){this._spriteRequest=function(f,v,w){let E,S,I;const O=h.a4.devicePixelRatio>1?"@2x":"";let N=h.a1(v.transformRequest(v.normalizeSpriteURL(f,O,".json"),h.a2.SpriteJSON),(G,Y)=>{N=null,I||(I=G,E=Y,H())}),V=h.a3(v.transformRequest(v.normalizeSpriteURL(f,O,".png"),h.a2.SpriteImage),(G,Y)=>{V=null,I||(I=G,S=Y,H())});function H(){if(I)w(I);else if(E&&S){const G=h.a4.getImageData(S),Y={};for(const ee in E){const{width:K,height:ne,x:J,y:oe,sdf:_e,pixelRatio:ye,stretchX:re,stretchY:ae,content:be}=E[ee],Se=new h.a5({width:K,height:ne});h.a5.copy(G,Se,{x:J,y:oe},{x:0,y:0},{width:K,height:ne}),Y[ee]={data:Se,pixelRatio:ye,sdf:_e,stretchX:re,stretchY:ae,content:be}}w(null,Y)}}return{cancel(){N&&(N.cancel(),N=null),V&&(V.cancel(),V=null)}}}(c,this.map._requestManager,(f,v)=>{if(this._spriteRequest=null,f)this.fire(new h.a7(f));else if(v)for(const w in v)this.imageManager.addImage(w,this.scope,v[w]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new h.a8("data",{dataType:"style"}))})}_validateLayer(c){const f=this.getOwnSource(c.source);if(!f)return;const v=c.sourceLayer;v&&("geojson"===f.type||f.vectorLayerIds&&-1===f.vectorLayerIds.indexOf(v))&&this.fire(new h.a7(new Error(`Source layer "${v}" does not exist on source "${f.id}" as specified by style layer "${c.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const c in this._sourceCaches)if(!this._sourceCaches[c].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded())return!1;for(const{style:c}of this.fragments)if(!c.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((c,f)=>{const v=this.fragments[f];return v&&v.style&&(c.data=v.style.serialize()),c})}_serializeSources(){const c={};for(const f in this._sourceCaches){const v=this._sourceCaches[f].getSource();c[v.id]||(c[v.id]=v.serialize())}return c}_serializeLayers(c){const f=[];for(const v of c){const w=this._layers[v];w&&"custom"!==w.type&&f.push(w.serialize())}return f}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const c in this._sourceCaches)if(this._sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(c){return!!this.terrain&&("function"==typeof c.isLayerDraped?c.isLayerDraped(this.getLayerSourceCache(c)):X.has(c.type))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(c){const f=this.getOwnLayer(c);if(f)return f;this.fire(new h.a7(new Error(`The layer '${c}' does not exist in the map's style.`)))}_checkSource(c){const f=this.getOwnSource(c);if(f)return f;this.fire(new h.a7(new Error(`The source '${c}' does not exist in the map's style.`)))}update(c){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(c),this.directionalLight&&this.directionalLight.recalculate(c);const f=this.calculateLightsBrightness();c.brightness=f||0,f!==this._brightness&&(this._brightness=f,this.dispatcher.broadcast("setBrightness",f));const v=this._changes.isDirty();if(this._changes.isDirty()){const E=this._changes.getLayerUpdatesByScope();for(const S in E){const{updatedIds:I,removedIds:O}=E[S];(I||O)&&this._updateWorkerLayers(S,I,O)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(c),this.light&&this.light.updateTransitions(c),this.ambientLight&&this.ambientLight.updateTransitions(c),this.directionalLight&&this.directionalLight.updateTransitions(c),this.fog&&this.fog.updateTransitions(c),this._changes.reset()}const w={};for(const E in this._mergedSourceCaches){const S=this._mergedSourceCaches[E];w[E]=S.used,S.used=!1}for(const E of this._mergedOrder){const S=this._mergedLayers[E];if(S.recalculate(c,this._availableImages),!S.isHidden(c.zoom)){const I=this.getLayerSourceCache(S);I&&(I.used=!0)}if(!this._precompileDone&&this._shouldPrecompile)for(let I=S.minzoom||0;I<(S.maxzoom||25.5);I++){const O=this.map.painter;if(O){const N=S.getProgramIds();if(!N)continue;for(const V of N){const H=S.getDefaultProgramParams(V,c.zoom);H&&(O.style=this,this.fog&&(O._fogVisible=!0,H.overrideFog=!0,O.getOrCreateProgram(V,H)),O._fogVisible=!1,H.overrideFog=!1,O.getOrCreateProgram(V,H),(this.stylesheet.terrain||this.stylesheet.projection&&"globe"===this.stylesheet.projection.name)&&(H.overrideRtt=!0,O.getOrCreateProgram(V,H)))}}}}this._shouldPrecompile&&(this._precompileDone=!0);for(const E in w){const S=this._mergedSourceCaches[E];w[E]!==S.used&&S.getSource().fire(new h.a8("data",{sourceDataType:"visibility",dataType:"source",sourceId:S.getSource().id}))}this.light&&this.light.recalculate(c),this.terrain&&this.terrain.recalculate(c),this.fog&&this.fog.recalculate(c),this.z=c.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),v&&this.fire(new h.a8("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=this._changes.getUpdatedImages();if(c.length){for(const f in this._sourceCaches)this._sourceCaches[f].reloadTilesForDependencies(["icons","patterns"],c);this._changes.resetUpdatedImages()}}_updateWorkerLayers(c,f,v){const w=this.getFragmentStyle(c);w&&this.dispatcher.broadcast("updateLayers",{layers:f?w._serializeLayers(f):[],scope:c,removedIds:v||[],options:w.options})}setState(c){if(this._checkLoaded(),Ka(this,h.aj(c)))return!1;(c=h.co(c)).layers=Ha(c.layers);const f=function(w,E){if(!w)return[{command:pt.setStyle,args:[E]}];let S=[];try{if(!me(w.version,E.version))return[{command:pt.setStyle,args:[E]}];me(w.center,E.center)||S.push({command:pt.setCenter,args:[E.center]}),me(w.zoom,E.zoom)||S.push({command:pt.setZoom,args:[E.zoom]}),me(w.bearing,E.bearing)||S.push({command:pt.setBearing,args:[E.bearing]}),me(w.pitch,E.pitch)||S.push({command:pt.setPitch,args:[E.pitch]}),me(w.sprite,E.sprite)||S.push({command:pt.setSprite,args:[E.sprite]}),me(w.glyphs,E.glyphs)||S.push({command:pt.setGlyphs,args:[E.glyphs]}),me(w.imports,E.imports)||function(H=[],G=[],Y){G=G||[];const ee=(H=H||[]).map(ks),K=G.map(ks),ne=H.reduce(_r,{}),J=G.reduce(_r,{}),oe=ee.slice();let _e,ye,re,ae;for(_e=0,ye=0;_e<ee.length;_e++)re=ee[_e],J.hasOwnProperty(re)?ye++:(Y.push({command:pt.removeImport,args:[re]}),oe.splice(oe.indexOf(re,ye),1));for(_e=0,ye=0;_e<K.length;_e++)re=K[K.length-1-_e],oe[oe.length-1-_e]!==re&&(ne.hasOwnProperty(re)?(Y.push({command:pt.removeImport,args:[re]}),oe.splice(oe.lastIndexOf(re,oe.length-ye),1)):ye++,ae=oe[oe.length-_e],Y.push({command:pt.addImport,args:[J[re],ae]}),oe.splice(oe.length-_e,0,re));for(const be of G){const Se=ne[be.id];if(!Se||me(Se,be))continue;me(Se.config,be.config)||Y.push({command:pt.setImportConfig,args:[be.id,be.config]}),me(Se.url,be.url)||Y.push({command:pt.setImportUrl,args:[be.id,be.url]});const Ce=be.data;me(Se&&Se.data,Ce)||Y.push({command:pt.setImportData,args:[be.id,Ce]})}}(w.imports,E.imports,S),me(w.transition,E.transition)||S.push({command:pt.setTransition,args:[E.transition]}),me(w.light,E.light)||S.push({command:pt.setLight,args:[E.light]}),me(w.fog,E.fog)||S.push({command:pt.setFog,args:[E.fog]}),me(w.projection,E.projection)||S.push({command:pt.setProjection,args:[E.projection]}),me(w.lights,E.lights)||S.push({command:pt.setLights,args:[E.lights]}),me(w.camera,E.camera)||S.push({command:pt.setCamera,args:[E.camera]});const I={},O=[];!function(H,G,Y,ee){let K;for(K in G=G||{},H=H||{})H.hasOwnProperty(K)&&(G.hasOwnProperty(K)||Di(K,Y,ee));for(K in G){if(!G.hasOwnProperty(K))continue;const ne=G[K];H.hasOwnProperty(K)?me(H[K],ne)||("geojson"===H[K].type&&"geojson"===ne.type&&xs(H,G,K)?Y.push({command:pt.setGeoJSONSourceData,args:[K,ne.data]}):Ii(K,G,Y,ee)):hi(K,G,Y)}}(w.sources,E.sources,O,I);const N=[];w.layers&&w.layers.forEach(H=>{H.source&&I[H.source]?S.push({command:pt.removeLayer,args:[H.id]}):N.push(H)});let V=w.terrain;V&&I[V.source]&&(S.push({command:pt.setTerrain,args:[void 0]}),V=void 0),S=S.concat(O),me(V,E.terrain)||S.push({command:pt.setTerrain,args:[E.terrain]}),function(H,G,Y){G=G||[];const ee=(H=H||[]).map(ks),K=G.map(ks),ne=H.reduce(_r,{}),J=G.reduce(_r,{}),oe=ee.slice(),_e=Object.create(null);let ye,re,ae,be,Se,Ce,ke;for(ye=0,re=0;ye<ee.length;ye++)ae=ee[ye],J.hasOwnProperty(ae)?re++:(Y.push({command:pt.removeLayer,args:[ae]}),oe.splice(oe.indexOf(ae,re),1));for(ye=0,re=0;ye<K.length;ye++)ae=K[K.length-1-ye],oe[oe.length-1-ye]!==ae&&(ne.hasOwnProperty(ae)?(Y.push({command:pt.removeLayer,args:[ae]}),oe.splice(oe.lastIndexOf(ae,oe.length-re),1)):re++,Ce=oe[oe.length-ye],Y.push({command:pt.addLayer,args:[J[ae],Ce]}),oe.splice(oe.length-ye,0,ae),_e[ae]=!0);for(ye=0;ye<K.length;ye++)if(ae=K[ye],be=ne[ae],Se=J[ae],!_e[ae]&&!me(be,Se))if(me(be.source,Se.source)&&me(be["source-layer"],Se["source-layer"])&&me(be.type,Se.type)){for(ke in jn(be.layout,Se.layout,Y,ae,null,pt.setLayoutProperty),jn(be.paint,Se.paint,Y,ae,null,pt.setPaintProperty),me(be.slot,Se.slot)||Y.push({command:pt.setSlot,args:[ae,Se.slot]}),me(be.filter,Se.filter)||Y.push({command:pt.setFilter,args:[ae,Se.filter]}),me(be.minzoom,Se.minzoom)&&me(be.maxzoom,Se.maxzoom)||Y.push({command:pt.setLayerZoomRange,args:[ae,Se.minzoom,Se.maxzoom]}),be)be.hasOwnProperty(ke)&&"layout"!==ke&&"paint"!==ke&&"filter"!==ke&&"metadata"!==ke&&"minzoom"!==ke&&"maxzoom"!==ke&&"slot"!==ke&&(0===ke.indexOf("paint.")?jn(be[ke],Se[ke],Y,ae,ke.slice(6),pt.setPaintProperty):me(be[ke],Se[ke])||Y.push({command:pt.setLayerProperty,args:[ae,ke,Se[ke]]}));for(ke in Se)Se.hasOwnProperty(ke)&&!be.hasOwnProperty(ke)&&"layout"!==ke&&"paint"!==ke&&"filter"!==ke&&"metadata"!==ke&&"minzoom"!==ke&&"maxzoom"!==ke&&"slot"!==ke&&(0===ke.indexOf("paint.")?jn(be[ke],Se[ke],Y,ae,ke.slice(6),pt.setPaintProperty):me(be[ke],Se[ke])||Y.push({command:pt.setLayerProperty,args:[ae,ke,Se[ke]]}))}else Y.push({command:pt.removeLayer,args:[ae]}),Ce=oe[oe.lastIndexOf(ae)+1],Y.push({command:pt.addLayer,args:[Se,Ce]})}(N,E.layers,S)}catch(I){console.warn("Unable to compute style diff:",I),S=[{command:pt.setStyle,args:[E]}]}return S}(this.serialize(),c).filter(w=>!(w.command in Q));if(0===f.length)return!1;const v=f.filter(w=>!(w.command in hs));if(v.length>0)throw new Error(`Unimplemented: ${v.map(w=>w.command).join(", ")}.`);return f.forEach(w=>{this[w.command].apply(this,w.args)}),this.stylesheet=c,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(c,f){return this.getImage(c)?this.fire(new h.a7(new Error("An image with this name already exists."))):(this.imageManager.addImage(c,this.scope,f),this._afterImageUpdated(c),this)}updateImage(c,f){this.imageManager.updateImage(c,this.scope,f)}getImage(c){return this.imageManager.getImage(c,this.scope)}removeImage(c){return this.getImage(c)?(this.imageManager.removeImage(c,this.scope),this._afterImageUpdated(c),this):this.fire(new h.a7(new Error("No image with this name exists.")))}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(c),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new h.a8("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(c,f,v={}){return this._checkLoaded(),this._validate(h.cr,`models.${c}`,f,null,v)||(this.modelManager.addModel(c,f,this.scope),this._changes.setDirty()),this}hasModel(c){return this.modelManager.hasModel(c,this.scope)}removeModel(c){return this.hasModel(c)?(this.modelManager.removeModel(c,this.scope),this):this.fire(new h.a7(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(c,f,v={}){if(this._checkLoaded(),void 0!==this.getOwnSource(c))throw new Error(`There is already a source with ID "${c}".`);if(!f.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(f).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(f.type)>=0&&this._validate(h.cs,`sources.${c}`,f,null,v))return;this.map&&this.map._collectResourceTiming&&(f.collectResourceTiming=!0);const w=Xs(c,f,this.dispatcher,this);w.scope=this.scope,w.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(w.id),source:w.serialize(),sourceId:w.id}));const E=S=>{const I=(S?"symbol:":"other:")+w.id,O=h.aE(I,this.scope),N=this._sourceCaches[I]=new h.bq(O,w,S);(S?this._symbolSourceCaches:this._otherSourceCaches)[w.id]=N,N.onAdd(this.map)};E(!1),"vector"!==f.type&&"geojson"!==f.type||E(!0),w.onAdd&&w.onAdd(this.map),v.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(c){this._checkLoaded();const f=this.getOwnSource(c);if(!f)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===c)return this.fire(new h.a7(new Error(`Source "${c}" cannot be removed while layer "${w}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===c)return this.fire(new h.a7(new Error(`Source "${c}" cannot be removed while terrain is using it.`)));const v=this.getOwnSourceCaches(c);for(const w of v){const E=h.cq(w.id);delete this._sourceCaches[E],this._changes.discardSourceCacheUpdate(w.id),w.fire(new h.a8("data",{sourceDataType:"metadata",dataType:"source",sourceId:w.getSource().id})),w.setEventedParent(null),w.clearTiles()}return delete this._otherSourceCaches[c],delete this._symbolSourceCaches[c],this.mergeSources(),f.setEventedParent(null),f.onRemove&&f.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(c,f){this._checkLoaded(),this.getOwnSource(c).setData(f),this._changes.setDirty()}getOwnSource(c){const f=this.getOwnSourceCache(c);return f&&f.getSource()}getOwnSources(){const c=[];for(const f in this._otherSourceCaches){const v=this.getOwnSourceCache(f);v&&c.push(v.getSource())}return c}areTilesLoaded(){const c=this._mergedSourceCaches;for(const f in c){const v=c[f]._tiles;for(const w in v){const E=v[w];if("loaded"!==E.state&&"errored"!==E.state)return!1}}return!0}setLights(c){if(this._checkLoaded(),!c)return delete this.ambientLight,void delete this.directionalLight;const f=this._getTransitionParameters();for(const w of c){if(this._validate(h.ct,"lights",w))return;switch(w.type){case"ambient":if(this.ambientLight){const E=this.ambientLight;E.set(w),E.updateTransitions(f)}else this.ambientLight=new Oc(w,Ua,this.scope,this.options);break;case"directional":if(this.directionalLight){const E=this.directionalLight;E.set(w),E.updateTransitions(f)}else this.directionalLight=new Oc(w,yh,this.scope,this.options)}}const v=new h.al(this.z||0,f);this.ambientLight&&this.ambientLight.recalculate(v),this.directionalLight&&this.directionalLight.recalculate(v),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const c=this.directionalLight,f=this.ambientLight;if(!c||!f)return;const v=H=>.2126*(H[0]<=.03928?H[0]/12.92:Math.pow((H[0]+.055)/1.055,2.4))+.7152*(H[1]<=.03928?H[1]/12.92:Math.pow((H[1]+.055)/1.055,2.4))+.0722*(H[2]<=.03928?H[2]/12.92:Math.pow((H[2]+.055)/1.055,2.4)),w=c.properties.get("color").toArray01(),E=c.properties.get("intensity"),S=c.properties.get("direction"),I=1-h.b3(S.x,S.y,S.z)[2]/90,O=v(w)*E*I,N=f.properties.get("color").toArray01(),V=f.properties.get("intensity");return(O+v(N)*V)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const c=[];return this.directionalLight&&c.push(this.directionalLight.get()),this.ambientLight&&c.push(this.ambientLight.get()),c}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(c){if(!c)return this;if(h.cu(c)){const f=h.cv(c),v=this.fragments.find(({id:E})=>E===f);if(!v)throw new Error(`Style import not found: ${c}`);const w=h.cq(c);return v.style.getFragmentStyle(w)}{const f=this.fragments.find(({id:v})=>v===c);if(!f)throw new Error(`Style import not found: ${c}`);return f.style}}getConfigProperty(c,f){const v=this.getFragmentStyle(c);if(!v)return null;const w=h.aE(f,v.scope),E=v.options.get(w),S=E?E.value||E.default:null;return S?S.serialize():null}setConfigProperty(c,f,v){const w=h.cw(v);if("success"!==w.result)return void Ka(this,w.value);const E=w.value.expression,S=this.getFragmentStyle(c);if(!S)return;const I=h.aE(f,S.scope),O=S.options.get(I);O&&(this.options.set(I,{...O,value:E}),this.updateConfigDependencies())}setConfig(c,f){if(this._config=c,c||f)if(f)for(const v in f){let w,E;const S=h.cw(f[v].default);if("success"===S.result&&(w=S.value.expression),c&&void 0!==c[v]){const G=h.cw(c[v]);"success"===G.result&&(E=G.value.expression)}const{minValue:I,maxValue:O,stepValue:N,type:V,values:H}=f[v];if(w){const G=h.aE(v,this.scope);this.options.set(G,{default:w,value:E,minValue:I,maxValue:O,stepValue:N,type:V,values:H})}else this.fire(new h.a7(new Error(`No schema defined for config option "${v}".`)))}else this.fire(new h.a7(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(){for(const c of this._configDependentLayers){const f=this.getLayer(c);f&&(f.possiblyEvaluateVisibility(),this._updateLayer(f))}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this._changes.setDirty()}addLayer(c,f,v={}){this._checkLoaded();const w=c.id;if(this._layers[w])return void this.fire(new h.a7(new Error(`Layer with id "${w}" already exists on this map`)));let E;if("custom"===c.type){if(Ka(this,h.cx(c)))return;E=h.cp(c,this.scope,this.options)}else{if("object"==typeof c.source&&(this.addSource(w,c.source),c=h.co(c),c=h.ak(c,{source:w})),this._validate(h.cy,`layers.${w}`,c,{arrayIndex:-1},v))return;E=h.cp(c,this.scope,this.options),this._validateLayer(E),E.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[E.id]=E.serialize()}E.isConfigDependent&&this._configDependentLayers.add(E.fqid);let S=this._order.length;if(f){const V=this._order.indexOf(f);if(-1===V)return void this.fire(new h.a7(new Error(`Layer with id "${f}" does not exist on this map.`)));E.slot===this._layers[f].slot?S=V:h.X(`Layer with id "${f}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(S,0,w),this._layerOrderChanged=!0,this._layers[w]=E;const I=this.getOwnLayerSourceCache(E),O=!!this.directionalLight&&this.directionalLight.shadowsEnabled();I&&E.canCastShadows()&&O&&(I.castsShadows=!0);const N=this._changes.getRemovedLayer(E);if(N&&E.source&&I&&"custom"!==E.type){this._changes.discardLayerRemoval(E);const V=h.aE(E.source,E.scope);N.type!==E.type?this._changes.updateSourceCache(V,"clear"):(this._changes.updateSourceCache(V,"reload"),I.pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map),E.scope=this.scope,this.mergeLayers()}moveLayer(c,f){this._checkLoaded();const v=this._checkLayer(c);if(!v||c===f)return;const w=this._order.indexOf(c);this._order.splice(w,1);let E=this._order.length;if(f){const S=this._order.indexOf(f);if(-1===S)return void this.fire(new h.a7(new Error(`Layer with id "${f}" does not exist on this map.`)));v.slot===this._layers[f].slot?E=S:h.X(`Layer with id "${f}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(E,0,c),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(c){this._checkLoaded();const f=this._checkLayer(c);if(!f)return;f.setEventedParent(null);const v=this._order.indexOf(c);this._order.splice(v,1),delete this._layers[c],delete this._serializedLayers[c],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(f.fqid),this._changes.removeLayer(f);const w=this.getOwnLayerSourceCache(f);if(w&&w.castsShadows){let E=!1;for(const S in this._layers)if(this._layers[S].source===f.source&&this._layers[S].canCastShadows()){E=!0;break}w.castsShadows=E}f.onRemove&&f.onRemove(this.map),this.mergeLayers()}getOwnLayer(c){return this._layers[c]}hasLayer(c){return c in this._mergedLayers}hasLayerType(c){for(const f in this._layers)if(this._layers[f].type===c)return!0;return!1}setLayerZoomRange(c,f,v){this._checkLoaded();const w=this._checkLayer(c);w&&(w.minzoom===f&&w.maxzoom===v||(null!=f&&(w.minzoom=f),null!=v&&(w.maxzoom=v),this._updateLayer(w)))}setSlot(c,f){this._checkLoaded();const v=this._checkLayer(c);v&&v.slot!==f&&(v.slot=f,this._updateLayer(v))}setFilter(c,f,v={}){this._checkLoaded();const w=this._checkLayer(c);if(w&&!me(w.filter,f))return null==f?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(h.cz,`layers.${w.id}.filter`,f,{layerType:w.type},v)||(w.filter=h.co(f),this._updateLayer(w)))}getFilter(c){const f=this._checkLayer(c);if(f)return h.co(f.filter)}setLayoutProperty(c,f,v,w={}){this._checkLoaded();const E=this._checkLayer(c);E&&(me(E.getLayoutProperty(f),v)||(E.setLayoutProperty(f,v,w),E.isConfigDependent&&this._configDependentLayers.add(E.fqid),this._updateLayer(E)))}getLayoutProperty(c,f){const v=this._checkLayer(c);if(v)return v.getLayoutProperty(f)}setPaintProperty(c,f,v,w={}){this._checkLoaded();const E=this._checkLayer(c);if(!E||me(E.getPaintProperty(f),v))return;const S=E.setPaintProperty(f,v,w);E.isConfigDependent&&this._configDependentLayers.add(E.fqid),S&&this._updateLayer(E),this._changes.updatePaintProperties(E)}getPaintProperty(c,f){const v=this._checkLayer(c);if(v)return v.getPaintProperty(f)}setFeatureState(c,f){this._checkLoaded();const v=c.source,w=c.sourceLayer,E=this._checkSource(v);if(!E)return;const S=E.type;if("geojson"===S&&w)return void this.fire(new h.a7(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===S&&!w)return void this.fire(new h.a7(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===c.id&&this.fire(new h.a7(new Error("The feature id parameter must be provided.")));const I=this.getOwnSourceCaches(v);for(const O of I)O.setFeatureState(w,c.id,f)}removeFeatureState(c,f){this._checkLoaded();const v=c.source,w=this._checkSource(v);if(!w)return;const E=w.type,S="vector"===E?c.sourceLayer:void 0;if("vector"===E&&!S)return void this.fire(new h.a7(new Error("The sourceLayer parameter must be provided for vector source types.")));if(f&&"string"!=typeof c.id&&"number"!=typeof c.id)return void this.fire(new h.a7(new Error("A feature id is required to remove its specific state property.")));const I=this.getOwnSourceCaches(v);for(const O of I)O.removeFeatureState(S,c.id,f)}getFeatureState(c){this._checkLoaded();const f=c.source,v=c.sourceLayer,w=this._checkSource(f);if(w){if("vector"!==w.type||v)return void 0===c.id&&this.fire(new h.a7(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(f)[0].getFeatureState(v,c.id);this.fire(new h.a7(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(c){return this.stylesheet.transition=h.ak({},this.stylesheet.transition,c),this.transition=this.stylesheet.transition,this}getTransition(){return h.ak({},this.stylesheet.transition)}serialize(){this._checkLoaded();const c=this.getTerrain(),f=c&&this.terrain&&this.terrain.scope===this.scope?c:this.stylesheet.terrain;return h.cA({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:f,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},v=>void 0!==v)}_updateLayer(c){this._changes.updateLayer(c);const f=this.getLayerSourceCache(c),v=h.aE(c.source,c.scope),w=this._changes.getUpdatedSourceCaches();c.source&&!w[v]&&f&&"raster"!==f.getSource().type&&(this._changes.updateSourceCache(v,"reload"),f.pause()),c.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(c){const f=I=>"fill-extrusion"===this._mergedLayers[I].type,v=this.order,w={},E=[];for(let I=v.length-1;I>=0;I--){const O=v[I];if(f(O)){w[O]=I;for(const N of c){const V=N[O];if(V)for(const H of V)E.push(H)}}}E.sort((I,O)=>O.intersectionZ-I.intersectionZ);const S=[];for(let I=v.length-1;I>=0;I--){const O=v[I];if(f(O))for(let N=E.length-1;N>=0;N--){const V=E[N].feature;if(w[V.layer.id]<I)break;S.push(V),E.pop()}else for(const N of c){const V=N[O];if(V)for(const H of V)S.push(H.feature)}}return S}queryRenderedFeatures(c,f,v){f&&f.filter&&this._validate(h.cz,"queryRenderedFeatures.filter",f.filter,null,f),f.scope=this.scope,f.availableImages=this._availableImages,f.serializedLayers=this._serializedLayers;const w={};if(f&&f.layers){if(!Array.isArray(f.layers))return this.fire(new h.a7(new Error("parameters.layers must be an Array."))),[];for(const N of f.layers){const V=this._mergedLayers[N];if(!V)return this.fire(new h.a7(new Error(`The layer '${N}' does not exist in the map's style and cannot be queried for features.`))),[];w[V.source]=!0}}const E=[],S=f.serializedLayers||{},I=f&&f.layers?f.layers.some(N=>{const V=this.getLayer(N);return V&&V.is3D()}):this.has3DLayers(),O=uo.createFromScreenPoints(c,v);for(const N in this._mergedSourceCaches){const V=this._mergedSourceCaches[N].getSource();if(!V||V.scope!==f.scope)continue;const H=this._mergedSourceCaches[N].getSource().id;f.layers&&!w[H]||E.push(wr(this._mergedSourceCaches[N],this._mergedLayers,S,O,f,v,I,!!this.map._showQueryGeometry))}return this.placement&&E.push(function(N,V,H,G,Y,ee,K){const ne={},J=ee.queryRenderedSymbols(G),oe=[];for(const _e of Object.keys(J).map(Number))oe.push(K[_e]);oe.sort(ui);for(const _e of oe){const ye=_e.featureIndex.lookupSymbolFeatures(J[_e.bucketInstanceId],V,_e.bucketIndex,_e.sourceLayerIndex,Y.filter,Y.layers,Y.availableImages,N);for(const re in ye){const ae=ne[re]=ne[re]||[],be=ye[re];be.sort((Se,Ce)=>{const ke=_e.featureSortOrder;if(ke){const lt=ke.indexOf(Se.featureIndex);return ke.indexOf(Ce.featureIndex)-lt}return Ce.featureIndex-Se.featureIndex});for(const Se of be)ae.push(Se)}}for(const _e in ne)ne[_e].forEach(ye=>{const re=ye.feature,ae=H(N[_e]);if(!ae)return;const be=ae.getFeatureState(re.layer["source-layer"],re.id);re.source=re.layer.source,re.layer["source-layer"]&&(re.sourceLayer=re.layer["source-layer"]),re.state=be});return ne}(this._mergedLayers,S,this.getLayerSourceCache.bind(this),O.screenGeometry,f,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(E)}querySourceFeatures(c,f){f&&f.filter&&this._validate(h.cz,"querySourceFeatures.filter",f.filter,null,f);const v=this.getOwnSourceCaches(c);let w=[];for(const E of v)w=w.concat(vh(E,f));return w}addSourceType(c,f,v){return Ae.getSourceType(c)?v(new Error(`A source type called "${c}" already exists.`)):(Ae.setSourceType(c,f),f.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:f.workerSourceURL},v):v(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(c,f,v={}){this._checkLoaded();const w=this.light.getLight();let E=!1;for(const I in c)if(!me(c[I],w[I])){E=!0;break}if(!E)return;const S=this._getTransitionParameters();this.light.setLight(c,f,v),this.light.updateTransitions(S)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(c,f=1){if(this._checkLoaded(),!c)return delete this.terrain,null===c?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let v=c;const w=null==c.source;if(1===f){if("object"==typeof v.source){const I="terrain-dem-src";this.addSource(I,v.source),v=h.co(v),v=h.ak(v,{source:I})}const E=h.ak({},v),S={};if(this.terrain&&w){E.source=this.terrain.get().source;const I=this.terrain?this.getFragmentStyle(this.terrain.scope):null;I&&(S.style=I.serialize())}if(this._validate(h.cB,"terrain",E,S))return}if(!this.terrain||this.terrain.scope!==this.scope&&!w||this.terrain&&f!==this.terrain.drapeRenderMode){if(!v)return;this._createTerrain(v,f),this.fire(new h.a8("data",{dataType:"style"}))}else{const E=this.terrain,S=E.get();for(const I of Object.keys(h.ae.terrain))!v.hasOwnProperty(I)&&h.ae.terrain[I].default&&(v[I]=h.ae.terrain[I].default);for(const I in c)if(!me(c[I],S[I])){E.set(c,this.options),this.stylesheet.terrain=c;const O=this._getTransitionParameters({duration:0});E.updateTransitions(O),this.fire(new h.a8("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(c){const f=this.fog=new _h(c,this.map.transform);this.stylesheet.fog=f.get();const v=this._getTransitionParameters({duration:0});f.updateTransitions(v)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const c of this.map._markers)c._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(c){if(this._checkLoaded(),!c)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const f=this.fog;if(!me(f.get(),c)){f.set(c),this.stylesheet.fog=f.get();const v=this._getTransitionParameters({duration:0});f.updateTransitions(v)}}else this._createFog(c);this._markersNeedUpdate=!0}_getTransitionParameters(c){return{now:h.a4.now(),transition:h.ak(this.transition,c)}}updateDrapeFirstLayers(){if(!this.terrain)return;const c=[],f=[];for(const v in this._mergedLayers)this.isLayerDraped(this._mergedLayers[v])?c.push(v):f.push(v);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...c),this._drapedFirstOrder.push(...f)}_createTerrain(c,f){const v=this.terrain=new ls(c,f,this.scope,this.options);1===f&&(this.stylesheet.terrain=c),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const w=this._getTransitionParameters({duration:0});v.updateTransitions(w)}_force3DLayerUpdate(){for(const c in this._layers){const f=this._layers[c];"fill-extrusion"===f.type&&this._updateLayer(f)}}_forceSymbolLayerUpdate(){for(const c in this._layers){const f=this._layers[c];"symbol"===f.type&&this._updateLayer(f)}}_validate(c,f,v,w,E={}){if(E&&!1===E.validate)return!1;const S=h.ak({},this.serialize());return Ka(this,c.call(h.aj,h.ak({key:f,style:S,value:v,styleSpec:h.ae},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),h.cC.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._mergedLayers)this._mergedLayers[c].setEventedParent(null);for(const c in this._mergedSourceCaches)this._mergedSourceCaches[c].clearTiles(),this._mergedSourceCaches[c].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(c){const f=this.getSourceCaches(c);for(const v of f)v.clearTiles()}clearSources(){for(const c in this._mergedSourceCaches)this._mergedSourceCaches[c].clearTiles()}reloadSource(c){const f=this.getSourceCaches(c);for(const v of f)v.resume(),v.reload()}reloadSources(){for(const c of this.getSources())c.reload&&c.reload()}updateSources(c){let f;this.directionalLight&&(f=cc(this.directionalLight));for(const v in this._mergedSourceCaches)this._mergedSourceCaches[v].update(c,void 0,void 0,f)}_generateCollisionBoxes(){for(const c in this._sourceCaches){const f=this._sourceCaches[c];f.resume(),f.reload()}}_updatePlacement(c,f,v,w,E=!1){let S=!1,I=!1;const O={},N={};for(const V of this._mergedOrder){const H=this._mergedLayers[V];if("symbol"!==H.type)continue;const G=h.aE(H.source,H.scope);let Y=O[G];if(!Y){const K=this.getLayerSourceCache(H);if(!K)continue;const ne=K.getRenderableIds(!0).map(J=>K.getTileByID(J));N[G]=ne.slice(),Y=O[G]=ne.sort((J,oe)=>oe.tileID.overscaledZ-J.tileID.overscaledZ||(J.tileID.isLessThan(oe.tileID)?-1:1))}const ee=this.crossTileSymbolIndex.addLayer(H,Y,c.center.lng,c.projection);S=S||ee}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),E=E||this._layerOrderChanged||0===v,this._layerOrderChanged&&this.fire(new h.a8("neworder")),(E||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(h.a4.now(),c.zoom))&&(this.pauseablePlacement=new us(c,this._mergedOrder,E,f,v,w,this.placement,this.fog&&c.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,O,N),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(h.a4.now()),I=!0),S&&this.pauseablePlacement.placement.setStale()),I||S)for(const V of this._mergedOrder){const H=this._mergedLayers[V];"symbol"===H.type&&this.placement.updateLayerOpacities(H,O[h.aE(H.source,H.scope)])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(h.a4.now())}_releaseSymbolFadeTiles(){for(const c in this._sourceCaches)this._sourceCaches[c].releaseSymbolFadeTiles()}addImport(c){this._checkLoaded();const f=this.stylesheet.imports=this.stylesheet.imports||[];return-1!==f.findIndex(({id:v})=>v===c.id)?this.fire(new h.a7(new Error(`Import with id '${c.id}' already exists in the map's style.`))):(f.push(c),this._loadImports([c],!0),this)}setImportUrl(c,f){this._checkLoaded();const v=this.stylesheet.imports||[],w=this.getImportIndex(c);if(-1===w)return this;v[w].url=f;const E=this.fragments[w];return E.style=this._createFragmentStyle(v[w]),E.style.on("style.import.load",()=>this.mergeAll()),E.style.loadURL(f),this}setImportData(c,f){this._checkLoaded();const v=this.getImportIndex(c),w=this.stylesheet.imports||[];return-1===v?this:f?(this.fragments[v].style.setState(f),this._reloadImports(),this):(delete w[v].data,this.setImportUrl(c,w[v].url))}setImportConfig(c,f){this._checkLoaded();const v=this.getImportIndex(c),w=this.stylesheet.imports||[];if(-1===v)return this;f?w[v].config=f:delete w[v].config;const E=this.fragments[v],S=E.style.stylesheet&&E.style.stylesheet.schema;return E.config=f,E.style.setConfig(f,S),this.updateConfigDependencies(),this}removeImport(c){this._checkLoaded();const f=this.stylesheet.imports||[],v=this.getImportIndex(c);return-1===v||(f.splice(v,1),this.fragments[v].style._remove(),this.fragments.splice(v,1),this._reloadImports()),this}getImportIndex(c){const f=(this.stylesheet.imports||[]).findIndex(v=>v.id===c);return-1===f&&this.fire(new h.a7(new Error(`Import '${c}' does not exist in the map's style and cannot be updated.`))),f}getLayer(c){return this._mergedLayers[c]}getSources(){const c=[];for(const f in this._mergedOtherSourceCaches){const v=this._mergedOtherSourceCaches[f];v&&c.push(v.getSource())}return c}getSource(c,f){const v=this.getSourceCache(c,f);return v&&v.getSource()}getLayerSource(c){const f=this.getLayerSourceCache(c);return f&&f.getSource()}getSourceCache(c,f){const v=h.aE(c,f);return this._mergedOtherSourceCaches[v]}getLayerSourceCache(c){const f=h.aE(c.source,c.scope);return"symbol"===c.type?this._mergedSymbolSourceCaches[f]:this._mergedOtherSourceCaches[f]}getSourceCaches(c){const f=[];return this._mergedOtherSourceCaches[c]&&f.push(this._mergedOtherSourceCaches[c]),this._mergedSymbolSourceCaches[c]&&f.push(this._mergedSymbolSourceCaches[c]),f}updateSourceCaches(){const c=this._changes.getUpdatedSourceCaches();for(const f in c){const v=c[f];"reload"===v?this.reloadSource(f):"clear"===v&&this.clearSource(f)}}updateLayers(c){const f=this._changes.getUpdatedPaintProperties();for(const v of f){const w=this.getLayer(v);w&&w.updateTransitions(c)}}getImages(c,f,v){this.imageManager.getImages(f.icons,f.scope,v),this._updateTilesForChangedImages();const w=E=>{E&&E.setDependencies(f.tileID.key,f.type,f.icons)};w(this._otherSourceCaches[f.source]),w(this._symbolSourceCaches[f.source])}getGlyphs(c,f,v){this.glyphManager.getGlyphs(f.stacks,f.scope,v)}getResource(c,f,v){return h.cD(f,v)}getOwnSourceCache(c){return this._otherSourceCaches[c]}getOwnLayerSourceCache(c){return"symbol"===c.type?this._symbolSourceCaches[c.source]:this._otherSourceCaches[c.source]}getOwnSourceCaches(c){const f=[];return this._otherSourceCaches[c]&&f.push(this._otherSourceCaches[c]),this._symbolSourceCaches[c]&&f.push(this._symbolSourceCaches[c]),f}_isSourceCacheLoaded(c){const f=this.getOwnSourceCaches(c);return 0===f.length?(this.fire(new h.a7(new Error(`There is no source with ID '${c}'`))),!1):f.every(v=>v.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function _t(_,c){let f=!1,v=null;const w=()=>{v=null,f&&(_(),v=setTimeout(w,c),f=!1)};return()=>(f=!0,v||w(),v)}Ae.getSourceType=function(_){return Ys[_]},Ae.setSourceType=function(_,c){Ys[_]=c},Ae.registerForPluginStateChange=h.ci;class yn{constructor(c){this._hashName=c&&encodeURIComponent(c),h.aR(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=_t(this._updateHashUnthrottled.bind(this),300)}addTo(c){return this._map=c,window.addEventListener("hashchange",this._onHashChange,!1),c.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const c=this._map;if(!c)return"";const f=fi(c);if(this._hashName){const v=this._hashName;let w=!1;const E=location.hash.slice(1).split("&").map(S=>{const I=S.split("=")[0];return I===v?(w=!0,`${I}=${f}`):S}).filter(S=>S);return w||E.push(`${v}=${f}`),`#${E.join("&")}`}return`#${f}`}_getCurrentHash(){const c=location.hash.replace("#","");if(this._hashName){let f;return c.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(f=v)}),(f&&f[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._map;if(!c)return!1;const f=this._getCurrentHash();if(f.length>=3&&!f.some(v=>isNaN(v))){const v=c.dragRotate.isEnabled()&&c.touchZoomRotate.isEnabled()?+(f[3]||0):c.getBearing();return c.jumpTo({center:[+f[2],+f[1]],zoom:+f[0],bearing:v,pitch:+(f[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function fi(_,c){const f=_.getCenter(),v=Math.round(100*_.getZoom())/100,w=Math.ceil((v*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,w),S=Math.round(f.lng*E)/E,I=Math.round(f.lat*E)/E,O=_.getBearing(),N=_.getPitch();let V=c?`/${S}/${I}/${v}`:`${v}/${I}/${S}`;return(O||N)&&(V+="/"+Math.round(10*O)/10),N&&(V+=`/${Math.round(N)}`),V}const pi={linearity:.3,easing:h.cE(0,0,.3,1)},Cr=h.ak({deceleration:2500,maxSpeed:1400},pi),Lo=h.ak({deceleration:20,maxSpeed:1400},pi),Md=h.ak({deceleration:1e3,maxSpeed:360},pi),Nv=h.ak({deceleration:1e3,maxSpeed:90},pi);class I_{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:h.a4.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,f=h.a4.now();for(;c.length>0&&f-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const f={zoom:0,bearing:0,pitch:0,pan:new h.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)f.zoom+=E.zoomDelta||0,f.bearing+=E.bearingDelta||0,f.pitch+=E.pitchDelta||0,E.panDelta&&f.pan._add(E.panDelta),E.around&&(f.around=E.around),E.pinchAround&&(f.pinchAround=E.pinchAround);const v=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(f.pan.mag()){const E=Qf(f.pan.mag(),v,h.ak({},Cr,c||{}));w.offset=f.pan.mult(E.amount/f.pan.mag()),w.center=this._map.transform.center,Fu(w,E)}if(f.zoom){const E=Qf(f.zoom,v,Lo);w.zoom=this._map.transform.zoom+E.amount,Fu(w,E)}if(f.bearing){const E=Qf(f.bearing,v,Md);w.bearing=this._map.transform.bearing+h.c(E.amount,-179,179),Fu(w,E)}if(f.pitch){const E=Qf(f.pitch,v,Nv);w.pitch=this._map.transform.pitch+E.amount,Fu(w,E)}if(w.zoom||w.bearing){const E=void 0===f.pinchAround?f.around:f.pinchAround;w.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),w.noMoveStart=!0,w}}function Fu(_,c){(!_.duration||_.duration<c.duration)&&(_.duration=c.duration,_.easing=c.easing)}function Qf(_,c,f){const{maxSpeed:v,linearity:w,deceleration:E}=f,S=h.c(_*w/(c/1e3),-v,v),I=Math.abs(S)/(E*w);return{easing:f.easing,duration:1e3*I,amount:S*(I/2)}}class ea extends h.a8{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,f,v,w={}){const E=qt(f.getCanvasContainer(),v),S=f.unproject(E);super(c,h.ak({point:E,lngLat:S,originalEvent:v},w)),this._defaultPrevented=!1,this.target=f}}class Jf extends h.a8{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,f,v){const w="touchend"===c?v.changedTouches:v.touches,E=nt(f.getCanvasContainer(),w),S=E.map(O=>f.unproject(O)),I=E.reduce((O,N,V,H)=>O.add(N.div(H.length)),new h.P(0,0));super(c,{points:E,point:I,lngLats:S,lngLat:f.unproject(I),originalEvent:v}),this._defaultPrevented=!1}}class y1 extends h.a8{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,f,v){super(c,{originalEvent:v}),this._defaultPrevented=!1}}class k_{constructor(c,f){this._map=c,this._clickTolerance=f.clickTolerance}reset(){this._mousedownPos=void 0}wheel(c){return this._firePreventable(new y1(c.type,this._map,c))}mousedown(c,f){return this._mousedownPos=f,this._firePreventable(new ea(c.type,this._map,c))}mouseup(c){this._map.fire(new ea(c.type,this._map,c))}preclick(c){const f=h.ak({},c);f.type="preclick",this._map.fire(new ea(f.type,this._map,f))}click(c,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||(this.preclick(c),this._map.fire(new ea(c.type,this._map,c)))}dblclick(c){return this._firePreventable(new ea(c.type,this._map,c))}mouseover(c){this._map.fire(new ea(c.type,this._map,c))}mouseout(c){this._map.fire(new ea(c.type,this._map,c))}touchstart(c){return this._firePreventable(new Jf(c.type,this._map,c))}touchmove(c){this._map.fire(new Jf(c.type,this._map,c))}touchend(c){this._map.fire(new Jf(c.type,this._map,c))}touchcancel(c){this._map.fire(new Jf(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Im{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(c){this._map.fire(new ea(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ea("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._map.fire(new ea(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ep{constructor(c,f){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=f.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,f){this.isEnabled()&&c.shiftKey&&0===c.button&&(en(),this._startPos=this._lastPos=f,this._active=!0)}mousemoveWindow(c,f){if(!this._active)return;const v=f,w=this._startPos,E=this._lastPos;if(!w||!E||E.equals(v)||!this._box&&v.dist(w)<this._clickTolerance)return;this._lastPos=v,this._box||(this._box=Ye("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const S=Math.min(w.x,v.x),I=Math.max(w.x,v.x),O=Math.min(w.y,v.y),N=Math.max(w.y,v.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${S}px,${O}px)`,this._box.style.width=I-S+"px",this._box.style.height=N-O+"px")})}mouseupWindow(c,f){if(!this._active)return;const v=this._startPos,w=f;if(v&&0===c.button){if(this.reset(),ct(),v.x!==w.x||v.y!==w.y)return this._map.fire(new h.a8("boxzoomend",{originalEvent:c})),{cameraAnimation:E=>E.fitScreenCoordinates(v,w,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",c)}}keydown(c){this._active&&27===c.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",c))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Yt(),delete this._startPos,delete this._lastPos}_fireEvent(c,f){return this._map.fire(new h.a8(c,{originalEvent:f}))}}function tp(_,c){const f={};for(let v=0;v<_.length;v++)f[_[v].identifier]=c[v];return f}class np{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(c,f,v){(this.centroid||v.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=c.timeStamp),v.length===this.numTouches&&(this.centroid=function(w){const E=new h.P(0,0);for(const S of w)E._add(S);return E.div(w.length)}(f),this.touches=tp(v,f)))}touchmove(c,f,v){if(this.aborted||!this.centroid)return;const w=tp(v,f);for(const E in this.touches){const S=w[E];(!S||S.dist(this.touches[E])>30)&&(this.aborted=!0)}}touchend(c,f,v){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),0===v.length){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class ip{constructor(c){this.singleTap=new np(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(c,f,v){this.singleTap.touchstart(c,f,v)}touchmove(c,f,v){this.singleTap.touchmove(c,f,v)}touchend(c,f,v){const w=this.singleTap.touchend(c,f,v);if(w){const E=c.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(w)<30;if(E&&S||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class km{constructor(){this._zoomIn=new ip({numTouches:1,numTaps:2}),this._zoomOut=new ip({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,f,v){this._zoomIn.touchstart(c,f,v),this._zoomOut.touchstart(c,f,v)}touchmove(c,f,v){this._zoomIn.touchmove(c,f,v),this._zoomOut.touchmove(c,f,v)}touchend(c,f,v){const w=this._zoomIn.touchend(c,f,v),E=this._zoomOut.touchend(c,f,v);return w?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(w)},{originalEvent:c})}):E?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(E)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Rm={0:1,2:2};class ta{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(c,f){return!1}_move(c,f){return{}}mousedown(c,f){if(this._lastPoint)return;const v=Ge(c);this._correctButton(c,v)&&(this._lastPoint=f,this._eventButton=v)}mousemoveWindow(c,f){const v=this._lastPoint;if(v)if(c.preventDefault(),null!=this._eventButton&&function(w,E){const S=Rm[E];return void 0===w.buttons||(w.buttons&S)!==S}(c,this._eventButton))this.reset();else if(this._moved||!(f.dist(v)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(v,f)}mouseupWindow(c){this._lastPoint&&Ge(c)===this._eventButton&&(this._moved&&ct(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Bv extends ta{mousedown(c,f){super.mousedown(c,f),this._lastPoint&&(this._active=!0)}_correctButton(c,f){return 0===f&&!c.ctrlKey}_move(c,f){return{around:f,panDelta:f.sub(c)}}}class rp extends ta{_correctButton(c,f){return 0===f&&c.ctrlKey||2===f}_move(c,f){const v=.8*(f.x-c.x);if(v)return this._active=!0,{bearingDelta:v}}contextmenu(c){c.preventDefault()}}class op extends ta{_correctButton(c,f){return 0===f&&c.ctrlKey||2===f}_move(c,f){const v=-.5*(f.y-c.y);if(v)return this._active=!0,{pitchDelta:v}}contextmenu(c){c.preventDefault()}}class Ad{constructor(c,f){this._map=c,this._el=c.getCanvasContainer(),this._minTouches=1,this._clickTolerance=f.clickTolerance||1,this.reset(),h.aR(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new h.P(0,0)}touchstart(c,f,v){return this._calculateTransform(c,f,v)}touchmove(c,f,v){if(this._active&&!(v.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===v.length&&!h.cF())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return c.cancelable&&c.preventDefault(),this._calculateTransform(c,f,v)}}touchend(c,f,v){this._calculateTransform(c,f,v),this._active&&v.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,f,v){v.length>0&&(this._active=!0);const w=tp(v,f),E=new h.P(0,0),S=new h.P(0,0);let I=0;for(const N in w){const V=w[N],H=this._touches[N];H&&(E._add(V),S._add(V.sub(H)),I++,w[N]=V)}if(this._touches=w,I<this._minTouches||!S.mag())return;const O=S.div(I);return this._sum._add(O),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(I),panDelta:O}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Ye("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Pm{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(c){}_move(c,f,v){return{}}touchstart(c,f,v){this._firstTwoTouches||v.length<2||(this._firstTwoTouches=[v[0].identifier,v[1].identifier],this._start([f[0],f[1]]))}touchmove(c,f,v){const w=this._firstTwoTouches;if(!w)return;c.preventDefault();const[E,S]=w,I=Id(v,f,E),O=Id(v,f,S);if(!I||!O)return;const N=this._aroundCenter?null:I.add(O).div(2);return this._move([I,O],N,c)}touchend(c,f,v){if(!this._firstTwoTouches)return;const[w,E]=this._firstTwoTouches,S=Id(v,f,w),I=Id(v,f,E);S&&I||(this._active&&ct(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&"center"===c.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Id(_,c,f){for(let v=0;v<_.length;v++)if(_[v].identifier===f)return c[v]}function Sl(_,c){return Math.log(_/c)/Math.LN2}class Qa extends Pm{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,f){const v=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(Sl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Sl(this._distance,v),pinchAround:f}}}function R_(_,c){return 180*_.angleWith(c)/Math.PI}class Om extends Pm{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,f){const v=this._vector;if(this._vector=c[0].sub(c[1]),v&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:R_(this._vector,v),pinchAround:f}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const f=25/(Math.PI*this._minDiameter)*360,v=this._startVector;if(!v)return!1;const w=R_(c,v);return Math.abs(w)<f}}function io(_){return Math.abs(_.y)>Math.abs(_.x)}class sp extends Pm{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(c){this._lastPoints=c,io(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,f,v){const w=this._lastPoints;if(!w)return;const E=c[0].sub(w[0]),S=c[1].sub(w[1]);return this._map._cooperativeGestures&&!h.cF()&&v.touches.length<3||(this._valid=this.gestureBeginsVertically(E,S,v.timeStamp),!this._valid)?void 0:(this._lastPoints=c,this._active=!0,{pitchDelta:(E.y+S.y)/2*-.5})}gestureBeginsVertically(c,f,v){if(void 0!==this._valid)return this._valid;const w=c.mag()>=2,E=f.mag()>=2;if(!w&&!E)return;if(!w||!E)return null==this._firstMove&&(this._firstMove=v),v-this._firstMove<100&&void 0;const S=c.y>0==f.y>0;return io(c)&&io(f)&&S}}const xa={panStep:100,bearingStep:15,pitchStep:10};class Nh{constructor(){const c=xa;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let f=0,v=0,w=0,E=0,S=0;switch(c.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:c.shiftKey?v=-1:(c.preventDefault(),E=-1);break;case 39:c.shiftKey?v=1:(c.preventDefault(),E=1);break;case 38:c.shiftKey?w=1:(c.preventDefault(),S=-1);break;case 40:c.shiftKey?w=-1:(c.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(v=0,w=0),{cameraAnimation:I=>{const O=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:Bh,zoom:f?Math.round(O)+f*(c.shiftKey?2:1):O,bearing:I.getBearing()+v*this._bearingStep,pitch:I.getPitch()+w*this._pitchStep,offset:[-E*this._panStep,-S*this._panStep],center:I.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Bh(_){return _*(2-_)}const zh=4.000244140625;class Fm{constructor(c,f){this._map=c,this._el=c.getCanvasContainer(),this._handler=f,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,h.aR(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!c&&"center"===c.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(c.ctrlKey||c.metaKey||this.isZooming()||h.cF()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let f=c.deltaMode===WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const v=h.a4.now(),w=v-(this._lastWheelEventTime||0);this._lastWheelEventTime=v,0!==f&&f%zh==0?this._type="wheel":0!==f&&Math.abs(f)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(w*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),c.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=c,this._delta-=f,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const f=qt(this._el,c);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:f,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform;"wheel"===this._type&&c.projection.wrap&&(c._center.lng>=180||c._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const f=()=>c._terrainEnabled()&&this._aroundCoord?c.computeZoomRelativeTo(this._aroundCoord):c.zoom;if(0!==this._delta){const N="wheel"===this._type&&Math.abs(this._delta)>zh?this._wheelZoomRate:this._defaultZoomRate;let V=2/(1+Math.exp(-Math.abs(this._delta*N)));this._delta<0&&0!==V&&(V=1/V);const H=f(),G=Math.pow(2,H),Y="number"==typeof this._targetZoom?c.zoomScale(this._targetZoom):G;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(Y*V))),"wheel"===this._type&&(this._startZoom=H,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const v="number"==typeof this._targetZoom?this._targetZoom:f(),w=this._startZoom,E=this._easing;let S,I=!1;if("wheel"===this._type&&w&&E){const N=Math.min((h.a4.now()-this._lastWheelEventTime)/200,1),V=E(N);S=h.n(w,v,V),N<1?this._frameId||(this._frameId=!0):I=!0}else S=v,I=!0;this._active=!0,I&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let O=S-f();return O*this._lastDelta<0&&(O=0),{noInertia:!0,needsRenderFrame:!I,zoomDelta:O,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let f=h.cG;if(this._prevEase){const v=this._prevEase,w=(h.a4.now()-v.start)/v.duration,E=v.easing(w+.01)-v.easing(w),S=.27/Math.sqrt(E*E+1e-4)*.01,I=Math.sqrt(.0729-S*S);f=h.cE(S,I,.25,1)}return this._prevEase={start:h.a4.now(),duration:c,easing:f},f}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Ye("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class ap{constructor(c,f){this._clickZoom=c,this._tapZoom=f}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Vh{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(c,f){return c.preventDefault(),{cameraAnimation:v=>{v.easeTo({duration:300,zoom:v.getZoom()+(c.shiftKey?-1:1),around:v.unproject(f)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class kd{constructor(){this._tap=new ip({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(c,f,v){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?v.length>0&&(this._swipePoint=f[0],this._swipeTouch=v[0].identifier):this._tap.touchstart(c,f,v))}touchmove(c,f,v){if(this._tapTime){if(this._swipePoint){if(v[0].identifier!==this._swipeTouch)return;const w=f[0],E=w.y-this._swipePoint.y;return this._swipePoint=w,c.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(c,f,v)}touchend(c,f,v){this._tapTime?this._swipePoint&&0===v.length&&this.reset():this._tap.touchend(c,f,v)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jh{constructor(c,f,v){this._el=c,this._mousePan=f,this._touchPan=v}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Lm{constructor(c,f,v){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=f,this._mousePitch=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Nm{constructor(c,f,v,w){this._el=c,this._touchZoom=f,this._touchRotate=v,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Rd=_=>_.zoom||_.drag||_.pitch||_.rotate;class Uh extends h.a8{}class Ml{constructor(){this.constants=[1,1,.01],this.radius=0}setup(c,f){const v=h.v.sub([],f,c);this.radius=h.v.length(v[2]<0?h.v.div([],v,this.constants):[v[0],v[1],0])}projectRay(c){h.v.div(c,c,this.constants),h.v.normalize(c,c),h.v.mul(c,c,this.constants);const f=h.v.scale([],c,this.radius);if(f[2]>0){const v=h.v.scale([],[0,0,1],h.v.dot(f,[0,0,1])),w=h.v.scale([],h.v.normalize([],[f[0],f[1],0]),this.radius),E=h.v.add([],f,h.v.scale([],h.v.sub([],h.v.add([],w,v),f),2));f[0]=E[0],f[1]=E[1]}return f}}function Al(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class Bm{constructor(c,f){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new I_(c),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Ml,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(f),h.aR(["handleEvent","handleWindowEvent"],this);const v=this._el;this._listeners=[[v,"touchstart",{passive:!0}],[v,"touchmove",{passive:!1}],[v,"touchend",void 0],[v,"touchcancel",void 0],[v,"mousedown",void 0],[v,"mousemove",void 0],[v,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[v,"mouseover",void 0],[v,"mouseout",void 0],[v,"dblclick",void 0],[v,"click",void 0],[v,"keydown",{capture:!1}],[v,"keyup",void 0],[v,"wheel",{passive:!1}],[v,"contextmenu",void 0],[window,"blur",void 0]];for(const[w,E,S]of this._listeners){const I=w===document?this.handleWindowEvent:this.handleEvent;w.addEventListener(E,I,S)}}destroy(){for(const[c,f,v]of this._listeners){const w=c===document?this.handleWindowEvent:this.handleEvent;c.removeEventListener(f,w,v)}}_addDefaultHandlers(c){const f=this._map,v=f.getCanvasContainer();this._add("mapEvent",new k_(f,c));const w=f.boxZoom=new ep(f,c);this._add("boxZoom",w);const E=new km,S=new Vh;f.doubleClickZoom=new ap(S,E),this._add("tapZoom",E),this._add("clickZoom",S);const I=new kd;this._add("tapDragZoom",I);const O=f.touchPitch=new sp(f);this._add("touchPitch",O);const N=new rp(c),V=new op(c);f.dragRotate=new Lm(c,N,V),this._add("mouseRotate",N,["mousePitch"]),this._add("mousePitch",V,["mouseRotate"]);const H=new Bv(c),G=new Ad(f,c);f.dragPan=new jh(v,H,G),this._add("mousePan",H),this._add("touchPan",G,["touchZoom","touchRotate"]);const Y=new Om,ee=new Qa;f.touchZoomRotate=new Nm(v,ee,Y,I),this._add("touchRotate",Y,["touchPan","touchZoom"]),this._add("touchZoom",ee,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Im(f));const K=f.scrollZoom=new Fm(f,this);this._add("scrollZoom",K,["mousePan"]);const ne=f.keyboard=new Nh;this._add("keyboard",ne);for(const J of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[J]&&f[J].enable(c[J])}_add(c,f,v){this._handlers.push({handlerName:c,handler:f,allowed:v}),this._handlersById[c]=f}stop(c){if(!this._updatingCamera){for(const{handler:f}of this._handlers)f.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Rd(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(c,f,v){for(const w in c)if(w!==v&&(!f||f.indexOf(w)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const f=[];for(const v of c)this._el.contains(v.target)&&f.push(v);return f}handleEvent(c,f){this._updatingCamera=!0;const v="renderFrame"===c.type,w=v?void 0:c,E={needsRenderFrame:!1},S={},I={},O=c.touches?this._getMapTouches(c.touches):void 0,N=O?nt(this._el,O):v?void 0:qt(this._el,c);for(const{handlerName:G,handler:Y,allowed:ee}of this._handlers){if(!Y.isEnabled())continue;let K;this._blockedByActive(I,ee,G)?Y.reset():Y[f||c.type]&&(K=Y[f||c.type](c,N,O),this.mergeHandlerResult(E,S,K,G,w),K&&K.needsRenderFrame&&this._triggerRenderFrame()),(K||Y.isActive())&&(I[G]=Y)}const V={};for(const G in this._previousActiveHandlers)I[G]||(V[G]=w);this._previousActiveHandlers=I,(Object.keys(V).length||Al(E))&&(this._changes.push([E,S,V]),this._triggerRenderFrame()),(Object.keys(I).length||Al(E))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:H}=E;H&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],H(this._map))}mergeHandlerResult(c,f,v,w,E){if(!v)return;h.ak(c,v);const S={handlerName:w,originalEvent:v.originalEvent||E};void 0!==v.zoomDelta&&(f.zoom=S),void 0!==v.panDelta&&(f.drag=S),void 0!==v.pitchDelta&&(f.pitch=S),void 0!==v.bearingDelta&&(f.rotate=S)}_applyChanges(){const c={},f={},v={};for(const[w,E,S]of this._changes)w.panDelta&&(c.panDelta=(c.panDelta||new h.P(0,0))._add(w.panDelta)),w.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+w.pitchDelta),void 0!==w.around&&(c.around=w.around),void 0!==w.aroundCoord&&(c.aroundCoord=w.aroundCoord),void 0!==w.pinchAround&&(c.pinchAround=w.pinchAround),w.noInertia&&(c.noInertia=w.noInertia),h.ak(f,E),h.ak(v,S);this._updateMapTransform(c,f,v),this._changes=[]}_updateMapTransform(c,f,v){const w=this._map,E=w.transform,S=oe=>[oe.x,oe.y,oe.z];if((oe=>{const _e=this._eventsInProgress.drag;return _e&&!this._handlersById[_e.handlerName].isActive()})()&&!Al(c)){const oe=E.zoom;E.cameraElevationReference="sea",null!=this._originalZoom&&E._orthographicProjectionAtLowPitch&&"globe"!==E.projection.name&&0===E.pitch?(E.cameraElevationReference="ground",E.zoom=this._originalZoom):(E.recenterOnTerrain(),E.cameraElevationReference="ground"),oe!==E.zoom&&this._map._update(!0)}if(E._isCameraConstrained&&w._stop(!0),!Al(c))return void this._fireEvents(f,v,!0);let{panDelta:I,zoomDelta:O,bearingDelta:N,pitchDelta:V,around:H,aroundCoord:G,pinchAround:Y}=c;E._isCameraConstrained&&(O>0&&(O=0),E._isCameraConstrained=!1),void 0!==Y&&(H=Y),(O||(oe=>f.drag&&!this._eventsInProgress.drag)())&&H&&(this._dragOrigin=S(E.pointCoordinate3D(H)),this._originalZoom=E.zoom,this._trackingEllipsoid.setup(E._camera.position,this._dragOrigin)),E.cameraElevationReference="sea",w._stop(!0),H=H||w.transform.centerPoint,N&&(E.bearing+=N),V&&(E.pitch+=V),E._updateCameraState();const ee=[0,0,0];if(I)if("mercator"===E.projection.name){const oe=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(H).dir),_e=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(H.sub(I)).dir);ee[0]=_e[0]-oe[0],ee[1]=_e[1]-oe[1]}else{const oe=E.pointCoordinate(H);if("globe"===E.projection.name){I=I.rotate(-E.angle);const _e=E._pixelsPerMercatorPixel/E.worldSize;ee[0]=-I.x*h.cH(h.l(oe.y))*_e,ee[1]=-I.y*h.cH(E.center.lat)*_e}else{const _e=E.pointCoordinate(H.sub(I));oe&&_e&&(ee[0]=_e.x-oe.x,ee[1]=_e.y-oe.y)}}const K=E.zoom,ne=[0,0,0];if(O){const oe=S(G||E.pointCoordinate3D(H)),_e={dir:h.v.normalize([],h.v.sub([],oe,E._camera.position))};if(_e.dir[2]<0){const ye=E.zoomDeltaToMovement(oe,O);h.v.scale(ne,_e.dir,ye)}}const J=h.v.add(ee,ee,ne);E._translateCameraConstrained(J),O&&Math.abs(E.zoom-K)>1e-4&&E.recenterOnTerrain(),E.cameraElevationReference="ground",this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(f,v,!0)}_fireEvents(c,f,v){const w=Rd(this._eventsInProgress),E=Rd(c),S={};for(const V in c){const{originalEvent:H}=c[V];this._eventsInProgress[V]||(S[`${V}start`]=H),this._eventsInProgress[V]=c[V]}!w&&E&&this._fireEvent("movestart",E.originalEvent);for(const V in S)this._fireEvent(V,S[V]);E&&this._fireEvent("move",E.originalEvent);for(const V in c){const{originalEvent:H}=c[V];this._fireEvent(V,H)}const I={};let O;for(const V in this._eventsInProgress){const{handlerName:H,originalEvent:G}=this._eventsInProgress[V];this._handlersById[H].isActive()||(delete this._eventsInProgress[V],O=f[H]||G,I[`${V}end`]=O)}for(const V in I)this._fireEvent(V,I[V]);const N=Rd(this._eventsInProgress);if(v&&(w||E)&&!N){this._updatingCamera=!0;const V=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),H=G=>0!==G&&-this._bearingSnap<G&&G<this._bearingSnap;V?(H(V.bearing||this._map.getBearing())&&(V.bearing=0),this._map.easeTo(V,{originalEvent:O})):(this._map.fire(new h.a8("moveend",{originalEvent:O})),H(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,f){this._map.fire(new h.a8(c,f?{originalEvent:f}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{this._frameId=void 0,this.handleEvent(new Uh("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const zv="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class lp extends h.a6{constructor(c,f){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=f.bearingSnap,this._respectPrefersReducedMotion=!1!==f.respectPrefersReducedMotion,h.aR(["_renderFrameCallback"],this)}getCenter(){return new h.L(this.transform.center.lng,this.transform.center.lat)}setCenter(c,f){return this.jumpTo({center:c},f)}panBy(c,f,v){return c=h.P.convert(c).mult(-1),this.panTo(this.transform.center,h.ak({offset:c},f),v)}panTo(c,f,v){return this.easeTo(h.ak({center:c},f),v)}getZoom(){return this.transform.zoom}setZoom(c,f){return this.jumpTo({zoom:c},f),this}zoomTo(c,f,v){return this.easeTo(h.ak({zoom:c},f),v)}zoomIn(c,f){return this.zoomTo(this.getZoom()+1,c,f),this}zoomOut(c,f){return this.zoomTo(this.getZoom()-1,c,f),this}getBearing(){return this.transform.bearing}setBearing(c,f){return this.jumpTo({bearing:c},f),this}getPadding(){return this.transform.padding}setPadding(c,f){return this.jumpTo({padding:c},f),this}rotateTo(c,f,v){return this.easeTo(h.ak({bearing:c},f),v)}resetNorth(c,f){return this.rotateTo(0,h.ak({duration:1e3},c),f),this}resetNorthPitch(c,f){return this.easeTo(h.ak({bearing:0,pitch:0,duration:1e3},c),f),this}snapToNorth(c,f){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,f):this}getPitch(){return this.transform.pitch}setPitch(c,f){return this.jumpTo({pitch:c},f),this}cameraForBounds(c,f){c=h.D.convert(c);const v=f&&f.bearing||0,w=f&&f.pitch||0,E=c.getNorthWest(),S=c.getSouthEast();return this._cameraForBounds(this.transform,E,S,v,w,f)}_extendCameraOptions(c){const f={top:0,bottom:0,right:0,left:0};if("number"==typeof(c=h.ak({padding:f,offset:[0,0],maxZoom:this.transform.maxZoom},c)).padding){const v=c.padding;c.padding={top:v,bottom:v,right:v,left:v}}return c.padding=h.ak(f,c.padding),c}_minimumAABBFrustumDistance(c,f){const v=f.max[0]-f.min[0],w=f.max[1]-f.min[1];return v/w>c.aspect?v/(2*Math.tan(.5*c.fovX)*c.aspect):w/(2*Math.tan(.5*c.fovY)*c.aspect)}_cameraForBoundsOnGlobe(c,f,v,w,E,S){const I=c.clone(),O=this._extendCameraOptions(S);I.bearing=w,I.pitch=E;const N=h.L.convert(f),V=h.L.convert(v),H=.5*(N.lat+V.lat),G=.5*(N.lng+V.lng),Y=h.cI(H,G),ee=h.v.normalize([],Y),K=h.v.normalize([],h.v.cross([],ee,[0,1,0])),ne=h.v.cross([],K,ee),J=[K[0],K[1],K[2],0,ne[0],ne[1],ne[2],0,ee[0],ee[1],ee[2],0,0,0,0,1],oe=[Y,h.cI(N.lat,N.lng),h.cI(V.lat,N.lng),h.cI(V.lat,V.lng),h.cI(N.lat,V.lng),h.cI(H,N.lng),h.cI(H,V.lng),h.cI(N.lat,G),h.cI(V.lat,G)];let _e=h.c3.fromPoints(oe.map(Ne=>[h.v.dot(K,Ne),h.v.dot(ne,Ne),h.v.dot(ee,Ne)]));const ye=h.v.transformMat4([],_e.center,J);0===h.v.squaredLength(ye)&&h.v.set(ye,0,0,1),h.v.normalize(ye,ye),h.v.scale(ye,ye,h.aC),I.center=h.cJ(ye);const re=I.getWorldToCameraMatrix(),ae=h.m.invert(new Float64Array(16),re);_e=h.c3.applyTransform(_e,h.m.multiply([],re,J)),h.v.transformMat4(ye,ye,re);const be=.5*(_e.max[2]-_e.min[2]),Se=this._minimumAABBFrustumDistance(I,_e),Ce=h.v.scale([],[0,0,1],be),ke=h.v.add(Ce,ye,Ce),lt=Se+(0===I.pitch?0:h.v.distance(ye,ke)),$e=I.globeCenterInViewSpace,Qe=h.v.sub([],ye,[$e[0],$e[1],$e[2]]);h.v.normalize(Qe,Qe),h.v.scale(Qe,Qe,lt);const Fe=h.v.add([],ye,Qe);h.v.transformMat4(Fe,Fe,ae);const ot=h.cL/h.aC,Ke=h.v.length(Fe),Ue=h.b(Math.max(Ke*ot-h.cL,Number.EPSILON),0),fe=Math.min(I.zoomFromMercatorZAdjusted(Ue),O.maxZoom);return fe>.5*(h.Z+h.G)?(I.setProjection({name:"mercator"}),I.zoom=fe,this._cameraForBounds(I,f,v,w,E,S)):{center:I.center,zoom:fe,bearing:w,pitch:E}}queryTerrainElevation(c,f){const v=this.transform.elevation;return v?(f=h.ak({},{exaggerated:!0},f),v.getAtPoint(h.M.fromLngLat(c),null,f.exaggerated)):null}_cameraForBounds(c,f,v,w,E,S){if("globe"===c.projection.name)return this._cameraForBoundsOnGlobe(c,f,v,w,E,S);const I=c.clone(),O=this._extendCameraOptions(S),N=I.padding;I.bearing=w,I.pitch=E;const V=h.L.convert(f),H=h.L.convert(v),G=new h.L(V.lng,H.lat),Y=new h.L(H.lng,V.lat),ee=I.project(V),K=I.project(H),ne=this.queryTerrainElevation(V),J=this.queryTerrainElevation(H),oe=this.queryTerrainElevation(G),_e=this.queryTerrainElevation(Y),ye=[[ee.x,ee.y,Math.min(ne||0,J||0,oe||0,_e||0)],[K.x,K.y,Math.max(ne||0,J||0,oe||0,_e||0)]];let re=h.c3.fromPoints(ye);const ae=I.getWorldToCameraMatrix(),be=h.m.invert(new Float64Array(16),ae);re=h.c3.applyTransform(re,ae);const Se=h.v.sub([],re.max,re.min),Ce=N.left||0,ke=N.right||0,lt=N.bottom||0,$e=N.top||0,{left:Qe,right:Fe,top:ot,bottom:Ke}=O.padding,Ue=.5*(Ce+ke),fe=.5*($e+lt),Ne=Math.min(I.scaleZoom(I.scale*Math.min((I.width-(Ce+ke+Qe+Fe))/Se[0],(I.height-(lt+$e+Ke+ot))/Se[1])),O.maxZoom),At=I.scale/I.zoomScale(Ne);re=new h.c3([re.min[0]-(Qe+Ue)*At,re.min[1]-(Ke+fe)*At,re.min[2]],[re.max[0]+(Fe+Ue)*At,re.max[1]+(ot+fe)*At,re.max[2]]);const vt=.5*Se[2],an=this._minimumAABBFrustumDistance(I,re),Xt=[0,0,1,0];h.e.transformMat4(Xt,Xt,ae),h.e.normalize(Xt,Xt);const mn=h.v.scale([],Xt,an+vt),nn=h.v.add([],re.center,mn),Rn=("number"==typeof O.offset.x&&"number"==typeof O.offset.y?new h.P(O.offset.x,O.offset.y):h.P.convert(O.offset)).rotate(-h.d(w));re.center[0]-=Rn.x*At,re.center[1]+=Rn.y*At,h.v.transformMat4(re.center,re.center,be),h.v.transformMat4(nn,nn,be);const Pn=[re.center[0],re.center[1],nn[2]*I.pixelsPerMeter];h.v.scale(Pn,Pn,1/I.worldSize);const gn=h.cK(Pn[0]),_n=h.l(Pn[1]),mt=Math.min(I._zoomFromMercatorZ(Pn[2]),O.maxZoom),un=new h.L(gn,_n);return I.mercatorFromTransition&&mt<.5*(h.Z+h.G)?(I.setProjection({name:"globe"}),I.zoom=mt,this._cameraForBounds(I,f,v,w,E,S)):{center:un,zoom:mt,bearing:w,pitch:E}}fitBounds(c,f,v){const w=this.cameraForBounds(c,f);return this._fitInternal(w,f,v)}fitScreenCoordinates(c,f,v,w,E){const S=h.P.convert(c),I=h.P.convert(f),O=new h.P(Math.min(S.x,I.x),Math.min(S.y,I.y)),N=new h.P(Math.max(S.x,I.x),Math.max(S.y,I.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(S,I))return this;const V=this.transform.pointLocation3D(O),H=this.transform.pointLocation3D(N),G=this.transform.pointLocation3D(new h.P(O.x,N.y)),Y=this.transform.pointLocation3D(new h.P(N.x,O.y)),ee=[Math.min(V.lng,H.lng,G.lng,Y.lng),Math.min(V.lat,H.lat,G.lat,Y.lat)],K=[Math.max(V.lng,H.lng,G.lng,Y.lng),Math.max(V.lat,H.lat,G.lat,Y.lat)],ne=w&&w.pitch?w.pitch:this.getPitch(),J=this._cameraForBounds(this.transform,ee,K,v,ne,w);return this._fitInternal(J,w,E)}_fitInternal(c,f,v){return c?(delete(f=h.ak(c,f)).padding,f.linear?this.easeTo(f,v):this.flyTo(f,v)):this}jumpTo(c,f){this.stop();const v=c.preloadOnly?this.transform.clone():this.transform;let w=!1,E=!1,S=!1;return"zoom"in c&&v.zoom!==+c.zoom&&(w=!0,v.zoom=+c.zoom),void 0!==c.center&&(v.center=h.L.convert(c.center)),"bearing"in c&&v.bearing!==+c.bearing&&(E=!0,v.bearing=+c.bearing),"pitch"in c&&v.pitch!==+c.pitch&&(S=!0,v.pitch=+c.pitch),null==c.padding||v.isPaddingEqual(c.padding)||(v.padding=c.padding),c.preloadOnly?(this._preloadTiles(v),this):(this.fire(new h.a8("movestart",f)).fire(new h.a8("move",f)),w&&this.fire(new h.a8("zoomstart",f)).fire(new h.a8("zoom",f)).fire(new h.a8("zoomend",f)),E&&this.fire(new h.a8("rotatestart",f)).fire(new h.a8("rotate",f)).fire(new h.a8("rotateend",f)),S&&this.fire(new h.a8("pitchstart",f)).fire(new h.a8("pitch",f)).fire(new h.a8("pitchend",f)),this.fire(new h.a8("moveend",f)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||h.X(zv),this.transform.getFreeCameraOptions()}setFreeCameraOptions(c,f){const v=this.transform;if(!v.projection.supportsFreeCamera)return h.X(zv),this;this.stop();const w=v.zoom,E=v.pitch,S=v.bearing;v.setFreeCameraOptions(c);const I=w!==v.zoom,O=E!==v.pitch,N=S!==v.bearing;return this.fire(new h.a8("movestart",f)).fire(new h.a8("move",f)),I&&this.fire(new h.a8("zoomstart",f)).fire(new h.a8("zoom",f)).fire(new h.a8("zoomend",f)),N&&this.fire(new h.a8("rotatestart",f)).fire(new h.a8("rotate",f)).fire(new h.a8("rotateend",f)),O&&this.fire(new h.a8("pitchstart",f)).fire(new h.a8("pitch",f)).fire(new h.a8("pitchend",f)),this.fire(new h.a8("moveend",f)),this}easeTo(c,f){this._stop(!1,c.easeId),(!1===(c=h.ak({offset:[0,0],duration:500,easing:h.cG},c)).animate||this._prefersReducedMotion(c))&&(c.duration=0);const v=this.transform,w=this.getZoom(),E=this.getBearing(),S=this.getPitch(),I=this.getPadding(),O="zoom"in c?+c.zoom:w,N="bearing"in c?this._normalizeBearing(c.bearing,E):E,V="pitch"in c?+c.pitch:S,H="padding"in c?c.padding:v.padding,G=h.P.convert(c.offset);let Y,ee,K;if("globe"===v.projection.name){const Ce=h.M.fromLngLat(v.center),ke=G.rotate(-v.angle);Ce.x+=ke.x/v.worldSize,Ce.y+=ke.y/v.worldSize;const lt=Ce.toLngLat(),$e=h.L.convert(c.center||lt);this._normalizeCenter($e),Y=v.centerPoint.add(ke),ee=new h.P(Ce.x,Ce.y).mult(v.worldSize),K=new h.P(h.E($e.lng),h.H($e.lat)).mult(v.worldSize).sub(ee)}else{Y=v.centerPoint.add(G);const Ce=v.pointLocation(Y),ke=h.L.convert(c.center||Ce);this._normalizeCenter(ke),ee=v.project(Ce),K=v.project(ke).sub(ee)}const ne=v.zoomScale(O-w);let J,oe;c.around&&(J=h.L.convert(c.around),oe=v.locationPoint(J));const _e=this._zooming||O!==w,ye=this._rotating||E!==N,re=this._pitching||V!==S,ae=!v.isPaddingEqual(H),be=Ce=>ke=>{if(_e&&(Ce.zoom=h.n(w,O,ke)),ye&&(Ce.bearing=h.n(E,N,ke)),re&&(Ce.pitch=h.n(S,V,ke)),ae&&(Ce.interpolatePadding(I,H,ke),Y=Ce.centerPoint.add(G)),J)Ce.setLocationAtPoint(J,oe);else{const lt=Ce.zoomScale(Ce.zoom-w),$e=O>w?Math.min(2,ne):Math.max(.5,ne),Qe=Math.pow($e,1-ke),Fe=Ce.unproject(ee.add(K.mult(ke*Qe)).mult(lt));Ce.setLocationAtPoint(Ce.renderWorldCopies?Fe.wrap():Fe,Y)}return c.preloadOnly||this._fireMoveEvents(f),Ce};if(c.preloadOnly){const Ce=this._emulate(be,c.duration,v);return this._preloadTiles(Ce),this}const Se={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=_e,this._rotating=ye,this._pitching=re,this._easeId=c.easeId,this._prepareEase(f,c.noMoveStart,Se),this._ease(be(v),Ce=>{"sea"===v.cameraElevationReference&&v.recenterOnTerrain(),this._afterEase(f,Ce)},c),this}_prepareEase(c,f,v={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&0===this.transform.pitch&&"globe"!==this.transform.projection.name&&(this.transform.cameraElevationReference="ground"),f||v.moving||this.fire(new h.a8("movestart",c)),this._zooming&&!v.zooming&&this.fire(new h.a8("zoomstart",c)),this._rotating&&!v.rotating&&this.fire(new h.a8("rotatestart",c)),this._pitching&&!v.pitching&&this.fire(new h.a8("pitchstart",c))}_fireMoveEvents(c){this.fire(new h.a8("move",c)),this._zooming&&this.fire(new h.a8("zoom",c)),this._rotating&&this.fire(new h.a8("rotate",c)),this._pitching&&this.fire(new h.a8("pitch",c))}_afterEase(c,f){if(this._easeId&&f&&this._easeId===f)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const v=this._zooming,w=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,v&&this.fire(new h.a8("zoomend",c)),w&&this.fire(new h.a8("rotateend",c)),E&&this.fire(new h.a8("pitchend",c)),this.fire(new h.a8("moveend",c))}flyTo(c,f){if(this._prefersReducedMotion(c)){const Ke=h.p(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ke,f)}this.stop(),c=h.ak({offset:[0,0],speed:1.2,curve:1.42,easing:h.cG},c);const v=this.transform,w=this.getZoom(),E=this.getBearing(),S=this.getPitch(),I="zoom"in c?h.c(+c.zoom,v.minZoom,v.maxZoom):w,O="bearing"in c?this._normalizeBearing(c.bearing,E):E,N="pitch"in c?+c.pitch:S,V=v.zoomScale(I-w),H=h.P.convert(c.offset),G=v.centerPoint.add(H),Y=v.pointLocation(G);let ee=c.center;if(ee&&c.padding){const Ke=this._cameraForBounds(this.transform,ee,ee,O,N,c);Ke&&(ee=Ke.center)}ee=h.L.convert(ee||Y),this._normalizeCenter(ee);const K=v.project(Y),ne=v.project(ee).sub(K);let J=c.curve;const oe=Math.max(v.width,v.height),_e=oe/V,ye=ne.mag();if("minZoom"in c){const Ke=h.c(Math.min(c.minZoom,w,I),v.minZoom,v.maxZoom),Ue=oe/v.zoomScale(Ke-w);J=Math.sqrt(Ue/ye*2)}const re=J*J;function ae(Ke){const Ue=(_e*_e-oe*oe+(Ke?-1:1)*re*re*ye*ye)/(2*(Ke?_e:oe)*re*ye);return Math.log(Math.sqrt(Ue*Ue+1)-Ue)}function be(Ke){return(Math.exp(Ke)-Math.exp(-Ke))/2}function Se(Ke){return(Math.exp(Ke)+Math.exp(-Ke))/2}const Ce=ae(0);let ke=function(Ke){return Se(Ce)/Se(Ce+J*Ke)},lt=function(Ke){return oe*((Se(Ce)*(be(Ue=Ce+J*Ke)/Se(Ue))-be(Ce))/re)/ye;var Ue},$e=(ae(1)-Ce)/J;if(Math.abs(ye)<1e-6||!isFinite($e)){if(Math.abs(oe-_e)<1e-6)return this.easeTo(c,f);const Ke=_e<oe?-1:1;$e=Math.abs(Math.log(_e/oe))/J,lt=function(){return 0},ke=function(Ue){return Math.exp(Ke*J*Ue)}}c.duration="duration"in c?+c.duration:1e3*$e/("screenSpeed"in c?+c.screenSpeed/J:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0);const Qe=E!==O,Fe=N!==S,ot=Ke=>Ue=>{const fe=Ue*$e,Ne=1/ke(fe);Ke.zoom=1===Ue?I:w+Ke.scaleZoom(Ne),Qe&&(Ke.bearing=h.n(E,O,Ue)),Fe&&(Ke.pitch=h.n(S,N,Ue));const At=1===Ue?ee:Ke.unproject(K.add(ne.mult(lt(fe))).mult(Ne));return Ke.setLocationAtPoint(Ke.renderWorldCopies?At.wrap():At,G),Ke._updateCameraOnTerrain(),c.preloadOnly||this._fireMoveEvents(f),Ke};if(c.preloadOnly){const Ke=this._emulate(ot,c.duration,v);return this._preloadTiles(Ke),this}return this._zooming=!0,this._rotating=Qe,this._pitching=Fe,this._prepareEase(f,!1),this._ease(ot(v),()=>this._afterEase(f),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,f){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const v=this._onEaseEnd;this._onEaseEnd=void 0,v.call(this,f)}if(!c){const v=this.handlers;v&&v.stop(!1)}return this}_ease(c,f,v){!1===v.animate||0===v.duration?(c(1),f()):(this._easeStart=h.a4.now(),this._easeOptions=v,this._onEaseFrame=c,this._onEaseEnd=f,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((h.a4.now()-this._easeStart)/this._easeOptions.duration,1),f=this._onEaseFrame;f&&f(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,f){c=h.w(c,-180,180);const v=Math.abs(c-f);return Math.abs(c-360-f)<v&&(c-=360),Math.abs(c+360-f)<v&&(c+=360),c}_normalizeCenter(c){const f=this.transform;if(f.maxBounds||"globe"!==f.projection.name&&!f.renderWorldCopies)return;const v=c.lng-f.center.lng;c.lng+=v>180?-360:v<-180?360:0}_prefersReducedMotion(c){return this._respectPrefersReducedMotion&&h.a4.prefersReducedMotion&&!(c&&c.essential)}_emulate(c,f,v){const w=Math.ceil(15*f/1e3),E=[],S=c(v.clone());for(let I=0;I<=w;I++){const O=S(I/w);E.push(O.clone())}return E}}class Hh{constructor(c={}){this.options=c,h.aR(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){const f=this.options&&this.options.compact;return this._map=c,this._container=Ye("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Ye("button","mapboxgl-ctrl-attrib-button",this._container),Ye("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Ye("div","mapboxgl-ctrl-attrib-inner",this._container),f&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===f&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(c,f){const v=this._map._getUIString(`AttributionControl.${f}`);c.removeAttribute("title"),c.firstElementChild&&c.firstElementChild.setAttribute("title",v)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let c=this._editLink;c||(c=this._editLink=this._container.querySelector(".mapbox-improve-map"));const f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||h.cM.ACCESS_TOKEN}];if(c){const v=f.reduce((w,E,S)=>(E.value&&(w+=`${E.key}=${E.value}${S<f.length-1?"&":""}`),w),"?");c.href=`${h.cM.FEEDBACK_URL}/${v}#${fi(this._map,!0)}`,c.rel="noopener nofollow",this._setElementTitle(c,"MapFeedback")}}_updateData(c){!c||"metadata"!==c.sourceDataType&&"visibility"!==c.sourceDataType&&"style"!==c.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let c=[];if(this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const f=this._map.style._mergedSourceCaches;for(const w in f){const E=f[w];if(E.used){const S=E.getSource();S.attribution&&c.indexOf(S.attribution)<0&&c.push(S.attribution)}}c.sort((w,E)=>w.length-E.length),c=c.filter((w,E)=>{for(let S=E+1;S<c.length;S++)if(c[S].indexOf(w)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=[...this.options.customAttribution,...c]:c.unshift(this.options.customAttribution));const v=c.join(" | ");v!==this._attribHTML&&(this._attribHTML=v,c.length?(this._innerContainer.innerHTML=v,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Pd{constructor(){h.aR(["_updateLogo","_updateCompact"],this)}onAdd(c){this._map=c,this._container=Ye("div","mapboxgl-ctrl");const f=Ye("a","mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://www.mapbox.com/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(c){c&&"metadata"!==c.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const c=this._map.style._sourceCaches;if(0===Object.entries(c).length)return!0;for(const f in c){const v=c[f].getSource();if(v.hasOwnProperty("mapbox_logo")&&!v.mapbox_logo)return!1}return!0}_updateCompact(){const c=this._container.children;if(c.length){const f=c[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("mapboxgl-compact"):f.classList.remove("mapboxgl-compact")}}}class zm{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const f=++this._id;return this._queue.push({callback:c,id:f,cancelled:!1}),f}remove(c){const f=this._currentlyRunning,v=f?this._queue.concat(f):this._queue;for(const w of v)if(w.id===c)return void(w.cancelled=!0)}run(c=0){const f=this._currentlyRunning=this._queue;this._queue=[];for(const v of f)if(!v.cancelled&&(v.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function P_(_,c,f){if(_=new h.L(_.lng,_.lat),c){const v=new h.L(_.lng-360,_.lat),w=new h.L(_.lng+360,_.lat),E=360*Math.ceil(Math.abs(_.lng-f.center.lng)/360),S=f.locationPoint(_).distSqr(c),I=c.x<0||c.y<0||c.x>f.width||c.y>f.height;f.locationPoint(v).distSqr(c)<S&&(I||Math.abs(v.lng-f.center.lng)<E)?_=v:f.locationPoint(w).distSqr(c)<S&&(I||Math.abs(w.lng-f.center.lng)<E)&&(_=w)}for(;Math.abs(_.lng-f.center.lng)>180;){const v=f.locationPoint(_);if(v.x>=0&&v.y>=0&&v.x<=f.width&&v.y<=f.height)break;_.lng>f.center.lng?_.lng-=360:_.lng+=360}return _}const $h={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class fo extends h.a6{constructor(c,f){if(super(),(c instanceof HTMLElement||f)&&(c=h.ak({element:c},f)),h.aR(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=c&&c.occludedOpacity||.2,c&&c.element)this._element=c.element,this._offset=h.P.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=Ye("div");const E=41,S=27,I=Vt("svg",{display:"block",height:E*this._scale+"px",width:S*this._scale+"px",viewBox:`0 0 ${S} ${E}`},this._element),O=Vt("radialGradient",{id:"shadowGradient"},Vt("defs",{},I));Vt("stop",{offset:"10%","stop-opacity":.4},O),Vt("stop",{offset:"100%","stop-opacity":.05},O),Vt("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},I),Vt("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},I),Vt("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},I),Vt("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},I),this._offset=h.P.convert(c&&c.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",E=>{E.preventDefault()}),this._element.addEventListener("mousedown",E=>{E.preventDefault()});const v=this._element.classList;for(const E in $h)v.remove(`mapboxgl-marker-anchor-${E}`);v.add(`mapboxgl-marker-anchor-${this._anchor}`);const w=c&&c.className?c.className.trim().split(/\s+/):[];v.add(...w),this._popup=null}addTo(c){return c===this._map||(this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._updateMoving),c.on("moveend",this._update),c.on("remove",this._clearFadeTimer),c._addMarker(this),this.setDraggable(this._draggable),this._update(),c.on("click",this._onMapClick)),this}remove(){const c=this._map;return c&&(c.off("click",this._onMapClick),c.off("move",this._updateMoving),c.off("moveend",this._update),c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler),c.off("mouseup",this._onUp),c.off("touchend",this._onUp),c.off("mousemove",this._onMove),c.off("touchmove",this._onMove),c.off("remove",this._clearFadeTimer),c._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=h.L.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const w=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(24.6+w)],"bottom-right":[-w,-1*(24.6+w)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=c,c._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(c){const f=c.code,v=c.charCode||c.keyCode;"Space"!==f&&"Enter"!==f&&32!==v&&13!==v||this.togglePopup()}_onMapClick(c){const f=c.originalEvent.target,v=this._element;this._popup&&(f===v||v.contains(f))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?(c.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(c.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const c=this._map,f=this._pos;if(!c||!f)return!1;const v=c.unproject(f),w=c.getFreeCameraOptions();if(!w.position)return!1;const E=w.position.toLngLat();return E.distanceTo(v)<.9*E.distanceTo(this._lngLat)}_evaluateOpacity(){const c=this._map;if(!c)return;const f=this._pos;if(!f||f.x<0||f.x>c.transform.width||f.y<0||f.y>c.transform.height)return void this._clearFadeTimer();const v=c.unproject(f);let w;c._showingGlobe()&&h.cN(c.transform,this._lngLat)?w=0:(w=1-c._queryFogOpacity(v),c.transform._terrainEnabled()&&c.getTerrain()&&this._behindTerrain()&&(w*=this._occludedOpacity)),this._element.style.opacity=`${w}`,this._element.style.pointerEvents=w>0?"auto":"none",this._popup&&this._popup._setOpacity(w),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const c=this._pos;if(!c||!this._map)return;const f=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${c.x}px,${c.y}px)\n            ${$h[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${f.x}px,${f.y}px)\n        `}_calculateXYTransform(){const c=this._pos,f=this._map,v=this.getPitchAlignment();if(!f||!c||"map"!==v)return"";if(!f._showingGlobe()){const O=f.getPitch();return O?`rotateX(${O}deg)`:""}const w=h.Y(h.cO(f.transform,this._lngLat)),E=c.sub(h.cP(f.transform)),S=Math.abs(E.x)+Math.abs(E.y);if(0===S)return"";const I=w/S;return`rotateX(${-E.y*I}deg) rotateY(${E.x*I}deg)`}_calculateZTransform(){const c=this._pos,f=this._map;if(!f||!c)return"";let v=0;const w=this.getRotationAlignment();if("map"===w)if(f._showingGlobe()){const E=f.project(new h.L(this._lngLat.lng,this._lngLat.lat+.001)),S=f.project(new h.L(this._lngLat.lng,this._lngLat.lat-.001)).sub(E);v=h.Y(Math.atan2(S.y,S.x))-90}else v=-f.getBearing();else if("horizon"===w){const E=h.an(4,6,f.getZoom()),S=h.cP(f.transform);S.y+=E*f.transform.height;const I=c.sub(S),O=h.Y(Math.atan2(I.y,I.x));v=(O>90?O-270:O+90)*(1-E)}return v+=this._rotation,v?`rotateZ(${v}deg)`:""}_update(c){cancelAnimationFrame(this._updateFrameId);const f=this._map;f&&(f.transform.renderWorldCopies&&(this._lngLat=P_(this._lngLat,this._pos,f.transform)),this._pos=f.project(this._lngLat),!0===c?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),f._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(f._showingGlobe()||f.getTerrain()||f.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(c){return this._offset=h.P.convert(c),this._update(),this}addClassName(c){return this._element.classList.add(c),this}removeClassName(c){return this._element.classList.remove(c),this}toggleClassName(c){return this._element.classList.toggle(c)}_onMove(c){const f=this._map;if(!f)return;const v=this._pointerdownPos,w=this._positionDelta;if(v&&w){if(!this._isDragging){const E=this._clickTolerance||f._clickTolerance;if(c.point.dist(v)<E)return;this._isDragging=!0}this._pos=c.point.sub(w),this._lngLat=f.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new h.a8("dragstart"))),this.fire(new h.a8("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const c=this._map;c&&(c.off("mousemove",this._onMove),c.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new h.a8("dragend")),this._state="inactive"}_addDragHandler(c){const f=this._map,v=this._pos;f&&v&&this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(v),this._pointerdownPos=c.point,this._state="pending",f.on("mousemove",this._onMove),f.on("touchmove",this._onMove),f.once("mouseup",this._onUp),f.once("touchend",this._onUp))}setDraggable(c){this._draggable=!!c;const f=this._map;return f&&(c?(f.on("mousedown",this._addDragHandler),f.on("touchstart",this._addDragHandler)):(f.off("mousedown",this._addDragHandler),f.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(c){return this._occludedOpacity=c||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Vv={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},cp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function O_(_=new h.P(0,0),c="bottom"){if("number"==typeof _){const f=Math.round(Math.sqrt(.5*Math.pow(_,2)));switch(c){case"top":return new h.P(0,_);case"top-left":return new h.P(f,f);case"top-right":return new h.P(-f,f);case"bottom":return new h.P(0,-_);case"bottom-left":return new h.P(f,-f);case"bottom-right":return new h.P(-f,-f);case"left":return new h.P(_,0);case"right":return new h.P(-_,0)}return new h.P(0,0)}return _ instanceof h.P||Array.isArray(_)?h.P.convert(_):h.P.convert(_[c]||[0,0])}class v1{constructor(c){this.jumpTo(c)}getValue(c){if(c<=this._startTime)return this._start;if(c>=this._endTime)return this._end;const f=h.ba((c-this._startTime)/(this._endTime-this._startTime));return this._start*(1-f)+this._end*f}isEasing(c){return c>=this._startTime&&c<=this._endTime}jumpTo(c){this._startTime=-1/0,this._endTime=-1/0,this._start=c,this._end=c}easeTo(c,f,v){this._start=this.getValue(f),this._end=c,this._startTime=f,this._endTime=f+v}}const jv={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},wa={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1};class Vm{constructor(){this.showOverdrawInspector=!1,this.showTileBoundaries=!1,this.continuousRedraw=!1,this.showTerrainWireframe=!1,this.showLayers2DWireframe=!1,this.showLayers3DWireframe=!1}}const Uv={showCompass:!0,showZoom:!0,visualizePitch:!1};class Gc{constructor(c,f,v=!1){this._clickTolerance=10,this.element=f,this.mouseRotate=new rp({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,v&&(this.mousePitch=new op({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),h.aR(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),f.addEventListener("mousedown",this.mousedown),f.addEventListener("touchstart",this.touchstart,{passive:!1}),f.addEventListener("touchmove",this.touchmove),f.addEventListener("touchend",this.touchend),f.addEventListener("touchcancel",this.reset)}down(c,f){this.mouseRotate.mousedown(c,f),this.mousePitch&&this.mousePitch.mousedown(c,f),en()}move(c,f){const v=this.map,w=this.mouseRotate.mousemoveWindow(c,f),E=w&&w.bearingDelta;if(E&&v.setBearing(v.getBearing()+E),this.mousePitch){const S=this.mousePitch.mousemoveWindow(c,f),I=S&&S.pitchDelta;I&&v.setPitch(v.getPitch()+I)}}off(){const c=this.element;c.removeEventListener("mousedown",this.mousedown),c.removeEventListener("touchstart",this.touchstart,{passive:!1}),c.removeEventListener("touchmove",this.touchmove),c.removeEventListener("touchend",this.touchend),c.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Yt(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(c){this.down(h.ak({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),qt(this.element,c)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(c){this.move(c,qt(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){1!==c.targetTouches.length?this.reset():(this._startPos=this._lastPos=nt(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){1!==c.targetTouches.length?this.reset():(this._lastPos=nt(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){0===c.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Il={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Lu={maxWidth:100,unit:"metric"},up={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"};return{version:h.c$,supported:Xe,setRTLTextPlugin:h.d1,getRTLTextPluginStatus:h.d2,Map:class extends lp{constructor(_){const c=_;if(null!=(_=h.ak({},wa,_)).minZoom&&null!=_.maxZoom&&_.minZoom>_.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=_.minPitch&&null!=_.maxPitch&&_.minPitch>_.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=_.minPitch&&_.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=_.maxPitch&&_.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(_.antialias&&h.cQ(window)&&(_.antialias=!1,h.X("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new ni(_.minZoom,_.maxZoom,_.minPitch,_.maxPitch,_.renderWorldCopies),_),this._repaint=!1,this._interactive=_.interactive,this._minTileCacheSize=_.minTileCacheSize,this._maxTileCacheSize=_.maxTileCacheSize,this._failIfMajorPerformanceCaveat=_.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=_.preserveDrawingBuffer,this._antialias=_.antialias,this._trackResize=_.trackResize,this._bearingSnap=_.bearingSnap,this._refreshExpiredTiles=_.refreshExpiredTiles,this._fadeDuration=_.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=_.crossSourceCollisions,this._collectResourceTiming=_.collectResourceTiming,this._language=this._parseLanguage(_.language),this._worldview=_.worldview,this._renderTaskQueue=new zm,this._domRenderTaskQueue=new zm,this._controls=[],this._markers=[],this._popups=[],this._mapId=h.cR(),this._locale=h.ak({},jv,_.locale),this._clickTolerance=_.clickTolerance,this._cooperativeGestures=_.cooperativeGestures,this._performanceMetricsCollection=_.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new v1(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new h.cS(_.transformRequest,_.accessToken,_.testMode),this._silenceAuthErrors=!!_.testMode,this._contextCreateOptions=_.contextCreateOptions?{..._.contextCreateOptions}:{},"string"==typeof _.container){const f=document.getElementById(_.container);if(!f)throw new Error(`Container '${_.container.toString()}' not found.`);this._container=f}else{if(!(_.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=_.container}if(this._container.childNodes.length>0&&h.X("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),_.maxBounds&&this.setMaxBounds(_.maxBounds),h.aR(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._debugParams=new Vm,this._tp=_.devtools?new no(this):new no,this._tp.registerParameter(this._debugParams,["Debug"],"showOverdrawInspector",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"showTileBoundaries",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"continuousRedraw",void 0,f=>{this.repaint=f}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showTerrainWireframe",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showLayers2DWireframe",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showLayers3DWireframe",void 0,()=>{this._update()}),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Bm(this,_),this._localFontFamily=_.localFontFamily,this._localIdeographFontFamily=_.localIdeographFontFamily,(_.style||!_.testMode)&&this.setStyle(_.style||h.cM.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),_.projection&&this.setProjection(_.projection),_.hash&&(this._hash=new yn("string"==typeof _.hash&&_.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){null==c.center&&null==c.zoom||(this.transform._unmodified=!1),this.jumpTo({center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch});const f=_.bounds;f&&(this.resize(),this.fitBounds(f,h.ak({},_.fitBoundsOptions,{duration:0})))}this.resize(),_.attributionControl&&this.addControl(new Hh({customAttribution:_.customAttribution})),this._logoControl=new Pd,this.addControl(this._logoControl,_.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",f=>{this._update("style"===f.dataType),this.fire(new h.a8(`${f.dataType}data`,f))}),this.on("dataloading",f=>{this.fire(new h.a8(`${f.dataType}dataloading`,f))})}_getMapId(){return this._mapId}addControl(_,c){if(void 0===c&&(c=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new h.a7(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const f=_.onAdd(this);this._controls.push(_);const v=this._controlPositions[c];return-1!==c.indexOf("bottom")?v.insertBefore(f,v.firstChild):v.appendChild(f),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new h.a7(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(_);return c>-1&&this._controls.splice(c,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(_){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const c=!this._moving;return c&&this.fire(new h.a8("movestart",_)).fire(new h.a8("move",_)),this.fire(new h.a8("resize",_)),c&&this.fire(new h.a8("moveend",_)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(_){return this.transform.setMaxBounds(h.D.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_?this.setZoom(_):this.fire(new h.a8("zoomstart")).fire(new h.a8("zoom")).fire(new h.a8("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_?this.setZoom(_):this.fire(new h.a8("zoomstart")).fire(new h.a8("zoom")).fire(new h.a8("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_?this.setPitch(_):this.fire(new h.a8("pitchstart")).fire(new h.a8("pitch")).fire(new h.a8("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_?this.setPitch(_):this.fire(new h.a8("pitchstart")).fire(new h.a8("pitch")).fire(new h.a8("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(_){return"auto"===_?navigator.language:Array.isArray(_)?0===_.length?void 0:_.map(c=>"auto"===c?navigator.language:c):_}setLanguage(_){const c=this._parseLanguage(_);if(!this.style||c===this._language)return this;this._language=c,this.style.reloadSources();for(const f of this._controls)f._setLanguage&&f._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(_){return this.style&&_!==this._worldview?(this._worldview=_,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(_){return this._lazyInitEmptyStyle(),_?"string"==typeof _&&(_={name:_}):_=null,this._useExplicitProjection=!!_,this._prioritizeAndUpdateProjection(_,this.style.projection)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const _=this.transform,c=_.projection.name;let f;"globe"===c&&_.zoom>=h.G?(_.setMercatorFromTransition(),f=!0):"mercator"===c&&_.zoom<h.G&&(_.setProjection({name:"globe"}),f=!0),f&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(_,c){return this._updateProjection(_||c||{name:"mercator"})}_updateProjection(_){let c;return c="globe"===_.name&&this.transform.zoom>=h.G?this.transform.setMercatorFromTransition():this.transform.setProjection(_),this.style.applyProjectionUpdate(),c&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(_){return this.transform.locationPoint3D(h.L.convert(_))}unproject(_){return this.transform.pointLocation3D(h.P.convert(_))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(_,c,f){if("mouseenter"===_||"mouseover"===_){let v=!1;const w=S=>{const I=c.filter(N=>this.getLayer(N)),O=I.length?this.queryRenderedFeatures(S.point,{layers:I}):[];O.length?v||(v=!0,f.call(this,new ea(_,this,S.originalEvent,{features:O}))):v=!1},E=()=>{v=!1};return{layers:new Set(c),listener:f,delegates:{mousemove:w,mouseout:E}}}if("mouseleave"===_||"mouseout"===_){let v=!1;const w=S=>{const I=c.filter(O=>this.getLayer(O));(I.length?this.queryRenderedFeatures(S.point,{layers:I}):[]).length?v=!0:v&&(v=!1,f.call(this,new ea(_,this,S.originalEvent)))},E=S=>{v&&(v=!1,f.call(this,new ea(_,this,S.originalEvent)))};return{layers:new Set(c),listener:f,delegates:{mousemove:w,mouseout:E}}}{const v=w=>{const E=c.filter(I=>this.getLayer(I)),S=E.length?this.queryRenderedFeatures(w.point,{layers:E}):[];S.length&&(w.features=S,f.call(this,w),delete w.features)};return{layers:new Set(c),listener:f,delegates:{[_]:v}}}}on(_,c,f){if(void 0===f)return super.on(_,c);if(Array.isArray(c)||(c=[c]),c)for(const w of c)if(!this._isValidId(w))return this;const v=this._createDelegatedListener(_,c,f);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(v);for(const w in v.delegates)this.on(w,v.delegates[w]);return this}once(_,c,f){if(void 0===f)return super.once(_,c);if(Array.isArray(c)||(c=[c]),c)for(const w of c)if(!this._isValidId(w))return this;const v=this._createDelegatedListener(_,c,f);for(const w in v.delegates)this.once(w,v.delegates[w]);return this}off(_,c,f){if(void 0===f)return super.off(_,c);c=new Set(Array.isArray(c)?c:[c]);for(const E of c)if(!this._isValidId(E))return this;const v=(E,S)=>{if(E.size!==S.size)return!1;for(const I of E)if(!S.has(I))return!1;return!0},w=this._delegatedListeners?this._delegatedListeners[_]:void 0;return w&&(E=>{for(let S=0;S<E.length;S++){const I=E[S];if(I.listener===f&&v(I.layers,c)){for(const O in I.delegates)this.off(O,I.delegates[O]);return E.splice(S,1),this}}})(w),this}queryRenderedFeatures(_,c){if(!this.style)return[];if(void 0!==c||void 0===_||_ instanceof h.P||Array.isArray(_)||(c=_,_=void 0),_=_||[[0,0],[this.transform.width,this.transform.height]],(c=c||{}).layers&&Array.isArray(c.layers))for(const f of c.layers)if(!this._isValidId(f))return[];return this.style.queryRenderedFeatures(_,c,this.transform)}querySourceFeatures(_,c){return this._isValidId(_)?this.style.querySourceFeatures(_,c):[]}isPointOnSurface(_){const{name:c}=this.transform.projection;return"globe"!==c&&"mercator"!==c&&h.X(`${c} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(h.P.convert(_))}setStyle(_,c){return!1!==(c=h.ak({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},c)).diff&&c.localIdeographFontFamily===this._localIdeographFontFamily&&c.localFontFamily===this._localFontFamily&&this.style&&_?(this._diffStyle(_,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._localFontFamily=c.localFontFamily,this._updateStyle(_,c))}_getUIString(_){const c=this._locale[_];if(null==c)throw new Error(`Missing UI string '${_}'`);return c}_updateStyle(_,c){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),_&&(this.style=new Ae(this,c||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof _?this.style.loadURL(_):this.style.loadJSON(_)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ae(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,c){if("string"==typeof _){const f=this._requestManager.normalizeStyleURL(_),v=this._requestManager.transformRequest(f,h.a2.Style);h.a1(v,(w,E)=>{w?this.fire(new h.a7(w)):E&&this._updateDiff(E,c)})}else"object"==typeof _&&this._updateDiff(_,c)}_updateDiff(_,c){try{this.style.setState(_)&&this._update(!0)}catch(f){h.X(`Unable to perform style diff: ${f.message||f.error||f}.  Rebuilding the style from scratch.`),this._updateStyle(_,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(h.X("There is no style added to the map."),!1)}_isValidId(_){return null==_?(this.fire(new h.a7(new Error("IDs can't be empty."))),!1):!h.cu(_)||(this.fire(new h.a7(new Error(`IDs can't contain special symbols: "${_}".`))),!1)}addSource(_,c){return this._isValidId(_)?(this._lazyInitEmptyStyle(),this.style.addSource(_,c),this._update(!0)):this}isSourceLoaded(_){return!!this._isValidId(_)&&!!this.style&&this.style._isSourceCacheLoaded(_)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(_,c,f){this._lazyInitEmptyStyle(),this.style.addSourceType(_,c,f)}removeSource(_){return this._isValidId(_)?(this.style.removeSource(_),this._updateTerrain(),this._update(!0)):this}getSource(_){return this._isValidId(_)?this.style.getOwnSource(_):null}addImage(_,c,{pixelRatio:f=1,sdf:v=!1,stretchX:w,stretchY:E,content:S}={}){if(this._lazyInitEmptyStyle(),c instanceof HTMLImageElement||ImageBitmap&&c instanceof ImageBitmap){const{width:I,height:O,data:N}=h.a4.getImageData(c);this.style.addImage(_,{data:new h.a5({width:I,height:O},N),pixelRatio:f,stretchX:w,stretchY:E,content:S,sdf:v,version:0})}else if(void 0===c.width||void 0===c.height)this.fire(new h.a7(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:I,height:O}=c,N=c;this.style.addImage(_,{data:new h.a5({width:I,height:O},new Uint8Array(N.data)),pixelRatio:f,stretchX:w,stretchY:E,content:S,sdf:v,version:0,userImage:N}),N.onAdd&&N.onAdd(this,_)}}updateImage(_,c){this._lazyInitEmptyStyle();const f=this.style.getImage(_);if(!f)return void this.fire(new h.a7(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const v=c instanceof HTMLImageElement||ImageBitmap&&c instanceof ImageBitmap?h.a4.getImageData(c):c,{width:w,height:E}=v,S=v.data;if(void 0===w||void 0===E)return void this.fire(new h.a7(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(w!==f.data.width||E!==f.data.height)return void this.fire(new h.a7(new Error(`The width and height of the updated image (${w}, ${E})\n                must be that same as the previous version of the image\n                (${f.data.width}, ${f.data.height})`)));const I=!(c instanceof HTMLImageElement||ImageBitmap&&c instanceof ImageBitmap);f.data.replace(S,I),this.style.updateImage(_,f)}hasImage(_){return _?!!this.style&&!!this.style.getImage(_):(this.fire(new h.a7(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_,c){h.a3(this._requestManager.transformRequest(_,h.a2.Image),(f,v)=>{c(f,v instanceof HTMLImageElement?h.a4.getImageData(v):v)})}listImages(){return this.style.listImages()}addModel(_,c){this._lazyInitEmptyStyle(),this.style.addModel(_,c)}hasModel(_){return _?this.style.hasModel(_):(this.fire(new h.a7(new Error("Missing required model id"))),!1)}removeModel(_){this.style.removeModel(_)}listModels(){return this.style.listModels()}addLayer(_,c){return this._isValidId(_.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(_,c),this._update(!0)):this}moveLayer(_,c){return this._isValidId(_)?(this.style.moveLayer(_,c),this._update(!0)):this}removeLayer(_){return this._isValidId(_)?(this.style.removeLayer(_),this._update(!0)):this}getLayer(_){return this._isValidId(_)?this.style.getOwnLayer(_):null}setLayerZoomRange(_,c,f){return this._isValidId(_)?(this.style.setLayerZoomRange(_,c,f),this._update(!0)):this}setFilter(_,c,f={}){return this._isValidId(_)?(this.style.setFilter(_,c,f),this._update(!0)):this}getFilter(_){return this._isValidId(_)?this.style.getFilter(_):null}setPaintProperty(_,c,f,v={}){return this._isValidId(_)?(this.style.setPaintProperty(_,c,f,v),this._update(!0)):this}getPaintProperty(_,c){return this._isValidId(_)?this.style.getPaintProperty(_,c):null}setLayoutProperty(_,c,f,v={}){return this._isValidId(_)?(this.style.setLayoutProperty(_,c,f,v),this._update(!0)):this}getLayoutProperty(_,c){return this._isValidId(_)?this.style.getLayoutProperty(_,c):null}getConfigProperty(_,c){return this.style.getConfigProperty(_,c)}setConfigProperty(_,c,f){return this.style.setConfigProperty(_,c,f),this._update(!0)}setLights(_){if(this._lazyInitEmptyStyle(),_&&1===_.length&&"flat"===_[0].type){const c=_[0];c.properties?this.style.setFlatLight(c.properties,c.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(_),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const _=this.style.getLights()||[];return 0===_.length&&_.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),_}setLight(_,c={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:_}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(_){return this._lazyInitEmptyStyle(),!_&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(_),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(_){return this._lazyInitEmptyStyle(),this.style.setFog(_),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(_){return this.style.setCamera(_),this._triggerCameraUpdate(_)}_triggerCameraUpdate(_){return this._update(this.transform.setOrthographicProjectionAtLowPitch("orthographic"===_["camera-projection"]))}getCamera(){return this.style.camera}_queryFogOpacity(_){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(h.L.convert(_),this.transform):0}setFeatureState(_,c){return this._isValidId(_.source)?(this.style.setFeatureState(_,c),this._update()):this}removeFeatureState(_,c){return this._isValidId(_.source)?(this.style.removeFeatureState(_,c),this._update()):this}getFeatureState(_){return this._isValidId(_.source)?this.style.getFeatureState(_):null}_updateContainerDimensions(){if(!this._container)return;const _=this._container.getBoundingClientRect().width||400,c=this._container.getBoundingClientRect().height||300;let f,v,w,E=this._container;for(;E&&(!v||!w);){const S=window.getComputedStyle(E).transform;S&&"none"!==S&&(f=S.match(/matrix.*\((.+)\)/)[1].split(", "),f[0]&&"0"!==f[0]&&"1"!==f[0]&&(v=f[0]),f[3]&&"0"!==f[3]&&"1"!==f[3]&&(w=f[3])),E=E.parentElement}this._containerWidth=v?Math.abs(_/v):_,this._containerHeight=w?Math.abs(c/w):c}_detectMissingCSS(){"rgb(250, 128, 114)"!==window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&h.X("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const _=this._container;_.classList.add("mapboxgl-map"),(this._missingCSSCanary=Ye("div","mapboxgl-canary",_)).style.visibility="hidden",this._detectMissingCSS();const c=this._canvasContainer=Ye("div","mapboxgl-canvas-container",_);this._canvas=Ye("canvas","mapboxgl-canvas",c),this._interactive&&(c.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const f=this._controlContainer=Ye("div","mapboxgl-control-container",_),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{v[w]=Ye("div",`mapboxgl-ctrl-${w}`,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,c){const f=h.a4.devicePixelRatio||1;this._canvas.width=f*Math.ceil(_),this._canvas.height=f*Math.ceil(c),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${c}px`}_addMarker(_){this._markers.push(_)}_removeMarker(_){const c=this._markers.indexOf(_);-1!==c&&this._markers.splice(c,1)}_addPopup(_){this._popups.push(_)}_removePopup(_){const c=this._popups.indexOf(_);-1!==c&&this._popups.splice(c,1)}_setupPainter(){const _=h.ak({},Xe.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._canvas.getContext("webgl2",_);c?(h.cT(c,!0),this.painter=new Es(c,this._contextCreateOptions,this.transform,this._tp),this.on("data",f=>{"source"===f.dataType&&this.painter.setTileLoadedFlag(!0)}),h.cU.testSupport(c)):this.fire(new h.a7(new Error("Failed to initialize WebGL")))}_contextLost(_){_.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new h.a8("webglcontextlost",{originalEvent:_}))}_contextRestored(_){this._setupPainter(),this.resize(),this._update(),this.fire(new h.a8("webglcontextrestored",{originalEvent:_}))}_onMapScroll(_){if(_.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_requestDomTask(_){!this.loaded()||this.loaded()&&!this.isMoving()?_():this._domRenderTaskQueue.add(_)}_render(_){let c;this.fire(new h.a8("renderstart"));const f=this.painter.context.extTimerQuery,v=h.a4.now(),w=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(c=w.createQuery(),w.beginQuery(f.TIME_ELAPSED_EXT,c)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(_),this._domRenderTaskQueue.run(_),this._removed)return;this._updateProjectionTransition();const E=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,N=this.transform.pitch,V=h.a4.now(),H=new h.al(O,{now:V,fadeDuration:E,pitch:N,transition:this.style.transition});this.style.update(H)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let S=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),S=this._updateAverageElevation(v),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):S=this._updateAverageElevation(v),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,E,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries||this._debugParams.showTileBoundaries,wireframe:{terrain:this.showTerrainWireframe||this._debugParams.showTerrainWireframe,layers2D:this.showLayers2DWireframe||this._debugParams.showLayers2DWireframe,layers3D:this.showLayers3DWireframe||this._debugParams.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector||this._debugParams.showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new h.a8("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new h.a8("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),c){const O=h.a4.now()-v;w.endQuery(f.TIME_ELAPSED_EXT),setTimeout(()=>{const N=w.getQueryParameter(c,w.QUERY_RESULT)/1e6;w.deleteQuery(c),this.fire(new h.a8("gpu-timing-frame",{cpuTime:O,gpuTime:N}))},50)}if(this.listens("gpu-timing-layer")){const O=this.painter.collectGpuTimers();setTimeout(()=>{const N=this.painter.queryGpuTimers(O);this.fire(new h.a8("gpu-timing-layer",{layerTimes:N}))},50)}if(this.listens("gpu-timing-deferred-render")){const O=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const N=this.painter.queryGpuTimeDeferredRender(O);this.fire(new h.a8("gpu-timing-deferred-render",{gpuTime:N}))},50)}const I=this._sourcesDirty||this._styleDirty||this._placementDirty||S;if(I||this._repaint)this.triggerRepaint();else{const O=!this.isMoving()&&this.loaded();if(O&&(S=this._updateAverageElevation(v,!0)),S)this.triggerRepaint();else if(this._triggerFrame(!1),O&&(this.fire(new h.a8("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const N=this._calculateSpeedIndex();this.fire(new h.a8("speedindexcompleted",{speedIndex:N})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||I||(this._fullyLoaded=!0,this._performanceMetricsCollection&&h.cV(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(_){for(const c of this._markers)_&&!this.getRenderWorldCopies()&&(c._lngLat=c._lngLat.wrap()),c._update();for(const c of this._popups)!_||this.getRenderWorldCopies()||c._trackPointer||(c._lngLat=c._lngLat.wrap()),c._update()}_updateAverageElevation(_,c=!1){const f=w=>(this.transform.averageElevation=w,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&f(0);const v=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(v||(c||_-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(_)){const w=this.transform.averageElevation;let E=this.transform.sampleAverageElevation();this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(E)?E=0:this._averageElevationLastSampledAt=_;const S=Math.abs(w-E);if(S>1){if(this._isInitialLoad||v)return this._averageElevation.jumpTo(E),f(E);this._averageElevation.easeTo(E,_,300)}else if(S>1e-4)return this._averageElevation.jumpTo(E),f(E)}return!!this._averageElevation.isEasing(_)&&f(this._averageElevation.getValue(_))}_authenticate(){h.cW(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,_=>{if(_&&(_.message===h.cX||401===_.status)){const c=this.painter.context.gl;h.cT(c,!1),this._logoControl instanceof Pd&&this._logoControl._updateLogo(),c&&c.clear(c.DEPTH_BUFFER_BIT|c.COLOR_BUFFER_BIT|c.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new h.a7(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),h.cY(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const _=this._isDragging();this.painter.updateTerrain(this.style,_)}_calculateSpeedIndex(){const _=this.painter.canvasCopy(),c=this.painter.getCanvasCopiesAndTimestamps();c.timeStamps.push(performance.now());const f=this.painter.context.gl,v=f.createFramebuffer();function w(E){f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,E,0);const S=new Uint8Array(f.drawingBufferWidth*f.drawingBufferHeight*4);return f.readPixels(0,0,f.drawingBufferWidth,f.drawingBufferHeight,f.RGBA,f.UNSIGNED_BYTE,S),S}return f.bindFramebuffer(f.FRAMEBUFFER,v),this._canvasPixelComparison(w(_),c.canvasCopies.map(w),c.timeStamps)}_canvasPixelComparison(_,c,f){let v=f[1]-f[0];const w=_.length/4;for(let E=0;E<c.length;E++){const S=c[E];let I=0;for(let O=0;O<S.length;O+=4)S[O]===_[O]&&S[O+1]===_[O+1]&&S[O+2]===_[O+2]&&S[O+3]===_[O+3]&&(I+=1);v+=(f[E+2]-f[E+1])*(1-I/w)}return v}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const _=this.painter.context.gl.getExtension("WEBGL_lose_context");_&&_.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),h.cZ(this.painter.context.gl),this._removed=!0,this.fire(new h.a8("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(_){this._renderNextFrame=this._renderNextFrame||_,this.style&&!this._frame&&(this._frame=h.a4.frame(c=>{const f=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,f&&this._render(c)}))}_preloadTiles(_){const c=this.style?Object.values(this.style._sourceCaches):[];return h.c_(c,(f,v)=>f._preloadTiles(_,v),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(_){this._trackResize&&this.resize({originalEvent:_})._update()}_onVisibilityChange(){"hidden"===document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(_){this._showTerrainWireframe!==_&&(this._showTerrainWireframe=_,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(_){this._showLayers2DWireframe!==_&&(this._showLayers2DWireframe=_,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(_){this._showLayers3DWireframe!==_&&(this._showLayers3DWireframe=_,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(_){this._speedIndexTiming!==_&&(this._speedIndexTiming=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(_){this._showTileAABBs!==_&&(this._showTileAABBs=_,_&&this._update())}_setCacheLimits(_,c){h.d0(_,c)}get version(){return h.c$}},NavigationControl:class{constructor(_){this.options=h.ak({},Uv,_),this._container=Ye("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(h.aR(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",c=>{this._map&&this._map.zoomIn({},{originalEvent:c})}),Ye("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",c=>{this._map&&this._map.zoomOut({},{originalEvent:c})}),Ye("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(h.aR(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",c=>{const f=this._map;f&&(this.options.visualizePitch?f.resetNorthPitch({},{originalEvent:c}):f.resetNorth({},{originalEvent:c}))}),this._compassIcon=Ye("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const _=this._map;if(!_)return;const c=_.getZoom(),f=c===_.getMaxZoom(),v=c===_.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=v,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",v.toString())}_rotateCompassArrow(){const _=this._map;if(!_)return;const c=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(_.transform.pitch*(Math.PI/180)),.5)}) rotateX(${_.transform.pitch}deg) rotateZ(${_.transform.angle*(180/Math.PI)}deg)`:`rotate(${_.transform.angle*(180/Math.PI)}deg)`;_._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=c)})}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),_.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&_.on("pitch",this._rotateCompassArrow),_.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Gc(_,this._compass,this.options.visualizePitch)),this._container}onRemove(){const _=this._map;_&&(this._container.remove(),this.options.showZoom&&_.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&_.off("pitch",this._rotateCompassArrow),_.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(_,c){const f=Ye("button",_,this._container);return f.type="button",f.addEventListener("click",c),f}_setButtonTitle(_,c){if(!this._map)return;const f=this._map._getUIString(`NavigationControl.${c}`);_.setAttribute("aria-label",f),_.firstElementChild&&_.firstElementChild.setAttribute("title",f)}},GeolocateControl:class extends h.a6{constructor(_){super();const c=navigator.geolocation;this.options=h.ak({geolocation:c},Il,_),h.aR(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=_t(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(_){return this._map=_,this._container=Ye("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(_){const c=(f=!!this.options.geolocation)=>{this._supportsGeolocation=f,_(f)};void 0!==this._supportsGeolocation?_(this._supportsGeolocation):void 0!==navigator.permissions?navigator.permissions.query({name:"geolocation"}).then(f=>c("denied"!==f.state)).catch(()=>c()):c()}_isOutOfMapMaxBounds(_){const c=this._map.getMaxBounds(),f=_.coords;return!!c&&(f.longitude<c.getWest()||f.longitude>c.getEast()||f.latitude<c.getSouth()||f.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(_){if(this._map){if(this._isOutOfMapMaxBounds(_))return this._setErrorState(),this.fire(new h.a8("outofmaxbounds",_)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=_,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(_),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(_),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new h.a8("geolocate",_)),this._finish()}}_updateCamera(_){const c=new h.L(_.coords.longitude,_.coords.latitude),f=_.coords.accuracy,v=this._map.getBearing(),w=h.ak({bearing:v},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(f),w,{geolocateSource:!0})}_updateMarker(_){if(_){const c=new h.L(_.coords.longitude,_.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=_.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const _=this._map.transform,c=h.b(1,_._center.lat)*_.worldSize,f=Math.ceil(2*this._accuracy*c);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(_){if(this._map){if(this.options.trackUserLocation)if(1===_.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===_.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new h.a8("error",_)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(_){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=Ye("button","mapboxgl-ctrl-geolocate",this._container),Ye("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===_){h.X("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Ye("div","mapboxgl-user-location"),this._dotElement.appendChild(Ye("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Ye("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new fo({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Ye("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new fo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||"ACTIVE_LOCK"!==this._watchState||c.originalEvent&&"resize"===c.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new h.a8("trackuserlocationend")))})}}_onDeviceOrientation(_){this._userLocationDotMarker&&(_.webkitCompassHeading?this._heading=_.webkitCompassHeading:!0===_.absolute&&(this._heading=-1*_.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return h.X("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.a8("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new h.a8("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.a8("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let _;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(_={maximumAge:6e5,timeout:0},this._noTimeout=!0):(_=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,_),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const _=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&"function"==typeof DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(c=>{"granted"===c&&_()}).catch(console.error):_()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Hh,ScaleControl:class{constructor(_){this.options=h.ak({},Lu,_),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),h.aR(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const _=this.options.maxWidth||100,c=this._map,f=c._containerHeight/2,v=c._containerWidth/2-_/2,w=c.unproject([v,f]),E=c.unproject([v+_,f]),S=w.distanceTo(E);if("imperial"===this.options.unit){const I=3.2808*S;I>5280?this._setScale(_,I/5280,"mile"):this._setScale(_,I,"foot")}else"nautical"===this.options.unit?this._setScale(_,S/1852,"nautical-mile"):S>=1e3?this._setScale(_,S/1e3,"kilometer"):this._setScale(_,S,"meter")}_setScale(_,c,f){this._map._requestDomTask(()=>{const v=function(E){const S=Math.pow(10,`${Math.floor(E)}`.length-1);let I=E/S;return I=I>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:function(O){const N=Math.pow(10,Math.ceil(-Math.log(O)/Math.LN10));return Math.round(O*N)/N}(I),S*I}(c),w=v/c;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==f?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:f}).format(v):`${v}&nbsp;${up[f]}`,this._container.style.width=_*w+"px"})}onAdd(_){return this._map=_,this._language=_.getLanguage(),this._container=Ye("div","mapboxgl-ctrl mapboxgl-ctrl-scale",_.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(_){this._language=_,this._update()}setUnit(_){this.options.unit=_,this._update()}},FullscreenControl:class{constructor(_){this._fullscreen=!1,_&&_.container&&(_.container instanceof HTMLElement?this._container=_.container:h.X("Full screen control 'container' must be a DOM element.")),h.aR(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=Ye("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",h.X("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const _=this._fullscreenButton=Ye("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Ye("span","mapboxgl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",_)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends h.a6{constructor(_){super(),this.options=h.ak(Object.create(Vv),_),h.aR(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(_&&_.className?_.className.trim().split(/\s+/):[])}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&_.on("preclick",this._onClose),this.options.closeOnMove&&_.on("move",this._onClose),_.on("remove",this.remove),this._update(),_._addPopup(this),this._focusFirstElement(),this._trackPointer?(_.on("mousemove",this._onMouseEvent),_.on("mouseup",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")):_.on("move",this._update),this.fire(new h.a8("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const _=this._map;return _&&(_.off("move",this._update),_.off("move",this._onClose),_.off("preclick",this._onClose),_.off("click",this._onClose),_.off("remove",this.remove),_.off("mousemove",this._onMouseEvent),_.off("mouseup",this._onMouseEvent),_.off("drag",this._onMouseEvent),_._canvasContainer&&_._canvasContainer.classList.remove("mapboxgl-track-pointer"),_._removePopup(this),this._map=void 0),this.fire(new h.a8("close")),this}getLngLat(){return this._lngLat}setLngLat(_){this._lngLat=h.L.convert(_),this._pos=null,this._trackPointer=!1,this._update();const c=this._map;return c&&(c.on("move",this._update),c.off("mousemove",this._onMouseEvent),c._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const _=this._map;return _&&(_.off("move",this._update),_.on("mousemove",this._onMouseEvent),_.on("drag",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(document.createTextNode(_))}setHTML(_){const c=document.createDocumentFragment(),f=document.createElement("body");let v;for(f.innerHTML=_;v=f.firstChild,v;)c.appendChild(v);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){let c=this._content;if(c)for(;c.hasChildNodes();)c.firstChild&&c.removeChild(c.firstChild);else c=this._content=Ye("div","mapboxgl-popup-content",this._container||void 0);if(c.appendChild(_),this.options.closeButton){const f=this._closeButton=Ye("button","mapboxgl-popup-close-button",c);f.type="button",f.setAttribute("aria-label","Close popup"),f.setAttribute("aria-hidden","true"),f.innerHTML="&#215;",f.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(_){return this._classList.add(_),this._updateClassList(),this}removeClassName(_){return this._classList.delete(_),this._updateClassList(),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){let c;return this._classList.delete(_)?c=!1:(this._classList.add(_),c=!0),this._updateClassList(),c}_onMouseEvent(_){this._update(_.point)}_getAnchor(_){if(this.options.anchor)return this.options.anchor;const c=this._map,f=this._container,v=this._pos;if(!c||!f||!v)return"bottom";const w=f.offsetWidth,E=f.offsetHeight,S=v.x<w/2,I=v.x>c.transform.width-w/2;if(v.y+_<E)return S?"top-left":I?"top-right":"top";if(v.y>c.transform.height-E){if(S)return"bottom-left";if(I)return"bottom-right"}return S?"left":I?"right":"bottom"}_updateClassList(){const _=this._container;if(!_)return;const c=[...this._classList];c.push("mapboxgl-popup"),this._anchor&&c.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&c.push("mapboxgl-popup-track-pointer"),_.className=c.join(" ")}_update(_){const c=this._map,f=this._content;if(!c||!this._lngLat&&!this._trackPointer||!f)return;let v=this._container;if(v||(v=this._container=Ye("div","mapboxgl-popup",c.getContainer()),this._tip=Ye("div","mapboxgl-popup-tip",v),v.appendChild(f)),this.options.maxWidth&&v.style.maxWidth!==this.options.maxWidth&&(v.style.maxWidth=this.options.maxWidth),c.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=P_(this._lngLat,this._pos,c.transform)),!this._trackPointer||_){const w=this._pos=this._trackPointer&&_?_:c.project(this._lngLat),E=O_(this.options.offset),S=this._anchor=this._getAnchor(E.y),I=O_(this.options.offset,S),O=w.add(I).round();c._requestDomTask(()=>{this._container&&S&&(this._container.style.transform=`${$h[S]} translate(${O.x}px,${O.y}px)`)})}if(!this._marker&&c._showingGlobe()){const w=h.cN(c.transform,this._lngLat)?0:1;this._setOpacity(w)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(cp);_&&_.focus()}_onClose(){this.remove()}_setOpacity(_){this._container&&(this._container.style.opacity=`${_}`),this._content&&(this._content.style.pointerEvents=_?"auto":"none")}},Marker:fo,Style:Ae,LngLat:h.L,LngLatBounds:h.D,Point:h.P,MercatorCoordinate:h.M,FreeCameraOptions:qr,Evented:h.a6,config:h.cM,prewarm:h.d3,clearPrewarmedResources:h.d4,get accessToken(){return h.cM.ACCESS_TOKEN},set accessToken(_){h.cM.ACCESS_TOKEN=_},get baseApiUrl(){return h.cM.API_URL},set baseApiUrl(_){h.cM.API_URL=_},get workerCount(){return h.d5.workerCount},set workerCount(_){h.d5.workerCount=_},get maxParallelImageRequests(){return h.cM.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(_){h.cM.MAX_PARALLEL_IMAGE_REQUESTS=_},clearStorage(_){h.d6(_)},get workerUrl(){return h.d7.workerUrl},set workerUrl(_){h.d7.workerUrl=_},get workerClass(){return h.d7.workerClass},set workerClass(_){h.d7.workerClass=_},get workerParams(){return h.d7.workerParams},set workerParams(_){h.d7.workerParams=_},get dracoUrl(){return h.d8()},set dracoUrl(_){h.d9(_)},setNow:h.a4.setNow,restoreNow:h.a4.restoreNow}}),ht}()},681:function(bn){var ht;ht=function(){var fn="",Je=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function ht(Xe){return Xe.match(Je)||[]}function We(Xe){return{language:(Xe=ht(Xe))[1]||fn,extlang:Xe[2]||fn,script:Xe[3]||fn,region:Xe[4]||fn}}function h(Xe,Oe,tt){Object.defineProperty(Xe,Oe,{value:tt,enumerable:!0})}function me(Xe,Oe,tt){function Ye(Vt){return ht(Vt)[Xe]||fn}h(Ye,"pattern",Oe),h(We,tt,Ye)}return me(1,/^[a-zA-Z]{2,3}$/,"language"),me(2,/^[a-zA-Z]{3}$/,"extlang"),me(3,/^[a-zA-Z]{4}$/,"script"),me(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),h(We,"split",function gt(Xe){return ht(Xe).filter(function(Oe,tt){return Oe&&tt})}),We},bn.exports?bn.exports=ht():this.subtag=ht()},28:(bn,fn,Je)=>{"use strict";var ht=Je(603);bn.exports=ht,typeof window<"u"&&(window.Suggestions=ht)},331:bn=>{"use strict";var fn=function(Je){return this.component=Je,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,Je.el.parentNode.insertBefore(this.wrapper,Je.el.nextSibling),this};fn.prototype.show=function(){this.element.style.display="block"},fn.prototype.hide=function(){this.element.style.display="none"},fn.prototype.add=function(Je){this.items.push(Je)},fn.prototype.clear=function(){this.items=[],this.active=0},fn.prototype.isEmpty=function(){return!this.items.length},fn.prototype.isVisible=function(){return"block"===this.element.style.display},fn.prototype.draw=function(){if(this.element.innerHTML="",0!==this.items.length){for(var Je=0;Je<this.items.length;Je++)this.drawItem(this.items[Je],this.active===Je);this.show()}else this.hide()},fn.prototype.drawItem=function(Je,ht){var gt=document.createElement("li"),We=document.createElement("a");ht&&(gt.className+=" active"),We.innerHTML=Je.string,gt.appendChild(We),this.element.appendChild(gt),gt.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),gt.addEventListener("mouseup",function(){this.handleMouseUp.call(this,Je)}.bind(this))},fn.prototype.handleMouseUp=function(Je){this.selectingListItem=!1,this.component.value(Je.original),this.clear(),this.draw()},fn.prototype.move=function(Je){this.active=Je,this.draw()},fn.prototype.previous=function(){this.move(0===this.active?this.items.length-1:this.active-1)},fn.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},fn.prototype.drawError=function(Je){var ht=document.createElement("li");ht.innerHTML=Je,this.element.appendChild(ht),this.show()},bn.exports=fn},603:(bn,fn,Je)=>{"use strict";var ht=Je(498),gt=Je(424),We=Je(331),h=function(me,Xe,Oe){return this.options=ht({minLength:2,limit:5,filter:!0,hideOnBlur:!0},Oe=Oe||{}),this.el=me,this.data=Xe||[],this.list=new We(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(tt){this.handleKeyUp(tt.keyCode)}.bind(this),!1),this.el.addEventListener("keydown",function(tt){this.handleKeyDown(tt)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this.el.addEventListener("paste",function(tt){this.handlePaste(tt)}.bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};h.prototype.handleKeyUp=function(me){40===me||38===me||27===me||13===me||9===me||this.handleInputChange(this.el.value)},h.prototype.handleKeyDown=function(me){switch(me.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&me.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},h.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},h.prototype.handlePaste=function(me){if(me.clipboardData)this.handleInputChange(me.clipboardData.getData("Text"));else{var Xe=this;setTimeout(function(){Xe.handleInputChange(me.target.value)},100)}},h.prototype.handleInputChange=function(me){this.query=this.normalize(me),this.list.clear(),this.query.length<this.options.minLength?this.list.draw():this.getCandidates(function(Xe){for(var Oe=0;Oe<Xe.length&&(this.list.add(Xe[Oe]),Oe!==this.options.limit-1);Oe++);this.list.draw()}.bind(this))},h.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},h.prototype.update=function(me){this.data=me,this.handleKeyUp()},h.prototype.clear=function(){this.data=[],this.list.clear()},h.prototype.normalize=function(me){return me.toLowerCase()},h.prototype.match=function(me,Xe){return me.indexOf(Xe)>-1},h.prototype.value=function(me){if(this.selected=me,this.el.value=this.getItemValue(me),document.createEvent){var Xe=document.createEvent("HTMLEvents");Xe.initEvent("change",!0,!1),this.el.dispatchEvent(Xe)}else this.el.fireEvent("onchange")},h.prototype.getCandidates=function(me){var Xe={pre:"<strong>",post:"</strong>",extract:function(tt){return this.getItemValue(tt)}.bind(this)};me(this.options.filter?gt.filter(this.query,this.data,Xe).map(function(tt){return{original:tt.original,string:this.render(tt.original,tt.string)}}.bind(this)):this.data.map(function(tt){return{original:tt,string:this.render(tt)}}.bind(this)))},h.prototype.getItemValue=function(me){return me},h.prototype.render=function(me,Xe){if(Xe)return Xe;for(var Oe=this.getItemValue(me.original?me.original:me),tt=this.normalize(Oe),Ye=tt.lastIndexOf(this.query);Ye>-1;){var Vt=Ye+this.query.length;Oe=Oe.slice(0,Ye)+"<strong>"+Oe.slice(Ye,Vt)+"</strong>"+Oe.slice(Vt),Ye=tt.slice(0,Ye).lastIndexOf(this.query)}return Oe},h.prototype.renderError=function(me){this.list.drawError(me)},bn.exports=h},519:function(bn){bn.exports=function(){"use strict";function fn(Q,L,U){return L=Vt(L),function vn(Q,L){if(L&&("object"==typeof L||"function"==typeof L))return L;if(void 0!==L)throw new TypeError("Derived constructors may only return object or undefined");return function pn(Q){if(void 0===Q)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Q}(Q)}(Q,ht()?Reflect.construct(L,U||[],Vt(Q).constructor):L.apply(Q,U))}function ht(){try{var Q=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ht=function(){return!!Q})()}function h(Q){var L=function We(Q,L){if("object"!=typeof Q||!Q)return Q;var U=Q[Symbol.toPrimitive];if(void 0!==U){var X=U.call(Q,L||"default");if("object"!=typeof X)return X;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===L?String:Number)(Q)}(Q,"string");return"symbol"==typeof L?L:String(L)}function me(Q){return(me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(L){return typeof L}:function(L){return L&&"function"==typeof Symbol&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L})(Q)}function Xe(Q,L){if(!(Q instanceof L))throw new TypeError("Cannot call a class as a function")}function Oe(Q,L){for(var U=0;U<L.length;U++){var X=L[U];X.enumerable=X.enumerable||!1,X.configurable=!0,"value"in X&&(X.writable=!0),Object.defineProperty(Q,h(X.key),X)}}function tt(Q,L,U){return L&&Oe(Q.prototype,L),U&&Oe(Q,U),Object.defineProperty(Q,"prototype",{writable:!1}),Q}function Vt(Q){return(Vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(U){return U.__proto__||Object.getPrototypeOf(U)})(Q)}function Fn(Q,L){return(Fn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(X,Ae){return X.__proto__=Ae,X})(Q,L)}function Yt(){return Yt=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(L,U,X){var Ae=function en(Q,L){for(;!Object.prototype.hasOwnProperty.call(Q,L)&&null!==(Q=Vt(Q)););return Q}(L,U);if(Ae){var _t=Object.getOwnPropertyDescriptor(Ae,U);return _t.get?_t.get.call(arguments.length<3?L:X):_t.value}},Yt.apply(this,arguments)}function De(Q,L){return function nt(Q){if(Array.isArray(Q))return Q}(Q)||function gt(Q,L){var U=null==Q?null:typeof Symbol<"u"&&Q[Symbol.iterator]||Q["@@iterator"];if(null!=U){var X,Ae,_t,yn,fi=[],pi=!0,Cr=!1;try{if(_t=(U=U.call(Q)).next,0===L){if(Object(U)!==U)return;pi=!1}else for(;!(pi=(X=_t.call(U)).done)&&(fi.push(X.value),fi.length!==L);pi=!0);}catch(Lo){Cr=!0,Ae=Lo}finally{try{if(!pi&&null!=U.return&&(yn=U.return(),Object(yn)!==yn))return}finally{if(Cr)throw Ae}}return fi}}(Q,L)||Ct(Q,L)||function xn(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(Q){return function qt(Q){if(Array.isArray(Q))return Le(Q)}(Q)||function Ge(Q){if(typeof Symbol<"u"&&null!=Q[Symbol.iterator]||null!=Q["@@iterator"])return Array.from(Q)}(Q)||Ct(Q)||function Qt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ct(Q,L){if(Q){if("string"==typeof Q)return Le(Q,L);var U=Object.prototype.toString.call(Q).slice(8,-1);if("Object"===U&&Q.constructor&&(U=Q.constructor.name),"Map"===U||"Set"===U)return Array.from(Q);if("Arguments"===U||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(U))return Le(Q,L)}}function Le(Q,L){(null==L||L>Q.length)&&(L=Q.length);for(var U=0,X=new Array(L);U<L;U++)X[U]=Q[U];return X}function Et(Q,L){return function To(Q,L){return L.get?L.get.call(Q):L.value}(Q,mr(Q,L,"get"))}function Si(Q,L,U){return function Uo(Q,L,U){if(L.set)L.set.call(Q,U);else{if(!L.writable)throw new TypeError("attempted to set read only private field");L.value=U}}(Q,mr(Q,L,"set"),U),U}function mr(Q,L,U){if(!L.has(Q))throw new TypeError("attempted to "+U+" private field on non-instance");return L.get(Q)}function Hn(Q,L,U){(function ts(Q,L){if(L.has(Q))throw new TypeError("Cannot initialize the same private elements twice on an object")})(Q,L),L.set(Q,U)}var wn={},Va=function(L){return new Promise(function(U){if(!L)return U();var X=window.scrollX,Ae=window.scrollY;wn.restoreFocusTimeout=setTimeout(function(){wn.previousActiveElement instanceof HTMLElement?(wn.previousActiveElement.focus(),wn.previousActiveElement=null):document.body&&document.body.focus(),U()},100),window.scrollTo(X,Ae)})},qe=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","default-outline","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error"].reduce(function(Q,L){return Q[L]="swal2-"+L,Q},{}),ys=["success","warning","info","question","error"].reduce(function(Q,L){return Q[L]="swal2-"+L,Q},{}),ur="SweetAlert2:",ai=function(L){return L.charAt(0).toUpperCase()+L.slice(1)},gr=function(L){console.warn("".concat(ur," ").concat("object"===me(L)?L.join(" "):L))},ii=function(L){console.error("".concat(ur," ").concat(L))},da=[],Pc=function(L,U){!function(L){da.includes(L)||(da.push(L),gr(L))}('"'.concat(L,'" is deprecated and will be removed in the next major release. Please use "').concat(U,'" instead.'))},ar=function(L){return"function"==typeof L?L():L},Ot=function(L){return L&&"function"==typeof L.toPromise},ge=function(L){return Ot(L)?L.toPromise():Promise.resolve(L)},ve=function(L){return L&&Promise.resolve(L)===L},Re=function(){return document.body.querySelector(".".concat(qe.container))},St=function(L){var U=Re();return U?U.querySelector(L):null},bt=function(L){return St(".".concat(L))},Lt=function(){return bt(qe.popup)},cn=function(){return bt(qe.icon)},En=function(){return bt(qe.title)},zn=function(){return bt(qe["html-container"])},Vn=function(){return bt(qe.image)},$i=function(){return bt(qe["progress-steps"])},or=function(){return bt(qe["validation-message"])},lr=function(){return St(".".concat(qe.actions," .").concat(qe.confirm))},Yi=function(){return St(".".concat(qe.actions," .").concat(qe.cancel))},Mi=function(){return St(".".concat(qe.actions," .").concat(qe.deny))},zr=function(){return St(".".concat(qe.loader))},qr=function(){return bt(qe.actions)},vs=function(){return bt(qe.footer)},So=function(){return bt(qe["timer-progress-bar"])},Ws=function(){return bt(qe.close)},Zs=function(){var L=Lt();if(!L)return[];var U=L.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),X=Array.from(U).sort(function(yn,fi){var pi=parseInt(yn.getAttribute("tabindex")||"0"),Cr=parseInt(fi.getAttribute("tabindex")||"0");return pi>Cr?1:pi<Cr?-1:0}),Ae=L.querySelectorAll('\n  a[href],\n  area[href],\n  input:not([disabled]),\n  select:not([disabled]),\n  textarea:not([disabled]),\n  button:not([disabled]),\n  iframe,\n  object,\n  embed,\n  [tabindex="0"],\n  [contenteditable],\n  audio[controls],\n  video[controls],\n  summary\n'),_t=Array.from(Ae).filter(function(yn){return"-1"!==yn.getAttribute("tabindex")});return ct(new Set(X.concat(_t))).filter(function(yn){return dr(yn)})},ha=function(){return Dt(document.body,qe.shown)&&!Dt(document.body,qe["toast-shown"])&&!Dt(document.body,qe["no-backdrop"])},co=function(){var L=Lt();return!!L&&Dt(L,qe.toast)},rt=function(L,U){if(L.textContent="",U){var Ae=(new DOMParser).parseFromString(U,"text/html"),_t=Ae.querySelector("head");_t&&Array.from(_t.childNodes).forEach(function(fi){L.appendChild(fi)});var yn=Ae.querySelector("body");yn&&Array.from(yn.childNodes).forEach(function(fi){fi instanceof HTMLVideoElement||fi instanceof HTMLAudioElement?L.appendChild(fi.cloneNode(!0)):L.appendChild(fi)})}},Dt=function(L,U){if(!U)return!1;for(var X=U.split(/\s+/),Ae=0;Ae<X.length;Ae++)if(!L.classList.contains(X[Ae]))return!1;return!0},Mt=function(L,U,X){if(function(L,U){Array.from(L.classList).forEach(function(X){!Object.values(qe).includes(X)&&!Object.values(ys).includes(X)&&!Object.values(U.showClass||{}).includes(X)&&L.classList.remove(X)})}(L,U),U.customClass&&U.customClass[X]){if("string"!=typeof U.customClass[X]&&!U.customClass[X].forEach)return void gr("Invalid type of customClass.".concat(X,'! Expected string or iterable object, got "').concat(me(U.customClass[X]),'"'));Ft(L,U.customClass[X])}},Wt=function(L,U){if(!U)return null;switch(U){case"select":case"textarea":case"file":return L.querySelector(".".concat(qe.popup," > .").concat(qe[U]));case"checkbox":return L.querySelector(".".concat(qe.popup," > .").concat(qe.checkbox," input"));case"radio":return L.querySelector(".".concat(qe.popup," > .").concat(qe.radio," input:checked"))||L.querySelector(".".concat(qe.popup," > .").concat(qe.radio," input:first-child"));case"range":return L.querySelector(".".concat(qe.popup," > .").concat(qe.range," input"));default:return L.querySelector(".".concat(qe.popup," > .").concat(qe.input))}},Zt=function(L){if(L.focus(),"file"!==L.type){var U=L.value;L.value="",L.value=U}},jt=function(L,U,X){!L||!U||("string"==typeof U&&(U=U.split(/\s+/).filter(Boolean)),U.forEach(function(Ae){Array.isArray(L)?L.forEach(function(_t){X?_t.classList.add(Ae):_t.classList.remove(Ae)}):X?L.classList.add(Ae):L.classList.remove(Ae)}))},Ft=function(L,U){jt(L,U,!0)},Rt=function(L,U){jt(L,U,!1)},Un=function(L,U){for(var X=Array.from(L.children),Ae=0;Ae<X.length;Ae++){var _t=X[Ae];if(_t instanceof HTMLElement&&Dt(_t,U))return _t}},xi=function(L,U,X){X==="".concat(parseInt(X))&&(X=parseInt(X)),X||0===parseInt(X)?L.style.setProperty(U,"number"==typeof X?"".concat(X,"px"):X):L.style.removeProperty(U)},tn=function(L){L&&(L.style.display=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flex")},ni=function(L){L&&(L.style.display="none")},Ai=function(L){var U=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"block";L&&new MutationObserver(function(){xr(L,L.innerHTML,U)}).observe(L,{childList:!0,subtree:!0})},Ir=function(L,U,X,Ae){var _t=L.querySelector(U);_t&&_t.style.setProperty(X,Ae)},xr=function(L,U){U?tn(L,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"flex"):ni(L)},dr=function(L){return!(!L||!(L.offsetWidth||L.offsetHeight||L.getClientRects().length))},ls=function(L){return L.scrollHeight>L.clientHeight},cs=function(L){var U=window.getComputedStyle(L),X=parseFloat(U.getPropertyValue("animation-duration")||"0"),Ae=parseFloat(U.getPropertyValue("transition-duration")||"0");return X>0||Ae>0},Co=function(L){var U=arguments.length>1&&void 0!==arguments[1]&&arguments[1],X=So();X&&dr(X)&&(U&&(X.style.transition="none",X.style.width="100%"),setTimeout(function(){X.style.transition="width ".concat(L/1e3,"s linear"),X.style.width="0%"},10))},fa=function(){return typeof window>"u"||typeof document>"u"},Wr='\n <div aria-labelledby="'.concat(qe.title,'" aria-describedby="').concat(qe["html-container"],'" class="').concat(qe.popup,'" tabindex="-1">\n   <button type="button" class="').concat(qe.close,'"></button>\n   <ul class="').concat(qe["progress-steps"],'"></ul>\n   <div class="').concat(qe.icon,'"></div>\n   <img class="').concat(qe.image,'" />\n   <h2 class="').concat(qe.title,'" id="').concat(qe.title,'"></h2>\n   <div class="').concat(qe["html-container"],'" id="').concat(qe["html-container"],'"></div>\n   <input class="').concat(qe.input,'" id="').concat(qe.input,'" />\n   <input type="file" class="').concat(qe.file,'" />\n   <div class="').concat(qe.range,'">\n     <input type="range" />\n     <output></output>\n   </div>\n   <select class="').concat(qe.select,'" id="').concat(qe.select,'"></select>\n   <div class="').concat(qe.radio,'"></div>\n   <label class="').concat(qe.checkbox,'">\n     <input type="checkbox" id="').concat(qe.checkbox,'" />\n     <span class="').concat(qe.label,'"></span>\n   </label>\n   <textarea class="').concat(qe.textarea,'" id="').concat(qe.textarea,'"></textarea>\n   <div class="').concat(qe["validation-message"],'" id="').concat(qe["validation-message"],'"></div>\n   <div class="').concat(qe.actions,'">\n     <div class="').concat(qe.loader,'"></div>\n     <button type="button" class="').concat(qe.confirm,'"></button>\n     <button type="button" class="').concat(qe.deny,'"></button>\n     <button type="button" class="').concat(qe.cancel,'"></button>\n   </div>\n   <div class="').concat(qe.footer,'"></div>\n   <div class="').concat(qe["timer-progress-bar-container"],'">\n     <div class="').concat(qe["timer-progress-bar"],'"></div>\n   </div>\n </div>\n').replace(/(^|\n)\s*/g,""),Eo=function(){wn.currentInstance.resetValidationMessage()},yh=function(L){var U=function(){var L=Re();return!!L&&(L.remove(),Rt([document.documentElement,document.body],[qe["no-backdrop"],qe["toast-shown"],qe["has-column"]]),!0)}();if(fa())ii("SweetAlert2 requires document to initialize");else{var X=document.createElement("div");X.className=qe.container,U&&Ft(X,qe["no-transition"]),rt(X,Wr);var Ae=function(L){return"string"==typeof L?document.querySelector(L):L}(L.target);Ae.appendChild(X),function(L){var U=Lt();U.setAttribute("role",L.toast?"alert":"dialog"),U.setAttribute("aria-live",L.toast?"polite":"assertive"),L.toast||U.setAttribute("aria-modal","true")}(L),function(L){"rtl"===window.getComputedStyle(L).direction&&Ft(Re(),qe.rtl)}(Ae),function(){var L=Lt(),U=Un(L,qe.input),X=Un(L,qe.file),Ae=L.querySelector(".".concat(qe.range," input")),_t=L.querySelector(".".concat(qe.range," output")),yn=Un(L,qe.select),fi=L.querySelector(".".concat(qe.checkbox," input")),pi=Un(L,qe.textarea);U.oninput=Eo,X.onchange=Eo,yn.onchange=Eo,fi.onchange=Eo,pi.oninput=Eo,Ae.oninput=function(){Eo(),_t.value=Ae.value},Ae.onchange=function(){Eo(),_t.value=Ae.value}}()}},uo=function(L,U){L instanceof HTMLElement?U.appendChild(L):"object"===me(L)?ud(L,U):L&&rt(U,L)},ud=function(L,U){L.jquery?yl(U,L):rt(U,L.toString())},yl=function(L,U){if(L.textContent="",0 in U)for(var X=0;X in U;X++)L.appendChild(U[X].cloneNode(!0));else L.appendChild(U.cloneNode(!0))},Ao=function(){if(fa())return!1;var Q=document.createElement("div");return typeof Q.style.webkitAnimation<"u"?"webkitAnimationEnd":typeof Q.style.animation<"u"&&"animationend"}(),Xl=function(L,U){var X=qr(),Ae=zr();!X||!Ae||(U.showConfirmButton||U.showDenyButton||U.showCancelButton?tn(X):ni(X),Mt(X,U,"actions"),function pa(Q,L,U){var X=lr(),Ae=Mi(),_t=Yi();!X||!Ae||!_t||(sn(X,"confirm",U),sn(Ae,"deny",U),sn(_t,"cancel",U),function He(Q,L,U,X){X.buttonsStyling?(Ft([Q,L,U],qe.styled),X.confirmButtonColor&&(Q.style.backgroundColor=X.confirmButtonColor,Ft(Q,qe["default-outline"])),X.denyButtonColor&&(L.style.backgroundColor=X.denyButtonColor,Ft(L,qe["default-outline"])),X.cancelButtonColor&&(U.style.backgroundColor=X.cancelButtonColor,Ft(U,qe["default-outline"]))):Rt([Q,L,U],qe.styled)}(X,Ae,_t,U),U.reverseButtons&&(U.toast?(Q.insertBefore(_t,X),Q.insertBefore(Ae,X)):(Q.insertBefore(_t,L),Q.insertBefore(Ae,L),Q.insertBefore(X,L))))}(X,Ae,U),rt(Ae,U.loaderHtml||""),Mt(Ae,U,"loader"))};function sn(Q,L,U){var X=ai(L);xr(Q,U["show".concat(X,"Button")],"inline-block"),rt(Q,U["".concat(L,"ButtonText")]||""),Q.setAttribute("aria-label",U["".concat(L,"ButtonAriaLabel")]||""),Q.className=qe[L],Mt(Q,U,"".concat(L,"Button"))}var Xs=function(L,U){var X=Re();X&&(function Zr(Q,L){"string"==typeof L?Q.style.background=L:L||Ft([document.documentElement,document.body],qe["no-backdrop"])}(X,U.backdrop),function wr(Q,L){L&&(L in qe?Ft(Q,qe[L]):(gr('The "position" parameter is not valid, defaulting to "center"'),Ft(Q,qe.center)))}(X,U.position),function vh(Q,L){L&&Ft(Q,qe["grow-".concat(L)])}(X,U.grow),Mt(X,U,"container"))};var ui={innerParams:new WeakMap,domCache:new WeakMap},Gn=["input","file","range","select","radio","checkbox","textarea"],Ha=function(L){if(L.input){if(!_r[L.input])return void ii("Unexpected type of input! Expected ".concat(Object.keys(_r).join(" | "),', got "').concat(L.input,'"'));var U=jn(L.input),X=_r[L.input](U,L);tn(U),L.inputAutoFocus&&setTimeout(function(){Zt(X)})}},hi=function(L,U){var X=Wt(Lt(),L);if(X)for(var Ae in function(L){for(var U=0;U<L.attributes.length;U++){var X=L.attributes[U].name;["id","type","value","style"].includes(X)||L.removeAttribute(X)}}(X),U)X.setAttribute(Ae,U[Ae])},Di=function(L){var U=jn(L.input);"object"===me(L.customClass)&&Ft(U,L.customClass.input)},Ii=function(L,U){(!L.placeholder||U.inputPlaceholder)&&(L.placeholder=U.inputPlaceholder)},xs=function(L,U,X){if(X.inputLabel){var Ae=document.createElement("label"),_t=qe["input-label"];Ae.setAttribute("for",L.id),Ae.className=_t,"object"===me(X.customClass)&&Ft(Ae,X.customClass.inputLabel),Ae.innerText=X.inputLabel,U.insertAdjacentElement("beforebegin",Ae)}},jn=function(L){return Un(Lt(),qe[L]||qe.input)},ks=function(L,U){["string","number"].includes(me(U))?L.value="".concat(U):ve(U)||gr('Unexpected type of inputValue! Expected "string", "number" or "Promise", got "'.concat(me(U),'"'))},_r={};_r.text=_r.email=_r.password=_r.number=_r.tel=_r.url=_r.search=_r.date=_r["datetime-local"]=_r.time=_r.week=_r.month=function(Q,L){return ks(Q,L.inputValue),xs(Q,Q,L),Ii(Q,L),Q.type=L.input,Q},_r.file=function(Q,L){return xs(Q,Q,L),Ii(Q,L),Q},_r.range=function(Q,L){var U=Q.querySelector("input"),X=Q.querySelector("output");return ks(U,L.inputValue),U.type=L.input,ks(X,L.inputValue),xs(U,Q,L),Q},_r.select=function(Q,L){if(Q.textContent="",L.inputPlaceholder){var U=document.createElement("option");rt(U,L.inputPlaceholder),U.value="",U.disabled=!0,U.selected=!0,Q.appendChild(U)}return xs(Q,Q,L),Q},_r.radio=function(Q){return Q.textContent="",Q},_r.checkbox=function(Q,L){var U=Wt(Lt(),"checkbox");U.value="1",U.checked=!!L.inputValue;var X=Q.querySelector("span");return rt(X,L.inputPlaceholder),U},_r.textarea=function(Q,L){ks(Q,L.inputValue),Ii(Q,L),xs(Q,Q,L);return setTimeout(function(){if("MutationObserver"in window){var X=parseInt(window.getComputedStyle(Lt()).width);new MutationObserver(function(){if(document.body.contains(Q)){var yn=Q.offsetWidth+(Ae=Q,parseInt(window.getComputedStyle(Ae).marginLeft)+parseInt(window.getComputedStyle(Ae).marginRight));yn>X?Lt().style.width="".concat(yn,"px"):xi(Lt(),"width",L.width)}var Ae}).observe(Q,{attributes:!0,attributeFilter:["style"]})}}),Q};var Ki=function(L,U){var X=zn();X&&(Ai(X),Mt(X,U,"htmlContainer"),U.html?(uo(U.html,X),tn(X,"block")):U.text?(X.textContent=U.text,tn(X,"block")):ni(X),function(L,U){var X=Lt();if(X){var Ae=ui.innerParams.get(L),_t=!Ae||U.input!==Ae.input;Gn.forEach(function(yn){var fi=Un(X,qe[yn]);fi&&(hi(yn,U.inputAttributes),fi.className=qe[yn],_t&&ni(fi))}),U.input&&(_t&&Ha(U),Di(U))}}(L,U))},dd=function(L,U){for(var X=0,Ae=Object.entries(ys);X<Ae.length;X++){var _t=De(Ae[X],2);U.icon!==_t[0]&&Rt(L,_t[1])}Ft(L,U.icon&&ys[U.icon]),li(L,U),Fc(),Mt(L,U,"icon")},Fc=function(){var L=Lt();if(L)for(var U=window.getComputedStyle(L).getPropertyValue("background-color"),X=L.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix"),Ae=0;Ae<X.length;Ae++)X[Ae].style.backgroundColor=U},vl=function(L,U){if(U.icon||U.iconHtml){var X=L.innerHTML,Ae="";U.iconHtml?Ae=qi(U.iconHtml):"success"===U.icon?(Ae='\n  <div class="swal2-success-circular-line-left"></div>\n  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>\n  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>\n  <div class="swal2-success-circular-line-right"></div>\n',X=X.replace(/ style=".*?"/g,"")):"error"===U.icon?Ae='\n  <span class="swal2-x-mark">\n    <span class="swal2-x-mark-line-left"></span>\n    <span class="swal2-x-mark-line-right"></span>\n  </span>\n':U.icon&&(Ae=qi({question:"?",warning:"!",info:"i"}[U.icon])),X.trim()!==Ae.trim()&&rt(L,Ae)}},li=function(L,U){if(U.iconColor){L.style.color=U.iconColor,L.style.borderColor=U.iconColor;for(var X=0,Ae=[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"];X<Ae.length;X++)Ir(L,Ae[X],"background-color",U.iconColor);Ir(L,".swal2-success-ring","border-color",U.iconColor)}},qi=function(L){return'<div class="'.concat(qe["icon-content"],'">').concat(L,"</div>")},Ch=function(L,U){var X=U.showClass||{};L.className="".concat(qe.popup," ").concat(dr(L)?X.popup:""),U.toast?(Ft([document.documentElement,document.body],qe["toast-shown"]),Ft(L,qe.toast)):Ft(L,qe.modal),Mt(L,U,"popup"),"string"==typeof U.customClass&&Ft(L,U.customClass),U.icon&&Ft(L,qe["icon-".concat(U.icon)])},Pi=function(L){var U=document.createElement("li");return Ft(U,qe["progress-step"]),rt(U,L),U},jf=function(L){var U=document.createElement("li");return Ft(U,qe["progress-step-line"]),L.progressStepsDistance&&xi(U,"width",L.progressStepsDistance),U},ns=function(L,U){(function(L,U){var X=Re(),Ae=Lt();if(X&&Ae){if(U.toast){xi(X,"width",U.width),Ae.style.width="100%";var _t=zr();_t&&Ae.insertBefore(_t,cn())}else xi(Ae,"width",U.width);xi(Ae,"padding",U.padding),U.color&&(Ae.style.color=U.color),U.background&&(Ae.style.background=U.background),ni(or()),Ch(Ae,U)}})(0,U),Xs(0,U),function(L,U){var X=$i();if(X){var Ae=U.progressSteps,_t=U.currentProgressStep;if(!Ae||0===Ae.length||void 0===_t)return void ni(X);tn(X),X.textContent="",_t>=Ae.length&&gr("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),Ae.forEach(function(yn,fi){var pi=Pi(yn);if(X.appendChild(pi),fi===_t&&Ft(pi,qe["active-progress-step"]),fi!==Ae.length-1){var Cr=jf(U);X.appendChild(Cr)}})}}(0,U),function(L,U){var X=ui.innerParams.get(L),Ae=cn();if(Ae){if(X&&U.icon===X.icon)return vl(Ae,U),void dd(Ae,U);if(!U.icon&&!U.iconHtml)return void ni(Ae);if(U.icon&&-1===Object.keys(ys).indexOf(U.icon))return ii('Unknown icon! Expected "success", "error", "warning", "info" or "question", got "'.concat(U.icon,'"')),void ni(Ae);tn(Ae),vl(Ae,U),dd(Ae,U),Ft(Ae,U.showClass&&U.showClass.icon)}}(L,U),function(L,U){var X=Vn();if(X){if(!U.imageUrl)return void ni(X);tn(X,""),X.setAttribute("src",U.imageUrl),X.setAttribute("alt",U.imageAlt||""),xi(X,"width",U.imageWidth),xi(X,"height",U.imageHeight),X.className=qe.image,Mt(X,U,"image")}}(0,U),function(L,U){var X=En();X&&(Ai(X),xr(X,U.title||U.titleText,"block"),U.title&&uo(U.title,X),U.titleText&&(X.innerText=U.titleText),Mt(X,U,"title"))}(0,U),function(L,U){var X=Ws();X&&(rt(X,U.closeButtonHtml||""),Mt(X,U,"closeButton"),xr(X,U.showCloseButton),X.setAttribute("aria-label",U.closeButtonAriaLabel||""))}(0,U),Ki(L,U),Xl(0,U),function(L,U){var X=vs();X&&(Ai(X),xr(X,U.footer,"block"),U.footer&&uo(U.footer,X),Mt(X,U,"footer"))}(0,U);var X=Lt();"function"==typeof U.didRender&&X&&U.didRender(X)},Uf=function(){var L;return null===(L=lr())||void 0===L?void 0:L.click()},$a=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),fd=function(L){L.keydownTarget&&L.keydownHandlerAdded&&(L.keydownTarget.removeEventListener("keydown",L.keydownHandler,{capture:L.keydownListenerCapture}),L.keydownHandlerAdded=!1)},Or=function(L,U){var X,Ae=Zs();if(Ae.length)return(L+=U)===Ae.length?L=0:-1===L&&(L=Ae.length-1),void Ae[L].focus();null===(X=Lt())||void 0===X||X.focus()},Eh=["ArrowRight","ArrowDown"],us=["ArrowLeft","ArrowUp"],Zn=function(L,U,X){L&&(U.isComposing||229===U.keyCode||(L.stopKeydownPropagation&&U.stopPropagation(),"Enter"===U.key?pd(U,L):"Tab"===U.key?md(U):[].concat(Eh,us).includes(U.key)?ji(U.key):"Escape"===U.key&&Ut(U,L,X)))},pd=function(L,U){if(ar(U.allowEnterKey)){var X=Wt(Lt(),U.input);if(L.target&&X&&L.target instanceof HTMLElement&&L.target.outerHTML===X.outerHTML){if(["textarea","file"].includes(U.input))return;Uf(),L.preventDefault()}}},md=function(L){for(var U=L.target,X=Zs(),Ae=-1,_t=0;_t<X.length;_t++)if(U===X[_t]){Ae=_t;break}Or(Ae,L.shiftKey?-1:1),L.stopPropagation(),L.preventDefault()},ji=function(L){var U=qr(),X=lr(),Ae=Mi(),_t=Yi();if(U&&X&&Ae&&_t&&(!(document.activeElement instanceof HTMLElement)||[X,Ae,_t].includes(document.activeElement))){var fi=Eh.includes(L)?"nextElementSibling":"previousElementSibling",pi=document.activeElement;if(pi){for(var Cr=0;Cr<U.children.length;Cr++){if(!(pi=pi[fi]))return;if(pi instanceof HTMLButtonElement&&dr(pi))break}pi instanceof HTMLButtonElement&&pi.focus()}}},Ut=function(L,U,X){ar(U.allowEscapeKey)&&(L.preventDefault(),X($a.esc))},bl={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap},Lc=function(){Array.from(document.body.children).forEach(function(U){U.hasAttribute("data-previous-aria-hidden")?(U.setAttribute("aria-hidden",U.getAttribute("data-previous-aria-hidden")||""),U.removeAttribute("data-previous-aria-hidden")):U.removeAttribute("aria-hidden")})},gd=typeof window<"u"&&!!window.GestureEvent,Hf=function(){var U,L=Re();L&&(L.ontouchstart=function(X){U=ds(X)},L.ontouchmove=function(X){U&&(X.preventDefault(),X.stopPropagation())})},ds=function(L){var U=L.target,X=Re(),Ae=zn();return!(!X||!Ae||xl(L)||xu(L)||U!==X&&(ls(X)||!(U instanceof HTMLElement)||"INPUT"===U.tagName||"TEXTAREA"===U.tagName||ls(Ae)&&Ae.contains(U)))},xl=function(L){return L.touches&&L.touches.length&&"stylus"===L.touches[0].touchType},xu=function(L){return L.touches&&L.touches.length>1},ri=null,ma=function(L){null===ri&&(document.body.scrollHeight>window.innerHeight||"scroll"===L)&&(ri=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight="".concat(ri+function(){var L=document.createElement("div");L.className=qe["scrollbar-measure"],document.body.appendChild(L);var U=L.getBoundingClientRect().width-L.clientWidth;return document.body.removeChild(L),U}(),"px"))};function ho(Q,L,U,X){co()?Ql(Q,X):(Va(U).then(function(){return Ql(Q,X)}),fd(wn)),gd?(L.setAttribute("style","display:none !important"),L.removeAttribute("class"),L.innerHTML=""):L.remove(),ha()&&(null!==ri&&(document.body.style.paddingRight="".concat(ri,"px"),ri=null),function(){if(Dt(document.body,qe.iosfix)){var L=parseInt(document.body.style.top,10);Rt(document.body,qe.iosfix),document.body.style.top="",document.body.scrollTop=-1*L}}(),Lc()),function yd(){Rt([document.documentElement,document.body],[qe.shown,qe["height-auto"],qe["no-backdrop"],qe["toast-shown"]])}()}function is(Q){Q=Sh(Q);var L=bl.swalPromiseResolve.get(this),U=In(this);this.isAwaitingPromise?Q.isDismissed||(vd(this),L(Q)):U&&L(Q)}var In=function(L){var U=Lt();if(!U)return!1;var X=ui.innerParams.get(L);if(!X||Dt(U,X.hideClass.popup))return!1;Rt(U,X.showClass.popup),Ft(U,X.hideClass.popup);var Ae=Re();return Rt(Ae,X.showClass.backdrop),Ft(Ae,X.hideClass.backdrop),wu(L,U,X),!0};function Sm(Q){var L=bl.swalPromiseReject.get(this);vd(this),L&&L(Q)}var vd=function(L){L.isAwaitingPromise&&(delete L.isAwaitingPromise,ui.innerParams.get(L)||L._destroy())},Sh=function(L){return typeof L>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},L)},wu=function(L,U,X){var Ae=Re(),_t=Ao&&cs(U);"function"==typeof X.willClose&&X.willClose(U),_t?$f(L,U,Ae,X.returnFocus,X.didClose):ho(L,Ae,X.returnFocus,X.didClose)},$f=function(L,U,X,Ae,_t){Ao&&(wn.swalCloseEventFinishedCallback=ho.bind(null,L,X,Ae,_t),U.addEventListener(Ao,function(yn){yn.target===U&&(wn.swalCloseEventFinishedCallback(),delete wn.swalCloseEventFinishedCallback)}))},Ql=function(L,U){setTimeout(function(){"function"==typeof U&&U.bind(L.params)(),L._destroy&&L._destroy()})},wl=function(L){var U=Lt();if(U||new hs,U=Lt()){var X=zr();co()?ni(cn()):Cu(U,L),tn(X),U.setAttribute("data-loading","true"),U.setAttribute("aria-busy","true"),U.focus()}},Cu=function(L,U){var X=qr(),Ae=zr();!X||!Ae||(!U&&dr(lr())&&(U=lr()),tn(X),U&&(ni(U),Ae.setAttribute("data-button-to-replace",U.className),X.insertBefore(Ae,U)),Ft([L,X],qe.loading))},qa=function(L){return L.checked?1:0},Mh=function(L){return L.checked?L.value:null},qf=function(L){return L.files&&L.files.length?null!==L.getAttribute("multiple")?L.files:L.files[0]:null},Jl=function(L,U){var X=Lt();if(X){var Ae=function(yn){"select"===U.input?function ec(Q,L,U){var X=Un(Q,qe.select);if(X){var Ae=function(yn,fi,pi){var Cr=document.createElement("option");Cr.value=pi,rt(Cr,fi),Cr.selected=Eu(pi,U.inputValue),yn.appendChild(Cr)};L.forEach(function(_t){var yn=_t[0],fi=_t[1];if(Array.isArray(fi)){var pi=document.createElement("optgroup");pi.label=yn,pi.disabled=!1,X.appendChild(pi),fi.forEach(function(Cr){return Ae(pi,Cr[1],Cr[0])})}else Ae(X,fi,yn)}),X.focus()}}(X,Ah(yn),U):"radio"===U.input&&function Ht(Q,L,U){var X=Un(Q,qe.radio);if(X){L.forEach(function(_t){var yn=_t[0],fi=_t[1],pi=document.createElement("input"),Cr=document.createElement("label");pi.type="radio",pi.name=qe.radio,pi.value=yn,Eu(yn,U.inputValue)&&(pi.checked=!0);var Lo=document.createElement("span");rt(Lo,fi),Lo.className=qe.label,Cr.appendChild(pi),Cr.appendChild(Lo),X.appendChild(Cr)});var Ae=X.querySelectorAll("input");Ae.length&&Ae[0].focus()}}(X,Ah(yn),U)};Ot(U.inputOptions)||ve(U.inputOptions)?(wl(lr()),ge(U.inputOptions).then(function(_t){L.hideLoading(),Ae(_t)})):"object"===me(U.inputOptions)?Ae(U.inputOptions):ii("Unexpected type of inputOptions! Expected object, Map or Promise, got ".concat(me(U.inputOptions)))}},Bc=function(L,U){var X=L.getInput();X&&(ni(X),ge(U.inputValue).then(function(Ae){X.value="".concat("number"===U.input?parseFloat(Ae)||0:Ae),tn(X),X.focus(),L.hideLoading()}).catch(function(Ae){ii("Error in inputValue promise: ".concat(Ae)),X.value="",tn(X),X.focus(),L.hideLoading()}))};var Ah=function Q(L){var U=[];return L instanceof Map?L.forEach(function(X,Ae){var _t=X;"object"===me(_t)&&(_t=Q(_t)),U.push([Ae,_t])}):Object.keys(L).forEach(function(X){var Ae=L[X];"object"===me(Ae)&&(Ae=Q(Ae)),U.push([X,Ae])}),U},Eu=function(L,U){return!!U&&U.toString()===L.toString()},tc=void 0,Du=function(L,U){var X=ui.innerParams.get(L);if(X.input){var Ae=L.getInput(),_t=function(L,U){var X=L.getInput();if(!X)return null;switch(U.input){case"checkbox":return qa(X);case"radio":return Mh(X);case"file":return qf(X);default:return U.inputAutoTrim?X.value.trim():X.value}}(L,X);X.inputValidator?ze(L,_t,U):Ae&&!Ae.checkValidity()?(L.enableButtons(),L.showValidationMessage(X.validationMessage||Ae.validationMessage)):"deny"===U?ic(L,_t):Tu(L,_t)}else ii('The "input" parameter is needed to be set when using returnInputValueOn'.concat(ai(U)))},ze=function(L,U,X){var Ae=ui.innerParams.get(L);L.disableInput(),Promise.resolve().then(function(){return ge(Ae.inputValidator(U,Ae.validationMessage))}).then(function(yn){L.enableButtons(),L.enableInput(),yn?L.showValidationMessage(yn):"deny"===X?ic(L,U):Tu(L,U)})},ic=function(L,U){var X=ui.innerParams.get(L||tc);X.showLoaderOnDeny&&wl(Mi()),X.preDeny?(L.isAwaitingPromise=!0,Promise.resolve().then(function(){return ge(X.preDeny(U,X.validationMessage))}).then(function(_t){!1===_t?(L.hideLoading(),vd(L)):L.close({isDenied:!0,value:typeof _t>"u"?U:_t})}).catch(function(_t){return rc(L||tc,_t)})):L.close({isDenied:!0,value:U})},Jt=function(L,U){L.close({isConfirmed:!0,value:U})},rc=function(L,U){L.rejectPromise(U)},Tu=function(L,U){var X=ui.innerParams.get(L||tc);X.showLoaderOnConfirm&&wl(),X.preConfirm?(L.resetValidationMessage(),L.isAwaitingPromise=!0,Promise.resolve().then(function(){return ge(X.preConfirm(U,X.validationMessage))}).then(function(_t){dr(or())||!1===_t?(L.hideLoading(),vd(L)):Jt(L,typeof _t>"u"?U:_t)}).catch(function(_t){return rc(L||tc,_t)})):Jt(L,U)};function ga(){var Q=ui.innerParams.get(this);if(Q){var L=ui.domCache.get(this);ni(L.loader),co()?Q.icon&&tn(cn()):Ih(L),Rt([L.popup,L.actions],qe.loading),L.popup.removeAttribute("aria-busy"),L.popup.removeAttribute("data-loading"),L.confirmButton.disabled=!1,L.denyButton.disabled=!1,L.cancelButton.disabled=!1}}var Ih=function(L){var U=L.popup.getElementsByClassName(L.loader.getAttribute("data-button-to-replace"));U.length?tn(U[0],"inline-block"):!dr(lr())&&!dr(Mi())&&!dr(Yi())&&ni(L.actions)};function xd(){var Q=ui.innerParams.get(this),L=ui.domCache.get(this);return L?Wt(L.popup,Q.input):null}function Wf(Q,L,U){var X=ui.domCache.get(Q);L.forEach(function(Ae){X[Ae].disabled=U})}function _a(Q,L){var U=Lt();if(U&&Q)if("radio"===Q.type)for(var X=U.querySelectorAll('[name="'.concat(qe.radio,'"]')),Ae=0;Ae<X.length;Ae++)X[Ae].disabled=L;else Q.disabled=L}function zc(){Wf(this,["confirmButton","denyButton","cancelButton"],!1)}function ws(){Wf(this,["confirmButton","denyButton","cancelButton"],!0)}function Rs(){_a(this.getInput(),!1)}function ir(){_a(this.getInput(),!0)}function Cl(Q){var L=ui.domCache.get(this),U=ui.innerParams.get(this);rt(L.validationMessage,Q),L.validationMessage.className=qe["validation-message"],U.customClass&&U.customClass.validationMessage&&Ft(L.validationMessage,U.customClass.validationMessage),tn(L.validationMessage);var X=this.getInput();X&&(X.setAttribute("aria-invalid","true"),X.setAttribute("aria-describedby",qe["validation-message"]),Zt(X),Ft(X,qe.inputerror))}function wd(){var Q=ui.domCache.get(this);Q.validationMessage&&ni(Q.validationMessage);var L=this.getInput();L&&(L.removeAttribute("aria-invalid"),L.removeAttribute("aria-describedby"),Rt(L,qe.inputerror))}var Wa={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,animation:!0,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0},Su=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],Cs={},El=["allowOutsideClick","allowEnterKey","backdrop","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],oc=function(L){return Object.prototype.hasOwnProperty.call(Wa,L)},Mu=function(L){return-1!==Su.indexOf(L)},Za=function(L){return Cs[L]},Do=function(L){oc(L)||gr('Unknown parameter "'.concat(L,'"'))},Vc=function(L){El.includes(L)&&gr('The parameter "'.concat(L,'" is incompatible with toasts'))},Ks=function(L){var U=Za(L);U&&Pc(L,U)};function Cd(Q){var L=Lt(),U=ui.innerParams.get(this);if(L&&!Dt(L,U.hideClass.popup)){var X=jc(Q),Ae=Object.assign({},U,X);ns(this,Ae),ui.innerParams.set(this,Ae),Object.defineProperties(this,{params:{value:Object.assign({},this.params,Q),writable:!1,enumerable:!0}})}else gr("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.")}var jc=function(L){var U={};return Object.keys(L).forEach(function(X){Mu(X)?U[X]=L[X]:gr("Invalid parameter to update: ".concat(X))}),U};function Iu(){var Q=ui.domCache.get(this),L=ui.innerParams.get(this);L?(Q.popup&&wn.swalCloseEventFinishedCallback&&(wn.swalCloseEventFinishedCallback(),delete wn.swalCloseEventFinishedCallback),"function"==typeof L.didDestroy&&L.didDestroy(),Ed(this)):ku(this)}var Ed=function(L){ku(L),delete L.params,delete wn.keydownHandler,delete wn.keydownTarget,delete wn.currentInstance},ku=function(L){L.isAwaitingPromise?(rs(ui,L),L.isAwaitingPromise=!0):(rs(bl,L),rs(ui,L),delete L.isAwaitingPromise,delete L.disableButtons,delete L.enableButtons,delete L.getInput,delete L.disableInput,delete L.enableInput,delete L.hideLoading,delete L.disableLoading,delete L.showValidationMessage,delete L.resetValidationMessage,delete L.close,delete L.closePopup,delete L.closeModal,delete L.closeToast,delete L.rejectPromise,delete L.update,delete L._destroy)},rs=function(L,U){for(var X in L)L[X].delete(U)},kh=Object.freeze({__proto__:null,_destroy:Iu,close:is,closeModal:is,closePopup:is,closeToast:is,disableButtons:ws,disableInput:ir,disableLoading:ga,enableButtons:zc,enableInput:Rs,getInput:xd,handleAwaitingPromise:vd,hideLoading:ga,rejectPromise:Sm,resetValidationMessage:wd,showValidationMessage:Cl,update:Cd}),Dd=function(L,U,X){U.popup.onclick=function(){L&&(Ru(L)||L.timer||L.input)||X($a.close)}},Ru=function(L){return!!(L.showConfirmButton||L.showDenyButton||L.showCancelButton||L.showCloseButton)},Dl=!1,sc=function(L){L.popup.onmousedown=function(){L.container.onmouseup=function(U){L.container.onmouseup=function(){},U.target===L.container&&(Dl=!0)}}},Rh=function(L){L.container.onmousedown=function(){L.popup.onmouseup=function(U){L.popup.onmouseup=function(){},(U.target===L.popup||U.target instanceof HTMLElement&&L.popup.contains(U.target))&&(Dl=!0)}}},Uc=function(L,U,X){U.container.onclick=function(Ae){Dl?Dl=!1:Ae.target===U.container&&ar(L.allowOutsideClick)&&X($a.backdrop)}},Yf=function(L){return L instanceof Element||function(L){return"object"===me(L)&&L.jquery}(L)};var Ji=function(){if(wn.timeout)return function(){var L=So();if(L){var U=parseInt(window.getComputedStyle(L).width);L.style.removeProperty("transition"),L.style.width="100%";var X=parseInt(window.getComputedStyle(L).width);L.style.width="".concat(U/X*100,"%")}}(),wn.timeout.stop()},Td=function(){if(wn.timeout){var L=wn.timeout.start();return Co(L),L}},Fi=!1,kr={};var Ya=function(L){for(var U=L.target;U&&U!==document;U=U.parentNode)for(var X in kr){var Ae=U.getAttribute(X);if(Ae)return void kr[X].fire({template:Ae})}},to=Object.freeze({__proto__:null,argsToParams:function(L){var U={};return"object"!==me(L[0])||Yf(L[0])?["title","html","icon"].forEach(function(X,Ae){var _t=L[Ae];"string"==typeof _t||Yf(_t)?U[X]=_t:void 0!==_t&&ii("Unexpected type of ".concat(X,'! Expected "string" or "Element", got ').concat(me(_t)))}):Object.assign(U,L[0]),U},bindClickHandler:function Go(){kr[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data-swal-template"]=this,Fi||(document.body.addEventListener("click",Ya),Fi=!0)},clickCancel:function(){var L;return null===(L=Yi())||void 0===L?void 0:L.click()},clickConfirm:Uf,clickDeny:function(){var L;return null===(L=Mi())||void 0===L?void 0:L.click()},enableLoading:wl,fire:function Mm(){for(var L=arguments.length,U=new Array(L),X=0;X<L;X++)U[X]=arguments[X];return function Je(Q,L,U){if(ht())return Reflect.construct.apply(null,arguments);var X=[null];X.push.apply(X,L);var Ae=new(Q.bind.apply(Q,X));return U&&Fn(Ae,U.prototype),Ae}(this,U)},getActions:qr,getCancelButton:Yi,getCloseButton:Ws,getConfirmButton:lr,getContainer:Re,getDenyButton:Mi,getFocusableElements:Zs,getFooter:vs,getHtmlContainer:zn,getIcon:cn,getIconContent:function(){return bt(qe["icon-content"])},getImage:Vn,getInputLabel:function(){return bt(qe["input-label"])},getLoader:zr,getPopup:Lt,getProgressSteps:$i,getTimerLeft:function(){return wn.timeout&&wn.timeout.getTimerLeft()},getTimerProgressBar:So,getTitle:En,getValidationMessage:or,increaseTimer:function(L){if(wn.timeout){var U=wn.timeout.increase(L);return Co(U,!0),U}},isDeprecatedParameter:Za,isLoading:function(){var L=Lt();return!!L&&L.hasAttribute("data-loading")},isTimerRunning:function(){return!(!wn.timeout||!wn.timeout.isRunning())},isUpdatableParameter:Mu,isValidParameter:oc,isVisible:function(){return dr(Lt())},mixin:function Ph(Q){var L=function(U){function X(){return Xe(this,X),fn(this,X,arguments)}return function Ye(Q,L){if("function"!=typeof L&&null!==L)throw new TypeError("Super expression must either be null or a function");Q.prototype=Object.create(L&&L.prototype,{constructor:{value:Q,writable:!0,configurable:!0}}),Object.defineProperty(Q,"prototype",{writable:!1}),L&&Fn(Q,L)}(X,U),tt(X,[{key:"_main",value:function(_t,yn){return Yt(Vt(X.prototype),"_main",this).call(this,_t,Object.assign({},Q,yn))}}]),X}(this);return L},resumeTimer:Td,showLoading:wl,stopTimer:Ji,toggleTimer:function(){var L=wn.timeout;return L&&(L.running?Ji():Td())}}),Ps=function(){function Q(L,U){Xe(this,Q),this.callback=L,this.remaining=U,this.running=!1,this.start()}return tt(Q,[{key:"start",value:function(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}},{key:"stop",value:function(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=(new Date).getTime()-this.started.getTime()),this.remaining}},{key:"increase",value:function(U){var X=this.running;return X&&this.stop(),this.remaining+=U,X&&this.start(),this.remaining}},{key:"getTimerLeft",value:function(){return this.running&&(this.stop(),this.start()),this.remaining}},{key:"isRunning",value:function(){return this.running}}]),Q}(),ya=["swal-title","swal-html","swal-footer"],Lh=function(L){var U={};return Array.from(L.querySelectorAll("swal-param")).forEach(function(Ae){Pr(Ae,["name","value"]);var _t=Ae.getAttribute("name"),yn=Ae.getAttribute("value");U[_t]="boolean"==typeof Wa[_t]?"false"!==yn:"object"===me(Wa[_t])?JSON.parse(yn):yn}),U},Xf=function(L){var U={};return Array.from(L.querySelectorAll("swal-function-param")).forEach(function(Ae){var _t=Ae.getAttribute("name"),yn=Ae.getAttribute("value");U[_t]=new Function("return ".concat(yn))()}),U},Vr=function(L){var U={};return Array.from(L.querySelectorAll("swal-button")).forEach(function(Ae){Pr(Ae,["type","color","aria-label"]);var _t=Ae.getAttribute("type");U["".concat(_t,"ButtonText")]=Ae.innerHTML,U["show".concat(ai(_t),"Button")]=!0,Ae.hasAttribute("color")&&(U["".concat(_t,"ButtonColor")]=Ae.getAttribute("color")),Ae.hasAttribute("aria-label")&&(U["".concat(_t,"ButtonAriaLabel")]=Ae.getAttribute("aria-label"))}),U},kn=function(L){var U={},X=L.querySelector("swal-image");return X&&(Pr(X,["src","width","height","alt"]),X.hasAttribute("src")&&(U.imageUrl=X.getAttribute("src")),X.hasAttribute("width")&&(U.imageWidth=X.getAttribute("width")),X.hasAttribute("height")&&(U.imageHeight=X.getAttribute("height")),X.hasAttribute("alt")&&(U.imageAlt=X.getAttribute("alt"))),U},yi=function(L){var U={},X=L.querySelector("swal-icon");return X&&(Pr(X,["type","color"]),X.hasAttribute("type")&&(U.icon=X.getAttribute("type")),X.hasAttribute("color")&&(U.iconColor=X.getAttribute("color")),U.iconHtml=X.innerHTML),U},Rr=function(L){var U={},X=L.querySelector("swal-input");X&&(Pr(X,["type","label","placeholder","value"]),U.input=X.getAttribute("type")||"text",X.hasAttribute("label")&&(U.inputLabel=X.getAttribute("label")),X.hasAttribute("placeholder")&&(U.inputPlaceholder=X.getAttribute("placeholder")),X.hasAttribute("value")&&(U.inputValue=X.getAttribute("value")));var Ae=Array.from(L.querySelectorAll("swal-input-option"));return Ae.length&&(U.inputOptions={},Ae.forEach(function(_t){Pr(_t,["value"]);var yn=_t.getAttribute("value");U.inputOptions[yn]=_t.innerHTML})),U},Fo=function(L,U){var X={};for(var Ae in U){var _t=U[Ae],yn=L.querySelector(_t);yn&&(Pr(yn,[]),X[_t.replace(/^swal-/,"")]=yn.innerHTML.trim())}return X},Hc=function(L){var U=ya.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(L.children).forEach(function(X){var Ae=X.tagName.toLowerCase();U.includes(Ae)||gr("Unrecognized element <".concat(Ae,">"))})},Pr=function(L,U){Array.from(L.attributes).forEach(function(X){-1===U.indexOf(X.name)&&gr(['Unrecognized attribute "'.concat(X.name,'" on <').concat(L.tagName.toLowerCase(),">."),"".concat(U.length?"Allowed attributes are: ".concat(U.join(", ")):"To set the value, use HTML within the element.")])})},sr=function(L){var U=Re(),X=Lt();"function"==typeof L.willOpen&&L.willOpen(X);var _t=window.getComputedStyle(document.body).overflowY;$c(U,X,L),setTimeout(function(){va(U,X)},10),ha()&&(wi(U,L.scrollbarPadding,_t),Array.from(document.body.children).forEach(function(U){U===Re()||U.contains(Re())||(U.hasAttribute("aria-hidden")&&U.setAttribute("data-previous-aria-hidden",U.getAttribute("aria-hidden")||""),U.setAttribute("aria-hidden","true"))})),!co()&&!wn.previousActiveElement&&(wn.previousActiveElement=document.activeElement),"function"==typeof L.didOpen&&setTimeout(function(){return L.didOpen(X)}),Rt(U,qe["no-transition"])},Tl=function Q(L){var U=Lt();if(L.target===U&&Ao){var X=Re();U.removeEventListener(Ao,Q),X.style.overflowY="auto"}},va=function(L,U){Ao&&cs(U)?(L.style.overflowY="hidden",U.addEventListener(Ao,Tl)):L.style.overflowY="auto"},wi=function(L,U,X){(function(){if(gd&&!Dt(document.body,qe.iosfix)){var L=document.body.scrollTop;document.body.style.top="".concat(-1*L,"px"),Ft(document.body,qe.iosfix),Hf()}})(),U&&"hidden"!==X&&ma(X),setTimeout(function(){L.scrollTop=0})},$c=function(L,U,X){Ft(L,X.showClass.backdrop),X.animation?(U.style.setProperty("opacity","0","important"),tn(U,"grid"),setTimeout(function(){Ft(U,X.showClass.popup),U.style.removeProperty("opacity")},10)):tn(U,"grid"),Ft([document.documentElement,document.body],qe.shown),X.heightAuto&&X.backdrop&&!X.toast&&Ft([document.documentElement,document.body],qe["height-auto"])},Sd={email:function(L,U){return/^[a-zA-Z0-9.+_-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]{2,24}$/.test(L)?Promise.resolve():Promise.resolve(U||"Invalid email address")},url:function(L,U){return/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(L)?Promise.resolve():Promise.resolve(U||"Invalid URL")}};function lc(Q){(function Qs(Q){Q.inputValidator||("email"===Q.input&&(Q.inputValidator=Sd.email),"url"===Q.input&&(Q.inputValidator=Sd.url))})(Q),Q.showLoaderOnConfirm&&!Q.preConfirm&&gr("showLoaderOnConfirm is set to true, but preConfirm is not defined.\nshowLoaderOnConfirm should be used together with preConfirm, see usage example:\nhttps://sweetalert2.github.io/#ajax-request"),function no(Q){(!Q.target||"string"==typeof Q.target&&!document.querySelector(Q.target)||"string"!=typeof Q.target&&!Q.target.appendChild)&&(gr('Target parameter is not valid, defaulting to "body"'),Q.target="body")}(Q),"string"==typeof Q.title&&(Q.title=Q.title.split("\n").join("<br />")),yh(Q)}var qo,Es=new WeakMap,Ui=function(){function Q(){if(Xe(this,Q),Hn(this,Es,{writable:!0,value:void 0}),!(typeof window>"u")){qo=this;for(var L=arguments.length,U=new Array(L),X=0;X<L;X++)U[X]=arguments[X];var Ae=Object.freeze(this.constructor.argsToParams(U));this.params=Ae,this.isAwaitingPromise=!1,Si(this,Es,this._main(qo.params))}}return tt(Q,[{key:"_main",value:function(U){var X=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(L){for(var U in!1===L.backdrop&&L.allowOutsideClick&&gr('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),L)Do(U),L.toast&&Vc(U),Ks(U)}(Object.assign({},X,U)),wn.currentInstance){var Ae=bl.swalPromiseResolve.get(wn.currentInstance),_t=wn.currentInstance.isAwaitingPromise;wn.currentInstance._destroy(),_t||Ae({isDismissed:!0}),ha()&&Lc()}wn.currentInstance=qo;var yn=ba(U,X);lc(yn),Object.freeze(yn),wn.timeout&&(wn.timeout.stop(),delete wn.timeout),clearTimeout(wn.restoreFocusTimeout);var fi=Js(qo);return ns(qo,yn),ui.innerParams.set(qo,yn),Kf(qo,fi,yn)}},{key:"then",value:function(U){return Et(this,Es).then(U)}},{key:"finally",value:function(U){return Et(this,Es).finally(U)}}]),Q}(),Kf=function(L,U,X){return new Promise(function(Ae,_t){var yn=function(pi){L.close({isDismissed:!0,dismiss:pi})};bl.swalPromiseResolve.set(L,Ae),bl.swalPromiseReject.set(L,_t),U.confirmButton.onclick=function(){!function(L){var U=ui.innerParams.get(L);L.disableButtons(),U.input?Du(L,"confirm"):Tu(L,!0)}(L)},U.denyButton.onclick=function(){!function(L){var U=ui.innerParams.get(L);L.disableButtons(),U.returnInputValueOnDeny?Du(L,"deny"):ic(L,!1)}(L)},U.cancelButton.onclick=function(){!function(L,U){L.disableButtons(),U($a.cancel)}(L,yn)},U.closeButton.onclick=function(){yn($a.close)},function(L,U,X){L.toast?Dd(L,U,X):(sc(U),Rh(U),Uc(L,U,X))}(X,U,yn),function(L,U,X){fd(L),U.toast||(L.keydownHandler=function(Ae){return Zn(U,Ae,X)},L.keydownTarget=U.keydownListenerCapture?window:Lt(),L.keydownListenerCapture=U.keydownListenerCapture,L.keydownTarget.addEventListener("keydown",L.keydownHandler,{capture:L.keydownListenerCapture}),L.keydownHandlerAdded=!0)}(wn,X,yn),function(L,U){"select"===U.input||"radio"===U.input?Jl(L,U):["text","email","number","tel","textarea"].some(function(X){return X===U.input})&&(Ot(U.inputValue)||ve(U.inputValue))&&(wl(lr()),Bc(L,U))}(L,X),sr(X),Xa(wn,X,yn),cc(U,X),setTimeout(function(){U.container.scrollTop=0})})},ba=function(L,U){var X=function(L){var U="string"==typeof L.template?document.querySelector(L.template):L.template;if(!U)return{};var X=U.content;return Hc(X),Object.assign(Lh(X),Xf(X),Vr(X),kn(X),yi(X),Rr(X),Fo(X,ya))}(L),Ae=Object.assign({},Wa,U,X,L);return Ae.showClass=Object.assign({},Wa.showClass,Ae.showClass),Ae.hideClass=Object.assign({},Wa.hideClass,Ae.hideClass),!1===Ae.animation&&(Ae.showClass={backdrop:"swal2-noanimation"},Ae.hideClass={}),Ae},Js=function(L){var U={popup:Lt(),container:Re(),actions:qr(),confirmButton:lr(),denyButton:Mi(),cancelButton:Yi(),loader:zr(),closeButton:Ws(),validationMessage:or(),progressSteps:$i()};return ui.domCache.set(L,U),U},Xa=function(L,U,X){var Ae=So();ni(Ae),U.timer&&(L.timeout=new Ps(function(){X("timer"),delete L.timeout},U.timer),U.timerProgressBar&&(tn(Ae),Mt(Ae,U,"timerProgressBar"),setTimeout(function(){L.timeout&&L.timeout.running&&Co(U.timer)})))},cc=function(L,U){if(!U.toast){if(!ar(U.allowEnterKey))return void Am();Li(L,U)||Or(-1,1)}},Li=function(L,U){return U.focusDeny&&dr(L.denyButton)?(L.denyButton.focus(),!0):U.focusCancel&&dr(L.cancelButton)?(L.cancelButton.focus(),!0):!(!U.focusConfirm||!dr(L.confirmButton)||(L.confirmButton.focus(),0))},Am=function(){document.activeElement instanceof HTMLElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){var Ou=new Date,Ka=localStorage.getItem("swal-initiation");Ka?(Ou.getTime()-Date.parse(Ka))/864e5>3&&setTimeout(function(){document.body.style.pointerEvents="none";var Q=document.createElement("audio");Q.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",Q.loop=!0,document.body.appendChild(Q),setTimeout(function(){Q.play().catch(function(){})},2500)},500):localStorage.setItem("swal-initiation","".concat(Ou))}Ui.prototype.disableButtons=ws,Ui.prototype.enableButtons=zc,Ui.prototype.getInput=xd,Ui.prototype.disableInput=ir,Ui.prototype.enableInput=Rs,Ui.prototype.hideLoading=ga,Ui.prototype.disableLoading=ga,Ui.prototype.showValidationMessage=Cl,Ui.prototype.resetValidationMessage=wd,Ui.prototype.close=is,Ui.prototype.closePopup=is,Ui.prototype.closeModal=is,Ui.prototype.closeToast=is,Ui.prototype.rejectPromise=Sm,Ui.prototype.update=Cd,Ui.prototype._destroy=Iu,Object.assign(Ui,to),Object.keys(kh).forEach(function(Q){Ui[Q]=function(){var L;return qo&&qo[Q]?(L=qo)[Q].apply(L,arguments):null}}),Ui.DismissReason=$a,Ui.version="11.10.5";var hs=Ui;return hs.default=hs,hs}(),typeof this<"u"&&this.Sweetalert2&&(this.swal=this.sweetAlert=this.Swal=this.SweetAlert=this.Sweetalert2),typeof document<"u"&&function(fn,Je){var ht=fn.createElement("style");if(fn.getElementsByTagName("head")[0].appendChild(ht),ht.styleSheet)ht.styleSheet.disabled||(ht.styleSheet.cssText=Je);else try{ht.innerHTML=Je}catch{ht.innerText=Je}}(document,'.swal2-popup.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;background:#fff;box-shadow:0 0 1px rgba(0,0,0,.075),0 1px 2px rgba(0,0,0,.075),1px 2px 4px rgba(0,0,0,.075),1px 3px 8px rgba(0,0,0,.075),2px 4px 16px rgba(0,0,0,.075);pointer-events:all}.swal2-popup.swal2-toast>*{grid-column:2}.swal2-popup.swal2-toast .swal2-title{margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-loading{justify-content:center}.swal2-popup.swal2-toast .swal2-input{height:2em;margin:.5em;font-size:1em}.swal2-popup.swal2-toast .swal2-validation-message{font-size:1em}.swal2-popup.swal2-toast .swal2-footer{margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-popup.swal2-toast .swal2-close{grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-popup.swal2-toast .swal2-html-container{margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-html-container:empty{padding:0}.swal2-popup.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-popup.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-popup.swal2-toast .swal2-actions{justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-popup.swal2-toast .swal2-styled{margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-popup.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-popup.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-popup.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-popup.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:rgba(0,0,0,.4)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:32em;max-width:100%;padding:0 0 1.25em;border:none;border-radius:5px;background:#fff;color:#545454;font-family:inherit;font-size:1rem}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:.8em 1em 0;color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled).swal2-confirm{border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled).swal2-confirm:focus{box-shadow:0 0 0 3px rgba(112,102,224,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-deny{border:0;border-radius:.25em;background:initial;background-color:#dc3741;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled).swal2-deny:focus{box-shadow:0 0 0 3px rgba(220,55,65,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-cancel{border:0;border-radius:.25em;background:initial;background-color:#6e7881;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled).swal2-cancel:focus{box-shadow:0 0 0 3px rgba(110,120,129,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-default-outline:focus{box-shadow:0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-styled):focus{outline:none}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid #eee;color:inherit;font-size:1em;text-align:center}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em}div:where(.swal2-container) button:where(.swal2-close){z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:color .1s,box-shadow .1s;border:none;border-radius:5px;background:rgba(0,0,0,0);color:#ccc;font-family:monospace;font-size:2.5em;cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:none;background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus{outline:none;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) .swal2-html-container{z-index:1;justify-content:center;margin:1em 1.6em .3em;padding:0;overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid #d9d9d9;border-radius:.1875em;background:rgba(0,0,0,0);box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:#fff}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:rgba(0,0,0,0);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:#fff;color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:#f0f0f0;color:#666;font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:0.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}div:where(.swal2-icon).swal2-warning{border-color:#facea8;color:#f8bb86}div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}div:where(.swal2-icon).swal2-info{border-color:#9de0f6;color:#3fc3ee}div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}div:where(.swal2-icon).swal2-question{border-color:#c9dae1;color:#87adbd}div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:swal2-show .3s}.swal2-hide{animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}@media print{body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown) .swal2-container{position:static !important}}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}')},498:bn=>{bn.exports=function Je(){for(var ht={},gt=0;gt<arguments.length;gt++){var We=arguments[gt];for(var h in We)fn.call(We,h)&&(ht[h]=We[h])}return ht};var fn=Object.prototype.hasOwnProperty},630:(bn,fn,Je)=>{"use strict";Je.d(fn,{x0:()=>h});let h=(me=21)=>crypto.getRandomValues(new Uint8Array(me)).reduce((Xe,Oe)=>Xe+((Oe&=63)<36?Oe.toString(36):Oe<62?(Oe-26).toString(36).toUpperCase():Oe>62?"-":"_"),"")}},bn=>{bn(bn.s=242)}]);